/*! For license information please see designer.browser.js.LICENSE.txt */
var GravitDesigner=function(e){function t(t){for(var i,a,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);p.length;)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={2:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=i);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.src=function(e){return a.p+"chunk."+({12:"vendors~heic2any",13:"vendors~pdfjsWorker"}[e]||e)+".js"}(e);var l=new Error;r=function(t){s.onerror=s.onload=null,clearTimeout(c);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,n[1](l)}o[e]=void 0}};var c=setTimeout((function(){r({type:"timeout",target:s})}),12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(t)},a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw console.error(e),e};var s=this.webpackJsonpGravitDesigner=this.webpackJsonpGravitDesigner||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;return r.push([1252,0]),n()}([,,,function(e,t,n){"use strict";var i=n(22),o=n(180).PROPER,r=n(80),a=n(52),s=n(125),l=n(57),c=n(27),d=n(235),u=RegExp.prototype,p=u.toString,g=i(d),h=c((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),f=o&&"toString"!=p.name;(h||f)&&r(RegExp.prototype,"toString",(function(){var e=a(this),t=l(e.source),n=e.flags;return"/"+t+"/"+l(void 0===n&&s(u,e)&&!("flags"in u)?g(e):n)}),{unsafe:!0})},,,function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,n(105))},,,function(e,t,n){"use strict";var i,o,r,a,s=n(47),l=n(126),c=n(6),d=n(96),u=n(49),p=n(361),g=n(80),h=n(275),f=n(154),m=n(155),y=n(234),v=n(119),_=n(34),b=n(62),w=n(181),C=n(221),E=n(558),S=n(363),G=n(223),A=n(365).set,T=n(560),P=n(368),L=n(563),D=n(369),x=n(564),I=n(99),O=n(310),k=n(38),F=n(565),R=n(224),M=n(194),N=k("species"),B=I.get,$=I.set,U=I.getterFor("Promise"),K=p&&p.prototype,j=p,H=K,V=c.TypeError,z=c.document,W=c.process,q=D.f,Y=q,X=!!(z&&z.createEvent&&c.dispatchEvent),Q=_(c.PromiseRejectionEvent),Z=!1,J=O("Promise",(function(){var e=C(j),t=e!==String(j);if(!t&&66===M)return!0;if(l&&!H.finally)return!0;if(M>=51&&/native code/.test(e))return!1;var n=new j((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))};return(n.constructor={})[N]=i,!(Z=n.then((function(){}))instanceof i)||!t&&F&&!Q})),ee=J||!S((function(e){j.all(e).catch((function(){}))})),te=function(e){var t;return!(!b(e)||!_(t=e.then))&&t},ne=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;T((function(){for(var i=e.value,o=1==e.state,r=0;n.length>r;){var a,s,l,c=n[r++],d=o?c.ok:c.fail,p=c.resolve,g=c.reject,h=c.domain;try{d?(o||(2===e.rejection&&ae(e),e.rejection=1),!0===d?a=i:(h&&h.enter(),a=d(i),h&&(h.exit(),l=!0)),a===c.promise?g(V("Promise-chain cycle")):(s=te(a))?u(s,a,p,g):p(a)):g(i)}catch(e){h&&!l&&h.exit(),g(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&oe(e)}))}},ie=function(e,t,n){var i,o;X?((i=z.createEvent("Event")).promise=t,i.reason=n,i.initEvent(e,!1,!0),c.dispatchEvent(i)):i={promise:t,reason:n},!Q&&(o=c["on"+e])?o(i):"unhandledrejection"===e&&L("Unhandled promise rejection",n)},oe=function(e){u(A,c,(function(){var t,n=e.facade,i=e.value;if(re(e)&&(t=x((function(){R?W.emit("unhandledRejection",i,n):ie("unhandledrejection",n,i)})),e.rejection=R||re(e)?2:1,t.error))throw t.value}))},re=function(e){return 1!==e.rejection&&!e.parent},ae=function(e){u(A,c,(function(){var t=e.facade;R?W.emit("rejectionHandled",t):ie("rejectionhandled",t,e.value)}))},se=function(e,t,n){return function(i){e(t,i,n)}},le=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ne(e,!0))},ce=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw V("Promise can't be resolved itself");var i=te(t);i?T((function(){var n={done:!1};try{u(i,t,se(ce,n,e),se(le,n,e))}catch(t){le(n,t,e)}})):(e.value=t,e.state=1,ne(e,!1))}catch(t){le({done:!1},t,e)}}};if(J&&(H=(j=function(e){w(this,H),v(e),u(i,this);var t=B(this);try{e(se(ce,t),se(le,t))}catch(e){le(t,e)}}).prototype,(i=function(e){$(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=h(H,{then:function(e,t){var n=U(this),i=n.reactions,o=q(G(this,j));return o.ok=!_(e)||e,o.fail=_(t)&&t,o.domain=R?W.domain:void 0,n.parent=!0,i[i.length]=o,0!=n.state&&ne(n,!1),o.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new i,t=B(e);this.promise=e,this.resolve=se(ce,t),this.reject=se(le,t)},D.f=q=function(e){return e===j||e===r?new o(e):Y(e)},!l&&_(p)&&K!==Object.prototype)){a=K.then,Z||(g(K,"then",(function(e,t){var n=this;return new j((function(e,t){u(a,n,e,t)})).then(e,t)}),{unsafe:!0}),g(K,"catch",H.catch,{unsafe:!0}));try{delete K.constructor}catch(e){}f&&f(K,H)}s({global:!0,wrap:!0,forced:J},{Promise:j}),m(j,"Promise",!1,!0),y("Promise"),r=d("Promise"),s({target:"Promise",stat:!0,forced:J},{reject:function(e){var t=q(this);return u(t.reject,void 0,e),t.promise}}),s({target:"Promise",stat:!0,forced:l||J},{resolve:function(e){return P(l&&this===r?j:this,e)}}),s({target:"Promise",stat:!0,forced:ee},{all:function(e){var t=this,n=q(t),i=n.resolve,o=n.reject,r=x((function(){var n=v(t.resolve),r=[],a=0,s=1;E(e,(function(e){var l=a++,c=!1;s++,u(n,t,e).then((function(e){c||(c=!0,r[l]=e,--s||i(r))}),o)})),--s||i(r)}));return r.error&&o(r.value),n.promise},race:function(e){var t=this,n=q(t),i=n.reject,o=x((function(){var o=v(t.resolve);E(e,(function(e){u(o,t,e).then(n.resolve,i)}))}));return o.error&&i(o.value),n.promise}})},,,function(e,t,n){"use strict";var i=n(16);const o=n(472),r=n(473),a=n(198);o.GoogleTagManagerSettings=n(730),o.AUTO_SAVE_ENABLED=i.GPlatform.webBrowser!==i.GPlatform.constructor.WebBrowser.Safari,o.DOMAIN="gravit.io",o.GA={customDimensions:["EWOSU","token","template","preset"]},o.PURCHASE={URL_TO_PRODUCT:{purchase_flow:214093,purchase_flow_new:220444}},o.LEGACY_SHARE_DIALOG=!1,o.ENABLE_COLLABORATION=!0,o.FILE_REVIEW_ENABLED=!0,o.ENABLE_REQUEST_ACCESS=!0,o.ENABLE_GUEST_ACCESS=!0,o.IN_APP_PURCHASE.WINDOWS.production="ESDWINGRAVIT",o.IN_APP_PURCHASE.WINDOWS.beta="ESDWINGRAVIT",o.IN_APP_PURCHASE.WINDOWS.lts="ESDWINGRAVIT",o.IN_APP_PURCHASE.WINDOWS.rc="GravitDesignerSubscription-rc",o.IN_APP_PURCHASE.WINDOWS.trunk="GravitDesignerSubscription-trunk",o.IN_APP_PURCHASE.CLEVERBRIDGE.openCartInAPopup=!0,o.websocketURL="wss://ws.gravit.io",o.trunkWebsocketURL="wss://ws-trunk.gravit.io",o.rcWebsocketURL="wss://ws-rc.gravit.io",o.betaWebsocketURL="wss://ws-beta.gravit.io",o.cloudTrunkURL="https://cloud-trunk.gravit.io",o.cloudBetaURL="https://cloud-beta.gravit.io",o.cloudRCURL="https://cloud-rc.gravit.io",o.trunkURL="https://designer-trunk.gravit.io",o.betaURL="https://designer-beta.gravit.io",o.ltsURL="https://designer-lts.gravit.io",o.rcURL="https://designer-rc.gravit.io",o.prodURL="https://designer.gravit.io",o.domain="gravit.io",o.gApi=n(731),o.DateAPI=n(211).DateAPI,o.GLocaleFactory=n(211).GLocale,o.defaultUserSettings=n(199),o.SharePermissions=n(319),o.ShareRoles=n(259),o.Share=n(520),o.Lock=n(523),o.FileExtended=n(519),o.MicrosoftB2BKeyType=n(733),o.PaymentProviders=n(521),o.PurchaseStatus=n(734),o.SubscriptionStatus=n(735),o.PasswordlessAuthenticationActions=n(524),o.License=n(736),o.LicenseType=n(525),o.Runtime=n(526),o.User=n(737),o.CloudUtils=n(320),a.IS_WEB_WORKER||(o.GLoginDialog=n(244).GLoginDialog,o.GReminderDialogFactory=n(244).GReminderDialogFactory,o.GReminderDialog=n(244).GReminderDialog,o.GPaywallDialog=n(244).GPaywallDialog),o.CATEGORIES=n(738),o.ELEMENTS=n(739),o.GooglePickerBuilder=n(740),o.HAS_ANNOTATIONS=!0,o.ANNOTATION_PERMANENT_LINK=!0,o.ANONYMOUS_SESSION_ENABLED=!0,o.USE_EXTENSION_IN_FILENAME=!1,o.ALWAYS_SHOW_ACCOUNT_SETTING_DIALOG=!1,o.Notification=n(741),o.NotificationConstants=n(527),o.FileStatus=n(528),o.FileReviewStatusAvailable=[o.FileStatus.IN_REVIEW,o.FileStatus.REOPENED,o.FileStatus.AWAITING_APPROVAL,o.FileStatus.APPROVED],o.GFileReviewFlow=n(742),o.GFileReviewActions=n(743);const s=n(744);o.NOTIFICATION_USER_MENTION_REGEX=s.NOTIFICATION.USER_MENTION,o.HTTP_STATUS_CODES=n(522),o.CloudIntegration={cloudOptions:[{name:"Google Drive",type:"googledrive",className:"google-drive",pro:!0,default:!1}],nativeOption:{type:"native",name:"Gravit Cloud",deletable:!1,pro:!1,id:r.Provider.CloudNative,default:!0}},o.PAGE_CLIP_DEFAULT=!0,o.msTeamsMode=!1,o.thirdPartyCookieWarningLink="https://support.gravit.io/hc/en-us/articles/1500005394122",o.LINKS.BLENDING_MODES_DOCUMENTATION_URL="https://documentation.designer.io/colors-gradients-textures/blending-modes",e.exports=o},,function(e,t,n){"use strict";var i=n(47),o=n(226);i({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},,,function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var i=n(1);function o(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;this.label=i.GLocale.get(e),this.visible=t,this.icon=n,this.parent=null}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>null;var a=new o;return Object.defineProperties(a,{label:{get:()=>i.GLocale.get(new i.GLocaleKey(e[0],e[1]))},visible:{get:n},icon:{get:r},parent:{get:()=>t}}),a}i.GObject.inherit(o,i.GObject),o.prototype.label=null,o.prototype.visible=!0,o.prototype.icon=null,o.CATEGORY_FILE=r(["GCategory","category.file"]),o.CATEGORY_FILE_SHARE=r(["GCategory","category.file.share"],o.CATEGORY_FILE),o.CATEGORY_FILE_OPEN_RECENT=r(["GCategory","category.file.open-recent"],o.CATEGORY_FILE),o.CATEGORY_FILE_SAVE_AS=r(["GCategory","category.file.save-as"],o.CATEGORY_FILE),o.CATEGORY_FILE_GRAVIT_CLOUD=r(["GCategory","category.file.gravit-cloud"],o.CATEGORY_FILE),o.CATEGORY_FILE_IMPORT=r(["GCategory","category.file.import"],o.CATEGORY_FILE),o.CATEGORY_FILE_IMPORT_IMAGE=r(["GCategory","category.file.import.image"],o.CATEGORY_FILE_IMPORT),o.CATEGORY_FILE_EXPORT=r(["GCategory","category.file.export"],o.CATEGORY_FILE,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-export":null),o.CATEGORY_FILE_EXPORT_PDF=r(["GCategory","category.file.export.pdf"],o.CATEGORY_FILE_EXPORT),o.CATEGORY_EDIT=r(["GCategory","category.edit"]),o.CATEGORY_EDIT_PASTE=r(["GCategory","category.edit.paste"],o.CATEGORY_EDIT,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-paste":null),o.CATEGORY_EDIT_SELECT_SAME=r(["GCategory","category.edit.select-same"],o.CATEGORY_EDIT),o.CATEGORY_MODIFY=r(["GCategory","category.modify"]),o.CATEGORY_MODIFY_COMBINE=r(["GCategory","category.modify.combine"],o.CATEGORY_MODIFY),o.CATEGORY_MODIFY_ARRANGE=r(["GCategory","category.modify.arrange"],o.CATEGORY_MODIFY,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-arrange":null),o.CATEGORY_MODIFY_ALIGN=r(["GCategory","category.modify.align"],o.CATEGORY_MODIFY,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-align":null),o.CATEGORY_MODIFY_TRANSFORM=r(["GCategory","category.modify.transform"],o.CATEGORY_MODIFY,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-transform":null),o.CATEGORY_MODIFY_PATH=r(["GCategory","category.modify.path"],o.CATEGORY_MODIFY),o.CATEGORY_MODIFY_SYMBOL=r(["GCategory","category.modify.symbol"],o.CATEGORY_MODIFY,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-symbol":null),o.CATEGORY_VIEW=r(["GCategory","category.view"],null,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-no-icon":null),o.CATEGORY_VIEW_CANVAS=r(["GCategory","category.view.canvas"],o.CATEGORY_VIEW),o.CATEGORY_VIEW_SNAP=r(["GCategory","category.view.snap"],o.CATEGORY_VIEW,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-snap":null),o.CATEGORY_VIEW_MAGNIFICATION=r(["GCategory","category.view.magnification"],o.CATEGORY_VIEW,()=>!0,()=>gDesigner.isTouchEnabled()?"gravit-icon-zoom-in":null),o.CATEGORY_HELP=r(["GCategory","category.help"]),o.CATEGORY_HELP_SUPPORT=r(["GCategory","category.help.support"],o.CATEGORY_HELP),o.CATEGORY_HELP_BETA_FEEDBACK=r(["GCategory","category.help.beta_feedback"],o.CATEGORY_HELP),o.CATEGORY_HELP_LEARN=r(["GCategory","category.help.learn"],o.CATEGORY_HELP),o.CATEGORY_HELP_LANGUAGE=r(["GCategory","category.help.language"],o.CATEGORY_HELP),o.CATEGORY_HELP_SWITCHWEBCDR=r(["GCategory","category.help.switchwebcdr"],o.CATEGORY_HELP),o.CATEGORY_ACCOUNT=r(["GCategory","category.account"],null,()=>gDesigner.isTouchEnabled(),()=>{const e=gDesigner.getSyncUser();if(e){if(e.hasOwnPictureAvatar())return $("<div/>").addClass("avatar").css("background-image",'url("'.concat(e.avatar,'")'));const t=e.getUserColor();return $("<div/>").addClass("avatar").css("background-color",t).css("border-color",t).append($("<span/>").text(e.getUserNameInitials()))}return null}),e.exports=o},function(e,t,n){"use strict";var i=n(178),o=n(513),r=n(182),a=n(99),s=n(378),l=a.set,c=a.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){l(this,{type:"Array Iterator",target:i(e),index:0,kind:t})}),(function(){var e=c(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),r.Arguments=r.Array,o("keys"),o("values"),o("entries")},,,function(e,t){var n=Function.prototype,i=n.bind,o=n.call,r=i&&i.bind(o);e.exports=i?function(e){return e&&r(o,e)}:function(e){return e&&function(){return o.apply(e,arguments)}}},,function(e,t,n){var i=n(6),o=n(372),r=n(373),a=n(19),s=n(89),l=n(38),c=l("iterator"),d=l("toStringTag"),u=a.values,p=function(e,t){if(e){if(e[c]!==u)try{s(e,c,u)}catch(t){e[c]=u}if(e[d]||s(e,d,t),o[t])for(var n in a)if(e[n]!==a[n])try{s(e,n,a[n])}catch(t){e[n]=a[n]}}};for(var g in o)p(i[g]&&i[g].prototype,g);p(r,"DOMTokenList")},function(e,t,n){var i=n(47),o=n(370);i({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(752));function a(){}o.GObject.inherit(a,o.GObject),a.SHORTCUT_DELAY=500,a.prototype.getId=function(){throw new Error("Not Supported")},a.prototype.getTitle=function(){throw new Error("Not Supported")},a.prototype.getInfo=function(){return null},a.prototype.getIcon=function(){return r.default[this.getId()]||null},a.prototype.getCategory=function(){return null},a.prototype.getGroup=function(){return null},a.prototype.getGroupIcon=function(){return null},a.prototype.getShortcut=function(){return null},a.prototype.isShortcutGlobal=function(){return!1},a.prototype.isRegisterShortcut=function(){return null},a.prototype.getAdditionalShortcuts=function(){return null},a.prototype.isEnabled=function(){return!0},a.prototype.isCheckable=function(){return!1},a.prototype.isChecked=function(){return!1},a.prototype.isAvailable=function(e){return!0},a.prototype.execute=function(){throw new Error("Not Supported")},a.prototype.executeFromShortcut=function(){return this.execute.apply(this,arguments)},a.prototype.isPro=function(){return!1},a.prototype.getTooltipArea=function(){return null},a.prototype.getTooltipConfig=function(e){return null},a.prototype.isVisible=function(){return!0},a.prototype.noHover=function(){return!1},a.prototype.getStyleClass=function(){return null},a.prototype.statsValue=function(){return null},a.prototype.toString=function(){return"[Object GAction]"},e.exports=a},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(6),o=n(372),r=n(373),a=n(566),s=n(89),l=function(e){if(e&&e.forEach!==a)try{s(e,"forEach",a)}catch(t){e.forEach=a}};for(var c in o)o[c]&&l(i[c]&&i[c].prototype);l(r)},function(e,t,n){"use strict";var i=n(184),o=n(49),r=n(22),a=n(250),s=n(27),l=n(52),c=n(34),d=n(114),u=n(104),p=n(57),g=n(95),h=n(279),f=n(145),m=n(618),y=n(251),v=n(38)("replace"),_=Math.max,b=Math.min,w=r([].concat),C=r([].push),E=r("".indexOf),S=r("".slice),G="$0"==="a".replace(/./,"$0"),A=!!/./[v]&&""===/./[v]("a","$0");a("replace",(function(e,t,n){var r=A?"$":"$0";return[function(e,n){var i=g(this),r=null==e?void 0:f(e,v);return r?o(r,e,i,n):o(t,p(i),e,n)},function(e,o){var a=l(this),s=p(e);if("string"==typeof o&&-1===E(o,r)&&-1===E(o,"$<")){var g=n(t,a,s,o);if(g.done)return g.value}var f=c(o);f||(o=p(o));var v=a.global;if(v){var G=a.unicode;a.lastIndex=0}for(var A=[];;){var T=y(a,s);if(null===T)break;if(C(A,T),!v)break;""===p(T[0])&&(a.lastIndex=h(s,u(a.lastIndex),G))}for(var P,L="",D=0,x=0;x<A.length;x++){for(var I=p((T=A[x])[0]),O=_(b(d(T.index),s.length),0),k=[],F=1;F<T.length;F++)C(k,void 0===(P=T[F])?P:String(P));var R=T.groups;if(f){var M=w([I],k,O,s);void 0!==R&&C(M,R);var N=p(i(o,void 0,M))}else N=m(I,s,O,k,R,o);O>=D&&(L+=S(s,D,O)+N,D=O+I.length)}return L+S(s,D)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!G||A)},,,function(e,t,n){"use strict";n(84),n(750);var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t._cloneChildrenIntoReceiver=A,t._mergeChildren=S,t._mergePath=E,t._mergeProperties=w,t._mergeStyle=C,t._removeDeletedChildren=G,t._tryAndCatch=void 0,t._updateCommonChildren=T,t.areNodePropertiesDifferent=v,t.base64StringToString=function(e){let t;try{t=m(l.toByteArray(e))}catch(e){t=""}return t},t.base64URLSafeEncode=function(e){return(0,a.trim)((0,a.encode)(e))},t.blockChanges=function(e,t,n,i){n&&n.startBlockReferenceChanges();i&&i.beginUpdate();e&&e._beginSelectionUpdate();t&&t.forEach(e=>{e.beginUpdate()})},t.buildDialogDocumentHasUpdates=function(e,t,n,i){return c.custom({subtitle:o.GLocale.get(new o.GLocaleKey("GSaveAction","has-new-version-when-save-message")),className:"g-has-updates-warning-dialog",icon:"info",closeable:!1,buttons:[{label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.cancel")),closeOnClick:!0,shortcut:c.Shortcut.Esc,position:"left",onclick:()=>{i&&i.call(this,e)}},{label:o.GLocale.get(new o.GLocaleKey("GSaveAction","has-new-version-when-save-reload")),closeOnClick:!0,onclick:()=>{gDesigner.getToolbar()._updateActions(),t.call(this,e)}},{label:o.GLocale.get(new o.GLocaleKey("GSaveAction","has-new-version-when-save-save")),className:"primary",closeOnClick:!0,shortcut:c.Shortcut.Enter,onclick:()=>{n.call(this,e)}}]})},t.chaining=void 0,t.debounce=function(e,t){let n;return function(){const i=arguments;let o=()=>{n=0,e.apply(this,i)};n&&clearTimeout(n),n=setTimeout(o,t)}},t.decodeFromUTF8=m,t.decodeHTML=function(e){return $("<textarea/>").html(e).text()},t.decrypt=function(e){try{var t=e.split(":"),n=t.shift(),i=s.enc.Hex.parse(n),o=t.join(":");return s.AES.decrypt(o,h,{iv:i,format:s.format.OpenSSL,mode:s.mode.CBC}).toString(s.enc.Utf8)}catch(e){return}},t.encodeToUTF8=y,t.encrypt=function(e){try{var t=s.lib.WordArray.random(32),n=s.AES.encrypt(e,h,{iv:t,format:s.format.OpenSSL,mode:s.mode.CBC});return t.toString(s.enc.Hex)+":"+n.toString()}catch(e){return}},t.fakeFunction=function(){},t.getAnnotationType=function(e){let t=e.toString().match(/\[G((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)Annotation\]/);return t&&t[1]||null},t.getExtensionFromString=function(e,t){var n=new RegExp("\\b"+t.join("|")+"\\b","gim"),i=e.match(n);return i?i[0]:null},t.getFileNameWithoutExtension=function(e,t){e.toLowerCase().endsWith(".".concat(t).toLowerCase())&&(e=e.substr(0,e.lastIndexOf(".")));return e},t.getFileSHA256Digest=async function(e){e instanceof Blob?e=await e.arrayBuffer():"string"==typeof e&&(e=y(e));return s.SHA256(function(e){for(var t=new Uint8Array(e),n=[],i=0;i<t.length;i+=4)n.push(t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3]);return s.lib.WordArray.create(n,t.length)}(e)).toString()},t.getFileStateAndRole=function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=t.getPrivateShareList();o.forEach(t=>{const{id:o,copy:r,inspect:a,comment:s,owner:l,access:c,edit:p}=t;e.getUID()===o?(n=d.makeFromShare(t),l?Object.assign(i,{owner:!0,edit:!0,inspect:!0,copy:!0,comment:!!u,share:!0}):Object.assign(i,{owner:!1,share:!1,edit:p,copy:r,inspect:a,comment:!!u&&s,sharing:c})):c&&Object.assign(i,{sharing:!0})});const r=o.find(e=>e.owner);if(r){const t=e.getUID()===r.id;i.owner=t,i.share=t}const a=t.getPublicShare();a&&a.access&&(i.isPrivate=!1,i.sharing=!0);return Object.assign(i,{isPrivate:o&&o.filter(e=>!e.owner).length>0}),{state:i,role:n,publicShare:a}},t.getSizeInfo=function(e){var t=e;const n=1e6,i=1e3*n;var o={gb:0,mb:0,kb:0},r=Math.floor(t/i);r&&(o.gb=r,t-=r*i);var a=Math.floor(t/n);a&&(o.mb=a,t-=a*n);var s=Math.floor(t/1e3);s&&(o.kb=s,t-=1e3*s);return o},t.getVersionFromString=function(e,t,n){var i=e.match(t.join("|"));return i?i[0]:n},t.isDifferent=_,t.isFunction=function(e){if(void 0===e)return!1;var t=Object.prototype.toString.call(e);return["[object Function]","[object AsyncFunction]","[object GeneratorFunction]","[object Proxy]"].indexOf(t)>=0},t.isPassiveSupported=function(){if(void 0===P){P=!1;try{const e={get passive(){return P=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){P=!1}}return P},t.isSupportedScreenSize=function(e){if(!e&&o.GSystem.hardware===o.GSystem.Hardware.Tablet){return(window.screen.height>window.screen.width?window.screen.height:window.screen.width)>=p}return(e||window.screen.availWidth)>=p},t.isSymbol=f,t.isSymbolInstance=void 0,t.iterateAroundIndex=function(e,t,n){var i=0,o=0,r=e.length;for(;i<r;){var a=t+o;n(e[a],a),i++,o>0&&t-o>=0?o=-o:o>0?o++:t-o+1<r?o=1-o:o--}},t.iterateEqualStyleLayers=function(e,t,n,i){var r=[];if(n.length>1){for(var a=0;a<n.length;a++){var s=n[a],l=[];if("fill"===e)l=s.getPaintLayers().getFillLayers();else if("border"===e)l=s.getPaintLayers().getBorderLayers();else if("effect"===e)for(var c=s.getEffects().getFirstChild();null!==c;c=c.getNext())l.push(c);for(var d=0;d<l.length;d++){var u=l[d];("fill"===e&&o.GStylable.FillPaintLayer.equals(u,t)||"border"===e&&o.GStylable.BorderPaintLayer.equals(u,t)||"effect"===e&&o.GUtil.equals(u,t))&&r.push(u)}}r.forEach((function(e){i(e)}))}else i(t)},t.mergeNode=b,t.releaseChanges=function(e,t,n){t&&t.forEach(e=>{e.endUpdate()});e&&e._finishSelectionUpdate();for(var i=arguments.length,o=new Array(i>3?i-3:0),r=3;r<i;r++)o[r-3]=arguments[r];o&&o.forEach(e=>{e.endUpdate()});n&&n.endBlockReferenceChanges()},t.removeAllSuffixWhichLikeExtension=function(e,t){const n=".".concat(t).toLowerCase();for(;e.toLowerCase().endsWith(n);)e=e.substr(0,e.lastIndexOf("."));return e},t.resolveDocumentImages=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(async(i,r)=>{const a=e=>e===o.GImage.ImageStatus.Loaded||e===o.GImage.ImageStatus.Error;let s=0;if(e.accept(e=>{e instanceof o.GImage&&!a(e.getStatus())&&s++}),s>0){let l=setTimeout(()=>{(s>0||n.cancelled)&&(e.removeEventListener(o.GImage.StatusEvent,c),r())},t);const c=t=>{let{status:d}=t;a(d)&&--s<=0&&(l&&(clearTimeout(l),l=null),e.removeEventListener(o.GImage.StatusEvent,c),i(!0)),n.cancelled&&(l&&(clearTimeout(l),l=null),e.removeEventListener(o.GImage.StatusEvent,c),r())};e.addEventListener(o.GImage.StatusEvent,c)}else i(!0)})},t.saveBBoxes=function(e){var t=[];e.accept((function(e){if(e instanceof o.GElement){var n=e.getPaintBBox(!1,null,!0);t.push(n)}}));for(var n=new Float64Array(4*t.length),i=0;i<t.length;++i)for(var r=o.GRect.serialize(t[i]),a=0;a<4;++a)n[4*i+a]=r[a];s="Test_invisible-.dat",l=n,navigator.webkitTemporaryStorage.requestQuota(1e3,(function(e){var t=e;console.log("Requested bytes:",1e3,"Granted bytes:",t),window.webkitRequestFileSystem(window.TEMPORARY,t,(function(e){const t=e.root.toURL();window.webkitResolveLocalFileSystemURL(t,(function(e){e.getFile(s,{create:!0},(function(e){e.createWriter((function(e){e.onwriteend=function(){console.log("Write completed.")},e.onerror=function(e){console.log("Write failed: "+e.toString())},e.seek(0);var t=new Blob([l.buffer],{type:"application/octet-stream"});e.write(t)}),(function(e){console.log(e)}))}))}),(function(e){console.log(e)}))}),(function(e){console.log(e)}))}));var s,l},t.sleep=function(e){return new Promise(t=>setTimeout(t,e))},t.stringToBase64String=function(e){return l.fromByteArray(y(e))},t.throttle=function(e,t){let n;return function(){const i=arguments;n||(e.apply(this,i),n=!0,setTimeout(()=>n=!1,t))}},t.toCapitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},t.toMD5=function(e){return s.MD5(e).toString()},t.trimStart=function(e,t){if(!t||!t.length)return e;if(!e||!e.startsWith(t))return e;return e.substring(t.length)},t.watchDog=void 0,n(9),n(3),n(14),n(63),n(28),n(19),n(158),n(201),n(166),n(167),n(129),n(937),n(58),n(132),n(25),n(321),n(261);var o=n(1),r=i(n(75)),a=n(938);const s=n(939);var l=n(229),c=n(36);const d=n(386),{HAS_ANNOTATIONS:u,MIN_SUPPORTED_SCREEN_SIZE:p}=n(12);const g={trap:(e,t,n,i)=>o=>((e,t,n,i,o)=>gDesigner.isEnabledProFeatures(o)||n&&n(e)?t?t(e):void 0:(i&&i(e),e.stopImmediatePropagation(),e.preventDefault(),gDesigner.handlePROFeatureInterruption(),!1))(o,e,t,n,i),check:(e,t)=>gDesigner.isEnabledProFeatures()?e:t};t.watchDog=g;t._tryAndCatch=async e=>{try{await e()}catch(e){console.log(e)}};const h=s.enc.Latin1.parse(s.enc.Latin1.stringify(s.SHA256("#a09j!@10jas-109827s*%#1098XAapoc-9908#!123")));function f(e,t){const n=e=>e&&e instanceof o.GSymbol&&(!t||!e.isMaster());return!!n(e)||!!e.findParent(n)}function m(e){return new TextDecoder("utf-8").decode(e)}function y(e){return new TextEncoder("utf-8").encode(e)}t.isSymbolInstance=e=>f(e,!0);function v(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=e=>Object.keys(e).filter(e=>(e.startsWith("$")||e.startsWith("@"))&&!n.includes(e)).map(e=>e.slice(1)),r=i(e),a=i(t);return!o.GUtil.equals(r,a)||!e.arePropertiesEqual(t,r)}function _(e,t,n){if(n||(n=["$lmd","$storedUrl","$__ids"]),!(e instanceof t.constructor))return!0;if(e.hasMixin(o.GNode.Properties)!==t.hasMixin(o.GNode.Properties))return!0;if(e.hasMixin(o.GNode.Properties)&&v(e,t,n))return!0;if(e.hasMixin(o.GElement.Stylable)!==t.hasMixin(o.GElement.Stylable))return!0;if(e.hasMixin(o.GElement.Stylable)){const i=e.getEffects(),o=t.getEffects();if(Boolean(i)!==Boolean(o))return!0;if(i&&_(i,o,n))return!0;const r=e.getPaintLayers(),a=t.getPaintLayers();if(Boolean(r)!==Boolean(a))return!0;if(r&&_(r,a,n))return!0}if(e.hasMixin(o.GNode.Container)!==t.hasMixin(o.GNode.Container))return!0;if(e instanceof o.GPathBase!=t instanceof o.GPathBase)return!0;if(e instanceof o.GPathBase){var i=e.getAnchorPoints(),r=i.getChildren(),a=t.getAnchorPoints(),s=a.getChildren();if(r.length!==s.length)return!0;for(var l=0;l<r.length;l++){var c=i.getChildByIndex(l),d=a.getChildByIndex(l);if(c^d)return!0;if(v(c,d,n))return!0}}if(e.hasMixin(o.GNode.Container)){const i=e.getChildren(),o=t.getChildren();if(i.length!==o.length)return!0;for(let e=0;e<i.length;e++)if(_(i[e],o[e],n))return!0}return!1}function b(e,t){try{C(e,t),E(e,t),S(e,t),w(e,t)}catch(e){console.log(e,e&&e.stack)}}function w(e,t){const n=function(e){const t=[];return Object.keys(e).filter(e=>e.startsWith("$")&&!t.includes(e)).map(e=>e.slice(1))}(t);e.setProperties(n,t.getProperties(n))}function C(e,t){if(e.hasMixin(o.GElement.Stylable)){var n=e.getPaintLayers(),i=t.getPaintLayers(),a=n.getBorderLayers(),s=i.getBorderLayers(),l=n.getFillLayers(),c=i.getFillLayers();e.hasMixin(r.default)?(s.length&&a.length&&a[0].assignFrom(s[0]),c.length&&l.length&&l[0].assignFrom(c[0])):(a.forEach(e=>{var t=s.find(t=>t.getId()===e.getId());t&&e.assignFrom(t)}),l.forEach(e=>{var t=c.find(t=>t.getId()===e.getId());t&&e.assignFrom(t)}))}}function E(e,t){if(e instanceof o.GPathBase){var n=e.getAnchorPoints();n.beginUpdate(),n.clearChildren(),n.deserialize(t.getAnchorPoints().serialize()),n.endUpdate()}}function S(e,t){if(!e.hasMixin(o.GNode.Container))return;let n=e.getChildren(),i=t.getChildren();G(e,t),A(e,t),T(n,i)}function G(e,t){let n=e.getChildren(),i=t.getChildren();n.forEach(t=>{i.some(e=>e.getId()===t.getId())||e.removeChild(t)})}function A(e,t){for(var n=t.getLastChild();null!==n;n=n.getPrevious()){if(e.getChildren().some(e=>e.getId()===n.getId()))continue;let t=n.getNext(),i=t&&e.getChildren().find(e=>e.getId()===t.getId());e.insertChild(n.clone(),i)}}function T(e,t){e.forEach(e=>{let n=t.find(t=>t.getId()===e.getId());n&&_(e,n)&&b(e,n)})}let P;t.chaining=(e,t)=>()=>e()&&t()},,function(e,t){e.exports=function(e){return"function"==typeof e}},,function(e,t,n){"use strict";n(9),n(14),n(29),n(25),n(45),n(19),n(24),n(28);var i=n(1),o=n(16);class r{static error(e){let{showTitle:t=!0,closeCallback:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.custom({title:t?i.GLocale.get(new i.GLocaleKey("GCommonNames","text.something-wrong")):"",subtitle:gApi.formatError(e),closeCallback:n})}static externalFileError(e){let t=e?i.GLocale.get(new i.GLocaleKey("GContainer","text.load-failed-from-recent")):i.GLocale.get(new i.GLocaleKey("GContainer","text.load-failed-from-link"));return r.custom({subtitle:t,icon:"error"})}static splashScreenError(e,t,n){var i=$("<div></div>").append($("<div></div>").addClass("message").html(e));const o=[];return n&&o.push($("<button></button>").text(t).on("click",e=>{n&&n(e),i.gDialog("close")})),i.gDialog({releaseOnClose:!0,className:"g-system-dialog g-splash-screen-error-dialog",buttons:o}),i.gDialog("open",!1),i}static async confirm(e,t,n,r,a,s,l,c){if(c){let e=()=>{try{return gContainer.getProperty(c)}catch(e){return!1}};if(await e())return}var d=$("<div></div>").append($("<div></div>").addClass("message").html(e));let u;const p=e=>{u&&document.removeEventListener("keydown",u,!0),d.gDialog("close"),t&&t(e)};(s||l)&&(u=e=>{s&&o.GKey.translateKey(e.keyCode)===o.GKey.Constant.ENTER?d.gDialog("isOpen")&&(e.preventDefault(),e.stopImmediatePropagation(),p(!0)):l&&o.GKey.translateKey(e.keyCode)===o.GKey.Constant.ESC&&d.gDialog("isOpen")&&(e.preventDefault(),e.stopImmediatePropagation(),p(!1))},document.addEventListener("keydown",u,!0));const g=e=>e&&"object"==typeof e?e.text:e,h=e=>!!e&&"object"==typeof e&&!!e.pro,f=!!(m=r)&&"object"==typeof m&&!!m.disabled;var m;d.gDialog({releaseOnClose:!0,className:"g-system-dialog g-confirm-dialog"+(c?" g-onetime-dialog":""),buttons:[$("<button></button>").text(g(n)||i.GLocale.get(new i.GLocaleKey("GLocale","cancel"))).gPro({pro:h(n)}).on("click",()=>{p(!1)}),$("<button></button>").addClass("primary").toggleClass("g-disabled",f).text(g(r)||i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).gPro({pro:h(r)}).on("click",()=>{f||p(!0)})]}),c&&d.closest(".g-dialog").find(".g-dialog-footer").prepend($("<label></label>").append([$("<input>").attr("type","checkbox").on("change",(function(){this.checked?gContainer.setProperty(c,!0):gContainer.setProperty(c,!1)})),$("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.do-not-show-again")))])),null===a&&(a=!1),d.gDialog("open",a)}static prompt(e,t,n,o,r,a){var s=n&&"string"!=typeof n,l=s?n:$("<input/>").addClass("max-width").attr("type","text").val(n||"").on("keypress",e=>{13===e.keyCode||"Enter"===e.key?(c.gDialog("close"),t&&t(!!s||l.val())):27!==e.keyCode&&"Escape"!==e.key||(c.gDialog("close"),t&&t())}),c=$("<div></div>").append($("<div></div>").addClass("message").html(e)).append($("<div></div>").addClass("input").append(l));c.gDialog({releaseOnClose:!0,className:"g-system-dialog g-prompt-dialog "+a,buttons:[$("<button></button>").text(o||i.GLocale.get(new i.GLocaleKey("GLocale","cancel"))).on("click",()=>{c.gDialog("close"),t&&t()}),$("<button></button>").addClass("primary").text(r||i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",()=>{t&&(t(!!s||l.val()),c.gDialog("close"))})]}),c.gDialog("open",!0),c.find("input:first-child").focus().select()}static alert(e,t){let{closeByEnter:n=!0,className:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var a,s=$("<div></div>").append($("<div></div>").addClass("message").html(e));const l=()=>{n&&document.removeEventListener("keypress",a,!0),s.gDialog("close"),t&&t()};return a=e=>{o.GKey.translateKey(e.keyCode)===o.GKey.Constant.ENTER&&s.gDialog("isOpen")&&(e.preventDefault(),e.stopImmediatePropagation(),l())},s.gDialog({releaseOnClose:!0,className:"g-system-dialog g-alert-dialog"+(r?" "+r:""),buttons:[$("<button></button>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",()=>l())]}),s.gDialog("open",!1),n&&document.addEventListener("keypress",a,!0),s}static showOneTimeDialog(e,t){return gContainer.getProperty(t).then(n=>{if(!n){var o=$("<div></div>").append($("<div></div>").addClass("message").html(e));return o.gDialog({releaseOnClose:!0,className:"g-system-dialog g-onetime-dialog",buttons:[$("<button></button>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",()=>{o.gDialog("close")})]}),o.closest(".g-dialog").find(".g-dialog-footer").prepend($("<label></label>").append([$("<input>").attr("type","checkbox").on("change",(function(){this.checked?gContainer.setProperty(t,!0):gContainer.setProperty(t,!1)})),$("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.do-not-show-again")))])),o.gDialog("open",!1),o}})}static showCDRWarning(){return gDesigner.getSetting("disable_cdr_warning",!1)?Promise.resolve():this.info({className:"g-cdr-warning",setting:"disable_cdr_warning",title:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-warning-title")),label:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-warning-label")),message:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-warning-message"))})}static showCDRUnsupportedObjectWarning(e){if(!this.isDialogOpen(".g-system-dialog.g-dialog-v1")&&!gDesigner.getSetting("disable_cdr_unsupported_effect",!1)){const t=e instanceof i.GStylable.Effect?i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-object-warning-effect-name")).replace("%name",e.getNodeNameTranslated()):i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-object-warning-generic-name"));return this.info({setting:"disable_cdr_unsupported_effect",title:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-warning-title")),label:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-label")),message:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-object-warning-message")).replace("%name",t)})}return Promise.resolve()}static showCDRUnsupportedObjectsWarning(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return gDesigner.getSetting("disable_cdr_unsupported_effects",!1)?Promise.resolve(gDesigner.getSetting("default_cdr_unsupported_effects",1)):(gDesigner.stats("unsupported-dialog_open"),this.warning({setting:"disable_cdr_unsupported_effects",title:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-title")),label:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-label")),message:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-message")),options:{setting:"default_cdr_unsupported_effects",values:[i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-0")),i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-1")),i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-2")),i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-3"))],tooltips:[i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-0-tooltip")),i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-1-tooltip")),"",i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-option-3-tooltip"))],onClick:()=>{gDesigner.stats("unsupported-dialog_click_option")}},details:{label:i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.cdr-unsupported-objects-warning-details-label")),onClick:()=>{gDesigner.stats("unsupported-dialog_click_details")},items:e},onCancel:()=>{gDesigner.stats("unsupported-dialog_click_cancel")},onSubmit:()=>{gDesigner.stats("unsupported-dialog_click_submit")}}).then(e=>(gDesigner.setSetting("default_cdr_unsupported_effects",e),e)))}static warning(e){return this._dialogV1(Object.assign({icon:"assets/icon/dialog/warning.svg",buttons:[$("<button/>").text(i.GLocale.get(new i.GLocaleKey("GLocale","cancel"))).attr("data-title",i.GLocale.get(new i.GLocaleKey("GFilesPanel","action.cancel-tooltip"))).on("click",t=>{e.onCancel&&e.onCancel.call(this),$(t.target).closest(".g-dialog-content").gDialog("close",!0)}),$("<button/>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",t=>{e.onSubmit&&e.onSubmit.call(this),$(t.target).closest(".g-dialog-content").gDialog("close")})]},e||{}))}static info(e){return this._dialogV1(Object.assign({icon:"assets/icon/dialog/info.svg",buttons:[$("<button/>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",e=>$(e.target).closest(".g-dialog-content").gDialog("close"))]},e||{}))}static isDialogOpen(e){return $(e).length>0}static _dialogV1(){let{title:e="",label:t="",message:n="",icon:o="assets/icon/dialog/info.svg",closeable:r=!0,buttons:a=[],details:s,options:l,setting:c,className:d=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const u={},p=new Promise((e,t)=>Object.assign(u,{resolve:e,reject:t})),g=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-system-dialog g-dialog-v1 "+d,closeCallback:e=>{e?u.reject():(c&&gDesigner.setSetting(c,g.find('input[data-property="'.concat(c,'"]')).is(":checked")),l?u.resolve(parseInt(g.find('input[name="options"]:checked').val())||0):u.resolve())}}),h=$("<header></header>").append($("<span/>").addClass("title").text(e)).appendTo(g);return r&&h.append($("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>g.gDialog("close",!0))),$("<main></main>").append($("<img/>").attr("src",o).css("display",o?"":"none")).append($("<div/>").addClass("container").append($("<div/>").addClass("content").append($("<span/>").addClass("label").text(t)).append($("<pre/>").addClass("message").text(n)).append(s?$("<div/>").addClass("details").append($("<label/>").append($("<span/>").text(s.label)).append($("<span/>").addClass("gravit-icon-down icon")).on("click",e=>{s.onClick&&s.onClick.call(this);const t=$(e.target).closest(".details");t.find(".panel").toggleClass("collapsed"),t.find(".icon").toggleClass("gravit-icon-down gravit-icon-up")})).append($("<div/>").addClass("panel collapsed").append($("<ul/>").append(s.items.map(e=>$("<li/>").append($("<span/>").text(e)))))):"").append(l?$("<div/>").addClass("options").append(l.values.map((e,t)=>{let n=$("<label/>").append($("<input/>").attr("type","radio").attr("name","options").attr("value",t).prop("checked",e=>e===(l.setting?gDesigner.getSetting(l.setting,0):0)).on("change",()=>{l.onClick&&l.onClick.call(this)})).append($("<span/>").text(e));return l.tooltips&&l.tooltips[t]&&n.append($("<span/>").addClass("tooltip").text("?").attr("data-title",l.tooltips[t])),n})):"")).append($("<footer/>").append(c?$("<label/>").append($("<input>").attr("type","checkbox").attr("data-property",c)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.do-not-show-again")))):"").append(a.length?$("<div/>").addClass("buttons").append(a):""))).appendTo(g),g.gDialog("open",r),p}static messageWithInfo(e){let{mainMessage:t,infoMessage:n}=e;const o=$("<div />").gDialog({releaseOnClose:!0,className:"g-system-dialog g-message-with-info-dialog",buttons:[$("<button/>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",()=>o.gDialog("close"))]}),r=$("<div />").addClass("content").appendTo(o);return t&&r.append($("<div />").addClass("main-message").html(t)),n&&r.append($("<div />").addClass("info-message").append($("<div />").addClass("info-message-icon").append($("<img/>").attr("src","assets/icon/dialog/info.svg"))).append($("<div />").addClass("info-message-content").html(n))),o.gDialog("open",!0)}static custom(e){let{title:t="",subtitle:n="",styles:o={},footer:r,icon:a,buttons:s=[],openCallback:l,closeCallback:c,closeable:d=!0,className:u="",dontShowAgainCb:p}=e;var g=[];const h=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-system-dialog g-custom-dialog ".concat(u),closeCallback:e=>{g.length&&(g.forEach(e=>Mousetrap.unbind(e)),g=[]),c&&c(e)},openCallback:l});o.dialog&&h.css(o.dialog),d&&$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>h.gDialog("close")).appendTo(h),a&&$("<div></div>").addClass("icon").append($("<div></div>").addClass(a)).appendTo(h);let f=$("<div></div>").addClass("content").append($("<span></span>").addClass("title").html(t)).append($("<span></span>").addClass("subtitle").html(n)).appendTo(h);if(r&&f.append($("<span></span>").addClass("footer").html(r)),s&&s.length){var m=$("<div></div>").addClass("buttons");p&&m.prepend($("<label></label>").append([$("<input>").attr("type","checkbox").on("change",(function(){p(this.checked)})),$("<span></span>").addClass("dont-show-this-again-message").text(i.GLocale.get(new i.GLocaleKey("GSystemDialog","text.do-not-show-again")))])),m.append(s.map(e=>{let{label:t,onclick:n,highlighted:i,className:o,position:r,shortcut:a,closeOnClick:s=!1}=e;var l=!1,c=()=>{l||(l=!0,a&&(Mousetrap.unbind(a),g.splice(g.indexOf(a),1)),g.length&&(g.forEach(e=>Mousetrap.unbind(e)),g=[]),s&&h.gDialog("close"),n&&n(h))},d=$("<button></button>").append($("<span></span>").text(t)).addClass("g-pro-button "+(i?"highlighted":"")).on("click",()=>c());return a&&(Mousetrap.bind(a,c),g.push(a)),o&&(o=o instanceof Array?o:[o],o.forEach(e=>d.addClass(e))),r&&d.css("float",r),d})),o.buttons&&m.css(o.buttons),m.appendTo(f)}return h.gDialog("open",d),h}static advanced(e){let{title:t="",buttons:n=[],closeCallback:i,closeable:o=!0}=e;var r=[],a=$("<div></div>").append($("<div></div>").addClass("message").html(t));return a.gDialog({releaseOnClose:!0,className:"g-system-dialog g-advanced-dialog",closeCallback:e=>{r.length&&(r.forEach(e=>Mousetrap.unbind(e)),r=[]),i&&i(e)},buttons:n.map(e=>{let{label:t,onclick:n,highlighted:i,className:o,position:s,shortcut:l,closeOnClick:c=!1}=e;var d=!1,u=()=>{d||(d=!0,l&&(Mousetrap.unbind(l),r.splice(r.indexOf(l),1)),r.length&&(r.forEach(e=>Mousetrap.unbind(e)),r=[]),n(a),c&&a.gDialog("close",!1))},p=$("<button></button>").append($("<span></span>").text(t)).addClass(i?"primary":"").on("click",()=>u());return l&&(Mousetrap.bind(l,u),r.push(l)),o&&(o=o instanceof Array?o:[o],o.forEach(e=>p.addClass(e))),s&&p.css("float",s),p})}),a.gDialog("open",o),a}toString(){return"[Object GSystemDialog]"}}r.Shortcut={Esc:"esc",Enter:"enter"},e.exports=r},,function(e,t,n){var i=n(6),o=n(267),r=n(59),a=n(270),s=n(357),l=n(356),c=o("wks"),d=i.Symbol,u=d&&d.for,p=l?d:d&&d.withoutSetter||a;e.exports=function(e){if(!r(c,e)||!s&&"string"!=typeof c[e]){var t="Symbol."+e;s&&r(d,e)?c[e]=d[e]:c[e]=l&&u?u(t):p(t)}return c[e]}},,,,,,,function(e,t,n){var i=n(47),o=n(619);i({global:!0,forced:parseInt!=o},{parseInt:o})},function(e,t,n){var i;e.exports=(i=i||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},r=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,o=e.sigBytes;if(this.clamp(),i%4)for(var r=0;r<o;r++){var a=n[r>>>2]>>>24-r%4*8&255;t[i+r>>>2]|=a<<24-(i+r)%4*8}else for(r=0;r<o;r+=4)t[i+r>>>2]=n[r>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],o=function(t){t=t;var n=987654321,i=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},r=0;r<t;r+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),i.push(4294967296*s()|0)}return new a.init(i,t)}}),s=i.enc={},l=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var r=t[o>>>2]>>>24-o%4*8&255;i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o++){var r=t[o>>>2]>>>24-o%4*8&255;i.push(String.fromCharCode(r))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new a.init(n,t)}},d=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=o.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,o=n.sigBytes,r=this.blockSize,s=o/(4*r),l=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*r,c=e.min(4*l,o);if(l){for(var d=0;d<l;d+=r)this._doProcessBlock(i,d);var u=i.splice(0,l);n.sigBytes-=c}return new a.init(u,c)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=u.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),i)},function(e,t,n){var i=n(6),o=n(174).f,r=n(89),a=n(80),s=n(269),l=n(405),c=n(310);e.exports=function(e,t){var n,d,u,p,g,h=e.target,f=e.global,m=e.stat;if(n=f?i:m?i[h]||s(h,{}):(i[h]||{}).prototype)for(d in t){if(p=t[d],u=e.noTargetGet?(g=o(n,d))&&g.value:n[d],!c(f?d:h+(m?".":"#")+d,e.forced)&&void 0!==u){if(typeof p==typeof u)continue;l(p,u)}(e.sham||u&&u.sham)&&r(p,"sham",!0),a(n,d,p,e)}}},,function(e,t){var n=Function.prototype.call;e.exports=n.bind?n.bind(n):function(){return n.apply(n,arguments)}},,,function(e,t,n){var i=n(6),o=n(62),r=i.String,a=i.TypeError;e.exports=function(e){if(o(e))return e;throw a(r(e)+" is not an object")}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TOOLTIP_AREA=t.GRichTooltipConfig=void 0,n(262),n(3);const i=function(e){let{title:t,description:n,video:i,pic:o,isPro:r,middle:a,shortcut:s,videoTimeout:l,marginLeft:c,side:d,learnMore:u,upgradeToProStatsValue:p,forceShow:g,flipHorizontal:h}=e;if(!t)throw new Error("");this._title=t,this._description=n,this._video=i,this._pic=o,this._isPro=r,this._middle=a,this._marginLeft=c,this._shortcut=s,this._videoTimeout=l,this._side=d,this._learnMore=u,this._upgradeToProStatsValue=p,this._forceShow=g,this._flipHorizontal=h};t.GRichTooltipConfig=i,i.from=function(e){return new i(e)},i.prototype._title=null,i.prototype._description=null,i.prototype._video=null,i.prototype._pic=null,i.prototype._isPro=null,i.prototype._middle=null,i.prototype._marginLeft=null,i.prototype._shortcut=null,i.prototype._videoTimeout=null,i.prototype._side=null,i.prototype._learnMore=null,i.prototype._upgradeToProStatsValue=null,i.prototype._forceShow=!1,i.prototype._flipHorizontal=!1,i.prototype.setConfig=function(e){let{title:t,description:n,video:i,pic:o,isPro:r,middle:a,shortcut:s,videoTimeout:l,marginLeft:c,side:d,learnMore:u,upgradeToProStatsValue:p}=e;if(void 0!==t&&(this._title=t),!this._title)throw new Error("");return void 0!==n&&(this._description=n),void 0!==i&&(this._video=i),void 0!==o&&(this._pic=o),void 0!==r&&(this._isPro=r),void 0!==a&&(this._middle=a),void 0!==s&&(this._shortcut=s),void 0!==l&&(this._videoTimeout=l),void 0!==c&&(this._marginLeft=c),void 0!==d&&(this._side=d),void 0!==u&&(this._learnMore=u),void 0!==p&&(this._upgradeToProStatsValue=p),this},i.prototype.getConfig=function(){return{title:this._title,description:this._description,video:this._video,pic:this._pic,isPro:this._isPro,middle:this._middle,marginLeft:this._marginLeft,shortcut:this._shortcut,videoTimeout:this._videoTimeout,side:this._side,learnMore:this._learnMore,upgradeToProStatsValue:this._upgradeToProStatsValue,forceShow:this._forceShow,flipHorizontal:this._flipHorizontal}},i.prototype.toString=function(){return"[Object GRichTooltipConfig]"};t.TOOLTIP_AREA={TOOLBAR:"TOOLBAR",SIDEBAR:"SIDEBAR",MAIN_MENU:{TRY_PRO_COMMON:"TRY_PRO_COMMON",TRY_EXP_PDF_ADVANCED_SETTING:"TRY_EXP_PDF_ADVANCED_SETTING"}};var o=i;t.default=o},function(e,t,n){var i=n(6),o=n(156),r=i.String;e.exports=function(e){if("Symbol"===o(e))throw TypeError("Cannot convert a Symbol value to a string");return r(e)}},function(e,t,n){"use strict";var i=n(47),o=n(22),r=n(325),a=n(95),s=n(57),l=n(326),c=o("".indexOf);i({target:"String",proto:!0,forced:!l("includes")},{includes:function(e){return!!~c(s(a(this)),s(r(e)),arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var i=n(22),o=n(97),r=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return r(o(e),t)}},,,function(e,t,n){var i=n(34);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},function(e,t,n){"use strict";var i=n(184),o=n(49),r=n(22),a=n(250),s=n(311),l=n(52),c=n(95),d=n(223),u=n(279),p=n(104),g=n(57),h=n(145),f=n(157),m=n(251),y=n(226),v=n(315),_=n(27),b=v.UNSUPPORTED_Y,w=Math.min,C=[].push,E=r(/./.exec),S=r(C),G=r("".slice);a("split",(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=g(c(this)),a=void 0===n?4294967295:n>>>0;if(0===a)return[];if(void 0===e)return[r];if(!s(e))return o(t,r,e,a);for(var l,d,u,p=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),m=0,v=new RegExp(e.source,h+"g");(l=o(y,v,r))&&!((d=v.lastIndex)>m&&(S(p,G(r,m,l.index)),l.length>1&&l.index<r.length&&i(C,p,f(l,1)),u=l[0].length,m=d,p.length>=a));)v.lastIndex===l.index&&v.lastIndex++;return m===r.length?!u&&E(v,"")||S(p,""):S(p,G(r,m)),p.length>a?f(p,0,a):p}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:o(t,this,e,n)}:t,[function(t,n){var i=c(this),a=null==t?void 0:h(t,e);return a?o(a,t,i,n):o(r,g(i),t,n)},function(e,i){var o=l(this),a=g(e),s=n(r,o,a,i,r!==t);if(s.done)return s.value;var c=d(o,RegExp),h=o.unicode,f=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(b?"g":"y"),y=new c(b?"^(?:"+o.source+")":o,f),v=void 0===i?4294967295:i>>>0;if(0===v)return[];if(0===a.length)return null===m(y,a)?[a]:[];for(var _=0,C=0,E=[];C<a.length;){y.lastIndex=b?0:C;var A,T=m(y,b?G(a,C):a);if(null===T||(A=w(p(y.lastIndex+(b?C:0)),a.length))===_)C=u(a,C,h);else{if(S(E,G(a,_,C)),E.length===v)return E;for(var P=1;P<=T.length-1;P++)if(S(E,T[P]),E.length===v)return E;C=_=A}}return S(E,G(a,_)),E}]}),!!_((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]})),b)},,,,function(e,t,n){var i=n(27);e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},,,,,,function(e,t,n){var i=n(6),o=n(67),r=n(358),a=n(52),s=n(219),l=i.TypeError,c=Object.defineProperty;t.f=o?c:function(e,t,n){if(a(e),t=s(t),a(n),r)try{return c(e,t,n)}catch(e){}if("get"in n||"set"in n)throw l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},,,function(e,t,n){"use strict";var i=n(17);n(19),n(24),n(9),n(83),n(111),n(90),n(171),n(58),n(14),n(63),n(3);var o=n(1),r=n(936),a=n(12),s=i(n(648)),l=n(230),c=n(531),d=n(18),u=n(751),p=n(232),g=n(192),h=n(36),f=n(78);function m(){}o.GObject.inherit(m,o.GEventTarget),m.OpenFileRequest=function(e,t){this._type=e,this._content=t},m.OpenFileRequest.prototype.getType=function(){return this._type},m.OpenFileRequest.prototype.getContent=function(){return this._content},m.OpenFileRequest.Type={Document:"document",Token:"token",DocumentOrToken:"documentOrToken",StoreContent:"storeContent",ExternalAsset:"externalAsset",Template:"template",Preset:"preset",MSTeamsDeepLink:"msteamsdeeplink"},m.DeepLinking={ProCoupon:"procoupon",PurchaseFlow:"purchase_flow",PurchaseFlowNew:"purchase_flow_new",Purchase:"purchase",ResetPassword:a.PasswordlessAuthenticationActions.ResetPassword,SetPassword:a.PasswordlessAuthenticationActions.SetPassword,PasswordlessToken:a.PasswordlessAuthenticationActions.PasswordlessToken,ConfirmEmail:"confirm_email",Account:"account",Purchases:"purchases",EnterpriseLogIn:"enterprise",DirectLink:"directlink",ResetTrial:"reset_trial",PWADialog:"pwainstall",FocusAnnot:"annot",CreateShare:"create_share",ActivateTrial:"activate_trial"},m.Runtime={Browser:"browser",Chrome:"chrome",WebWorker:"webworker",Phonegap:"phonegap",Electron:"electron",PWA:"pwa",IPad:"ipad"},m.GravitLanguages=[...o.GLocale.getAvailableLanguages()],m.prototype._recentDocuments=null,m.prototype._deepLinking=null,m.prototype.getRuntime=function(){throw new Error("Not implemented.")},m.prototype.getStorage=function(){throw new Error("Not implemented.")},m.prototype.getRootPath=function(){return""},m.prototype.registerFontProviders=function(){l.registerProvider(c)},m.prototype.getSystemFontsProvider=function(){return null},m.prototype.supportsLocalFonts=function(){return!1},m.prototype.getProperty=function(e){return new Promise(t=>{var n=window.localStorage.getItem(e)||null;t(n?JSON.parse(n):null)})},m.prototype.setProperty=function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},m.prototype.removeProperty=function(e){window.localStorage.removeItem(e)},m.prototype.getPropertyKeyByIndex=function(e){return window.localStorage.key(e)},m.prototype.getStorageLength=function(){return window.localStorage.length},m.prototype.setCookie=function(e){let{name:t,value:n}=e;return navigator.cookieEnabled?(document.cookie="".concat(t,"=").concat(n,"; path=/"),document.cookie="".concat(t,"=").concat(n,"; path=/; domain=").concat(a.DOMAIN),Promise.resolve()):Promise.reject()},m.prototype.handleDeepLinking=function(e){const t=new URL(e||window.location.href).searchParams,n=Object.keys(m.DeepLinking).find(e=>t.has(m.DeepLinking[e]));if(n){const e={link:m.DeepLinking[n],options:Array.from(t.entries()).reduce((e,t)=>(e[t[0]]=t[1],e),{})};return this._deepLinking=e,this._deepLinking}return null},m.prototype.shouldBypassEmailVerification=function(){return this._deepLinking&&this._deepLinking.link===m.DeepLinking.DirectLink},m.prototype.init=function(e){return window.gDesigner&&gDesigner.addEventListener(f,this._documentEvent,this),e(this)},m.prototype._documentEvent=function(e){e.type!==f.Type.Activated&&e.type!==f.Type.StorageItemUpdated||this._updateClientAPI(e.document)},m.prototype._updateClientAPI=function(e){const t=e&&e.getToken();if(t){const n=gDesigner.getActiveDocument();(!n||e===n)&&a.gApi.setToken({token:t})}},m.prototype.start=function(){},m.prototype.preLogin=async function(){},m.prototype.signWithMagicLink=function(e,t,n){return a.gApi.magicLink.authenticate(e,t,n)},m.prototype.canUnload=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var i=!e&&!t;return n?Promise.resolve(i):i},m.prototype.openExternalLink=function(){},m.prototype.copyToClipboard=function(){return Promise.resolve()},m.prototype.initLanguage=function(e,t){const n=()=>this.getProperty("designer.settings").then(e=>{if(e&&e.hasOwnProperty("language")){const t=e.language;if(m.GravitLanguages.indexOf(t)>=0)o.GLocale.setLanguage(t),a.gApi.setLanguage(t);else{let e=o.GSystem.language&&o.GLocale.lookupLanguage(o.GSystem.language);e&&m.GravitLanguages.includes(e)?(o.GLocale.setLanguage(e),a.GLocaleFactory.setLanguage(e),a.gApi.setLanguage(e)):(o.GLocale.setLanguage(o.GLocaleLanguage.English),a.GLocaleFactory.setLanguage(o.GLocaleLanguage.English),a.gApi.setLanguage(o.GLocaleLanguage.English))}}});if(t)return new Promise(async o=>{try{i(t),e&&e(),o()}catch(t){await n(),e&&e(),o()}});function i(e){const t=o.GLocale.lookupLanguage(e);null!==t&&(m.GravitLanguages.indexOf(t)>=0?("undefined"!=typeof gDesigner&&gDesigner.setSetting("language",t),o.GLocale.setLanguage(t),a.GLocaleFactory.setLanguage(t),a.gApi.setLanguage(t)):(o.GLocale.setLanguage(o.GLocaleLanguage.English),a.GLocaleFactory.setLanguage(o.GLocaleLanguage.English),a.gApi.setLanguage(o.GLocaleLanguage.English)))}a.gApi.getUser().then(async t=>{t&&!t.anonymous?i(t.locale):await n(),e&&e()}).catch(async()=>{await n(),e&&e()})},m.prototype.newDocumentActionPerformed=function(e){e&&e()},m.prototype.getRecentDocuments=function(){return this._recentDocuments||[]},m.prototype.updateRecentDocumentsAction=function(e){var t;this._recentDocuments=e;const n=gDesigner.getMainMenu();if(n){const e=t=n.findItem(o.GLocale.get(d.CATEGORY_FILE.label));if(e&&e.getMenu()){const n=e.getMenu().findItem(o.GLocale.get(d.CATEGORY_FILE_OPEN_RECENT.label).split("/")[1]);n&&(t=n.getMenu())}}if(t)if(t.clearItems(),e.length>0)for(var i=e[0]instanceof this._storage.constructor.Item,r=0;r<e.length;++r){let n=e[r];n instanceof this._storage.constructor.Item||!i||(gDesigner.addMenuSeparator(t),i=!1);const o=this.getRecentDocumentIconClass(n),a=n.getName()+"."+n.getExtension().toLowerCase();gDesigner.addMenuItem(t,a,o,null,null,(function(){try{gDesigner.openDocument(n)}catch(e){if(!(e instanceof s.default))throw e;h.externalFileError(!0)}}))}else{var a=gDesigner.addMenuItem(t);gDesigner.updateMenuItem(a,o.GLocale.get(u.TITLE),!1,!1)}},m.prototype.getRecentDocumentIconClass=function(e){return e instanceof this._storage.constructor.Item?null:"[Object GGoogleDriveStorage.Item]"===e.toString()?"gravit-icon-googledrive-logo":"[Object GSharePointStorage.Item]"===e.toString()?"gravit-icon-sharepoint-logo":"[Object GOneDriveBusinessStorage.Item]"===e.toString()?"gravit-icon-onedrivebusiness-logo":p["gravit-icon-cloud-logo"]},m.prototype.triggerClose=function(){},m.prototype.getGoogleAPI=function(){return r.GDefaultGoogleAPI},m.prototype.signWithOAuth=function(e){return new Promise((t,n)=>{a.gApi.popup("/auth/"+e).then(e=>{e?t(e):n()}).catch(e=>{let t;"string"==typeof e&&(t=e),!t&&e&&e.message&&(t=e.message),!t&&e&&e.errors&&(t=e.errors.toString()),!t&&e&&(t=e),n(t)})})},m.prototype.isMemoryInfoAvailable=function(){return!1},m.prototype.getMemoryInfo=function(){return null},m.prototype._getJsHeapLimitSize=function(){return window.performance.memory?window.performance.memory.jsHeapSizeLimit:a.JS_HEAP_SIZE_LIMIT_POYFILL},m.prototype._estimatingMemoryUsage=function(){return gDesigner.getDocuments().reduce((e,t)=>e+(t&&t.getStorageItem())?t.getStorageItem().documentRealFileSize:0,0)*a.FILE_SIZE_TO_RAM_COEFFCIENT+a.MIN_JS_HEAP_SIZE},m.prototype.verifyEnoughMemoryToSave=function(e){try{if(e&&e.getStorageItem()){var t=this._estimatingMemoryUsage(),n=this._getJsHeapLimitSize()-(t+=e.getStorageItem().documentRealFileSize*a.FILE_SIZE_TO_SAVING_RAM_COEFFCIENT);if(2*e.getStorageItem().documentRealFileSize>n){var i=o.GLocale.get(new o.GLocaleKey("GContainer","text.not-memary-enough"));new g(i).open()}}}catch(e){console.error(e)}},m.prototype.minimizeWindow=function(){},m.prototype.maximizeWindow=function(){},m.prototype.closeWindow=function(){},m.prototype.getStorageDestinations=function(){return[]},m.prototype.getDefaultStorageDestination=function(e){const t=this.getStorageDestinations();return t?t.find(t=>t.isSupported(e)):null},m.prototype.getSharepointAuthenticator=function(){return null},m.prototype.toString=function(){return"[Object GContainer]"},e.exports=m},function(e,t,n){"use strict";e.exports={Init:0,Ready:1,Loading:10,LoadFailed:11,Loaded:12,LoadCancelled:13,Saving:20,SaveFailed:21,Saved:22,Syncing:30,SyncFailed:31,SaveCancelled:32,Downloading:40,DownloadFailed:41,Downloaded:42,DownloadCancelled:43,Locked:50,Unlocked:51}},function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t,n){this.type=e,this.document=t,n&&(this.data=n)}i.GObject.inherit(o,i.GEvent),o.Type={Added:0,Removed:1,Deactivated:10,Activated:11,StorageItemUpdated:12,Modified:23,SynchronismUpdated:30,SynchronismUpdateFailed:31,OwnerUpdated:40,CloudSynchronismUpdated:50,UpdateAvailable:60,BeforeReload:70,AutoSaveSynchronizing:80,AutoSaveSynchronized:81,AutoSaveSynchronizationFailed:82,ContextMenuOpened:90},o.prototype.type=null,o.prototype.document=null,o.prototype.toString=function(){return"[Object GDocumentEvent]"},e.exports=o},,function(e,t,n){var i=n(6),o=n(34),r=n(59),a=n(89),s=n(269),l=n(221),c=n(99),d=n(180).CONFIGURABLE,u=c.get,p=c.enforce,g=String(String).split("String");(e.exports=function(e,t,n,l){var c,u=!!l&&!!l.unsafe,h=!!l&&!!l.enumerable,f=!!l&&!!l.noTargetGet,m=l&&void 0!==l.name?l.name:t;o(n)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!r(n,"name")||d&&n.name!==m)&&a(n,"name",m),(c=p(n)).source||(c.source=g.join("string"==typeof m?m:""))),e!==i?(u?!f&&e[t]&&(h=!0):delete e[t],h?e[t]=n:a(e,t,n)):h?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return o(this)&&u(this).source||l(this)}))},,,function(e,t,n){var i=n(47),o=n(6),r=n(96),a=n(184),s=n(22),l=n(27),c=o.Array,d=r("JSON","stringify"),u=s(/./.exec),p=s("".charAt),g=s("".charCodeAt),h=s("".replace),f=s(1..toString),m=/[\uD800-\uDFFF]/g,y=/^[\uD800-\uDBFF]$/,v=/^[\uDC00-\uDFFF]$/,_=function(e,t,n){var i=p(n,t-1),o=p(n,t+1);return u(y,e)&&!u(v,o)||u(v,e)&&!u(y,i)?"\\u"+f(g(e,0),16):e},b=l((function(){return'"\\udf06\\ud834"'!==d("\udf06\ud834")||'"\\udead"'!==d("\udead")}));d&&i({target:"JSON",stat:!0,forced:b},{stringify:function(e,t,n){for(var i=0,o=arguments.length,r=c(o);i<o;i++)r[i]=arguments[i];var s=a(d,null,r);return"string"==typeof s?h(s,m,_):s}})},function(e,t,n){"use strict";var i=n(47),o=n(236).trim;i({target:"String",proto:!0,forced:n(414)("trim")},{trim:function(){return o(this)}})},function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)o(n,i)&&(e[i]=n[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),o);else for(var r=0;r<i;r++)e[o+r]=t[n+r]},flattenChunks:function(e){var t,n,i,o,r,a;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(a=new Uint8Array(i),o=0,t=0,n=e.length;t<n;t++)r=e[t],a.set(r,o),o+=r.length;return a}},a={arraySet:function(e,t,n,i,o){for(var r=0;r<i;r++)e[o+r]=t[n+r]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,r)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,a))},t.setTyped(i)},,function(e,t,n){var i,o,r,a,s,l,c,d,u,p,g,h,f,m,y,v,_,b,w;e.exports=(i=n(46),n(213),void(i.lib.Cipher||(o=i,r=o.lib,a=r.Base,s=r.WordArray,l=r.BufferedBlockAlgorithm,c=o.enc,c.Utf8,d=c.Base64,u=o.algo.EvpKDF,p=r.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?w:_}return function(t){return{encrypt:function(n,i,o){return e(i).encrypt(t,n,i,o)},decrypt:function(n,i,o){return e(i).decrypt(t,n,i,o)}}}}()}),r.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),g=o.mode={},h=r.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=g.CBC=function(){var e=h.extend();function t(e,t,n){var i=this._iv;if(i){var o=i;this._iv=void 0}else o=this._prevBlock;for(var r=0;r<n;r++)e[t+r]^=o[r]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o),i.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,r=e.slice(n,n+o);i.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=r}}),e}(),m=(o.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,i=n-e.sigBytes%n,o=i<<24|i<<16|i<<8|i,r=[],a=0;a<i;a+=4)r.push(o);var l=s.create(r,i);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},r.BlockCipher=p.extend({cfg:p.cfg.extend({mode:f,padding:m}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=n.createEncryptor;else i=n.createDecryptor,this._minBufferSize=1;this._mode&&this._mode.__creator==i?this._mode.init(this,t&&t.words):(this._mode=i.call(n,this,t&&t.words),this._mode.__creator=i)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4}),y=r.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(o.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var i=s.create([1398893684,1701076831]).concat(n).concat(t);else i=t;return i.toString(d)},parse:function(e){var t=d.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var i=s.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return y.create({ciphertext:t,salt:i})}},_=r.SerializableCipher=a.extend({cfg:a.extend({format:v}),encrypt:function(e,t,n,i){i=this.cfg.extend(i);var o=e.createEncryptor(n,i),r=o.finalize(t),a=o.cfg;return y.create({ciphertext:r,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:i.format})},decrypt:function(e,t,n,i){return i=this.cfg.extend(i),t=this._parse(t,i.format),e.createDecryptor(n,i).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),b=(o.kdf={}).OpenSSL={execute:function(e,t,n,i){i||(i=s.random(8));var o=u.create({keySize:t+n}).compute(e,i),r=s.create(o.words.slice(t),4*n);return o.sigBytes=4*t,y.create({key:o,iv:r,salt:i})}},w=r.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:b}),encrypt:function(e,t,n,i){var o=(i=this.cfg.extend(i)).kdf.execute(n,e.keySize,e.ivSize);i.iv=o.iv;var r=_.encrypt.call(this,e,t,o.key,i);return r.mixIn(o),r},decrypt:function(e,t,n,i){i=this.cfg.extend(i),t=this._parse(t,i.format);var o=i.kdf.execute(n,e.keySize,e.ivSize,t.salt);return i.iv=o.iv,_.decrypt.call(this,e,t,o.key,i)}}))))},,function(e,t,n){var i=n(67),o=n(73),r=n(152);e.exports=i?function(e,t,n){return o.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";n(19);var i=n(47),o=n(6),r=n(96),a=n(49),s=n(22),l=n(383),c=n(80),d=n(275),u=n(155),p=n(379),g=n(99),h=n(181),f=n(34),m=n(59),y=n(110),v=n(156),_=n(52),b=n(62),w=n(57),C=n(159),E=n(152),S=n(222),G=n(183),A=n(38),T=n(314),P=A("iterator"),L=g.set,D=g.getterFor("URLSearchParams"),x=g.getterFor("URLSearchParamsIterator"),I=r("fetch"),O=r("Request"),k=r("Headers"),F=O&&O.prototype,R=k&&k.prototype,M=o.RegExp,N=o.TypeError,B=o.decodeURIComponent,$=o.encodeURIComponent,U=s("".charAt),K=s([].join),j=s([].push),H=s("".replace),V=s([].shift),z=s([].splice),W=s("".split),q=s("".slice),Y=/\+/g,X=Array(4),Q=function(e){return X[e-1]||(X[e-1]=M("((?:%[\\da-f]{2}){"+e+"})","gi"))},Z=function(e){try{return B(e)}catch(t){return e}},J=function(e){var t=H(e,Y," "),n=4;try{return B(t)}catch(e){for(;n;)t=H(t,Q(n--),Z);return t}},ee=/[!'()~]|%20/g,te={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ne=function(e){return te[e]},ie=function(e){return H($(e),ee,ne)},oe=function(e,t){if(t)for(var n,i,o=W(t,"&"),r=0;r<o.length;)(n=o[r++]).length&&(i=W(n,"="),j(e,{key:J(V(i)),value:J(K(i,"="))}))},re=function(e){this.entries.length=0,oe(this.entries,e)},ae=function(e,t){if(e<t)throw N("Not enough arguments")},se=p((function(e,t){L(this,{type:"URLSearchParamsIterator",iterator:S(D(e).entries),kind:t})}),"Iterator",(function(){var e=x(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n})),le=function(){h(this,ce);var e,t,n,i,o,r,s,l,c,d=arguments.length>0?arguments[0]:void 0,u=this,p=[];if(L(u,{type:"URLSearchParams",entries:p,updateURL:function(){},updateSearchParams:re}),void 0!==d)if(b(d))if(e=G(d))for(n=(t=S(d,e)).next;!(i=a(n,t)).done;){if(r=(o=S(_(i.value))).next,(s=a(r,o)).done||(l=a(r,o)).done||!a(r,o).done)throw N("Expected sequence with length 2");j(p,{key:w(s.value),value:w(l.value)})}else for(c in d)m(d,c)&&j(p,{key:c,value:w(d[c])});else oe(p,"string"==typeof d?"?"===U(d,0)?q(d,1):d:w(d))},ce=le.prototype;if(d(ce,{append:function(e,t){ae(arguments.length,2);var n=D(this);j(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){ae(arguments.length,1);for(var t=D(this),n=t.entries,i=w(e),o=0;o<n.length;)n[o].key===i?z(n,o,1):o++;t.updateURL()},get:function(e){ae(arguments.length,1);for(var t=D(this).entries,n=w(e),i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){ae(arguments.length,1);for(var t=D(this).entries,n=w(e),i=[],o=0;o<t.length;o++)t[o].key===n&&j(i,t[o].value);return i},has:function(e){ae(arguments.length,1);for(var t=D(this).entries,n=w(e),i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){ae(arguments.length,1);for(var n,i=D(this),o=i.entries,r=!1,a=w(e),s=w(t),l=0;l<o.length;l++)(n=o[l]).key===a&&(r?z(o,l--,1):(r=!0,n.value=s));r||j(o,{key:a,value:s}),i.updateURL()},sort:function(){var e=D(this);T(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=D(this).entries,i=y(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)i((t=n[o++]).value,t.key,this)},keys:function(){return new se(this,"keys")},values:function(){return new se(this,"values")},entries:function(){return new se(this,"entries")}},{enumerable:!0}),c(ce,P,ce.entries,{name:"entries"}),c(ce,"toString",(function(){for(var e,t=D(this).entries,n=[],i=0;i<t.length;)e=t[i++],j(n,ie(e.key)+"="+ie(e.value));return K(n,"&")}),{enumerable:!0}),u(le,"URLSearchParams"),i({global:!0,forced:!l},{URLSearchParams:le}),!l&&f(k)){var de=s(R.has),ue=s(R.set),pe=function(e){if(b(e)){var t,n=e.body;if("URLSearchParams"===v(n))return t=e.headers?new k(e.headers):new k,de(t,"content-type")||ue(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),C(e,{body:E(0,w(n)),headers:E(0,t)})}return e};if(f(I)&&i({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return I(e,arguments.length>1?pe(arguments[1]):{})}}),f(O)){var ge=function(e){return h(this,F),new O(e,arguments.length>1?pe(arguments[1]):{})};F.constructor=ge,ge.prototype=F,i({global:!0,forced:!0},{Request:ge})}}e.exports={URLSearchParams:le,getState:D}},,,,function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(26)),a=i(n(511)),s=i(n(12));function l(){}o.GObject.inherit(l,r.default),l.prototype.isEnabled=function(){return!s.default||gDesigner.getRightSidebars().getActiveSidebar()!==a.default.ID},l.prototype.toString=function(){return"[Object GElementAction]"},e.exports=l},function(e,t,n){var i=n(6).TypeError;e.exports=function(e){if(null==e)throw i("Can't call method on "+e);return e}},function(e,t,n){var i=n(6),o=n(34),r=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?r(i[e]):i[e]&&i[e][t]}},function(e,t,n){var i=n(6),o=n(95),r=i.Object;e.exports=function(e){return r(o(e))}},,function(e,t,n){var i,o,r,a=n(554),s=n(6),l=n(22),c=n(62),d=n(89),u=n(59),p=n(268),g=n(271),h=n(272),f=s.TypeError,m=s.WeakMap;if(a||p.state){var y=p.state||(p.state=new m),v=l(y.get),_=l(y.has),b=l(y.set);i=function(e,t){if(_(y,e))throw new f("Object already initialized");return t.facade=e,b(y,e,t),t},o=function(e){return v(y,e)||{}},r=function(e){return _(y,e)}}else{var w=g("state");h[w]=!0,i=function(e,t){if(u(e,w))throw new f("Object already initialized");return t.facade=e,d(e,w,t),t},o=function(e){return u(e,w)?e[w]:{}},r=function(e){return u(e,w)}}e.exports={set:i,get:o,has:r,enforce:function(e){return r(e)?o(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw f("Incompatible receiver, "+e+" required");return n}}}},,,,,function(e,t,n){var i=n(114),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n(9),n(14),n(19),n(24),n(129),n(115),n(90),n(111),n(63),n(158),n(201),n(166),n(167),n(29);var i=n(12),o=n(1),r=n(16),a=n(32),s=n(753),l=n(78),c=n(36);const d=n(988);var u=n(76),p=n(192),g=n(323);const h=n(77),f=n(151),m=n(231),y=n(306),v=n(388),_=n(147);var b=i.FILE_FORMATS.find(e=>e.default),w=i.FILE_FORMATS.filter(e=>e.secondary),C=i.FOLDER_FORMAT;const E=n(501),S=10,G=80,A=90,T=100;class P{static convertToCloudItem(e){const t=e=>{let t=!1;e instanceof f&&(t=!0);var n=f.from(e);n.setItemType(f.Type.File),t||n.setPermissions([f.Permission.Open,f.Permission.Copy,f.Permission.Editing,f.Permission.Rename,f.Permission.CutPaste,f.Permission.Delete,f.Permission.Download]),n.autosave?(n.setPreviewURL(n.autosave_url_t),n.setModificationTime(e.autosave_updated)):(n.setPreviewURL(n.url_t||n.url_s),n.setModificationTime(e.updated));const o=i.FILE_FORMATS.find(e=>{const t=n.getMimeType();return!(!t||e.type.toLowerCase()!==t.toLowerCase())||e.ext.toLowerCase()===n.getExtension()});return n.setMimeType(o.type),n.ext=o.ext,n.extension=o.ext,n.storage=f.Storage.Gravit,n};return e instanceof Array?e.map(t):t(e)}static _getAuthorizationToken(){return null}static syncCloudImages(e,t,n,r){return new Promise((l,c)=>{try{var d=e.getScene(),u=d.getDictionary().getEntries(),p=[];d.acceptChildren(e=>{e instanceof o.GImage&&p.push({name:e.getProperty("name"),url:e.getProperty("url")})});const h=P._getAuthorizationToken();var g=i.gApi.url;(0,s.syncImagesToCloud)(e=>(0,s.listFilesFn)(e,h,g),o.GLocale.get(new o.GLocaleKey("GCommonNames","text.untitled-image")),p,u,async(e,t)=>(0,s.createFileAndGetSignedPutUrlsFn)(e,t,g,h),async(e,t,n)=>(0,s.updateFileFn)(e,t,n,g,h,i.COMPUTE_SHA256_FOR_FILES,a.getFileSHA256Digest),e=>{try{var t=d.getDictionary().merge(e);try{var i=o.GNode.serialize(d,o.GUtil.extend({save:!0},n))}finally{d.getDictionary().merge(t)}l([i])}catch(e){c(e)}},t,r)}catch(e){c(e)}})}static resolveImage(e,t){function n(e,t){let n=e.url,i=e.scene;if(i&&i.isReleased())return!1;let a=i&&i.getDictionary()&&i.getDictionary().getEntry(n);return!a||!/^data:.{0,255};base64,/i.exec(a.value)||(a.value.length>r.GPlatform.maxImgDataUrlLength&&new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open(),e.resolved(a.value),!1)}!async function(){let a=e.url,s=e.scene&&e.scene.getDictionary()&&e.scene.getDictionary().getEntry(a);if(n(e))if("string"==typeof a&&a.startsWith("123rf://")){var l=a.slice(8),c="ec23d185aa5ffb6495e02635803bb081";(function(e){var t="https://www.123rfapis.com/?method=download&id="+e;t+="&dl_type=png";const n=Math.floor(Date.now()/1e3);t+="&current_time="+n;var i=function(e,t,n){return v(c+"759561ac90761219f6415da66f18a154"+e+t+n)}(e,"png",n);return t+="&sign="+i,t+="&api_key="+c,new Promise((e,n)=>{var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){if(this.status>=200&&this.status<300){var t=JSON.parse(this.response);e(t.download_url)}else n()},i.send()})})(l).then(n=>{if(n){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="arraybuffer",i.onload=function(){if(this.status<200||this.status>=400)alert("There was a problem downloading requested image");else{var n=new Blob([this.response],{type:"image"});if(n.size>r.GPlatform.maxPngDataSize)new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open();else{var i=new FileReader;i.onload=function(){if(this.result.length>r.GPlatform.maxImgDataUrlLength)return void new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open();let n=e.scene&&e.scene.getDictionary()&&e.scene.getDictionary().getEntry(e.url);n&&t&&(n.cloud=n.value,n.value=this.result),e.resolved(this.result)},i.onerror=function(){new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open()},i.readAsDataURL(n)}}},i.send()}else alert("There was a problem downloading the image selected")},()=>{alert("There was a problem downloading requested image")})}else if(/^(dictionary|gravit|document|asset|magenta)/.test(a)&&(a.startsWith(o.GDictionary.PROTOCOL)&&(a=e.scene&&e.scene.getDictionary()?e.scene.getDictionary().getValue(e.url):null,"string"==typeof a&&a.startsWith(o.GDictionary.CLOUD_PROTOCOL)&&(s=e.scene&&e.scene.getDictionary()&&e.scene.getDictionary().getEntry(e.url))),"string"==typeof a)){const n=await gDesigner.getUser(),o=a.startsWith("magenta"),r=e.scene&&t.getScene()!==e.scene?t.getTempCloudStorageItem():t.getStorageItem();var d=r&&r.getId();if(!n.isAnonymous()&&!d&&t){d=(await i.gApi.createFile({trashed:null})).id,t.setReservedId(d)}const l=a.slice(a.indexOf("://")+3),c=new URLSearchParams(l);let p,g,h=l;if(c.has("id"))h=c.get("id"),p=c.get("width"),g=c.get("height");else if(c.has("url")){const e=new URL(c.get("url")).pathname.slice(1).split("/");h="public"==e[0]?e[2]:e[1]}else h=a.slice(a.indexOf("://")+3);return gDesigner.isAnonymous()&&o?i.gApi.getFile(h).then(n=>{u(n.url,p,g,n=>{s&&t&&(s.cloud=s.value,s.value=n),e.resolved(n)},!0)}):i.gApi.resolveUrls(d,h).then(n=>{u(n[0][1],p,g,n=>{s&&t&&(s.cloud=s.value,s.value=n),e.resolved(n)},o)})}function u(t,i,a,s,l){if(!n(e))return;const c=new Image;c.crossOrigin="Anonymous";i&&(c.width=i),a&&(c.height=a),c.onload=function(){if(!n(e))return void(c.onload=null);const t=document.createElement("CANVAS"),d=t.getContext("2d");l&&([c.width,c.height]=function(e,t,n){const i=e.width/t,o=e.height/n;return i<1||o<1?[e.width,e.height]:i>o?[t,t*e.height/e.width]:[n*e.width/e.height,n]}(c,i||1080,a||1080));let u=!1;(c.width>r.GPlatform.maxImgLinearDimension||c.height>r.GPlatform.maxImgLinearDimension||c.width*c.height>r.GPlatform.maxImgAreaDots)&&(new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open(),u=!0),t.width=c.width,t.height=c.height,d.drawImage(c,0,0,c.width,c.height);var g=t.toDataURL();g.length>r.GPlatform.maxImgDataUrlLength&&!u&&(new p(o.GLocale.get(new o.GLocaleKey("GDocument","text.image-in-design-too-big"))).open(),u=!0),c.onload=null,s(g)},c.src=t}}()}static createFolder(e,t){return new Promise((n,o)=>{var r=this;!async function(){try{var a=r.definePath(t);await i.gApi.createFile({name:e,type:C,parent:a,trashed:!1}),n()}catch(e){o(e)}}()})}static definePath(e){return e?e.id:null}static fileExists(e){return i.gApi.getFile(e).then(()=>!0).catch(e=>{if(e.status===i.HTTP_STATUS_CODES.NOT_FOUND)return!1;throw e})}static changePathTree(e,t){return new Promise((n,o)=>{!async function(){try{for(var r=0;r<e.length;++r){var a=e[r],s=a.parent;t!==s&&a.id!==t&&await i.gApi.updateFile(a.id,{parent:t})}n()}catch(e){o(e)}}()})}static performSignup(){return this.performLogin(d.Forms.SignUp)}static performLogin(e){return new Promise((t,n)=>{try{const n=()=>{new d(e=>{gDesigner.getUser(),t(e)},e).open()};gDesigner.getUser().then(e=>{!e||gDesigner.isAnonymous()?n():t(e)}).catch(()=>{n()})}catch(e){n(e)}})}static createFile(e,t){!async function(){var n=null;let o=e.getScene().getActivePage().getGeometryBBox(),r=0,a=0;o&&(r=o.getWidth(),a=o.getHeight());const s={name:e.getTitle(),parent:null,type:b.type,app:"designer",unit:e.getScene().getProperty("ut"),width:r,height:a,trashed:null};e.getReservedId()?(await i.gApi.updateFile(e.getReservedId(),s),n=e.getReservedId()):n=await i.gApi.createFile(s),t(n)}()}static loadDesignData(e,t,n,o,r,a){return new Promise(async(s,l)=>{try{let p;if(e&&a){let t=(r=await i.gApi.getFile(e)).url;if(n){t=(await i.gApi.getAutoSave(e,n)).url}else r.autosave&&(t=r.autosave_url);p=r.url,r.url=t}else if(e&&!r)if(o)r=await i.gApi.getShare(o);else{var c=n?"/version/"+n:"";r=t?await i.gApi.getFile(e+c+"?edit"):await i.gApi.getFile(e+c)}else if(t){const t=r?r.id:e;t&&await i.gApi.file.registerAccess(t).catch(e=>{console.error("Could not register access",e)})}const g=e=>fetch(e).then((function(e){if(!e.ok)throw new Error("failed to download, status = "+e.status);return e.blob()}));var d=await g(r.url).catch(e=>{if(!p)throw e;return g(p)}),u=new FileReader;u.onload=function(){s({data:new Uint8Array(this.result),file:r})},u.onerror=l,u.readAsArrayBuffer(new Blob([d],{type:"application/octet-stream"}))}catch(e){l(e)}})}static getDesigneDataSize(e){return new Promise(async(t,n)=>{try{var o=await i.gApi.getFile(e);return await fetch(o.url,{method:"HEAD"}).then((function(e){var n=e.headers.get("Content-Length");t(n)}))}catch(e){n(e)}})}static renameFile(e,t,n){!async function(){try{await i.gApi.updateFile(e.id,{name:t}),n(!0)}catch(e){console.error(e),n(!1)}}()}static _checkSecondaryFormatSanity(){return!0}static performSave(e,t,n,r,a){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e.hasPagesWithInfiniteEmptyCanvas())return void(n?n({code:507,message:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas")),noFailCall:!0}):c.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))));var d=r;function u(){let r=!1;if(e.isCommercialProductFile())return void e.openPaywall();var u=a||e.getStorageItem();const p=u&&w.length&&w.find(e=>e.ext.toUpperCase()===u.getExtension());if(p&&!P._checkSecondaryFormatSanity(e))return void(n&&n());const f=e.getEditor().markSavePoint();var m=function(i){f.rollback(),s||(i&&507===i.code?c.alert(i.message):c.confirm(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.save-to-cloud-failed")),(function(i){i?(gDesigner.stats("savealert_save-failed_click-save-local"),gDesigner.executeAction("file.save-as.".concat(b.ext),[null,e],void 0,!0)):(gDesigner.stats("savealert_save-failed_dont-save-local"),"function"!=typeof n||r?"function"==typeof t&&t(!1):(r=!0,n()))}),o.GLocale.get(new o.GLocaleKey("GLocale","no")),o.GLocale.get(new o.GLocaleKey("GLocale","yes")))),i&&console.log(i),e.updateStatus(h.SaveFailed),e.setSynchronizing(!1),e.setErrored(!0),gDesigner.trigger(new l(l.Type.SynchronismUpdateFailed,e)),n&&!r&&(r=!0,n())};try{const n={};e.setSynchronizing(!0),e.updateStatus(h.Saving,n);const{progress:r}=n,a=e=>{r&&r(e)};!async function(t){var n=null;try{let t={unit:e.getScene().getProperty("ut"),width:0,height:0};if(i.HAS_ANNOTATIONS)if(p){let t=!0;await g.saveDocumentAnnotations(e,t);d=e.updateSaveOptionsLastModifiedDate(d)}else try{let n=(await g.getCloudAnnotationsForDocument(e)).annotationsCollection;e.getScene().iteratePages(e=>{!!g.findAnnotationsListForPage(e,n)||n.push(o.GNode.store(e.getAnnotations()))},!0),t.annotations=n}catch(e){console.warn("Annotations couldn't be updated on server")}let n=e.getScene().getActivePage().getGeometryBBox();n&&(t.width=n.getWidth(),t.height=n.getHeight()),await i.gApi.updateFile(u._id,t),e.buildPreview().then(e=>{P.updateFileThumbnail(u.getId(),e,"image/jpeg")})}catch(e){n=e}t(n)}((function(n){a(S),n?m(n):u.write(e,(function(){a(A),e.setSynchronizing(!1),e.setErrored(!1),gDesigner.hasEventListeners(l)&&gDesigner.trigger(new l(l.Type.Modified,e));var n=(n,i)=>{try{n&&(e.updateStatus(h.Saved,d),gDesigner.updateRecentDocumentsAction(),e.getStorageItem().setFileAutoSaveLastModifiedDate(new Date(i.autosave_updated)),e.getStorageItem().setFileLastModifiedDate(new Date(i.updated)))}finally{a(T),t&&t()}};i.gApi.getFile(u._id+"?edit").then(e=>n(!0,e)).catch(n)}),(function(e){m(e)}),e=>{a(E.calculateProgress(S,G,e/100))},d)}))}catch(e){m(e)}}const p=()=>{gDesigner.getUser().then(e=>{!e||gDesigner.isAnonymous()?P.performLogin().then(u):u()})};gDesigner.isOffline()?m.openUnavailableFeature(p):p()}static async updateFileThumbnail(e,t,n){var o=await i.gApi.signedPutUrls(e,{type_t:n}),r=new XMLHttpRequest;r.open("PUT",o.url_t);var a={"Content-Type":n,"Cache-Control":"public,max-age=31600000"};for(var s in a)r.setRequestHeader(s,a[s]);r.send(t)}static async saveDocumentAnnotations(e,t,n){return!!i.HAS_ANNOTATIONS&&(gDesigner.isOffline()?(console.warn("Failed to record annotations"),!1):gDesigner.getUser().then(i=>!(!i||gDesigner.isAnonymous())&&g.saveDocumentAnnotations(e,t,void 0,n)))}static async getCloudAnnotations(e){if(i.HAS_ANNOTATIONS){if(!gDesigner.isOffline())return gDesigner.getUser().then(e=>{e&&gDesigner.isAnonymous()});console.warn("Failed to get annotations")}}static isOnline(){return"undefined"!=typeof window&&void 0!==window.gApi&&window.gApi.url}static getRecentStorageItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.FILE_FORMATS;var t=this;return new Promise((n,o)=>{!async function(){const r=e.map(e=>e.type).join("|");try{if(t.isOnline()){var a=await i.gApi.listFiles({type:r,accessed:"true",sort:"-accessed",parent:"*",limit:"10"});n(a)}}catch(e){}o([])}()})}static unzipData(e){var t=null;try{t=_.ungzip(e,{to:"string"})}catch(r){if("undefined"==typeof TextDecoder&&e.length>1e7){for(var n=[],i=e.length,o=0;o<i;o+=32768)n.push(String.fromCharCode.apply(null,e.subarray(o,o+32768)));t=n.join("")}else try{t="undefined"==typeof TextDecoder?new FakeTextEncoding.TextDecoder("utf-8").decode(e):new TextDecoder("utf-8").decode(e)}catch(e){console.warn("Couldn't unzip data. Data corrupted?")}}return t}static resendEmailConfirmation(e){let t,n;if(gContainer.getRuntime()===u.Runtime.Electron){const e=gContainer.getPlatform();"darwin"!==e&&"win32"!==e||(t="designer://"),n=gDesigner.getAssetsURL()}else n=location.origin;return i.gApi.resendEmailConfirmation({appUrl:t,webUrl:n,email:e.getEmail(),force:!0,origin:location.origin}).then(()=>{let e={},t=new Promise(t=>e.resolve=t);return c.custom({title:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.email-sent-title")),subtitle:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.email-sent-info")),icon:"ok",closeCallback:()=>e.resolve()}),t}).catch(e=>c.custom({title:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.something-wrong")),subtitle:i.gApi.formatError(e)}))}static createUint8ArrayFromBlob(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=function(){t(new Uint8Array(this.result))},i.onerror=n,i.readAsArrayBuffer(e)})}static getFileDataForVersionOrAutoSave(e,t,n){return t&&!n?i.gApi.getFile(e,!1,t):i.gApi.getFile(e)}static async activateCoupon(e){try{const t=await i.gApi.coupon.activate(e);await y.checkLicense(),gDesigner.addNotification({message:t.message})}catch(e){if(!e.ok&&e.code)switch(e.code){case i.gApi.ERROR_CODES.ERR_SUBSCRIPTION_COULD_NOT_BE_DEACTIVATED:const e=$("<div>".concat(o.GLocale.get(new o.GLocaleKey("GCloudUtil","text.err-subscription-could-not-be-deactivated")),"</div>"));return e.find("a").addClass("link").attr("href","javascript:void(0)").on("click",e=>(e.preventDefault(),gDesigner.runDeepLink("purchases"),!1)),c.alert(e);case i.gApi.ERROR_CODES.ERR_SUBSCRIPTION_IS_ACTIVE:const{nextBillingDate:t}=await i.gApi.subscription.getNextBillingDate();return c.alert(o.GLocale.get(new o.GLocaleKey("GCloudUtil","text.err-subscription-is-active")).replace("%date",i.DateAPI.format(t)));case i.gApi.ERROR_CODES.ERR_SUBSCRIPTION_IS_NOT_EXPIRED:return c.alert(o.GLocale.get(new o.GLocaleKey("GCloudUtil","text.err-subscription-is-not-expired")).replace("%date",i.DateAPI.format(gDesigner.getLicense().getExpirationDate())));case i.gApi.ERROR_CODES.ERR_SUBSCRIPTION_IS_LIFETIME:return c.alert(o.GLocale.get(new o.GLocaleKey("GCloudUtil","text.err-subscription-is-lifetime")))}gDesigner.addNotification({message:i.gApi.formatError(e)})}}}e.exports=P},,function(e,t,n){"use strict";function i(){}n(3),i.prototype._touchTools=null,i.prototype.init=function(e,t){throw new Error("Not Supported.")},i.prototype.isGroup=function(e){return!0},i.prototype.isSticky=function(){return!1},i.prototype.isAvailable=function(e){return!e},i.prototype.update=function(e,t,n){(e=e||this._document)&&e.clearActiveStylesList()},i.prototype.openPatternChooser=function(){throw new Error("Not Supported.")},i.prototype.openEyeDropper=function(e,t){throw new Error("Not Supported.")},i.prototype.setTouchTools=function(e){this._touchTools=e},i.prototype.getTouchTools=function(){return this._touchTools},i.prototype.toString=function(){return"[Object GProperties]"},e.exports=i},function(e,t,n){var i=n(104);e.exports=function(e){return i(e.length)}},function(e,t,n){var i=n(22),o=n(119),r=i(i.bind);e.exports=function(e,t){return o(e),void 0===t?e:r?r(e,t):function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";n(613);var i,o=n(47),r=n(67),a=n(383),s=n(6),l=n(110),c=n(49),d=n(22),u=n(377),p=n(80),g=n(181),h=n(59),f=n(370),m=n(614),y=n(157),v=n(280).codeAt,_=n(617),b=n(57),w=n(155),C=n(90),E=n(99),S=E.set,G=E.getterFor("URL"),A=C.URLSearchParams,T=C.getState,P=s.URL,L=s.TypeError,D=s.parseInt,x=Math.floor,I=Math.pow,O=d("".charAt),k=d(/./.exec),F=d([].join),R=d(1..toString),M=d([].pop),N=d([].push),B=d("".replace),$=d([].shift),U=d("".split),K=d("".slice),j=d("".toLowerCase),H=d([].unshift),V=/[a-z]/i,z=/[\d+-.a-z]/i,W=/\d/,q=/^0x/i,Y=/^[0-7]+$/,X=/^\d+$/,Q=/^[\da-f]+$/i,Z=/[\0\t\n\r #%/:<>?@[\\\]^|]/,J=/[\0\t\n\r #/:<>?@[\\\]^|]/,ee=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,te=/[\t\n\r]/g,ne=function(e,t){var n,i,o;if("["==O(t,0)){if("]"!=O(t,t.length-1))return"Invalid host";if(!(n=oe(K(t,1,-1))))return"Invalid host";e.host=n}else if(pe(e)){if(t=_(t),k(Z,t))return"Invalid host";if(null===(n=ie(t)))return"Invalid host";e.host=n}else{if(k(J,t))return"Invalid host";for(n="",i=m(t),o=0;o<i.length;o++)n+=de(i[o],ae);e.host=n}},ie=function(e){var t,n,i,o,r,a,s,l=U(e,".");if(l.length&&""==l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(n=[],i=0;i<t;i++){if(""==(o=l[i]))return e;if(r=10,o.length>1&&"0"==O(o,0)&&(r=k(q,o)?16:8,o=K(o,8==r?1:2)),""===o)a=0;else{if(!k(10==r?X:8==r?Y:Q,o))return e;a=D(o,r)}N(n,a)}for(i=0;i<t;i++)if(a=n[i],i==t-1){if(a>=I(256,5-t))return null}else if(a>255)return null;for(s=M(n),i=0;i<n.length;i++)s+=n[i]*I(256,3-i);return s},oe=function(e){var t,n,i,o,r,a,s,l=[0,0,0,0,0,0,0,0],c=0,d=null,u=0,p=function(){return O(e,u)};if(":"==p()){if(":"!=O(e,1))return;u+=2,d=++c}for(;p();){if(8==c)return;if(":"!=p()){for(t=n=0;n<4&&k(Q,p());)t=16*t+D(p(),16),u++,n++;if("."==p()){if(0==n)return;if(u-=n,c>6)return;for(i=0;p();){if(o=null,i>0){if(!("."==p()&&i<4))return;u++}if(!k(W,p()))return;for(;k(W,p());){if(r=D(p(),10),null===o)o=r;else{if(0==o)return;o=10*o+r}if(o>255)return;u++}l[c]=256*l[c]+o,2!=++i&&4!=i||c++}if(4!=i)return;break}if(":"==p()){if(u++,!p())return}else if(p())return;l[c++]=t}else{if(null!==d)return;u++,d=++c}}if(null!==d)for(a=c-d,c=7;0!=c&&a>0;)s=l[c],l[c--]=l[d+a-1],l[d+--a]=s;else if(8!=c)return;return l},re=function(e){var t,n,i,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)H(t,e%256),e=x(e/256);return F(t,".")}if("object"==typeof e){for(t="",i=function(e){for(var t=null,n=1,i=null,o=0,r=0;r<8;r++)0!==e[r]?(o>n&&(t=i,n=o),i=null,o=0):(null===i&&(i=r),++o);return o>n&&(t=i,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),i===n?(t+=n?":":"::",o=!0):(t+=R(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ae={},se=f({},ae,{" ":1,'"':1,"<":1,">":1,"`":1}),le=f({},se,{"#":1,"?":1,"{":1,"}":1}),ce=f({},le,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),de=function(e,t){var n=v(e,0);return n>32&&n<127&&!h(t,e)?e:encodeURIComponent(e)},ue={ftp:21,file:null,http:80,https:443,ws:80,wss:443},pe=function(e){return h(ue,e.scheme)},ge=function(e){return""!=e.username||""!=e.password},he=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},fe=function(e,t){var n;return 2==e.length&&k(V,O(e,0))&&(":"==(n=O(e,1))||!t&&"|"==n)},me=function(e){var t;return e.length>1&&fe(K(e,0,2))&&(2==e.length||"/"===(t=O(e,2))||"\\"===t||"?"===t||"#"===t)},ye=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&fe(t[0],!0)||t.length--},ve=function(e){return"."===e||"%2e"===j(e)},_e={},be={},we={},Ce={},Ee={},Se={},Ge={},Ae={},Te={},Pe={},Le={},De={},xe={},Ie={},Oe={},ke={},Fe={},Re={},Me={},Ne={},Be={},$e=function(e,t,n,o){var r,a,s,l,c,d=n||_e,u=0,p="",g=!1,f=!1,v=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=B(t,ee,"")),t=B(t,te,""),r=m(t);u<=r.length;){switch(a=r[u],d){case _e:if(!a||!k(V,a)){if(n)return"Invalid scheme";d=we;continue}p+=j(a),d=be;break;case be:if(a&&(k(z,a)||"+"==a||"-"==a||"."==a))p+=j(a);else{if(":"!=a){if(n)return"Invalid scheme";p="",d=we,u=0;continue}if(n&&(pe(e)!=h(ue,p)||"file"==p&&(ge(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=p,n)return void(pe(e)&&ue[e.scheme]==e.port&&(e.port=null));p="","file"==e.scheme?d=Ie:pe(e)&&o&&o.scheme==e.scheme?d=Ce:pe(e)?d=Ae:"/"==r[u+1]?(d=Ee,u++):(e.cannotBeABaseURL=!0,N(e.path,""),d=Me)}break;case we:if(!o||o.cannotBeABaseURL&&"#"!=a)return"Invalid scheme";if(o.cannotBeABaseURL&&"#"==a){e.scheme=o.scheme,e.path=y(o.path),e.query=o.query,e.fragment="",e.cannotBeABaseURL=!0,d=Be;break}d="file"==o.scheme?Ie:Se;continue;case Ce:if("/"!=a||"/"!=r[u+1]){d=Se;continue}d=Te,u++;break;case Ee:if("/"==a){d=Pe;break}d=Re;continue;case Se:if(e.scheme=o.scheme,a==i)e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=y(o.path),e.query=o.query;else if("/"==a||"\\"==a&&pe(e))d=Ge;else if("?"==a)e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=y(o.path),e.query="",d=Ne;else{if("#"!=a){e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=y(o.path),e.path.length--,d=Re;continue}e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,e.path=y(o.path),e.query=o.query,e.fragment="",d=Be}break;case Ge:if(!pe(e)||"/"!=a&&"\\"!=a){if("/"!=a){e.username=o.username,e.password=o.password,e.host=o.host,e.port=o.port,d=Re;continue}d=Pe}else d=Te;break;case Ae:if(d=Te,"/"!=a||"/"!=O(p,u+1))continue;u++;break;case Te:if("/"!=a&&"\\"!=a){d=Pe;continue}break;case Pe:if("@"==a){g&&(p="%40"+p),g=!0,s=m(p);for(var _=0;_<s.length;_++){var b=s[_];if(":"!=b||v){var w=de(b,ce);v?e.password+=w:e.username+=w}else v=!0}p=""}else if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&pe(e)){if(g&&""==p)return"Invalid authority";u-=m(p).length+1,p="",d=Le}else p+=a;break;case Le:case De:if(n&&"file"==e.scheme){d=ke;continue}if(":"!=a||f){if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&pe(e)){if(pe(e)&&""==p)return"Invalid host";if(n&&""==p&&(ge(e)||null!==e.port))return;if(l=ne(e,p))return l;if(p="",d=Fe,n)return;continue}"["==a?f=!0:"]"==a&&(f=!1),p+=a}else{if(""==p)return"Invalid host";if(l=ne(e,p))return l;if(p="",d=xe,n==De)return}break;case xe:if(!k(W,a)){if(a==i||"/"==a||"?"==a||"#"==a||"\\"==a&&pe(e)||n){if(""!=p){var C=D(p,10);if(C>65535)return"Invalid port";e.port=pe(e)&&C===ue[e.scheme]?null:C,p=""}if(n)return;d=Fe;continue}return"Invalid port"}p+=a;break;case Ie:if(e.scheme="file","/"==a||"\\"==a)d=Oe;else{if(!o||"file"!=o.scheme){d=Re;continue}if(a==i)e.host=o.host,e.path=y(o.path),e.query=o.query;else if("?"==a)e.host=o.host,e.path=y(o.path),e.query="",d=Ne;else{if("#"!=a){me(F(y(r,u),""))||(e.host=o.host,e.path=y(o.path),ye(e)),d=Re;continue}e.host=o.host,e.path=y(o.path),e.query=o.query,e.fragment="",d=Be}}break;case Oe:if("/"==a||"\\"==a){d=ke;break}o&&"file"==o.scheme&&!me(F(y(r,u),""))&&(fe(o.path[0],!0)?N(e.path,o.path[0]):e.host=o.host),d=Re;continue;case ke:if(a==i||"/"==a||"\\"==a||"?"==a||"#"==a){if(!n&&fe(p))d=Re;else if(""==p){if(e.host="",n)return;d=Fe}else{if(l=ne(e,p))return l;if("localhost"==e.host&&(e.host=""),n)return;p="",d=Fe}continue}p+=a;break;case Fe:if(pe(e)){if(d=Re,"/"!=a&&"\\"!=a)continue}else if(n||"?"!=a)if(n||"#"!=a){if(a!=i&&(d=Re,"/"!=a))continue}else e.fragment="",d=Be;else e.query="",d=Ne;break;case Re:if(a==i||"/"==a||"\\"==a&&pe(e)||!n&&("?"==a||"#"==a)){if(".."===(c=j(c=p))||"%2e."===c||".%2e"===c||"%2e%2e"===c?(ye(e),"/"==a||"\\"==a&&pe(e)||N(e.path,"")):ve(p)?"/"==a||"\\"==a&&pe(e)||N(e.path,""):("file"==e.scheme&&!e.path.length&&fe(p)&&(e.host&&(e.host=""),p=O(p,0)+":"),N(e.path,p)),p="","file"==e.scheme&&(a==i||"?"==a||"#"==a))for(;e.path.length>1&&""===e.path[0];)$(e.path);"?"==a?(e.query="",d=Ne):"#"==a&&(e.fragment="",d=Be)}else p+=de(a,le);break;case Me:"?"==a?(e.query="",d=Ne):"#"==a?(e.fragment="",d=Be):a!=i&&(e.path[0]+=de(a,ae));break;case Ne:n||"#"!=a?a!=i&&("'"==a&&pe(e)?e.query+="%27":e.query+="#"==a?"%23":de(a,ae)):(e.fragment="",d=Be);break;case Be:a!=i&&(e.fragment+=de(a,se))}u++}},Ue=function(e){var t,n,i=g(this,Ke),o=arguments.length>1?arguments[1]:void 0,a=b(e),s=S(i,{type:"URL"});if(void 0!==o)try{t=G(o)}catch(e){if(n=$e(t={},b(o)))throw L(n)}if(n=$e(s,a,null,t))throw L(n);var l=s.searchParams=new A,d=T(l);d.updateSearchParams(s.query),d.updateURL=function(){s.query=b(l)||null},r||(i.href=c(je,i),i.origin=c(He,i),i.protocol=c(Ve,i),i.username=c(ze,i),i.password=c(We,i),i.host=c(qe,i),i.hostname=c(Ye,i),i.port=c(Xe,i),i.pathname=c(Qe,i),i.search=c(Ze,i),i.searchParams=c(Je,i),i.hash=c(et,i))},Ke=Ue.prototype,je=function(){var e=G(this),t=e.scheme,n=e.username,i=e.password,o=e.host,r=e.port,a=e.path,s=e.query,l=e.fragment,c=t+":";return null!==o?(c+="//",ge(e)&&(c+=n+(i?":"+i:"")+"@"),c+=re(o),null!==r&&(c+=":"+r)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+F(a,"/"):"",null!==s&&(c+="?"+s),null!==l&&(c+="#"+l),c},He=function(){var e=G(this),t=e.scheme,n=e.port;if("blob"==t)try{return new Ue(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&pe(e)?t+"://"+re(e.host)+(null!==n?":"+n:""):"null"},Ve=function(){return G(this).scheme+":"},ze=function(){return G(this).username},We=function(){return G(this).password},qe=function(){var e=G(this),t=e.host,n=e.port;return null===t?"":null===n?re(t):re(t)+":"+n},Ye=function(){var e=G(this).host;return null===e?"":re(e)},Xe=function(){var e=G(this).port;return null===e?"":b(e)},Qe=function(){var e=G(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+F(t,"/"):""},Ze=function(){var e=G(this).query;return e?"?"+e:""},Je=function(){return G(this).searchParams},et=function(){var e=G(this).fragment;return e?"#"+e:""},tt=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(r&&u(Ke,{href:tt(je,(function(e){var t=G(this),n=b(e),i=$e(t,n);if(i)throw L(i);T(t.searchParams).updateSearchParams(t.query)})),origin:tt(He),protocol:tt(Ve,(function(e){var t=G(this);$e(t,b(e)+":",_e)})),username:tt(ze,(function(e){var t=G(this),n=m(b(e));if(!he(t)){t.username="";for(var i=0;i<n.length;i++)t.username+=de(n[i],ce)}})),password:tt(We,(function(e){var t=G(this),n=m(b(e));if(!he(t)){t.password="";for(var i=0;i<n.length;i++)t.password+=de(n[i],ce)}})),host:tt(qe,(function(e){var t=G(this);t.cannotBeABaseURL||$e(t,b(e),Le)})),hostname:tt(Ye,(function(e){var t=G(this);t.cannotBeABaseURL||$e(t,b(e),De)})),port:tt(Xe,(function(e){var t=G(this);he(t)||(""==(e=b(e))?t.port=null:$e(t,e,xe))})),pathname:tt(Qe,(function(e){var t=G(this);t.cannotBeABaseURL||(t.path=[],$e(t,b(e),Fe))})),search:tt(Ze,(function(e){var t=G(this);""==(e=b(e))?t.query=null:("?"==O(e,0)&&(e=K(e,1)),t.query="",$e(t,e,Ne)),T(t.searchParams).updateSearchParams(t.query)})),searchParams:tt(Je),hash:tt(et,(function(e){var t=G(this);""!=(e=b(e))?("#"==O(e,0)&&(e=K(e,1)),t.fragment="",$e(t,e,Be)):t.fragment=null}))}),p(Ke,"toJSON",(function(){return c(je,this)}),{enumerable:!0}),p(Ke,"toString",(function(){return c(je,this)}),{enumerable:!0}),P){var nt=P.createObjectURL,it=P.revokeObjectURL;nt&&p(Ue,"createObjectURL",l(nt,P)),it&&p(Ue,"revokeObjectURL",l(it,P))}w(Ue,"URL"),o({global:!0,forced:!a,sham:!r},{URL:Ue})},,,function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?i:n)(t)}},function(e,t,n){"use strict";n(14);var i,o,r=n(47),a=n(6),s=n(49),l=n(22),c=n(34),d=n(62),u=(i=!1,(o=/[ac]/).exec=function(){return i=!0,/./.exec.apply(this,arguments)},!0===o.test("abc")&&i),p=a.Error,g=l(/./.test);r({target:"RegExp",proto:!0,forced:!u},{test:function(e){var t=this.exec;if(!c(t))return g(this,e);var n=s(t,this,e);if(null!==n&&!d(n))throw new p("RegExp exec method returned something other than an Object or null");return!!n}})},,,function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t,n,i){this.key=e,this.previousValue=t,this.newValue=n,this.restoring=i}i.GObject.inherit(o,i.GEvent),o.prototype.key=null,o.prototype.previousValue=null,o.prototype.newValue=null,o.prototype.restoring=!1,o.prototype.toString=function(){return"[Object GSettingChangedEvent]"},e.exports=o},function(e,t,n){var i=n(6),o=n(34),r=n(179),a=i.TypeError;e.exports=function(e){if(o(e))return e;throw a(r(e)+" is not a function")}},,,,,,function(e,t,n){var i=n(22);e.exports=i({}.isPrototypeOf)},function(e,t){e.exports=!1},,,function(e,t,n){"use strict";var i,o=n(47),r=n(22),a=n(174).f,s=n(104),l=n(57),c=n(325),d=n(95),u=n(326),p=n(126),g=r("".startsWith),h=r("".slice),f=Math.min,m=u("startsWith");o({target:"String",proto:!0,forced:!!(p||m||(i=a(String.prototype,"startsWith"),!i||i.writable))&&!m},{startsWith:function(e){var t=l(d(this));c(e);var n=s(f(arguments.length>1?arguments[1]:void 0,t.length)),i=l(e);return g?g(t,i,n):h(t,n,n+i.length)===i}})},function(e,t,n){var i=n(96);e.exports=i("navigator","userAgent")||""},,function(e,t,n){"use strict";var i=n(49),o=n(250),r=n(52),a=n(104),s=n(57),l=n(95),c=n(145),d=n(279),u=n(251);o("match",(function(e,t,n){return[function(t){var n=l(this),o=null==t?void 0:c(t,e);return o?i(o,t,n):new RegExp(t)[e](s(n))},function(e){var i=r(this),o=s(e),l=n(t,i,o);if(l.done)return l.value;if(!i.global)return u(i,o);var c=i.unicode;i.lastIndex=0;for(var p,g=[],h=0;null!==(p=u(i,o));){var f=s(p[0]);g[h]=f,""===f&&(i.lastIndex=d(o,a(i.lastIndex),c)),h++}return 0===h?null:g}]}))},,,,,,,,,,,function(e,t,n){"use strict";var i=n(1);function o(){}i.GObject.inheritAndMix(o,i.GObject),e.exports=o},function(e,t,n){"use strict";var i=n(17);n(28),n(9),n(297),n(25),n(14),n(132),n(759),n(163),n(19),n(158),n(201),n(166),n(167),n(29),n(58),n(24),n(1266);var o=n(43),r=n(1),a=n(16),s=n(1086),l=n(710),c=n(12),d=n(32),u=i(n(1346)),p=i(n(1348)),g=i(n(1349)),h=i(n(175)),f=n(147);const m=n(1350);var y=n(348),v=n(78),_=n(77),b=n(200),w=n(305),C=n(216),E=n(749),S=n(1351),G=n(192),A=n(1123),T=n(1353),P=n(230),L=n(106),D=n(202),x=n(76);const I=n(544),O=n(351),k=n(263),F=n(264),R=n(36),M=n(395),N=n(390),B=c.FILE_FORMATS.find(e=>e.default),$=c.FILE_FORMATS.filter(e=>e.secondary),U=n(352),K=n(389);n(1041);function j(e){this._storageItem=e instanceof C.Item?e:null,this._windows=[],this._activeWindow=null,this._updateStatus(_.Init),this.sessionId=r.GUtil.uuid(),e instanceof r.GScene?this.setScene(e):this.setScene(gDesigner.createScene()),this._storageItem&&gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.StorageItemUpdated,this)),this._activeStylesList={Fill:null,Border:null,Effect:null},this._lockedSymbolInstances=!1}r.GObject.inherit(j,r.GEventTarget),j.FileTypes=N.getFileTypesArray(),j.prototype._status=null,j.prototype._errored=!1,j.prototype._storageItem=null,j.prototype._isUpdateAvailable=!1,j.prototype._tempCloudStorageItem=null,j.prototype._documentColors=null,j.prototype._scene=null,j.prototype._editor=null,j.prototype._windows=null,j.prototype._activeWindow=null,j.prototype._synchronizing=!1,j.prototype._title=null,j.prototype._reservedId=null,j.prototype._trashed=null,j.prototype._fontImporter=null,j.prototype._paywall=null,j.prototype._lockedSymbolInstances=!1,j.prototype._lockedByVersionHistory=!1,j.prototype._editable=!0,j.prototype._annotationsEditable=c.HAS_ANNOTATIONS,j.prototype._owner=null,j.prototype._cloudSynchronismFlag=!1,j.prototype._documentFromTemplate=!1,j.prototype._isShared=!1,j.prototype._focusAnnotationId=null,j.prototype._failedDocumentIdOrToken=null,j.prototype._lastDownloadSize=0,j.prototype._lastDownloadSize=0,j.prototype.hasUTS=void 0,j.prototype._activeStylesList=null,j.prototype.updateActiveStylesList=function(e,t){this._activeStylesList.hasOwnProperty(e)&&(this._activeStylesList[e]=t)},j.prototype.getActiveStylesList=function(){return this._activeStylesList},j.prototype.clearActiveStylesList=function(){Object.keys(this._selectedStylesList).forEach(e=>{this._selectedStylesList[e]=null})},j.prototype.setFocusAnnotationId=function(e){this._focusAnnotationId=e},j.prototype.getFocusAnnotationId=function(){return this._focusAnnotationId},j.prototype.setFailedDocumentIdOrToken=function(e){this._failedDocumentIdOrToken=e},j.prototype.getFailedDocumentIdOrToken=function(){return this._failedDocumentIdOrToken},j.prototype._annotationFocused=!1,j.prototype.setAnnotationFocused=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._annotationFocused=e},j.prototype.isAnnotationFocused=function(){return this._annotationFocused},j.prototype._colorModeElms=null,j.prototype.setColorModeElms=function(e){this._colorModeElms=e},j.prototype.getColorModeElms=function(){return this._colorModeElms},j.prototype.setDocumentFromTemplate=function(e){this._documentFromTemplate=e},j.prototype.isDocumentFromTemplate=function(){return this._documentFromTemplate},j.prototype.setIsShared=function(e){this._isShared=e},j.prototype.isShared=function(){return this._isShared},j.prototype.openPaywall=function(e){this._paywall&&this._paywall.close(),this._paywall=new S(this,this.getStorageItem(),e),this._paywall.open()},j.prototype.getStatus=function(){return this._status},j.prototype.isNew=function(){return!this._storageItem},j.prototype.isModified=function(){return!!this._editor&&(!!this._errored||(!!this._editor.isModified(c.HAS_ANNOTATIONS?e=>e.hasMixin(r.GAnnotation)||e instanceof r.GComment:null)||!(!this._editable||!this.getScene()||this.getStorageItem()&&this.getStorageItem().getVersionId()||!(this.getScene().getLastTimeAnnotationsFromCloudModified()-this.getScene().getLastSavedTime()>0))))},j.prototype.getStorageItem=function(){return this._storageItem},j.prototype.getExtension=function(){return this.getStorageItem().getExtension()||B.ext},j.prototype.hasCDR=function(){return!!(M.CDR_ORIGIN_PROPERTY_NAME&&this._scene&&this._scene.getProperty(M.CDR_ORIGIN_PROPERTY_NAME,!0))},j.prototype.getTempCloudStorageItem=function(){return this._tempCloudStorageItem||this._storageItem},j.prototype.getStorage=function(){return this._storageItem?this._storageItem.getStorage():null},j.prototype.setStorageItem=function(e){e!==this._storageItem&&(this._storageItem=e,this._storageItem&&this.getFileFormatVersion()&&this._storageItem.storeFileFormatVersion(this.getFileFormatVersion()),gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.StorageItemUpdated,this)))},j.prototype.getScene=function(){return this._scene},j.prototype.setScene=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e!==this._scene||t){var n=!1;gDesigner.getActiveDocument()===this&&(gDesigner.activateDocument(null),n=!0),this._updateScene(e),this._updateStatus(_.Ready,e),n&&gDesigner.activateDocument(this)}},j.prototype.setFileFormatVersion=function(){},j.prototype.saveFileFormatVersion=async function(){},j.prototype.getFileFormatVersion=function(){return null},j.prototype.getDocumentColors=function(e){var t=Object.keys(this._documentColors);t.sort(function(e,t){return this._documentColors[t]-this._documentColors[e]}.bind(this));var n=t.map(function(e){return r.GPattern.deserialize(e)}.bind(this));return"number"==typeof e&&e>0&&(n=n.slice(0,e)),n},j.prototype._applicationStateChangedEvent=function(e){e.document===this&&this._scene&&this._checkPermissionsAndUpdateState()},j.prototype._networkAvailabilityChangedEvent=function(){this._checkPermissionsAndUpdateState()},j.prototype._checkPermissionsAndUpdateState=function(){const e=gDesigner.getApplicationManager().isInspectEnabled(),t=gDesigner.getApplicationManager().isCommentingEnabled();e===this._editable&&t===this._annotationsEditable||(this._editable=e,this._annotationsEditable=t,this._updateState())},j.prototype._resolvedMissingEntryEvent=function(e){try{const t=this.isCloudFile()?this.getStorageItem().getId():null;u.default.register({message:"DICTIONARY_MISSING_ENTRY",data:{entry:e.entry.uuid,file_id:t}})}catch(e){console.error(e)}},j.prototype._updateScene=function(e){if(this._scene&&(this._editor.release(),this._editor.removeEventListener(o.GEditor.FileDropEvent,this._dropFileEvent,this),this._editor.removeEventListener(o.GEditor.ModifiedEvent,this._modifiedEvent,this),this._editor.removeAllEventListeners(),this._scene.getDictionary().removeEventListener(r.GSceneDictionary.ResolvedMissingEntryEvent,this._resolvedMissingEntryEvent,this),this._scene.removeEventListener(r.GNode.AfterInsertEvent,this._afterInsertNodeEvent,this),this._scene.removeEventListener(r.GNode.AfterRemoveEvent,this._afterRemoveNodeEvent,this),this._scene.removeEventListener(r.GNode.BeforeRemoveEvent,this._beforeRemoveNodeEvent,this),this._scene.removeEventListener(r.GNode.BeforePropertiesChangeEvent,this._beforePropertiesChangeEvent,this),this._scene.removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChangeEvent,this),this._scene.removeEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),this._scene.removeAllEventListeners(),this._scene.iteratePages(e=>{e.removeAllEventListeners()},!0),this._scene.getDictionary().removeAllEventListeners(),this._scene.getSymbolDictionary().removeAllEventListeners(),gDesigner.removeEventListener(I,this._licenseChangedEvent,this),gDesigner.removeEventListener(O,this._applicationStateChangedEvent,this),gDesigner.removeEventListener(k,this._networkAvailabilityChangedEvent,this),gDesigner.removeEventListener(F,this._userLoggedEvent,this),gDesigner.removeEventListener(v,this._handleDocumentEvent,this),gDesigner.removeEventListener(w,this._handleStorageItemEvent,this),this.removeEventListener(U,this._collaborationEvent,this),this.removeEventListener(b,this._handleDocumentStatusEvent,this),this._editor=null,this._scene=null),this._documentColors={},this._scene=e,this._scene){this._editor=o.GEditor.getEditor(e)||new o.GEditor(e);const t=gDesigner.getSyncUser();t&&this._editor.setUID(t.getUID()),this._editor.addEventListener(o.GEditor.FileDropEvent,this._dropFileEvent,this,void 0,void 0,!0),this._editor.addEventListener(o.GEditor.ModifiedEvent,this._modifiedEvent,this,void 0,void 0,!0),this._scene.getDictionary().addEventListener(r.GSceneDictionary.ResolvedMissingEntryEvent,this._resolvedMissingEntryEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.AfterInsertEvent,this._afterInsertNodeEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.AfterRemoveEvent,this._afterRemoveNodeEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.BeforeRemoveEvent,this._beforeRemoveNodeEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.BeforePropertiesChangeEvent,this._beforePropertiesChangeEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChangeEvent,this,void 0,void 0,!0),this._scene.addEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this,void 0,void 0,!0),gDesigner.addEventListener(I,this._licenseChangedEvent,this),gDesigner.addEventListener(O,this._applicationStateChangedEvent,this),gDesigner.addEventListener(k,this._networkAvailabilityChangedEvent,this),gDesigner.addEventListener(F,this._userLoggedEvent,this),gDesigner.addEventListener(v,this._handleDocumentEvent,this),gDesigner.addEventListener(w,this._handleStorageItemEvent,this),this.addEventListener(U,this._collaborationEvent,this,void 0,void 0,!0),this.addEventListener(b,this._handleDocumentStatusEvent,this,void 0,void 0,!0),e.acceptChildren(e=>{if(e.hasMixin(r.GElement.Stylable)&&e.getPaintLayers())for(var t=e.getPaintLayers().getFirstChild();null!==t;t=t.getNext())this._updateDocumentColorsFromElement(t,["_pt"])}),this._updateState()}},j.prototype._userLoggedEvent=function(e){const{user:t}=e;t&&this._editor&&this._editor.setUID(new h.default(t).getUID())},j.prototype._handleDocumentEvent=function(){},j.prototype._handleStorageItemEvent=function(){},j.prototype._collaborationEvent=async function(e){if(this.isLockedByVersionHistory())return;const{type:t,data:n}=e;switch(t){case U.Type.ReviewStatusChanged:this.isCollaborative()&&this.getStorageItem().setCollaborativeFileStatus(n.status);break;case U.Type.FileUpdate:if(n&&n.metadata&&n.metadata.sessionId&&n.metadata.sessionId===this.sessionId)return;this._isUpdateAvailable=!0,this._isIgnoringCurrentUpdate=!1,gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.UpdateAvailable,this))}},j.prototype._handleDocumentStatusEvent=async function(e){switch(e.status){case _.Loaded:this._isUpdateAvailable=!1,this._isIgnoringCurrentUpdate=!1;break;case _.Ready:this._checkPermissionsAndUpdateState();break;case _.Saved:this._isUpdateAvailable=!1,this._isIgnoringCurrentUpdate=!1,this._handleDocumentStatusSavedEventForRealtimeNotification(e)}},j.prototype._handleDocumentStatusSavedEventForRealtimeNotification=async function(e){e.data&&(e.data.hasOwnProperty("collabTextUpdate")||e.data.hasOwnProperty("sendEmail"))?this.publish({collabTextUpdate:e.data.collabTextUpdate,sendEmail:e.data.sendEmail}):this.publish()},j.prototype.isUpdateAvailable=async function(){if(this._isUpdateAvailable)return!0;const e=this.getStorageItem();return!(!e||!e.hasVersionControl()&&!this.isCloudFile()||this._synchronizing)&&e.hasUpdates()},j.prototype.isIgnoringCurrentUpdate=function(){return this._isIgnoringCurrentUpdate},j.prototype.ignoreCurrentUpdate=function(){this._isIgnoringCurrentUpdate=!0},j.prototype.getEditor=function(){return this._editor},j.prototype.getWindows=function(){return this._windows},j.prototype.getActiveWindow=function(){return this._activeWindow},j.prototype.setOwner=function(e){(this._owner&&this._owner.id)!==(e&&e.id)&&(this._owner=e,gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.OwnerUpdated,this)))},j.prototype.getOwner=function(){return this._owner},j.prototype.canSaveToCloud=async function(){if(!this._owner)return!0;const e=await gDesigner.getUser();return!!e&&(this._owner.id===e.getUID()||gDesigner.getApplicationManager().hasPermission(this,c.SharePermissions.EDIT))},j.prototype.setTitle=function(e){e!==this._title&&(this._title=e,this.isCloudFile()&&this.getStorageItem().setFileName(e),gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.Modified,this)))};var H={},V=1;function z(e){setTimeout(e,10)}j.prototype.getTitle=function(){return this.isNew()&&(H[this.sessionId]=H[this.sessionId]?H[this.sessionId]:V++),this.isNew()?this._title||r.GLocale.get(new r.GLocaleKey("GDocument","text.default-document-name"))+"-"+H[this.sessionId]:this._storageItem.getName()},j.prototype.insertElement=function(e,t,n,i){var o=this.getScene();if(o.isFixedSized()&&e.hasMixin(r.GElement.Transform)){var a=e.getGeometryBBox();if(!a)return;var s=a.getWidth(),l=a.getHeight(),c=o.getProperty("w"),d=o.getProperty("h"),u=new r.GTransform;if(n&&(s>c||l>d)){var p=1,g=1;s>c&&(p=c/s),l>d&&(g=d/l),p<g?g=p:p=g,u=u.translated(-a.getX(),-a.getY()).scaled(p,g).translated(a.getX(),a.getY()),s*=p,l*=g}t&&(u=u.translated((c-s)/2-a.getX(),(d-l)/2-a.getY())),e.transform(u,!0);var h=u.getScaleFactor(),f=function(e){if(e instanceof r.GItem&&e.hasMixin(r.GElement.Stylable)&&e.hasStyleBorder()){var t=e.getPaintLayers();t&&r.GUtil.each(t.getBorderLayers(),(function(e,t){t&&t.setProperty("_bw",t.$_bw*h)}))}};e.beginUpdate(),f(e),e.hasMixin(r.GNode.Container)&&e.acceptChildren(f),e.endUpdate()}this._editor.insertElements([e],!0,i,e instanceof r.GItem)},j.prototype.loadFromData=function(e){var t={progress:null,checkAnnotations:!1};this._updateStatus(_.Loading,t),this._loadDataIntoDocument(e,t)},j.prototype._loadDataIntoDocument=async function(e,t){t.progress&&t.progress(5),await(0,d.sleep)(10);const n=L.unzipData(e);return t.progress&&t.progress(10),await(0,d.sleep)(10),this.deserializeData(n,t)},j.prototype.deserializeData=function(e,t){const n=this.getActiveWindow();return n&&n.centerAndZoom(),this._updateCloudSynchronism(this.isCloudFile()),new Promise(async(n,i)=>{t||(t={progress:null},this._updateStatus(_.Loading,t)),t.progress&&t.progress(15);const o=await new Promise((n,i)=>{try{r.GNode.deserializeAsync(e,gDesigner.getWorkspace(),t.progress,null,n)}catch(e){i(e)}}).catch(i);e=null,o&&(!this.isCloudFile()&&!this.isExternalFile()&&o&&o.isCloudSynchronization()?this.loadFromCloud(o,t,()=>{this._updateCloudSynchronism(!0)},()=>{this._updateCloudSynchronism(!1),gDesigner.isOffline()||o.setProperty("cfs",!1)},!1):o?(this.isExternalFile()&&o.setProperty("cfs",!1),this._updateScene(o),!this.isCloudFile()&&t.checkAnnotations&&this.loadCloudAnnotations(),this._updateStatus(_.Loaded),this.setScene(o,!0)):this._updateStatus(_.LoadFailed),n())})},j.prototype.loadFromCloud=function(e,t,n,i){let o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];t=t||{progress:null},this._updateStatus(_.Syncing,t);var r=()=>{this.chooseLatestDocument(e,e=>{this.setScene(e),t.checkAnnotations&&this.loadCloudAnnotations(),this._updateStatus(_.Loaded),n&&n(e)},n=>{this.setScene(e),t.checkAnnotations&&this.loadCloudAnnotations(),this._updateStatus(_.SyncFailed),i&&i(n)},null,o&&(()=>{this._updateStatus(_.LoadCancelled)})||void 0)};r()},j.prototype.storeToCloud=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;var a=o||{};this.isModified()||Object.assign(a,{lastModifiedDate:e.getLastSavedTime()});const s=()=>{this._updateCloudSynchronism(!1),n?n.apply(null,arguments):new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.sync-to-cloud-error"))).open()},l=()=>{this._updateCloudSynchronism(!0),t&&t.apply(null,arguments)};this.isExternalFile()?this.performCloudSave(l,s,a,i):L.performSave(this,l,s,a,await D.from(gDesigner.getDefaultStorage(),e.getProperty("cid"),this.getTitle()),i)},j.prototype.saveAnnotations=function(e,t){return L.saveDocumentAnnotations(this,e,t)},j.prototype.loadCloudAnnotations=function(){return L.getCloudAnnotations(this)},j.prototype.performCloudSave=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var o=this;let a=!1;if(this.isCommercialProductFile())this.openPaywall();else{var s=this.getStorageItem(),l=n=>{i||(n&&507===n.code?(R.alert(n.message),n.noFailCall&&(a=!0)):R.confirm(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.save-to-cloud-failed")),n=>{n?gDesigner.executeAction("file.save-as.".concat(B.ext),[null,this],"savefailed"):"function"!=typeof t||a?"function"==typeof e&&e(!1):(a=!0,t())},r.GLocale.get(new r.GLocaleKey("GLocale","no")),r.GLocale.get(new r.GLocaleKey("GLocale","yes")))),n&&console.log(n),this.setSynchronizing(!1),this._updateStatus(_.SyncFailed),this._updateStatus(_.SaveFailed),gDesigner.trigger(new v(v.Type.SynchronismUpdateFailed,this)),this.setErrored(!0),t&&!a&&(a=!0,t())};try{this.setSynchronizing(!0);var c=async()=>{const t=!o.isCloudFile()||s.getType()!==B.type;await this.saveAnnotations(t),n=this.updateSaveOptionsLastModifiedDate(n),s.write(this,(function(){o.setSynchronizing(!1),o.setErrored(!1),o._updateStatus(_.Saved,{}),gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.Modified,o));try{o.isCloudFile()&&gDesigner.updateRecentDocumentsAction()}finally{e&&e()}}),(function(e){l(e)}),null,n)};if(s.hasVersionControl()&&await s.hasUpdates()){var d=this.getScene(),u=await s.getLatestFileVersion(),p=await new Promise((e,t)=>{u.read(t=>e(t),e=>t(e))}),g=r.GNode.deserialize(L.unzipData(p),gDesigner.getWorkspace());return new T(d,g,this.getTitle(),u.getName(),e=>{if(e===d)c();else{this.setSynchronizing(!1);const t=new j(u);t.setScene(e),gDesigner.replaceDocument(this,t,!0)}},()=>{this.setSynchronizing(!1),o.setErrored(!1),this._updateStatus(_.SaveCancelled,{}),e&&e()}).open()}c()}catch(e){l(e)}}},j.prototype.chooseLatestDocument=async function(e,t,n,i,o){var a=e=>{n&&n(e),(e instanceof Error||"string"==typeof e)&&console.error(e)};let s;try{s=await c.gApi.getFile(e.getProperty("cid"))}catch(e){return void a(e)}L.loadDesignData(e.getProperty("cid"),void 0,void 0,void 0,void 0,s.autosave).then(async n=>{var s=n.data,l=n.file;this._tempCloudStorageItem=await D.from(gDesigner.getDefaultStorage(),e.getProperty("cid")),i=i||function(e,t){return e.lastModifiedDate().getTime()!==t.lastModifiedDate().getTime()&&(0,d.isDifferent)(e,t)};var c=r.GNode.deserialize(L.unzipData(s),gDesigner.getWorkspace());c?i(e,c)?new T(e,c,this.getTitle(),l.name,n=>{this._tempCloudStorageItem=null,n===e?this.storeToCloud(n):n.setProperties(["cid","cfs"],e.getProperties(["cid","cfs"])),t(n,!0)},o).open():t(e):a()}).catch(a)},j.prototype.isCloudSynchronismAvailable=function(){return this._cloudSynchronismFlag},j.prototype._updateCloudSynchronism=function(e){this._cloudSynchronismFlag!==e&&(this._cloudSynchronismFlag=e,gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.CloudSynchronismUpdated,this)))},j.prototype.isCloudFile=function(){return this.getStorageItem()instanceof D.Item},j.prototype.isCollaborative=function(){return this.getStorageItem()&&this.getStorageItem().hasMixin(K)},j.prototype.isShareable=function(){const e=this.getStorageItem();return this.isCloudFile()&&e&&e.getId()||e&&e.getId()&&e.supportsShadowFile()&&e.supportsSharing()},j.prototype.isExternalFile=function(){return this.getStorageItem()instanceof y.Item},j.prototype.isEditingEnabled=function(){const e=this.getStorageItem();return!e||e.isEditingEnabled()},j.prototype.getId=function(){return this.isCloudFile()||this.isExternalFile()?this.getStorageItem().getId():this.getCloudReferenceId()?this.getCloudReferenceId():null},j.prototype.getToken=function(){return this.isCollaborative()?this.getStorageItem().getToken():null},j.prototype.getAnnotationsId=function(){if(!c.HAS_ANNOTATIONS)return null;var e=this.getId();if(!e){var t=this.getScene();(e=t.isCloudAnnotations()?t.getProperty("cid"):null)||(e=this.getReservedId())}return e},j.prototype.getAnnotationsToken=async function(e){if(!c.HAS_ANNOTATIONS)return null;var t=null;let n=location.search.match(/token=(?:(?!&)[\s\S])+/);n&&(t=n[0].slice(6));var i=null,o=this.getScene(),r=this.getId(),a=o.getProperty("cid"),s=this.getReservedId();return!t||e!==r&&e!==s?e===a&&e!==r&&e!==s&&(i=o.getProperty("asec")):i=t,i},j.prototype.updateSaveOptionsLastModifiedDate=function(e,t){return e?e.save=!0:e={save:!0},c.HAS_ANNOTATIONS&&this._scene&&this._scene.getLastTimeAnnotationsFromCloudModified()&&(e.lastModifiedDate=this._scene.getLastTimeAnnotationsFromCloudModified()),t&&!e.lastModifiedDate&&(e.lastModifiedDate=t),e},j.prototype.isWebFile=function(){const e=this.getStorageItem();return e?e instanceof D.Item:gContainer.getRuntime()===x.Runtime.Browser||gContainer.getRuntime()===x.Runtime.PWA},j.prototype.isCommercialProductFile=function(){return this.getStorageItem()&&this.getStorageItem()instanceof D.CommercialProduct},j.prototype.restrictElements=function(e){return e.forEach(e=>{e.setProperty("restricted",this.getStorageItem().getId(),!0)}),e},j.prototype.filterUnrestrictedCommercialFileElements=function(e){return e&&e.filter(e=>{let t=e.getProperty("restricted",!0)||!1;if(!t)return!0;let n=this.getStorageItem();return n&&n.getId()===t})},j.prototype.hasCloudReference=function(){return!this.isCloudFile()&&!!this._getCloudSceneId()},j.prototype.getCloudReferenceId=function(){return this.hasCloudReference()&&this._getCloudSceneId()||null},j.prototype._getCloudSceneId=function(){return this.getScene()&&this.getScene().getProperty("cid")},j.prototype.isCloudSyncOn=function(){return this.hasCloudReference()&&this.getScene()&&this.getScene().isCloudSynchronization()},j.prototype.isExtensionAvailableForLoading=function(e){return e&&!!j.FileTypes.find(t=>t.load&&t.ext.toUpperCase()===e.toUpperCase())},j.prototype.reload=async function(){let e;if(gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.BeforeReload,this)),this.isCloudFile()){const t=await c.gApi.getFile(this.getId());e=await D.from(gDesigner.getDefaultStorage(),t,void 0,void 0,t.autosave),this.getEditor()&&this.getEditor().markSavePoint(),this.setStorageItem(e)}else e=this.getStorageItem();this.load(e)},j.prototype.load=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("lts"!==gDesigner.getEnv()||gDesigner.isEnabledProFeatures()){var n=e||this._storageItem;if(n){var i=n.getName(),o=n.getExtension();t=Object.assign({},{progress:null,filename:i,ext:o?o.toLowerCase():null},t),this._updateStatus(_.Loading,t);var a=e=>{let t=!1;P.getInstance().query(n=>{var i=[];n.faces.slice().map(e=>{for(var t=[e.family],n=0;n<e.fonts.length;n++)e.fonts[n].family&&t.indexOf(e.fonts[n].family)<0&&t.push(e.fonts[n].family);i=i.concat(t)}),s.GPDFImport.updateFontFamilies(i),t||(t=!0,e())},"%",!0)},l=function(e,i,a,s){if(e)return new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.image-too-big"))).open(),void this._updateStatus(_.LoadFailed);t.progress(100);var l=gDesigner.createScene(),c=l.getActivePage(),d=new r.GImage;d.setProperties(["iw","ih","url"],[a,s,i]),c.setProperties(["w","h","bck"],[a,s,"PNG"!==o?r.GRGBColor.WHITE:null]),c.appendChild(d),n.getName()&&this.setTitle(n.getName()),this.setScene(l),this._updateStatus(_.Loaded),gDesigner.gtmEvent("DOCUMENT_IMPORT_EVENT")}.bind(this);n.read(async e=>{if("GVDESIGN"===o||o===B.ext.toUpperCase()){gDesigner.stats("document_open_".concat(o.toLowerCase())),t.checkAnnotations=!0;const i=P.getInstance();i.setShowMissingFontsDialog(!1);const r=new p.default;r.start(),this._loadDataIntoDocument(e,t).finally(async()=>{try{const e=gDesigner.getWorkspace().getFontManager();await new g.default(e).waitForAllPendingFonts();const t=r.getMissingFonts();t&&t.length&&new E(this,t).open()}finally{r.stop(),i.setShowMissingFontsDialog(!0)}}),gDesigner.addToRecentFiles(n),gDesigner.gtmEvent("DOCUMENT_OPEN_EVENT")}else if($.length&&$.find(e=>e.ext.toUpperCase()===o)){await this._handleSecondaryFormatRead(n,e,t);var i=gDesigner.getWindows().getActiveWindow().getView();if(i&&this.hasCDR()&&!i.getViewConfiguration().multiPageView){var c=this._scene.getActivePage();if(c){var d=c.getContentBBox();if(d&&!d.isEmpty()){var u=d.getSide(r.GRect.Side.CENTER);i.zoomAtCenter(u)}}}gDesigner.gtmEvent("DOCUMENT_OPEN_EVENT")}else if("SVG"===o||"SVGZ"===o)gDesigner.stats("document_open_svg"),s.GSVGImport.import(e,{fontProvider:Z},gDesigner.getWorkspace().getFontManager(),(e,t,i)=>{if(t){let e;if(t instanceof r.GPage)e=gDesigner.createScene(!0),e.appendChild(t),e.setActivePage(t);else{e=gDesigner.createScene();var o=e.getActivePage(),a=null,s=[];if(t instanceof r.GGroup)for(var l=1===t.getChildren().length;t.getFirstChild();){var c=t.getFirstChild();if(t.removeChild(c),o.appendChild(c),l&&c.hasMixin(r.GStylable)){var d=t.getEffects();d&&d.getChildren().length&&d.getChildren().forEach((function(e){c.getEffects().appendChild(e.clone())}))}if(!c.hasMixin(r.GStylable)||null===c.getPaintLayers()||c instanceof r.GImage||c.hasStyleBorder()||c.hasStyleFill())s.push(c),c.getPaintBBox()&&(a=a?a.united(c.getPaintBBox()):c.getPaintBBox())}else s.push(t),o.appendChild(t),a=t.getPaintBBox();r.GUtil.each(s,(function(){})),o.setProperties(["w","h"],[i?i.width:0,i?i.height:0]),i.unit&&e.setProperty("ut",i.unit)}this._updateStatus(_.Loaded),n.getName()&&this.setTitle(n.getName()),this.setScene(e),gDesigner.gtmEvent("DOCUMENT_IMPORT_EVENT")}else this._updateStatus(_.LoadFailed);var u=gDesigner.getWindows().getActiveWindow().getView();u.getViewConfiguration().paintMode=r.GScenePaintConfiguration.PaintMode.Output,u.invalidate()});else if("EPS"===o)gDesigner.stats("document_open_eps"),this._preProcessFonts(r.GLocale.get(new r.GLocaleKey("GDocument","text.keep-fonts-eps"))),s.GEPSImport.import(e,gDesigner.getSetting("eps_outline_fonts",!0),gDesigner.getWorkspace().getFontManager(),(e,t,i,o)=>{if(this._postProcessFonts(),e||!t){e&&new G(e).open(),this._updateStatus(_.LoadFailed);var a=gDesigner.getWindows().getActiveWindow().getView();return a.getViewConfiguration().paintMode=r.GScenePaintConfiguration.PaintMode.Output,void a.invalidate()}var s=gDesigner.createScene(),l=s.getActivePage(),c=null;"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(W=0,console.time("optimization time")),Q(t),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.timeEnd("optimization time"),console.log("Nodes removed: "+W));var d=[];for(s._beginBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),t._blockUpdateChanges();t.getFirstChild();){var u=t.getFirstChild();t.removeChild(u),l.appendChild(u),d.push(u),u.getPaintBBox()&&(c=c?c.united(u.getPaintBBox()):u.getPaintBBox())}l.acceptChildren((function(e){e instanceof r.GText&&e.hasFontsToResolve()&&e.toFakeText()})),t._releaseUpdateChanges(),r.GUtil.each(d,(function(e,t){t.transform((new r.GTransform).translated(-c.getX(),-c.getY()))})),i?l.setProperties(["w","h"],[i?i.width:0,i?i.height:0]):l.trimToContent(),l.setProperty("bck",o||r.GRGBColor.WHITE),s._endBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),this._updateStatus(_.Loaded),n.getName()&&this.setTitle(n.getName()),this.setScene(s),gDesigner.gtmEvent("DOCUMENT_IMPORT_EVENT")},(function(e){new G(e).open()}),(function(e){t&&t.progress&&t.progress(e)}),this.initCancelHandler.bind(this));else if("PDF"===o||"AI"===o){"PDF"===o?gDesigner.stats("document_open_pdf"):gDesigner.stats("document_open_ai"),this._preProcessFonts();var h=0,f=function(e){new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.ai-not-pdf-compatible")),e).open()};a(()=>s.GPDFImport.import(e,{},gDesigner.getWorkspace().getFontManager(),(e,t,i)=>{if(this._postProcessFonts(),e)new G(e).open();else{var o=gDesigner.createScene(!0);o._beginBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),r.GUtil.each(t,(function(e,t){t.setProperty("name",r.GLocale.get(new r.GLocaleKey("GCommonNames","text.page"))+" "+(e+1)),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.time("optimization time"),W=0),Q(t),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.timeEnd("optimization time"),console.log("Nodes removed: "+W)),o.appendChild(t)})),o._endBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),o.setActivePage(t[0]),this._updateStatus(_.Loaded),n.getName()&&this.setTitle(n.getName()),this.setScene(o),i instanceof Array&&i.length&&new E(this,i,null,e=>{e||o.acceptChildren(e=>{e instanceof r.GText&&e.toFakeText()})}).open();var a=gDesigner.getWindows().getActiveWindow().getView();a.getViewConfiguration().paintMode=r.GScenePaintConfiguration.PaintMode.Output,a.invalidate(),gDesigner.gtmEvent("DOCUMENT_IMPORT_EVENT")}},(function(e,n){h=Math.max(h,e/n*100),t.progress(h)}),f))}else if("SKETCH"===o)gDesigner.stats("document_open_sketch"),this._preProcessFonts(),s.GSketchImport.import(e,{progress:t.progress,fontProvider:Z,workspace:gDesigner.getWorkspace()},e=>{this._postProcessFonts();var t=(e=e||{}).pages,i=e.v50error;if(t&&Array.isArray(t)){e.replacedFonts&&new E(this,e.replacedFonts).open();var o=gDesigner.createScene(!0);o._beginBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),t.forEach(e=>{o.appendChild(e)}),o._endBlockChanges([r.GNode._Change.BeforeChildRemove,r.GNode._Change.AfterChildRemove,r.GNode._Change.BeforeChildInsert,r.GNode._Change.AfterChildInsert]),o.setActivePage(t[0]),this._updateStatus(_.Loaded),n.getName()&&this.setTitle(n.getName()),this.setScene(o),gDesigner.gtmEvent("DOCUMENT_IMPORT_EVENT")}else if(i)new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.unsupported-sketch-version-50+"))).open(),this._updateStatus(_.LoadFailed);else{var a={text:"string"==typeof e?e:null};this._updateStatus(_.LoadFailed,a)}});else if("JPG"===o||"JPEG"===o||"PNG"===o||"HEIC"===o)if(gDesigner.stats("document_open_".concat(o.toLowerCase())),"HEIC"===o){const t=new Blob([e]);m.getInstance().then(e=>e.parse(t)).then(e=>s.GBitmapImport.import(e,l)).catch(e=>console.log("Heic conversion error",e))}else s.GBitmapImport.import(e,l);else this._updateStatus(_.LoadFailed)},e=>{e&&(console.log(e),new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.error-reading-file"))).open()),this._updateStatus(_.LoadFailed)},t.progress)}}},j.prototype._handleSecondaryFormatRead=async function(e,t){this._updateStatus(_.LoadFailed,t)},j.prototype._handleSecondaryFormatSave=async function(e,t,n){n&&n(r.GLocale.get(new r.GLocaleKey("GDocument","text.cannot-save")))},j.prototype.store=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=!i.export;var a=e=>{o&&(this._updateStatus(_.SaveFailed,e),this._updateStatus(_.Ready)),n&&n(e)};if("lts"===gDesigner.getEnv()&&!gDesigner.isEnabledProFeatures())return a();if(gContainer.verifyEnoughMemoryToSave(this),!this._scene)return a();var s=e||this._storageItem;if(!s)throw new Error("Unable to save, no storage item available.");var d=s.getExtension(),u={progress:null,filename:i.filename,ext:d&&d.toLowerCase()};o&&this._updateStatus(_.Saving,u);var p=()=>{o&&(this._updateStatus(_.Saved),this._updateStatus(_.Ready)),d!==B.ext.toUpperCase()&&-1===$.findIndex(e=>e.ext.toUpperCase()===d)||!this._editor?gDesigner.gtmEvent("DOCUMENT_EXPORT_EVENT"):(gDesigner.gtmEvent("DOCUMENT_SAVE_EVENT"),o&&this._editor.markSavePoint()),o&&gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.Modified,this));try{d===B.ext.toUpperCase()&&gDesigner.addToRecentFiles(s)}finally{t&&t()}},g=e=>{s.write(e,p,a,u.progress,this)};const h=[N.JPEG.ext.toUpperCase(),N.JPG.ext.toUpperCase(),N.PNG.ext.toUpperCase()],m=[N.JPEG.ext.toUpperCase(),N.JPG.ext.toUpperCase()];if(d===B.ext.toUpperCase()){var y=this._scene,b=0;y.acceptChildren((function(){b++})),u.progress&&u.progress instanceof Function&&u.progress(10),z((function(){var e;try{e=r.GNode.serialize(y,r.GUtil.extend({save:!0},i||{}))}catch(e){return console.error(e),void a(r.GLocale.get(new r.GLocaleKey("GDocument","text.cannot-save")))}null===e||""===e||e.length<b?a(r.GLocale.get(new r.GLocaleKey("GDocument","text.cannot-save"))):(u.progress&&u.progress instanceof Function&&u.progress(50),z((function(){var t=new Uint8Array(f.gzip(e,{level:9}).buffer);u.progress&&u.progress instanceof Function&&u.progress(75),t.byteLength>20+b?g(t):a("GZIP compression fail")})))}))}else if($&&$.find(e=>e.ext.toUpperCase()===d))await this._handleSecondaryFormatSave(u,g,a,i);else if("SVG"===d||"SVGZ"===d){const{exportOptions:e={}}=i;l.GSVGExport.export(this._scene.getActivePage(),e,(e,t)=>{if(e||!t)return a();if(!i.suppressMessages&&!gDesigner.getSetting("disable_warning_unsupported_features",!1)){let e=l.GSVGExport.getUnsupportedFeatures(this._scene.getActivePage());e&&e.length&&new A(e).open()}if("SVGZ"===d)g(new Uint8Array(f.gzip(t,{level:9}).buffer));else if("function"==typeof TextEncoder)g(new TextEncoder("utf-8").encode(t));else{var n=encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})),o=new Uint8Array(n.length);Array.prototype.forEach.call(n,(function(e,t){o[t]=e.charCodeAt(0)})),g(o)}})}else if(h.includes(d)){var w=r.GLength.DPI,C=this._scene.getActivePage();l.GBitmapExport.export(C,null,m.includes(d)?r.GRGBColor.WHITE:null,null,w,1,!0).toImageBuffer(d,e=>g(new Uint8Array(e)))}else if("PDF"===d){var E=this;gDesigner.getUser().then((function(e){var t;t=e&&e.getFullUserName()?e.getFullUserName():r.GLocale.get(new r.GLocaleKey("GDocument","text.default-export-author")),l.GPDFExport.export(E._scene,{dpi:i.dpi||72,progress:u.progress,user:t,jpegQuality:i.jpegQuality||c.JPEG_EXPORT_QUALITY_DEFAULT,title:E.getTitle()},(e,t)=>{if(e||!t)return a(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.pdf-export-error")));var n=new FileReader;n.onload=()=>g(new Uint8Array(n.result)),n.readAsArrayBuffer(new Blob([t]))},null,{message:e=>u.progressInfo&&u.progressInfo(e)})}))}else a()},j.prototype.initCancelHandler=function(e){this._activeWindow&&this._activeWindow.activateCancelLoading(e)},j.prototype.placeOrImport=function(e,t,n,i,o){var l=(e,i)=>{if(i&&e instanceof r.GBlock&&e.setProperty("name",i),t&&e.hasMixin(r.GElement.Transform)){var a=e.getGeometryBBox(),s=a&&a.getX()?a.getX():0,l=a&&a.getY()?a.getY():0,c=t.center?-a.getWidth()/2:0,d=t.center?-a.getHeight()/2:0;e.transform(new r.GTransform(1,0,0,1,t.x-s+c,t.y-l+d),!0)}o&&o([e])||this.insertElement(e,!t,!0,n)},c=(e,t)=>{s.GBitmapImport.import(e,(function(e,n,i,o){if(e)new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.image-too-big"))).open();else{var a=new r.GImage;a.setProperties(["iw","ih","url"],[i,o,n]),l(a,t)}}))};const d=(e,t)=>{let i=t?"".concat(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.loading-file")).replace("%name",t),"..."):r.GLocale.get(new r.GLocaleKey("GDocument","text.opening-your-image")),o=this._activateProgress(i);try{this._preProcessFonts(r.GLocale.get(new r.GLocaleKey("GDocument","text.keep-fonts-eps"))),s.GEPSImport.import(e,gDesigner.getSetting("eps_outline_fonts",!0),gDesigner.getWorkspace().getFontManager(),(e,i,o,a)=>{if(this._deactivateProgress(),this._postProcessFonts(),!e&&i){"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(W=0,console.time("optimization time")),Q(i),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.timeEnd("optimization time"),console.log("Nodes removed: "+W));var s=i,l=i.getPaintBBox();if(a){(s=new r.GRectangle).setBounds(0,0,l.getWidth(),l.getHeight()),s._blockUpdateChanges();var c=new r.GStylable.FillPaintLayer;for(c.setProperties(["_pt"],[a]),s.getPaintLayers().appendChild(c);i.getFirstChild();){var d=i.getFirstChild();i.removeChild(d),d.transform((new r.GTransform).translated(-l.getX(),-l.getY())),s.appendChild(d)}s._releaseUpdateChanges(),s._invalidateGeometryForChildUpdate(!0)}else s.transform((new r.GTransform).translated(-l.getX(),-l.getY()));s.setProperty("name",t||r.GLocale.get(new r.GLocaleKey("GCommonNames","text.image"))),n||this._editor.beginTransaction();try{this._scene.appendChild(s),s.acceptChildren((function(e){e instanceof r.GText&&e.hasFontsToResolve()&&e.toFakeText()}))}finally{n||this._editor.commitTransaction(r.GLocale.get(new r.GLocaleKey("GDocument","text.import-from-eps")))}}else e&&new G(e).open()},e=>{this._deactivateProgress(),new G(e).open()},o,this.initCancelHandler.bind(this))}catch(e){throw this._deactivateProgress(),e}};var u=(e,t,i)=>{let o=t?"".concat(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.loading-file")).replace("%name",t),"..."):r.GLocale.get(new r.GLocaleKey("GDocument","text.opening-your-image")),a=this._activateProgress(o);try{this._preProcessFonts(),s.GPDFImport.import(e,{startPage:1},gDesigner.getWorkspace().getFontManager(),(e,o)=>{if(this._deactivateProgress(),this._postProcessFonts(),e)new G(e).open();else if(o&&o.length){n||this._editor.beginTransaction();try{var a=o.shift();"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.time("optimization time"),W=0),Q(a),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&(console.timeEnd("optimization time"),console.log("Nodes removed: "+W));var s=a.getGeometryBBox(),l=new r.GRectangle;l.setProperty("name",t||r.GLocale.get(new r.GLocaleKey("GCommonNames","text.image"))),l.setBounds(s.getX(),s.getY(),s.getWidth(),s.getHeight()),l.beginUpdate(),a.getChildren().forEach(e=>{a.removeChild(e),l.appendChild(e)}),this._scene.appendChild(l),l.acceptChildren(e=>{e instanceof r.GText&&e.toFakeText()}),l.endUpdate()}finally{n||this._editor.commitTransaction(r.GLocale.get(new r.GLocaleKey("GDocument",i?"text.import-from-ai":"text.import-from-pdf")))}}},e=>a(e),(function(e){new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.ai-not-pdf-compatible")),e).open()}))}catch(e){throw this._deactivateProgress(),e}},p=(e,t,n)=>{t=t&&t.toUpperCase();var i=a.GPlatform.maxPngDataSize;switch("JPG"!==t&&"JPEG"!==t||r.GSystem.operatingSystem!==r.GSystem.OperatingSystem.OSX_IOS&&(i>>=2),t){case"JPG":case"JPEG":case"HEIC":case"GIF":case"PNG":if(e.size>i)return void new G(r.GLocale.get(new r.GLocaleKey("GDocument","text.image-too-big"))).open();"HEIC"===t?m.getInstance().then(t=>t.parse(e)).then(e=>c(e,n)).catch(()=>console.log("HEIC conversion failed")):c(e,n);break;case"SVG":case"SVGZ":((e,t)=>{s.GSVGImport.import(e,{fontProvider:Z},gDesigner.getWorkspace().getFontManager(),(e,n)=>{n&&l(n,t)})})(e,n);break;case"PDF":case"AI":u(e,n,"AI"===t);break;case"EPS":d(e,n)}};if(e instanceof C.Item)e.read(t=>{var n=e.getExtension(),i=e.getName();p(new Blob([t]),n,i)});else{var g=null,h=null;if(!i&&e.name){var f=e.name.lastIndexOf(".");f>=0&&(g=e.name.substr(f+1),h=e.name.substr(0,f))}if(!g&&e.type)for(var y=0;y<j.FileTypes.length;++y)if(j.FileTypes[y].mime===e.type){g=j.FileTypes[y].ext;break}if(!gDesigner.isEnabledProFeatures()){let e=j.FileTypes.find(e=>e.ext.toUpperCase()===g.toUpperCase());if(e&&e.pro)return void gDesigner.handlePROFeatureInterruption()}p(e,g,h)}},j.prototype._preProcessFonts=function(e){if(gContainer.getRuntime()===x.Runtime.Electron){let e=gContainer.getSystemFontsProvider();e&&P.enableProviders([e],!0)}let t=P.getInstance();t&&(e&&(t.keepFontsMessage=e),t.setShowMissingFontsDialog(!1))},j.prototype._postProcessFonts=function(){if(gContainer.getRuntime()===x.Runtime.Electron){let e=gContainer.getSystemFontsProvider();e&&P.disableProviders([e],!0)}let e=P.getInstance();e&&e.setShowMissingFontsDialog(!0)},j.prototype._activateProgress=function(e){if(this._activeWindow){let t=this._activeWindow.activateProgress(e,!0).find("progress");return e=>t.val(e)}return e=>console.info("progress",e)},j.prototype._deactivateProgress=function(){this._activeWindow&&this._activeWindow.deactivateProgress()},j.prototype.activate=function(){this._updateState()},j.prototype.isCollaborativeTextEditing=function(){return!1},j.prototype.getCollaborativeTextController=function(){return null},j.prototype.deactivate=function(){},j.prototype.release=function(){this._scene&&this.setScene(null),this.getStorageItem()&&this.getStorageItem().release(),this.removeAllEventListeners(!0)},j.prototype.publish=function(e){const t=this._storageItem&&this._storageItem.getExtension(),n=!!$.find(e=>e.ext.toUpperCase()===t);let i=!1,o=!0;return e&&(i=e.collabTextUpdate,o=e.sendEmail),this.getId()&&c.gApi.realtime&&c.gApi.realtime.publishFile?c.gApi.realtime.publishFile(this.getId(),{sessionId:this.sessionId},n,i,o):Promise.resolve()},j.prototype._afterInsertNodeEvent=function(e){if(e.node instanceof r.GGroup&&e.node.getFirstChild())this._updateDocumentColorsFromGroup(e.node);else if(e.node instanceof r.GElement&&e.node.hasMixin(r.GElement.Stylable))this._updateDocumentColors(e.node);else if(e.node instanceof r.GStylable.PaintLayer){if(this._updateDocumentColorsFromElement(e.node,["_pt"]),this.hasCDR()){var t=e.node.getParent();t&&(e.node instanceof r.GStylable.FillPaintLayer?t.getFillLayers(!0).length>1&&R.showCDRUnsupportedObjectWarning():e.node instanceof r.GStylable.BorderPaintLayer&&t.getBorderLayers(!0).length>1&&R.showCDRUnsupportedObjectWarning())}}else e.node instanceof r.GStylable.Effect&&this.hasCDR()&&R.showCDRUnsupportedObjectWarning(e.node);this._updateSymbolLock(this._scene.getActivePage())},j.prototype._beforeRemoveNodeEvent=function(e){this._updateSymbolLock(e.node,!0)},j.prototype._afterRemoveNodeEvent=function(e){e.node instanceof r.GGroup&&e.node.getFirstChild()?this._updateDocumentColorsFromGroup(e.node,!0):e.node instanceof r.GElement&&e.node.hasMixin(r.GElement.Stylable)?this._updateDocumentColors(e.node,!0):e.node instanceof r.GStylable.PaintLayer&&this._updateDocumentColorsFromElement(e.node,["_pt"],!0),e.node instanceof r.GText&&this._updateDocumentColorsFromElement(e.node,["content"],!0)},j.prototype._beforePropertiesChangeEvent=function(e){e.node instanceof r.GSymbol&&null===e.values[e.properties.indexOf("masterRef")]&&this._updateSymbolLock(e.node,!0)},j.prototype._afterPropertiesChangeEvent=function(e){if(!e.temporary){const t=t=>{if(this.hasCDR()&&!e.node.hasMixin(r.GAnnotation)&&e.properties.includes(t)){const n=e.node.getProperty(t);n&&n!==r.GPaintCanvas.BlendMode.Normal&&R.showCDRUnsupportedObjectWarning()}};if(e.node instanceof r.GStylable.PaintLayer?(this._handlePropertiesChangedForDocumentColorsElement(e.node,["_pt"],e.properties,e.values),t("_bl")):(e.node.hasMixin(r.GStylable)&&t("_sbl"),e.node instanceof r.GText&&this._handlePropertiesChangedForDocumentColorsElement(e.node,["content"],e.properties,e.values)),!gDesigner.isEnabledProFeatures()){-1!==e.properties.indexOf("lkt")&&(0,d.isSymbolInstance)(e.node)&&(e.node instanceof r.GSymbol?e.node.acceptChildren(e=>e instanceof r.GElement&&e.setFlag(r.GElement.Flag.FullLocked)):e.node.setFlag(r.GElement.Flag.FullLocked))}}},j.prototype._afterFlagChangeEvent=function(e){const t=e.node;e.flag===r.GNode.Flag.Selected&&t instanceof r.GCollabText&&gDesigner.stats("document_canvas_select-collab-text")},j.prototype._licenseChangedEvent=function(){this._updateSymbolLock(this._scene)},j.prototype.lock=function(){},j.prototype.unlock=function(){},j.prototype.isLocked=function(){return!1},j.prototype.lockByVersionHistory=function(){this._lockedByVersionHistory=!0},j.prototype.isLockedByVersionHistory=function(){return this._lockedByVersionHistory},j.prototype._updateState=function(){if(this._scene){if(this._editable)this._scene.accept(e=>{if(e instanceof r.GElement){e.setProperty("plkt",r.GBlock.ProgramLck.NoLock);const t=e.getProperty("_lkt",!0);void 0!==t&&e.setProperty("lkt",t)}});else if(this._scene.accept(e=>{if(e instanceof r.GElement){void 0===e.getProperty("_lkt",!0)&&e.setProperty("_lkt",e.getProperty("lkt")||null,!0),e.setProperty("lkt",r.GBlock.LockType.Full)}}),this._annotationsEditable){const e=r.GBlock.ProgramLck.NoSizeChanges|r.GBlock.ProgramLck.NoEdit|r.GBlock.ProgramLck.NoMove|r.GBlock.ProgramLck.NoOrigChildrenEdit|r.GBlock.ProgramLck.NoNewChildren|r.GBlock.ProgramLck.NoDelete|r.GBlock.ProgramLck.NoDirectVisibilityChange|r.GBlock.ProgramLck.NoSelect;this._scene.iteratePages(t=>{t.acceptChildren(t=>{t instanceof r.GElement&&t.setProperty("plkt",e),t.hasMixin(r.GAnnotation)&&(t.setProperty("lkt",null),t.setProperty("plkt",e&~r.GBlock.ProgramLck.NoSelect))}),t.setProperty("plkt",e),t.setProperty("lkt",null)},!0)}this._updateSymbolLock(this._scene)}},j.prototype._updateSymbolLock=function(e,t){if(!this._editable)return;const n=!t;if(e=e||this._scene){const i=t=>{e.accept(e=>{if((0,d.isSymbolInstance)(e)){if(e instanceof r.GSymbol&&null===e.getProperty("masterRef"))return!1;!(e instanceof r.GSymbol)&&e instanceof r.GElement&&t(e)}})};gDesigner.isEnabledProFeatures()?this._lockedSymbolInstances&&(i(e=>e.setProperty("lkt",e.getProperty("lkt"),n,!0)),this._lockedSymbolInstances=!1):(i(e=>{t?e.hasFlag(r.GElement.Flag.FullLocked)&&e.removeFlag(r.GElement.Flag.FullLocked):e.setFlag(r.GElement.Flag.FullLocked),e.setProperty("_pro",n,!0)}),this._lockedSymbolInstances=!0)}},j.prototype._modifiedEvent=function(e){gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.Modified,this,e.data?e.data:null))},j.prototype._dropFileEvent=function(e){var t=null;if(e.file.name){var n=e.file.name.lastIndexOf(".");n>=0&&(t=e.file.name.substr(n+1))}if(!t&&e.file.type)for(var i=0;i<j.FileTypes.length;++i)if(j.FileTypes[i].mime===e.file.type){t=j.FileTypes[i].ext;break}gDesigner.stats("document_drop_file",t),this.placeOrImport(e.file,{x:e.position.getX(),y:e.position.getY()})},j.prototype._updateStatus=function(e,t){e!==this._status&&(this._status=e,this.hasEventListeners(b)&&this.trigger(new b(e,t)),P.getInstance().trigger(new b(e,t)),this._status===_.Loaded&&this.isCommercialProductFile()&&this.openPaywall())},j.prototype.updateStatus=function(e,t){this._updateStatus(e,t||{})},j.prototype._extractUsedDocumentRef=function(e){return e&&0===e.indexOf("document://")&&(e=e.substr("document://".length)),null},j.prototype._addDocumentColors=function(e){for(var t=0;t<e.length;++t){var n=r.GPattern.serialize(e[t]);this._documentColors.hasOwnProperty(n)?this._documentColors[n]+=1:this._documentColors[n]=1}},j.prototype._clearDocumentColors=function(e){for(var t=0;t<e.length;++t){var n=r.GPattern.serialize(e[t]);this._documentColors.hasOwnProperty(n)&&0==--this._documentColors[n]&&delete this._documentColors[n]}},j.prototype._updateDocumentColors=function(e,t){var n=e.getPaintLayers();n&&r.GUtil.each(n.getLayers(),function(e,n){t?this._updateDocumentColorsFromElement(n,["_pt"],t):this._updateDocumentColorsFromElement(n,["_pt"])}.bind(this))},j.prototype._updateDocumentColorsFromGroup=function(e,t){for(var n=e.getChildren(),i=0;i<n.length;i++){var o=n[i];o instanceof r.GGroup||!o.hasMixin(r.GElement.Stylable)?this._updateDocumentColorsFromGroup(o,t):this._updateDocumentColors(o,t)}},j.prototype._updateDocumentColorsFromElement=function(e,t,n){for(var i=[],o=0;o<t.length;++o){var a=e.getProperty(t[o]);if(a){!function n(o,a,s){if(o instanceof r.GColor)i.push(o);else if(o instanceof r.GGradient)for(var l=o.getStops(),c=0;c<l.length;++c)i.push(l[c].color);else if("content"===t[s]&&e instanceof r.GText&&a){var d=e.getTLCore().getRichContent();if(d&&d.length)n(e._getGravitValue("fontColor",d[0].fontColor),!1,s)}}(a,!0,o)}}i.length&&(n?this._clearDocumentColors(i):this._addDocumentColors(i))},j.prototype._handlePropertiesChangedForDocumentColorsElement=function(e,t,n,i){for(var o=[],a=[],s=[],l=0;l<t.length;++l){var c=n.indexOf(t[l]);if(c>=0){o.push(c),a.push(t[l]);!function t(i,o,a){if(i instanceof r.GColor)s.push(i);else if(i instanceof r.GGradient)for(var l=i.getStops(),c=0;c<l.length;++c)s.push(l[c].color);else if("content"===n[a]&&e instanceof r.GText&&i&&o){var d=JSON.parse(i);if(d[0]&&d[0].fontColor)t(e._getGravitValue("fontColor",d[0].fontColor),!1,a)}}(i[c],!0,c)}}s.length&&this._clearDocumentColors(s),a.length&&this._updateDocumentColorsFromElement(e,a)},j.prototype.setSynchronizing=function(e){e!==this._synchronizing&&(this._synchronizing=e,gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.SynchronismUpdated,this)))},j.prototype.isSynchronizing=function(){return this._synchronizing},j.prototype.setErrored=function(e){e!==this._errored&&(this._errored=!!e,gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.Modified,this)))},j.prototype.buildPreview=function(){return new Promise(e=>{for(var t=null,n=this._scene.getFirstChild();null!==n;n=n.getNext())if(n instanceof r.GPage){t=n;break}if(t){var i=t._getBitmapPaintArea(),o=l.GBitmapExport.convertSizeToScale(i.getWidth(),i.getHeight(),i.getWidth()>i.getHeight()?"600w":"600h");t.toBitmap(o.getX(),o.getY(),2,r.GRGBColor.WHITE).toImageBlob("image/jpeg",e)}})},j.prototype.hasPagesWithInfiniteEmptyCanvas=function(){for(var e=this._scene.getFirstChild();null!==e;e=e.getNext())if(e instanceof r.GPage&&!e.getGeometryBBox())return!0;return!1},j.prototype.setReservedId=function(e){this._reservedId=e},j.prototype.getReservedId=function(){return this._reservedId},j.prototype.getLastDownloadSize=function(){return this._lastDownloadSize},j.prototype.setLastDownloadSize=function(e){this._lastDownloadSize=e},j.waitToRendererProcess=z;var W,q=Object.keys(r.GShape.GeometryProperties).concat(Object.keys(r.GShape.MetaProperties)).concat(Object.keys(r.GItem.MetaProperties)).concat(Object.keys(r.GBlock.VisualProperties)).concat(Object.keys(r.GBlock.MetaProperties)).concat(Object.keys(r.GElement.Anchor.MetaProperties));function Y(e,t){if(e.constructor!==t.constructor)return!1;if(!(e instanceof r.GShape))return!1;if(!t.getFirstChild())return!1;if(!e.arePropertiesEqual(t,q))return!1;var n=t.$ps;return t.$ps=e.getStylePropertySets(),r.GStylable.prototype.equalsStyle.call(e,t)?(t.$ps=n,!0):(t.$ps=n,!1)}function X(e,t){if(!e.arePropertiesEqual(t,Object.keys(r.GPath.GeometryProperties)))return!1;for(var n=Object.keys(r.GPathBase.AnchorPoint.GeometryProperties),i=e.getAnchorPoints(),o=t.getAnchorPoints(),a=i.getFirstChild(),s=o.getFirstChild();a&&s;a=a.getNext(),s=s.getNext())if(!a.arePropertiesEqual(s,n))return!1;return null===a&&null===s}function Q(e){e._blockUpdateChanges();let t=e.getFirstChild();for(;t;){var n=t.getNext();if(n){if(!Y(t,n)){t=n;continue}if(!(t instanceof r.GPath)){t=n;continue}if(!X(t,n)){t=n;continue}e.removeChild(n),t._blockUpdateChanges();for(var i=n.getFirstChild();null!==i;i=i.getNext())n.removeChild(i),t.appendChild(i);t._releaseUpdateChanges(),W++}else t=n}for(t=e.getFirstChild();null!==t;t=t.getNext())Q(t);e._releaseUpdateChanges()}var Z={queryFirst:function(e,t){const n=(e,t)=>{let n,i,o,r,a,s,l,c,d,u,p,g=e.length,h=t.length;if(0===g)return h;if(0===h)return g;for(g>h&&(n=e,e=t,t=n),s=new Int8Array(g+1),i=0;i<=g;i++)s[i]=i;for(i=1;i<=h;i++){for(r=i,p=t[i-1],o=1;o<=g;o++)p===e[o-1]?a=s[o-1]:(l=r+1,c=s[o]+1,d=l-(l-c&c-l>>7),u=s[o-1]+1,a=d-(d-u&u-d>>7)),s[o-1]=r,r=a;s[g]=r}return s[g]};var i=0,o=[];e.fontName&&o.push(e.fontName),o.length?o[0]!==e.fontFamily&&o.push(e.fontFamily):o.push(e.fontFamily);P.getInstance().query((function r(a){var s;a.faces.length?(s=function(t){var i={family:t[0].fonts[0].family||t[0].family,weight:t[0].fonts[0].weight,style:t[0].fonts[0].style},o=e.fontName||e.fontFamily||gDesigner.getWorkspace().getFontManager().getDefaultFont().getFamily(),r=n(i.family,o),a=0,s=i.family;for(let e=0;e<t.length;e++){var l=t[e];let i;if(l.families)for(var c=0;c<l.families.length;c++)i=n(l.families[c],o),i<r&&(r=i,a=e,s=l.families[c]);else i=n(l.family,o),i<r&&(r=i,a=e,s=l.family)}i=null;var d=t[a];for(let t=0;t<d.fonts.length;t++){var u=d.fonts[t];if(!u.family||u.family===s){if(u.style===e.fontStyle&&u.weight===e.fontWeight){i={family:u.family||d.family,weight:u.weight,style:u.style};break}i||(i={family:u.family||d.family,weight:u.weight,style:u.style})}}return i}(a.faces),t(s)):i<o.length-1?(i++,setTimeout(()=>P.getInstance().query(r,o[i]))):t(null)}),o[i])}};e.exports=j},function(e,t,n){var i=n(119);e.exports=function(e,t){var n=e[t];return null==n?void 0:i(n)}},,function(e,t,n){"use strict";var i={};(0,n(85).assign)(i,n(416),n(419),n(285)),e.exports=i},,,,function(e,t,n){"use strict";var i=n(17);n(261),n(84),n(58),n(28),n(25),n(14),n(29),n(132);var o=n(32),r=i(n(238));const{FILE_ID_PREFIX:a}=n(12);function s(){this._permissions=[]}s.prototype.parent=null,s.prototype._previewURL=null,s.prototype.setPreviewURL=function(e){this._previewURL=e},s.prototype.getPreviewURL=function(){return this._previewURL},s.prototype.getParentId=function(){const e=this.getParent();return e instanceof s?e.getId():e},s.prototype.getParent=function(){return this.parent},s.prototype.getId=function(){return this.id},s.prototype._permissions=null,s.prototype._itemType=null,s.prototype.storage=null,s.prototype.settings=null,s.prototype.autosave=null,s.prototype.getStorage=function(){return this.storage},s.prototype.isAutoSavedVersion=function(){return this.autosave},s.prototype.getExtension=function(){const e=this.extension||this.ext;return e&&e.toLowerCase()||null},s.prototype.getNameWithExtension=function(){let e=this.getName();e=s.normalizeMultipleDotsEnd(e);const t=".".concat(this.getExtension());return!e.toLowerCase().endsWith(t)?e+=t:e=e.substr(0,e.lastIndexOf("."))+t,e},s.prototype.getNameWithoutExtension=function(){return(0,o.getFileNameWithoutExtension)(this.getName(),this.getExtension())},s.prototype.getName=function(){return this.name.trim()},s.prototype.setItemType=function(e){if(!Object.values(s.Type).includes(e))throw Error("Invalid type!");this._itemType=e},s.prototype.getType=function(){return this._itemType},s.prototype.getPermissions=function(){return this._permissions},s.prototype.revokePermissions=function(){this._permissions=[]},s.prototype.getIcon=function(){return this.icon},s.prototype.setMimeType=function(e){this._mimetype=e},s.prototype.getMimeType=function(){return this._mimetype||this.mimeType||this.type},s.prototype.setSize=function(e){this._size=e},s.prototype.getSize=function(){return this._size},s.prototype.hasPermission=function(e){return this._permissions.includes(e)},s.prototype.setPermission=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._permissionSupported(e)){if(t)this.hasPermission(e)||this._permissions.push(e);else if(this.hasPermission(e)){var n=this._permissions.indexOf(e);this._permissions.splice(n,1)}}else console.warn("Permission not supported: "+e)},s.prototype.setVersion=function(e){this._version=e},s.prototype.getVersion=function(){return this._version},s.prototype.setModificationTime=function(e){this._modificationTime=e},s.prototype.getModificationTime=function(){return this._modificationTime},s.prototype.setPermissions=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.forEach(e=>this.setPermission(e,t))},s.prototype._permissionSupported=function(e){return Object.values(s.Permission).includes(e)},s.from=function(e){var t=new s;return(t=Object.assign(t,e)).settings&&(t.settings=s.GCloudSettings.from(t.settings)),t},s.parseFromJSON=function(e,t){try{const t=JSON.parse(e);return s.from(t)}catch(e){if(!t&&void 0===t)throw e;return t}},s.Permission={Open:"open",Copy:"copy",Editing:"editing",Rename:"rename",CutPaste:"cutPaste",Download:"download",Delete:"delete"},s.Storage={GoogleDrive:"GOOGLE_DRIVE",SharePoint:"SHAREPOINT",OneDriveBusiness:"ONEDRIVE_BUSINESS",Gravit:"GRAVIT_CLOUD"},s.Type={Folder:"folder",File:"file",CorporateStorage:"corporate-storage"},s.GCloudSettings=function(){},s.GCloudSettings.from=function(e){let t=new s.GCloudSettings;return t=Object.assign(t,e),t},s.GCloudSettings.parseFromJSON=function(e,t){try{const t=JSON.parse(e);return s.GCloudSettings.from(t)}catch(e){if(!t&&void 0===t)throw e;return t}},s.getPrefixIdForStorage=function(e){switch(e){case s.Storage.Gravit:return"";case s.Storage.GoogleDrive:return a.GOOGLEDRIVE;case s.Storage.SharePoint:return a.SHAREPOINT;case s.Storage.OneDriveBusiness:return a.ONEDRIVEBUSINESS}throw new Error("Unsupported storage!")},s.getFileStorageId=function(e){if(!e.id)return null;const t=s.getPrefixIdForStorage(e.storage);let n=e.id;return t&&(n=n.replace("".concat(t,"_"),"")),n},s.getCollaborativeFileId=function(e,t){const n=s.getPrefixIdForStorage(t);return"".concat(n?n+"_":"").concat(e)},s.createOrReturnSelfInstance=function(e){return e instanceof s?e:s.from(e)},s.getExtensionFromName=function(e){const t=e.match(r.default.String.FileExtension);return t?t[0].slice(1):null},s.normalizeMultipleDotsEnd=function(e){if(e.endsWith(".")){const t=e.match(r.default.String.MultipleDotsEnd);if(t)return e.slice(0,t.index)}return e},e.exports=s},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var i=n(22),o=i({}.toString),r=i("".slice);e.exports=function(e){return r(o(e),8,-1)}},function(e,t,n){var i=n(22),o=n(52),r=n(557);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,i){return o(n),r(i),t?e(n,i):n.__proto__=i,n}}():void 0)},function(e,t,n){var i=n(73).f,o=n(59),r=n(38)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){var i=n(6),o=n(559),r=n(34),a=n(153),s=n(38)("toStringTag"),l=i.Object,c="Arguments"==a(function(){return arguments}());e.exports=o?a:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=l(e),s))?n:c?a(t):"Object"==(i=a(t))&&r(t.callee)?"Arguments":i}},function(e,t,n){var i=n(22);e.exports=i([].slice)},function(e,t,n){"use strict";var i=n(47),o=n(22),r=n(27),a=n(278),s=n(52),l=n(273),c=n(104),d=n(223),u=a.ArrayBuffer,p=a.DataView,g=p.prototype,h=o(u.prototype.slice),f=o(g.getUint8),m=o(g.setUint8);i({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:r((function(){return!new u(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(h&&void 0===t)return h(s(this),e);for(var n=s(this).byteLength,i=l(e,n),o=l(void 0===t?n:t,n),r=new(d(this,u))(c(o-i)),a=new p(this),g=new p(r),y=0;i<o;)m(g,y++,f(a,i++));return r}})},function(e,t,n){var i,o=n(52),r=n(377),a=n(274),s=n(272),l=n(366),c=n(220),d=n(271),u=d("IE_PROTO"),p=function(){},g=function(e){return"<script>"+e+"<\/script>"},h=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&i?h(i):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(g("document.F=Object")),e.close(),e.F):h(i);for(var n=a.length;n--;)delete f.prototype[a[n]];return f()};s[u]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(p.prototype=o(e),n=new p,p.prototype=null,n[u]=e):n=f(),void 0===t?n:r(n,t)}},,function(e,t){e.exports=require("fs")},,function(e,t,n){"use strict";var i=n(47),o=n(126),r=n(361),a=n(27),s=n(96),l=n(34),c=n(223),d=n(368),u=n(80);if(i({target:"Promise",proto:!0,real:!0,forced:!!r&&a((function(){r.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=c(this,s("Promise")),n=l(e);return this.then(n?function(n){return d(t,e()).then((function(){return n}))}:e,n?function(n){return d(t,e()).then((function(){throw n}))}:e)}}),!o&&l(r)){var p=s("Promise").prototype.finally;r.prototype.finally!==p&&u(r.prototype,"finally",p,{unsafe:!0})}},,function(e,t){var n,i,o=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],d=!1,u=-1;function p(){d&&l&&(d=!1,l.length?c=l.concat(c):u=-1,c.length&&g())}function g(){if(!d){var e=s(p);d=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||d||s(g)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var i=n(6),o=n(22),r=n(27),a=n(119),s=n(314),l=n(185),c=n(408),d=n(409),u=n(194),p=n(410),g=i.Array,h=l.aTypedArray,f=l.exportTypedArrayMethod,m=i.Uint16Array,y=m&&o(m.prototype.sort),v=!(!y||r((function(){y(new m(2),null)}))&&r((function(){y(new m(2),{})}))),_=!!y&&!r((function(){if(u)return u<74;if(c)return c<67;if(d)return!0;if(p)return p<602;var e,t,n=new m(516),i=g(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,i[e]=e-2*t+3;for(y(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==i[e])return!0}));f("sort",(function(e){return void 0!==e&&a(e),_?y(this,e):s(h(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!_||v)},function(e,t,n){"use strict";var i=n(6),o=n(184),r=n(185),a=n(27),s=n(157),l=i.Int8Array,c=r.aTypedArray,d=r.exportTypedArrayMethod,u=[].toLocaleString,p=!!l&&a((function(){u.call(new l(1))}));d("toLocaleString",(function(){return o(u,p?s(c(this)):c(this),s(arguments))}),a((function(){return[1,2].toLocaleString()!=new l([1,2]).toLocaleString()}))||!a((function(){l.prototype.toLocaleString.call([1,2])})))},function(e,t,n){var i=n(47),o=n(583);i({global:!0,forced:parseFloat!=o},{parseFloat:o})},,,function(e,t,n){"use strict";var i=n(47),o=n(620).left,r=n(312),a=n(194),s=n(224);i({target:"Array",proto:!0,forced:!r("reduce")||!s&&a>79&&a<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},,function(e,t){e.exports=jQuery},function(e,t,n){var i=n(67),o=n(49),r=n(355),a=n(152),s=n(178),l=n(219),c=n(59),d=n(358),u=Object.getOwnPropertyDescriptor;t.f=i?u:function(e,t){if(e=s(e),t=l(t),d)try{return u(e,t)}catch(e){}if(c(e,t))return a(!o(r.f,e,t),e[t])}},function(e,t,n){"use strict";n(25),n(14),n(63),n(3),n(115),n(84);var i=n(238),o=n(12);const{GObject:r}=n(1),a=n(647),s={},l=["#B30000","#B35900","#999900","#59B300","#009966","#00B3B3","#0095B3","#006699","#003CB3","#1E00B3","#5900B3","#9500B3","#B30077","#E60000","#E67300","#E69900","#5500FF","#BF00FF"];function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,e)}r.inheritAndMix(c,r,[a,o.User]),c.equals=function(e,t){return new c(e).getUID()===new c(t).getUID()},c.prototype.hasOwnPictureAvatar=function(){return this.avatar&&this.avatar.split("?")[1]&&"v="===this.avatar.split("?")[1].substr(0,2)},c.prototype.getUID=function(){return!this.id&&o.ANONYMOUS_SESSION_ENABLED?this.user_id||this.session_id||"":this.id||this.user_id||""},c.prototype.getUserColor=function(){if(!this._color){const t=this.getUID();if(!s[t]){var e=l.shift();s[t]=e||"#"+((32*Math.random()|0)<<3|(32*Math.random()|0)<<11|(32*Math.random()|0)<<19).toString(16)}this._color=s[t]}return this._color},c.prototype.getEmail=function(){return o.CloudUtils.getUserEmail(this)},c.prototype.isDeactivated=function(){return!!this.deactivated},c.prototype.isAnonymous=function(){return this.anonymous},c.prototype.isGravitAccount=function(){const e=this.getEmail();return/\@(gravit\.io|designer\.io|corel\.com)$/.test(e)},c.prototype.isEmailVerified=function(){return!!this.email_verified},c.prototype.getFirstName=function(){try{if(this.name&&this.name.trim()){return this.name.trim().split(i.GRegex.String.SpacesLineBreak)[0]}return this.name||""}catch(e){return""}},c.prototype.getUserNameInitials=function(){const e=this.getFirstName();try{if(this.last_name&&this.last_name.trim()){const t=this.last_name;return"".concat(e.substr(0,1)).concat(t.substr(0,1)).toLocaleUpperCase()}return e?"".concat(e.substr(0,1)):""}catch(t){return e?"".concat(e.substr(0,1)):""}},c.prototype.getLastName=function(){return this.last_name},c.prototype.getUserReference=function(){return this.email||this.login||this.getFullUserName()},c.prototype.getAccountName=function(){return this.email||this.login||""},e.exports=c},,,function(e,t,n){var i=n(218),o=n(95);e.exports=function(e){return i(o(e))}},function(e,t,n){var i=n(6).String;e.exports=function(e){try{return i(e)}catch(e){return"Object"}}},function(e,t,n){var i=n(67),o=n(59),r=Function.prototype,a=i&&Object.getOwnPropertyDescriptor,s=o(r,"name"),l=s&&"something"===function(){}.name,c=s&&(!i||i&&a(r,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},function(e,t,n){var i=n(6),o=n(125),r=i.TypeError;e.exports=function(e,t){if(o(t,e))return e;throw r("Incorrect invocation")}},function(e,t){e.exports={}},function(e,t,n){var i=n(156),o=n(145),r=n(182),a=n(38)("iterator");e.exports=function(e){if(null!=e)return o(e,a)||o(e,"@@iterator")||r[i(e)]}},function(e,t){var n=Function.prototype,i=n.apply,o=n.bind,r=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(o?r.bind(i):function(){return r.apply(i,arguments)})},function(e,t,n){"use strict";var i,o,r,a=n(375),s=n(67),l=n(6),c=n(34),d=n(62),u=n(59),p=n(156),g=n(179),h=n(89),f=n(80),m=n(73).f,y=n(125),v=n(225),_=n(154),b=n(38),w=n(270),C=l.Int8Array,E=C&&C.prototype,S=l.Uint8ClampedArray,G=S&&S.prototype,A=C&&v(C),T=E&&v(E),P=Object.prototype,L=l.TypeError,D=b("toStringTag"),x=w("TYPED_ARRAY_TAG"),I=w("TYPED_ARRAY_CONSTRUCTOR"),O=a&&!!_&&"Opera"!==p(l.opera),k=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},R={BigInt64Array:8,BigUint64Array:8},M=function(e){if(!d(e))return!1;var t=p(e);return u(F,t)||u(R,t)};for(i in F)(r=(o=l[i])&&o.prototype)?h(r,I,o):O=!1;for(i in R)(r=(o=l[i])&&o.prototype)&&h(r,I,o);if((!O||!c(A)||A===Function.prototype)&&(A=function(){throw L("Incorrect invocation")},O))for(i in F)l[i]&&_(l[i],A);if((!O||!T||T===P)&&(T=A.prototype,O))for(i in F)l[i]&&_(l[i].prototype,T);if(O&&v(G)!==T&&_(G,T),s&&!u(T,D))for(i in k=!0,m(T,D,{get:function(){return d(this)?this[x]:void 0}}),F)l[i]&&h(l[i],x,i);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:O,TYPED_ARRAY_CONSTRUCTOR:I,TYPED_ARRAY_TAG:k&&x,aTypedArray:function(e){if(M(e))return e;throw L("Target is not a typed array")},aTypedArrayConstructor:function(e){if(c(e)&&(!_||y(A,e)))return e;throw L(g(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(s){if(n)for(var i in F){var o=l[i];if(o&&u(o.prototype,e))try{delete o.prototype[e]}catch(e){}}T[e]&&!n||f(T,e,n?t:O&&E[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var i,o;if(s){if(_){if(n)for(i in F)if((o=l[i])&&u(o,e))try{delete o[e]}catch(e){}if(A[e]&&!n)return;try{return f(A,e,n?t:O&&A[e]||t)}catch(e){}}for(i in F)!(o=l[i])||o[e]&&!n||f(o,e,t)}},isView:function(e){if(!d(e))return!1;var t=p(e);return"DataView"===t||u(F,t)||u(R,t)},isTypedArray:M,TypedArray:A,TypedArrayPrototype:T}},,,,,,,function(e,t,n){"use strict";var i=n(1);e.exports=class{constructor(e,t){this._cb=t||null,this._dialog=$("<div></div>"),$("<div/>").addClass("message").css({lineHeight:"1.5em"}).append($("<span/>").html(e)).appendTo(this._dialog),this._dialog.gDialog({releaseOnClose:!0,buttons:[$("<button>"+i.GLocale.get(new i.GLocaleKey("GLocale","ok"))+"</button>").on("click",()=>this.close())]})}open(){this._dialog.gDialog("open",!0)}close(){this._dialog.gDialog("close"),this._cb&&this._cb()}}},function(e,t,n){"use strict";e.exports={SidebarsIds:{GInspectorSidebar:"inspector",GAnnotationsSidebar:"annotations",GOutlineSidebar:"outline"}}},function(e,t,n){var i,o,r=n(6),a=n(130),s=r.process,l=r.Deno,c=s&&s.versions||l&&l.version,d=c&&c.v8;d&&(o=(i=d.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&a&&(!(i=a.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=a.match(/Chrome\/(\d+)/))&&(o=+i[1]),e.exports=o},,,,function(e,t,n){"use strict";const i={IS_LOCALHOST:"localhost"===window.location.hostname,IS_RC:!1,IS_BETA:!1,IS_TRUNK:!1,IS_PRODUCTION:!0,IS_LTS:!1,IS_WEB_WORKER:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope};e.exports=i},,function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t){this.status=e,this.data=t}i.GObject.inherit(o,i.GEvent),o.prototype.status=null,o.prototype.data=null,o.prototype.toString=function(){return"[Object GDocumentStatusEvent]"},e.exports=o},function(e,t,n){n(313)("Uint8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},function(e,t,n){"use strict";var i=n(17);n(9),n(83),n(25),n(19),n(24);var o=n(1),r=n(12),a=i(n(305)),s=i(n(36)),l=n(32),c=i(n(501)),d=n(216),u=n(106);const p=n(389),g=n(77);var h=r.FILE_FORMATS.find(e=>e.default),f=r.FILE_FORMATS.filter(e=>!e.default);const m=n(388),y=n(147);function v(e){return fetch(r.gApi.url+"/error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign(e,{ua:window.navigator.userAgent}))})}function _(){}o.GObject.inherit(_,d),_.ProgressStages={Preparing:0,SyncingImages:50,UploadingFile:100},_.from=async function(e,t,n,i,o){let r=t;return"string"==typeof t&&(r=await u.getFileDataForVersionOrAutoSave(t,i,o)),r?new _.Item(e,r.id,n||r.name,r,i||r.version,null,o):null},_.Item=function(e,t,n,i,o,r,a){if(d.Item.call(this,e),this._filename=n,this._id=t,this._file=u.convertToCloudItem(i),this._versionId=o,this._token=r,this._isAutoSave="boolean"==typeof a?a:!(!i||!i.autosave),this._fileLastModifiedDate=i&&new Date(i.updated||i.created),this._fileAutoSaveLastModifiedDate=i&&new Date(i.autosave_updated),i&&f.length){var s=null;i.type?s=f.find(e=>e.type===this._file.getMimeType()):this._file.getExtension()&&(s=f.find(e=>e.ext===this._file.getExtension())),s&&(this._ext=s.ext.toUpperCase(),this._type=s.type)}},o.GObject.inheritAndMix(_.Item,d.Item,[p]),_.Item.prototype._filename=null,_.Item.prototype._ext=null,_.Item.prototype._type=null,_.Item.prototype._id=null,_.Item.prototype._file=null,_.Item.prototype._versionId=null,_.Item.prototype._token=null,_.Item.prototype._isAutoSave=null,_.Item.prototype.isRegistrable=function(){return!!this.getId()},_.Item.prototype.getId=function(){return this._id},_.Item.prototype.isVersionAutoSave=function(){return this._isAutoSave},_.Item.prototype.getToken=function(){return this._token},_.Item.prototype.getFullName=function(){return this._filename},_.Item.prototype.getName=function(){return o.GUtil.xss(this._filename)},_.Item.prototype.getVersionId=function(){return this._versionId||null},_.Item.prototype.setVersionId=function(e){this._versionId=e},_.Item.prototype.storeFileFormatVersion=function(e){return this._fileFormatVersion=e,this.supportsSharing()?r.gApi.updateFileFormat(this.getId(),{fileFormat:this._fileFormatVersion}):Promise.resolve()},_.Item.prototype.setCollaborativeFileStatus=async function(e){if(this._file.status!==e){var t=this._file.status;this._file.status=e,gDesigner.hasEventListeners(a.default.FileStatusUpdate)&&gDesigner.trigger(new a.default.FileStatusUpdate(this,t,e))}},_.Item.prototype.getCollaborativeFile=async function(){return this._file},_.Item.prototype.setFileName=function(e){this._filename=e},_.Item.prototype.getOrCreateCollaborativeFile=async function(){return gDesigner.getCloudCommunicationManager().getFileExtended(this.getId())},_.Item.prototype.getExtension=function(){return this._ext||h.ext.toUpperCase()},_.Item.prototype.getType=function(){return this._type||h.type},_.Item.prototype.setFile=function(e){if(!e)throw new Error("File can not be null");const t=this._file&&this._file.status,n=new r.FileExtended(e);this._file=u.convertToCloudItem(e),this._id=e.id,this._name=e.name,this._versionId=e.version,this._fileLastModifiedDate=new Date(e.updated),this._fileAutoSaveLastModifiedDate=new Date(e.autosave_updated),this._isAutoSave=!!n.isAutoSave(),this._file.status!==t&&null!=t&&gDesigner.hasEventListeners(a.default.FileStatusUpdate)&&gDesigner.trigger(new a.default.FileStatusUpdate(this,t,this._file.status))},_.Item.prototype.getFile=function(){return this._file},_.Item.prototype.read=async function(e,t){if(!this._file.url){const e=await u.getFileDataForVersionOrAutoSave(this._id,this._versionId,this._isAutoSave);this._file.url=e.url}u.loadDesignData(this._id,!0,this._versionId,this._token,this._file,this._isAutoSave).then(t=>{e(t.data)}).catch(t)},_.Item.prototype.supportsSharing=function(){let e=!0;return this._id||(e=!1),e},_.Item.prototype._canPerformExtensionSpecificWrite=function(){return!1},_.Item.prototype._performExtensionSpecificWrite=async function(){},_.Item.prototype._setFileSizeAfterSaved=async function(e){return u.getDesigneDataSize(e).then(e=>{this._fileSizeAfterSaved=e})},_.Item.prototype._performDefaultWrite=async function(e,t,n,i,o){e.updateStatus(g.Saving);const s=e=>{i&&i(e)};return u.syncCloudImages(e,this._id,o,e=>{s(c.default.calculateProgress(_.ProgressStages.Preparing,_.ProgressStages.SyncingImages,e))}).then(i=>{let[d]=i;return(async()=>{if(!d)return v({message:"[cloud] scene is null",stack:"id: ".concat(this._id,"\nscene: ").concat(d)}),this._writing=!1,n&&n("scene is null");try{const u=y.gzip(d,{level:9}),p=u.hasOwnProperty("size")?u.size:u.length;if(p<=0)return v({message:"[cloud] empty scene/blob",stack:"id: ".concat(this._id,"\nscene: ").concat(d)}),this._writing=!1,n&&n("empty blob");const f=y.ungzip(u,{to:"string"});if(this._verifyFileNotTooSmall(p,e),!f)return v({message:"[cloud] invalid Scene",stack:"id: ".concat(this._id,"\nscene original: ").concat(d,"\nscene parsed: ").concat(f)}),this._writing=!1,n&&n("Scene invalid, sending error, please try again or submit a bug issue on https://discuss.gravit.io");var i=m.base64(u);const b=await r.gApi.signedPutUrls(this._id,{type:h.type,md5:i}),w=await this._uploadWithProgress(b.url,{method:"PUT",headers:{"Content-Type":h.type,"Content-Encoding":"gzip","Cache-Control":"public,max-age=31536000","Content-MD5":i},body:u,onProgress:e=>{s(c.default.calculateProgress(_.ProgressStages.SyncingImages,_.ProgressStages.UploadingFile,e))}});if(w.status>=400)return e.updateStatus(g.SaveFailed),this._writing=!1,400===w.status?n&&n("Invalid response, probably corrupted upload: "+w.status):n&&n("Invalid response status: "+w.status);const C=r.COMPUTE_SHA256_FOR_FILES?await(0,l.getFileSHA256Digest)(u):null;await r.gApi.updateFile(this._id,{trashed:!1,sha256:C}),this.setVersionId(null),gDesigner.hasEventListeners(a.default)&&gDesigner.trigger(new a.default(a.default.Type.VersionUpdate,this)),e.updateStatus(g.Saved,o),t&&t(),this._writing=!1}catch(t){this._writing=!1,e.updateStatus(g.SaveFailed),n&&n(t)}})()}).catch(e=>{n(e),this._writing=!1})},_.Item.prototype.write=async function(e,t,n,i,r){if(gContainer.verifyEnoughMemoryToSave(e),!this._writing){if(!e.hasPagesWithInfiniteEmptyCanvas()){this._writing=!0;try{await this._checkUserQuotaLimit()}catch(e){return n&&n(e),void(this._writing=!1)}return this._canPerformExtensionSpecificWrite()?this._performExtensionSpecificWrite(e,t,n,i,r):this._performDefaultWrite(e,t,n,i,r)}n?n({code:507,noFailCall:!0,message:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))}):s.default.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas")))}},_.Item.prototype.createOrUpdateFileWithMetadata=async function(e,t){if(!this._writing){this._writing=!0;try{await this._checkUserQuotaLimit(),await this._createFileInCaseNew(),await this._uploadBinary(e),await this._uploadThumbnail(t.thumbnail),await this._makeFileVisibleUpdateInternalVersionAndHash(e),await this._updateFileAfterSave()}finally{this._writing=!1}}},_.Item.prototype._makeFileVisibleUpdateInternalVersionAndHash=async function(e){const t=r.COMPUTE_SHA256_FOR_FILES?await(0,l.getFileSHA256Digest)(e):null,n={trashed:!1};t&&(n.sha256=t);const i=await r.gApi.updateFile(this.getId(),n);this.setVersionId(i.versionId)},_.Item.prototype._updateFileAfterSave=async function(){const e=await r.gApi.getFile(this._id);this._fileLastModifiedDate=new Date(e.updated),this._file=u.convertToCloudItem(e)},_.Item.prototype._isNewFile=function(){return!this.getId()},_.Item.prototype._createFileInCaseNew=async function(){if(this._isNewFile()){const e=await r.gApi.createFile({name:this.getName(),parent:this._file.getParentId(),type:this.getType(),app:"designer",trashed:null}),t=await r.gApi.getFile(e.id,!0);this._id=this._file.id=e.id,this._fileLastModifiedDate=new Date(t.updated||t.created),this._file.setModificationTime(new Date(t.updated||t.created))}},_.Item.prototype._uploadBinary=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=m.base64(e),i=await r.gApi.signedPutUrls(this.getId(),{type:this.getType(),md5:n}),o=await fetch(i.url,{method:"PUT",headers:Object.assign({"Content-Type":this.getType(),"Cache-Control":"public,max-age=31536000","Content-MD5":n},t),body:e});if(o.status>=400){if(400===o.status)throw new Error("Invalid response, probably corrupted upload: "+o.status);throw new Error("Invalid response status: "+o.status)}},_.Item.prototype._uploadThumbnail=async function(e){if(e)return u.updateFileThumbnail(this.getId(),e.getImageAsBlob(),e.getMimeType())},_.Item.prototype._checkUserQuotaLimit=async function(){const{pro:e,free:t}=gDesigner.getLicense().getQuotas(),n=gDesigner.isEnabledProFeatures()?e:t;if(n>0){if(await r.gApi.quota()>n){const e=new Error(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.running-out-of-cloud-space")));throw e.code=507,e}}},n(995)(_),_.Item.prototype.getUniqueId=function(){return this._id},_.Item.prototype.hasUpdates=async function(){if(!this.getUniqueId())return!1;let e=await this.getLatestFileInfo();const t=e.getModificationTime()||e.updated||e.created,n=this._file.getModificationTime()||this._file.updated||this._file.created;this._fileLastModifiedDate&&!isNaN(this._fileLastModifiedDate.getTime())||(this._fileLastModifiedDate=new Date(n)),this._fileAutoSaveLastModifiedDate&&!isNaN(this._fileAutoSaveLastModifiedDate.getTime())||(this._fileAutoSaveLastModifiedDate=new Date(this._file.autosave_updated));return(e.autosave?Math.max(new Date(t).getTime(),new Date(e.autosave_updated).getTime()):new Date(t).getTime())>(this._file.autosave?Math.max(this._fileLastModifiedDate.getTime(),this._fileAutoSaveLastModifiedDate.getTime()):this._fileLastModifiedDate.getTime())},_.Item.prototype.getLatestFileInfo=async function(){const e=await gDesigner.getCloudCommunicationManager().getFile(this._id);return u.convertToCloudItem(e)},_.Item.prototype.exists=async function(){return u.fileExists(this._id)},_.Item.prototype._uploadWithProgress=function(e,t){return new Promise((n,i)=>{const o=new XMLHttpRequest;if(o.open(t.method||"PUT",e),t.headers)for(let e in t.headers)o.setRequestHeader(e,t.headers[e]);o.onload=()=>n(o),o.onerror=()=>i(o),o.upload&&t.onProgress&&(o.upload.onprogress=e=>{t.onProgress(e.loaded/e.total)}),o.send(t.body)})},e.exports=_},function(e,t,n){"use strict";(function(e){var i=n(229),o=n(469),r=n(470);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|h(t,n),o=(e=s(e,i)).write(t,n);o!==i&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|g(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):p(e,t);if("Buffer"===t.type&&r(t.data))return p(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=s(e,t<0?0:0|g(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|g(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function g(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(i)return $(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return G(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function m(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function y(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,o){var r,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var d=-1;for(r=n;r<s;r++)if(c(e,r)===c(t,-1===d?0:r-d)){if(-1===d&&(d=r),r-d+1===l)return d*a}else-1!==d&&(r-=r-d),d=-1}else for(n+l>s&&(n=s-l),r=n;r>=0;r--){for(var u=!0,p=0;p<l;p++)if(c(e,r+p)!==c(t,p)){u=!1;break}if(u)return r}return-1}function _(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?(i=Number(i))>o&&(i=o):i=o;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");i>r/2&&(i=r/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,i){return K($(t,e.length-n),e,n,i)}function w(e,t,n,i){return K(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function C(e,t,n,i){return w(e,t,n,i)}function E(e,t,n,i){return K(U(t),e,n,i)}function S(e,t,n,i){return K(function(e,t){for(var n,i,o,r=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),i=n>>8,o=n%256,r.push(o),r.push(i);return r}(t,e.length-n),e,n,i)}function G(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function A(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var r,a,s,l,c=e[o],d=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=n)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(r=e[o+1]))&&(l=(31&c)<<6|63&r)>127&&(d=l);break;case 3:r=e[o+1],a=e[o+2],128==(192&r)&&128==(192&a)&&(l=(15&c)<<12|(63&r)<<6|63&a)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:r=e[o+1],a=e[o+2],s=e[o+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&r)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),o+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return d(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,r=Math.min(n,i);o<r;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!r(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,o),o+=a.length}return i},l.byteLength=h,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):f.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var r=(o>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(r,a),c=this.slice(i,o),d=e.slice(t,n),u=0;u<s;++u)if(c[u]!==d[u]){r=c[u],a=d[u];break}return r<a?-1:a<r?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var r=!1;;)switch(i){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}function P(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function L(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var o="",r=t;r<n;++r)o+=B(e[r]);return o}function D(e,t,n){for(var i=e.slice(t,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,i,o,r){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function O(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,r=Math.min(e.length-n,2);o<r;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function k(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,r=Math.min(e.length-n,4);o<r;++o)e[n+o]=t>>>8*(i?o:3-o)&255}function F(e,t,n,i,o,r){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(e,t,n,i,r){return r||F(e,0,n,4),o.write(e,t,n,i,23,4),n+4}function M(e,t,n,i,r){return r||F(e,0,n,8),o.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;n=new l(o,void 0);for(var r=0;r<o;++r)n[r]=this[r+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var i=this[e+--t],o=1;t>0&&(o*=256);)i+=this[e+--t]*o;return i},l.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var i=t,o=1,r=this[e+--i];i>0&&(o*=256);)r+=this[e+--i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,r=0;for(this[t]=255&e;++r<n&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,r=1;for(this[t+o]=255&e;--o>=0&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):k(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var r=0,a=1,s=0;for(this[t]=255&e;++r<n&&(a*=256);)e<0&&0===s&&0!==this[t+r-1]&&(s=1),this[t+r]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var r=n-1,a=1,s=0;for(this[t+r]=255&e;--r>=0&&(a*=256);)e<0&&0===s&&0!==this[t+r+1]&&(s=1),this[t+r]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):k(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):k(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return R(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return R(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return M(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return M(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,r=i-n;if(this===e&&n<t&&t<i)for(o=r-1;o>=0;--o)e[o+t]=this[o+n];else if(r<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(r=t;r<n;++r)this[r]=e;else{var a=l.isBuffer(e)?e:$(new l(e,i).toString()),s=a.length;for(r=0;r<n-t;++r)this[r+t]=a[r%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function $(e,t){var n;t=t||1/0;for(var i=e.length,o=null,r=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&r.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&r.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function U(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(105))},function(e,t,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},,,,,,,,,function(e,t,n){var i,o,r,a,s,l,c,d;e.exports=(d=n(46),n(484),n(485),o=(i=d).lib,r=o.Base,a=o.WordArray,s=i.algo,l=s.MD5,c=s.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=n.hasher.create(),o=a.create(),r=o.words,s=n.keySize,l=n.iterations;r.length<s;){c&&i.update(c);var c=i.update(e).finalize(t);i.reset();for(var d=1;d<l;d++)c=i.finalize(c),i.reset();o.concat(c)}return o.sigBytes=4*s,o}}),i.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)},d.EvpKDF)},,,function(e,t,n){"use strict";var i=n(17);n(9);var o=n(1),r=n(12),a=i(n(987)),s=n(147),l=n(192),c=n(8),d=n(39);function u(){}u.Directory=function(e){this._storage=e},u.Directory.prototype._storage=null,u.Directory.prototype.getStorage=function(){return this._storage},u.Directory.prototype.getUniqueId=function(){return null},u.Directory.prototype.addDirectory=async function(e,t){throw new Error("Not implemented.")},u.Directory.prototype.addFile=async function(e,t){throw new Error("Not implemented.")},u.Item=function(e){this._storage=e},o.GObject.inherit(u.Item,o.GObject),u.Item.prototype._storage=null,u.Item.prototype._fileFormatVersion=null,u.Item.prototype.isRegistrable=function(){return!1},u.Item.prototype.release=function(){this._data&&(this._data=null)},u.Item.prototype.getStorage=function(){return this._storage},u.Item.prototype.getUniqueId=function(){return null},u.Item.prototype.getVersionId=function(){return null},u.Item.prototype.getFile=function(){return null},u.Item.prototype.getId=function(){return null},u.Item.prototype.getFullName=function(){throw new Error("Not implemented.")},u.Item.prototype.setFileName=function(e){throw new Error("Not implemented.")},u.Item.prototype.getName=function(){var e=this.getFullName();if(e){var t=e.lastIndexOf(".");return t>=0?e.substr(0,t):e}return null},u.Item.prototype.getExtension=function(){var e=this.getFullName();if(e){var t=e.lastIndexOf(".");if(t>=0)return e.substr(t+1).toUpperCase()}return null},u.Item.prototype.storeFileFormatVersion=async function(e){this._fileFormatVersion=e},u.Item.prototype.getFileFormatVersion=function(){return this._fileFormatVersion},u.Item.prototype.read=function(e,t,n){throw new Error("Not implemented.")},u.Item.prototype.write=function(e,t,n,i,o){throw new Error("Not implemented.")},u.Item.prototype.createOrUpdateFileWithMetadata=async function(e,t){throw new Error("Not implemented")},u.Item.prototype.getToken=function(){throw new Error("Not implemented")},u.Item.prototype.supportsShadowFile=function(){return!1},u.Item.prototype.isEditingEnabled=function(){return!0},u.Item.prototype.supportsSharing=function(){return!1},u.Item.prototype.hasVersionControl=function(){return!1},u.Item.prototype.supportsExternalSharing=function(){return!1},u.Item.prototype.supportsExternalSharingByLink=function(){return!1},u.Item.prototype.getPermissionsList=function(){},u.Item.prototype._fileSizeBeforeSaved=0,u.Item.prototype._fileSizeAfterSaved=0,u.Item.prototype.documentRealFileSize=0,u.Item.prototype._fileLastModifiedDate=null,u.Item.prototype._fileAutoSaveLastModifiedDate=null,u.Item.prototype._isSaveCounterMeasureEnabled=!1,u.Item.prototype.getFileSizeBeforeSaved=function(){return this._fileSizeBeforeSaved},u.Item.prototype._setFileSizeBeforeSaved=function(e){this._fileSizeBeforeSaved=e},u.Item.prototype.getFileLastModifiedDate=function(){return this._fileLastModifiedDate},u.Item.prototype.setFileLastModifiedDate=function(e){this._fileLastModifiedDate=e},u.Item.prototype.getFileAutoSaveLastModifiedDate=function(){return this._fileAutoSaveLastModifiedDate},u.Item.prototype.setFileAutoSaveLastModifiedDate=function(e){this._fileAutoSaveLastModifiedDate=e},u.Item.prototype._setFileSizeAfterSaved=async function(){throw new Error("Not implemented")},u.Item.prototype.getFileSizeAfterSaved=function(){return this._fileSizeAfterSaved},u.Item.prototype.isSaveCounterMeasureEnabled=function(){return this._isSaveCounterMeasureEnabled},u.Item.prototype.setSaveCounterMeasureEnabled=function(e){this._isSaveCounterMeasureEnabled=e},u.Item.prototype._verifyFileNotTooSmall=function(e,t){try{e<r.UN_BELIVEVABLE_FEW_BYTES_TO_SAVE&&!this.isSaveCounterMeasureEnabled()&&new l(c.get(new d("GDocument","text.saveing-error"))).open(),this.getDocumentRealSizeAfterSave(t)}catch(e){console.error(e)}},u.Item.prototype._verifyFileSizeAfterSaved=function(){try{(()=>!(this.getFileSizeBeforeSaved()<this.getFileSizeAfterSaved())&&this.getFileSizeBeforeSaved()/2>this.getFileSizeAfterSaved())()&&this.getFileSizeAfterSaved()&&this.getFileSizeAfterSaved()>0&&new l(c.get(new d("GDocument","text.saveing-error"))).open()}catch(e){console.error(e)}},u.Item.prototype.notEnoughDiskSpace=function(){new l(c.get(new d("GDocument","text.save-no-space"))).open()},u.Item.prototype.getDocumentRealSizeAfterSave=function(e){let t=null;e=e||gDesigner.getActiveDocument();try{t=o.GNode.serialize(e.getScene(),{save:!0,singleton:!1})}catch(e){return console.error(e),this.documentRealFileSize=0,this.documentRealFileSize}return null===t||""===t?(this.documentRealFileSize=0,this.documentRealFileSize):(this.documentRealFileSize=s.gzip(t,{level:9}).length,this.documentRealFileSize)},u.Item.prototype.hasUpdates=async function(){throw Error("Not implemented!")},u.prototype.canChooseDirectory=function(){return!1},u.prototype.canPromptOpen=function(){return!1},u.prototype.canPromptSave=function(){return!1},u.prototype.canSave=function(){return!1},u.prototype.canDownload=function(){return!1},u.prototype.chooseDirectory=function(e,t){throw new Error("Not implemented.")},u.prototype.openPrompt=function(e,t,n,i){throw new Error("Not implemented.")},u.prototype.savePrompt=function(e,t,n,i){throw new Error("Not implemented.")},u.prototype.download=function(e,t){throw new Error("Not implemented.")},u.prototype.storeLastDirectory=function(e){gDesigner.setSetting("lastDirectory",e)},u.prototype.getLastDirectory=function(){var e=o.GSystem.operatingSystem===o.GSystem.OperatingSystem.Windows?"\\":"/";if(gDesigner.getSetting("lastDirectory"))return gDesigner.getSetting("lastDirectory");if(gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getStorageItem()){let t=gDesigner.getActiveDocument().getStorageItem().getUniqueId();return t.substring(0,t.lastIndexOf(e))}for(var t=0;t<gDesigner.getDocuments().length;++t)if(gDesigner.getDocuments()[t].getStorageItem()){let n=gDesigner.getDocuments()[t].getStorageItem().getUniqueId();return n.substring(0,n.lastIndexOf(e))}return""},u.prototype.getPlugins=function(){return[]},u.prototype.getPluginPath=function(e){return null},u.prototype.getPluginSrc=function(e){return null},u.prototype.getWritePermission=async function(e){return new a.default(!0)},e.exports=u},function(e,t,n){"use strict";n(3);var i=n(1),o=n(32),r=n(1044),a=n(397),s=n(308),l=n(1045),c=n(717),d=n(26);function u(e,t){this._parent=e,this._htmlElement=$("<ul></ul>").addClass("g-menu"),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this));const n=e=>{e.cancelable||(e.stopImmediatePropagation(),"touchmove"===e.type&&this.closeMenus(!0))},i=!!(0,o.isPassiveSupported)()&&{capture:!1,passive:!0};this._htmlElement[0].addEventListener("touchstart",n,i),this._htmlElement[0].addEventListener("touchmove",n,i),this._htmlElement[0].addEventListener("touchend",n,i),t&&this._htmlElement.addClass(t)}i.GObject.inherit(u,i.GEventTarget),u.prototype._parent=null,u.prototype._htmlElement=null,u.prototype._items=null,u.prototype._hovered=!1,u.prototype._tooltipType=null,u.prototype._rangeLeftX=null,u.prototype._rangeLeftY=null,u.prototype._rangeRightX=null,u.prototype._rangeRightY=null,u.prototype.getParent=function(){return this._parent},u.prototype.setTooltipType=function(e){if(e&&"string"==typeof e)return this._tooltipType=e,this},u.prototype.isHovered=function(e){if(this._hovered)return!0;if(e){for(var t=0;t<this.getItemCount();++t){var n=this.getItem(t);if(n instanceof s&&n.getType()===s.Type.Menu&&n.getMenu().isHovered(!0))return!0}return!1}return!1},u.prototype.createMenuItem=function(e){return e?new s(s.Type.Menu,u):new s},u.prototype.createDivider=function(){return new s(s.Type.Divider)},u.prototype.setActiveItem=function(e){let t=this.getActiveItem();t&&t.changeActiveState(!1),e.changeActiveState(!0)},u.prototype.getActiveItem=function(){let e=null;for(let n=0;n<this._items.length;n++){var t=this._items[n];if(t.isActive()){e=t;break}}return e},u.prototype.isRootMenu=function(){return!(this._parent&&this._parent instanceof s)},u.prototype.isSubMenu=function(){return!!(this._parent&&this._parent instanceof s)&&!this._parent.isRootItem()},u.prototype.createAddDivider=function(){return this.createInsertDivider(this.getItemCount())},u.prototype.createInsertDivider=function(e){var t=new s(s.Type.Divider);return this.insertItem(e,t),t},u.prototype.createAddItem=function(e,t,n,i,o){return this.createInsertItem(this.getItemCount(),e,t,n,i,o)},u.prototype.createInsertItem=function(e,t,n,i,o,r){var a=new s(null,null,r);return t instanceof d?a.setAction(t,this._tooltipType):(a.setCaption(t),n&&a.addEventListener(s.ActivateEvent,n),i&&a.addEventListener(s.EnterEvent,i),o&&a.addEventListener(s.LeaveEvent,o)),this.insertItem(e,a),a},u.prototype.addItem=function(e){return this.insertItem(this.getItemCount(),e)},u.prototype.insertItem=function(e,t){null==this._items&&(this._items=[]),e+1<this._items.length?(this._items.splice(e,0,t),this._items[e+1]._htmlElement.before(t._htmlElement)):(this._items.push(t),this._htmlElement.append(t._htmlElement)),t._parent=this},u.prototype.removeItem=function(e){e>=0&&e<this.getItemCount()&&(this._items[e]._parent=null,this._items[e]._htmlElement.detach(),this._items.splice(e,1))},u.prototype.clearItems=function(){if(this._items){for(var e=0;e<this._items.length;++e)this._items[e]._parent=null,this._items[e]._htmlElement.detach();this._items=[]}},u.prototype.getItem=function(e){return e>=0&&e<this.getItemCount()?this._items[e]:null},u.prototype.getItemCount=function(){return this._items?this._items.length:0},u.prototype.indexOf=function(e){return this._items?this._items.indexOf(e):-1},u.prototype.findItem=function(e){for(var t=0;t<this.getItemCount();++t){var n=this.getItem(t);if(e==n.getCaption())return n}return null},u.prototype.update=function(){for(var e=0;e<this.getItemCount();++e){this.getItem(e).update()}},u.prototype.isOpen=function(){return!!this._htmlElement.parent().length},u.prototype.open=function(e,t,n,i){t="number"==typeof t?t:a.Position.Center,n="number"==typeof n?n:a.Position.Center;const o=e&&"number"==typeof e.x&&"number"==typeof e.y,r=this._htmlElement.hasClass("g-touch"),s=!o&&$(e).hasClass("g-menu-button");if(this._htmlElement.toggleClass("g-menu-button",!!s),this.isOpen()||(this.update(),this._htmlElement.appendTo($("body")),this.isSubMenu()||l.setActiveMenu(this,!1,i),this.trigger(c.EVENT)),this._htmlElement.parent().is("body")){var d=this._htmlElement.outerWidth(),u=this._htmlElement.outerHeight(),p=$(window).width(),g=$(window).height(),h={x:0,y:0,width:0,height:0};if(o)h.x=e.x,h.y=e.y;else{var f=$(e),m=f.offset();h.x=m.left,h.y=m.top,h.width=f.outerWidth(),h.height=f.outerHeight()}var y=0;switch(t){case a.Position.Left_Top:(y=h.x-d)<0&&(y=h.x+h.width);break;case a.Position.Center:y=h.x;break;case a.Position.Right_Bottom:(y=h.x+h.width)+d>p&&(y=h.x-d)}var v=0;switch(n){case a.Position.Left_Top:(v=h.y-u)<0&&(v=h.y+h.height);break;case a.Position.Center:v=h.y;break;case a.Position.Right_Bottom:(v=h.y+h.height)+u>g&&(v=h.y-u)}const i=this._rangeLeftX?this._rangeLeftX:0;y<i&&(y=i);const l=this._rangeRightX?this._rangeRightX:p;y+d>=l&&(y=l-d);const c=this._rangeLeftY?this._rangeLeftY:0;v<c&&(v=c);const _=this._rangeRightY?this._rangeRightY:g;if(v+u>=_&&(v=_-u),this._htmlElement.find(".g-menu-arrow").remove(),r&&s){const e=$("<div/>").addClass("g-menu-arrow").prependTo(this._htmlElement);let t=h.width/2-14;t<0&&(y-14>0?(y-=14,t+=14):e.remove()),e.css("left","".concat(t,"px"))}switch(this._htmlElement.css("left",y),this._htmlElement.css("top",v),t){case a.Position.Left_Top:this._htmlElement.addClass("g-menu-left");break;case a.Position.Right_Bottom:this._htmlElement.addClass("g-menu-right")}switch(n){case a.Position.Left_Top:this._htmlElement.addClass("g-menu-top");break;case a.Position.Right_Bottom:this._htmlElement.addClass("g-menu-bottom")}}},u.prototype.close=function(){this.isOpen()&&this._htmlElement.parent().is("body")&&(this.closeMenus(!0),this._htmlElement.removeClass("g-menu-left g-menu-right g-menu-top g-menu-bottom"),this._htmlElement.detach(),this===l._activeMenu&&l.setActiveMenu(null,!0),this.trigger(r.EVENT))},u.prototype.setTouchMode=function(e){this._htmlElement.toggleClass("g-touch",!!e)},u.prototype.closeMenus=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var t=0;t<this.getItemCount();++t){var n=this.getItem(t);n instanceof s&&n.getType()===s.Type.Menu&&(!n.isForcedAsOpened()||e)&&n.getMenu().close()}},u.prototype._mouseOver=function(e){this._hovered=!0},u.prototype._mouseOut=function(e){this._hovered=!1,this.isSubMenu()&&setTimeout(function(){this.isHovered(!0)||this.closeMenus()}.bind(this),150)},u.prototype.getHtmlElement=function(){return this._htmlElement},u.prototype.detach=function(){this.closeMenus(!0),this._htmlElement.find(".g-hover").removeClass("g-hover"),this._htmlElement.removeClass("g-menu-root"),this._htmlElement.detach(),this._parent=null},u.prototype.addClass=function(e){this._htmlElement.addClass(e)},u.prototype.setActiveRangeSize=function(e,t,n,i){this._rangeLeftX=e,this._rangeLeftY=t,this._rangeRightX=this._rangeLeftX+i,this._rangeRightY=this._rangeLeftY+n},u.prototype.toString=function(){return"[Object GMenu]"},e.exports=u},function(e,t,n){var i=n(6),o=n(22),r=n(27),a=n(153),s=i.Object,l=o("".split);e.exports=r((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"==a(e)?l(e,""):s(e)}:s},function(e,t,n){var i=n(552),o=n(266);e.exports=function(e){var t=i(e,"string");return o(t)?t:t+""}},function(e,t,n){var i=n(6),o=n(62),r=i.document,a=o(r)&&o(r.createElement);e.exports=function(e){return a?r.createElement(e):{}}},function(e,t,n){var i=n(22),o=n(34),r=n(268),a=i(Function.toString);o(r.inspectSource)||(r.inspectSource=function(e){return a(e)}),e.exports=r.inspectSource},function(e,t,n){var i=n(6),o=n(49),r=n(119),a=n(52),s=n(179),l=n(183),c=i.TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(r(n))return a(o(n,e));throw c(s(e)+" is not iterable")}},function(e,t,n){var i=n(52),o=n(364),r=n(38)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[r])?t:o(n)}},function(e,t,n){var i=n(153),o=n(6);e.exports="process"==i(o.process)},function(e,t,n){var i=n(6),o=n(59),r=n(34),a=n(97),s=n(271),l=n(572),c=s("IE_PROTO"),d=i.Object,u=d.prototype;e.exports=l?d.getPrototypeOf:function(e){var t=a(e);if(o(t,c))return t[c];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof d?u:null}},function(e,t,n){"use strict";var i,o,r=n(49),a=n(22),s=n(57),l=n(235),c=n(315),d=n(267),u=n(159),p=n(99).get,g=n(411),h=n(412),f=d("native-string-replace",String.prototype.replace),m=RegExp.prototype.exec,y=m,v=a("".charAt),_=a("".indexOf),b=a("".replace),w=a("".slice),C=(o=/b*/g,r(m,i=/a/,"a"),r(m,o,"a"),0!==i.lastIndex||0!==o.lastIndex),E=c.UNSUPPORTED_Y||c.BROKEN_CARET,S=void 0!==/()??/.exec("")[1];(C||S||E||g||h)&&(y=function(e){var t,n,i,o,a,c,d,g=this,h=p(g),G=s(e),A=h.raw;if(A)return A.lastIndex=g.lastIndex,t=r(y,A,G),g.lastIndex=A.lastIndex,t;var T=h.groups,P=E&&g.sticky,L=r(l,g),D=g.source,x=0,I=G;if(P&&(L=b(L,"y",""),-1===_(L,"g")&&(L+="g"),I=w(G,g.lastIndex),g.lastIndex>0&&(!g.multiline||g.multiline&&"\n"!==v(G,g.lastIndex-1))&&(D="(?: "+D+")",I=" "+I,x++),n=new RegExp("^(?:"+D+")",L)),S&&(n=new RegExp("^"+D+"$(?!\\s)",L)),C&&(i=g.lastIndex),o=r(m,P?n:g,I),P?o?(o.input=w(o.input,x),o[0]=w(o[0],x),o.index=g.lastIndex,g.lastIndex+=o[0].length):g.lastIndex=0:C&&o&&(g.lastIndex=g.global?o.index+o[0].length:i),S&&o&&o.length>1&&r(f,o[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&T)for(o.groups=c=u(null),a=0;a<T.length;a++)c[(d=T[a])[0]]=o[d[1]];return o}),e.exports=y},function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},,function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=c(e),a=i[0],s=i[1],l=new r(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),d=0,u=s>0?a-4:a;for(n=0;n<u;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===s&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,l[d++]=255&t);1===s&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,r=[],a=0,s=n-o;a<s;a+=16383)r.push(d(e,a,a+16383>s?s:a+16383));1===o?(t=e[n-1],r.push(i[t>>2]+i[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],r.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return r.join("")};for(var i=[],o=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var o,r,a=[],s=t;s<n;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(r=o)>>18&63]+i[r>>12&63]+i[r>>6&63]+i[63&r]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t,n){"use strict";n(297),n(14),n(29);var i=n(1),o=n(749),r=n(200),a=n(77);const s=n(341),l=n(231),c=n(263);var d=[],u=function(){};function p(){if(p._instance)throw new Error("FontsProviderManager can be instantiated only once.");p._instance=this}function g(e){var t=gDesigner.getActiveDocument(),n=function n(i){var s=p.getInstance();if(i)switch(i.status){case a.Saved:case a.SyncFailed:case a.Ready:case a.SaveFailed:s.removeEventListener(r,n),delete s._listenerFor[t.sessionId];break;case a.LoadFailed:s.removeEventListener(r,n),delete s._listenerFor[t.sessionId];default:return}if(!((t.getScene().getProperty("cst")||[]).indexOf(e.family)>=0)){var l=[e.family],c=d.filter((function(e){return!e.isInitialized()&&e.hasEnabler()})).map((function(e){return e.getEnabler()}));!function(e,t){var n=p.getInstance();n._missingFontsActions||(n._missingFontsActions={});n._missingFontsActions[t.sessionId]||(n._missingFontsActions[t.sessionId]={});for(var i=n._missingFontsActions[t.sessionId],o=e.length-1;o>=0;o--){var r=e[o];i.hasOwnProperty(r)?e.splice(o,1):i[r]=null}}(l,t),l.length&&(s._missingFontsDialog?(s._missingFontsDialog.setProviderEnablers(c),s._missingFontsDialog.setMissingFonts(l)):l.length&&(s._missingFontsDialog=new o(t,l,c,e=>{s._missingFontsDialog=null,s.keepFontsMessage=null;var n=s._missingFontsActions[t.sessionId];for(var i in e)n[i]=e[i]})),e.tryToResolveMissingFont&&s._showMissingFontsDialog&&!s._missingFontsDialog.opened&&s._missingFontsDialog.open(s.keepFontsMessage),s._firstCallback=u)}};if(t&&t.getStatus()===a.Ready)n();else{var i=p.getInstance();t&&!i._listenerFor[t.sessionId]&&(i._listenerFor[t.sessionId]=n,i.addEventListener(r,n))}}i.GObject.inherit(p,i.GEventTarget),p.ResetEvent=function(e){this.manager=e},i.GObject.inherit(p.ResetEvent,i.GEvent),p.MissingFontEvent=function(e,t,n){this.manager=e,this.evt=t,this.provider=n},i.GObject.inherit(p.MissingFontEvent,i.GEvent),p.prototype.manager=null,p.prototype._resetProviders=null,p.prototype.init=function(){gDesigner.addEventListener(c,this._networkAvailabilityChangedEvent,this)},p.prototype._networkAvailabilityChangedEvent=function(e){if(this._resetProviders&&this._resetProviders.length&&e.connected)for(;this._resetProviders.length;)this.reset(this._resetProviders.shift(),!0)},p.registerProvider=function(e){var t=new e(p._instance);d.indexOf(t)<0&&d.push(t)},p.unregisterProvider=function(e){for(var t=0;t<d.length;t++)d[t]instanceof e&&d.splice(t--,1)},p.getInstance=function(){return p._instance||new p},p.getInstance(),p.getProvider=function(e){return v[e]||null},p.getProviders=function(){return d.slice()},p.getProviderInstance=function(e){if(p._instance)for(var t=0;t<d.length;t++)if(d[t]instanceof e)return d[t];return null},p.disableProviders=function(e){if(p._instance){for(var t=0;t<e.length;t++)for(var n=e[t],i=0;i<d.length;i++)d[i]instanceof n?d[i].setEnabled(!1):d[i].setEnabled(!0);p._instance.reset(null,!1,!0)}},p.enableProviders=function(e,t){if(p._instance){for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<d.length;o++)d[o]instanceof i?d[o].setEnabled(!0):t||d[o].setEnabled(!1);t||p._instance.reset(null,!1,!0)}},p.resolveQueryFontFamily=function(e){var t=p.getInstance(),n=()=>{var n=t.searchFamilyInCache(e.family);e.callback(n&&n.fonts&&n.fonts.length?n.fonts:[])};t.isCacheEmpty()?t.query(n,"%",!0):n()},p._triggerMissingFont=function(e,t){var n=p.getInstance();n.hasEventListeners(p.MissingFontEvent)&&n.trigger(new p.MissingFontEvent(n,e,t))},p.resolveFont=function(e,t){var n;e&&void 0===t?(n=p.getProvider(e.family))?n.resolveFont(e.family,e.style,e.weight,{done:function(t){var n;e.sender instanceof i.GFontManager&&(n=e.sender._getFont(e.family,e.style,e.weight)),n&&n.isResolved()||(n=i.GOpenTypeFont.create(e.family,e.style,e.weight,t)),n&&e.resolved(n)},fail:function(t){t&&t===s.Errors.ConnectionError?gDesigner.isOffline()&&l.openUnavailableFeature(()=>p.resolveFont(e)):(e.failed(),p._triggerMissingFont(e,n),g(e))}}):p.resolveFont(e,0):"number"==typeof t&&((n=d[t])?n.resolveFont(e.family,e.style,e.weight,{done:function(n){var o;e.sender instanceof i.GFontManager&&(o=e.sender._getFont(e.family,e.style,e.weight)),o&&o.isResolved()||(o=i.GOpenTypeFont.create(e.family,e.style,e.weight,n)),o?e.resolved(o):p.resolveFont(e,t+1)},fail:function(){p.resolveFont(e,t+1)}}):d&&t===d.length?(e.failed(),p._triggerMissingFont(e,n),g(e)):p.resolveFont(e,t+1))},p.prototype._lock=null,p.prototype._loaded=0,p.prototype._lastLoaded=0,p.prototype._loadedPreviews=0,p.prototype._lastLoadedPreviews=0,p.prototype._loading=!1,p.prototype._timeStamp=0,p.prototype._firstCallback=null,p.prototype._missingFontsDialog=null,p.prototype._missingFontsActions=null,p.prototype._showMissingFontsDialog=!0,p.prototype._listenerFor={},p.prototype.getMissingFontsDialog=function(){return this._missingFontsDialog},p.prototype.keepFontsMessage=null;var h={},f=[],m={},y=[],v={};p.prototype.isLoading=function(){return this._loading},p.prototype.releaseDocumentListener=function(e){this._listenerFor[e.sessionId]&&this.removeEventListener(r,this._listenerFor[e.sessionId])},p.prototype.setShowMissingFontsDialog=function(e){this._showMissingFontsDialog=e},p.prototype.resetMissingFontsDialog=function(){this._missingFontsDialog=null},p.prototype._providerProbe=function(e,t,n,i,o,r,a,l,c,u){for(var p,g,_,b=this,w=l?20:9999;d[e]&&!c&&!d[e].isEnabled();)e++;if(l?(p=this._loadedPreviews,g=this._lastLoadedPreviews):(p=this._loaded,g=this._lastLoaded),e>=d.length)return this._loading=!1,this._timeStamp=i,void(l?this._loadedPreviews=this._lastLoadedPreviews:(this._loaded=this._lastLoaded,a&&o.length&&(!c&&this.hasDisabled()||(m[n]={faces:o.slice(),total:r},y.unshift(n)>30&&delete m[y.pop()]),c||(h[n]={faces:o,total:r},f.unshift(n)>30&&delete h[f.pop()])),t({faces:o,total:r}),c||this._providerProbe(0,t,n,i,[],0,a,!0,c,u)));var C,E=p+(p<9999?9999:w),S=0;if(0===e&&!a){var G=0;for(e=0;e<d.length;e++)if((c||d[e].isEnabled())&&(G+=d[e].getTotalFonts(this.normalizeQuery(n)))>p){S=p-G+d[e].getTotalFonts(this.normalizeQuery(n));break}}(!n||"%"===n)&&g<r||e>=d.length?this._providerProbe(d.length,t,n,i,o,r,a,l,c,u):(C=E-g,(_=d[e]).load(this.normalizeQuery(n),S,C,{done:function(s,u,p){if(i<this._timeStamp)console.log("discarded");else{(d.indexOf(_)<0||!c&&!d[e].isEnabled())&&this._providerProbe(e+1,t,n,i,o,r,a,l,c);for(var g=0;g<s.length;g++)v.hasOwnProperty(s[g].family)||(v[s[g].family]=_);if(!l){var f=h[this.normalizeQuery(n)]||{faces:[]};if(o!==f.faces||c){for(g=0;g<o.length;g++){if((y=d.indexOf(v[o[g].family]))>e&&d[y].isEnabled()){Array.prototype.splice.apply(o,[g,0].concat(s));break}}if(g==o.length&&Array.prototype.push.apply(o,s),!c){var m=f.faces;for(g=0;g<m.length;g++){if((y=d.indexOf(v[m[g].family]))>e&&d[y].isEnabled()){Array.prototype.splice.apply(m,[g,0].concat(s));break}}g==m.length&&Array.prototype.push.apply(m,s)}}else{for(var g=0;g<o.length;g++){var y;if((y=d.indexOf(v[o[g].family]))>e&&d[y].isEnabled()){Array.prototype.splice.apply(f.faces,[g,0].concat(s));break}}g==o.length&&Array.prototype.push.apply(o,s)}}_.addPreviews(s,l),r+=_.getTotalFonts(this.normalizeQuery(n)),a&&0===e&&(l?this._loadedPreviews=0:this._loaded=0),l?this._lastLoadedPreviews+=s.length:this._lastLoaded+=s.length,o.sort((e,t)=>e.family.localeCompare(t.family)),this._providerProbe(e+1,t,n,i,o,r,a,l,c)}}.bind(b),fail:function(d){u||d&&d===s.Errors.ConnectionError&&(b._resetProviders||(b._resetProviders=[]),b._resetProviders.push(_.constructor)),b._providerProbe(e+1,t,n,i,o,r,a,l,c)}.bind(b)},u))},p.prototype.setLock=function(){this._lock&&clearTimeout(this._lock),this._lock=setTimeout(function(){this._lock=null}.bind(this),1e4)},p.prototype.getLock=function(){return!!this._lock},p.prototype.reset=function(e,t,n){if(e)for(var i=0;i<d.length;i++)d[i]instanceof e&&(t||d[i].isEnabled())&&d[i].resetProvider();this._lock&&(clearTimeout(this._lock),this._lock=null),this._loaded=0,this._lastLoaded=0,this._loadedPreviews=0,this._lastLoadedPreviews=0,this._loading=!1,this._timeStamp=0,h={},f=[],n||(m={},y=[]),this._firstCallback&&this.query(this._firstCallback,"%"),this._missingFontsDialog&&(this._missingFontsDialog=null),this.hasEventListeners(p.ResetEvent)&&this.trigger(new p.ResetEvent(this))},p.prototype.loadMore=function(e,t){if(!this._loading){if(0===this._loadedPreviews&&0===this._lastLoadedPreviews)this._providerProbe(0,e,t,n,[],0,!1,!0);else if(this._loadedPreviews>=9999&&this._lastLoadedPreviews<this._loadedPreviews+20)if(this._loaded>=9999&&this._lastLoaded<this._loaded+9999){this._loading=!0;var n=(new Date).getTime();this._providerProbe(0,e,t,n,[],0,!1,!1)}else{this._loading=!0;n=(new Date).getTime();this._providerProbe(0,e,t,n,[],0,!1,!0)}else if(this._loaded>=9999&&this._lastLoaded<this._loaded+9999){this._loading=!0;n=(new Date).getTime();this._providerProbe(0,e,t,n,[],0,!1,!1)}return this._lastLoadedPreviews}},p.prototype.query=function(e,t,n){if(t&&(t=t.toLowerCase()),n&&m.hasOwnProperty(t))e(i=m[t]);else if(!n&&h.hasOwnProperty(t)){this._lastLoaded=0,this._lastLoadedPreviews=0;var i=h[t];this._loaded=i.faces.length,this._loadedPreviews=i.faces.length,e(i)}else{if(t.length>2){var o=t.substr(0,t.length-2);for(o=this.normalizeQuery(o);o.length>1;){if(h.hasOwnProperty(o))if((i=h[o]).faces.length<9999||i.faces.length==i.total){for(var r=[],a=0;a<i.faces.length;a++)i.faces[a].family.substr(0,t.length-1).toLowerCase()==t.substr(0,t.length-1).toLowerCase()&&r.push(i.faces[a]);return this._lastLoaded=this._lastLoadedPreviews=0,this._loaded=this._loadedPreviews=r.length,void e({faces:r})}o=o.substr(0,o.length-2),o=this.normalizeQuery(o)}}var s=(new Date).getTime();this._loading=!0,this._loaded=this._loadedPreviews=0,this._lastLoaded=this._lastLoadedPreviews=0,this._providerProbe(0,e,t,s,[],0,!0,!1,n)}},p.prototype.normalizeQuery=function(e){return"%"!=e&&(e?e+="%":e="%",e=e.replace(/%+$/,"%")),e},p.prototype.isCacheEmpty=function(){return!m||!m.hasOwnProperty("%")},p.prototype.hasDisabled=function(){return d.some(e=>!e.isEnabled())},p.prototype.searchFamilyInCache=function(e){var t=e.toLowerCase()+("%"==e?"":"%");if(this.isCacheEmpty())return null;for(;t.length>0;){if(m.hasOwnProperty(t)){var n=m[t];if(n.faces)for(var i=0;i<n.faces.length;i++){var o=n.faces[i];if(o.family===e)return o;if(o.families&&o.families.indexOf(e)>=0)return o}}if(1===t.length)break;t=t.substr(0,t.length-2),t=this.normalizeQuery(t)}return null},e.exports=p},function(e,t,n){"use strict";n(9),n(14),n(29),n(3);var i=n(1),o=n(16),r=n(32),a=n(12),s=n(322);function l(e,t,n){const r=e=>{if(o.GKey.translateKey(e.keyCode)===o.GKey.Constant.ESC)return e.preventDefault(),e.stopPropagation(),$(document).off("keydown",r),this._dialog.gDialog("close"),!1};this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-offline-dialog",alwaysCloseable:!0,closeCallback:()=>$(document).off("keydown",r)}),$(document).on("keydown",r),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",this.close.bind(this)).appendTo(this._dialog),$("<div></div>").addClass("logo").appendTo(this._dialog);const a=$("<div></div>").addClass("content").append($("<span></span>").addClass("title").html(e)).append($("<span></span>").addClass("subtitle").html(t)).append($("<div></div>").addClass("buttons").append(n.map(e=>{let{label:t,onclick:n,highlighted:i}=e;return $("<button></button>").append($("<span></span>").text(t)).addClass("g-pro-button "+(i?"highlighted":"")).on("click",()=>n(this))})));s.OFFLINEDIALOG.HAS_FOOTER&&a.append($("<span></span>").addClass("footer").html(i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-footer")))),a.appendTo(this._dialog)}i.GObject.inherit(l,i.GObject),l.openOfflineWarning=async function(){const e=await gDesigner.getUser();if(!e)return;const t=gDesigner.getLicense(),n=gDesigner.now();let o=a.DateAPI.millisecondsToDays(a.DateAPI.diff(a.DateAPI.toUTCZone(n),t.getOfflineExpirationDate()));new l(i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-title")).replace("%name",e.getFullUserName()),i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-subtitle")).replace("%days",o),[{label:i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-check")),onclick:e=>e.close()}]).open()},l.openUnavailableFeature=function(e){l.openRetryConnection(e,i.GLocale.get(new i.GLocaleKey("GOfflineDialog","title.unavailable-feature")))},l.openRetryConnection=async function(e,t){if($(".g-offline-dialog").length)return;const n=await gDesigner.getUser();new l(t||i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-title-retry")).replace("%name",n?n.getFullUserName():i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.display-name-in-case-missing"))),"",[{label:i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-retry")),highlighted:!0,onclick:async t=>{gDesigner.stats("offline-dialog_retry"),t._dialog.addClass("g-loading"),await(0,r.sleep)(500),t._dialog.removeClass("g-loading"),await gDesigner.isOfflineAsync()||(e&&e(),t.close())}},{label:i.GLocale.get(new i.GLocaleKey("GOfflineDialog","text.offline-cancel")),onclick:e=>{gDesigner.stats("offline-dialog_cancel"),e.close()}}]).open()},l.prototype._dialog=null,l.prototype.open=function(){this._dialog.gDialog("open",!1)},l.prototype.close=function(){this._dialog.gDialog("close")},l.prototype.toString=function(){return"[Object GOfflineDialog]"},e.exports=l},function(e,t,n){"use strict";const i=n(970);i.icon="",i["cloud-logo"]="assets/img/cloud/cloud_logo_white.svg",i["gravit-icon-cloud-logo"]="gravit-icon-cloud",i["gravit-icon-cloud"]="gravit-icon-gravit-cloud-file",i["gravit-icon-cloud-window"]="gravit-icon-gravit-cloud-file-window",i["gravit-icon-cloud-save-choose"]="gravit-icon-gravit-cloud-file-save-choose",i["gravit-icon-share-copy"]="gravit-icon-share-copy",e.exports=i},function(e,t,n){var i=n(359),o=n(274).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,o)}},function(e,t,n){"use strict";var i=n(96),o=n(73),r=n(38),a=n(67),s=r("species");e.exports=function(e){var t=i(e),n=o.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(52);e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var i=n(22),o=n(95),r=n(57),a=n(227),s=i("".replace),l="["+a+"]",c=RegExp("^"+l+l+"*"),d=RegExp(l+l+"*$"),u=function(e){return function(t){var n=r(o(t));return 1&e&&(n=s(n,c,"")),2&e&&(n=s(n,d,"")),n}};e.exports={start:u(1),end:u(2),trim:u(3)}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GRegex=void 0;const{NOTIFICATION_USER_MENTION_REGEX:i}=n(12),o={String:{InParenthesis:{NotNegativeNumberInTheEnd:/\(\d+\)$/},SpacesLineBreak:/\s/,NotNegativeNumber:/\d+/,MentionInputRtrim:/\s+$/,MentionInputRegexpEncode:/([.*+?^=!:${}()|\[\]\/\\])/g,MentionInputHighlightRegString:"(?![^&;]+;)(?!<[^<>]*)(<%=term%>)(?![^<>]*>)(?![^&;]+;)",USERNAME_RE:i||/@[^\r\n\t\f\v\s,{#%'"*<()>}:`;,!&?$+^\/|=\]\[\\]+/g,EMAIL:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,FileExtension:/\.[0-9a-z]+$/i,MultipleDotsEnd:/\.+$/,InvalidFileName:/(\\|\||\/)/,ValidFileName:/^(?:[\x2DA-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])+(?:[ -\.0-9A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])*$/},URLQuery:{NextParameter:/[?&]([^=#]+)=([^&#]*)/g},NavigatorUserAgent:{IS_CHROME_OS:/CrO[S\u017F]/i}};t.GRegex=o;var r={String:o.String};t.default=r},,,,,,,function(e,t,n){var i,o,r;e.exports=(r=n(46),o=(i=r).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,i=this._map;e.clamp();for(var o=[],r=0;r<n;r+=3)for(var a=(t[r>>>2]>>>24-r%4*8&255)<<16|(t[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|t[r+2>>>2]>>>24-(r+2)%4*8&255,s=0;s<4&&r+.75*s<n;s++)o.push(i.charAt(a>>>6*(3-s)&63));var l=i.charAt(64);if(l)for(;o.length%4;)o.push(l);return o.join("")},parse:function(e){var t=e.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var r=0;r<n.length;r++)i[n.charCodeAt(r)]=r}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var i=[],r=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,l=n[e.charCodeAt(a)]>>>6-a%4*2;i[r>>>2]|=(s|l)<<24-r%4*8,r++}return o.create(i,r)}(e,t,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},r.enc.Base64)},function(e,t,n){var i;e.exports=(i=n(46),function(e){var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=a.MD5=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var r=this._hash.words,a=e[t+0],l=e[t+1],g=e[t+2],h=e[t+3],f=e[t+4],m=e[t+5],y=e[t+6],v=e[t+7],_=e[t+8],b=e[t+9],w=e[t+10],C=e[t+11],E=e[t+12],S=e[t+13],G=e[t+14],A=e[t+15],T=r[0],P=r[1],L=r[2],D=r[3];T=c(T,P,L,D,a,7,s[0]),D=c(D,T,P,L,l,12,s[1]),L=c(L,D,T,P,g,17,s[2]),P=c(P,L,D,T,h,22,s[3]),T=c(T,P,L,D,f,7,s[4]),D=c(D,T,P,L,m,12,s[5]),L=c(L,D,T,P,y,17,s[6]),P=c(P,L,D,T,v,22,s[7]),T=c(T,P,L,D,_,7,s[8]),D=c(D,T,P,L,b,12,s[9]),L=c(L,D,T,P,w,17,s[10]),P=c(P,L,D,T,C,22,s[11]),T=c(T,P,L,D,E,7,s[12]),D=c(D,T,P,L,S,12,s[13]),L=c(L,D,T,P,G,17,s[14]),T=d(T,P=c(P,L,D,T,A,22,s[15]),L,D,l,5,s[16]),D=d(D,T,P,L,y,9,s[17]),L=d(L,D,T,P,C,14,s[18]),P=d(P,L,D,T,a,20,s[19]),T=d(T,P,L,D,m,5,s[20]),D=d(D,T,P,L,w,9,s[21]),L=d(L,D,T,P,A,14,s[22]),P=d(P,L,D,T,f,20,s[23]),T=d(T,P,L,D,b,5,s[24]),D=d(D,T,P,L,G,9,s[25]),L=d(L,D,T,P,h,14,s[26]),P=d(P,L,D,T,_,20,s[27]),T=d(T,P,L,D,S,5,s[28]),D=d(D,T,P,L,g,9,s[29]),L=d(L,D,T,P,v,14,s[30]),T=u(T,P=d(P,L,D,T,E,20,s[31]),L,D,m,4,s[32]),D=u(D,T,P,L,_,11,s[33]),L=u(L,D,T,P,C,16,s[34]),P=u(P,L,D,T,G,23,s[35]),T=u(T,P,L,D,l,4,s[36]),D=u(D,T,P,L,f,11,s[37]),L=u(L,D,T,P,v,16,s[38]),P=u(P,L,D,T,w,23,s[39]),T=u(T,P,L,D,S,4,s[40]),D=u(D,T,P,L,a,11,s[41]),L=u(L,D,T,P,h,16,s[42]),P=u(P,L,D,T,y,23,s[43]),T=u(T,P,L,D,b,4,s[44]),D=u(D,T,P,L,E,11,s[45]),L=u(L,D,T,P,A,16,s[46]),T=p(T,P=u(P,L,D,T,g,23,s[47]),L,D,a,6,s[48]),D=p(D,T,P,L,v,10,s[49]),L=p(L,D,T,P,G,15,s[50]),P=p(P,L,D,T,m,21,s[51]),T=p(T,P,L,D,E,6,s[52]),D=p(D,T,P,L,h,10,s[53]),L=p(L,D,T,P,w,15,s[54]),P=p(P,L,D,T,l,21,s[55]),T=p(T,P,L,D,_,6,s[56]),D=p(D,T,P,L,A,10,s[57]),L=p(L,D,T,P,y,15,s[58]),P=p(P,L,D,T,S,21,s[59]),T=p(T,P,L,D,f,6,s[60]),D=p(D,T,P,L,C,10,s[61]),L=p(L,D,T,P,g,15,s[62]),P=p(P,L,D,T,b,21,s[63]),r[0]=r[0]+T|0,r[1]=r[1]+P|0,r[2]=r[2]+L|0,r[3]=r[3]+D|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var r=e.floor(i/4294967296),a=i;n[15+(o+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var d=l[c];l[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return s},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,i,o,r,a){var s=e+(t&n|~t&i)+o+a;return(s<<r|s>>>32-r)+t}function d(e,t,n,i,o,r,a){var s=e+(t&i|n&~i)+o+a;return(s<<r|s>>>32-r)+t}function u(e,t,n,i,o,r,a){var s=e+(t^n^i)+o+a;return(s<<r|s>>>32-r)+t}function p(e,t,n,i,o,r,a){var s=e+(n^(t|~i))+o+a;return(s<<r|s>>>32-r)+t}t.MD5=r._createHelper(l),t.HmacMD5=r._createHmacHelper(l)}(Math),i.MD5)},,,,function(e,t,n){"use strict";n(14);var i=n(22),o=n(80),r=n(226),a=n(27),s=n(38),l=n(89),c=s("species"),d=RegExp.prototype;e.exports=function(e,t,n,u){var p=s(e),g=!a((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),h=g&&!a((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return t=!0,null},n[p](""),!t}));if(!g||!h||n){var f=i(/./[p]),m=t(p,""[e],(function(e,t,n,o,a){var s=i(e),l=t.exec;return l===r||l===d.exec?g&&!a?{done:!0,value:f(t,n,o)}:{done:!0,value:s(n,t,o)}:{done:!1}}));o(String.prototype,e,m[0]),o(d,p,m[1])}u&&l(d[p],"sham",!0)}},function(e,t,n){var i=n(6),o=n(49),r=n(52),a=n(34),s=n(153),l=n(226),c=i.TypeError;e.exports=function(e,t){var n=e.exec;if(a(n)){var i=o(n,e,t);return null!==i&&r(i),i}if("RegExp"===s(e))return o(l,e,t);throw c("RegExp#exec called on incompatible receiver")}},,,,,,,function(e,t){e.exports=require("path")},,,function(e,t,n){"use strict";var i,o=n(47),r=n(22),a=n(174).f,s=n(104),l=n(57),c=n(325),d=n(95),u=n(326),p=n(126),g=r("".endsWith),h=r("".slice),f=Math.min,m=u("endsWith");o({target:"String",proto:!0,forced:!!(p||m||(i=a(String.prototype,"endsWith"),!i||i.writable))&&!m},{endsWith:function(e){var t=l(d(this));c(e);var n=arguments.length>1?arguments[1]:void 0,i=t.length,o=void 0===n?i:f(s(n),i),r=l(e);return g?g(t,r,o):h(t,o-r.length,o)===r}})},function(e,t,n){"use strict";var i=n(47),o=n(67),r=n(6),a=n(22),s=n(59),l=n(34),c=n(125),d=n(57),u=n(73).f,p=n(405),g=r.Symbol,h=g&&g.prototype;if(o&&l(g)&&(!("description"in h)||void 0!==g().description)){var f={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:d(arguments[0]),t=c(h,this)?new g(e):void 0===e?g():g(e);return""===e&&(f[t]=!0),t};p(m,g),m.prototype=h,h.constructor=m;var y="Symbol(test)"==String(g("test")),v=a(h.toString),_=a(h.valueOf),b=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),C=a("".slice);u(h,"description",{configurable:!0,get:function(){var e=_(this),t=v(e);if(s(f,e))return"";var n=y?C(t,7,-1):w(t,b,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:m})}},function(e,t,n){"use strict";n(3);var i=n(1);function o(e){this.connected=e}i.GObject.inherit(o,i.GEvent),o.prototype.connected=!1,o.prototype.toString=function(){return"[Object GNetworkAvailabilityChangedEvent]"},e.exports=o},function(e,t,n){"use strict";var i=n(1);function o(e){this.user=e}i.GObject.inherit(o,i.GEvent),o.prototype.user=null,e.exports=o},,function(e,t,n){var i=n(6),o=n(96),r=n(34),a=n(125),s=n(356),l=i.Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=o("Symbol");return r(t)&&a(t.prototype,l(e))}},function(e,t,n){var i=n(126),o=n(268);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.19.0",mode:i?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var i=n(6),o=n(269),r=i["__core-js_shared__"]||o("__core-js_shared__",{});e.exports=r},function(e,t,n){var i=n(6),o=Object.defineProperty;e.exports=function(e,t){try{o(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},function(e,t,n){var i=n(22),o=0,r=Math.random(),a=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++o+r,36)}},function(e,t,n){var i=n(267),o=n(270),r=i("keys");e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t){e.exports={}},function(e,t,n){var i=n(114),o=Math.max,r=Math.min;e.exports=function(e,t){var n=i(e);return n<0?o(n+t,0):r(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,n){var i=n(80);e.exports=function(e,t,n){for(var o in t)i(e,o,t[o],n);return e}},function(e,t,n){var i=n(38),o=n(182),r=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||a[r]===e)}},function(e,t,n){var i=n(22),o=n(27),r=n(34),a=n(156),s=n(96),l=n(221),c=function(){},d=[],u=s("Reflect","construct"),p=/^\s*(?:class|function)\b/,g=i(p.exec),h=!p.exec(c),f=function(e){if(!r(e))return!1;try{return u(c,d,e),!0}catch(e){return!1}};e.exports=!u||o((function(){var e;return f(f.call)||!f(Object)||!f((function(){e=!0}))||e}))?function(e){if(!r(e))return!1;switch(a(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return h||!!g(p,l(e))}:f},function(e,t,n){"use strict";var i=n(6),o=n(22),r=n(67),a=n(375),s=n(180),l=n(89),c=n(275),d=n(27),u=n(181),p=n(114),g=n(104),h=n(376),f=n(571),m=n(225),y=n(154),v=n(233).f,_=n(73).f,b=n(573),w=n(157),C=n(155),E=n(99),S=s.PROPER,G=s.CONFIGURABLE,A=E.get,T=E.set,P=i.ArrayBuffer,L=P,D=L&&L.prototype,x=i.DataView,I=x&&x.prototype,O=Object.prototype,k=i.Array,F=i.RangeError,R=o(b),M=o([].reverse),N=f.pack,B=f.unpack,$=function(e){return[255&e]},U=function(e){return[255&e,e>>8&255]},K=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},j=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},H=function(e){return N(e,23,4)},V=function(e){return N(e,52,8)},z=function(e,t){_(e.prototype,t,{get:function(){return A(this)[t]}})},W=function(e,t,n,i){var o=h(n),r=A(e);if(o+t>r.byteLength)throw F("Wrong index");var a=A(r.buffer).bytes,s=o+r.byteOffset,l=w(a,s,s+t);return i?l:M(l)},q=function(e,t,n,i,o,r){var a=h(n),s=A(e);if(a+t>s.byteLength)throw F("Wrong index");for(var l=A(s.buffer).bytes,c=a+s.byteOffset,d=i(+o),u=0;u<t;u++)l[c+u]=d[r?u:t-u-1]};if(a){var Y=S&&"ArrayBuffer"!==P.name;if(d((function(){P(1)}))&&d((function(){new P(-1)}))&&!d((function(){return new P,new P(1.5),new P(NaN),Y&&!G})))Y&&G&&l(P,"name","ArrayBuffer");else{(L=function(e){return u(this,D),new P(h(e))}).prototype=D;for(var X,Q=v(P),Z=0;Q.length>Z;)(X=Q[Z++])in L||l(L,X,P[X]);D.constructor=L}y&&m(I)!==O&&y(I,O);var J=new x(new L(2)),ee=o(I.setInt8);J.setInt8(0,2147483648),J.setInt8(1,2147483649),!J.getInt8(0)&&J.getInt8(1)||c(I,{setInt8:function(e,t){ee(this,e,t<<24>>24)},setUint8:function(e,t){ee(this,e,t<<24>>24)}},{unsafe:!0})}else D=(L=function(e){u(this,D);var t=h(e);T(this,{bytes:R(k(t),0),byteLength:t}),r||(this.byteLength=t)}).prototype,I=(x=function(e,t,n){u(this,I),u(e,D);var i=A(e).byteLength,o=p(t);if(o<0||o>i)throw F("Wrong offset");if(o+(n=void 0===n?i-o:g(n))>i)throw F("Wrong length");T(this,{buffer:e,byteLength:n,byteOffset:o}),r||(this.buffer=e,this.byteLength=n,this.byteOffset=o)}).prototype,r&&(z(L,"byteLength"),z(x,"buffer"),z(x,"byteLength"),z(x,"byteOffset")),c(I,{getInt8:function(e){return W(this,1,e)[0]<<24>>24},getUint8:function(e){return W(this,1,e)[0]},getInt16:function(e){var t=W(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=W(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return j(W(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return j(W(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return B(W(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return B(W(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){q(this,1,e,$,t)},setUint8:function(e,t){q(this,1,e,$,t)},setInt16:function(e,t){q(this,2,e,U,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){q(this,2,e,U,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){q(this,4,e,K,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){q(this,4,e,K,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){q(this,4,e,H,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){q(this,8,e,V,t,arguments.length>2?arguments[2]:void 0)}});C(L,"ArrayBuffer"),C(x,"DataView"),e.exports={ArrayBuffer:L,DataView:x}},function(e,t,n){"use strict";var i=n(280).charAt;e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},function(e,t,n){var i=n(22),o=n(114),r=n(57),a=n(95),s=i("".charAt),l=i("".charCodeAt),c=i("".slice),d=function(e){return function(t,n){var i,d,u=r(a(t)),p=o(n),g=u.length;return p<0||p>=g?e?"":void 0:(i=l(u,p))<55296||i>56319||p+1===g||(d=l(u,p+1))<56320||d>57343?e?s(u,p):i:e?c(u,p,p+2):d-56320+(i-55296<<10)+65536}};e.exports={codeAt:d(!1),charAt:d(!0)}},function(e,t,n){"use strict";e.exports=function(e,t,n,i){for(var o=65535&e|0,r=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{r=r+(o=o+t[i++]|0)|0}while(--a);o%=65521,r%=65521}return o|r<<16|0}},function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();e.exports=function(e,t,n,o){var r=i,a=o+n;e^=-1;for(var s=o;s<a;s++)e=e>>>8^r[255&(e^t[s])];return-1^e}},function(e,t,n){"use strict";var i=n(85),o=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){r=!1}for(var a=new i.Buf8(256),s=0;s<256;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&r||!e.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[a]);return n}a[254]=a[254]=1,t.string2buf=function(e){var t,n,o,r,a,s=e.length,l=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(o=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(o-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new i.Buf8(l),a=0,r=0;a<l;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(o=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(o-56320),r++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),n=0,o=t.length;n<o;n++)t[n]=e.charCodeAt(n);return t},t.buf2string=function(e,t){var n,i,o,r,s=t||e.length,c=new Array(2*s);for(i=0,n=0;n<s;)if((o=e[n++])<128)c[i++]=o;else if((r=a[o])>4)c[i++]=65533,n+=r-1;else{for(o&=2===r?31:3===r?15:7;r>1&&n<s;)o=o<<6|63&e[n++],r--;r>1?c[i++]=65533:o<65536?c[i++]=o:(o-=65536,c[i++]=55296|o>>10&1023,c[i++]=56320|1023&o)}return l(c,i)},t.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},function(e,t,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},,,,,,,,,,,,function(e,t,n){"use strict";var i=n(47),o=n(22),r=n(119),a=n(97),s=n(109),l=n(57),c=n(27),d=n(314),u=n(312),p=n(408),g=n(409),h=n(194),f=n(410),m=[],y=o(m.sort),v=o(m.push),_=c((function(){m.sort(void 0)})),b=c((function(){m.sort(null)})),w=u("sort"),C=!c((function(){if(h)return h<70;if(!(p&&p>3)){if(g)return!0;if(f)return f<603;var e,t,n,i,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)m.push({k:t+i,v:n})}for(m.sort((function(e,t){return t.v-e.v})),i=0;i<m.length;i++)t=m[i].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));i({target:"Array",proto:!0,forced:_||!b||!w||!C},{sort:function(e){void 0!==e&&r(e);var t=a(this);if(C)return void 0===e?y(t):y(t,e);var n,i,o=[],c=s(t);for(i=0;i<c;i++)i in t&&v(o,t[i]);for(d(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:l(t)>l(n)?1:-1}}(e)),n=o.length,i=0;i<n;)t[i]=o[i++];for(;i<c;)delete t[i++];return t}})},,,,,,,,function(e,t,n){"use strict";var i=n(1);function o(e,t){this.type=e,this.storageItem=t}i.GObject.inherit(o,i.GEvent),o.Type={VersionUpdate:2,ShareCreated:3,FileUpdated:4,FileCheckIn:5},o.prototype.storageItem=null,o.prototype.type=null,o.FileStatusUpdate=function(e,t,n){this.storageItem=e,this.oldStatus=t,this.newStatus=n},i.GObject.inherit(o.FileStatusUpdate,i.GEvent),e.exports=o},function(e,t,n){"use strict";const i=n(993);e.exports=new i},,function(e,t,n){"use strict";n(3),n(25);var i=n(1),o=n(16),r=n(56),a=n(1374),s=n(1044),l=n(397),c=n(1045),d=n(717);function u(e,t,n,i){this._htmlElement=$("<li></li>").addClass("g-menu-item"),this._category=e||u.Type.Item,this._componentId=n||null,this._pro=!1,this._visible=!0,this._feature=null,this._detachBound=this._detach.bind(this),this._category===u.Type.Divider?(this._isVisible=i,this._htmlElement.addClass("g-menu-item-divider")):(this._htmlElement.append($("<span></span>").addClass("g-menu-item-icon").css("display","none")).append($("<span></span>").addClass("g-menu-item-caption")).append($("<span></span>").addClass("g-menu-item-info")).append($("<span></span>").addClass("g-menu-item-shortcut").css("display","none")).append($("<span></span>").addClass("g-menu-item-detach").addClass("gravit-icon-detach").css("display","none")).append($("<span></span>").addClass("g-menu-item-tail")),this._category===u.Type.Menu&&(this._htmlElement.addClass("g-menu-item-menu"),this.setMenu(new t(this)))),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this)),this._htmlElement.on("mousedown",this._mouseDown.bind(this)),this._htmlElement.on("mouseup",this._mouseUp.bind(this))}i.GObject.inherit(u,i.GEventTarget),u.Type={Item:0,Menu:1,Divider:2},u.EnterEvent=function(){},i.GObject.inherit(u.EnterEvent,i.GEvent),u.EnterEvent.prototype.toString=function(){return"[Object GMenuItem.EnterEvent]"},u.ENTER_EVENT=new u.EnterEvent,u.LeaveEvent=function(){},i.GObject.inherit(u.LeaveEvent,i.GEvent),u.LeaveEvent.prototype.toString=function(){return"[Object GMenuItem.LeaveEvent]"},u.LEAVE_EVENT=new u.LeaveEvent,u.ActivateEvent=function(){},i.GObject.inherit(u.ActivateEvent,i.GEvent),u.ActivateEvent.prototype.toString=function(){return"[Object GMenuItem.ActivateEvent]"},u.ACTIVATE_EVENT=new u.ActivateEvent,u.BeforeActivateEvent=function(){},i.GObject.inherit(u.BeforeActivateEvent,i.GEvent),u.BeforeActivateEvent.prototype.toString=function(){return"[Object GMenuItem.BeforeActivateEvent]"},u.BEFORE_ACTIVATE_EVENT=new u.BeforeActivateEvent,u.UpdateEvent=function(){},i.GObject.inherit(u.UpdateEvent,i.GEvent),u.UpdateEvent.prototype.toString=function(){return"[Object GMenuItem.UpdateEvent]"},u.UPDATE_EVENT=new u.UpdateEvent,u.DetachEvent=function(){},i.GObject.inherit(u.DetachEvent,i.GEvent),u.DetachEvent.prototype.toString=function(){return"[Object GMenuItem.DetachEvent]"},u.prototype._parent=null,u.prototype._category=null,u.prototype._menu=null,u.prototype._icon=null,u.prototype._forcedAsOpened=!1,u.prototype._caption=null,u.prototype._shortcutHint=null,u.prototype._action=null,u.prototype._data=null,u.prototype._noHover=!1,u.prototype._pro=!1,u.prototype._visible=!0,u.prototype._feature=null,u.prototype._info=null,u.prototype._uuid=null,u.prototype._detached=!1,u.prototype._detachBound=null,u.prototype._isVisible=null,u.prototype._proFeatureInterruption=!0,u.prototype.getUUID=function(){return this._uuid||(this._uuid=i.GUtil.uuid()),this._uuid},u.prototype.getParent=function(){return this._parent},u.prototype.getType=function(){return this._category},u.prototype.getIcon=function(){return this._icon},u.prototype.isForcedAsOpened=function(){return this._forcedAsOpened},u.prototype.setPro=function(e,t){this._pro=!!e,this._feature=t,this._htmlElement.gPro({pro:this._pro,feature:t});let n=!1;const i=gDesigner.getLicense(),o=i.isLegacy()&&gDesigner.isLegacyFeature(t),a=!o&&(i.isFree()||gDesigner.isAnonymous()||i.isExpired());if(this._pro&&(n=i.isTrial()&&!o),!n&&!a||!this._action)return;let s=this._action.getTooltipConfig(this._action.getTooltipArea());s&&this._htmlElement.gRichTooltip(r.GRichTooltipConfig.from(Object.assign({},s.getConfig(),{isPro:!gDesigner.isEnabledProFeatures()||!(i.isPro()&&!i.isExpired())})))},u.prototype.isPro=function(){return!!this._pro},u.prototype.getFeature=function(){return this._feature},u.prototype.setIcon=function(e){if(e!==this._icon){this._icon=e;var t=this._htmlElement.find(".g-menu-item-icon");t.empty(),this._icon?("string"==typeof this._icon?t.append($("<i></i>").addClass(e)):t.append(this._icon),t.css("display",""),this._htmlElement.addClass("has-icon")):(t.css("display","none"),this._htmlElement.removeClass("has-icon"))}},u.prototype.getCaption=function(){return this._caption},u.prototype.setCaption=function(e){if(e!==this._caption){this._caption=e;var t=this._htmlElement.find(".g-menu-item-caption");t.empty(),!this._caption||this._caption instanceof i.GLocaleKey||"string"==typeof this._caption?t.html(this._caption?i.GLocale.get(this._caption):""):t.append(this._caption)}},u.prototype.getInfo=function(){return this._info},u.prototype.setInfo=function(e){if(e!==this._info){this._info=e;const t=this._htmlElement.find(".g-menu-item-info").empty();this._htmlElement.css("display",this._info?"":"none"),this._info&&(this._info instanceof i.GLocaleKey||"string"==typeof this._info?t.text(this._info?i.GLocale.get(this._info):""):t.append(this._info))}},u.prototype.getShortcutHint=function(){return this._shortcutHint},u.prototype.setShortcutHint=function(e){this._shortcutHint=e;var t=this._htmlElement.find(".g-menu-item-shortcut");this._shortcutHint&&this._shortcutHint.length>0?(t.text(o.GKey.shortcutToString(e)),t.css("display",""),this._htmlElement.addClass("has-shortcut")):(t.empty(),t.css("display","none"),this._htmlElement.removeClass("has-shortcut"))},u.prototype.getAction=function(){return this._action},u.prototype.updateEnabled=function(){this._action&&this.setEnabled(!!this._action.isEnabled())},u.prototype.setAction=function(e,t){if(e!==this._action){if(this._action){let t=e.getShortcut();t&&t===this.getShortcutHint()&&this.setShortcutHint(null)}if(this._action=e,this._action){let n=e.getShortcut();if(n&&this.setShortcutHint(n),this.setCaption(this._action.getTitle()),this.setInfo(this._action.getInfo()),this.setIcon(this._action.getIcon()),this.setEnabled(!0===this._action.isEnabled()),this.setVisible(this._action.isVisible()),t){let e=this._action.getTooltipConfig(t);e&&this.setTooltipConfig(r.GRichTooltipConfig.from(Object.assign({},e.getConfig(),{side:!0})))}}}this.setPro(this._action&&this._action.isPro(),this._action&&this._action.getId())},u.prototype.isChecked=function(){return this._htmlElement.hasClass("g-menu-item-checked")},u.prototype.isCheckable=function(){return!!this._action&&this._action.isCheckable()},u.prototype.setChecked=function(e){e!=this.isChecked()&&(e?this._htmlElement.addClass("g-menu-item-checked"):this._htmlElement.removeClass("g-menu-item-checked"))},u.prototype.isEnabled=function(){return!this._htmlElement.hasClass("g-disabled")},u.prototype.setEnabled=function(e){e!=this.isEnabled()&&(e?this._htmlElement.removeClass("g-disabled"):this._htmlElement.addClass("g-disabled"))},u.prototype.setDetachable=function(e){const t=this._htmlElement.find(".g-menu-item-detach").css("display",e?"":"none");e?(t.on("click",this._detachBound),t[0].addEventListener("mousedown",this._stopPropagationEventListener,!0),t[0].addEventListener("mouseup",this._stopPropagationEventListener,!0)):(t.off("click",this._detachBound),t[0].removeEventListener("mousedown",this._stopPropagationEventListener,!0),t[0].removeEventListener("mouseup",this._stopPropagationEventListener,!0))},u.prototype._stopPropagationEventListener=function(e){e.stopPropagation()},u.prototype._detach=function(e){if(e.button==o.GMouseEvent.BUTTON_LEFT){e.stopPropagation(),e.preventDefault(),this._detached=!0;const t=this._parent;t&&(t.removeItem(t.indexOf(this)),t.close()),this.hasEventListeners(u.DetachEvent)&&this.trigger(new u.DetachEvent)}},u.prototype.setVisible=function(e){this._visible=!!e,this._htmlElement.css("display",e?"":"none")},u.prototype.isVisible=function(){return this._visible},u.prototype.getData=function(){return this._data},u.prototype.setData=function(e){this._data=e},u.prototype.setNoHover=function(e){this._noHover=e},u.prototype.addClass=function(e){this._htmlElement.addClass(e)},u.prototype.isRootItem=function(){return this._parent&&"function"==typeof this._parent.toString&&"[Object GMenu]"===this._parent.toString()&&null!=this._parent._parent&&!(this._parent._parent instanceof u)},u.prototype.isRootMenuBarItem=function(){return this.isRootItem()&&this._parent._parent&&"function"==typeof this._parent._parent.toString&&"[Object GMenuBar]"===this._parent._parent.toString()},u.prototype.getMenuBar=function(){return this.isRootMenuBarItem()?this._parent._parent:null},u.prototype.getMenu=function(){return this._menu},u.prototype.setMenu=function(e){e&&e!==this._menu&&this._category===u.Type.Menu&&(this._menu=e,this._menu._parent=this,this._menu.addEventListener(d.EVENT,this._menuOpen.bind(this)),this._menu.addEventListener(s.EVENT,this._menuClose.bind(this)))},u.prototype.update=function(){this._action&&(this.setCaption(this._action.getTitle()),this.setEnabled(this._action.isEnabled()),this.setChecked(this._action.isChecked()),this.setPro(this._action.isPro(),this._action.getId()),this.setIcon(this._icon||this._action.getIcon()),this.setInfo(this._action.getInfo()),this.setVisible(this._action.isVisible())),this.getType()===u.Type.Divider&&this._isVisible&&this.setVisible(this._isVisible()),this.hasEventListeners(u.UpdateEvent)&&this.trigger(u.UPDATE_EVENT)},u.prototype.activate=function(){let e=!1;const t=()=>{let e,t=this.getParent();for(;t&&(e=t,t!==t.getParent());)t=t.getParent();return e};if(this.hasEventListeners(u.BeforeActivateEvent)&&this.trigger(u.BEFORE_ACTIVATE_EVENT),this._action&&this._action.isAvailable(this._componentId)&&this._action.isEnabled()){let o=t();var n="execute";this._action.isPro()&&!gDesigner.isEnabledProFeatures(this._action.getId())&&(n="nonprotriespro"),this._action.execute(),e=!0;var i=this._action.statsValue()||this._action.getId();o&&"context"===o.__which?gDesigner.stats("action_"+n+"_context",i):o&&"menubar"===o.__which?gDesigner.stats("action_"+n+"_menu",i):o&&"assistantbar"===o.__which?gDesigner.stats("action_"+n+"_assistantbar",i):o&&"touchmenu"===o.__which?gDesigner.stats("action_"+n+"_touchmenu",i):gDesigner.stats("action_"+n+"_toolbar",i)}if(this.isEnabled()){if(this.isPro()&&this._proFeatureInterruption&&!gDesigner.isEnabledProFeatures(this._feature)){if(!e){let e=t();e&&"context"===e.__which?gDesigner.stats("action_nonprotriespro_context",this._feature):e&&"menubar"===e.__which?gDesigner.stats("action_nonprotriespro_menu",this._feature):e&&"assistantbar"===e.__which?gDesigner.stats("action_nonprotriespro_assistantbar",this._feature):e&&"touchmenu"===e.__which?gDesigner.stats("action_nonprotriespro_touchmenu",this._feature):gDesigner.stats("action_nonprotriespro_toolbar",this._feature),gDesigner.handlePROFeatureInterruption()}return!1}this.hasEventListeners(u.ActivateEvent)&&this.trigger(u.ACTIVATE_EVENT),this._parent&&this._parent.hasEventListeners(a)&&this._parent.trigger(new a(this))}},u.prototype.setTooltipConfig=function(e){this._htmlElement.gRichTooltip(e)},u.prototype.setProFeatureInterruption=function(e){this._proFeatureInterruption=e},u.prototype._mouseOver=function(e){this._parent&&this._category===u.Type.Menu&&this._parent.getActiveItem()!==this&&!this.isRootItem()&&this._parent.closeMenus(!0),this._parent&&"function"==typeof this._parent.toString&&"[Object GMenu]"===this._parent.toString()&&!this.isRootItem()&&this._parent.closeMenus(),this.isEnabled()&&(this._category==u.Type.Menu&&i.GSystem.hardware===i.GSystem.Hardware.Desktop&&(!this.isRootItem()||this.isRootMenuBarItem()&&this.getMenuBar().isActive())&&this._openMenu(),this._category!=u.Type.Divider&&(this._noHover||this._htmlElement.addClass("g-hover"),this.hasEventListeners(u.EnterEvent)&&this.trigger(u.ENTER_EVENT)))},u.prototype.isActive=function(){return this._htmlElement.hasClass("g-active")},u.prototype.changeActiveState=function(e){e?this._htmlElement.addClass("g-active"):this._htmlElement.removeClass("g-active")},u.prototype._mouseOut=function(e){if(this._category===u.Type.Menu&&(this.isRootItem()||i.GSystem.hardware!==i.GSystem.Hardware.Desktop))return e.stopPropagation(),void e.preventDefault();this.isEnabled()&&this._category!=u.Type.Divider&&(this._noHover||this._htmlElement.removeClass("g-hover"),this.hasEventListeners(u.LeaveEvent)&&this.trigger(u.LEAVE_EVENT))},u.prototype._mouseDown=function(e){e.cancelable&&(this.isEnabled()?e.button==o.GMouseEvent.BUTTON_LEFT?(e.stopPropagation(),e.preventDefault(),this._category===u.Type.Menu&&(this._forcedAsOpened?(this.getMenu().close(),this._forcedAsOpened=!1):(this._parent&&(this._parent.closeMenus(!0),this._parent.setActiveItem(this)),this._openMenu(),this._forcedAsOpened=!0))):(e.button,o.GMouseEvent.BUTTON_MIDDLE,e.stopPropagation(),e.preventDefault()):gDesigner.isTouchEnabled()&&e.button===o.GMouseEvent.BUTTON_LEFT&&e.stopPropagation())},u.prototype._mouseUp=function(e){if(e.cancelable&&(e.stopPropagation(),e.preventDefault(),e.button!=o.GMouseEvent.BUTTON_MIDDLE&&e.button!=o.GMouseEvent.BUTTON_RIGHT&&!this._detached&&this._category!==u.Type.Menu)){if(this.isRootMenuBarItem()||this._mouseOut(e),this._category==u.Type.Item){let e=this.activate();this.isEnabled()&&!1!==e&&c.triggerGlobalActivation(this)}this.isRootMenuBarItem()||c.setActiveMenu(null)}},u.prototype._openMenu=function(){this.getMenu().open(this._htmlElement,this.isRootItem()?l.Position.Center:l.Position.Right_Bottom,this.isRootItem()?l.Position.Right_Bottom:l.Position.Center)},u.prototype._menuOpen=function(){this._htmlElement.addClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.addClass("g-active")},u.prototype._menuClose=function(){this._forcedAsOpened=!1,this._htmlElement.removeClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.removeClass("g-active")},u.prototype.toString=function(){return"[Object GMenuItem]"},e.exports=u},function(e,t,n){"use strict";function i(e){Object.assign(this,e)}n(25),n(3),i.prototype.def=!1,i.prototype.id=null,i.prototype.sidebar=null,i.prototype.icon=null,i.prototype.panel=null,i.prototype.toolbar=null,i.prototype.activate=function(){},i.prototype.deactivate=function(){},i.prototype.toString=function(){return"[Object GTouchTool]"},i.APPEARANCE_TOUCH_TOOL=new i({id:"appearance",icon:"gravit-icon-touch-appearance-panel",panel:".appearance-property-panel",panelWidth:"380px",toolbar:".appearance-toolbar"}),e.exports=i},function(e,t,n){var i=n(27),o=n(34),r=/#|\.prototype\./,a=function(e,t){var n=l[s(e)];return n==d||n!=c&&(o(t)?i(t):!!t)},s=a.normalize=function(e){return String(e).replace(r,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",d=a.POLYFILL="P";e.exports=a},function(e,t,n){var i=n(62),o=n(153),r=n(38)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==o(e))}},function(e,t,n){"use strict";var i=n(27);e.exports=function(e,t){var n=[][e];return!!n&&i((function(){n.call(null,t||function(){throw 1},1)}))}},function(e,t,n){"use strict";var i=n(47),o=n(6),r=n(49),a=n(67),s=n(575),l=n(185),c=n(278),d=n(181),u=n(152),p=n(89),g=n(576),h=n(104),f=n(376),m=n(577),y=n(219),v=n(59),_=n(156),b=n(62),w=n(266),C=n(159),E=n(125),S=n(154),G=n(233).f,A=n(579),T=n(374).forEach,P=n(234),L=n(73),D=n(174),x=n(99),I=n(407),O=x.get,k=x.set,F=L.f,R=D.f,M=Math.round,N=o.RangeError,B=c.ArrayBuffer,$=B.prototype,U=c.DataView,K=l.NATIVE_ARRAY_BUFFER_VIEWS,j=l.TYPED_ARRAY_CONSTRUCTOR,H=l.TYPED_ARRAY_TAG,V=l.TypedArray,z=l.TypedArrayPrototype,W=l.aTypedArrayConstructor,q=l.isTypedArray,Y=function(e,t){W(e);for(var n=0,i=t.length,o=new e(i);i>n;)o[n]=t[n++];return o},X=function(e,t){F(e,t,{get:function(){return O(this)[t]}})},Q=function(e){var t;return E($,e)||"ArrayBuffer"==(t=_(e))||"SharedArrayBuffer"==t},Z=function(e,t){return q(e)&&!w(t)&&t in e&&g(+t)&&t>=0},J=function(e,t){return t=y(t),Z(e,t)?u(2,e[t]):R(e,t)},ee=function(e,t,n){return t=y(t),!(Z(e,t)&&b(n)&&v(n,"value"))||v(n,"get")||v(n,"set")||n.configurable||v(n,"writable")&&!n.writable||v(n,"enumerable")&&!n.enumerable?F(e,t,n):(e[t]=n.value,e)};a?(K||(D.f=J,L.f=ee,X(z,"buffer"),X(z,"byteOffset"),X(z,"byteLength"),X(z,"length")),i({target:"Object",stat:!0,forced:!K},{getOwnPropertyDescriptor:J,defineProperty:ee}),e.exports=function(e,t,n){var a=e.match(/\d+$/)[0]/8,l=e+(n?"Clamped":"")+"Array",c="get"+e,u="set"+e,g=o[l],y=g,v=y&&y.prototype,_={},w=function(e,t){F(e,t,{get:function(){return function(e,t){var n=O(e);return n.view[c](t*a+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var o=O(e);n&&(i=(i=M(i))<0?0:i>255?255:255&i),o.view[u](t*a+o.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};K?s&&(y=t((function(e,t,n,i){return d(e,v),I(b(t)?Q(t)?void 0!==i?new g(t,m(n,a),i):void 0!==n?new g(t,m(n,a)):new g(t):q(t)?Y(y,t):r(A,y,t):new g(f(t)),e,y)})),S&&S(y,V),T(G(g),(function(e){e in y||p(y,e,g[e])})),y.prototype=v):(y=t((function(e,t,n,i){d(e,v);var o,s,l,c=0,u=0;if(b(t)){if(!Q(t))return q(t)?Y(y,t):r(A,y,t);o=t,u=m(n,a);var p=t.byteLength;if(void 0===i){if(p%a)throw N("Wrong length");if((s=p-u)<0)throw N("Wrong length")}else if((s=h(i)*a)+u>p)throw N("Wrong length");l=s/a}else l=f(t),o=new B(s=l*a);for(k(e,{buffer:o,byteOffset:u,byteLength:s,length:l,view:new U(o)});c<l;)w(e,c++)})),S&&S(y,V),v=y.prototype=C(z)),v.constructor!==y&&p(v,"constructor",y),p(v,j,y),H&&p(v,H,l),_[l]=y,i({global:!0,forced:y!=g,sham:!K},_),"BYTES_PER_ELEMENT"in y||p(y,"BYTES_PER_ELEMENT",a),"BYTES_PER_ELEMENT"in v||p(v,"BYTES_PER_ELEMENT",a),P(l)}):e.exports=function(){}},function(e,t,n){var i=n(157),o=Math.floor,r=function(e,t){var n=e.length,l=o(n/2);return n<8?a(e,t):s(e,r(i(e,0,l),t),r(i(e,l),t),t)},a=function(e,t){for(var n,i,o=e.length,r=1;r<o;){for(i=r,n=e[r];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==r++&&(e[i]=n)}return e},s=function(e,t,n,i){for(var o=t.length,r=n.length,a=0,s=0;a<o||s<r;)e[a+s]=a<o&&s<r?i(t[a],n[s])<=0?t[a++]:n[s++]:a<o?t[a++]:n[s++];return e};e.exports=r},function(e,t,n){var i=n(27),o=n(6).RegExp;t.UNSUPPORTED_Y=i((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=i((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},,,,,,function(e,t,n){var i=n(67),o=n(6),r=n(22),a=n(310),s=n(407),l=n(89),c=n(73).f,d=n(233).f,u=n(125),p=n(311),g=n(57),h=n(235),f=n(315),m=n(80),y=n(27),v=n(59),_=n(99).enforce,b=n(234),w=n(38),C=n(411),E=n(412),S=w("match"),G=o.RegExp,A=G.prototype,T=o.SyntaxError,P=r(h),L=r(A.exec),D=r("".charAt),x=r("".replace),I=r("".indexOf),O=r("".slice),k=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,F=/a/g,R=/a/g,M=new G(F)!==F,N=f.UNSUPPORTED_Y,B=i&&(!M||N||C||E||y((function(){return R[S]=!1,G(F)!=F||G(R)==R||"/a/i"!=G(F,"i")})));if(a("RegExp",B)){for(var $=function(e,t){var n,i,o,r,a,c,d=u(A,this),h=p(e),f=void 0===t,m=[],y=e;if(!d&&h&&f&&e.constructor===$)return e;if((h||u(A,e))&&(e=e.source,f&&(t="flags"in y?y.flags:P(y))),e=void 0===e?"":g(e),t=void 0===t?"":g(t),y=e,C&&"dotAll"in F&&(i=!!t&&I(t,"s")>-1)&&(t=x(t,/s/g,"")),n=t,N&&"sticky"in F&&(o=!!t&&I(t,"y")>-1)&&(t=x(t,/y/g,"")),E&&(e=(r=function(e){for(var t,n=e.length,i=0,o="",r=[],a={},s=!1,l=!1,c=0,d="";i<=n;i++){if("\\"===(t=D(e,i)))t+=D(e,++i);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:L(k,O(e,i+1))&&(i+=2,l=!0),o+=t,c++;continue;case">"===t&&l:if(""===d||v(a,d))throw new T("Invalid capture group name");a[d]=!0,r[r.length]=[d,c],l=!1,d="";continue}l?d+=t:o+=t}return[o,r]}(e))[0],m=r[1]),a=s(G(e,t),d?this:A,$),(i||o||m.length)&&(c=_(a),i&&(c.dotAll=!0,c.raw=$(function(e){for(var t,n=e.length,i=0,o="",r=!1;i<=n;i++)"\\"!==(t=D(e,i))?r||"."!==t?("["===t?r=!0:"]"===t&&(r=!1),o+=t):o+="[\\s\\S]":o+=t+D(e,++i);return o}(e),n)),o&&(c.sticky=!0),m.length&&(c.groups=m)),e!==y)try{l(a,"source",""===y?"(?:)":y)}catch(e){}return a},U=function(e){e in $||c($,e,{configurable:!0,get:function(){return G[e]},set:function(t){G[e]=t}})},K=d(G),j=0;K.length>j;)U(K[j++]);A.constructor=$,$.prototype=A,m(o,"RegExp",$)}b("RegExp")},function(e,t,n){"use strict";var i=n(1),o=n(969);o.DESIGNER.HIGHLIGHTOUTLINE_COLOR=new i.GRGBColor([197,17,98]),o.PURCHASEPANEL.HAS_PRODUCT_DESCRIPTION=!1,e.exports=o},function(e,t,n){"use strict";n(9),n(28),n(19),n(24),n(58);var i=n(1),o=n(43),r=n(32),a=n(12),s=n(533),l=n(989);const c=n(387);function d(){}async function u(e,t){const n=gDesigner.getSyncUser(),i=gDesigner.getApplicationManager(),o=d.isOwner(n,e),r=(e.getProperty("asgn")||[]).includes(n.getUID()),a=i.isCommentingEditingEnabled(),s=await i.hasAccess(t);return a&&(s||o||r)}d.getCloudAnnotationsForDocument=async function(e){const t=e.getAnnotationsId();if(!t)throw new s("GAnnotationsUtils.getCloudAnnotationsForDocument: can't get annotations id for the document");const n=await e.getAnnotationsToken(t);return gDesigner.getAnnotationsManager().getAnnotations(t,n).then(i=>new l(i,t,n,e))},d.updateAndReturnCloudAnnotationsForDocument=async function(e,t){const n=e.getAnnotationsId();if(!n)throw new s("GAnnotationsUtils.updateAndReturnCloudAnnotationsForDocument: can't get annotations id for the document");t||(t=[]);const i=await e.getAnnotationsToken(n);return gDesigner.getAnnotationsManager().updateAnnotations(n,this._prepareAnnotations(e,t),i).then(t=>new l(t,n,i,e))},d._prepareAnnotations=function(e,t){return t},d.saveDocumentAnnotations=async function(e,t,n,o){var r=t;if(n=n||e.getScene(),!e.isCloudFile()&&!e.isExternalFile()||!n||!n.hasAnnotations()&&!n.isCloudAnnotations())return!1;var a=e.getId(),s=n.getProperty("cid"),c=e.getReservedId();let u=[];var p;n.iteratePages(e=>{let t=e.getAnnotations();o&&(d.removeSidFromAnnotations(t),e.getProperty("Guid")||d.removeGuidFromAnnotations(t)),u.push(t)},!0);var g=null;const h=async()=>{let e=await gApi.getFile(p,!0).catch(()=>null);if(e&&e.link_accesses&&e.link_accesses.length)for(var t=0;t<e.link_accesses.length&&!g;++t){let n=e.link_accesses[t];if(n.token&&n.comment)return n.token}return null};if((p=a||(s||c))&&r&&((g=await e.getAnnotationsToken(p))||(g=await h())),!p)try{const t={trashed:null};let n=await gApi.createFile(t);(p=n.id)&&e.setReservedId(p)}catch(e){console.warn("Failed to record annotations")}if(!p)return!1;r&&!g&&(g=await h());const f=this._prepareAnnotations(e,u.map(i.GNode.store));return f instanceof Array||(f.suppressNewPageNotifications=!!o),gDesigner.getAnnotationsManager().updateAnnotations(p,f,g).then(t=>{var a=new l(t,p,g,e);let s,c=a.annotationsCollection;return s=o&&n.getLastSavedTime()||new Date(a.lastUpdateTime).getTime(),c&&c.length?(n.iteratePages(e=>{let t=d.findAnnotationsListForPage(e,c);t&&e.setAnnotations(i.GNode.restore(t))},!0),n.getProperty("cid")!==p&&n.setCloudAnnotations(p),r&&g&&n.setProperty("asec",g)):(n.setCloudAnnotations(null),n.cleanAnnotations(),r&&g&&n.setProperty("asec",g)),n.setLastTimeAnnotationsFromCloudModified(s),!0}).catch(e=>(n.setCloudAnnotations(null),console.warn("Failed to record annotations: "+e),!1))},d.findAnnotationsListForPage=function(e,t){const n=e.getProperty("Guid",!0)||e.getAnnotations().getProperty("Guid");let i=null;if(!t||!t.length)return i;if(n&&(i=this._findInAnnotationsObj(t,e=>e.Guid===n||e.aid===n,e=>e.$Guid===n||e["@Guid"]===n||e.$aid===n)),!i){const n=e.getAnnotations().getProperty("aid");n&&(i=this._findInAnnotationsObj(t,e=>e.aid===n,e=>e.$aid===n))}if(!i){const n=e.getId();n&&(i=this._findInAnnotationsObj(t,e=>e.pgid===n,e=>e.$pgid===n))}return i},d._findInAnnotationsObj=function(e,t,n){return e.find(e=>e instanceof i.GAnnotationsList?n(e):t(e))},d.mergeAnnotations=function(e,t,n,o,a){let s={},l={},c=!1;t.forEach(e=>{l[e.getId()]=e,e.hasFlag(i.GNode.Flag.Selected)&&(s[e.getId()]=1)}),t.forEach(t=>{o.some(e=>e.getId()===t.getId())||(e.removeChild(t),c=!0)});const d=["$lmd","$storedUrl","$__ids","$plkt","$mtime","$lkt","@_lkt"];a&&a instanceof Object&&d.push(...Object.keys(a).map(e=>"$"+e));for(let t=0;t<o.length;t++){let n=o[t],a=l[n.getId()];a&&((0,r.isDifferent)(n,a,d.concat(n instanceof i.GRectangleAnnotation?["$cu"]:[]))&&((0,r.mergeNode)(a,n),c=!0),a.setProperty("mtime",n.getProperty("mtime"))),1===s[n.getId()]&&n.setFlag(i.GNode.Flag.Selected),l[n.getId()]||(e.appendChild(n),c=!0)}e.setProperty("sid",n.getProperty("sid")||null);const u=n.getProperty("Guid");return u&&e.setProperty("Guid",u),c},d.canDeleteAnnotation=function(e){var t=gDesigner.getSyncUser();return d.isOwner(t,e)},d.removeAnnotations=function(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!t||!t.getScene())return;let r=t.getScene(),a=gDesigner.getActiveDocument();if(a.getScene()===r){var s=!!a.getAnnotationsId();o.GAnnotationEditor.removeAnnotations(e,t,n,i,!s)}},d.filterAnnotationElements=function(e){return e.filter(e=>e.hasMixin(i.GAnnotation)||e instanceof i.GComment)},d.canResolveAnnotation=function(e){return u(e,c.RESOLVE_COMMENT_ANNOTATION)},d.canReopenAnnotation=function(e){return u(e,c.REOPEN_COMMENT_ANNOTATION)},d.isOwner=function(e,t){if(e){const n=t.getProperty?t.getProperty("uid"):t.uid;return e.getUID()===n}return!1},d.canUpdate=function(e){return!(gDesigner.isAnonymous()&&!a.ANONYMOUS_SESSION_ENABLED)&&!!e},d.resolveAllComments=function(e){var t=e.getScene();t&&o.GEditor.tryRunTransaction(t,(function(){t.iteratePages(e=>{e.getAnnotations().resolve()},!0)}),i.GLocale.get(new i.GLocaleKey("GAnnotationsSidebar","text.resolve-all-comments")))},d.getCommentsCount=function(e){if(!e.annotations)return 0;let t=0;const n={annotationsCollection:e.annotations,lastUpdateTime:0};let i=new l(n,e.id);return i&&i.annotationsCollection&&i.annotationsCollection.forEach(e=>{e.$&&e.$.forEach((function(e){e.rsv||(e.$&&0!==e.$.length&&e.$.forEach((function(e){"cmt"===e["@"]&&t++})),t++)}))}),t},d.removeSidFromAnnotations=function(e){d.setPropertyValueInAnnotations(e,"sid",null)},d.removeGuidFromAnnotations=function(e){d.setPropertyValueInAnnotations(e,"Guid","")},d.setPropertyValueInAnnotations=function(e,t,n,o){e.accept(e=>{(e instanceof i.GAnnotationsList||e.hasMixin(i.GAnnotation)||e instanceof i.GComment)&&e.setProperty(t,n,o)})},e.exports=d},,function(e,t,n){var i=n(6),o=n(311),r=i.TypeError;e.exports=function(e){if(o(e))throw r("The method doesn't accept regular expressions");return e}},function(e,t,n){var i=n(38)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(e){}}return!1}},,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){this._providerManager=e}n(129),n(14),n(29),i.Errors={UnknownError:0,ConnectionError:1},i.prototype._providerManager=null,i.prototype._enabled=!0,i.prototype.addPreviews=function(e){throw new Error("GFontsProvider.addPreviews: virtual")},i.prototype.load=function(e,t,n,i){throw new Error("GFontsProvider.load: virtual")},i.prototype.getTotalFonts=function(e){throw new Error("GFontsProvider.getTotalFonts: virtual")},i.prototype.getProviderId=function(){throw new Error("GFontsProvider.getProviderId: virtual")},i.prototype.resolveFont=function(e,t,n,i){throw new Error("GFontsProvider.resolveFont: virtual")},i.prototype.isInitialized=function(){return!0},i.prototype.resetProvider=function(){},i.prototype.hasEnabler=function(){return!1},i.prototype.getEnabler=function(){return null},i.prototype.setEnabled=function(e){this._enabled=!!e},i.prototype.isEnabled=function(){return this._enabled},i.prototype._searchFilter=function(e){return function(t){return e.indexOf("%")>=0?t.family.toLowerCase().startsWith(e.replace(/%/g,"")):t.family.toLowerCase()==e.toLowerCase()}},i.prototype._getClosestKey=function(e,t,n,i){var o,r=Number.POSITIVE_INFINITY;n=Number(n);for(var a=-1,s=0;s<e.length;s++){var l=e[s];l.family===t&&(o=(n-l.weight)*(n-l.weight),i!==l.style&&(o+=9e4),o<r&&(r=o,a=s))}return a},e.exports=i},function(e,t,n){var i,o,r,a,s,l;e.exports=(l=n(46),o=(i=l).lib,r=o.Base,a=o.WordArray,(s=i.x64={}).Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],i=0;i<t;i++){var o=e[i];n.push(o.high),n.push(o.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}}),l)},,,,,,function(e,t,n){"use strict";n(9),n(3);var i=n(1);const o=n(216),r=n(151);function a(){}i.GObject.inherit(a,o),a.Item=function(e,t){o.Item.call(this,e),this.setFile(t)},i.GObject.inherit(a.Item,o.Item),a.Item.prototype._app=null,a.Item.prototype._filename=null,a.Item.prototype._ext=null,a.Item.prototype._id=null,a.Item.prototype._file=null,a.Item.prototype.isRegistrable=function(){return!!this.getId()},a.Item.prototype.getId=function(){return this._id},a.Item.prototype.setId=function(e){return this._id=e,this},a.Item.prototype.getFullName=function(){return this._filename},a.Item.prototype.getName=function(){return this._filename},a.Item.prototype.setFileName=function(e){return this._filename=e,this},a.Item.prototype.getExtension=function(){return this._ext&&this._ext.toUpperCase()||"CDRAPP"},a.Item.prototype.setFile=function(e){if(!e)throw new Error(i.GLocale.get(new i.GLocaleKey("GExternalStorage","text.error-file-cant-be-null")));e=r.createOrReturnSelfInstance(e),this._file=e,this._id=e.id,this._filename=e.name},a.Item.prototype.getFile=function(){const e=this._file;return!e.settings&&this._client&&(e.settings=this._client.getSettings()),e},a.Item.prototype.hasFileSettings=function(){return this._file&&this._file.settings},a.Item.prototype.getUniqueId=function(){return this._id},a.Item.prototype.getVersion=function(){throw Error("Not implemented!")},a.Item.prototype.getMimeType=function(){throw Error("Not implemented!")},a.Item.prototype.hasVersionControl=function(){return!1},a.Item.prototype.hasUpdates=async function(){throw Error("Not implemented!")},a.Item.prototype.getLatestFileVersion=async function(){throw Error("Not implemented!")},a.Item.prototype.getLatestFileInfo=async function(){throw Error("Not implemented!")},a.Item.prototype.exists=async function(){throw Error("Not implemented!")},a.Item.prototype.isVersionNewerThan=function(){throw Error("Not implemented!")},a.Item.prototype.setCloudClient=function(e){this._client=e},a.Item.prototype.getCloudClient=function(){return this._client},a.Item.prototype.supportsSharing=function(){return this._getClient().isCorporate()},a.Item.prototype.getCorporateProviderName=function(){throw Error("Not implemented!")},a.Item.prototype.isEmailFromCorporateDomain=function(){throw Error("Not implemented!")},a.Item.prototype.toString=function(){return"[Object GExternalStorage.Item]"},e.exports=a},,,function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t){this.document=e,this.state=t}i.GObject.inherit(o,i.GEvent),o.prototype.document=null,o.prototype.state=null,o.prototype.toString=function(){return"Object [GApplicationStateChangedEvent]"},e.exports=o},function(e,t,n){"use strict";n(3);const{GEvent:i,GObject:o}=n(1);function r(e,t){this.type=e,this.data=t}o.inherit(r,i),r.prototype.type=null,r.prototype.data=null,r.Type={AnnotationsUpdate:0,ShareUpdate:10,UserUpdate:20,LockRequest:30,LockUpdated:31,FileUpdate:40,FileAutoSave:41,ReviewStatusChanged:50},r.prototype.toString=function(){return"[Object GCollaborationEvent]"},e.exports=r},function(e,t,n){"use strict";n(3);var i=n(1);function o(){}i.GObject.inherit(o,i.GEventTarget),o.UpdateEvent=function(){},i.GObject.inherit(o.UpdateEvent,i.GEvent),o.UpdateEvent.prototype.toString=function(){return"[Object GView.UpdateEvent]"},o.UPDATE_EVENT=new o.UpdateEvent,o.prototype.getId=function(){throw new Error("Not Supported")},o.prototype.getTitle=function(){throw new Error("Not Supported")},o.prototype.isEnabled=function(){return!0},o.prototype.isVisible=function(){return!0},o.prototype._fireUpdateEvent=function(){this.trigger(o.UPDATE_EVENT)},o.prototype.toString=function(){return"[Object GView]"},e.exports=o},function(e,t,n){"use strict";n(58),n(45);var i=n(1),o=n(16),r=n(353),a=n(118),s=n(772),{SidebarsIds:l}=n(193),c=n(720);function d(e,t,n){this._htmlElement=e,this._orientation=t,this._frame=n,this._sidebarWidths={},this._canResize=!1,this._isResizing=!1}i.GObject.inherit(d,i.GEventTarget),d.Orientation={Left:"left",Right:"right"},d.SidebarEvent=c,d.prototype._htmlElement=null,d.prototype._orientation=null,d.prototype._sidebars=null,d.prototype._activeSidebar=null,d.prototype._activeTouchTool=null,d.prototype._touchToolbar=null,d.prototype._sidebarWidths=null,d.prototype._sidebarsSelector=null,d.prototype.getActiveSidebar=function(){return this._activeSidebar},d.prototype.setActiveSidebar=function(e){if(e||this.setActiveTouchTool(null),e!==this._activeSidebar){if(e){var t=this.getSidebar(e);if((!t||!t.isVisible())&&(e=null,this._activeSidebar)){const e=this.getSidebar(this._activeSidebar);if(e&&e.isVisible())return}}for(var n=this._activeSidebar,i=0;i<this._sidebars.length;++i){var o=this._sidebars[i],r=o.sidebar.getId();if(r===e){this._activeSidebar=r,o.container.css("display",""),o.sidebar.activate(),this._sidebarWidths[r]?this._htmlElement.css("width",this._sidebarWidths[r]+"px"):this._htmlElement.css("width",o.sidebar.getDefaultWidth()+"px"),this.relayout(),this.hasEventListeners(d.SidebarEvent)&&this.trigger(new d.SidebarEvent(d.SidebarEvent.Type.Activated,o.sidebar));const e=o.sidebar.getTouchTools();if(e){const t=e.find(e=>{let{def:t}=e;return!!t})||e[0];t&&this.setActiveTouchTool(t)}}else o.container.css("display","none"),r===n&&(o.sidebar.deactivate(),this._activeSidebar=e,this.hasEventListeners(d.SidebarEvent)&&this.trigger(new d.SidebarEvent(d.SidebarEvent.Type.Deactivated,o.sidebar)));this._updateBadge(o.sidebar)}this._htmlElement.find(".sidebar-option").removeClass("active"),this._htmlElement.find(".sidebar-option.sidebar-"+e).addClass("active"),this._activeSidebar&&!this._getSidebarInfo(this._activeSidebar)&&this.setActiveSidebar(this._sidebars[0].sidebar.getId())}},d.prototype.setActiveTouchTool=function(e){this._activeTouchTool&&e&&this._activeTouchTool.id===e.id||(this._htmlElement.find("[g-touch-tool]").removeClass("g-active"),this._htmlElement.find(".sidebar-container").removeClass("g-active"),this._activeTouchTool&&this._activeTouchTool.deactivate(),e?(this._htmlElement.find(".sidebar-".concat(e.sidebar)).addClass("g-active"),this._htmlElement.find('[g-touch-tool="'.concat(e.id,'"]')).addClass("g-active"),this._activeTouchTool=e):this._activeTouchTool=null,this._activeTouchTool&&this._activeTouchTool.activate())},d.prototype.showSidebar=function(e){if(this.getSidebar(e)&&this._activeSidebar!==e){null===this._activeSidebar&&this.setActiveSidebar(e);var t=this._htmlElement.find(".sidebar-option.sidebar-"+e);t.is(":hidden")&&t.show()}},d.prototype.hideSidebar=function(e){if(this.getActiveSidebar()===e){for(var t=null,n=0;n<this._sidebars.length&&!t;++n)if(this._sidebars[n].sidebar.getId()!==e){var i=this._sidebars[n].sidebar.getId();this._htmlElement.find(".sidebar-option.sidebar-"+i).is(":visible")&&(t=i)}this.setActiveSidebar(t)}var o=this._htmlElement.find(".sidebar-option.sidebar-"+e);o.is(":visible")&&o.hide()},d.prototype.setSidebarEnabled=function(e,t){var n=this._getSidebarInfo(e);if(n)if(t)n.container.find(".g-disabled-overlay").remove(),n.container.removeClass("g-disabled");else{var i=n.container.find(".g-disabled-overlay");0===i.length&&(i=$("<div></div>").addClass("g-disabled-overlay").appendTo(n.container)),n.container.addClass("g-disabled")}},d.prototype.init=function(){this._sidebars=[];var e=function(e,t){t>1&&!this._sidebarsSelector&&(this._sidebarsSelector=$("<div/>").addClass("sidebar-selector").css("display","none").appendTo(this._htmlElement),this._htmlElement.css("width",e.getDefaultWidth()+"px")),this._sidebarsSelector&&$("<div/>").addClass("sidebar-option sidebar-"+e.getId()).append([$("<span/>").addClass("sidebar-title").text(i.GLocale.get(e.getTitle())),$("<span/>").addClass("g-badge").hide()]).on("click",this._tryActivateSidebar.bind(this,e)).appendTo(this._sidebarsSelector);var n=$("<div></div>").addClass("sidebar-container sidebar-"+e.getId()+(this._sidebarsSelector?" multiple":"")).css("display","none").appendTo(this._htmlElement);e.init(n),this._sidebars.push({container:n,sidebar:e}),n.find("button").each((function(e,t){$(t).on("mousedown",(function(e){e.preventDefault()}))})),e.addEventListener(r.UpdateEvent,function(){this.setSidebarEnabled(e.getId(),e.isEnabled()),this._updateTouchToolbar(),this._updateBadge(e)}.bind(this)),e.getId()===l.GInspectorSidebar&&e.addEventListener(d.SidebarEvent,function(e){[d.SidebarEvent.Type.ChildAdded,d.SidebarEvent.Type.ChildRemoved].includes(e.type)&&this._updateTouchToolbar()}.bind(this)),this.setSidebarEnabled(e.getId(),e.isEnabled())}.bind(this),t=[];for(let e=0;e<window.gravit.sidebars.length;++e){let n=window.gravit.sidebars[e];n.getOrientation()===this._orientation&&t.push(n)}if(window.gravit.sidebars)for(let n=0;n<t.length;++n){let i=t[n];i.getOrientation()===this._orientation&&e(i,t.length)}gDesigner.addEventListener(a,this._settingChanged,this),this._mouseDownHandler=this._documentMouseDown.bind(this),this._mouseMoveHandler=this._documentMouseMove.bind(this),this._mouseReleaseHandler=this._resizeMouseUp.bind(this),document.addEventListener("mousemove",this._mouseMoveHandler),document.addEventListener("mousedown",this._mouseDownHandler),document.addEventListener("mouseup",this._mouseReleaseHandler,!0),document.addEventListener("dragstart",this._mouseMoveHandler),document.addEventListener("drag",this._mouseMoveHandler),document.addEventListener("dragend",this._mouseMoveHandler,!0),this._updateTouchToolbar()},d.prototype.setView=function(e){e!==this._view&&(this._view&&(this._view.removeEventListener(o.GMouseEvent.Down,this._mouseDownHandler,this),this._view.removeEventListener(o.GMouseEvent.Move,this._mouseMoveHandler,this),this._view.removeEventListener(o.GMouseEvent.DragStart,this._mouseMoveHandler,this),this._view.removeEventListener(o.GMouseEvent.Drag,this._mouseMoveHandler,this),this._view.removeEventListener(o.GMouseEvent.DragEnd,this._mouseMoveHandler,this),this._view.removeEventListener(o.GMouseEvent.Release,this._mouseReleaseHandler,this)),this._view=e,this._view&&(this._view.addEventListener(o.GMouseEvent.Down,this._mouseDownHandler,this),this._view.addEventListener(o.GMouseEvent.Move,this._mouseMoveHandler,this),this._view.addEventListener(o.GMouseEvent.DragStart,this._mouseMoveHandler,this),this._view.addEventListener(o.GMouseEvent.Drag,this._mouseMoveHandler,this),this._view.addEventListener(o.GMouseEvent.DragEnd,this._mouseMoveHandler,this),this._view.addEventListener(o.GMouseEvent.Release,this._mouseReleaseHandler,this)))},d.prototype._isActiveSidebarDeactivatable=function(){return!(this.getSidebar(this._activeSidebar)&&!this.getSidebar(this._activeSidebar).isDeactivatable())},d.prototype._tryActivateSidebar=function(e){return!!this._isActiveSidebarDeactivatable()&&(gDesigner.stats("sidebars_activate_sidebar",e&&e.getId()||"unkn"),this.setActiveSidebar(e.getId()),this.setSidebarEnabled(e.getId(),e.isEnabled()),!0)},d.prototype.disableContextSensitive=function(){this._updateTouchToolbar({disableContextSensitive:!0})},d.prototype.enableContextSensitive=function(){this._updateTouchToolbar()},d.prototype._documentMouseMove=function(e){if(this._htmlElement&&this._htmlElement[0])if(this._isResizing){var t;e instanceof MouseEvent?t=e.pageX:(e.isImmediatePropagationStopped=!0,t=e.client.getX()/i.GPaintCanvas.getScreenDPI()),e.stopPropagation instanceof Function&&e.stopPropagation(),this._newWidth=this._orientation===d.Orientation.Left?t:window.innerWidth-t,this._newWidth<this._minimumWidth&&(this._newWidth=this._minimumWidth),this._htmlElement.css("width",this._newWidth+"px");var n=this.getSidebar(this._activeSidebar);n&&n.resize()}else{var o=this._orientation===d.Orientation.Left?this._htmlElement[0].offsetWidth:window.innerWidth-this._htmlElement[0].offsetWidth,r=i.GMath.isEqualEps(e.pageX,o,3*i.GPaintCanvas.getScreenDPI())&&this._orientation!==d.Orientation.Right;(r||this._canResize)&&(r&&!this._canResize?(this._frame.addClass("resize"),this._canResize=r):this._canResize&&!r&&(this._frame.removeClass("resize"),this._canResize=r))}},d.prototype._documentMouseDown=function(e){var t=this.getSidebar(this._activeSidebar);this._canResize&&t&&t.isResizeable()&&(this._isResizing=!0,this._minimumWidth=t.getMinimumWidth(),e instanceof o.GMouseEvent&&(e.isImmediatePropagationStopped=!0),e.stopPropagation instanceof Function&&e.stopPropagation())},d.prototype._resizeMouseUp=function(e){if(this._isResizing){e instanceof o.GMouseEvent&&(e.isImmediatePropagationStopped=!0),e.stopPropagation instanceof Function&&e.stopPropagation(),this._isResizing=!1;var t=this.getSidebar(this._activeSidebar);t&&gDesigner.setSetting("sidebars_width_"+t.getId(),this._newWidth)}},d.prototype.relayout=function(){if(this._activeSidebar){let e=this.getSidebar(this._activeSidebar);e&&(this._htmlElement.css("width",e.getSettingWidth()+"px"),e.relayout())}for(var e=0,t=0,n=0;n<this._sidebars.length;++n){let o=this._sidebars[n];var i=o.sidebar.getId();o.sidebar.isVisible()?(e++,this._htmlElement.find(".sidebar-option.sidebar-"+i).show()):this._htmlElement.find(".sidebar-option.sidebar-"+i).hide(),o.sidebar.isEnabled()&&t++,this._updateBadge(o.sidebar)}if(e>0){let n=this._htmlElement.find(".sidebar-container");this._sidebarsSelector&&t>0&&(this._sidebarsSelector.css("display",""),this._sidebarsSelector.toggleClass("singleton",1===e),n.hasClass("multiple")||n.addClass("multiple")),this._orientation===d.Orientation.Right&&n.css("bottom",$(".license-info:visible").length>0?parseInt($(".license-info:visible").outerHeight(),10):0)}else this._sidebarsSelector&&this._sidebarsSelector.css("display","none"),this._htmlElement.find(".sidebar-container").removeClass("multiple");this._updateTouchToolbar()},d.prototype._getSidebarInfo=function(e){if(e&&this._sidebars)for(var t=0;t<this._sidebars.length;++t){if(this._sidebars[t].sidebar.getId()===e)return this._sidebars[t]}return null},d.prototype._settingChanged=function(e){if(e.key==="sidebars_"+this._orientation+"_active"){if(gDesigner.isTouchEnabled()&&e.restoring)return;this.setActiveSidebar(e.newValue?e.newValue:null),gDesigner.setPartVisible(this.getSidebarsPart(),!!e.newValue)}else if(0===e.key.indexOf("sidebars_width_")&&this._orientation!==d.Orientation.Right){var t=e.key.substr("sidebars_width_".length);this._sidebarWidths[t]=e.newValue,t===this._activeSidebar&&(this._htmlElement.css("width",e.newValue+"px"),gDesigner.relayout())}else"touch"===e.key&&(this._updateTouchToolbar(),this._htmlElement.find(".appearance-properties-panel").removeClass("display-none"))},d.prototype._updateBadge=function(e){if(this._sidebarsSelector){var t=this._sidebarsSelector.find(".sidebar-option.sidebar-"+e.getId()),n=t.find(".g-badge");e.updateBadge(n)?(t.addClass("content-width"),n.show()):(t.removeClass("content-width"),n.hide())}},d.prototype.getSidebar=function(e){var t=null;if(e){var n=this._getSidebarInfo(e);n&&(t=n.sidebar)}return t},d.prototype.getSidebarsPart=function(){switch(this._orientation){case d.Orientation.Left:return s.LeftSidebars;case d.Orientation.Right:return s.RightSidebars}},d.prototype.addClassName=function(e){this._htmlElement.find(".sidebar-container").addClass(e)},d.prototype.removeClassName=function(e){this._htmlElement.find(".sidebar-container").removeClass(e)},d.setOrientationStateInSetting=function(e,t){gDesigner.setSetting(d.getSettingNameForSidebar(e),t)},d.isOrientationActiveInSetting=function(e){return gDesigner.getSetting(d.getSettingNameForSidebar(e))},d.getSettingNameForSidebar=function(e){return"sidebars_"+e+"_active"},d.prototype.getHtmlElement=function(){return this._htmlElement},e.exports=d},function(e,t,n){"use strict";var i={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,r=o&&!i.call({1:2},1);t.f=r?function(e){var t=o(this,e);return!!t&&t.enumerable}:i},function(e,t,n){var i=n(357);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var i=n(194),o=n(27);e.exports=!!Object.getOwnPropertySymbols&&!o((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},function(e,t,n){var i=n(67),o=n(27),r=n(220);e.exports=!i&&!o((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var i=n(22),o=n(59),r=n(178),a=n(556).indexOf,s=n(272),l=i([].push);e.exports=function(e,t){var n,i=r(e),c=0,d=[];for(n in i)!o(s,n)&&o(i,n)&&l(d,n);for(;t.length>c;)o(i,n=t[c++])&&(~a(d,n)||l(d,n));return d}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(6);e.exports=i.Promise},function(e,t,n){var i=n(49),o=n(52),r=n(145);e.exports=function(e,t,n){var a,s;o(e);try{if(!(a=r(e,"return"))){if("throw"===t)throw n;return n}a=i(a,e)}catch(e){s=!0,a=e}if("throw"===t)throw n;if(s)throw a;return o(a),n}},function(e,t,n){var i=n(38)("iterator"),o=!1;try{var r=0,a={next:function(){return{done:!!r++}},return:function(){o=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}},function(e,t,n){var i=n(6),o=n(277),r=n(179),a=i.TypeError;e.exports=function(e){if(o(e))return e;throw a(r(e)+" is not a constructor")}},function(e,t,n){var i,o,r,a,s=n(6),l=n(184),c=n(110),d=n(34),u=n(59),p=n(27),g=n(366),h=n(157),f=n(220),m=n(367),y=n(224),v=s.setImmediate,_=s.clearImmediate,b=s.process,w=s.Dispatch,C=s.Function,E=s.MessageChannel,S=s.String,G=0,A={};try{i=s.location}catch(e){}var T=function(e){if(u(A,e)){var t=A[e];delete A[e],t()}},P=function(e){return function(){T(e)}},L=function(e){T(e.data)},D=function(e){s.postMessage(S(e),i.protocol+"//"+i.host)};v&&_||(v=function(e){var t=h(arguments,1);return A[++G]=function(){l(d(e)?e:C(e),void 0,t)},o(G),G},_=function(e){delete A[e]},y?o=function(e){b.nextTick(P(e))}:w&&w.now?o=function(e){w.now(P(e))}:E&&!m?(a=(r=new E).port2,r.port1.onmessage=L,o=c(a.postMessage,a)):s.addEventListener&&d(s.postMessage)&&!s.importScripts&&i&&"file:"!==i.protocol&&!p(D)?(o=D,s.addEventListener("message",L,!1)):o="onreadystatechange"in f("script")?function(e){g.appendChild(f("script")).onreadystatechange=function(){g.removeChild(this),T(e)}}:function(e){setTimeout(P(e),0)}),e.exports={set:v,clear:_}},function(e,t,n){var i=n(96);e.exports=i("document","documentElement")},function(e,t,n){var i=n(130);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},function(e,t,n){var i=n(52),o=n(62),r=n(369);e.exports=function(e,t){if(i(e),o(t)&&t.constructor===e)return t;var n=r.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var i=n(119),o=function(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)};e.exports.f=function(e){return new o(e)}},function(e,t,n){"use strict";var i=n(67),o=n(22),r=n(49),a=n(27),s=n(371),l=n(360),c=n(355),d=n(97),u=n(218),p=Object.assign,g=Object.defineProperty,h=o([].concat);e.exports=!p||a((function(){if(i&&1!==p({b:1},p(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=p({},e)[n]||"abcdefghijklmnopqrst"!=s(p({},t)).join("")}))?function(e,t){for(var n=d(e),o=arguments.length,a=1,p=l.f,g=c.f;o>a;)for(var f,m=u(arguments[a++]),y=p?h(s(m),p(m)):s(m),v=y.length,_=0;v>_;)f=y[_++],i&&!r(g,m,f)||(n[f]=m[f]);return n}:p},function(e,t,n){var i=n(359),o=n(274);e.exports=Object.keys||function(e){return i(e,o)}},function(e,t){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(e,t,n){var i=n(220)("span").classList,o=i&&i.constructor&&i.constructor.prototype;e.exports=o===Object.prototype?void 0:o},function(e,t,n){var i=n(110),o=n(22),r=n(218),a=n(97),s=n(109),l=n(512),c=o([].push),d=function(e){var t=1==e,n=2==e,o=3==e,d=4==e,u=6==e,p=7==e,g=5==e||u;return function(h,f,m,y){for(var v,_,b=a(h),w=r(b),C=i(f,m),E=s(w),S=0,G=y||l,A=t?G(h,E):n||p?G(h,0):void 0;E>S;S++)if((g||S in w)&&(_=C(v=w[S],S,b),e))if(t)A[S]=_;else if(_)switch(e){case 3:return!0;case 5:return v;case 6:return S;case 2:c(A,v)}else switch(e){case 4:return!1;case 7:c(A,v)}return u?-1:o||d?d:A}};e.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(e,t,n){var i=n(6),o=n(114),r=n(104),a=i.RangeError;e.exports=function(e){if(void 0===e)return 0;var t=o(e),n=r(t);if(t!==n)throw a("Wrong length or index");return n}},function(e,t,n){var i=n(67),o=n(73),r=n(52),a=n(178),s=n(371);e.exports=i?Object.defineProperties:function(e,t){r(e);for(var n,i=a(t),l=s(t),c=l.length,d=0;c>d;)o.f(e,n=l[d++],i[n]);return e}},function(e,t,n){"use strict";var i=n(47),o=n(49),r=n(126),a=n(180),s=n(34),l=n(379),c=n(225),d=n(154),u=n(155),p=n(89),g=n(80),h=n(38),f=n(182),m=n(380),y=a.PROPER,v=a.CONFIGURABLE,_=m.IteratorPrototype,b=m.BUGGY_SAFARI_ITERATORS,w=h("iterator"),C=function(){return this};e.exports=function(e,t,n,a,h,m,E){l(n,t,a);var S,G,A,T=function(e){if(e===h&&I)return I;if(!b&&e in D)return D[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},P=t+" Iterator",L=!1,D=e.prototype,x=D[w]||D["@@iterator"]||h&&D[h],I=!b&&x||T(h),O="Array"==t&&D.entries||x;if(O&&(S=c(O.call(new e)))!==Object.prototype&&S.next&&(r||c(S)===_||(d?d(S,_):s(S[w])||g(S,w,C)),u(S,P,!0,!0),r&&(f[P]=C)),y&&"values"==h&&x&&"values"!==x.name&&(!r&&v?p(D,"name","values"):(L=!0,I=function(){return o(x,this)})),h)if(G={values:T("values"),keys:m?I:T("keys"),entries:T("entries")},E)for(A in G)(b||L||!(A in D))&&g(D,A,G[A]);else i({target:t,proto:!0,forced:b||L},G);return r&&!E||D[w]===I||g(D,w,I,{name:h}),f[t]=I,G}},function(e,t,n){"use strict";var i=n(380).IteratorPrototype,o=n(159),r=n(152),a=n(155),s=n(182),l=function(){return this};e.exports=function(e,t,n){var c=t+" Iterator";return e.prototype=o(i,{next:r(1,n)}),a(e,c,!1,!0),s[c]=l,e}},function(e,t,n){"use strict";var i,o,r,a=n(27),s=n(34),l=n(159),c=n(225),d=n(80),u=n(38),p=n(126),g=u("iterator"),h=!1;[].keys&&("next"in(r=[].keys())?(o=c(c(r)))!==Object.prototype&&(i=o):h=!0),null==i||a((function(){var e={};return i[g].call(e)!==e}))?i={}:p&&(i=l(i)),s(i[g])||d(i,g,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:h}},function(e,t){(function(t){e.exports=t}).call(this,{})},,function(e,t,n){var i=n(27),o=n(38),r=n(126),a=o("iterator");e.exports=!i((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),n+=i+e})),r&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},,function(e,t,n){"use strict";n.r(t);class i extends Error{constructor(...e){super(...e),this.constructor=i,this.__proto__=i.prototype,this.name="AppError"}toString(){return this.message}}t.default=i},function(e,t,n){"use strict";n(262);const{ShareRoles:i,defaultUserSettings:{share:{defaults:{public:{role:o}={},private:{role:r}={}}={}}={}}={}}=n(12),a=n(963),s=n(966),l=n(967);function c(){throw"No instantiate"}c.makeFromShare=function(e){const t=c._makeFromShareRole(e.getRole());return t&&(t.applyPermissions(new s(e.getPermissions())),t.lockPermissions()),t},c.makeFromShareRole=function(e){const t=c._makeFromShareRole(e);return t.lockPermissions(),t},c._makeFromShareRole=function(e){if(!e)return null;const{id:t,name:n,description:i,status:o,pro:r,permissions:c={},assignable:d,level:u}=e,p=new a({id:t,level:u,name:n,description:i,status:o,pro:r,permissions:new s(c),assignable:d}),g=l[p.id];return g&&p.grant(g),p},c.ROLES={get ALL(){return Object.values(i).map(e=>c.makeFromShareRole(e))},get DEFAULT_PUBLIC_ROLE(){return c.makeFromShareRole(o)},get DEFAULT_PRIVATE_ROLE(){return c.makeFromShareRole(r)},get NO_ACCESS_ROLE(){return c.makeFromShareRole(i.NoAccess)},get APPROVER_ROLE(){return c.makeFromShareRole(i.Approver)},get OWNER_ROLE(){return c.makeFromShareRole(i.Owner)},get VIEWER_ROLE(){return c.makeFromShareRole(i.Viewer)}},e.exports=c},function(e,t,n){"use strict";n(25);const i=n(968);e.exports=Object.assign({},i)},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(381),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(t){return new Md5(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Md5},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var n=OUTPUT_TYPES[t];e[n]=createOutputMethod(n)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null==e)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e){if(!this.finalized){var t,n=typeof e;if("string"!==n){if("object"!==n)throw ERROR;if(null===e)throw ERROR;if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw ERROR;t=!0}for(var i,o,r=0,a=e.length,s=this.blocks,l=this.buffer8;r<a;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)if(ARRAY_BUFFER)for(o=this.start;r<a&&o<64;++r)l[o++]=e[r];else for(o=this.start;r<a&&o<64;++r)s[o>>2]|=e[r]<<SHIFT[3&o++];else if(ARRAY_BUFFER)for(o=this.start;r<a&&o<64;++r)(i=e.charCodeAt(r))<128?l[o++]=i:i<2048?(l[o++]=192|i>>6,l[o++]=128|63&i):i<55296||i>=57344?(l[o++]=224|i>>12,l[o++]=128|i>>6&63,l[o++]=128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++r)),l[o++]=240|i>>18,l[o++]=128|i>>12&63,l[o++]=128|i>>6&63,l[o++]=128|63&i);else for(o=this.start;r<a&&o<64;++r)(i=e.charCodeAt(r))<128?s[o>>2]|=i<<SHIFT[3&o++]:i<2048?(s[o>>2]|=(192|i>>6)<<SHIFT[3&o++],s[o>>2]|=(128|63&i)<<SHIFT[3&o++]):i<55296||i>=57344?(s[o>>2]|=(224|i>>12)<<SHIFT[3&o++],s[o>>2]|=(128|i>>6&63)<<SHIFT[3&o++],s[o>>2]|=(128|63&i)<<SHIFT[3&o++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++r)),s[o>>2]|=(240|i>>18)<<SHIFT[3&o++],s[o>>2]|=(128|i>>12&63)<<SHIFT[3&o++],s[o>>2]|=(128|i>>6&63)<<SHIFT[3&o++],s[o>>2]|=(128|63&i)<<SHIFT[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[3&t],t>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,t,n,i,o,r,a=this.blocks;this.first?t=((t=((e=((e=a[0]-680876937)<<7|e>>>25)-271733879<<0)^(n=((n=(-271733879^(i=((i=(-1732584194^2004318071&e)+a[1]-117830708)<<12|i>>>20)+e<<0)&(-271733879^e))+a[2]-1126478375)<<17|n>>>15)+i<<0)&(i^e))+a[3]-1316259209)<<22|t>>>10)+n<<0:(e=this.h0,t=this.h1,n=this.h2,t=((t+=((e=((e+=((i=this.h3)^t&(n^i))+a[0]-680876936)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+a[1]-389564586)<<12|i>>>20)+e<<0)&(e^t))+a[2]+606105819)<<17|n>>>15)+i<<0)&(i^e))+a[3]-1044525330)<<22|t>>>10)+n<<0),t=((t+=((e=((e+=(i^t&(n^i))+a[4]-176418897)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+a[5]+1200080426)<<12|i>>>20)+e<<0)&(e^t))+a[6]-1473231341)<<17|n>>>15)+i<<0)&(i^e))+a[7]-45705983)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+a[8]+1770035416)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+a[9]-1958414417)<<12|i>>>20)+e<<0)&(e^t))+a[10]-42063)<<17|n>>>15)+i<<0)&(i^e))+a[11]-1990404162)<<22|t>>>10)+n<<0,t=((t+=((e=((e+=(i^t&(n^i))+a[12]+1804603682)<<7|e>>>25)+t<<0)^(n=((n+=(t^(i=((i+=(n^e&(t^n))+a[13]-40341101)<<12|i>>>20)+e<<0)&(e^t))+a[14]-1502002290)<<17|n>>>15)+i<<0)&(i^e))+a[15]+1236535329)<<22|t>>>10)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+a[1]-165796510)<<5|e>>>27)+t<<0)^t))+a[6]-1069501632)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+a[11]+643717713)<<14|n>>>18)+i<<0)^i))+a[0]-373897302)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+a[5]-701558691)<<5|e>>>27)+t<<0)^t))+a[10]+38016083)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+a[15]-660478335)<<14|n>>>18)+i<<0)^i))+a[4]-405537848)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+a[9]+568446438)<<5|e>>>27)+t<<0)^t))+a[14]-1019803690)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+a[3]-187363961)<<14|n>>>18)+i<<0)^i))+a[8]+1163531501)<<20|t>>>12)+n<<0,t=((t+=((i=((i+=(t^n&((e=((e+=(n^i&(t^n))+a[13]-1444681467)<<5|e>>>27)+t<<0)^t))+a[2]-51403784)<<9|i>>>23)+e<<0)^e&((n=((n+=(e^t&(i^e))+a[7]+1735328473)<<14|n>>>18)+i<<0)^i))+a[12]-1926607734)<<20|t>>>12)+n<<0,t=((t+=((r=(i=((i+=((o=t^n)^(e=((e+=(o^i)+a[5]-378558)<<4|e>>>28)+t<<0))+a[8]-2022574463)<<11|i>>>21)+e<<0)^e)^(n=((n+=(r^t)+a[11]+1839030562)<<16|n>>>16)+i<<0))+a[14]-35309556)<<23|t>>>9)+n<<0,t=((t+=((r=(i=((i+=((o=t^n)^(e=((e+=(o^i)+a[1]-1530992060)<<4|e>>>28)+t<<0))+a[4]+1272893353)<<11|i>>>21)+e<<0)^e)^(n=((n+=(r^t)+a[7]-155497632)<<16|n>>>16)+i<<0))+a[10]-1094730640)<<23|t>>>9)+n<<0,t=((t+=((r=(i=((i+=((o=t^n)^(e=((e+=(o^i)+a[13]+681279174)<<4|e>>>28)+t<<0))+a[0]-358537222)<<11|i>>>21)+e<<0)^e)^(n=((n+=(r^t)+a[3]-722521979)<<16|n>>>16)+i<<0))+a[6]+76029189)<<23|t>>>9)+n<<0,t=((t+=((r=(i=((i+=((o=t^n)^(e=((e+=(o^i)+a[9]-640364487)<<4|e>>>28)+t<<0))+a[12]-421815835)<<11|i>>>21)+e<<0)^e)^(n=((n+=(r^t)+a[15]+530742520)<<16|n>>>16)+i<<0))+a[2]-995338651)<<23|t>>>9)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+a[0]-198630844)<<6|e>>>26)+t<<0)|~n))+a[7]+1126891415)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+a[14]-1416354905)<<15|n>>>17)+i<<0)|~e))+a[5]-57434055)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+a[12]+1700485571)<<6|e>>>26)+t<<0)|~n))+a[3]-1894986606)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+a[10]-1051523)<<15|n>>>17)+i<<0)|~e))+a[1]-2054922799)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+a[8]+1873313359)<<6|e>>>26)+t<<0)|~n))+a[15]-30611744)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+a[6]-1560198380)<<15|n>>>17)+i<<0)|~e))+a[13]+1309151649)<<21|t>>>11)+n<<0,t=((t+=((i=((i+=(t^((e=((e+=(n^(t|~i))+a[4]-145523070)<<6|e>>>26)+t<<0)|~n))+a[11]-1120210379)<<10|i>>>22)+e<<0)^((n=((n+=(e^(i|~t))+a[2]+718787259)<<15|n>>>17)+i<<0)|~e))+a[9]-343485551)<<21|t>>>11)+n<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=n-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+n<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,i=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&i,i>>8&255,i>>16&255,i>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,n,i="",o=this.array(),r=0;r<15;)e=o[r++],t=o[r++],n=o[r++],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return e=o[r],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(165),__webpack_require__(105))},function(e,t,n){"use strict";n(9);const{GObject:i}=n(1);function o(e){this._app=e,this._collaborativeFile=null}i.inherit(o,i),o.prototype.getOrCreateCollaborativeFile=async function(){throw"Not implemented"},o.prototype.createCollaborativeFile=async function(){throw"Not implemented"},o.prototype.updateCollaborativeFile=function(){throw"Not implemented"},o.prototype.getCollaborativeFile=async function(){throw"Not implemented"},o.prototype.shareWithUser=async function(e,t){throw"Not implemented"},o.prototype.unshareWithUser=async function(e,t){throw"Not implemented"},o.prototype.setCollaborativeFileStatus=async function(e){throw"Not implemented"},e.exports=o},function(e,t,n){"use strict";var i=n(1);function o(){}o.GVDESIGN={ext:"gvdesign",mime:"application/gravit+design",name:new i.GLocaleKey("GDocument","file-type.gvdesign"),title:new i.GLocaleKey("GDocument","title.save-gvdesign"),category:"gravit",load:!0,store:!0,import_image:!1,default:!0},o.HEIC={ext:"heic",mime:"image/heic",name:new i.GLocaleKey("GDocument","file-type.png"),category:"image",load:!0,store:!1,import_image:!0},o.PNG={ext:"png",mime:"image/png",name:new i.GLocaleKey("GDocument","file-type.png"),category:"image",load:!0,store:!0,import_image:!0},o.JPG={ext:"jpg",mime:"image/jpeg",name:new i.GLocaleKey("GDocument","file-type.jpeg"),category:"image",load:!0,store:!0,import_image:!0},o.JPEG={ext:"jpeg",mime:"image/jpeg",category:"image",load:!0,import_image:!0},o.SVG={ext:"svg",mime:"image/svg+xml",name:new i.GLocaleKey("GDocument","file-type.svg"),category:"vector",load:!0,store:!0,import_image:!0},o.SVGZ={ext:"svgz",mime:"image/svg+xml",name:new i.GLocaleKey("GDocument","file-type.svgz"),category:"vector",load:!0,store:!1,import_image:!0},o.PDF={ext:"pdf",mime:"application/pdf",name:new i.GLocaleKey("GDocument","file-type.pdf"),category:"document",load:!0,store:!0,import_image:!0},o.AI={ext:"ai",mime:"application/pdf",name:new i.GLocaleKey("GDocument","file-type.ai"),category:"document",load:!0,store:!1,import_image:!0,pro:!0},o.EPS={ext:"eps",mime:"application/postscript",name:new i.GLocaleKey("GDocument","file-type.eps"),category:"document",load:!0,store:!1,import_image:!0,pro:!0},o.SKETCH={ext:"sketch",mime:"application/zip",name:new i.GLocaleKey("GDocument","file-type.sketch"),category:"document",load:!0,store:!1,import_image:!0,pro:!0},o.ZIP={ext:"zip",mime:"application/zip",load:!1,store:!1,import_image:!1},o.getFileTypesArray=function(){return[o.GVDESIGN,o.PNG,o.HEIC,o.JPG,o.JPEG,o.SVG,o.PDF,o.AI,o.EPS,o.SKETCH]},e.exports=o},,,,,function(e,t,n){"use strict";function i(){}i.PAGE_CLIP_CONTENT_ENABLED=2,i.PAGE_CLIP_CONTENT_DISABLED=1,i.PAGE_CLIP_PROPERTY_NAME="cce",i.EXPORT_PROPERTY_NAME="__export",i.MULTIPAGE_VIEW_ENABLED="mve",i.PropertiesToExcludeFromCopying=null,e.exports=i},function(e,t,n){"use strict";n(19),n(24),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9);var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=o(t);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=r?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=e[a]}i.default=e,n&&n.set(e,i);return i}(n(1358));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}const r=n(12);let a=!1,s=!1,l=null;const c={TeamsMode:{DESKTOP:{label:"Desktop",code:"desktop"},WEB:{label:"Web",code:"web"},IOS:{label:"Ios",code:"ios"},ANDROID:{label:"Android",code:"android"},OTHER:{label:"Other"}},isExecutingOnMSTeams:async()=>{const e=await c.getTeamsContext().catch(()=>!1);return!!e&&!!e.tid},getTeamsEnv:async function(){switch(l||await c.initTeams(),l.hostClientType){case c.TeamsMode.DESKTOP.code:return c.TeamsMode.DESKTOP.label;case c.TeamsMode.WEB.code:return c.TeamsMode.WEB.label;default:return c.TeamsMode.OTHER.label}},isExecutingOnChannelOrChat:async()=>!!await c.isExecutingOnMSTeams()&&(!!await c.isPrivateChat()||!!await c.isTeamsChannel()),isExecutingOnChannelOrChatSingletonPromise:()=>s,initTeams:()=>{if(l)return Promise.resolve();const e=r.msTeamsMode?15e3:0;return new Promise((t,n)=>{const o=setTimeout(()=>{n()},e);i.initialize(()=>{i.getContext(e=>{l=e,clearTimeout(o),t()})})})},getTeamsContext:async()=>(l||await c.initTeams(),l),getTeamsLocale:async()=>(l||await c.initTeams(),l.locale),isPrivateChat:async()=>!!(await c.getTeamsContext()).chatId,isTeamsChannel:async()=>!!(await c.getTeamsContext()).channelId,sendSettings:async e=>(l||await c.initTeams(),i.authentication.notifySuccess(e)),getAuthenticator:async()=>(l||await c.initTeams(),i.authentication),isExecutingOnMSTeamsSync:()=>a};c.isExecutingOnMSTeams().then(e=>{a=e}),s=c.isExecutingOnChannelOrChat();var d=c;t.default=d},function(e,t,n){"use strict";e.exports={Position:{Left_Top:0,Center:1,Right_Bottom:2}}},function(e,t,n){"use strict";var i=n(17);n(58),n(14),n(29),n(9),n(261),n(25),n(3);var o=n(1),r=n(16),a=n(56),s=i(n(1133)),l=n(12),c=n(144),d=n(18),u=n(26),p=n(399),g=n(77);const h=n(36),f=n(390);var m=l.FILE_FORMATS.map(e=>e.ext);const y=l.FILE_FORMATS.find(e=>e.default).ext;function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._fileExt=e,this._isNativeExt=!!m.includes(this._fileExt);var n=c.FileTypes.filter(t=>t.ext===e)[0];this._title=n.title||n.name,this._mime=n.mime,this._options=t,v.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GSaveAsAction","text.try-this-feature-pro-tooltip-title")),learnMore:"https://documentation.designer.io/import-export/export/#quick-exporting",upgradeToProStatsValue:"file.save-as.pdf.300",middle:!1,side:!0})}}o.GObject.inherit(v,u),v.ID="file.save-as",v.TOOLTIP_CONFIG=null,v.prototype._fileExt=null,v.prototype._isNativeExt=!1,v.prototype._title=null,v.prototype._mime=null,v.prototype._options=null,v.prototype.getId=function(){if("pdf"===this._fileExt){const e=this._options&&this._options.dpi;if(e&&72!==e)return v.ID+"."+this._fileExt+"."+e}return v.ID+"."+this._fileExt},v.prototype.getTitle=function(){if(this._isNativeExt)return gDesigner.getDefaultStorage().canSave()?o.GLocale.get(this._title):o.GLocale.get(new o.GLocaleKey("GDocument","title.download-"+this._fileExt));if("pdf"===this._fileExt){var e=this._options.dpi?this._options.dpi:72;return o.GLocale.get(new o.GLocaleKey("GSaveAsAction","text.dpi-value")).replace("%dpiValue",e).replace("%dpiString",o.GLocale.get(new o.GLocaleKey("GSaveAsAction","text.dpi")))}{const{dpi:e=72}=this._options;return o.GLocale.get(new o.GLocaleKey("GSaveAsAction","pdf"===this._fileExt?"text.save-pdf":"text.save-common")).replace("%title",o.GLocale.get(this._title)).replace("%fileExtension",this._fileExt).replace("%dpiValue",e).replace("%dpiString",o.GLocale.get(new o.GLocaleKey("GSaveAsAction","text.dpi")))}},v.prototype.getCategory=function(){return this._isNativeExt?d.CATEGORY_FILE:"pdf"===this._fileExt?d.CATEGORY_FILE_EXPORT_PDF:d.CATEGORY_FILE_EXPORT},v.prototype.getGroup=function(){return this._isNativeExt?"file":"pdf"===this._fileExt?"export/file-type/"+this._fileExt:"export/file-type"},v.prototype.isPro=function(){return"pdf"===this._fileExt&&300===this._options.dpi},v.prototype.getTooltipArea=function(){return a.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON},v.prototype.getTooltipConfig=function(e){return"file.save-as.pdf.300"===this.getId()&&e&&v.TOOLTIP_CONFIG[e]||null},v.prototype.getShortcut=function(){return this._isNativeExt?[r.GKey.Constant.SHIFT,r.GKey.Constant.META,r.GKey.Constant.OPTION,"S"]:null},v.prototype.isEnabled=function(e,t){return!!gDesigner.getApplicationManager().isFileFormatEnabledForSaveAs({ext:this._fileExt})&&(!!gDesigner.getApplicationManager().isSavingAsEnabled()&&(!!(t=t||gDesigner.getActiveDocument())&&((e=e||(t.getStorageItem()?t.getStorageItem().getStorage():gDesigner.getDefaultStorage())).canPromptSave()||e.canDownload())))},v.prototype.execute=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;const r=t||gDesigner.getActiveDocument();if(r&&r.isCommercialProductFile())return r.openPaywall(this.getId()),!1;new p(()=>{this._performSave(e,r,n,i,o)},()=>{gDesigner.stats("action_cancelled_anonymous",this.getId())})},v.prototype._performSave=async function(e,t,n,i,r){let a=r;if(t.isCloudFile()&&(this._fileExt===y&&t.getScene().setCloudSynchronization(t.getStorageItem().getId()),i.lastModifiedDate=t.isModified()?void 0:t.getScene().getLastSavedTime()),e=e||(t.getStorageItem()?t.getStorageItem().getStorage():gDesigner.getDefaultStorage()),!await this._checkWriteAccess(e))return;const l=!e.canDownload()||this._fileExt!==f.PDF.ext;if(e.canPromptSave()&&l){const o=t.getStorageItem();!a&&o&&(a=o.getName()),a||(a=t.getTitle()),a&&!a.endsWith(this._fileExt)&&(a+=".".concat(this._fileExt.toLowerCase())),e.savePrompt(a,this._getFileTypes(t,e),async e=>{m.includes((e.getExtension()||"").toLowerCase())&&t.setStorageItem(e);let o=this._fileExt!==y||!t.isCloudFile();await t.saveAnnotations(o),(i=t.updateSaveOptionsLastModifiedDate(i)).singleton=!t.isCloudFile(),i=this._updateSaveOptions(i,t,e),t.store(e,n,this._showError,i instanceof s.default?i:Object.assign({},this._options,i))},()=>{n&&n({documentStatus:g.SaveCancelled})})}else if(e.canDownload()){if(a||t.getStorageItem()&&(a=t.getStorageItem().getName()),a=a||t.getTitle()||"Design",!this._isNativeExt&&t.hasPagesWithInfiniteEmptyCanvas())return void h.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas")));(i=t.updateSaveOptionsLastModifiedDate(i)).singleton=!t.isCloudFile(),i.export=!0,e.download(a+"."+this._fileExt,e=>{e&&t.store(e,n,this._showError,Object.assign({},this._options,i,{filename:a}))})}},v.prototype._checkWriteAccess=async function(e){const t=gContainer.getDefaultStorageDestination(this._fileExt);if(t){const n=await e.getWritePermission(t),i=n.isAuthorized();return!i&&n.getStatusText()&&this._showError(n.getStatusText()),i}return!0},v.prototype._showError=function(e){e&&h.error(e,{showTitle:!1})},v.prototype._getFileTypes=function(){return[{ext:this._fileExt,mime:this._mime}]},v.prototype._updateSaveOptions=function(e){return e},v.prototype.toString=function(){return"[Object GSaveAsAction]"},e.exports=v},function(e,t,n){"use strict";var i=n(17),o=n(1),r=i(n(106)),a=i(n(769));function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};this._cb=e,this._showFormCb=t,this._run()}o.GObject.inherit(s,o.GObject),s.prototype._close=function(){this._dialog&&this._dialog.gDialog("close")},s.prototype._run=function(){if(gDesigner.isAnonymous())return new a.default(e=>{e&&!e.anonymous&&this._logged(e)}).open({anonymous:!0,signup:!0,animate:!0}),void this._showFormCb();this._cb&&this._cb()},s.prototype._logged=function(e){this._close(),this._cb&&this._cb(e)},s.prototype._build=function(){this._dialog=$("<div/>"),gDesigner.getUser().then(e=>{if(e)this._logged(e);else{this._dialog.closest(".loading").removeClass("loading");var t=$("<div/>");t.addClass("container").appendTo(this._dialog),$("<div/>").addClass("logo").appendTo(t),$("<span/>").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GLoginPanel","text.title"))).appendTo(t),$("<span/>").addClass("subtitle").text(o.GLocale.get(new o.GLocaleKey("GLoginPanel","text.subtitle"))).appendTo(t);var n=$("<div/>");n.addClass("buttons").appendTo(t);var i=(e,t)=>{var i=$("<div/>");i.on("click",t),i.addClass(e).text(o.GLocale.get(new o.GLocaleKey("GLoginPanel","text."+e))).appendTo(n)};i("login",()=>{r.default.performLogin().then(e=>{this._logged(e)})}),i("signup",()=>{r.default.performSignup().then(e=>{this._logged(e)})})}}),this._dialog.gDialog({releaseOnClose:!0,className:"g-login-panel loading"}),this._dialog.gDialog("open",!0)},e.exports=s},function(e,t,n){"use strict";n(9),n(3);var i=n(1),o=n(16),r=n(32),a=n(1132),s=n(12),l=n(56),c=n(18),d=n(26),u=n(398),p=n(401),g=n(77),h=n(106),f=n(1382),m=n(1383);const y=n(36),v=n(1384);var _=n(76),b="."+s.FILE_FORMATS.find(e=>e.default).ext;function w(){w.TOOLTIP_CONFIG={[l.TOOLTIP_AREA.TOOLBAR]:l.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSaveAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSaveAction","tooltip-description")),shortcut:w.SHORTCUT,learnMore:"https://documentation.designer.io/basics/working-with-files/save-and-open-files/#save"})}}i.GObject.inherit(w,d),w.ID="file.save",w.TITLE=new i.GLocaleKey("GSaveAction","title"),w.SHORTCUT=[o.GKey.Constant.META,"S"],w.TOOLTIP_CONFIG=null,w.prototype.getId=function(){return w.ID},w.prototype.getTitle=function(){return w.TITLE},w.prototype.getIcon=function(){return"gravit-icon-save"},w.prototype.getCategory=function(){return c.CATEGORY_FILE},w.prototype.getGroup=function(){return"file"},w.prototype.getShortcut=function(){return w.SHORTCUT},w.prototype.isShortcutGlobal=function(){return!0},w.prototype.isEnabled=function(e){return!!gDesigner.getApplicationManager().isEditingEnabled()&&(!(!(e=e||gDesigner.getActiveDocument())||!e.isModified()&&!e.isNew())&&(!e.isSynchronizing()&&(!(e.isNew()||!e.getStorageItem()||!e.getStorageItem().getStorage().canSave())||gDesigner.canExecuteAction(u.ID+b,[null,e],void 0,!0))))},w.prototype.execute=function(e,t,n){const i=e||gDesigner.getActiveDocument();if(i&&i.isCommercialProductFile())return i.openPaywall(this.getId()),!1;gContainer.getRuntime()===_.Runtime.IPad&&(n=!0),this._save(i,t,n)},w.prototype._performSave=async function(e,t){await e.isUpdateAvailable()?r.buildDialogDocumentHasUpdates.call(this,e,(function(){e.reload()}),(function(){h.performSave(e,t)})):h.performSave(e,t)},w.prototype._save=async function(e,t,n){if(gDesigner.getDefaultStorage().canSave()){if(!e.getScene().hasLinkedFiles())return this._saveDesktop(e,t,n);new m(()=>{this._saveDesktop(e,t,n)}).open()}else{if(e.isNew())return this._saveToCloud(e,t);if(e.isCloudFile()&&e.getId()){if(!await e.canSaveToCloud())return this._saveToCloud(e,t);await this._performSave(e,t)}else if(e.isExternalFile())e.storeToCloud(e.getScene(),t);else{if(!e.hasCloudReference())return this._saveToCloud(e,t);if(!e.isCloudSyncOn())return gDesigner.executeAction(u.ID+b,[null,e,t],void 0,!0);if(!await e.canSaveToCloud())return this._saveToCloud(e,t);e.chooseLatestDocument(e.getScene(),n=>{n!==e.getScene()?(e.setScene(n),t&&t()):e.storeToCloud(e.getScene(),t)},()=>this._saveToCloud(e,t),(e,t)=>t.lastModifiedDate().getTime()>e.lastModifiedDate().getTime(),()=>{t&&t()})}}},w.prototype._saveDesktop=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNew()){if(n)return this._saveToCloud(e,t);new f(async function(n){if(n===f.file()){if(await p.prototype._hasUnsupported.call(this,e))return;return gDesigner.executeAction(u.ID+b,[null,e,t],void 0,!0)}if(n===f.cloud())return this._saveToCloud(e,t)}.bind(this),{closeCallback:e=>e&&t&&t({documentStatus:g.SaveCancelled})}).open()}else if(e.isCloudFile()){if(!await e.canSaveToCloud())return this._saveToCloud(e,t);await this._performSave(e,t)}else if(e.hasCloudReference())if(e.isCloudSyncOn()){if(!await e.canSaveToCloud())return this._saveToCloud(e,t);e.chooseLatestDocument(e.getScene(),n=>{n!==e.getScene()?(e.setScene(n),e.store(e.getStorageItem(),t,null,{lastModifiedDate:n.getLastSavedTime()})):e.store(e.getStorageItem(),()=>{e.storeToCloud(e.getScene(),t)})},n=>{n&&404===n.status?e.store(e.getStorageItem(),t):y.alert(s.gApi.formatError(n))},(e,t)=>t.lastModifiedDate().getTime()>e.lastModifiedDate().getTime())}else e.isExternalFile()?e.storeToCloud(e.getScene(),t):e.store(e.getStorageItem(),t);else if(e.isExternalFile())e.storeToCloud(e.getScene(),t);else{const n=e.getStorageItem();let i={};n instanceof v.Item&&(i=(0,a.updateSaveOptions)(i,e,n)),e.store(n,t,null,i)}},w.prototype._saveToCloud=function(e,t){return gDesigner.executeAction(p.ID+".save-as",[e,n=>{n===g.Loaded?gDesigner.removeDocument(e,null,!0):n===g.Saved?t&&t({documentStatus:g.Saved}):n===g.SaveCancelled&&t&&t({documentStatus:g.SaveCancelled})}],void 0,!0)},w.prototype.getTooltipConfig=function(e){return e&&w.TOOLTIP_CONFIG[e]||null},w.prototype.toString=function(){return"[Object GSaveAction]"},e.exports=w},function(e,t,n){"use strict";n(9),n(3);var i=n(1),o=n(16),r=n(18),a=n(26),s=n(752),l=n(77),c=n(202),d=n(106),u=n(399);const p=n(231);function g(e){this._type=e,this._title=new i.GLocaleKey("GGravitCloudAction","title."+e)}g.Actions={New:"new",Save:"save",SaveAs:"save-as",Open:"open"},i.GObject.inherit(g,a),g.ID="gravit-cloud",g.prototype._type=null,g.prototype._title=null,g.prototype.getId=function(){return g.getIdForAction(this._type)},g.getIdForAction=function(e){return g.ID+"."+e},g.prototype.getTitle=function(){return this._title},g.prototype.getCategory=function(){return r.CATEGORY_FILE},g.prototype.getGroup=function(){return this._type===g.Actions.Open?"file-open":"file"},g.prototype.getGroupIcon=function(){return s["gravit-cloud"]},g.prototype.getShortcut=function(){return this._type==g.Actions.Open?[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"O"]:this._type==g.Actions.SaveAs?[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"S"]:null},g.prototype.isEnabled=function(){if(!gDesigner.getApplicationManager().isEditingEnabled()&&this._type===g.Actions.Save)return!1;if(!gDesigner.getApplicationManager().isOpenFromCloudEnabled()&&this._type===g.Actions.Open)return!1;if(!gDesigner.getApplicationManager().isSavingAsEnabled()&&this._type===g.Actions.SaveAs)return!1;return!(!gDesigner.getActiveDocument()&&this._type!==g.Actions.Open)&&!!d.isOnline()},g.prototype.execute=function(e,t,n){const i=()=>new u(()=>{this._executeAction(e,t,n)},()=>{gDesigner.stats("action-cancelled_export",this._type)});gDesigner.isOffline()?p.openUnavailableFeature(i):i()},g.prototype._executeAction=function(e,t,n){var i=this;if("open"===this._type){let e={closable:!0,showCloudOptions:!0,openFromCloud:!0};gDesigner.openNewDocumentDialog(e)}else if("save"===this._type){var o=gDesigner.getActiveDocument();if(o.isCommercialProductFile())return void o.openPaywall(this.getId());var r=o.getStorageItem();r&&r instanceof c.Item?d.performSave(o,()=>{t&&t(l.Saved)},()=>{t&&t(l.SaveFailed)}):i._saveAs(!1,e,t)}else if("new"===this._type){let n={closable:!0,cb:function(){i._saveAs(!0,e,t)}};gDesigner.openNewDocumentDialog(n)}else"save-as"===this._type&&i._saveAs(!1,e,t,n)},g.prototype._hasUnsupported=async function(){return!1},g.prototype._saveAs=async function(e,t,n,i){var o=t||gDesigner.getActiveDocument();if(o.isCommercialProductFile())o.openPaywall(this.getId());else{var r=o.getTitle();!o.isDocumentFromTemplate()&&await this._hasUnsupported(o)||gDesigner.openCloudSaveDialog(o,(function(){e&&gDesigner.getWindows().removeWindow(o.getActiveWindow()),n&&n(l.SaveCancelled)}),r,n,i)}},g.prototype.getIcon=function(){return gDesigner.getApplicationManager().isOpenFromCloudEnabled()&&this._type===g.Actions.Open?gDesigner.isTouchEnabled()?"gravit-icon-touch-file-open-cloud":"":gDesigner.getApplicationManager().isSavingAsEnabled()&&this._type===g.Actions.SaveAs?gDesigner.isTouchEnabled()?"gravit-icon-touch-file-save-as-cloud":"":void 0},g.prototype.toString=function(){return"[Object GGravitCloudAction]"},e.exports=g},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(26);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GFitAllAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GFitAllAction","tooltip-description")),shortcut:l.SHORTCUT})}}i.GObject.inherit(l,s),l.ID="view.zoom.fit.all",l.TITLE=new i.GLocaleKey("GFitAllAction","title"),l.SHORTCUT=[o.GKey.Constant.OPTION,o.GKey.Constant.META,"0"],l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_VIEW},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-fit-all":null},l.prototype.getGroup=function(){return"zoom"},l.prototype.getShortcut=function(){return l.SHORTCUT},l.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument(),t=e&&e.getScene()&&e.getScene().getPaintBBox()||null;return t&&!t.isEmpty()},l.prototype.execute=function(){var e,t=gDesigner.getActiveDocument(),n=t.getScene(),o=t.getActiveWindow().getView().getViewConfiguration().multiPageView;if(n.isFixedSized()&&!o){var r=n.getActivePage();e=new i.GRect(0,0,r.getProperty("w"),r.getProperty("h"))}else e=n.getPaintBBox(o);e&&!e.isEmpty()&&t.getActiveWindow().getView().zoomAll(e,!1)},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GFitAllAction]"},e.exports=l},function(e,t,n){"use strict";e.exports={Crop:1,Canvas:2,PagePanel:3,LayerPanel:4,FillPropertyPanel:5,BorderPropertyPanel:6,EffectPropertyPanel:7}},function(e,t,n){"use strict";n(3),n(45),n(9);var i=n(1),o=n(1578);function r(){}function a(e,t){this.id=e,this.expanded=t}function s(e,t,n,i,a,c,d,u,p,g,h,f,m,y,v,_,b,w,C,E,S,G,A){this._root=new r,this._root.expanded=!0,this._root.parent=this,this._rootIndentation=E||15,this._indentation=S||15,this._bottomPadding=G||0,o.call(this,e,t,0,0),this._container.classList.add("g-virtual-tree"),this._rowStyle=n||s.DEFAULT_ROW_STYLE,this._freeHeight=isNaN(d)?s.DEFAULT_FREEZONE_HEIGHT:d,this._insertIntoStyle=u||s.DEFAULT_INSERTINTO_STYLE,this._upSeparatorSpan1Style=v||s.DEFAULT_UP_SEPARATOR_SPAN1_STYLE,this._downSeparatorSpan1Style=b||s.DEFAULT_DOWN_SEPARATOR_SPAN1_STYLE,this._initComputedVals(),a&&(this._expandStyle=a),i&&(this._expandRenderer=i),c&&(this._separatorRenderer=c),_&&(this._upSeparatorSpan2Style=_),w&&(this._downSeparatorSpan2Style=w),p&&(this._dropAllowedCallback=p),g&&(this._dropCallback=g),h&&f&&(this._isDuplicateEffectCallback=h,this._duplicateCallback=f),m&&(this._clickCallback=m),y&&(this._expandCallback=y),A&&(this._renderFinishCallback=A),this._putLastChildWhenInside=!!C,this._aScroll=new l(this._container,200,10,null,7),this._drag=this._drag.bind(this)}function l(e,t,n,i,o){this._elem=e,this._scrollDelay=t||30,this._step=n||1,this._axisFlag=i||l.SCROLL_AXIS_FLAG.Y|l.SCROLL_AXIS_FLAG.X,this._scAreaWidth=o||5,this._fixupHandler("onmouseout",this.offScrolls.bind(this)),this._fixupHandler("ondragleave",this.offScrolls.bind(this))}r._Change={ExpandedSet:1,ExpandedRemoved:2},r.prototype.parent=null,r.prototype.previous=null,r.prototype.next=null,r.prototype.firstChild=null,r.prototype.lastChild=null,r.prototype.expanded=!1,r.prototype.dragging=!1,r.prototype.row=null,r.prototype.acceptChildren=function(e,t,n,i){var o,r=!i;if(!t||this.expanded)if(n)for(var a=this.lastChild;null!=a;a=a.previous){if(!1===(o=a.accept(e,t,n,i))&&!i)return!1;!0===o&&i&&(r=!0)}else for(a=this.firstChild;null!=a;a=a.next){if(!1===(o=a.accept(e,t,n,i))&&!i)return!1;!0===o&&i&&(r=!0)}return r},r.prototype.accept=function(e,t,n,i){return!1!==e.call(null,this)&&this.acceptChildren(e,t,n,i)},r.prototype.getNestLevel=function(){for(var e=0,t=this.parent;null!=t&&t instanceof r;t=t.parent)++e;return e},r.prototype.isVisible=function(){for(var e=this.parent;e instanceof r;){if(!e.expanded)return!1;e=e.parent}return!0},r.prototype.handleChange=function(e,t){e!=r._Change.ExpandedSet&&e!=r._Change.ExpandedRemoved||this.parent&&this.parent.handleChange(e,t)},r.prototype.handleExpand=function(e){e.target.id===s.COLLAPSE_ID&&this.expanded?(this.expanded=!1,this.handleChange(r._Change.ExpandedSet,this)):e.target.id!==s.EXPAND_ID||this.expanded||(this.expanded=!0,this.handleChange(r._Change.ExpandedRemoved,this))},r.prototype.getNodeCount=function(){var e=0;return this.accept((function(t){return++e,!0}),!1),e},r.prototype.getBBox=function(){if(this.row){const e=this.row.getBoundingClientRect();return new i.GRect(e.x,e.y,e.width,e.height)}return new i.GRect(0,0,0,0)},r.prototype.getNextFocusableNode=function(){return this.expanded?this.firstChild:this.next||this.parent&&this.parent.next||(this.parent.row?this.parent.parent.firstChild:this.parent.firstChild)},r.prototype.getPreviousFocusableNode=function(){return this.previous&&this.previous.expanded?this.previous.lastChild:!this.previous&&this.parent.expanded&&this.parent.row?this.parent:this.previous||(this.parent.lastChild.expanded?this.parent.lastChild.lastChild:this.parent.lastChild)},r.prototype.setDragging=function(e){this.accept(t=>{t.dragging=e})},r.prototype.toString=function(){return"[GVirtualTreeNode]"},a.prototype=Object.create(r.prototype),a.prototype.id=null,a.prototype.expanded=void 0,s.DEFAULT_ROW_STYLE="vrow",s.DEFAULT_INSERTINTO_STYLE="insertInto",s.DEFAULT_LINE_HEIGHT=30,s.DEFAULT_FREEZONE_HEIGHT=7,s.DEFAULT_UP_SEPARATOR_SPAN1_STYLE="up-separator-span1",s.DEFAULT_DOWN_SEPARATOR_SPAN1_STYLE="down-separator-span1",s.COLLAPSE_ID="clpsId",s.EXPAND_ID="xpndId",s.ROW_ID="rowId",s.LOWER_SEP_ID="lsepId",s.UPPER_SEP_ID="usepId",s.prototype=Object.create(o.prototype),s.IdxIterator=function(e,t,n,i){this._vtree=e,this._firstIdx=t||1,this._lastIdx=i?n&&n<=this._vtree._rowCount?n:this._vtree._rowCount:n&&n<=this._vtree._nodeCount?n:this._vtree._nodeCount,this._visibleOnly=!!i},s.IdxIterator.prototype._vtree=null,s.IdxIterator.prototype._firstIdx=0,s.IdxIterator.prototype._lastIdx=0,s.IdxIterator.prototype._visibleOnly=!1,s.IdxIterator.prototype._curNode=null,s.IdxIterator.prototype._curIdx=0,s.IdxIterator.prototype.getFirstNode=function(){return this._firstIdx<=this._lastIdx?(this._curIdx=this._firstIdx,this._curNode=this._vtree._getNodeByIdx(this._curIdx,this._visibleOnly)):(this._curIdx=this._lastIdx+1,this._curNode=null),this._curNode},s.IdxIterator.prototype.getNext=function(){return this._curIdx?(this._curIdx=this._curIdx<=this._lastIdx?this._curIdx+1:this._curIdx,this._curIdx<=this._lastIdx&&this._curNode?this._curNode=this._vtree.getNextNode(this._curNode,this._visibleOnly):this._curNode=null,this._curNode):this.getFirstNode()},s.prototype._root=null,s.prototype._nodeCount=0,s.prototype._rowStyle=null,s.prototype._rootIndentation=15,s.prototype._indentation=21,s.prototype._bottomPadding=0,s.prototype._containerWidth=0,s.prototype._expandedWidth=0,s.prototype._expandStyle=null,s.prototype._dragNodes=null,s.prototype._freeHeight=0,s.prototype._upSeparatorStyle=null,s.prototype._downSeparatorStyle=null,s.prototype._insertIntoStyle=null,s.prototype._downSepHeight=0,s.prototype._dropAllowedCallback=null,s.prototype._dropCallback=null,s.prototype._renderFinishCallback=null,s.prototype._dragStartPt=null,s.prototype._dragLastPt=null,s.prototype._dragBBox=null,s.prototype._dragNode=null,s.prototype._dragAndDropHelper=null,s.prototype._animatedDragEnabled=!1,s.prototype._dragByMouse=!1,s.prototype._isDuplicateEffectCallback=null,s.prototype._duplicateCallback=null,s.prototype._clickCallback=null,s.prototype._expandCallback=null,s.prototype._putLastChildWhenInside=!1,s.prototype._invalidationRequestTimerId=null,s.prototype._focusTimerId=null,s.prototype._updateMarksTimerId=null,s.prototype._aScroll=null,s.prototype._freeZone=null,s.prototype._lastVisitedDroppable=null,s.prototype.endUpdate=function(e){0==--this._updateCounter&&this.requestInvalidation(e)},s.prototype.refresh=function(){this._initComputedVals(),this.requestInvalidation(!0)},s.prototype.expandAndFocus=function(e,t){for(var n=0,i=e;i.parent&&i.parent!==this._root;)(i=i.parent).expanded||(i.expanded=!0,this._expandCallback&&this._expandCallback(i));if(this._focusTimerId)return!1;this._root.acceptChildren((function(t){return t!==e&&(n++,!0)}),!0),t||this.invalidate();var o=n*this._rowHeight,r=this._container.scrollTop;return 0===this._visibleRows&&this._updateVisibleRows(),(r>o||o-r>=this._rowHeight*this._visibleRows)&&(this._focusTimerId=setTimeout(function(){this._container.scrollTop=o,this._focusTimerId=null}.bind(this,50))),!0},s.prototype.requestInvalidation=function(e){e?this._updateCounter||(this.invalidate(),this._renderFinishCallback&&this._renderFinishCallback()):this._updateCounter||null===this._invalidationRequestTimerId&&(this._invalidationRequestTimerId=setTimeout(function(){this.requestInvalidation(!0),this._invalidationRequestTimerId=null}.bind(this),25))},s.prototype.handleChange=function(e,t){e!=r._Change.ExpandedSet&&e!=r._Change.ExpandedRemoved||this.requestInvalidation(!0)},s.prototype.invalidate=function(){this._updateRowCount(),this._updateVisibleRows(),this._updateScroller(),this._requestViewportClean(),this._render(),this._lastRenderScrollTop=this._container.scrollTop},s.prototype.getNextNode=function(e,t){var n=e,i=null;if(t)for(;n.parent instanceof r&&!n.parent.expanded;)n=n.parent;if(!n.firstChild||t&&!n.expanded||(i=n.firstChild),!i&&n.next&&(i=n.next),!i)for(var o=n.parent;!i&&o instanceof r&&o!==this._root;o=o.parent)o.next&&(i=o.next);return i},s.prototype.appendNode=function(e,t){return this._insertNodeBefore(e||this._root,null,t)},s.prototype.prependNode=function(e,t){return this._insertNodeBefore(e||this._root,e?e.firstChild:this._root.firstChild,t)},s.prototype.insertNodeBefore=function(e,t){return this._insertNodeBefore(e.parent,e,t)},s.prototype.insertNodeAfter=function(e,t){return this._insertNodeBefore(e.parent,e.next?e.next:null,t)},s.prototype.removeNode=function(e){e.parent&&(e.parent.firstChild==e&&(e.parent.firstChild=e.next),e.parent.lastChild==e&&(e.parent.lastChild=e.previous)),null!=e.previous&&(e.previous.next=e.next),null!=e.next&&(e.next.previous=e.previous);var t=e.parent;t&&(e.parent=null,e.previous=null,e.next=null,e.firstChild?this._nodeCount-=e.getNodeCount():--this._nodeCount,e.expanded&&e.firstChild?this._updateRowCount():t.expanded&&--this._rowCount,t.expanded&&!t.firstChild&&t!==this._root&&t.expanded&&(t.handleChange(r._Change.ExpandedRemoved,t),t.expanded=!1,this._expandCallback&&this._expandCallback(t)),t.expanded&&this.requestInvalidation())},s.prototype.clean=function(){this._nodeCount=0,this._rowCount=0,this._root=new r,this._root.expanded=!0,this._root.parent=this,this._dragNodes=null,this.requestInvalidation(!0)},s.prototype.acceptChildren=function(e,t,n,i){return this._root.acceptChildren(e,t,n,i)},s.prototype.getLastVisitedDroppable=function(){return this._lastVisitedDroppable},s.prototype._updateScroller=function(){this._scroller.style.height=(this._rowCount*this._rowHeight+this._freeHeight).toString()+"px",this._scroller.scrollHeight<this._container.clientHeight?this._scroller.style.borderRight="none":this._scroller.style.borderRight=""},s.prototype._isDragging=function(){return!!this._dragNode},s.prototype._renderViewport=function(e){const t=!this.isAnimatedDragEnabled()||!this._isDragging();if(t){this._freeZone=null,this._lastVisitedDroppable=null;for(var n=1,i=this._container.childNodes.length;n<i;n++)this._container.childNodes[n].style.display="none",this._container.childNodes[n].setAttribute("data-clean","")}if(this._rowCount&&this._renderer&&this._rowHeight){for(var o=Math.min(this._rowCount,e+this._cachedRows),r=document.createDocumentFragment(),a=new s.IdxIterator(this,e+1,o,!0),l=e,c=a.getFirstNode();null!=c;c=a.getNext(),++l){const e=c.row;var d=!t&&e?e:document.createElement("div");d.id=s.ROW_ID,d.classList.add(this._rowStyle),d.style.top=(l*this._rowHeight).toString()+"px";var u=this._rootIndentation+this._indentation*(c.getNestLevel()-1);if(d.style.paddingLeft=u.toString()+"px",c.expanded||c.firstChild){var p=document.createElement("span");c.expanded?p.id=s.COLLAPSE_ID:p.id=s.EXPAND_ID,this._expandStyle&&p.classList.add(this._expandStyle),this._expandRenderer(p),!t&&e||d.appendChild(p)}this.isAnimatedDragEnabled()?(d.classList.add("g-drag-vrow"),d.classList.toggle("g-drag-mouse",!!this._dragByMouse),d.classList.toggle("g-dragging",!!c.dragging)):(d.classList.remove("g-drag-vrow"),d.classList.remove("g-drag-mouse"),d.classList.remove("g-dragging")),t||!e?(d.addEventListener("click",this._nodeClick.bind(this,c)),d.setAttribute("draggable",!0),d.addEventListener("draginit",this._nodeDragInit.bind(this,c)),d.addEventListener("dragstart",this._nodeDragStart.bind(this,c)),d.addEventListener("dragend",this._nodeDragEnd.bind(this,c)),this.isAnimatedDragEnabled()||(d.addEventListener("dragenter",this._nodeDragEnter.bind(this,c)),d.addEventListener("dragover",this._nodeDragOver.bind(this,c)),d.addEventListener("dragleave",this._nodeDragLeave.bind(this,c)),d.addEventListener("dragexit",this._nodeDragExit.bind(this,c)),d.addEventListener("drop",this._nodeDrop.bind(this,c))),d._specCounter=0,d._hasStyle=!1,c.row=d,this._renderer(c,d),r.appendChild(d)):t||(d.hasAttribute("data-clean")&&(d.removeAttribute("data-clean"),d.style.display=""),d.parentNode||r.appendChild(d))}if(o==this._rowCount&&!this.isAnimatedDragEnabled()){var g=document.createElement("div");g.style.position="absolute",g.style.height=this._freeHeight.toString()+"px",g.style.top=(o*this._rowHeight).toString()+"px",g.addEventListener("dragenter",this._nodeDragEnter.bind(this,this._root)),g.addEventListener("dragover",this._nodeDragOver.bind(this,this._root)),g.addEventListener("dragleave",this._nodeDragLeave.bind(this,this._root)),g.addEventListener("drop",this._nodeDrop.bind(this,this._root)),r.appendChild(g),this._freeZone=g}this._container.appendChild(r),this._expandedWidth=this._container.scrollWidth;for(n=1,i=this._container.childNodes.length;n<i;n++)if("none"!==this._container.childNodes[n].style.display){getComputedStyle(this._container.childNodes[n]);this._container.childNodes[n].style.width=this._expandedWidth+"px"}}},s.prototype._initComputedVals=function(){this._containerWidth=parseInt(this._container.clientWidth);var e=document.createElement("div");e.classList.add(this._rowStyle),e.style.visibility="hidden",this._container.appendChild(e);var t=getComputedStyle(e),n=parseInt(t.height);this._rowHeight=(n||20)+this._bottomPadding;var i=document.createElement("div");i.classList.add(this._downSeparatorStyle),i.style.display="none",e.appendChild(i),this._downSepHeight=parseInt(getComputedStyle(i).height),this._expandedWidth=this._container.scrollWidth,this._container.removeChild(e)},s.prototype._insertNodeBefore=function(e,t,n){return n.parent=e,null!=t?(n.next=t,n.previous=t.previous,t.previous=n,null==n.previous?e.firstChild=n:n.previous.next=n):(null!=e.lastChild&&(n.previous=e.lastChild,e.lastChild.next=n,e.lastChild=n),n.next=null),null==e.firstChild&&(e.firstChild=n,n.previous=null,n.next=null),null==n.next&&(e.lastChild=n),n.firstChild?this._nodeCount+=n.getNodeCount():++this._nodeCount,n.expanded&&n.firstChild?this._updateRowCount():e.expanded&&++this._rowCount,(e.expanded||!e.expanded&&e.firstChild==e.lastChild)&&this.requestInvalidation(),this},s.prototype._expandRenderer=function(e){e.id===s.COLLAPSE_ID?e.innerHTML="&#9660;":e.id===s.EXPAND_ID&&(e.innerHTML="&#9658;")},s.prototype._separatorRenderer=function(e,t){var n=this._expandedWidth||this._container.scrollWidth;e.style.width=n.toString()+"px",e.style.height=this._freeHeight.toString()+"px",e.style.position="absolute",e.style.pointerEvents="none";var i=document.createElement("span"),o=null;e.id==s.UPPER_SEP_ID?(i.classList.add(this._upSeparatorSpan1Style),o=this._upSeparatorSpan2Style?this._upSeparatorSpan2Style:null,e.style.top="0px"):(i.classList.add(this._downSeparatorSpan1Style),o=this._downSeparatorSpan2Style?this._downSeparatorSpan2Style:null,e.style.top=(this._rowHeight-this._freeHeight).toString()+"px"),e.appendChild(i);getComputedStyle(i);if(o){var r=document.createElement("span");r.classList.add(o),e.appendChild(r)}},s.prototype._updateRowCount=function(){var e=0;this._root.acceptChildren((function(t){return++e,!0}),!0),this._rowCount=e},s.prototype._getNodeByIdx=function(e,t){var n=0,i=null;return this._root.acceptChildren((function(t){return++n!=e||(i=t,!1)}),t),i},s.prototype._nodeHasSomeParent=function(e,t){for(var n=!1,i=e.parent;i&&i instanceof r&&!n;i=i.parent)n=i===t;return n},s.prototype._nodeClick=function(e,t){!e.expanded&&!e.firstChild||t.target.id!==s.COLLAPSE_ID&&t.target.id!==s.EXPAND_ID?this._clickCallback&&(t.stopPropagation(),this._clickCallback(e)):(t.stopPropagation(),e.handleExpand(t),this._expandCallback&&this._expandCallback(e))},s.prototype.setDragNodes=function(e){e&&e.length&&(this._dragNodes=e.slice())},s.prototype.setAnimatedDragEnabled=function(e){this._animatedDragEnabled!==e&&(this._animatedDragEnabled=e,this.requestInvalidation(!0))},s.prototype.isAnimatedDragEnabled=function(){return this._animatedDragEnabled},s.prototype._onScroll=function(e){this.isAnimatedDragEnabled()&&this._isDragging()?e.preventDefault():o.prototype._onScroll.call(this,e)},s.prototype._nodeDragInit=function(e,t){this.isAnimatedDragEnabled()&&(this._dragNode=e,this._dragBBox=e.getBBox(),this._dragStartPt=new i.GPoint(t.clientX,t.clientY),this._dragOffset=this._dragStartPt.subtract(this._dragBBox.getSide(i.GRect.Side.TOP_LEFT)),this._dragAndDropHelper=new s._DragAndDropHelper(this))},s.prototype._nodeDragStart=function(e,t){this._dragNodes||(this._dragNodes=[e]),t.dataTransfer.setData("text/plain","some_dummy_data"),t.target.classList.add("g-drag"),this.isAnimatedDragEnabled()?(this._dragByMouse=!!t.isTrusted,this._dragNode||this._nodeDragInit(e,t),document.addEventListener("drag",this._drag,!0),e.setDragging(!0),this.requestInvalidation(!0)):this._aScroll.enableAScroll()},s.prototype._moveDown=function(e,t){e!==this._dragNode&&this._dragAndDropHelper&&(Math.abs(t.getY())>this._freeHeight?this._canDropInside(e)&&this._dragAndDropHelper.setDroppableNodeInside(e):this._canDropLower(e)&&this._dragAndDropHelper.setDroppableNodeLower(e))},s.prototype._moveUp=function(e,t){e!==this._dragNode&&this._dragAndDropHelper&&(t.getY()>this._freeHeight?this._canDropInside(e)&&this._dragAndDropHelper.setDroppableNodeInside(e):this._canDropUpper(e)&&this._dragAndDropHelper.setDroppableNodeUpper(e))},s.prototype._canDropUpper=function(e){const t=this._dragNode.row===this._freeZone;return this._dropHereAllowed(e)&&this._dropUpperAllowed(e,0,null,t)},s.prototype._canDropLower=function(e){return this._dropHereAllowed(e)&&this._dropLowerAllowed(e,this._rowHeight)},s.prototype._canDropInside=function(e){return this._dropHereAllowed(e)&&e!==this._root&&this._dropInsideAllowed(e)},s.prototype._getOffset=function(e,t){const n=e.getBBox().getSide(i.GRect.Side.TOP_LEFT);return t.getSide(i.GRect.Side.TOP_LEFT).subtract(n)},s.prototype._drag=function(e){if(!this._dragAndDropHelper)return;const t=new i.GPoint(e.clientX,e.clientY),n=t.subtract(this._dragLastPt||this._dragStartPt),o=parseInt(n.getY());if(0===o)return;this._dragLastPt=new i.GPoint(e.clientX,e.clientY);const r=t.subtract(this._dragOffset),a=new i.GRect(r.getX(),r.getY(),this._dragBBox.getWidth(),this._dragBBox.getHeight()),s=[];this._root.acceptChildren(e=>{if(this._dragNode!==e)if(e.getBBox().intersectsRect(a))s.push(e);else if(s.length>0)return!1},!0),this._dragAndDropHelper.setDroppableNodeInside(null);const l=o>0;if(1===s.length){const e=s[0],t=this._getOffset(e,a);l?this._moveDown(e,t):this._moveUp(e,t)}else if(2===s.length)if(l){const e=s[1],t=this._getOffset(e,a);this._moveDown(e,t)}else{const e=s[0],t=this._getOffset(e,a);this._moveUp(e,t)}},s.prototype._nodeDragEnd=function(e,t){document.removeEventListener("drag",this._drag,!0),gDesigner.setItemDraggingState(!1),$(t.target).closest(".g-drag").removeClass("g-drag"),this.isAnimatedDragEnabled()&&(e.setDragging(!1),this._dragAndDropHelper.drop(),this._dragNode=null,this._dragAndDropHelper=null,this.expandAndFocus(e,!0),this.requestInvalidation(!0))},s.prototype._nodeDragEnter=function(e,t){return t.preventDefault(),t.stopPropagation(),gDesigner.setItemDraggingState(!0),this._updateMarksTimerId&&clearTimeout(this._updateMarksTimerId),gDesigner.isTouchEnabled()?this._updateMarks(e,t.currentTarget,t.layerY,!0):this._updateMarksTimerId=setTimeout(function(e,t,n){this._updateMarks(e,t,n,!0)}.bind(this,e,t.currentTarget,t.layerY),10),this._lastVisitedDroppable=t.currentTarget,!1},s.prototype._nodeDragOver=function(e,t){return t.preventDefault(),t.stopPropagation(),this._updateMarksTimerId&&clearTimeout(this._updateMarksTimerId),gDesigner.isTouchEnabled()?this._updateMarks(e,t.currentTarget,t.layerY,!1):this._updateMarksTimerId=setTimeout(function(e,t,n){this._updateMarks(e,t,n,!1)}.bind(this,e,t.currentTarget,t.layerY),10),this._aScroll.takeOnOffAction(t),!1},s.prototype._nodeDragExit=function(e,t){$(this._container).find(".g-drag").removeClass("g-no-drop")},s.prototype._nodeDragLeave=function(e,t){return t.preventDefault(),t.stopPropagation(),t.currentTarget._hasStyle&&(!t.currentTarget._specCounter||t.currentTarget._specCounter<=1?(t.currentTarget._specCounter=0,t.currentTarget.classList.remove(this._insertIntoStyle),this._rowRemoveSep(t.currentTarget,s.LOWER_SEP_ID),this._rowRemoveSep(t.currentTarget,s.UPPER_SEP_ID),this._aScroll.takeOnOffAction(t)):--t.currentTarget._specCounter),!1},s.prototype._nodeDrop=function(e,t){t.preventDefault(),t.stopPropagation();var n=this._lastVisitedDroppable?this._lastVisitedDroppable:t.currentTarget,i=t.layerY;if(n._specCounter=0,this._dropHereAllowed(e)){n.classList.remove(this._insertIntoStyle),this._rowRemoveSep(n,s.LOWER_SEP_ID),this._rowRemoveSep(n,s.UPPER_SEP_ID),n._hasStyle=!1;var o=[],r=n===this._freeZone;if(this._dropUpperAllowed(e,i,o,r))if(o.length||(o=this._dragNodes),this._isDuplicateEffectCallback&&this._isDuplicateEffectCallback(t))e!==this._root?this._duplicateCallback(e.parent,e,e.previous?e.previous:null,o):this._duplicateCallback(this._root,null,r?e.lastChild:null,o);else{this.beginUpdate();for(var a=0;a<o.length;++a)this.removeNode(o[a]);if(e!==this._root){this._dropCallback&&this._dropCallback(e.parent,e,e.previous?e.previous:null,o);for(a=0;a<o.length;++a)this.insertNodeBefore(e,o[a])}else{this._dropCallback&&this._dropCallback(this._root,null,r?e.lastChild:null,o);for(a=0;a<o.length;++a)this.appendNode(e,o[a])}this._dragNodes=null,this.endUpdate()}else if(this._dropLowerAllowed(e,i,o))if(o.length||(o=this._dragNodes),this._isDuplicateEffectCallback&&this._isDuplicateEffectCallback(t))this._duplicateCallback(e.parent,e.next?e.next:null,e,o);else{this.beginUpdate();for(a=0;a<o.length;++a)this.removeNode(o[a]);this._dropCallback&&this._dropCallback(e.parent,e.next?e.next:null,e,o);for(a=o.length;a>0;--a)this.insertNodeAfter(e,o[a-1]);this._dragNodes=null,this.endUpdate()}else if(this._dropInsideAllowed(e,o,r))if(o.length||(o=this._dragNodes),this._isDuplicateEffectCallback&&this._isDuplicateEffectCallback(t))this._duplicateCallback(e,null,null,o);else{this.beginUpdate();for(a=0;a<o.length;++a)this.removeNode(o[a]);if(this._dropCallback&&this._dropCallback(e,null,r?e.lastChild:null,o),this._putLastChildWhenInside||r)for(a=0;a<o.length;++a)this.appendNode(e,o[a]);else for(a=o.length;a>0;--a)this.prependNode(e,o[a-1]);this._dragNodes=null,this.endUpdate()}}return this._dragNodes=null,this._aScroll.disableAScroll(),!1},s.prototype._dropHereAllowed=function(e){for(var t=this._dragNodes&&this._dragNodes.length,n=0;t&&n<this._dragNodes.length;++n){var i=this._dragNodes[n];t=i!==e&&!this._nodeHasSomeParent(e,i)}return t},s.prototype._dropUpperAllowed=function(e,t,n,i){var o=t<=this._freeHeight&&(this._dragNodes.length>1||e!==this._dragNodes[0].next);return o&&this._dropAllowedCallback&&(o=e!==this._root&&this._dropAllowedCallback(e.parent,e,e.previous?e.previous:null,this._dragNodes,n)||e===this._root&&this._dropInsideAllowed(e,n,i)),o},s.prototype._dropLowerAllowed=function(e,t,n){var i=t>=this._rowHeight-this._freeHeight&&!e.expanded&&e!==this._root&&(this._dragNodes.length>1||this._dragNodes[0]!==e.next);return i&&this._dropAllowedCallback&&(i=this._dropAllowedCallback(e.parent,e.next?e.next:null,e,this._dragNodes,n)),i},s.prototype._dropInsideAllowed=function(e,t,n){var i=n||this._putLastChildWhenInside,o=this._dragNodes.length>1||!(this._dragNodes[0].parent===e&&(i&&e.lastChild===this._dragNodes[0]||!i&&e.firstChild===this._dragNodes[0]));return o&&this._dropAllowedCallback&&(o=this._dropAllowedCallback(e,i?null:e.firstChild,i?e.lastChild:null,this._dragNodes,t)),o},s.prototype._drawUpperSeparator=function(e,t){var n=e===this._root?0:e.getNestLevel()-1;this._rowAddSep(t,s.UPPER_SEP_ID,n)},s.prototype._drawLowerSeparator=function(e,t){var n=e.getNestLevel()-1;this._rowAddSep(t,s.LOWER_SEP_ID,n)},s.prototype._updateMarks=function(e,t,n,i){let o=!0;if(this._dropHereAllowed(e)){var r=t===this._freeZone;this._dropUpperAllowed(e,n,null,r)?(o=!1,this._rowHasSep(t,s.UPPER_SEP_ID)||(this._rowRemoveSep(t,s.LOWER_SEP_ID),t._specCounter=0,t.classList.remove(this._insertIntoStyle),this._drawUpperSeparator(e,t))):this._dropLowerAllowed(e,n)?(o=!1,this._rowHasSep(t,s.LOWER_SEP_ID)||(this._rowRemoveSep(t,s.UPPER_SEP_ID),t._specCounter=0,t.classList.remove(this._insertIntoStyle),this._drawLowerSeparator(e,t))):e!==this._root&&this._dropInsideAllowed(e)&&(o=!1,this._rowRemoveSep(t,s.LOWER_SEP_ID),this._rowRemoveSep(t,s.UPPER_SEP_ID),t.classList.add(this._insertIntoStyle),t._hasStyle=!0,i&&(t._specCounter?++t._specCounter:t._specCounter=1))}$(this._container).find(".g-drag").toggleClass("g-no-drop",o)},s.prototype._rowHasSep=function(e,t){for(var n=1,i=e.childNodes.length;n<i;n++)if(e.childNodes[n].id===t)return!0;return!1},s.prototype._rowAddSep=function(e,t,n){var i=document.createElement("div");i.id=t,this._separatorRenderer(i,n),t==s.UPPER_SEP_ID?e.insertBefore(i,e.firstChild):e.appendChild(i),e._hasStyle=!0},s.prototype._rowRemoveSep=function(e,t){for(var n=e.childNodes.length-1;n>=0;--n)e.childNodes[n].id===t&&e.removeChild(e.childNodes[n])},s.prototype.resetRowHeight=function(e){this._rowHeight=e},s.prototype.setFreeHeight=function(e){this._freeHeight=e},s.prototype.toString=function(){return"[GVirtualTree]"},l.AUTO_SCROLL_Y={OFF:0,UP:1,DOWN:2},l.AUTO_SCROLL_X={OFF:0,LEFT:1,RIGHT:2},l.SCROLL_AXIS_FLAG={X:1,Y:2},l.prototype._elem=null,l.prototype._timerId=null,l.prototype._scrollDelay=null,l.prototype._step=null,l.prototype._axisFlag=null,l.prototype._scAreaWidth=0,l.prototype._aScrollEnabled=!1,l.prototype._aScrollY=l.AUTO_SCROLL_Y.OFF,l.prototype._aScrollX=l.AUTO_SCROLL_X.OFF,l.prototype.enableAScroll=function(){this._aScrollEnabled=!0,this._timerId=setInterval(this._tryScroll.bind(this),this._scrollDelay)},l.prototype.disableAScroll=function(){this._aScrollEnabled=!1,this._timerId&&(clearInterval(this._timerId),this._timerId=null)},l.prototype.takeOnOffAction=function(e){if(this._aScrollEnabled){if(e.layerY==e.clientY||e.layerX==e.clientX)return this._aScrollY=l.AUTO_SCROLL_Y.OFF,void(this._aScrollX=l.AUTO_SCROLL_X.OFF);for(var t=e.layerY,n=e.layerX,i=e.target;i!=this._elem&&i;i=i.offsetParent?i.offsetParent:i.parentNode)i.offsetParent&&(t+=i.offsetTop,n+=i.offsetLeft);if(!i)return;t-=this._elem.scrollTop,n-=this._elem.scrollLeft,this._axisFlag&l.SCROLL_AXIS_FLAG.Y&&n>0&&n<this._elem.offsetWidth&&(t<=this._scAreaWidth?this._aScrollY=l.AUTO_SCROLL_Y.UP:t>=this._elem.offsetHeight-this._scAreaWidth?this._aScrollY=l.AUTO_SCROLL_Y.DOWN:this._aScrollY=l.AUTO_SCROLL_Y.OFF),this._axisFlag&l.SCROLL_AXIS_FLAG.X&&t>0&&t<this._elem.offsetHeight&&(n<=this._scAreaWidth?this._aScrollX=l.AUTO_SCROLL_X.LEFT:n>=this._elem.offsetWidth-this._scAreaWidth?this._aScrollX=l.AUTO_SCROLL_X.RIGHT:this._aScrollX=l.AUTO_SCROLL_X.OFF)}},l.prototype.offScrolls=function(e){e.target===this._elem&&(this._aScrollY=l.AUTO_SCROLL_Y.OFF,this._aScrollX=l.AUTO_SCROLL_X.OFF)},l.prototype._tryScroll=function(){if(this._aScrollY!==l.AUTO_SCROLL_Y.OFF||this._aScrollX!==l.AUTO_SCROLL_X.OFF){if(this._aScrollY){var e=this._aScrollY==l.AUTO_SCROLL_Y.UP?-1:1;this._elem.scrollTop+=this._step*e}if(this._aScrollX){var t=this._aScrollX==l.AUTO_SCROLL_X.LEFT?-1:1;this._elem.scrollLeft+=this._step*t}}},l.prototype._fixupHandler=function(e,t){var n,i;this._elem[e]?this._elem[e]=(n=t,i=this._elem[e],function(){return n.apply(this,arguments),i.apply(this,arguments)}):this._elem[e]=t},n(1579)(s),e.exports.GVirtualTreeNode=r,e.exports.GVirtualTreeNodeNamed=a,e.exports.GVirtualTree=s},function(e,t,n){var i=n(59),o=n(555),r=n(174),a=n(73);e.exports=function(e,t){for(var n=o(t),s=a.f,l=r.f,c=0;c<n.length;c++){var d=n[c];i(e,d)||s(e,d,l(t,d))}}},function(e,t,n){var i=n(153);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(34),o=n(62),r=n(154);e.exports=function(e,t,n){var a,s;return r&&i(a=t.constructor)&&a!==n&&o(s=a.prototype)&&s!==n.prototype&&r(e,s),e}},function(e,t,n){var i=n(130).match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},function(e,t,n){var i=n(130);e.exports=/MSIE|Trident/.test(i)},function(e,t,n){var i=n(130).match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},function(e,t,n){var i=n(27),o=n(6).RegExp;e.exports=i((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},function(e,t,n){var i=n(27),o=n(6).RegExp;e.exports=i((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},,function(e,t,n){var i=n(180).PROPER,o=n(27),r=n(227);e.exports=function(e){return o((function(){return!!r[e]()||"​᠎"!=="​᠎"[e]()||i&&r[e].name!==e}))}},,function(e,t,n){"use strict";var i=n(417),o=n(85),r=n(283),a=n(204),s=n(284),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=o.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(a[n]);if(t.header&&i.deflateSetHeader(this.strm,t.header),t.dictionary){var d;if(d="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=i.deflateSetDictionary(this.strm,d)))throw new Error(a[n]);this._dict_set=!0}}function d(e,t){var n=new c(t);if(n.push(e,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(e,t){var n,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new o.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=i.deflate(s,a))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(r.buf2binstring(o.shrinkBuf(s.output,s.next_out))):this.onData(o.shrinkBuf(s.output,s.next_out)))}while((s.avail_in>0||0===s.avail_out)&&1!==n);return 4===a?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),s.avail_out=0,!0)},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Deflate=c,t.deflate=d,t.deflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},t.gzip=function(e,t){return(t=t||{}).gzip=!0,d(e,t)}},function(e,t,n){"use strict";var i,o=n(85),r=n(418),a=n(281),s=n(282),l=n(204);function c(e,t){return e.msg=l[t],t}function d(e){return(e<<1)-(e>4?9:0)}function u(e){for(var t=e.length;--t>=0;)e[t]=0}function p(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(o.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function g(e,t){r._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,p(e.strm)}function h(e,t){e.pending_buf[e.pending++]=t}function f(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function m(e,t){var n,i,o=e.max_chain_length,r=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,d=e.w_mask,u=e.prev,p=e.strstart+258,g=c[r+a-1],h=c[r+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===g&&c[n]===c[r]&&c[++n]===c[r+1]){r+=2,n++;do{}while(c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&c[++r]===c[++n]&&r<p);if(i=258-(p-r),r=p-258,i>a){if(e.match_start=t,a=i,i>=s)break;g=c[r+a-1],h=c[r+a]}}}while((t=u[t&d])>l&&0!=--o);return a<=e.lookahead?a:e.lookahead}function y(e){var t,n,i,r,l,c,d,u,p,g,h=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-262)){o.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=h?i-h:0}while(--n);t=n=h;do{i=e.prev[--t],e.prev[t]=i>=h?i-h:0}while(--n);r+=h}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,p=r,g=void 0,(g=c.avail_in)>p&&(g=p),n=0===g?0:(c.avail_in-=g,o.arraySet(d,c.input,c.next_in,g,u),1===c.state.wrap?c.adler=a(c.adler,d,g,u):2===c.state.wrap&&(c.adler=s(c.adler,d,g,u)),c.next_in+=g,c.total_in+=g,g),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)}function v(e,t){for(var n,i;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=m(e,n)),e.match_length>=3)if(i=r._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function _(e,t){for(var n,i,o;;){if(e.lookahead<262){if(y(e),e.lookahead<262&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=m(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,i=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(g(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=r._tr_tally(e,0,e.window[e.strstart-1]))&&g(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}function b(e,t,n,i,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=o}function w(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(1146),this.dyn_dtree=new o.Buf16(122),this.bl_tree=new o.Buf16(78),u(this.dyn_ltree),u(this.dyn_dtree),u(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(16),this.heap=new o.Buf16(573),u(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(573),u(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,r._tr_init(t),0):c(e,-2)}function E(e){var t,n=C(e);return 0===n&&((t=e.state).window_size=2*t.w_size,u(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function S(e,t,n,i,r,a){if(!e)return-2;var s=1;if(-1===t&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||8!==n||i<8||i>15||t<0||t>9||a<0||a>4)return c(e,-2);8===i&&(i=9);var l=new w;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new o.Buf8(2*l.w_size),l.head=new o.Buf16(l.hash_size),l.prev=new o.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new o.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=n,E(e)}i=[new b(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(y(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,g(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(g(e,!1),e.strm.avail_out),1)})),new b(4,4,8,4,v),new b(4,5,16,8,v),new b(4,6,32,32,v),new b(4,4,16,16,_),new b(8,16,32,32,_),new b(8,16,128,128,_),new b(8,32,128,256,_),new b(32,128,258,1024,_),new b(32,258,258,4096,_)],t.deflateInit=function(e,t){return S(e,t,8,15,8,0)},t.deflateInit2=S,t.deflateReset=E,t.deflateResetKeep=C,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?-2:(e.state.gzhead=t,0):-2},t.deflate=function(e,t){var n,o,a,l;if(!e||!e.state||t>5||t<0)return e?c(e,-2):-2;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||666===o.status&&4!==t)return c(e,0===e.avail_out?-5:-2);if(o.strm=e,n=o.last_flush,o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,h(o,31),h(o,139),h(o,8),o.gzhead?(h(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),h(o,255&o.gzhead.time),h(o,o.gzhead.time>>8&255),h(o,o.gzhead.time>>16&255),h(o,o.gzhead.time>>24&255),h(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),h(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(h(o,255&o.gzhead.extra.length),h(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=s(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(h(o,0),h(o,0),h(o,0),h(o,0),h(o,0),h(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),h(o,3),o.status=113);else{var m=8+(o.w_bits-8<<4)<<8;m|=(o.strategy>=2||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(m|=32),m+=31-m%31,o.status=113,f(o,m),0!==o.strstart&&(f(o,e.adler>>>16),f(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),p(e),a=o.pending,o.pending!==o.pending_buf_size));)h(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),p(e),a=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,h(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),0===l&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),p(e),a=o.pending,o.pending===o.pending_buf_size)){l=1;break}l=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,h(o,l)}while(0!==l);o.gzhead.hcrc&&o.pending>a&&(e.adler=s(e.adler,o.pending_buf,o.pending-a,a)),0===l&&(o.status=103)}else o.status=103;if(103===o.status&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&p(e),o.pending+2<=o.pending_buf_size&&(h(o,255&e.adler),h(o,e.adler>>8&255),e.adler=0,o.status=113)):o.status=113),0!==o.pending){if(p(e),0===e.avail_out)return o.last_flush=-1,0}else if(0===e.avail_in&&d(t)<=d(n)&&4!==t)return c(e,-5);if(666===o.status&&0!==e.avail_in)return c(e,-5);if(0!==e.avail_in||0!==o.lookahead||0!==t&&666!==o.status){var v=2===o.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(y(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(o,t):3===o.strategy?function(e,t){for(var n,i,o,a,s=e.window;;){if(e.lookahead<=258){if(y(e),e.lookahead<=258&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=s[o=e.strstart-1])===s[++o]&&i===s[++o]&&i===s[++o]){a=e.strstart+258;do{}while(i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&i===s[++o]&&o<a);e.match_length=258-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=r._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(g(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(g(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(g(e,!1),0===e.strm.avail_out)?1:2}(o,t):i[o.level].func(o,t);if(3!==v&&4!==v||(o.status=666),1===v||3===v)return 0===e.avail_out&&(o.last_flush=-1),0;if(2===v&&(1===t?r._tr_align(o):5!==t&&(r._tr_stored_block(o,0,0,!1),3===t&&(u(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),p(e),0===e.avail_out))return o.last_flush=-1,0}return 4!==t?0:o.wrap<=0?1:(2===o.wrap?(h(o,255&e.adler),h(o,e.adler>>8&255),h(o,e.adler>>16&255),h(o,e.adler>>24&255),h(o,255&e.total_in),h(o,e.total_in>>8&255),h(o,e.total_in>>16&255),h(o,e.total_in>>24&255)):(f(o,e.adler>>>16),f(o,65535&e.adler)),p(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?0:1)},t.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?c(e,-2):(e.state=null,113===t?c(e,-3):0):-2},t.deflateSetDictionary=function(e,t){var n,i,r,s,l,c,d,p,g=t.length;if(!e||!e.state)return-2;if(2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return-2;for(1===s&&(e.adler=a(e.adler,t,g,0)),n.wrap=0,g>=n.w_size&&(0===s&&(u(n.head),n.strstart=0,n.block_start=0,n.insert=0),p=new o.Buf8(n.w_size),o.arraySet(p,t,g-n.w_size,n.w_size,0),t=p,g=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=g,e.next_in=0,e.input=t,y(n);n.lookahead>=3;){i=n.strstart,r=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=2,y(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=s,0},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,n){"use strict";var i=n(85);function o(e){for(var t=e.length;--t>=0;)e[t]=0}var r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],a=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);o(c);var d=new Array(60);o(d);var u=new Array(512);o(u);var p=new Array(256);o(p);var g=new Array(29);o(g);var h,f,m,y=new Array(30);function v(e,t,n,i,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=o,this.has_stree=e&&e.length}function _(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function b(e){return e<256?u[e]:u[256+(e>>>7)]}function w(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function C(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,w(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function E(e,t,n){C(e,n[2*t],n[2*t+1])}function S(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function G(e,t,n){var i,o,r=new Array(16),a=0;for(i=1;i<=15;i++)r[i]=a=a+n[i-1]<<1;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=S(r[s]++,s))}}function A(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function T(e){e.bi_valid>8?w(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function P(e,t,n,i){var o=2*t,r=2*n;return e[o]<e[r]||e[o]===e[r]&&i[t]<=i[n]}function L(e,t,n){for(var i=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&P(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!P(t,i,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=i}function D(e,t,n){var i,o,s,l,c=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],o=e.pending_buf[e.l_buf+c],c++,0===i?E(e,o,t):(E(e,(s=p[o])+256+1,t),0!==(l=r[s])&&C(e,o-=g[s],l),E(e,s=b(--i),n),0!==(l=a[s])&&C(e,i-=y[s],l))}while(c<e.last_lit);E(e,256,t)}function x(e,t){var n,i,o,r=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==r[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):r[2*n+1]=0;for(;e.heap_len<2;)r[2*(o=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)L(e,r,n);o=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],L(e,r,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,r[2*o]=r[2*n]+r[2*i],e.depth[o]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,r[2*n+1]=r[2*i+1]=o,e.heap[1]=o++,L(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,o,r,a,s,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,g=t.stat_desc.extra_base,h=t.stat_desc.max_length,f=0;for(r=0;r<=15;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(r=l[2*l[2*(i=e.heap[n])+1]+1]+1)>h&&(r=h,f++),l[2*i+1]=r,i>c||(e.bl_count[r]++,a=0,i>=g&&(a=p[i-g]),s=l[2*i],e.opt_len+=s*(r+a),u&&(e.static_len+=s*(d[2*i+1]+a)));if(0!==f){do{for(r=h-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[h]--,f-=2}while(f>0);for(r=h;0!==r;r--)for(i=e.bl_count[r];0!==i;)(o=e.heap[--n])>c||(l[2*o+1]!==r&&(e.opt_len+=(r-l[2*o+1])*l[2*o],l[2*o+1]=r),i--)}}(e,t),G(r,c,e.bl_count)}function I(e,t,n){var i,o,r=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)o=a,a=t[2*(i+1)+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==r&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,r=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))}function O(e,t,n){var i,o,r=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),i=0;i<=n;i++)if(o=a,a=t[2*(i+1)+1],!(++s<l&&o===a)){if(s<c)do{E(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==r&&(E(e,o,e.bl_tree),s--),E(e,16,e.bl_tree),C(e,s-3,2)):s<=10?(E(e,17,e.bl_tree),C(e,s-3,3)):(E(e,18,e.bl_tree),C(e,s-11,7));s=0,r=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}}o(y);var k=!1;function F(e,t,n,o){C(e,0+(o?1:0),3),function(e,t,n,o){T(e),o&&(w(e,n),w(e,~n)),i.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}t._tr_init=function(e){k||(!function(){var e,t,n,i,o,l=new Array(16);for(n=0,i=0;i<28;i++)for(g[i]=n,e=0;e<1<<r[i];e++)p[n++]=i;for(p[n-1]=i,o=0,i=0;i<16;i++)for(y[i]=o,e=0;e<1<<a[i];e++)u[o++]=i;for(o>>=7;i<30;i++)for(y[i]=o<<7,e=0;e<1<<a[i]-7;e++)u[256+o++]=i;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,l[8]++;for(;e<=255;)c[2*e+1]=9,e++,l[9]++;for(;e<=279;)c[2*e+1]=7,e++,l[7]++;for(;e<=287;)c[2*e+1]=8,e++,l[8]++;for(G(c,287,l),e=0;e<30;e++)d[2*e+1]=5,d[2*e]=S(e,5);h=new v(c,r,257,286,15),f=new v(d,a,0,30,15),m=new v(new Array(0),s,0,19,7)}(),k=!0),e.l_desc=new _(e.dyn_ltree,h),e.d_desc=new _(e.dyn_dtree,f),e.bl_desc=new _(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,A(e)},t._tr_stored_block=F,t._tr_flush_block=function(e,t,n,i){var o,r,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),x(e,e.l_desc),x(e,e.d_desc),a=function(e){var t;for(I(e,e.dyn_ltree,e.l_desc.max_code),I(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(r=e.static_len+3+7>>>3)<=o&&(o=r)):o=r=n+5,n+4<=o&&-1!==t?F(e,t,n,i):4===e.strategy||r===o?(C(e,2+(i?1:0),3),D(e,c,d)):(C(e,4+(i?1:0),3),function(e,t,n,i){var o;for(C(e,t-257,5),C(e,n-1,5),C(e,i-4,4),o=0;o<i;o++)C(e,e.bl_tree[2*l[o]+1],3);O(e,e.dyn_ltree,t-1),O(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),D(e,e.dyn_ltree,e.dyn_dtree)),A(e),i&&T(e)},t._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(p[n]+256+1)]++,e.dyn_dtree[2*b(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){C(e,2,3),E(e,256,c),function(e){16===e.bi_valid?(w(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,n){"use strict";var i=n(420),o=n(85),r=n(283),a=n(285),s=n(204),l=n(284),c=n(423),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,t.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=r.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=i.inflateSetDictionary(this.strm,t.dictionary))!==a.Z_OK))throw new Error(s[n])}function p(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}u.prototype.push=function(e,t){var n,s,l,c,u,p=this.strm,g=this.options.chunkSize,h=this.options.dictionary,f=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?p.input=r.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new o.Buf8(g),p.next_out=0,p.avail_out=g),(n=i.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&h&&(n=i.inflateSetDictionary(this.strm,h)),n===a.Z_BUF_ERROR&&!0===f&&(n=a.Z_OK,f=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&n!==a.Z_STREAM_END&&(0!==p.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(p.output,p.next_out),c=p.next_out-l,u=r.buf2string(p.output,l),p.next_out=c,p.avail_out=g-c,c&&o.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(o.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(f=!0)}while((p.avail_in>0||0===p.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),p.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=u,t.inflate=p,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},t.ungzip=p},function(e,t,n){"use strict";var i=n(85),o=n(281),r=n(282),a=n(421),s=n(422);function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function u(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):-2}function p(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,u(e))):-2}function g(e,t){var n,i;return e?(i=new c,e.state=i,i.window=null,0!==(n=p(e,t))&&(e.state=null),n):-2}var h,f,m=!0;function y(e){if(m){var t;for(h=new i.Buf32(512),f=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,h,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,f,0,e.work,{bits:5}),m=!1}e.lencode=h,e.lenbits=9,e.distcode=f,e.distbits=5}function v(e,t,n,o){var r,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new i.Buf8(a.wsize)),o>=a.wsize?(i.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>o&&(r=o),i.arraySet(a.window,t,n-o,r,a.wnext),(o-=r)?(i.arraySet(a.window,t,n-o,o,0),a.wnext=o,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}t.inflateReset=u,t.inflateReset2=p,t.inflateResetKeep=d,t.inflateInit=function(e){return g(e,15)},t.inflateInit2=g,t.inflate=function(e,t){var n,c,d,u,p,g,h,f,m,_,b,w,C,E,S,G,A,T,P,L,D,x,I,O,k=0,F=new i.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),p=e.next_out,d=e.output,h=e.avail_out,u=e.next_in,c=e.input,g=e.avail_in,f=n.hold,m=n.bits,_=g,b=h,x=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;m<16;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(2&n.wrap&&35615===f){n.check=0,F[0]=255&f,F[1]=f>>>8&255,n.check=r(n.check,F,2,0),f=0,m=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&f)){e.msg="unknown compression method",n.mode=30;break}if(m-=4,D=8+(15&(f>>>=4)),0===n.wbits)n.wbits=D;else if(D>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<D,e.adler=n.check=1,n.mode=512&f?10:12,f=0,m=0;break;case 2:for(;m<16;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(n.flags=f,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=f>>8&1),512&n.flags&&(F[0]=255&f,F[1]=f>>>8&255,n.check=r(n.check,F,2,0)),f=0,m=0,n.mode=3;case 3:for(;m<32;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.head&&(n.head.time=f),512&n.flags&&(F[0]=255&f,F[1]=f>>>8&255,F[2]=f>>>16&255,F[3]=f>>>24&255,n.check=r(n.check,F,4,0)),f=0,m=0,n.mode=4;case 4:for(;m<16;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.head&&(n.head.xflags=255&f,n.head.os=f>>8),512&n.flags&&(F[0]=255&f,F[1]=f>>>8&255,n.check=r(n.check,F,2,0)),f=0,m=0,n.mode=5;case 5:if(1024&n.flags){for(;m<16;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.length=f,n.head&&(n.head.extra_len=f),512&n.flags&&(F[0]=255&f,F[1]=f>>>8&255,n.check=r(n.check,F,2,0)),f=0,m=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((w=n.length)>g&&(w=g),w&&(n.head&&(D=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,c,u,w,D)),512&n.flags&&(n.check=r(n.check,c,w,u)),g-=w,u+=w,n.length-=w),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break e;w=0;do{D=c[u+w++],n.head&&D&&n.length<65536&&(n.head.name+=String.fromCharCode(D))}while(D&&w<g);if(512&n.flags&&(n.check=r(n.check,c,w,u)),g-=w,u+=w,D)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break e;w=0;do{D=c[u+w++],n.head&&D&&n.length<65536&&(n.head.comment+=String.fromCharCode(D))}while(D&&w<g);if(512&n.flags&&(n.check=r(n.check,c,w,u)),g-=w,u+=w,D)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;m<16;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(f!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}f=0,m=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;m<32;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}e.adler=n.check=l(f),f=0,m=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=p,e.avail_out=h,e.next_in=u,e.avail_in=g,n.hold=f,n.bits=m,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){f>>>=7&m,m-=7&m,n.mode=27;break}for(;m<3;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}switch(n.last=1&f,m-=1,3&(f>>>=1)){case 0:n.mode=14;break;case 1:if(y(n),n.mode=20,6===t){f>>>=2,m-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}f>>>=2,m-=2;break;case 14:for(f>>>=7&m,m-=7&m;m<32;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&f,f=0,m=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(w=n.length){if(w>g&&(w=g),w>h&&(w=h),0===w)break e;i.arraySet(d,c,u,w,p),g-=w,u+=w,h-=w,p+=w,n.length-=w;break}n.mode=12;break;case 17:for(;m<14;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(n.nlen=257+(31&f),f>>>=5,m-=5,n.ndist=1+(31&f),f>>>=5,m-=5,n.ncode=4+(15&f),f>>>=4,m-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;m<3;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.lens[R[n.have++]]=7&f,f>>>=3,m-=3}for(;n.have<19;)n.lens[R[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},x=s(0,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,x){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;G=(k=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,A=65535&k,!((S=k>>>24)<=m);){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(A<16)f>>>=S,m-=S,n.lens[n.have++]=A;else{if(16===A){for(O=S+2;m<O;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(f>>>=S,m-=S,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}D=n.lens[n.have-1],w=3+(3&f),f>>>=2,m-=2}else if(17===A){for(O=S+3;m<O;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}m-=S,D=0,w=3+(7&(f>>>=S)),f>>>=3,m-=3}else{for(O=S+7;m<O;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}m-=S,D=0,w=11+(127&(f>>>=S)),f>>>=7,m-=7}if(n.have+w>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;w--;)n.lens[n.have++]=D}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,I={bits:n.lenbits},x=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,x){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},x=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,x){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(g>=6&&h>=258){e.next_out=p,e.avail_out=h,e.next_in=u,e.avail_in=g,n.hold=f,n.bits=m,a(e,b),p=e.next_out,d=e.output,h=e.avail_out,u=e.next_in,c=e.input,g=e.avail_in,f=n.hold,m=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;G=(k=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,A=65535&k,!((S=k>>>24)<=m);){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(G&&0==(240&G)){for(T=S,P=G,L=A;G=(k=n.lencode[L+((f&(1<<T+P)-1)>>T)])>>>16&255,A=65535&k,!(T+(S=k>>>24)<=m);){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}f>>>=T,m-=T,n.back+=T}if(f>>>=S,m-=S,n.back+=S,n.length=A,0===G){n.mode=26;break}if(32&G){n.back=-1,n.mode=12;break}if(64&G){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&G,n.mode=22;case 22:if(n.extra){for(O=n.extra;m<O;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.length+=f&(1<<n.extra)-1,f>>>=n.extra,m-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;G=(k=n.distcode[f&(1<<n.distbits)-1])>>>16&255,A=65535&k,!((S=k>>>24)<=m);){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(0==(240&G)){for(T=S,P=G,L=A;G=(k=n.distcode[L+((f&(1<<T+P)-1)>>T)])>>>16&255,A=65535&k,!(T+(S=k>>>24)<=m);){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}f>>>=T,m-=T,n.back+=T}if(f>>>=S,m-=S,n.back+=S,64&G){e.msg="invalid distance code",n.mode=30;break}n.offset=A,n.extra=15&G,n.mode=24;case 24:if(n.extra){for(O=n.extra;m<O;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}n.offset+=f&(1<<n.extra)-1,f>>>=n.extra,m-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===h)break e;if(w=b-h,n.offset>w){if((w=n.offset-w)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}w>n.wnext?(w-=n.wnext,C=n.wsize-w):C=n.wnext-w,w>n.length&&(w=n.length),E=n.window}else E=d,C=p-n.offset,w=n.length;w>h&&(w=h),h-=w,n.length-=w;do{d[p++]=E[C++]}while(--w);0===n.length&&(n.mode=21);break;case 26:if(0===h)break e;d[p++]=n.length,h--,n.mode=21;break;case 27:if(n.wrap){for(;m<32;){if(0===g)break e;g--,f|=c[u++]<<m,m+=8}if(b-=h,e.total_out+=b,n.total+=b,b&&(e.adler=n.check=n.flags?r(n.check,d,b,p-b):o(n.check,d,b,p-b)),b=h,(n.flags?f:l(f))!==n.check){e.msg="incorrect data check",n.mode=30;break}f=0,m=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;m<32;){if(0===g)break e;g--,f+=c[u++]<<m,m+=8}if(f!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}f=0,m=0}n.mode=29;case 29:x=1;break e;case 30:x=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=p,e.avail_out=h,e.next_in=u,e.avail_in=g,n.hold=f,n.bits=m,(n.wsize||b!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&v(e,e.output,e.next_out,b-e.avail_out)?(n.mode=31,-4):(_-=e.avail_in,b-=e.avail_out,e.total_in+=_,e.total_out+=b,n.total+=b,n.wrap&&b&&(e.adler=n.check=n.flags?r(n.check,d,b,e.next_out-b):o(n.check,d,b,e.next_out-b)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===_&&0===b||4===t)&&0===x&&(x=-5),x)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?-2:(n.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&o(1,t,i,0)!==n.check?-3:v(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,n){"use strict";e.exports=function(e,t){var n,i,o,r,a,s,l,c,d,u,p,g,h,f,m,y,v,_,b,w,C,E,S,G,A;n=e.state,i=e.next_in,G=e.input,o=i+(e.avail_in-5),r=e.next_out,A=e.output,a=r-(t-e.avail_out),s=r+(e.avail_out-257),l=n.dmax,c=n.wsize,d=n.whave,u=n.wnext,p=n.window,g=n.hold,h=n.bits,f=n.lencode,m=n.distcode,y=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{h<15&&(g+=G[i++]<<h,h+=8,g+=G[i++]<<h,h+=8),_=f[g&y];t:for(;;){if(g>>>=b=_>>>24,h-=b,0===(b=_>>>16&255))A[r++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=f[(65535&_)+(g&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&_,(b&=15)&&(h<b&&(g+=G[i++]<<h,h+=8),w+=g&(1<<b)-1,g>>>=b,h-=b),h<15&&(g+=G[i++]<<h,h+=8,g+=G[i++]<<h,h+=8),_=m[g&v];n:for(;;){if(g>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(g&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(C=65535&_,h<(b&=15)&&(g+=G[i++]<<h,(h+=8)<b&&(g+=G[i++]<<h,h+=8)),(C+=g&(1<<b)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(g>>>=b,h-=b,C>(b=r-a)){if((b=C-b)>d&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,S=p,0===u){if(E+=c-b,b<w){w-=b;do{A[r++]=p[E++]}while(--b);E=r-C,S=A}}else if(u<b){if(E+=c+u-b,(b-=u)<w){w-=b;do{A[r++]=p[E++]}while(--b);if(E=0,u<w){w-=b=u;do{A[r++]=p[E++]}while(--b);E=r-C,S=A}}}else if(E+=u-b,b<w){w-=b;do{A[r++]=p[E++]}while(--b);E=r-C,S=A}for(;w>2;)A[r++]=S[E++],A[r++]=S[E++],A[r++]=S[E++],w-=3;w&&(A[r++]=S[E++],w>1&&(A[r++]=S[E++]))}else{E=r-C;do{A[r++]=A[E++],A[r++]=A[E++],A[r++]=A[E++],w-=3}while(w>2);w&&(A[r++]=A[E++],w>1&&(A[r++]=A[E++]))}break}}break}}while(i<o&&r<s);i-=w=h>>3,g&=(1<<(h-=w<<3))-1,e.next_in=i,e.next_out=r,e.avail_in=i<o?o-i+5:5-(i-o),e.avail_out=r<s?s-r+257:257-(r-s),n.hold=g,n.bits=h}},function(e,t,n){"use strict";var i=n(85),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,n,l,c,d,u,p){var g,h,f,m,y,v,_,b,w,C=p.bits,E=0,S=0,G=0,A=0,T=0,P=0,L=0,D=0,x=0,I=0,O=null,k=0,F=new i.Buf16(16),R=new i.Buf16(16),M=null,N=0;for(E=0;E<=15;E++)F[E]=0;for(S=0;S<l;S++)F[t[n+S]]++;for(T=C,A=15;A>=1&&0===F[A];A--);if(T>A&&(T=A),0===A)return c[d++]=20971520,c[d++]=20971520,p.bits=1,0;for(G=1;G<A&&0===F[G];G++);for(T<G&&(T=G),D=1,E=1;E<=15;E++)if(D<<=1,(D-=F[E])<0)return-1;if(D>0&&(0===e||1!==A))return-1;for(R[1]=0,E=1;E<15;E++)R[E+1]=R[E]+F[E];for(S=0;S<l;S++)0!==t[n+S]&&(u[R[t[n+S]]++]=S);if(0===e?(O=M=u,v=19):1===e?(O=o,k-=257,M=r,N-=257,v=256):(O=a,M=s,v=-1),I=0,S=0,E=G,y=d,P=T,L=0,f=-1,m=(x=1<<T)-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){_=E-L,u[S]<v?(b=0,w=u[S]):u[S]>v?(b=M[N+u[S]],w=O[k+u[S]]):(b=96,w=0),g=1<<E-L,G=h=1<<P;do{c[y+(I>>L)+(h-=g)]=_<<24|b<<16|w|0}while(0!==h);for(g=1<<E-1;I&g;)g>>=1;if(0!==g?(I&=g-1,I+=g):I=0,S++,0==--F[E]){if(E===A)break;E=t[n+u[S]]}if(E>T&&(I&m)!==f){for(0===L&&(L=T),y+=G,D=1<<(P=E-L);P+L<A&&!((D-=F[P+L])<=0);)P++,D<<=1;if(x+=1<<P,1===e&&x>852||2===e&&x>592)return 1;c[f=I&m]=T<<24|P<<16|y-d|0}}return 0!==I&&(c[y+I]=E-L<<24|64<<16|0),p.bits=T,0}},function(e,t,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){t.read=function(e,t,n,i,o){var r,a,s=8*o-i-1,l=(1<<s)-1,c=l>>1,d=-7,u=n?o-1:0,p=n?-1:1,g=e[t+u];for(u+=p,r=g&(1<<-d)-1,g>>=-d,d+=s;d>0;r=256*r+e[t+u],u+=p,d-=8);for(a=r&(1<<-d)-1,r>>=-d,d+=i;d>0;a=256*a+e[t+u],u+=p,d-=8);if(0===r)r=1-c;else{if(r===l)return a?NaN:1/0*(g?-1:1);a+=Math.pow(2,i),r-=c}return(g?-1:1)*a*Math.pow(2,r-i)},t.write=function(e,t,n,i,o,r){var a,s,l,c=8*r-o-1,d=(1<<c)-1,u=d>>1,p=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:r-1,h=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=d?(s=0,a=d):a+u>=1?(s=(t*l-1)*Math.pow(2,o),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;e[n+g]=255&s,g+=h,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+g]=255&a,g+=h,a/=256,c-=8);e[n+g-h]|=128*f}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},,function(e,t,n){"use strict";const i=[{ext:"gvdesign",type:"application/gravit+design",default:!0}],o=i.map(e=>{let{ext:t}=e;return t.toLowerCase()});e.exports={ENABLE_UNSPLASH_INTEGRATION:!1,GoogleTagManagerSettings:null,IN_APP_PURCHASE:{WINDOWS:{trunk:null,rc:null,beta:null,production:null,lts:null},CLEVERBRIDGE:{openCartInAPopup:!1}},License:null,LicenseType:null,Runtime:null,NOTIFICATION_USER_MENTION_REGEX:null,NOTIFICATION_SETTINGS_ENABLED:!1,FILE_REVIEW_ENABLED:!0,ANNOTATION_PERMANENT_LINK:!1,ANONYMOUS_SESSION_ENABLED:!1,LOCAL_FONTS_API_ENABLED:!0,DOMAIN:null,GA:{customDimensions:null},TOUCH_LAYOUT:!0,SHARE_ENGINE:!0,LEGACY_SHARE_DIALOG:!1,ENABLE_COLLABORATION:!0,ENABLE_REQUEST_ACCESS:!0,ENABLE_GUEST_ACCESS:!0,LISTS_FEATURE:!0,REMOVE_GUEST_USER_WHEN_ROLE_IS_NO_ACCESS:!1,PURCHASE:{URL_TO_PRODUCT:null},DESIGNER:{TITLE:"Gravit Designer"},TRANSLATION_MANAGER:{CONSIDER_EXTENSION:void 0},SOFTWARE_UPDATE:{SHOW_CHANGE_LOG:!0,CHANGE_LOG_LINK:"https://designer.io/changelog/"},LOGIN_DIALOGS:{POPUP:!0},HAS_ENTERPRISE:!1,FORGOT_PWD_LINK:null,LICENSE:{UPGRADEABLE:!1},CLOUD_DIALOG:{NEW_LAYOUT:!1,SHOW_FILE_SIZE_INFO:!0},CLOUD_SYNC_FEATURE:{NEW_LAYOUT:!0},USER_LOGIN:{SHOW_PURCHASE_PRO:!0},AUTO_SAVE_ENABLED:!0,AUTOSAVE_INTERVALS:[5,10,20],AUTOSAVE_INTERVAL_DEFAULT:5,FILE_FORMATS:i,FILE_EXTENSIONS:o,LINKS:{CLEVERBRIDGE_SUPPORT_URL:"https://support.cleverbridge.com/hc/en/requests/new?ticket_form_id=18434",BLENDING_MODES_DOCUMENTATION_URL:null,ACCOUNT_SETTING_URL:null,USER_NAME_UPDATE_URL:null},FOLDER_FORMAT:"application/gravit+folder",HAS_SNAPZONES:!0,HAS_ANNOTATIONS:!1,PROFILE_DIALOG_URL:null,PRESET_LIMIT:void 0,CONNECTION_TEST_WITH_CREDENTIALS:!1,NEW_COMMENT_READ_TIMEOUT:3e4,cloudTrunkURL:null,cloudRCURL:null,trunkURL:null,betaURL:null,cloudBetaURL:null,prodURL:null,rcURL:null,ltsURL:null,domain:null,webcdr:null,stagingWebcdr:null,betaWebcdr:null,trunkwebcdr:null,websocketURL:null,trunkWebsocketURL:null,rcWebsocketURL:null,betaWebsocketURL:null,DateAPI:null,gApi:null,GooglePickerBuilder:null,USE_EXTENSION_IN_FILENAME:!0,ALWAYS_SHOW_ACCOUNT_SETTING_DIALOG:!0,ALLOW_REARRANGE_TABS:!0,SHOW_SIDEBAR_BADGE:!0,COMPUTE_SHA256_FOR_FILES:!1,IS_COREL:!1,IS_TRUNK:!1,IS_PROD:!0,IS_BETA:!1,FILE_ID_PREFIX:{},GFileReviewActions:{},FileStatus:{},User:{},NotificationConstants:{},LONG_PRESS_TIME_OUT:500,JPEG_EXPORT_QUALITY_DEFAULT:92,VTREE_FREE_HEIGHT:7,VTREE_FREE_HEIGHT_TOUCH:15,UN_BELIVEVABLE_FEW_BYTES_TO_SAVE:200,FILE_SIZE_TO_RAM_COEFFCIENT:1.5,FILE_SIZE_TO_SAVING_RAM_COEFFCIENT:5,MIN_JS_HEAP_SIZE:104857600,JS_HEAP_SIZE_LIMIT_POYFILL:4294705152,ELECTRON_NOJS_MAX_MEMORY:1503238553.6,MIN_TOUCH_MOVE_DISTANCE:20,MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE:10,MIN_SUPPORTED_SCREEN_SIZE:1024,MAX_FOLDER_DEPTH_FOR_CLOUD:64,OFFLINE_CHECK_MIN_WAIT:2e3,USER_CHECK_MIN_WAIT:3e4,SubscriptionStatus:null,PurchaseStatus:null,EXTERNAL_APP:{GOOGLEDRIVE:"googledrive"},DEFAULT_FILE_THUMBNAIL:"assets/img/cloud/default-file-preview.svg",CACHED_GAPI_FUNCTIONS:["getCollaborators","getFileExtended","getFile","getExternalFile"],SEARCH_IN_FOLDERS:!1}},function(e,t,n){"use strict";function i(){}i.Provider={CloudNative:1,SharepointNative:2,GoogleDriveNative:3,OneDriveBusinessNative:4},i.SecurityLevel={Lowest:0,Highest:1},e.exports=i},,function(e,t,n){var i=n(67),o=n(73),r=n(235),a=n(27),s=RegExp.prototype;i&&a((function(){return"sy"!==Object.getOwnPropertyDescriptor(s,"flags").get.call({dotAll:!0,sticky:!0})}))&&o.f(s,"flags",{configurable:!0,get:r})},,,,,,,,,function(e,t,n){var i,o,r,a,s,l,c,d;e.exports=(d=n(46),o=(i=d).lib,r=o.WordArray,a=o.Hasher,s=i.algo,l=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],a=n[3],s=n[4],c=0;c<80;c++){if(c<16)l[c]=0|e[t+c];else{var d=l[c-3]^l[c-8]^l[c-14]^l[c-16];l[c]=d<<1|d>>>31}var u=(i<<5|i>>>27)+s+l[c];u+=c<20?1518500249+(o&r|~o&a):c<40?1859775393+(o^r^a):c<60?(o&r|o&a|r&a)-1894007588:(o^r^a)-899497514,s=a,a=r,r=o<<30|o>>>2,o=i,i=u}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+r|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(i+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),i.SHA1=a._createHelper(c),i.HmacSHA1=a._createHmacHelper(c),d.SHA1)},function(e,t,n){var i,o,r,a;e.exports=(i=n(46),r=(o=i).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,i=4*n;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),r=this._iKey=t.clone(),s=o.words,l=r.words,c=0;c<n;c++)s[c]^=1549556828,l[c]^=909522486;o.sigBytes=r.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},,,,,,,,,,,,,,,,function(e,t,n){"use strict";e.exports=class{static calculateProgress(e,t,n){return e+(t-e)*n}}},function(e,t,n){"use strict";var i=n(17);n(14),n(29),n(321),n(3),n(25),n(9),n(163),n(45),n(63);var o=n(1),r=n(32),a=n(755),s=i(n(756)),l=i(n(36)),c=n(12),d=i(n(699)),u=i(n(701)),p=i(n(501));const g=n(348),h=n(106),f=n(536),m=n(305),y=n(389),v=n(78),_=n(151),b=n(390),w=n(77),C=n(702),E=n(703),{FILE_FORMATS:S}=n(12),G=Object.values(S).find(e=>e.default),A=10,T=50,P=80,L=100;function D(){}o.GObject.inherit(D,g),D.getSupportedFileFormats=function(){return b.getFileTypesArray().filter(e=>e.load)},D.convertToCloudItem=function(e){var t=_.from(e);if(t.updated=e.modifiedTime,t.created=e.createdTime,t.storage=_.Storage.GoogleDrive,!t.kind||t.kind!==s.default.Kind.TeamDrive&&t.kind!==s.default.Kind.Drive?t.mimeType===s.default.MimeType.Folder?t.setItemType(_.Type.Folder):(t.setItemType(_.Type.File),t.setVersion(e.version),t.setModificationTime(e.modifiedTime)):t.setItemType(_.Type.CorporateStorage),t.mimeType&&(t.type=t.mimeType),t.fileExtension){t.extension=t.fileExtension,t.name=e.name.replace(new RegExp(".(".concat(t.extension,")$"),"i"),"");const n=D.getSupportedFileFormats().find(e=>e.ext.toLowerCase()===t.fileExtension.toLowerCase());n&&(t.type=n.type||n.mime,t.setMimeType(t.type))}return t.capabilities&&(t.capabilities.canDownload&&(t.setPermission(_.Permission.Download),t.setPermission(_.Permission.Open)),t.capabilities.canEdit&&t.setPermission(_.Permission.Editing)),t.parent||(t.parent=null),t.hasThumbnail&&t.setPreviewURL(t.thumbnailLink),t.size&&t.setSize(t.size),t},D.Item=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;g.Item.call(this,e,t),this._rawData=n,this._token=i,t&&(this._setExtension(),t.version&&(this._version=t.version))},o.GObject.inheritAndMix(D.Item,g.Item,[y]),D.Item.prototype._version=null,D.Item.prototype._writing=!1,D.Item.prototype.setFile=function(e){if(!e)throw"File is incorrect";e instanceof _||(e=D.convertToCloudItem(e));const t=this._getOrCreateClient(),n=t&&t.getTokenIssuerSettings();!e.settings&&n&&(e=Object.assign(e,{settings:n})),g.Item.prototype.setFile.call(this,e),this._setExtension(),this._setVersion(e.version)},D.Item.prototype.isVersionNewerThan=function(e){if(e instanceof D.Item&&this.getUniqueId()===e.getUniqueId()){var t=this.getVersion()>e.getVersion(),n=e.getFile();const o=this.getFile();if(t&&i(o.modifiedTime,n.modifiedTime))return!0;const r=o.getVersion()>n.getVersion(),a=i(o.getModificationTime(),n.getModificationTime());if(r&&a)return!0}return!1;function i(e,t){return new Date(e).getTime()>new Date(t).getTime()}},D.Item.prototype.supportsShadowFile=function(){const e=this._getOrCreateClient();return!!e&&e.isCorporate()},D.Item.prototype.getCollaborativeFile=async function(){if(!this.supportsShadowFile())throw"Not the collaborative mode";return this._collaborativeFile=await gDesigner.getCloudCommunicationManager().getExternalFile(this.getId()).catch(()=>null),this._collaborativeFile},D.Item.prototype.setCollaborativeFileStatus=async function(e){if(!this.supportsShadowFile())throw"Not the collaborative mode";const t=this._collaborativeFile?this._collaborativeFile:await this.getCollaborativeFile();if(t&&Number(t.status)!==Number(e)){var n=t.status;t.status=e,gDesigner.hasEventListeners(m.FileStatusUpdate)&&gDesigner.trigger(new m.FileStatusUpdate(this,n,e))}},D.Item.prototype.getOrCreateCollaborativeFile=async function(){if(!this.supportsShadowFile())throw"Not the collaborative mode";var e=await this.getCollaborativeFile();return e||(await this.createShadowFile(),e=await this.getCollaborativeFile()),e},D.Item.prototype._app=c.FILE_ID_PREFIX.GOOGLEDRIVE,D.Item.prototype.getId=function(){const e=this._getGoogleId();return e?_.getCollaborativeFileId(e,_.Storage.GoogleDrive):null},D.Item.prototype._getGoogleId=function(){return this._id||null},D.Item.prototype._setExtension=function(){const e=this.getFile();e&&(e.fileExtension?this._ext=e.fileExtension:["application/vnd.corel-draw","application/cdr"].includes(e.mimeType)?this._ext="CDR":"application/des"===e.mimeType&&(this._ext="DES"))},D.Item.prototype._setFileSizeAfterSaved=async function(){return this._getOrCreateClient().getFileDetails(this.getUniqueId()).then(e=>{this._fileSizeAfterSaved=e.Length})},D.Item.prototype.write=async function(e,t,n,i,r){gContainer.verifyEnoughMemoryToSave(e);try{if(this._writing)return;if(e.hasPagesWithInfiniteEmptyCanvas())return void(n?n({code:507,noFailCall:!0,message:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))}):l.default.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))));this._writing=!0;const h=e.getEditor().markSavePoint(),f=e=>{h.rollback(),n&&n(e)};try{const n={};e.updateStatus(w.Saving,n);const l=i||n.progress,h=e=>{l&&l(e)};let m;var a=this.getExtension();const y=e.isNew();if(h(A),o.GUtil.prepareForSaving(e.getScene(),a),"CDR"===a||"DES"===a){var c={progress:i,ext:a.toLowerCase()};m=await this._exportDocumentToCDR(e,c,r)}else{var d=e.getScene(),u=o.GNode.serialize(d,o.GUtil.extend({save:!0},r));m=new Blob([u])}h(T),this._verifyFileNotTooSmall(m.size,e),this._setFileSizeBeforeSaved(m.size);const _=await this._buildGoogleMetadataForDoc(e),b=e=>{h(p.default.calculateProgress(T,P,e))};var g=this._id?this._id:null;await this._getOrCreateClient().upload(g,m,_,s.default.DefaultUploadType,b).then(async n=>{this._updateInternalFileWithGoogleResponse(n);try{await this._setFileSizeAfterSaved(),this._verifyFileSizeAfterSaved()}catch(e){console.error(e)}if(e.updateStatus(w.Saved),y&&this.supportsShadowFile())return this.createShadowFile().then(()=>{gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.StorageItemUpdated,e)),t&&t()});gDesigner.hasEventListeners(v)&&gDesigner.trigger(new v(v.Type.StorageItemUpdated,e)),h(L),t&&t()}).catch(t=>{e.updateStatus(w.SaveFailed),f(t)}).finally(()=>{this._writing=!1})}catch(e){f(e)}}catch(t){return e.updateStatus(w.SaveFailed),this._writing=!1,n&&n(t)}},D.Item.prototype.createOrUpdateFileWithMetadata=async function(e,t){try{if(this._writing)return;this._writing=!0;const n=await this._buildGoogleMetadata(t),i=await this._getOrCreateClient().upload(this._getGoogleId(),new Blob([e]),n);this._updateInternalFileWithGoogleResponse(i)}finally{this._writing=!1}},D.Item.prototype._updateInternalFileWithGoogleResponse=function(e){this.setFile(Object.assign(D.convertToCloudItem(e),{settings:this._getOrCreateClient().getTokenIssuerSettings()}))},D.Item.prototype._getOrCreateClient=function(){let e=this.getCloudClient();return!e&&this._file&&(e=new s.default(new f(this._file.settings)),this.setCloudClient(e)),e},D.Item.prototype._getClient=function(){return this._getOrCreateClient()},D.Item.prototype._exportDocumentToCDR=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(async(i,o)=>{(0,a.prepareCDRforSaving)(e,(function(e){return o(e)}),t,n,(function(e){return i(new Blob([e]))}))})},D.Item.prototype._setVersion=function(e){this._version=e},D.Item.prototype.getVersion=function(){return parseInt(this._version)},D.Item.prototype.read=function(e,t){if(this._rawData){var n=this._rawData;return this._rawData=null,e(n)}this._getOrCreateClient().getFile(this.getUniqueId(),this._getQuery()).then(async t=>{const n=await this._getOrCreateClient().getFileDetails(this.getUniqueId(),this._getQuery());this.setFile(n),this.supportsShadowFile()&&await this.syncShadowFile(),e(await h.createUint8ArrayFromBlob(t))}).catch(e=>t(e))},D.Item.prototype.getToken=function(){return this._token},D.Item.prototype.getMimeType=function(){return this.getFile().mimeType},D.Item.prototype.getPermissionsList=function(){return this._getOrCreateClient().getFilePermissions(this.getUniqueId())},D.Item.prototype.rolesMatch=function(e,t){return d.default[e]===t||u.default[t]===e},D.Item.prototype.getShareRole=async function(e){return this._getOrCreateClient().getFilePermissions(this.getUniqueId()).then(t=>{let n=null;return t&&t.length&&t.permissions.some(t=>{let{email:i,role:o}=t;if(e===i)return n=o,!0}),n})},D.Item.prototype.requestExternalShare=function(e,t){let n=!1;try{n=this._getOrCreateClient().isCorporate()}catch(e){}return n?e?this._shareWithUser(e,t.getRole()):this._shareWithDomain(t.getRole()):Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")))},D.Item.prototype.requestExternalUnShare=async function(e,t){let n=!1;try{n=this._getOrCreateClient().isCorporate()}catch(e){}if(!n)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));if(t&&t.is(c.ShareRoles.NoAccess))return Promise.resolve();const i=await this._getOrCreateClient().getShareIdForEmail(this.getUniqueId(),e);for(let e=0,t=i.length;e<t;e++)try{const t=await this._getOrCreateClient().removeShare(this.getUniqueId(),i[e]);if(t.status!==c.gApi.HTTP_STATUS_CODES.OK&&t.status!==c.gApi.HTTP_STATUS_CODES.NO_CONTENT){const e=t&&t.error&&t.error.message||o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.google-api-error"));return Promise.reject(e)}}catch(e){return Promise.reject(e)}return Promise.resolve()},D.Item.prototype._shareWithUser=async function(e,t){return this._getOrCreateClient().createOrUpdateUserShare(this.getUniqueId(),{role:t,emailAddress:e})},D.Item.prototype.isEmailFromCorporateDomain=async function(e){const t=gDesigner.getSyncUser();let n=!0;if(await this._getOrCreateClient().supportsEmailDomainCheck()){await this._getOrCreateClient().getAccountByEmail(e).catch(()=>!1)||(n=!1)}else c.gApi.sameDomain(t,{email:e})||(n=!1);return n},D.Item.prototype._shareWithDomain=async function(e){const t=await gDesigner.getUser(),n=t&&t.email.split("@")[1];return this._getOrCreateClient().createDomainShare(this.getUniqueId(),{role:e,domain:n})},D.Item.prototype._setId=function(e){this._id=e,this._file&&(this._file.id=e)},D.Item.prototype._buildGoogleMetadataForDoc=async function(e){const t=new C;t.thumbnail=await E.fromBlob(await e.buildPreview());const n=e.getScene();t.unit=n.getProperty("ut");const i=n.getActivePage(),o=i&&i.getGeometryBBox();return o&&(t.width=o.getWidth(),t.height=o.getHeight()),this._buildGoogleMetadata(t)},D.Item.prototype._buildGoogleMetadata=async function(e){const t=this._file.getExtension()||G.ext.toUpperCase(),n=this._file.getMimeType()||(i=t,Object.values(S).find(e=>{let{ext:t}=e;return!!t&&t.toLowerCase()===i.toLowerCase()})||G).type;var i;const o=e.thumbnail.getImageAsBlob(),r=await this._buildSafeEncodedBase64ForBlob(o),a={name:this._file.getNameWithExtension(),mimeType:n,contentHints:{thumbnail:{mimeType:e.thumbnail.getMimeType(),image:r}},appProperties:{type:n,app:"designer",unit:e.unit,width:e.width,height:e.height,trashed:null},viewedByMeTime:(new Date).toISOString()};return this._file.parent&&!this.getUniqueId()&&(a.parents=[this._file.getParentId()]),this._isFromGSuite()&&(a.driveId=this._getTeamDriveId()),a},D.Item.prototype._buildSafeEncodedBase64ForBlob=function(e){return new Promise((t,n)=>{const i=new FileReader;i.onload=e=>{const n=e.target.result,i=n.substr(n.indexOf(",")+1),o=(0,r.base64URLSafeEncode)(i);t(o)},i.onerror=function(){n(i.error)},i.readAsDataURL(e)})},D.Item.prototype.hasVersionControl=function(){return!0},D.Item.prototype.hasUpdates=async function(){if(!this.getUniqueId()||!this.getVersion())return!1;const e=await this._getOrCreateClient().getFileDetails(this.getUniqueId(),this._getQuery());return new D.Item(this.getStorage(),e).isVersionNewerThan(this)},D.Item.prototype._getQuery=function(){return this._isFromGSuite()?{supportsAllDrives:!0}:{}},D.Item.prototype._isFromGSuite=function(){return!!this._getTeamDriveId()},D.Item.prototype._getTeamDriveId=function(){const e=this._file.driveId;if(e)return e;const t=this._file.parent&&this._file.parent.driveId;return t||null},D.Item.prototype.getLatestFileVersion=async function(){const e=this._getOrCreateClient(),t=await this.getLatestFileInfo(),n=await e.getFile(this.getUniqueId(),this._getQuery()),i=await h.createUint8ArrayFromBlob(n),o=new D.Item(this._storage,t,i);return o.setCloudClient(e),o},D.Item.prototype.getLatestFileInfo=async function(){const e=await this._getOrCreateClient().getFileDetails(this.getUniqueId(),this._getQuery());return D.convertToCloudItem(e)},D.Item.prototype.exists=function(){return this._getOrCreateClient().fileExists(this.getUniqueId(),this._getQuery())},D.Item.prototype.toString=function(){return"[Object GGoogleDriveStorage.Item]"},e.exports=D},,,,,,,function(e,t,n){"use strict";e.exports={DEFAULT:0,PRESS_AND_HOLD:1}},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="view.zoom.fit-selection",a.TITLE=new i.GLocaleKey("GFitSelectionAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_VIEW},a.prototype.getGroup=function(){return"zoom"},a.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null;return t&&t.hasSelection()},a.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=(e?e.getEditor():null).getSelectionBBox();t&&!t.isEmpty()&&e.getActiveWindow().getView().zoomAll(t,!1,!0)},a.prototype.toString=function(){return"[Object GFitSelectionAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(9),n(28),n(58),n(3);var o=n(43),r=n(1),a=n(16),s=i(n(217)),l=i(n(308)),c=n(56),d=i(n(309)),u=n(1159),p=n(397),g=n(78),h=(n(548),n(719)),f=n(354),m=n(773),y=n(108),v=n(1407),_=n(545),b=n(1408),w=n(323),C=n(533);const E=n(351),S=n(118);var G=n(1409);const A=n(263),T=n(352),P=n(305),L=n(387),{SHOW_SIDEBAR_BADGE:D,NOTIFICATION_SETTINGS_ENABLED:x}=n(12),I=n(77),O=n(200),k=n(1163),{DateAPI:F,FileStatus:{APPROVED:R}}=n(12),M=n(193);function N(){h.call(this),this._annotationPanels=[],this._annotationProperties=[],this._handleFocusInEvent=this._handleFocusInEvent.bind(this),this._handleFocusOutEvent=this._handleFocusOutEvent.bind(this)}r.GObject.inherit(N,h),N.ANNOTATION_PROPERTIES=[new b([b.PropertySet.FillLayer,b.PropertySet.BorderLayer,b.PropertySet.BorderWidth],r.GEllipseAnnotation,o.GEllipseAnnotationTool,"gravit-icon-annotationtools-ellipse","text.tooltip-ellipse-tool",{_ptf:"text.tooltip-ellipse-fill",_ptb:"text.tooltip-ellipse-border",_ptfdropper:"text.tooltip-ellipse-dropper-fill",_ptbdropper:"text.tooltip-ellipse-dropper-border",_bw:"text.tooltip-ellipse-outline"},"Ellipse","tool-ellipse"),new b([b.PropertySet.FillLayer,b.PropertySet.BorderLayer,b.PropertySet.BorderWidth],r.GRectangleAnnotation,o.GRectangleAnnotationTool,"gravit-icon-annotationtools-rectangle","text.tooltip-rectangle-tool",{_ptf:"text.tooltip-rectangle-fill",_ptb:"text.tooltip-rectangle-border",_ptfdropper:"text.tooltip-rectangle-dropper-fill",_ptbdropper:"text.tooltip-rectangle-dropper-border",_bw:"text.tooltip-rectangle-outline"},"Rectangle","tool-rectangle"),new b([b.PropertySet.BorderLayer,b.PropertySet.BorderWidth],r.GPencilAnnotation,o.GPencilAnnotationTool,"gravit-icon-annotationtools-pencil","text.tooltip-pencil-tool",{_ptb:"text.tooltip-pencil-border",_ptbdropper:"text.tooltip-pencil-dropper-border",_bw:"text.tooltip-pencil-outline"},"Pencil","tool-pencil"),new b([b.PropertySet.BorderLayer,b.PropertySet.BorderWidth],r.GHighlighterAnnotation,o.GHighlighterAnnotationTool,"gravit-icon-annotationtools-highlighter","text.tooltip-highlighter-tool",{_ptb:"text.tooltip-highlighter-border",_ptbdropper:"text.tooltip-highlighter-dropper-border",_bw:"text.tooltip-highlighter-outline"},"Highlighter","tool-highlighter"),new b([b.PropertySet.BorderLayer,b.PropertySet.BorderWidth,b.PropertySet.BorderHeadMarker,b.PropertySet.BorderTailMarker],r.GArrowAnnotation,o.GArrowAnnotationTool,"gravit-icon-annotationtools-line","text.tooltip-arrow-tool",{_ptb:"text.tooltip-arrow-border",_ptbdropper:"text.tooltip-arrow-dropper-border",_bw:"text.tooltip-arrow-outline"},"Line","tool-line"),new b([b.PropertySet.FillLayer],r.GCommentAnnotation,o.GCommentAnnotationTool,"gravit-icon-annotationtools-comment","text.tooltip-comment-tool",{_ptf:"text.tooltip-comment-fill",_ptfdropper:"text.tooltip-comment-dropper-fill"},"Note","tool-comment"),new G],N.ANNOTATION_PROPERTIES_ARROW_POSITION=[32.5,44,55.5,67,78.5,90],N.ANNOTATION_PROPERTIES_ARROW_POSITION_TOUCH=[25.5,38,50.5,63,75.5,88],N.ID=M.SidebarsIds.GAnnotationsSidebar,N.TITLE=new r.GLocaleKey("GAnnotationsSidebar","text.title"),N.prototype._htmlElement=null,N.prototype._panelsContainer=null,N.prototype._annotationPanels=null,N.prototype._annotationProperties=null,N.prototype._document=null,N.prototype._notificationMenu=null,N.prototype._elements=null,N.prototype._listenersAdded=!1,N.prototype._annotationToolbar=null,N.prototype._annotationsToolbarPanel=null,N.prototype._showResolved=!1,N.prototype._showDistance=o.GEditorOptions.showDistance,N.prototype._toolExitKey=o.GEditorOptions.toolExitKey,N.prototype._currentAnnotations=null,N.prototype._localAnnotations=null,N.prototype._page=null,N.prototype.getId=function(){return N.ID},N.prototype.getTitle=function(){return N.TITLE},N.prototype.isEnabled=function(){return!!this._document},N.prototype.isVisible=function(){return!!gDesigner.getApplicationManager().isCommentingEnabled()},N.prototype.isDeactivatable=function(){return!this._annotationPanels||!this._annotationPanels.some(e=>e.properties.isAddingAnnotation())},N.prototype.getOrientation=function(){return f.Orientation.Right},N.prototype.getMinimumWidth=function(){return this._getSidebarWidth()},N.prototype.isResizeable=function(){return!1},N.prototype.getDefaultWidth=function(){return this._getSidebarWidth()},N.prototype._getSidebarWidth=function(){return gDesigner.isTouchEnabled()?376:300},N.prototype._storageItemFileStatusEvent=function(e){this._storageItem&&this._storageItem===e.storageItem&&(e.oldStatus!==R&&e.newStatus!==R||this._updatePropertyPanels(!0))},N.prototype._toggleShowResolved=function(e){if(e!==this._showResolved){this._showResolved=e;for(var t=this._annotationPanels.length-1;t>=0;t--){this._annotationPanels[t].properties.toggleShowResolved(e)}this._document.getActiveWindow().getView().getViewConfiguration().showResolvedAnnotations=e,this._document.getActiveWindow().getView().invalidateAndResetCache(null)}},N.prototype.syncAnnotations=function(e){return this._annotationPanels&&this._document&&this._document.getAnnotationsId()?this.isAnnotationPropertiesEditing()?Promise.resolve():new Promise(t=>{(e?w.updateAndReturnCloudAnnotationsForDocument(this._document,this._currentAnnotations):w.getCloudAnnotationsForDocument(this._document)).then(n=>{let i=n.annotationsCollection,o=!1;this._document&&this._document.getAnnotationsId()!==n.cid&&t(o);let r=!1;if(i){this._currentAnnotations=i;for(let t=this._annotationPanels.length-1;t>=0;t--){let n=this._annotationPanels[t];if(n.properties instanceof v){let t=this._getAnnotationsToSet(i,n.properties.getPage()),a=n.properties.setAnnotations(t);a===k.UPDATED?o=!0:a===k.DELAYED&&(r=!0,n.properties.setDelayedSyncCallback(this.syncAnnotations.bind(this,e)))}}}if(o=o&&!r,o){let e=this._document.getScene();e&&e.setLastTimeAnnotationsFromCloudModified(n.lastUpdateTime),gDesigner.notifyDocumentModified(this._document),this._active?this._activateAnnotations():this.trigger(h.UPDATE_EVENT)}t(o)})}):Promise.resolve()},N.prototype._getAnnotationsToSet=function(e,t){let n=w.findAnnotationsListForPage(t,e);return n||(n={"@":"annlst"}),n},N.prototype.init=function(e){h.prototype.init.call(this,e),this._htmlElement=e,this._notificationMenu=new s.default(null,"g-annotation-sidebar-notification-menu");const t=gDesigner.getApplicationManager().isCommentingEditingEnabled();this._sidebarTitle=$("<div></div>").addClass("sidebar-title-inner").append(r.GLocale.get(this.getTitle())),this._annotationToolbar=$("<div></div>").addClass("toolbar annotations-toolbar");const n=$("<button></button>");var i=$("<div></div>").addClass("annotation-sidebar-options").gOverlay({releaseOnClose:!1,clazz:"g-annotation-sidebar-option-overlay",closeCallback:()=>n.removeClass("g-active")});this._annotationsToolbarPanel=$("<div></div>").addClass("properties-panel").addClass("annotations-properties-panel");var a=$("<div></div>").addClass("annotation-options-box").appendTo(this._annotationToolbar);n.attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.annotation-options"))).addClass("annotation-options").append($("<span></span>").addClass("gravit-icon-settings")).on("click",function(e){i.gOverlay("open",$(e.target).closest("button")),n.addClass("g-active")}.bind(this)).appendTo(a),$("<span></span>").addClass("indicator").appendTo(this._annotationToolbar),this._optionsToolbar=$("<div></div>").gPropertyRow({noPaddingRight:!0,clickable:!0,rawClick:e=>{var t=!$(e.target).find("input").prop("checked");$(e.target).find("input").prop("checked",t),gDesigner.stats("annotations_settings_show-resolved",t?"On":"Off"),this._toggleShowResolved(t),e.stopPropagation()},columns:[{width:"100%",content:$("<label>").append($("<input>").attr("type","checkbox").prop("checked",this._showResolved).on("change",e=>{var t=$(e.target).prop("checked");gDesigner.stats("annotations_settings_show-resolved",t?"On":"Off"),this._toggleShowResolved(t),e.stopPropagation()})).append($("<span>").text(r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.show-resolved"))))}]}),t&&this._optionsToolbar.gPropertyRow({noPaddingRight:!0,clickable:!0,rawClick:()=>{gDesigner.getApplicationManager().isCommentingEditingEnabled()&&(w.resolveAllComments(this._document),this.relayout(!0))},columns:[{width:"100%",content:$("<label>").append($("<span>").addClass("resolve-all-button").addClass("gravit-icon-resolve-all")).append($("<span>").text(r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.resolve-all"))))}]}),x&&this._optionsToolbar.gPropertyRow({clickable:!0,isMenu:!0,rawClick:e=>{if(this._document&&this._document.isCloudFile())this._notificationMenu.open(e.target,p.Position.Right_Bottom,p.Position.Right_Bottom),$("body").find(".hover-notification-container")&&this._removeHoverNotificationFrag(),this._openHoverNotification(e.target);else{this._optionsToolbar.find(".notification-label").closest(".columns").gTooltip("show")}e.stopPropagation()},columns:[{width:"100%",clazz:"notification-label",content:$("<label>").append($("<span>").addClass("resolve-all-button").addClass("gravit-icon-notification")).append($("<span>").text(r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.notification"))))}]}),this._optionsToolbar.appendTo(i),$("<div/>").addClass("offline-overlay-message").append($("<div/>").addClass("box").append($("<span/>").text(r.GLocale.get(new r.GLocaleKey("GOfflineDialog","title.unavailable-feature"))))).appendTo(this._htmlElement),gDesigner.addEventListener(g,this._documentEvent,this),gDesigner.getWindows().addEventListener(_.WindowEvent,this._windowEvent,this),gDesigner.getToolManager().addEventListener(o.GToolManager.ToolChangedEvent,this._toolChangedEvent,this),gDesigner.addEventListener(E,this._stateChangedEvent,this),gDesigner.addEventListener(A,this._networkAvailabilityChangedEvent,this),this._activeTool(gDesigner.getToolManager().getActiveTool()),this._updatePropertyPanels(!0)},N.prototype.getTouchTools=function(){if(!this.isEnabled())return[];if(!this._active){const e=this._document&&this._document.getEditor(),t=e&&e.getSelection();if(t&&t.length)return[]}return[new d.default({id:"annotation",sidebar:this.getId(),icon:"gravit-icon-touch-comment-docker",panel:[this._annotationsToolbarPanel,".annotations-properties-panel"],toolbar:[this._annotationToolbar,".annotations-toolbar"]})]},N.prototype.activate=function(){this._active=!0,!this._listenersAdded&&this._document&&(this._addListeners(),this._updatePropertyPanels(!0)),this._updateToolbarButtons(),this._document&&this._document.getActiveWindow()&&this._activateAnnotations(),gDesigner.getToolManager().activateTool(o.GPointerTool,null,!0),this.syncAnnotations()},N.prototype.deactivate=function(){this._active=!1,this._listenersAdded&&this._removeListeners(),this._document&&this._document.getActiveWindow()&&this._deactivateAnnotations()},N.prototype._activateAnnotations=function(){this._document&&(this._document.getEditor().clearSelection(),this._document.getActiveWindow().getView().getViewConfiguration().elementAnnotations=!0,this._document.getActiveWindow().getView().getViewConfiguration().showResolvedAnnotations=this._showResolved,this._showDistance=o.GEditorOptions.showDistance,this._toolExitKey=o.GEditorOptions.toolExitKey,o.GEditorOptions.showDistance=!1,o.GEditorOptions.toolExitKey=a.GKey.Constant.ESC,this._document.getActiveWindow().getView().invalidateAndResetCache(null))},N.prototype._deactivateAnnotations=function(){if(this._document){var e=this._document.getEditor();e.getSelection()&&e.updateSelection(!1,e.getSelection().filter(e=>!e.hasMixin(r.GAnnotation))),this._document.getActiveWindow().getView().getViewConfiguration().elementAnnotations=!1,o.GEditorOptions.showDistance=this._showDistance,o.GEditorOptions.toolExitKey=this._toolExitKey,this._document.getActiveWindow().getView().invalidateAndResetCache(null)}},N.prototype._addListeners=function(){var e=this._document.getScene(),t=this._document.getEditor();gDesigner.getToolManager().addEventListener(o.GToolManager.ToolChangedEvent,this._updateFromToolOrSelection,this),t.addEventListener(o.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),e.addEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),e.addEventListener(r.GNode.AfterInsertEvent,this._afterInsertEvent,this),e.addEventListener(r.GNode.AfterRemoveEvent,this._afterRemoveEvent,this),gDesigner.addEventListener(S,this._settingChanged,this),gDesigner.isTouchEnabled()&&this._htmlElement&&(this._htmlElement[0].addEventListener("focusin",this._handleFocusInEvent,!0),this._htmlElement[0].addEventListener("focusout",this._handleFocusOutEvent,!0)),this._listenersAdded=!0},N.prototype._removeListeners=function(){var e=this._document.getScene(),t=this._document.getEditor();gDesigner.getToolManager().removeEventListener(o.GToolManager.ToolChangedEvent,this._updateFromToolOrSelection,this),t.removeEventListener(o.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),e.removeEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),e.removeEventListener(r.GNode.AfterInsertEvent,this._afterInsertEvent,this),e.removeEventListener(r.GNode.AfterRemoveEvent,this._afterRemoveEvent,this),gDesigner.removeEventListener(S,this._settingChanged,this),this._htmlElement&&(this._htmlElement[0].removeEventListener("focusin",this._handleFocusInEvent),this._htmlElement[0].removeEventListener("focusout",this._handleFocusOutEvent)),this._listenersAdded=!1},N.prototype._stateChangedEvent=async function(e){this._updateToolbar()},N.prototype._updateToolbar=async function(){const e=gDesigner.getApplicationManager(),t=e.isCommentingEditingEnabled(),n=await e.hasAccess(L.RESOLVE_ALL_COMMENT_ANNOTATION),i=this._optionsToolbar.find(".resolve-all-row");t&&n?i.parent().show():i.parent().hide()},N.prototype._windowEvent=function(e){e.type===_.WindowEvent.Type.Activated&&this._active&&this._activateAnnotations()},N.prototype._documentEvent=function(e){if(!e.document.isLockedByVersionHistory())if(e.type===g.Type.Activated){this._document=e.document,this._storageItem=this._document.getStorageItem();var t=this._document&&this._document.getScene();this._localAnnotations=t&&t.getAnnotations(),this._document.isLocked()||this._updateFromToolOrSelection(!0),this._active&&!this._listenersAdded&&this._addListeners(),this._active&&this._document.getActiveWindow()&&this._activateAnnotations(),this.trigger(h.UPDATE_EVENT),this._document.addEventListener(O,this._documentStatusEvent,this),this._document.addEventListener(T,this._collaborationEvent,this),gDesigner.addEventListener(P.FileStatusUpdate,this._storageItemFileStatusEvent,this),this._updateNotificationMenu()}else e.type===g.Type.Deactivated?(this._listenersAdded&&this._removeListeners(),this._document.getActiveWindow()&&this._deactivateAnnotations(),this._document.removeEventListener(O,this._documentStatusEvent,this),this._document.removeEventListener(T,this._collaborationEvent,this),gDesigner.removeEventListener(P.FileStatusUpdate,this._storageItemFileStatusEvent,this),this._document=null,this._storageItem=null,this._elements=null,this._currentAnnotations=null,this._localAnnotations=null,this._page=null,this._updatePropertyPanels(!0),this.trigger(h.UPDATE_EVENT)):e.type===g.Type.StorageItemUpdated&&this._updatePropertyPanels(!0)},N.prototype._settingChanged=function(e){"touch"===e.key&&this._updateToolbarButtons()},N.prototype._handleFocusInEvent=function(e){$(e.target).is("textarea")&&this._htmlElement.addClass("g-annotation-comment-focus")},N.prototype._handleFocusOutEvent=function(e){$(e.target).is("textarea")&&this._htmlElement.removeClass("g-annotation-comment-focus")},N.prototype._updateNotificationMenu=function(){this._notificationMenu.clearItems(),this._notificationMenu.setTooltipType(c.TOOLTIP_AREA.SIDEBAR),this._document.getId()&&gApi.updateFileData(this._document.getId()).then(e=>{const t=[{caption:r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.notification-all-annotation")),checked:!1,statType:"All"},{caption:r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.notification-assign-to-me")),checked:!1,statType:"Assigned"},{caption:r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.notification-none")),checked:!1,statType:"None"}];t[e.data.notifications_disabled||0].checked=!0,0===this._notificationMenu.getItemCount()&&t.forEach(e=>{this._notificationMenu.addItem(this._createMenuItem(e))})})},N.prototype._createMenuItem=function(e){var t=new l.default(l.default.Type.Item);return t.setChecked(e.checked),t.setCaption(e.caption),t.addEventListener(l.default.ActivateEvent,t=>{const{sender:n}=t;this._notificationMenu._items.forEach(e=>{e.setChecked(!1)}),n.setChecked(!0),gDesigner.stats("annotations_settings_notifications",e.statType),gApi.updateFileData(this._document.getId(),{notifications_disabled:this._notificationMenu.indexOf(n)})}),t},N.prototype._documentStatusEvent=function(e){e.status===I.Unlocked&&this._updateFromToolOrSelection(!0)},N.prototype._collaborationEvent=function(e){if(e.type===T.Type.AnnotationsUpdate){const{data:{lastUpdateTime:t}={}}=e;if(t&&this._document){const e=this._document.getScene();!e||e.getLastTimeAnnotationsFromCloudModified()&&!F.lt(e.getLastTimeAnnotationsFromCloudModified(),t,!1)||this.syncAnnotations()}}else e.type===T.Type.ReviewStatusChanged&&this._updateToolbar()},N.prototype.isToolAllowed=function(e){return!(![o.GHandTool,o.GPointerTool,o.GZoomTool].some(t=>e instanceof t)&&!e.hasMixin(o.GAnnotationTool))},N.prototype._toolChangedEvent=function(e){e.previousTool;var t=e.newTool;if(e.newTool.hasMixin(o.GAnnotationTool)){var n=gDesigner.getActiveDocument();n&&n.getEditor()&&n.getEditor().clearSelection()}this._activeTool(t)},N.prototype._networkAvailabilityChangedEvent=function(e){this._htmlElement.toggleClass("offline",!e.connected),e.connected&&this.syncAnnotations()},N.prototype._activeTool=function(e){this._annotationToolbar.find(".toolbar-button").each((t,n)=>{var i=$(n).data("toolClass");e instanceof i?$(n).addClass("g-active"):$(n).removeClass("g-active")})},N.prototype._afterFlagChangeEvent=function(e){e.node instanceof r.GPage&&e.flag===r.GNode.Flag.Active&&!this._document.getEditor().hasSelection()&&this._updateFromToolOrSelection()},N.prototype._afterInsertEvent=function(e){(e.node instanceof r.GPage||e.node instanceof r.GAnnotationsList)&&this._updatePropertyPanels(!0)},N.prototype._afterRemoveEvent=function(e){(e.node instanceof r.GPage||e.node instanceof r.GAnnotationsList)&&this._updatePropertyPanels(!0)},N.prototype.relayout=function(e){this._annotationPanels.forEach(t=>t.properties instanceof v&&t.properties.relayout(e))},N.prototype._updateSelection=function(){const e=this._document&&this._document.getEditor();if(e){var t=this._document.getScene().getActivePage();if(this._page=t,this._elements=e.getSelection(),this._elements&&this._elements.length){if(this._elements.find(e=>!(e.hasMixin(r.GAnnotation)||e instanceof r.GPage)))return this._elements=[],console.warn("deactivating annotations"),void gDesigner.getRightSidebars().setActiveSidebar(m.ID);this._elements=this._elements.filter(e=>e.hasMixin(r.GAnnotation))}if(!this._elements||0===this._elements.length){var n=gDesigner.getToolManager().getActiveTool();if(n instanceof o.GItemTool){var i=n.getDefaultStyle();i&&(this._elements=[i])}}this._elements||(this._elements=[])}},N.prototype._selectionChangedEvent=function(e){this._updateSelection(),this._updatePropertyPanels(!1,!1,!1)},N.prototype._updateFromToolOrSelection=function(e){this._updateSelection(),this._updatePropertyPanels(!0===e,e instanceof o.GToolManager.ToolChangedEvent&&!(e.newTool instanceof o.GPointerTool))},N.prototype._updateAnnotationArray=function(){var e,t,n=!1,i=!1;this._panelsContainer?i=!0:(this._panelsContainer=$("<div></div>").addClass("panels").appendTo(this._htmlElement),$("<div></div>").addClass("fixed-panels").appendTo(this._panelsContainer),$("<div></div>").addClass("scrolling-panels").appendTo(this._panelsContainer)),e=this._panelsContainer.find(".fixed-panels"),t=this._panelsContainer.find(".scrolling-panels");var o=function(e,i){var o,a,s=$("<div></div>").css("display","none").addClass("properties-panel");$("<hr/>");if(e instanceof y){o=e;var l=$("<div></div>").addClass("annotations-property-panel");o.init(l,this._annotationToolbar);var c=$("<div></div>").css("display","none");e instanceof b&&c.append($("<div></div>").addClass("arrow-top").css("right",(gDesigner.isTouchEnabled()?N.ANNOTATION_PROPERTIES_ARROW_POSITION_TOUCH[i]:N.ANNOTATION_PROPERTIES_ARROW_POSITION[i])+"%")),this._annotationsToolbarPanel.append(c),this._annotationsToolbarPanel.append(l),a=this._annotationToolbar,s=l,this._annotationProperties.push({panel:s,toolbar:a,properties:o,topArrow:c})}else{if(a=$("<div></div>").addClass("annotations-page-toolbar toolbar"),o=new v,s.appendTo(t),o.init(s,a,this._active,this._showResolved,this._updatePropertyPanels.bind(this),function(e){this._currentAnnotations=e}.bind(this)),""!==a.html()?a.insertBefore(s):a=null,this._currentAnnotations){let t,i,o=e.getAnnotations();t=r.GNode.store(o);let a=!1;if(o.restored?i=w.findAnnotationsListForPage(e,this._currentAnnotations):(i=this._currentAnnotations.find(e=>e["@id"]===t["@id"]),a=!0),i&&!r.GUtil.equals(t,i,!0)){let t=r.GNode.restore(i);if(t){let i=e.getAnnotations(),o=t.getChildren()||[];if(t.clearChildren(),a&&i.getProperty("aid")!==t.getProperty("aid")){i.setProperty("aid",t.getProperty("aid")),i.clearChildren();for(let e=0;e<o.length;e++)i.appendChild(o[e]);n=!0}else{let e=w.mergeAnnotations(i,i.getChildren(),t,o);n=n||e}}}}o.setPage(e),this._annotationPanels.push({panel:s,toolbar:a,properties:o})}}.bind(this);if(!i){this._sidebarTitle.appendTo(e),this._annotationToolbar.appendTo(e),this._annotationsToolbarPanel.appendTo(e);for(var a=0;a<N.ANNOTATION_PROPERTIES.length;a++)o(N.ANNOTATION_PROPERTIES[a],a)}if(this._document){for(a=this._annotationPanels.length-1;a>=0;a--){var s=this._annotationPanels[a];s.properties.setPage(null),s.panel&&s.panel.remove(),s.toolbar&&s.toolbar.remove(),s.divider&&s.divider.remove()}this._annotationPanels=[],this._document.getScene().iteratePages(e=>{o(e)},!0)}return n},N.prototype._updateToolbarButtons=function(){this._annotationProperties.forEach((e,t)=>{const{topArrow:n,properties:i}=e;if(i instanceof b){const e=gDesigner.isTouchEnabled()?N.ANNOTATION_PROPERTIES_ARROW_POSITION_TOUCH:N.ANNOTATION_PROPERTIES_ARROW_POSITION;n.find(".arrow-top").css("right",e[t]+"%")}})},N.prototype._updatePropertyPanels=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._updatingPropertyPanels)return;this.updateNotificationOption(),this._updatingPropertyPanels=!0;const i=()=>{let i=!1;try{e&&(i=this._updateAnnotationArray());var o=this._annotationProperties.concat(this._annotationPanels),a=this._annotationToolbar.find(".indicator");a.css("visibility","hidden");for(var s=0;s<o.length;++s){var l=o[s],c=l.properties,d=c.isAvailable(this._transformMode);if(d)if(c instanceof b||c instanceof G)l.panel.show(),(d=l.properties.update(this._document,this._elements,gDesigner.getToolManager().getActiveTool()))||l.panel.hide();else{var u=c.getPage().getAnnotations().getChildren();d=l.properties.update(this._document,u,t),n&&l.properties.relayout()}if(l.toolbar&&l.toolbar!==this._annotationToolbar)l.toolbar.css("display",d?"":"none"),c instanceof G||(d?(l.toolbar.gAccordion("toggleOpen",c.getPage().hasFlag(r.GNode.Flag.Active)),l.toolbar.gAccordion("init",l.panel,"label",null,"annotations"),c.getPage().hasFlag(r.GNode.Flag.Active)?l.panel.addClass("g-active"):l.panel.removeClass("g-active")):l.panel.css("display","none"));else if(l.panel.css("display",d?"":"none"),l.topArrow.css("display",d?"":"none"),d&&!(c instanceof G)){let e=this._annotationToolbar.find("."+c._toolbarIcon);a.css("left",e.position().left+e.width()/2-6),a.css("visibility","visible")}d&&this._annotationsToolbarPanel.css("display","")}this._document||(this._annotationPanels=[])}finally{this._updatingPropertyPanels=!1}return i};!this._currentAnnotations&&this._document&&this._document.getAnnotationsId()?w.getCloudAnnotationsForDocument(this._document).then(e=>{let t=!1;if(this._document&&this._document.getAnnotationsId()!==e.cid)return this._updatingPropertyPanels=!1,t;if(this._currentAnnotations=e.annotationsCollection,t=i(),t){let t=this._document.getScene();t&&t.setLastTimeAnnotationsFromCloudModified(e.lastUpdateTime),gDesigner.notifyDocumentModified(this._document),this._active?this._activateAnnotations():this.trigger(h.UPDATE_EVENT)}}).catch(e=>{!this._active||e instanceof C&&e.cid&&this._document&&this._document.getAnnotationsId()!==e.cid?this._updatingPropertyPanels=!1:(this._currentAnnotations=[],i())}):i()},N.prototype.updateBadge=function(e){var t={unread:0,total:0},n=this._annotationPanels.map(e=>e.properties.getPage()),i=this._document&&(this._document.isCloudFile()||this._document.isExternalFile());if(D&&!this._active){var o=gDesigner.getSyncUser();if(i){if(this._currentAnnotations){n.map(e=>w.findAnnotationsListForPage(e,this._currentAnnotations)).filter(e=>!!e).forEach((function(e){e.$&&e.$.forEach((function(e){var n=w.isOwner(o,e);e.rsv||(e.$&&0!=e.$.length?(e.$.forEach((function(e){"cmt"==e["@"]&&(o&&o.getUID()!==e.uid&&e.type!==r.GComment.Type.Close&&!(e.read||[]).includes(o.getUID())&&t.unread++,t.total++)})),n||(e.read||[]).includes(o.getUID())||t.unread++,t.total++):(n||(e.read||[]).includes(o.getUID())||t.unread++,t.total++))}))}))}}else if(this._localAnnotations){n.map(e=>w.findAnnotationsListForPage(e,this._localAnnotations)).filter(e=>!!e).forEach((function(e){for(var n=e.getFirstChild();null!==n&&n.hasMixin(r.GAnnotation);n=n.getNext()){var i=w.isOwner(o,n);if(!n.getProperty("rsv"))if(n.getChildren().length>0){for(var a=n.getFirstChild();null!==a&&a instanceof r.GComment;a=a.getNext())o&&o.getUID()!==a.getProperty("uid")&&a.getProperty("type")!==r.GComment.Type.Close&&!(a.getProperty("read")||[]).includes(o.getUID())&&t.unread++,t.total++;i||(n.getProperty("read")||[]).includes(o.getUID())||t.unread++,t.total++}else i||(n.getProperty("read")||[]).includes(o.getUID())||t.unread++,t.total++}}))}}return t.total>0&&(e.text(t.total),t.unread>0?e.addClass("new"):e.removeClass("new")),!!t.total},N.prototype.isAnnotationPropertiesEditing=function(){return this._annotationProperties.some(e=>{let{properties:t}=e;return t.isEditing&&t.isEditing()||!1})},N.prototype.updateNotificationOption=function(){const e=this._optionsToolbar.find(".notification-label").closest(".columns");this._document&&this._document.isCloudFile()?(e.removeAttr("data-title"),e.toggleClass("g-disabled",!1)):(e.attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.save-file-tip"))),e.toggleClass("g-disabled",!0))},N.prototype.toString=function(){return"[Object GAnnotationsSidebar]"},N.prototype._createHoverNotificationFrag=function(){let e=$("<div>").addClass("g-menu hover-notification-container").html(r.GLocale.get(new r.GLocaleKey("GAnnotationsSidebar","text.hover-notification")));return e.find("span").addClass("highlight").click(()=>{(new u).then(e=>e.open())}),e},N.prototype._openHoverNotification=function(e){let t=this._createHoverNotificationFrag(),n=$("body").find(".g-annotation-sidebar-notification-menu")[0];if(t.appendTo($("body")),document.addEventListener("click",this._removeHoverNotificationFrag),n&&(n.addEventListener("mouseenter",(function(){let e=$("body").find(".hover-notification-container");e.length&&$(e[0]).css("display","block")})),n.addEventListener("mouseleave",(function(){let e=$("body").find(".hover-notification-container");e.length&&setTimeout((function(){$(e[0]).css("display","none")}),250)})),$(n).find("li").map((e,t)=>{t.addEventListener("mousedown",(function(){let e=$("body").find(".hover-notification-container");e.length&&$(e[0]).css("display","none")}))})),t.parent().is("body")){var i=t.outerWidth(),o=t.outerHeight(),r=$(window).width(),a=$(window).height(),s={x:0,y:0,width:0,height:0},l=$(e),c=l.offset();s.x=c.left,s.y=c.top,s.width=l.outerWidth(),s.height=l.outerHeight();var d=0;(d=s.x+s.width)+i>r&&(d=s.x-i);var u=0;(u=s.y+s.height)+o>a&&(u=s.y-o);const n=this._rangeLeftX?this._rangeLeftX:0;d<n&&(d=n);const p=this._rangeRightX?this._rangeRightX:r;d+i>=p&&(d=p-i);const g=this._rangeLeftY?this._rangeLeftY:0;u<g&&(u=g);const h=this._rangeRightY?this._rangeRightY:a;u+o>=h&&(u=h-o);const f=u-o-10;t.css("left",d),t.css("top",f),t.addClass("g-menu-right g-menu-bottom")}},N.prototype._removeHoverNotificationFrag=function(){let e=$("body").find(".hover-notification-container");e.length&&(e.remove(),document.removeEventListener("click",this._removeHoverNotificationFrag))},e.exports=N},function(e,t,n){var i=n(567);e.exports=function(e,t){return new(i(e))(0===t?0:t)}},function(e,t,n){var i=n(38),o=n(159),r=n(73),a=i("unscopables"),s=Array.prototype;null==s[a]&&r.f(s,a,{configurable:!0,value:o(null)}),e.exports=function(e){s[a][e]=!0}},,,function(e,t){e.exports=require("url")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},,,,,,,,,,,,,function(e,t,n){"use strict";n(129),n(14),n(29),n(28);var i=n(1),o=n(971),r=n(341);function a(e){r.call(this,e)}i.GObject.inherit(a,r);var s=i.GUtil.uuid(),l={},c=null,d=[{family:"Open Sans",fonts:[{weight:i.GFont.Weight.Light,style:i.GFont.Style.Normal,url:"assets/font/OpenSans-Light.ttf"},{weight:i.GFont.Weight.Light,style:i.GFont.Style.Italic,url:"assets/font/OpenSans-LightItalic.ttf"},{weight:i.GFont.Weight.Regular,style:i.GFont.Style.Normal,url:"assets/font/OpenSans-Regular.ttf"},{weight:i.GFont.Weight.Regular,style:i.GFont.Style.Italic,url:"assets/font/OpenSans-Italic.ttf"},{weight:i.GFont.Weight.SemiBold,style:i.GFont.Style.Normal,url:"assets/font/OpenSans-SemiBold.ttf"},{weight:i.GFont.Weight.SemiBold,style:i.GFont.Style.Italic,url:"assets/font/OpenSans-SemiBoldItalic.ttf"},{weight:i.GFont.Weight.Bold,style:i.GFont.Style.Normal,url:"assets/font/OpenSans-Bold.ttf"},{weight:i.GFont.Weight.Bold,style:i.GFont.Style.Italic,url:"assets/font/OpenSans-BoldItalic.ttf"},{weight:i.GFont.Weight.ExtraBold,style:i.GFont.Style.Normal,url:"assets/font/OpenSans-ExtraBold.ttf"},{weight:i.GFont.Weight.ExtraBold,style:i.GFont.Style.Italic,url:"assets/font/OpenSans-ExtraBoldItalic.ttf"}],preview:"assets/font/OpenSans.svg",scripts:["LATIN"]}];d.push({family:"Noto Sans CJK SC",fonts:[{weight:i.GFont.Weight.Regular,style:i.GFont.Style.Normal,url:"assets/font/chinese-simplified/NotoSansCJKsc-Regular.otf"},{weight:i.GFont.Weight.Bold,style:i.GFont.Style.Normal,url:"assets/font/chinese-simplified/NotoSansCJKsc-Bold.otf"}],preview:"assets/font/chinese-simplified/NotoSans.svg",scripts:["HAN"]}),d.push({family:"Noto Sans CJK TC",fonts:[{weight:i.GFont.Weight.Regular,style:i.GFont.Style.Normal,url:"assets/font/chinese-traditional/NotoSansCJKtc-Regular.otf"},{weight:i.GFont.Weight.Bold,style:i.GFont.Style.Normal,url:"assets/font/chinese-traditional/NotoSansCJKtc-Bold.otf"}],preview:"assets/font/chinese-traditional/NotoSans.svg",scripts:["HAN"]}),d=d.concat(o),i.GObject.inherit(a,r),a.prototype.getDefaultFamilyForString=function(e){var t=i.GOpenTypeFont.getScriptForString(e);if("CYRILLIC"===t||"GREEK"===t)return"Noto Sans";var n=d.find(e=>e.scripts&&e.scripts.indexOf(t)>=0);return n&&n.family||null},a.prototype.addPreviews=function(e){for(var t=new DOMParser,n=0;n<e.length;n++)e[n].cachedPreview||(e[n].addPreviewCallback=function(e){var n=new XMLHttpRequest;n.open("GET",this.preview),n.onload=function(){var n;if(this.status>=200&&this.status<300)try{(n=t.parseFromString(this.response,"image/svg+xml").firstChild)&&n.getAttribute("xmlns")&&(n.setAttribute("height","20px"),e(n))}catch(e){"undefined"!=typeof gdb_loaddesign&&console.warn("Couldn't parse default preview")}},n.send()})},a.prototype.init=function(){c||(c=d)},a.prototype.load=function(e,t,n,i){this.init(),i.done(c.filter((function(t){return e.indexOf("%")>=0?t.family.toLowerCase().startsWith(e.replace(/%/g,"")):t.family.toLowerCase()==e.toLowerCase()})).slice(t,t+n),!0,null)},a.prototype.getTotalFonts=function(e){return this.init(),e?c.filter(this._searchFilter(e)).length:c.length},a.prototype.hasFont=function(e){var t=!1;if(d)for(var n=0;n<d.length;++n)if(d[n].family===e){t=!0;break}return t},a.prototype.resolveFont=function(e,t,n,o){this.init();for(var a=0;a<c.length;a++){var s=c[a];if(s.family===e)for(var d=s.fonts,u=0;u<d.length;u++){var p=d[u];if(p.weight===(n||400)&&p.style===(t||i.GFont.Style.Normal)){if(l[p.url])l[p.url].push(o);else{var g=new XMLHttpRequest;g.responseType="arraybuffer",g.open("GET",p.url),l[p.url]=[],l[p.url].push(o),g.onload=function(){if(this.status>=200&&this.status<300){var e=l[p.url];delete l[p.url],e.forEach(e=>{e.done(this.response)})}},g.onerror=()=>{delete l[p.url],o.fail(r.Errors.ConnectionError)},g.send()}return}}}o.fail()},a.prototype.getProviderId=function(){return s},e.exports=a},function(e,t,n){"use strict";function i(){}n(25),Object.assign(i,{SETUP:{ENDPOINT:"SETUP_URL_ENDPOINT"},COMMAND_SAVE:{REQUEST:"SAVE_REQUEST",SUCCESS:"SAVE_SUCCESS",FAILED:"SAVE_FAILED"},COMMAND_SYNC_IMAGES:{REQUEST:"sync-images",SUCCESS:"dictionary-updated"},CODES:{AUTOSAVE_CLOUD_SYNCHRONIZM_NOT_AVAILABLE:"AUTOSAVE_CLOUD_SYNCHRONIZM_NOT_AVAILABLE",AUTOSAVE_LOCAL_FILES_WITHOUT_CID_NOT_AVAILABLE:"AUTOSAVE_LOCAL_FILES_WITHOUT_CID_NOT_AVAILABLE",AUTOSAVE_OFFLINE_NOT_AVAILABLE:"AUTOSAVE_OFFLINE_NOT_AVAILABLE",AUTOSAVE_ALREADY_SAVING:"AUTOSAVE_ALREADY_SAVING",AUTOSAVE_NOT_MODIFIED:"AUTOSAVE_NOT_MODIFIED",AUTOSAVE_FILE_CONFLICT:"AUTOSAVE_FILE_CONFLICT"}}),e.exports=i},function(e,t,n){"use strict";function i(e,t){this.description=e,this.cid=t}n(262),i.description=null,i.cid=null,e.exports=i},function(e,t,n){"use strict";function i(e){return pako.gzip(e,{level:9}).buffer}Object.defineProperty(t,"__esModule",{value:!0}),t.gzip=i,t.hasRootFolderInSelections=function(e,t){if(!e||!(t||[]).length)return!1;t instanceof Array||(t=[t]);return t.some(t=>e.isRootFolder(t))},t.readResponseWithProgress=async function(e,t,n){const o=e.body.getReader(),r=parseInt(e.headers.get("Content-Length"))||0;let a=0;return new Promise(e=>{const s=new ReadableStream({start:l=>function c(){return o.read().then(d=>{let{done:u,value:p}=d;if(u)return l.close(),o.releaseLock(),void e(s);if("function"==typeof t){a+=function(e){if(n)return new Uint8Array(i(e)).length;return e.length}(p);const e=Math.floor(a/r*100);t(e)}return l.enqueue(p),c()})}()})}).then(e=>new Response(e))},n(9),n(45),n(19),n(158),n(201),n(166),n(167)},function(e,t,n){"use strict";n.r(t);class i extends Error{constructor(...e){super(...e),this.constructor=i,this.__proto__=i.prototype,this.name="GError"}toString(){return"[Object GError]"}}t.default=i},function(e,t,n){"use strict";n(25),n(9);var i=n(12);function o(e){const{accessToken:t,expires:n,corporate:i,accountId:r}=new o.Settings(e);this.accessToken=t,this.expires=n,this.corporate=i,this.accountId=r}o.Settings=function(e){e||(e={});const{accessToken:t,expires:n,corporate:i=!0,accountId:o}=e;return Object.assign(this,{accessToken:t,expires:n,corporate:i,accountId:o})},o.prototype.isExpired=function(){return!this.expires||(new Date).getTime()>this.expires},o.prototype.getSettings=function(){return{accessToken:this.accessToken,expires:this.expires,corporate:this.corporate,accountId:this.accountId}},o.prototype.get=async function(){return this.isExpired()?this.corporate?i.gApi.cloudServices.googleDrive.getAccessToken().then(e=>{let{accessToken:t,expires:n}=e;return this.expires=n,this.accessToken=t,this.accessToken}):gContainer.getGoogleAPI().getRefreshToken().then(e=>{let{accessToken:t,expires:n}=e;return this.expires=n,this.accessToken=t,this.accessToken}):this.accessToken},e.exports=o},function(e,t,n){"use strict";var i=n(47),o=n(22),r=n(406),a=o([].reverse),s=[1,2];i({target:"Array",proto:!0,forced:String(s)===String(s.reverse())},{reverse:function(){return r(this)&&(this.length=this.length),a(this)}})},,,,,,,function(e,t,n){"use strict";var i=n(1);function o(e){this.license=e}i.GObject.inherit(o,i.GEvent),o.prototype.license=null,e.exports=o},function(e,t,n){"use strict";n(3);var i=n(1),o=n(1378),r=n(36),a=n(400),s=n(77);function l(e){this._htmlElement=e,this._windows=[]}i.GObject.inherit(l,i.GEventTarget),l.WindowEvent=function(e,t,n){this.type=e,this.window=t,this.index=n},i.GObject.inherit(l.WindowEvent,i.GEvent),l.WindowEvent.Type={Added:0,Removed:1,Deactivated:10,Activated:11},l.WindowEvent.prototype.type=null,l.WindowEvent.prototype.window=null,l.WindowEvent.prototype.index=null,l.WindowEvent.prototype.toString=function(){return"[Object GWindows.WindowEvent]"},l.prototype._htmlElement=null,l.prototype._windows=null,l.prototype._activeWindow=null,l.prototype._viewOffset=null,l.prototype.getWindows=function(){return this._windows},l.prototype.getActiveWindow=function(){return this._activeWindow},l.prototype.activateWindow=function(e,t){if(e!==this._activeWindow){this._activeWindow&&(this._activeWindow.deactivate(),this._activeWindow._container.detach()),null===e?gDesigner.activateDocument(null,!0):(e&&this._activeWindow&&e.getDocument()!==this._activeWindow.getDocument()||!this._activeWindow)&&gDesigner.activateDocument(e.getDocument(),!0);var n=this._activeWindow;this._activeWindow=e,n&&this.hasEventListeners(l.WindowEvent)&&this.trigger(new l.WindowEvent(l.WindowEvent.Type.Deactivated,n)),e&&(e.getDocument()._activeWindow=e,this._htmlElement.append(e._container),this._relayoutWindow(e,t),this._activeWindow.activate(t),this.hasEventListeners(l.WindowEvent)&&this.trigger(new l.WindowEvent(l.WindowEvent.Type.Activated,e)))}},l.prototype.addWindow=function(e,t,n){var i=e instanceof o?e.getDocument():e,r=this._addWindow(i,t,n);if(e instanceof o){var a=e.getView();r.getView()&&r.getView().transform(a.getScrollX(),a.getScrollY(),a.getZoom())}return r},l.prototype.removeWindow=function(e,t,n,o){var c=e.getDocument(),d=function(n){if(!n||n.documentStatus!==s.SaveCancelled){if(e===this._activeWindow){var i=this._windows.indexOf(e);i>0?this.activateWindow(this._windows[i-1],o):i+1<this._windows.length?this.activateWindow(this._windows[i+1],o):this.activateWindow(null)}c._activeWindow===e&&(c._activeWindow=null),c._windows.splice(c._windows.indexOf(e),1),this._windows.splice(this._windows.indexOf(e),1),e._container.remove(),this.hasEventListeners(l.WindowEvent)&&this.trigger(new l.WindowEvent(l.WindowEvent.Type.Removed,e)),e.release(),t&&t(),0===c._windows.length&&gDesigner.removeDocument(c)}}.bind(this);n?d():c.isSynchronizing()?r.alert(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.please-wait-avoid-losing-progress"))):1===c._windows.length&&c.isModified()?gDesigner.canUnloadDocument(c).then(e=>{e?d():(gDesigner.stats("action_execute_windowalert",a.ID),gDesigner.executeAction(a.ID,[c,d],void 0,!0))}).catch(e=>{e&&!e.documentStatus&&console.log(e)}):d()},l.prototype.init=function(){},l.prototype.relayout=function(e){this._viewOffset=e||this._viewOffset,this._activeWindow&&this._relayoutWindow(this._activeWindow)},l.prototype._relayoutWindow=function(e,t){e.relayout(this._htmlElement.width(),this._htmlElement.height(),this._viewOffset,t)},l.prototype._addWindow=function(e,t,n){var i=new o(e,t);return e._windows.push(i),"number"==typeof n?this._windows.splice(n,0,i):this._windows.push(i),this.hasEventListeners(l.WindowEvent)&&this.trigger(new l.WindowEvent(l.WindowEvent.Type.Added,i,n)),this.activateWindow(i),i},l.prototype.getHtmlElement=function(){return this._htmlElement},l.prototype.getWindow=function(e){for(var t=null,n=0;n<this._windows.length;++n)if(this._windows[n].getDocument()===e){t=this._windows[n];break}return t},e.exports=l},function(e,t,n){"use strict";n(9),n(58);var i=n(1);const o=n(1379),r=n(1380),a=n(1381),s=n(1046),l=n(718),{gApi:c}=(n(175),n(12));function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._user=e,this._options=n,this._init(t,n)}i.GObject.inherit(d,i.GObject),d.prototype._options=null,d.prototype._avatar=null,d.Tabs={Account:"account",Purchase:"purchase",ChangePassword:"change-password"},d.prototype._init=async function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{closeable:l=!0,tabs:u}=n,p=gDesigner.getLicense();this._dialog=$("<div></div>").gDialog({closeCallback:()=>this._close(),releaseOnClose:!0,className:"g-profile-dialog"}),l&&$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",this.close.bind(this)).appendTo(this._dialog);let g=$("<div></div>").addClass("left-sidebar").appendTo(this._dialog),h=$("<div></div>").addClass("right-sidebar").appendTo(this._dialog);this._avatar=$("<div></div>").addClass("avatar").append($("<span></span>").addClass("btn gravit-icon-avatar").attr("data-title",i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.avatar-tooltip"))).on("click",this._updateAvatar.bind(this))),$("<div></div>").addClass("picture").append(this._avatar).appendTo(g);let f=$("<div></div>").addClass("header").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.details")))).appendTo(h);this._messageHandler=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";t._dialog.find(".message").remove(),e&&$("<div></div>").addClass("message "+n).append($("<span></span>").html(e)).on("click",e=>$(e.target).closest(".message").remove()).insertAfter(f)},this._tabs=$("<ul></ul>").addClass("tabs").appendTo(g),this._panels=$("<div></div>").addClass("tab-panels").appendTo(h);const m=(e,n,i,o)=>{let r=$("<div></div>").addClass("tab-panel").append(i).appendTo(this._panels);$("<li></li>").attr("id",o).addClass("tab").append($("<span></span>").addClass(n)).append($("<span></span>").text(e)).on("click",(function(n){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=$(n.target).closest(".tab");i||t._messageHandler(void 0),t._tabs.find(".tab.g-selected").removeClass("g-selected"),t._panels.find(".tab-panel.g-selected").removeClass("g-selected"),r.addClass("g-selected"),o.addClass("g-selected"),f.find("span").text(e),gDesigner.stats("profile-dialog_tab_".concat(o.attr("id")))})).appendTo(this._tabs)},y=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return u&&u.length?u.includes(e):t};if(y(d.Tabs.Account)&&m(i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.details")),"gravit-icon-account",new r(this._user,this._messageHandler.bind(this),this,n).getHTMLElement(),d.Tabs.Account),y(d.Tabs.ChangePassword,!1)&&m(i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.change-password")),"gravit-icon-change-password",new a(this._user,this._messageHandler.bind(this),this,n).getHTMLElement(),d.Tabs.ChangePassword),y(d.Tabs.Purchase)){await c.hasPurchases({issued:"true"}).catch(()=>!1)&&m(i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.purchases")),"gravit-icon-purchase",new o(this._user,this._messageHandler.bind(this),n).getHTMLElement(),d.Tabs.Purchase)}if(this._tabs.find(".tab:first-child").trigger("click",[!0]),e&&(gDesigner.stats("profile-dialog_tab_".concat(e)),this._tabs.find("#".concat(e)).trigger("click",[!0])),!gDesigner.isAnonymous()&&(!p.isPro()||p.isExpired())){const e=gDesigner.getAction(s.ID);e&&e.isVisible()&&e.isAvailable()&&this._tabs.append($("<button/>").addClass("purchase-pro-btn").html(i.GLocale.get(new i.GLocaleKey("GPurchaseProAction","title"))).on("click",(function(){gDesigner.stats("profile-dialog_click_purchase-pro"),gDesigner.executeAction(s.ID,null,null,!0)})))}this._updateUI(this._user)},d.prototype._updateAvatar=function(){gDesigner.stats("profile-dialog_click_update-avatar");let e=this._dialog.find(".avatar");function t(t){e.removeClass("g-loading");let n=i.GLocale.get(new i.GLocaleKey("GAccountPanel","text.error"));t&&t.message?n=t.message:t&&t.errors&&(n=t.errors.map(e=>e[1]).join("<br>")),this._messageHandler(n)}gDesigner.getDefaultStorage().openPrompt([{ext:"png",mime:"image/png"},{ext:"jpg",mime:"image/jpeg"},{ext:"jpeg",mime:"image/jpeg"}],n=>{e.addClass("g-loading"),n.read(o=>{if(o.byteLength>102400)return void t.call(this,{message:i.GLocale.get(new i.GLocaleKey("GProfileDialog","text.avatar-size-too-big"))});let r=n.getExtension().toLowerCase();"jpg"===r&&(r="jpeg");let a=new File([new Blob([o],{type:"image/"+r})],n.getFullName());this._messageHandler(void 0),gDesigner.getCloudCommunicationManager().updateAvatar(a).then(t=>{e.removeClass("g-loading"),e.find(".picture").css("background-image","url(".concat(t.avatar,")")),e.find(".picture").removeClass("g-profile-top-avatar"),e.find(".picture").css({"background-color":"transparent"}),e.find(".picture").text(""),gDesigner.getUser()}).catch(t)})},!1)},d.prototype._userPropertiesChangedEvent=function(e){this._updateUI(e.user)},d.prototype._updateUI=function(e){this._avatar&&(this._avatar.find(".picture").remove(),e.hasOwnPictureAvatar()?this._avatar.append($("<div/>").addClass("picture").css("background-image","url(".concat(e.avatar,")"))):this._avatar.append($("<div/>").addClass("picture").addClass("g-profile-top-avatar").css({"background-color":e.getUserColor()}).text(e.getUserNameInitials())))},d.prototype.open=function(){gDesigner.addEventListener(l,this._userPropertiesChangedEvent,this),this._dialog.gDialog("open",this._options.closeable)},d.prototype.close=function(){this._dialog.gDialog("close")},d.prototype._close=function(){gDesigner.removeEventListener(l,this._userPropertiesChangedEvent,this)},e.exports=d},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173)],void 0===(r="function"==typeof(i=function(e){return e.ui=e.ui||{},e.ui.version="1.13.0"})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){"use strict";n(3);var i=n(1),o=n(353);function r(){o.call(this)}i.GObject.inherit(r,o),r.prototype.init=function(e){},r.prototype.activate=function(){},r.prototype.deactivate=function(){},r.prototype.isEnabled=function(){return!0},r.prototype.toString=function(){return"[Object GPanel]"},e.exports=r},function(e,t,n){"use strict";e.exports={FillPropertiesPanel:"fill-properties-panel",BorderPropertiesPanel:"border-properties-panel",EffectPropertiesPanel:"effect-properties-panel"}},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(94),l=n(36);function c(){c.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/symbols/"})}}i.GObject.inherit(c,s),c.ID="modify.createsymbol",c.TITLE=new i.GLocaleKey("GCreateSymbolAction","title"),c.SHORTCUT=[o.GKey.Constant.F8],c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return a.CATEGORY_MODIFY_SYMBOL},c.prototype.getGroup=function(){return"structure/modify"},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-create-symbol":"gravit-icon-symbolmaster"},c.prototype.getShortcut=function(){return c.SHORTCUT},c.prototype.isPro=function(){if(!gDesigner.isEnabledProFeatures()){const e=gDesigner.getActiveDocument();if(e){const t=e.getEditor().getIndividualSelection();if(t&&t.length)return t.filter(e=>e instanceof i.GSymbol).length>1}}return!1},c.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t&&t.length)for(var n=0,o=new i.GSymbol,r=t.length-1;r>=0;--r){var a=t[r];if(a instanceof i.GSymbol&&!a.getMasterSymbol()||a.validateInsertion(o)&&!a.getParent().isLocked()&&o.validateInsertion(a.getParent())&&!i.GSymbol.containsUnsupportedNodes(a)){if(!(a instanceof i.GSymbol&&a.isMaster()))return!0;if(++n>1)return!0}}}return!1},c.prototype.execute=function(){if(!this.isPro()||gDesigner.isEnabledProFeatures()){var e=1,t=i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","createsymbol.defaultname")),n=t+" "+e,o=gDesigner.getActiveDocument();if(o){var r=o.getScene();if(r)(r.getSymbols()||[]).forEach((function(o){o instanceof i.GSymbol&&o.isMaster()&&o.getProperty("name")===n&&(e++,n=t+" "+e)})),l.prompt(i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","createsymbol.enternewname")),e=>{if(gDesigner.getActiveDocument()&&e){var t=gDesigner.getActiveDocument().getEditor(),n=i.GNode.order(t.getIndividualSelection().slice());t.beginTransaction();try{for(var o=new i.GSymbol,r=null,a=n.length-1;a>=0;--a){var s=n[a];if(s instanceof i.GSymbol&&s.convertToMaster(e))n.splice(a,1);else if(s.validateInsertion(o)&&!i.GSymbol.containsUnsupportedNodes(s)){if(!(r=s.getParent()).isLocked()&&o.validateInsertion(r))break;r=null}}r&&t.updateSelection(!1,[i.GSymbol.create(n,r,e)])}finally{t.commitTransaction(i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","title")))}}},n)}}else gDesigner.handlePROFeatureInterruption()},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GCreateSymbolAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1),o=n(43);const r=n(18),a=n(94);function s(e,t){a.call(this),this._id=e,this._title=t}i.GObject.inherit(s,a),s.EmptyValue={},s.EmptyPattern={},s.prototype._id=null,s.prototype._title=null,s.prototype.getId=function(){return this._id},s.prototype.getTitle=function(){return this._title},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_SELECT_SAME},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=t&&t.getSelection();if(!n||!n.length)return!1;return this._createPattern(n)!==s.EmptyPattern},s.prototype._createPattern=function(e){const t=e&&e.length;if(!t)return s.EmptyPattern;const n=this._getValue(e[0]);if(n===s.EmptyValue)return s.EmptyPattern;for(let i=1;i<t;i++){const t=e[i],o=this._getValue(t);if(o===s.EmptyValue)return s.EmptyPattern;if(!this._matches(n,o))return s.EmptyPattern}return n},s.prototype._matches=function(e,t){return e!==s.EmptyPattern&&(t!==s.EmptyPattern&&i.GUtil.equals(e,t,!0))},s.prototype._getValue=function(e){throw"Not implemented"},s.prototype.execute=function(){const e=gDesigner.getActiveDocument(),t=e&&e.getScene(),n=e&&e.getEditor(),r=n&&n.getSelection();if(!t||!r||!r.length)return;const a=this._createPattern(r);if(a===s.EmptyPattern)return;const l=[];t.accept(e=>{if(e instanceof i.GElement&&!e.hasMixin(i.GAnnotation)){const t=this._createPattern([e]);this._matches(a,t)&&l.push(e)}}),l.length>0&&o.GEditor.tryRunTransaction(t,()=>{n.updateSelection(!1,l)},i.GLocale.get(this.getTitle()))},s.prototype.toString=function(){return"[Object GSelectByAction]"},e.exports=s},function(e,t,n){var i=n(6),o=n(49),r=n(62),a=n(266),s=n(145),l=n(553),c=n(38),d=i.TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!r(e)||a(e))return e;var n,i=s(e,u);if(i){if(void 0===t&&(t="default"),n=o(i,e,t),!r(n)||a(n))return n;throw d("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},function(e,t,n){var i=n(6),o=n(49),r=n(34),a=n(62),s=i.TypeError;e.exports=function(e,t){var n,i;if("string"===t&&r(n=e.toString)&&!a(i=o(n,e)))return i;if(r(n=e.valueOf)&&!a(i=o(n,e)))return i;if("string"!==t&&r(n=e.toString)&&!a(i=o(n,e)))return i;throw s("Can't convert object to primitive value")}},function(e,t,n){var i=n(6),o=n(34),r=n(221),a=i.WeakMap;e.exports=o(a)&&/native code/.test(r(a))},function(e,t,n){var i=n(96),o=n(22),r=n(233),a=n(360),s=n(52),l=o([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(s(e)),n=a.f;return n?l(t,n(e)):t}},function(e,t,n){var i=n(178),o=n(273),r=n(109),a=function(e){return function(t,n,a){var s,l=i(t),c=r(l),d=o(a,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var i=n(6),o=n(34),r=i.String,a=i.TypeError;e.exports=function(e){if("object"==typeof e||o(e))return e;throw a("Can't set "+r(e)+" as a prototype")}},function(e,t,n){var i=n(6),o=n(110),r=n(49),a=n(52),s=n(179),l=n(276),c=n(109),d=n(125),u=n(222),p=n(183),g=n(362),h=i.TypeError,f=function(e,t){this.stopped=e,this.result=t},m=f.prototype;e.exports=function(e,t,n){var i,y,v,_,b,w,C,E=n&&n.that,S=!(!n||!n.AS_ENTRIES),G=!(!n||!n.IS_ITERATOR),A=!(!n||!n.INTERRUPTED),T=o(t,E),P=function(e){return i&&g(i,"normal",e),new f(!0,e)},L=function(e){return S?(a(e),A?T(e[0],e[1],P):T(e[0],e[1])):A?T(e,P):T(e)};if(G)i=e;else{if(!(y=p(e)))throw h(s(e)+" is not iterable");if(l(y)){for(v=0,_=c(e);_>v;v++)if((b=L(e[v]))&&d(m,b))return b;return new f(!1)}i=u(e,y)}for(w=i.next;!(C=r(w,i)).done;){try{b=L(C.value)}catch(e){g(i,"throw",e)}if("object"==typeof b&&b&&d(m,b))return b}return new f(!1)}},function(e,t,n){var i={};i[n(38)("toStringTag")]="z",e.exports="[object z]"===String(i)},function(e,t,n){var i,o,r,a,s,l,c,d,u=n(6),p=n(110),g=n(174).f,h=n(365).set,f=n(367),m=n(561),y=n(562),v=n(224),_=u.MutationObserver||u.WebKitMutationObserver,b=u.document,w=u.process,C=u.Promise,E=g(u,"queueMicrotask"),S=E&&E.value;S||(i=function(){var e,t;for(v&&(e=w.domain)&&e.exit();o;){t=o.fn,o=o.next;try{t()}catch(e){throw o?a():r=void 0,e}}r=void 0,e&&e.enter()},f||v||y||!_||!b?!m&&C&&C.resolve?((c=C.resolve(void 0)).constructor=C,d=p(c.then,c),a=function(){d(i)}):v?a=function(){w.nextTick(i)}:(h=p(h,u),a=function(){h(i)}):(s=!0,l=b.createTextNode(""),new _(i).observe(l,{characterData:!0}),a=function(){l.data=s=!s})),e.exports=S||function(e){var t={fn:e,next:void 0};r&&(r.next=t),o||(o=t,a()),r=t}},function(e,t,n){var i=n(130),o=n(6);e.exports=/ipad|iphone|ipod/i.test(i)&&void 0!==o.Pebble},function(e,t,n){var i=n(130);e.exports=/web0s(?!.*chrome)/i.test(i)},function(e,t,n){var i=n(6);e.exports=function(e,t){var n=i.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t){e.exports="object"==typeof window},function(e,t,n){"use strict";var i=n(374).forEach,o=n(312)("forEach");e.exports=o?[].forEach:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}},function(e,t,n){var i=n(6),o=n(406),r=n(277),a=n(62),s=n(38)("species"),l=i.Array;e.exports=function(e){var t;return o(e)&&(t=e.constructor,(r(t)&&(t===l||o(t.prototype))||a(t)&&null===(t=t[s]))&&(t=void 0)),void 0===t?l:t}},,,function(e,t,n){"use strict";var i=n(47),o=n(6),r=n(278),a=n(234),s=r.ArrayBuffer;i({global:!0,forced:o.ArrayBuffer!==s},{ArrayBuffer:s}),a("ArrayBuffer")},function(e,t,n){var i=n(6).Array,o=Math.abs,r=Math.pow,a=Math.floor,s=Math.log,l=Math.LN2;e.exports={pack:function(e,t,n){var c,d,u,p=i(n),g=8*n-t-1,h=(1<<g)-1,f=h>>1,m=23===t?r(2,-24)-r(2,-77):0,y=e<0||0===e&&1/e<0?1:0,v=0;for((e=o(e))!=e||e===1/0?(d=e!=e?1:0,c=h):(c=a(s(e)/l),e*(u=r(2,-c))<1&&(c--,u*=2),(e+=c+f>=1?m/u:m*r(2,1-f))*u>=2&&(c++,u/=2),c+f>=h?(d=0,c=h):c+f>=1?(d=(e*u-1)*r(2,t),c+=f):(d=e*r(2,f-1)*r(2,t),c=0));t>=8;p[v++]=255&d,d/=256,t-=8);for(c=c<<t|d,g+=t;g>0;p[v++]=255&c,c/=256,g-=8);return p[--v]|=128*y,p},unpack:function(e,t){var n,i=e.length,o=8*i-t-1,a=(1<<o)-1,s=a>>1,l=o-7,c=i-1,d=e[c--],u=127&d;for(d>>=7;l>0;u=256*u+e[c],c--,l-=8);for(n=u&(1<<-l)-1,u>>=-l,l+=t;l>0;n=256*n+e[c],c--,l-=8);if(0===u)u=1-s;else{if(u===a)return n?NaN:d?-1/0:1/0;n+=r(2,t),u-=s}return(d?-1:1)*n*r(2,u-t)}}},function(e,t,n){var i=n(27);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){"use strict";var i=n(97),o=n(273),r=n(109);e.exports=function(e){for(var t=i(this),n=r(t),a=arguments.length,s=o(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:o(l,n);c>s;)t[s++]=e;return t}},function(e,t,n){n(313)("Uint32",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},function(e,t,n){var i=n(6),o=n(27),r=n(363),a=n(185).NATIVE_ARRAY_BUFFER_VIEWS,s=i.ArrayBuffer,l=i.Int8Array;e.exports=!a||!o((function(){l(1)}))||!o((function(){new l(-1)}))||!r((function(e){new l,new l(null),new l(1.5),new l(e)}),!0)||o((function(){return 1!==new l(new s(2),1,void 0).length}))},function(e,t,n){var i=n(62),o=Math.floor;e.exports=Number.isInteger||function(e){return!i(e)&&isFinite(e)&&o(e)===e}},function(e,t,n){var i=n(6),o=n(578),r=i.RangeError;e.exports=function(e,t){var n=o(e);if(n%t)throw r("Wrong offset");return n}},function(e,t,n){var i=n(6),o=n(114),r=i.RangeError;e.exports=function(e){var t=o(e);if(t<0)throw r("The argument can't be less than 0");return t}},function(e,t,n){var i=n(110),o=n(49),r=n(364),a=n(97),s=n(109),l=n(222),c=n(183),d=n(276),u=n(185).aTypedArrayConstructor;e.exports=function(e){var t,n,p,g,h,f,m=r(this),y=a(e),v=arguments.length,_=v>1?arguments[1]:void 0,b=void 0!==_,w=c(y);if(w&&!d(w))for(f=(h=l(y,w)).next,y=[];!(g=o(f,h)).done;)y.push(g.value);for(b&&v>2&&(_=i(_,arguments[2])),n=s(y),p=new(u(m))(n),t=0;n>t;t++)p[t]=b?_(y[t],t):y[t];return p}},,,,function(e,t,n){var i=n(6),o=n(27),r=n(22),a=n(57),s=n(236).trim,l=n(227),c=r("".charAt),d=i.parseFloat,u=i.Symbol,p=u&&u.iterator,g=1/d(l+"-0")!=-1/0||p&&!o((function(){d(Object(p))}));e.exports=g?function(e){var t=s(a(e)),n=d(t);return 0===n&&"-"==c(t,0)?-0:n}:d},,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=require("child_process")},,,,,,function(e,t,n){"use strict";var i=n(280).charAt,o=n(57),r=n(99),a=n(378),s=r.set,l=r.getterFor("String Iterator");a(String,"String",(function(e){s(this,{type:"String Iterator",string:o(e),index:0})}),(function(){var e,t=l(this),n=t.string,o=t.index;return o>=n.length?{value:void 0,done:!0}:(e=i(n,o),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var i=n(6),o=n(110),r=n(49),a=n(97),s=n(615),l=n(276),c=n(277),d=n(109),u=n(616),p=n(222),g=n(183),h=i.Array;e.exports=function(e){var t=a(e),n=c(this),i=arguments.length,f=i>1?arguments[1]:void 0,m=void 0!==f;m&&(f=o(f,i>2?arguments[2]:void 0));var y,v,_,b,w,C,E=g(t),S=0;if(!E||this==h&&l(E))for(y=d(t),v=n?new this(y):h(y);y>S;S++)C=m?f(t[S],S):t[S],u(v,S,C);else for(w=(b=p(t,E)).next,v=n?new this:[];!(_=r(w,b)).done;S++)C=m?s(b,f,[_.value,S],!0):_.value,u(v,S,C);return v.length=S,v}},function(e,t,n){var i=n(52),o=n(362);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){o(e,"throw",t)}}},function(e,t,n){"use strict";var i=n(219),o=n(73),r=n(152);e.exports=function(e,t,n){var a=i(t);a in e?o.f(e,a,r(0,n)):e[a]=n}},function(e,t,n){"use strict";var i=n(6),o=n(22),r=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,s="Overflow: input needs wider integers to process",l=i.RangeError,c=o(a.exec),d=Math.floor,u=String.fromCharCode,p=o("".charCodeAt),g=o([].join),h=o([].push),f=o("".replace),m=o("".split),y=o("".toLowerCase),v=function(e){return e+22+75*(e<26)},_=function(e,t,n){var i=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;i+=36)e=d(e/35);return d(i+36*e/(e+38))},b=function(e){var t,n,i=[],o=(e=function(e){for(var t=[],n=0,i=e.length;n<i;){var o=p(e,n++);if(o>=55296&&o<=56319&&n<i){var r=p(e,n++);56320==(64512&r)?h(t,((1023&o)<<10)+(1023&r)+65536):(h(t,o),n--)}else h(t,o)}return t}(e)).length,r=128,a=0,c=72;for(t=0;t<e.length;t++)(n=e[t])<128&&h(i,u(n));var f=i.length,m=f;for(f&&h(i,"-");m<o;){var y=2147483647;for(t=0;t<e.length;t++)(n=e[t])>=r&&n<y&&(y=n);var b=m+1;if(y-r>d((2147483647-a)/b))throw l(s);for(a+=(y-r)*b,r=y,t=0;t<e.length;t++){if((n=e[t])<r&&++a>2147483647)throw l(s);if(n==r){for(var w=a,C=36;;C+=36){var E=C<=c?1:C>=c+26?26:C-c;if(w<E)break;var S=w-E,G=36-E;h(i,u(v(E+S%G))),w=d(S/G)}h(i,u(v(w))),c=_(a,b,m==f),a=0,++m}}++a,++r}return g(i,"")};e.exports=function(e){var t,n,i=[],o=m(f(y(e),a,"."),".");for(t=0;t<o.length;t++)n=o[t],h(i,c(r,n)?"xn--"+b(n):n);return g(i,".")}},function(e,t,n){var i=n(22),o=n(97),r=Math.floor,a=i("".charAt),s=i("".replace),l=i("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,d=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,n,i,u,p){var g=n+e.length,h=i.length,f=d;return void 0!==u&&(u=o(u),f=c),s(p,f,(function(o,s){var c;switch(a(s,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,n);case"'":return l(t,g);case"<":c=u[l(s,1,-1)];break;default:var d=+s;if(0===d)return o;if(d>h){var p=r(d/10);return 0===p?o:p<=h?void 0===i[p-1]?a(s,1):i[p-1]+a(s,1):o}c=i[d-1]}return void 0===c?"":c}))}},function(e,t,n){var i=n(6),o=n(27),r=n(22),a=n(57),s=n(236).trim,l=n(227),c=i.parseInt,d=i.Symbol,u=d&&d.iterator,p=/^[+-]?0x/i,g=r(p.exec),h=8!==c(l+"08")||22!==c(l+"0x16")||u&&!o((function(){c(Object(u))}));e.exports=h?function(e,t){var n=s(a(e));return c(n,t>>>0||(g(p,n)?16:10))}:c},function(e,t,n){var i=n(6),o=n(119),r=n(97),a=n(218),s=n(109),l=i.TypeError,c=function(e){return function(t,n,i,c){o(n);var d=r(t),u=a(d),p=s(d),g=e?p-1:0,h=e?-1:1;if(i<2)for(;;){if(g in u){c=u[g],g+=h;break}if(g+=h,e?g<0:p<=g)throw l("Reduce of empty array with no initial value")}for(;e?g>=0:p>g;g+=h)g in u&&(c=n(c,u[g],g,d));return c}};e.exports={left:c(!1),right:c(!0)}},,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";const{GObject:i,GEventTarget:o,GEvent:r}=n(1);function a(){}i.inheritAndMix(a,i,[o]),a.prototype._role=null,a.prototype.setRole=function(e){this._role=e,this.hasEventListeners(a.RoleChangedEvent)&&this.trigger(new a.RoleChangedEvent(e,this))},a.prototype.getRole=function(){return this._role},a.RoleChangedEvent=function(e,t){this.role=e,this.target=t},i.inherit(a.RoleChangedEvent,r),e.exports=a},function(e,t,n){"use strict";n.r(t);n(385);class i extends Error{constructor(...e){super(...e),this.constructor=i,this.__proto__=i.prototype,this.name="ExternalFileSettingsError"}toString(){return this.message}}t.default=i},function(e,t,n){var i;e.exports=(i=n(46),function(e){var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,a=t.algo,s=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,o=0;o<64;)t(i)&&(o<8&&(s[o]=n(e.pow(i,.5))),l[o]=n(e.pow(i,1/3)),o++),i++}();var c=[],d=a.SHA256=r.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],a=n[3],s=n[4],d=n[5],u=n[6],p=n[7],g=0;g<64;g++){if(g<16)c[g]=0|e[t+g];else{var h=c[g-15],f=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,m=c[g-2],y=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[g]=f+c[g-7]+y+c[g-16]}var v=i&o^i&r^o&r,_=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),b=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&d^~s&u)+l[g]+c[g];p=u,u=d,d=s,s=a+b|0,a=r,r=o,o=i,i=b+(_+v)|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+r|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+d|0,n[6]=n[6]+u|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(i/4294967296),n[15+(o+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=r._createHelper(d),t.HmacSHA256=r._createHmacHelper(d)}(Math),i.SHA256)},function(e,t,n){var i;e.exports=(i=n(46),n(342),function(){var e=i,t=e.lib.Hasher,n=e.x64,o=n.Word,r=n.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var d=a.SHA512=t.extend({_doReset:function(){this._hash=new r.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],o=n[1],r=n[2],a=n[3],s=n[4],d=n[5],u=n[6],p=n[7],g=i.high,h=i.low,f=o.high,m=o.low,y=r.high,v=r.low,_=a.high,b=a.low,w=s.high,C=s.low,E=d.high,S=d.low,G=u.high,A=u.low,T=p.high,P=p.low,L=g,D=h,x=f,I=m,O=y,k=v,F=_,R=b,M=w,N=C,B=E,$=S,U=G,K=A,j=T,H=P,V=0;V<80;V++){var z=c[V];if(V<16)var W=z.high=0|e[t+2*V],q=z.low=0|e[t+2*V+1];else{var Y=c[V-15],X=Y.high,Q=Y.low,Z=(X>>>1|Q<<31)^(X>>>8|Q<<24)^X>>>7,J=(Q>>>1|X<<31)^(Q>>>8|X<<24)^(Q>>>7|X<<25),ee=c[V-2],te=ee.high,ne=ee.low,ie=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),re=c[V-7],ae=re.high,se=re.low,le=c[V-16],ce=le.high,de=le.low;W=(W=(W=Z+ae+((q=J+se)>>>0<J>>>0?1:0))+ie+((q+=oe)>>>0<oe>>>0?1:0))+ce+((q+=de)>>>0<de>>>0?1:0),z.high=W,z.low=q}var ue,pe=M&B^~M&U,ge=N&$^~N&K,he=L&x^L&O^x&O,fe=D&I^D&k^I&k,me=(L>>>28|D<<4)^(L<<30|D>>>2)^(L<<25|D>>>7),ye=(D>>>28|L<<4)^(D<<30|L>>>2)^(D<<25|L>>>7),ve=(M>>>14|N<<18)^(M>>>18|N<<14)^(M<<23|N>>>9),_e=(N>>>14|M<<18)^(N>>>18|M<<14)^(N<<23|M>>>9),be=l[V],we=be.high,Ce=be.low,Ee=j+ve+((ue=H+_e)>>>0<H>>>0?1:0),Se=ye+fe;j=U,H=K,U=B,K=$,B=M,$=N,M=F+(Ee=(Ee=(Ee=Ee+pe+((ue+=ge)>>>0<ge>>>0?1:0))+we+((ue+=Ce)>>>0<Ce>>>0?1:0))+W+((ue+=q)>>>0<q>>>0?1:0))+((N=R+ue|0)>>>0<R>>>0?1:0)|0,F=O,R=k,O=x,k=I,x=L,I=D,L=Ee+(me+he+(Se>>>0<ye>>>0?1:0))+((D=ue+Se|0)>>>0<ue>>>0?1:0)|0}h=i.low=h+D,i.high=g+L+(h>>>0<D>>>0?1:0),m=o.low=m+I,o.high=f+x+(m>>>0<I>>>0?1:0),v=r.low=v+k,r.high=y+O+(v>>>0<k>>>0?1:0),b=a.low=b+R,a.high=_+F+(b>>>0<R>>>0?1:0),C=s.low=C+N,s.high=w+M+(C>>>0<N>>>0?1:0),S=d.low=S+$,d.high=E+B+(S>>>0<$>>>0?1:0),A=u.low=A+K,u.high=G+U+(A>>>0<K>>>0?1:0),P=p.low=P+H,p.high=T+j+(P>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;return t[i>>>5]|=128<<24-i%32,t[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(i+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(d),e.HmacSHA512=t._createHmacHelper(d)}(),i.SHA512)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=require("util")},function(e,t,n){"use strict";n(25),n(9);e.exports=new class{constructor(){this._cache={},this._initiliazed=!1}updateLicense(e){e._offline||this._update({license:e})}updateUser(e){this._update({user:e})}getUser(){return this._cache.user}getLicense(){if(this._cache.license){const{lastUpdate:e}=this._cache;return this._cache.license=Object.assign({},this._cache.license,{lastUpdate:e}),this._cache.license}return null}clear(){this._cache={},this._store()}_update(e){this._initiliazed&&(this._cache=Object.assign(this._cache,e),this._store())}async init(){return gContainer.getProperty("offline_cache").then(e=>{this._cache=e||{},this._initiliazed=!0}).catch(e=>Promise.reject(e))}_store(){this._initiliazed&&(this._cache.lastUpdate=gDesigner.now(),gContainer.setProperty("offline_cache",this._cache))}}},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GoogleToCloudRoleMap=void 0;var o=n(12),r=i(n(700));const a={[r.default.Reader]:o.ShareRoles.Viewer.id,[r.default.Commenter]:o.ShareRoles.Reviewer.id,[r.default.Writer]:o.ShareRoles.CoAuthor.id,[r.default.Owner]:o.ShareRoles.Owner.id,[r.default.Organizer]:o.ShareRoles.CoAuthor.id,[r.default.FileOrganizer]:o.ShareRoles.CoAuthor.id};t.GoogleToCloudRoleMap=a;var s=a;t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GoogleShareRoles=void 0;const i={Owner:"owner",Writer:"writer",Commenter:"commenter",Reader:"reader",Organizer:"organizer",FileOrganizer:"fileOrganizer"};t.GoogleShareRoles=i;var o=i;t.default=o},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.NoAccessId=t.CloudToGoogleRoleMap=void 0;var o=n(12),r=i(n(700));t.NoAccessId="NoAccess";const a={[o.ShareRoles.Viewer.id]:r.default.Reader,[o.ShareRoles.Developer.id]:r.default.Commenter,[o.ShareRoles.Reviewer.id]:r.default.Commenter,[o.ShareRoles.CoAuthor.id]:r.default.Writer,[o.ShareRoles.Owner.id]:r.default.Owner,[o.ShareRoles.NoAccess.id]:"NoAccess"};t.CloudToGoogleRoleMap=a;var s=a;t.default=s},function(e,t){function n(){}n.prototype.thumbnail=null,e.exports=n},function(e,t){class n{getImageAsBlob(){return new Blob([this.getImageAsBinary()],{type:this.getMimeType()})}getImageAsBinary(){const e=atob(this.getImageAsBase64()),t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}getMimeType(){return this.mimeType}getImageAsDataURL(){return this.image}getImageAsBase64(){return this.image.split("base64,")[1]}static async fromBlob(e){const t=new n,i=await new Promise(t=>{const n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsDataURL(e)});return t.image=i,t.mimeType=e.type,t}}e.exports=n},function(e,t,n){(function(t){var i;"function"!=typeof t.Promise?(i=n(1003),Object.defineProperty(i,"polyfilled",{value:!0,writable:!1,enumerable:!1})):i=t.Promise,e.exports=i}).call(this,n(105))},function(e,t,n){(function(t,i,o){var r;r=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var i=n(1),o=n(146),r=n(162),a=n(163),s=n(151),l=n(164),c=n(154),d=n(155),u=n(156),p=n(153);if(n(4)()){var g=n(165).PDFNodeStream;o.setPDFNetworkStreamFactory((function(e){return new g(e)}))}else if("undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream){var h=n(168).PDFFetchStream;o.setPDFNetworkStreamFactory((function(e){return new h(e)}))}else{var f=n(169).PDFNetworkStream;o.setPDFNetworkStreamFactory((function(e){return new f(e)}))}t.build=o.build,t.version=o.version,t.getDocument=o.getDocument,t.LoopbackPort=o.LoopbackPort,t.PDFDataRangeTransport=o.PDFDataRangeTransport,t.PDFWorker=o.PDFWorker,t.renderTextLayer=r.renderTextLayer,t.AnnotationLayer=a.AnnotationLayer,t.createPromiseCapability=i.createPromiseCapability,t.PasswordResponses=i.PasswordResponses,t.InvalidPDFException=i.InvalidPDFException,t.MissingPDFException=i.MissingPDFException,t.SVGGraphics=l.SVGGraphics,t.CanvasGraphics=c.CanvasGraphics,t.TilingPattern=d.TilingPattern,t.getShadingPatternFromIR=d.getShadingPatternFromIR,t.NativeImageDecoding=i.NativeImageDecoding,t.CMapCompressionType=i.CMapCompressionType,t.PermissionFlag=i.PermissionFlag,t.UnexpectedResponseException=i.UnexpectedResponseException,t.OPS=i.OPS,t.VerbosityLevel=i.VerbosityLevel,t.UNSUPPORTED_FEATURES=i.UNSUPPORTED_FEATURES,t.createValidAbsoluteUrl=i.createValidAbsoluteUrl,t.createObjectURL=i.createObjectURL,t.removeNullCharacters=i.removeNullCharacters,t.shadow=i.shadow,t.Util=i.Util,t.ReadableStream=i.ReadableStream,t.URL=i.URL,t.RenderingCancelledException=s.RenderingCancelledException,t.getFilenameFromUrl=s.getFilenameFromUrl,t.LinkTarget=s.LinkTarget,t.addLinkAttributes=s.addLinkAttributes,t.loadScript=s.loadScript,t.GlobalWorkerOptions=u.GlobalWorkerOptions,t.apiCompatibilityParams=p.apiCompatibilityParams},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toRomanNumerals=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d(Number.isInteger(e)&&e>0,"The number should be a positive integer.");for(var n,i=[];e>=1e3;)e-=1e3,i.push("M");n=e/100|0,e%=100,i.push(A[n]),n=e/10|0,e%=10,i.push(A[10+n]),i.push(A[20+e]);var o=i.join("");return t?o.toLowerCase():o},t.arrayByteLength=E,t.arraysToBytes=function(e){if(1===e.length&&e[0]instanceof Uint8Array)return e[0];var t,n,i,o=0,r=e.length;for(t=0;t<r;t++)n=e[t],i=E(n),o+=i;var a=0,s=new Uint8Array(o);for(t=0;t<r;t++)(n=e[t])instanceof Uint8Array||(n="string"==typeof n?C(n):new Uint8Array(n)),i=n.byteLength,s.set(n,a),a+=i;return s},t.assert=d,t.bytesToString=function(e){d(null!==e&&"object"===r(e)&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length;if(t<8192)return String.fromCharCode.apply(null,e);for(var n=[],i=0;i<t;i+=8192){var o=Math.min(i+8192,t),a=e.subarray(i,o);n.push(String.fromCharCode.apply(null,a))}return n.join("")},t.createPromiseCapability=function(){var e=Object.create(null),t=!1;return Object.defineProperty(e,"settled",{get:function(){return t}}),e.promise=new Promise((function(n,i){e.resolve=function(e){t=!0,n(e)},e.reject=function(e){t=!0,i(e)}})),e},t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getInheritableProperty=function(e){for(var t,n=e.dict,i=e.key,o=e.getArray,r=void 0!==o&&o,a=e.stopWhenFound,s=void 0===a||a,c=0;n;){var d=r?n.getArray(i):n.get(i);if(void 0!==d){if(s)return d;t||(t=[]),t.push(d)}if(++c>100){l('getInheritableProperty: maximum loop count exceeded for "'.concat(i,'"'));break}n=n.get("Parent")}return t},t.getLookupTableFactory=function(e){var t;return function(){return e&&(t=Object.create(null),e(t),e=null),t}},t.getVerbosityLevel=function(){return s},t.info=function(e){s>=a.INFOS&&console.log("Info: "+e)},t.isArrayBuffer=function(e){return"object"===r(e)&&null!==e&&void 0!==e.byteLength},t.isBool=function(e){return"boolean"==typeof e},t.isEmptyObj=function(e){for(var t in e)return!1;return!0},t.isNum=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSpace=function(e){return 32===e||9===e||13===e||10===e},t.isSameOrigin=function(e,t){try{var n=new o.URL(e);if(!n.origin||"null"===n.origin)return!1}catch(e){return!1}var i=new o.URL(t,n);return n.origin===i.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{var n=t?new o.URL(e,t):new o.URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(e){}return null},t.isLittleEndian=function(){var e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]},t.isEvalSupported=function(){try{return new Function(""),!0}catch(e){return!1}},t.log2=function(e){return e<=0?0:Math.ceil(Math.log2(e))},t.readInt8=function(e,t){return e[t]<<24>>24},t.readUint16=function(e,t){return e[t]<<8|e[t+1]},t.readUint32=function(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0},t.removeNullCharacters=function(e){return"string"!=typeof e?(l("The argument for removeNullCharacters must be a string."),e):e.replace(w,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(s=e)},t.shadow=function(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n},t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=C,t.stringToPDFString=function(e){var t,n=e.length,i=[];if("þ"===e[0]&&"ÿ"===e[1])for(t=2;t<n;t+=2)i.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;t<n;++t){var o=T[e.charCodeAt(t)];i.push(o?String.fromCharCode(o):e.charAt(t))}return i.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=l,t.unreachable=c,Object.defineProperty(t,"ReadableStream",{enumerable:!0,get:function(){return i.ReadableStream}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return o.URL}}),t.createObjectURL=t.FormatError=t.XRefParseException=t.XRefEntryException=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.NativeImageDecoding=t.MissingPDFException=t.MissingDataException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=void 0,n(2);var i=n(142),o=n(144);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},t.FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10};var a={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=a,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var s=a.WARNINGS;function l(e){s>=a.WARNINGS&&console.log("Warning: "+e)}function c(e){throw new Error(e)}function d(e,t){e||c(t)}var u=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}();t.PasswordException=u;var p=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}();t.UnknownErrorException=p;var g=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.InvalidPDFException=g;var h=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.MissingPDFException=h;var f=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}();t.UnexpectedResponseException=f;var m=function(){function e(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return e.prototype=new Error,e.prototype.name="MissingDataException",e.constructor=e,e}();t.MissingDataException=m;var y=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefEntryException",e.constructor=e,e}();t.XRefEntryException=y;var v=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefParseException",e.constructor=e,e}();t.XRefParseException=v;var _=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="FormatError",e.constructor=e,e}();t.FormatError=_;var b=function(){function e(e){this.name="AbortException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.AbortException=b;var w=/\x00/g;function C(e){d("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,n=new Uint8Array(t),i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}function E(e){return void 0!==e.length?e.length:(d(void 0!==e.byteLength),e.byteLength)}var S=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"],n=["cmyk(",0,"%,",0,"%,",0,"%,",0,"%)"];return e.makeCssRgb=function(e,n,i){return t[1]=e,t[3]=n,t[5]=i,t.join("")},e.makeCssCMYK=function(e,t,i,o){return n[1]=e,n[3]=t,n[5]=i,n[7]=o,n.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},e.applyInverseTransform=function(e,t){var n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]},e.getAxialAlignedBoundingBox=function(t,n){var i=e.applyTransform(t,n),o=e.applyTransform(t.slice(2,4),n),r=e.applyTransform([t[0],t[3]],n),a=e.applyTransform([t[2],t[1]],n);return[Math.min(i[0],o[0],r[0],a[0]),Math.min(i[1],o[1],r[1],a[1]),Math.max(i[0],o[0],r[0],a[0]),Math.max(i[1],o[1],r[1],a[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],o=e[2]*t[0]+e[3]*t[2],r=e[2]*t[1]+e[3]*t[3],a=(n+r)/2,s=Math.sqrt((n+r)*(n+r)-4*(n*r-o*i))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,n){function i(e,t){return e-t}var o=[t[0],t[2],n[0],n[2]].sort(i),r=[t[1],t[3],n[1],n[3]].sort(i),a=[];return t=e.normalizeRect(t),n=e.normalizeRect(n),(o[0]===t[0]&&o[1]===n[0]||o[0]===n[0]&&o[1]===t[0])&&(a[0]=o[1],a[2]=o[2],(r[0]===t[1]&&r[1]===n[1]||r[0]===n[1]&&r[1]===t[1])&&(a[1]=r[1],a[3]=r[2],a))},e}();t.Util=S;var G,A=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],P=(G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n&&o.URL.createObjectURL){var i=new Blob([e],{type:t});return o.URL.createObjectURL(i)}for(var r="data:"+t+";base64,",a=0,s=e.length;a<s;a+=3){var l=255&e[a],c=255&e[a+1],d=255&e[a+2],u=l>>2,p=(3&l)<<4|c>>4,g=a+1<s?(15&c)<<2|d>>6:64,h=a+2<s?63&d:64;r+=G[u]+G[p]+G[g]+G[h]}return r});t.createObjectURL=P},function(e,n,i){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=i(3);if(!r._pdfjsCompatibilityChecked){r._pdfjsCompatibilityChecked=!0;var a=i(4),s="object"===("undefined"==typeof window?"undefined":o(window))&&"object"===("undefined"==typeof document?"undefined":o(document));!r.btoa&&a()&&(r.btoa=function(e){return t.from(e,"binary").toString("base64")}),!r.atob&&a()&&(r.atob=function(e){return t.from(e,"base64").toString("binary")}),s&&void 0===Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){if(s&&!a()){var e=document.createElement("div");if(e.classList.add("testOne","testTwo"),!0!==e.classList.contains("testOne")||!0!==e.classList.contains("testTwo")){var t=DOMTokenList.prototype.add,n=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var o=0;o<n.length;o++){var r=n[o];t.call(this,r)}},DOMTokenList.prototype.remove=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var o=0;o<t.length;o++){var r=t[o];n.call(this,r)}}}}}(),s&&!a()&&!1!==document.createElement("div").classList.toggle("test",0)&&(DOMTokenList.prototype.toggle=function(e){var t=arguments.length>1?!!arguments[1]:!this.contains(e);return this[t?"add":"remove"](e),t}),String.prototype.startsWith||i(5),String.prototype.endsWith||i(35),String.prototype.includes||i(37),Array.prototype.includes||i(39),Array.from||i(46),Object.assign||i(69),Math.log2||(Math.log2=i(74)),Number.isNaN||(Number.isNaN=i(76)),Number.isInteger||(Number.isInteger=i(78)),r.Promise&&r.Promise.prototype&&r.Promise.prototype.finally||(r.Promise=i(81)),r.WeakMap||(r.WeakMap=i(101)),r.WeakSet||(r.WeakSet=i(118)),String.codePointAt||(String.codePointAt=i(122)),String.fromCodePoint||(String.fromCodePoint=i(124)),r.Symbol||i(126),String.prototype.padStart||i(133),String.prototype.padEnd||i(137),Object.values||(Object.values=i(139))}},function(e,t,n){"use strict";e.exports="undefined"!=typeof window&&window.Math===Math?window:void 0!==i&&i.Math===Math?i:"undefined"!=typeof self&&self.Math===Math?self:{}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(){return"object"===(void 0===o?"undefined":i(o))&&o+""=="[object process]"&&!o.versions.nw}},function(e,t,n){"use strict";n(6),e.exports=n(9).String.startsWith},function(e,t,n){"use strict";var i=n(7),o=n(25),r=n(27),a="".startsWith;i(i.P+i.F*n(34)("startsWith"),"String",{startsWith:function(e){var t=r(this,e,"startsWith"),n=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return a?a.call(t,i,n):t.slice(n,n+i.length)===i}})},function(e,t,n){"use strict";var i=n(8),o=n(9),r=n(10),a=n(20),s=n(23),l=function e(t,n,l){var c,d,u,p,g=t&e.F,h=t&e.G,f=t&e.P,m=t&e.B,y=h?i:t&e.S?i[n]||(i[n]={}):(i[n]||{}).prototype,v=h?o:o[n]||(o[n]={}),_=v.prototype||(v.prototype={});for(c in h&&(l=n),l)u=((d=!g&&y&&void 0!==y[c])?y:l)[c],p=m&&d?s(u,i):f&&"function"==typeof u?s(Function.call,u):u,y&&a(y,c,u,t&e.U),v[c]!=u&&r(v,c,p),f&&_[c]!=u&&(_[c]=u)};i.core=o,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(e,t,n){"use strict";var i=e.exports={version:"2.6.2"};"number"==typeof __e&&(__e=i)},function(e,t,n){"use strict";var i=n(11),o=n(19);e.exports=n(15)?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var i=n(12),o=n(14),r=n(18),a=Object.defineProperty;t.f=n(15)?Object.defineProperty:function(e,t,n){if(i(e),t=r(t,!0),i(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===i(e)?null!==e:"function"==typeof e}},function(e,t,n){"use strict";e.exports=!n(15)&&!n(16)((function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";e.exports=!n(16)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var i=n(13),o=n(8).document,r=i(o)&&i(o.createElement);e.exports=function(e){return r?o.createElement(e):{}}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e,t){if(!i(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!i(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!i(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var i=n(8),o=n(10),r=n(21),a=n(22)("src"),s=Function.toString,l=(""+s).split("toString");n(9).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(r(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(r(n,a)||o(n,a,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){"use strict";var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,n){"use strict";var i=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+o).toString(36))}},function(e,t,n){"use strict";var i=n(24);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var i=n(26),o=Math.min;e.exports=function(e){return e>0?o(i(e),9007199254740991):0}},function(e,t,n){"use strict";var i=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:i)(e)}},function(e,t,n){"use strict";var i=n(28),o=n(33);e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(e))}},function(e,t,n){"use strict";var i=n(13),o=n(29),r=n(30)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==o(e))}},function(e,t,n){"use strict";var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,n){"use strict";var i=n(31)("wks"),o=n(22),r=n(8).Symbol,a="function"==typeof r;(e.exports=function(e){return i[e]||(i[e]=a&&r[e]||(a?r:o)("Symbol."+e))}).store=i},function(e,t,n){"use strict";var i=n(9),o=n(8),r=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return r[e]||(r[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(32)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){"use strict";e.exports=!1},function(e,t,n){"use strict";e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var i=n(30)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";n(36),e.exports=n(9).String.endsWith},function(e,t,n){"use strict";var i=n(7),o=n(25),r=n(27),a="".endsWith;i(i.P+i.F*n(34)("endsWith"),"String",{endsWith:function(e){var t=r(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=o(t.length),s=void 0===n?i:Math.min(o(n),i),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";n(38),e.exports=n(9).String.includes},function(e,t,n){"use strict";var i=n(7),o=n(27);i(i.P+i.F*n(34)("includes"),"String",{includes:function(e){return!!~o(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";n(40),e.exports=n(9).Array.includes},function(e,t,n){"use strict";var i=n(7),o=n(41)(!0);i(i.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(45)("includes")},function(e,t,n){"use strict";var i=n(42),o=n(25),r=n(44);e.exports=function(e){return function(t,n,a){var s,l=i(t),c=o(l.length),d=r(a,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){"use strict";var i=n(43),o=n(33);e.exports=function(e){return i(o(e))}},function(e,t,n){"use strict";var i=n(29);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var i=n(26),o=Math.max,r=Math.min;e.exports=function(e,t){return(e=i(e))<0?o(e+t,0):r(e,t)}},function(e,t,n){"use strict";var i=n(30)("unscopables"),o=Array.prototype;null==o[i]&&n(10)(o,i,{}),e.exports=function(e){o[i][e]=!0}},function(e,t,n){"use strict";n(47),n(62),e.exports=n(9).Array.from},function(e,t,n){"use strict";var i=n(48)(!0);n(49)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var i=n(26),o=n(33);e.exports=function(e){return function(t,n){var r,a,s=String(o(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(r=s.charCodeAt(l))<55296||r>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):r:e?s.slice(l,l+2):a-56320+(r-55296<<10)+65536}}},function(e,t,n){"use strict";var i=n(32),o=n(7),r=n(20),a=n(10),s=n(50),l=n(51),c=n(59),d=n(60),u=n(30)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};e.exports=function(e,t,n,h,f,m,y){l(n,t,h);var v,_,b,w=function(e){if(!p&&e in G)return G[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},C=t+" Iterator",E="values"==f,S=!1,G=e.prototype,A=G[u]||G["@@iterator"]||f&&G[f],T=A||w(f),P=f?E?w("entries"):T:void 0,L="Array"==t&&G.entries||A;if(L&&(b=d(L.call(new e)))!==Object.prototype&&b.next&&(c(b,C,!0),i||"function"==typeof b[u]||a(b,u,g)),E&&A&&"values"!==A.name&&(S=!0,T=function(){return A.call(this)}),i&&!y||!p&&!S&&G[u]||a(G,u,T),s[t]=T,s[C]=g,f)if(v={values:E?T:w("values"),keys:m?T:w("keys"),entries:P},y)for(_ in v)_ in G||r(G,_,v[_]);else o(o.P+o.F*(p||S),t,v);return v}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var i=n(52),o=n(19),r=n(59),a={};n(10)(a,n(30)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=i(a,{next:o(1,n)}),r(e,t+" Iterator")}},function(e,t,n){"use strict";var i=n(12),o=n(53),r=n(57),a=n(56)("IE_PROTO"),s=function(){},l=function(){var e,t=n(17)("iframe"),i=r.length;for(t.style.display="none",n(58).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[r[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:o(n,t)}},function(e,t,n){"use strict";var i=n(11),o=n(12),r=n(54);e.exports=n(15)?Object.defineProperties:function(e,t){o(e);for(var n,a=r(t),s=a.length,l=0;s>l;)i.f(e,n=a[l++],t[n]);return e}},function(e,t,n){"use strict";var i=n(55),o=n(57);e.exports=Object.keys||function(e){return i(e,o)}},function(e,t,n){"use strict";var i=n(21),o=n(42),r=n(41)(!1),a=n(56)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),l=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~r(c,n)||c.push(n));return c}},function(e,t,n){"use strict";var i=n(31)("keys"),o=n(22);e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t,n){"use strict";e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var i=n(8).document;e.exports=i&&i.documentElement},function(e,t,n){"use strict";var i=n(11).f,o=n(21),r=n(30)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,r)&&i(e,r,{configurable:!0,value:t})}},function(e,t,n){"use strict";var i=n(21),o=n(61),r=n(56)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),i(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){"use strict";var i=n(33);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";var i=n(23),o=n(7),r=n(61),a=n(63),s=n(64),l=n(25),c=n(65),d=n(66);o(o.S+o.F*!n(68)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,o,u,p=r(e),g="function"==typeof this?this:Array,h=arguments.length,f=h>1?arguments[1]:void 0,m=void 0!==f,y=0,v=d(p);if(m&&(f=i(f,h>2?arguments[2]:void 0,2)),null==v||g==Array&&s(v))for(n=new g(t=l(p.length));t>y;y++)c(n,y,m?f(p[y],y):p[y]);else for(u=v.call(p),n=new g;!(o=u.next()).done;y++)c(n,y,m?a(u,f,[o.value,y],!0):o.value);return n.length=y,n}})},function(e,t,n){"use strict";var i=n(12);e.exports=function(e,t,n,o){try{return o?t(i(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&i(r.call(e)),t}}},function(e,t,n){"use strict";var i=n(50),o=n(30)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||r[o]===e)}},function(e,t,n){"use strict";var i=n(11),o=n(19);e.exports=function(e,t,n){t in e?i.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){"use strict";var i=n(67),o=n(30)("iterator"),r=n(50);e.exports=n(9).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||r[i(e)]}},function(e,t,n){"use strict";var i=n(29),o=n(30)("toStringTag"),r="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:r?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){"use strict";var i=n(30)("iterator"),o=!1;try{var r=[7][i]();r.return=function(){o=!0},Array.from(r,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var r=[7],a=r[i]();a.next=function(){return{done:n=!0}},r[i]=function(){return a},e(r)}catch(e){}return n}},function(e,t,n){"use strict";n(70),e.exports=n(9).Object.assign},function(e,t,n){"use strict";var i=n(7);i(i.S+i.F,"Object",{assign:n(71)})},function(e,t,n){"use strict";var i=n(54),o=n(72),r=n(73),a=n(61),s=n(43),l=Object.assign;e.exports=!l||n(16)((function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=i}))?function(e,t){for(var n=a(e),l=arguments.length,c=1,d=o.f,u=r.f;l>c;)for(var p,g=s(arguments[c++]),h=d?i(g).concat(d(g)):i(g),f=h.length,m=0;f>m;)u.call(g,p=h[m++])&&(n[p]=g[p]);return n}:l},function(e,t,n){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";n(75),e.exports=n(9).Math.log2},function(e,t,n){"use strict";var i=n(7);i(i.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){"use strict";n(77),e.exports=n(9).Number.isNaN},function(e,t,n){"use strict";var i=n(7);i(i.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){"use strict";n(79),e.exports=n(9).Number.isInteger},function(e,t,n){"use strict";var i=n(7);i(i.S,"Number",{isInteger:n(80)})},function(e,t,n){"use strict";var i=n(13),o=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&o(e)===e}},function(e,t,n){"use strict";n(82),n(47),n(83),n(86),n(99),n(100),e.exports=n(9).Promise},function(e,t,n){"use strict";var i=n(67),o={};o[n(30)("toStringTag")]="z",o+""!="[object z]"&&n(20)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},function(e,t,n){"use strict";for(var i=n(84),o=n(54),r=n(20),a=n(8),s=n(10),l=n(50),c=n(30),d=c("iterator"),u=c("toStringTag"),p=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(g),f=0;f<h.length;f++){var m,y=h[f],v=g[y],_=a[y],b=_&&_.prototype;if(b&&(b[d]||s(b,d,p),b[u]||s(b,u,y),l[y]=p,v))for(m in i)b[m]||r(b,m,i[m],!0)}},function(e,t,n){"use strict";var i=n(45),o=n(85),r=n(50),a=n(42);e.exports=n(49)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),r.Arguments=r.Array,i("keys"),i("values"),i("entries")},function(e,t,n){"use strict";e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i,o,r,a,s=n(32),l=n(8),c=n(23),d=n(67),u=n(7),p=n(13),g=n(24),h=n(87),f=n(88),m=n(89),y=n(90).set,v=n(92)(),_=n(93),b=n(94),w=n(95),C=n(96),E=l.TypeError,S=l.process,G=S&&S.versions,A=G&&G.v8||"",T=l.Promise,P="process"==d(S),L=function(){},D=o=_.f,x=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(30)("species")]=function(e){e(L,L)};return(P||"function"==typeof PromiseRejectionEvent)&&e.then(L)instanceof t&&0!==A.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),I=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},O=function(e,t){if(!e._n){e._n=!0;var n=e._c;v((function(){for(var i=e._v,o=1==e._s,r=0,a=function(t){var n,r,a,s=o?t.ok:t.fail,l=t.resolve,c=t.reject,d=t.domain;try{s?(o||(2==e._h&&R(e),e._h=1),!0===s?n=i:(d&&d.enter(),n=s(i),d&&(d.exit(),a=!0)),n===t.promise?c(E("Promise-chain cycle")):(r=I(n))?r.call(n,l,c):l(n)):c(i)}catch(e){d&&!a&&d.exit(),c(e)}};n.length>r;)a(n[r++]);e._c=[],e._n=!1,t&&!e._h&&k(e)}))}},k=function(e){y.call(l,(function(){var t,n,i,o=e._v,r=F(e);if(r&&(t=b((function(){P?S.emit("unhandledRejection",o,e):(n=l.onunhandledrejection)?n({promise:e,reason:o}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",o)})),e._h=P||F(e)?2:1),e._a=void 0,r&&t.e)throw t.v}))},F=function(e){return 1!==e._h&&0===(e._a||e._c).length},R=function(e){y.call(l,(function(){var t;P?S.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},M=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},N=function e(t){var n,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw E("Promise can't be resolved itself");(n=I(t))?v((function(){var o={_w:i,_d:!1};try{n.call(t,c(e,o,1),c(M,o,1))}catch(e){M.call(o,e)}})):(i._v=t,i._s=1,O(i,!1))}catch(e){M.call({_w:i,_d:!1},e)}}};x||(T=function(e){h(this,T,"Promise","_h"),g(e),i.call(this);try{e(c(N,this,1),c(M,this,1))}catch(e){M.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(97)(T.prototype,{then:function(e,t){var n=D(m(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=P?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&O(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),r=function(){var e=new i;this.promise=e,this.resolve=c(N,e,1),this.reject=c(M,e,1)},_.f=D=function(e){return e===T||e===a?new r(e):o(e)}),u(u.G+u.W+u.F*!x,{Promise:T}),n(59)(T,"Promise"),n(98)("Promise"),a=n(9).Promise,u(u.S+u.F*!x,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(s||!x),"Promise",{resolve:function(e){return C(s&&this===a?T:this,e)}}),u(u.S+u.F*!(x&&n(68)((function(e){T.all(e).catch(L)}))),"Promise",{all:function(e){var t=this,n=D(t),i=n.resolve,o=n.reject,r=b((function(){var n=[],r=0,a=1;f(e,!1,(function(e){var s=r++,l=!1;n.push(void 0),a++,t.resolve(e).then((function(e){l||(l=!0,n[s]=e,--a||i(n))}),o)})),--a||i(n)}));return r.e&&o(r.v),n.promise},race:function(e){var t=this,n=D(t),i=n.reject,o=b((function(){f(e,!1,(function(e){t.resolve(e).then(n.resolve,i)}))}));return o.e&&i(o.v),n.promise}})},function(e,t,n){"use strict";e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var i=n(23),o=n(63),r=n(64),a=n(12),s=n(25),l=n(66),c={},d={},u=e.exports=function(e,t,n,u,p){var g,h,f,m,y=p?function(){return e}:l(e),v=i(n,u,t?2:1),_=0;if("function"!=typeof y)throw TypeError(e+" is not iterable!");if(r(y)){for(g=s(e.length);g>_;_++)if((m=t?v(a(h=e[_])[0],h[1]):v(e[_]))===c||m===d)return m}else for(f=y.call(e);!(h=f.next()).done;)if((m=o(f,v,h.value,t))===c||m===d)return m};u.BREAK=c,u.RETURN=d},function(e,t,n){"use strict";var i=n(12),o=n(24),r=n(30)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[r])?t:o(n)}},function(e,t,n){"use strict";var i,o,r,a=n(23),s=n(91),l=n(58),c=n(17),d=n(8),u=d.process,p=d.setImmediate,g=d.clearImmediate,h=d.MessageChannel,f=d.Dispatch,m=0,y={},v=function(){var e=+this;if(y.hasOwnProperty(e)){var t=y[e];delete y[e],t()}},_=function(e){v.call(e.data)};p&&g||(p=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return y[++m]=function(){s("function"==typeof e?e:Function(e),t)},i(m),m},g=function(e){delete y[e]},"process"==n(29)(u)?i=function(e){u.nextTick(a(v,e,1))}:f&&f.now?i=function(e){f.now(a(v,e,1))}:h?(r=(o=new h).port2,o.port1.onmessage=_,i=a(r.postMessage,r,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(i=function(e){d.postMessage(e+"","*")},d.addEventListener("message",_,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:p,clear:g}},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var i=n(8),o=n(90).set,r=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(29)(a);e.exports=function(){var e,t,n,c=function(){var i,o;for(l&&(i=a.domain)&&i.exit();e;){o=e.fn,e=e.next;try{o()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(c)};else if(!r||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var d=s.resolve(void 0);n=function(){d.then(c)}}else n=function(){o.call(i,c)};else{var u=!0,p=document.createTextNode("");new r(c).observe(p,{characterData:!0}),n=function(){p.data=u=!u}}return function(i){var o={fn:i,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){"use strict";var i=n(24);function o(e){var t,n;this.promise=new e((function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i})),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new o(e)}},function(e,t,n){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var i=n(8).navigator;e.exports=i&&i.userAgent||""},function(e,t,n){"use strict";var i=n(12),o=n(13),r=n(93);e.exports=function(e,t){if(i(e),o(t)&&t.constructor===e)return t;var n=r.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var i=n(20);e.exports=function(e,t,n){for(var o in t)i(e,o,t[o],n);return e}},function(e,t,n){"use strict";var i=n(8),o=n(11),r=n(15),a=n(30)("species");e.exports=function(e){var t=i[e];r&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(7),o=n(9),r=n(8),a=n(89),s=n(96);i(i.P+i.R,"Promise",{finally:function(e){var t=a(this,o.Promise||r.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var i=n(7),o=n(93),r=n(94);i(i.S,"Promise",{try:function(e){var t=o.f(this),n=r(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";n(82),n(83),n(102),n(114),n(116),e.exports=n(9).WeakMap},function(e,t,n){"use strict";var i,o=n(103)(0),r=n(20),a=n(107),s=n(71),l=n(108),c=n(13),d=n(16),u=n(109),p=a.getWeak,g=Object.isExtensible,h=l.ufstore,f={},m=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(c(e)){var t=p(e);return!0===t?h(u(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(u(this,"WeakMap"),e,t)}},v=e.exports=n(110)("WeakMap",m,y,l,!0,!0);d((function(){return 7!=(new v).set((Object.freeze||Object)(f),7).get(f)}))&&(s((i=l.getConstructor(m,"WeakMap")).prototype,y),a.NEED=!0,o(["delete","has","get","set"],(function(e){var t=v.prototype,n=t[e];r(t,e,(function(t,o){if(c(t)&&!g(t)){this._f||(this._f=new i);var r=this._f[e](t,o);return"set"==e?this:r}return n.call(this,t,o)}))})))},function(e,t,n){"use strict";var i=n(23),o=n(43),r=n(61),a=n(25),s=n(104);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,d=4==e,u=6==e,p=5==e||u,g=t||s;return function(t,s,h){for(var f,m,y=r(t),v=o(y),_=i(s,h,3),b=a(v.length),w=0,C=n?g(t,b):l?g(t,0):void 0;b>w;w++)if((p||w in v)&&(m=_(f=v[w],w,y),e))if(n)C[w]=m;else if(m)switch(e){case 3:return!0;case 5:return f;case 6:return w;case 2:C.push(f)}else if(d)return!1;return u?-1:c||d?d:C}}},function(e,t,n){"use strict";var i=n(105);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){"use strict";var i=n(13),o=n(106),r=n(30)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),i(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var i=n(29);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(22)("meta"),r=n(13),a=n(21),s=n(11).f,l=0,c=Object.isExtensible||function(){return!0},d=!n(16)((function(){return c(Object.preventExtensions({}))})),u=function(e){s(e,o,{value:{i:"O"+ ++l,w:{}}})},p=e.exports={KEY:o,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==i(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,o)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[o].i},getWeak:function(e,t){if(!a(e,o)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[o].w},onFreeze:function(e){return d&&p.NEED&&c(e)&&!a(e,o)&&u(e),e}}},function(e,t,n){"use strict";var i=n(97),o=n(107).getWeak,r=n(12),a=n(13),s=n(87),l=n(88),c=n(103),d=n(21),u=n(109),p=c(5),g=c(6),h=0,f=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},y=function(e,t){return p(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var n=y(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=g(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var c=e((function(e,i){s(e,c,t,"_i"),e._t=t,e._i=h++,e._l=void 0,null!=i&&l(i,n,e[r],e)}));return i(c.prototype,{delete:function(e){if(!a(e))return!1;var n=o(e);return!0===n?f(u(this,t)).delete(e):n&&d(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=o(e);return!0===n?f(u(this,t)).has(e):n&&d(n,this._i)}}),c},def:function(e,t,n){var i=o(r(t),!0);return!0===i?f(e).set(t,n):i[e._i]=n,e},ufstore:f}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";var i=n(8),o=n(7),r=n(20),a=n(97),s=n(107),l=n(88),c=n(87),d=n(13),u=n(16),p=n(68),g=n(59),h=n(111);e.exports=function(e,t,n,f,m,y){var v=i[e],_=v,b=m?"set":"add",w=_&&_.prototype,C={},E=function(e){var t=w[e];r(w,e,"delete"==e||"has"==e?function(e){return!(y&&!d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return y&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof _&&(y||w.forEach&&!u((function(){(new _).entries().next()})))){var S=new _,G=S[b](y?{}:-0,1)!=S,A=u((function(){S.has(1)})),T=p((function(e){new _(e)})),P=!y&&u((function(){for(var e=new _,t=5;t--;)e[b](t,t);return!e.has(-0)}));T||((_=t((function(t,n){c(t,_,e);var i=h(new v,t,_);return null!=n&&l(n,m,i[b],i),i}))).prototype=w,w.constructor=_),(A||P)&&(E("delete"),E("has"),m&&E("get")),(P||G)&&E(b),y&&w.clear&&delete w.clear}else _=f.getConstructor(t,e,m,b),a(_.prototype,n),s.NEED=!0;return g(_,e),C[e]=_,o(o.G+o.W+o.F*(_!=v),C),y||f.setStrong(_,e,m),_}},function(e,t,n){"use strict";var i=n(13),o=n(112).set;e.exports=function(e,t,n){var r,a=t.constructor;return a!==n&&"function"==typeof a&&(r=a.prototype)!==n.prototype&&i(r)&&o&&o(e,r),e}},function(e,t,n){"use strict";var i=n(13),o=n(12),r=function(e,t){if(o(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n(23)(Function.call,n(113).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:r}},function(e,t,n){"use strict";var i=n(73),o=n(19),r=n(42),a=n(18),s=n(21),l=n(14),c=Object.getOwnPropertyDescriptor;t.f=n(15)?c:function(e,t){if(e=r(e),t=a(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){"use strict";n(115)("WeakMap")},function(e,t,n){"use strict";var i=n(7);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";n(117)("WeakMap")},function(e,t,n){"use strict";var i=n(7),o=n(24),r=n(23),a=n(88);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,l=arguments[1];return o(this),(t=void 0!==l)&&o(l),null==e?new this:(n=[],t?(i=0,s=r(l,arguments[2],2),a(e,!1,(function(e){n.push(s(e,i++))}))):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";n(82),n(83),n(119),n(120),n(121),e.exports=n(9).WeakSet},function(e,t,n){"use strict";var i=n(108),o=n(109);n(110)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return i.def(o(this,"WeakSet"),e,!0)}},i,!1,!0)},function(e,t,n){"use strict";n(115)("WeakSet")},function(e,t,n){"use strict";n(117)("WeakSet")},function(e,t,n){"use strict";n(123),e.exports=n(9).String.codePointAt},function(e,t,n){"use strict";var i=n(7),o=n(48)(!1);i(i.P,"String",{codePointAt:function(e){return o(this,e)}})},function(e,t,n){"use strict";n(125),e.exports=n(9).String.fromCodePoint},function(e,t,n){"use strict";var i=n(7),o=n(44),r=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],i=arguments.length,a=0;i>a;){if(t=+arguments[a++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?r(t):r(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";n(127),n(82),e.exports=n(9).Symbol},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(8),r=n(21),a=n(15),s=n(7),l=n(20),c=n(107).KEY,d=n(16),u=n(31),p=n(59),g=n(22),h=n(30),f=n(128),m=n(129),y=n(130),v=n(106),_=n(12),b=n(13),w=n(42),C=n(18),E=n(19),S=n(52),G=n(131),A=n(113),T=n(11),P=n(54),L=A.f,D=T.f,x=G.f,I=o.Symbol,O=o.JSON,k=O&&O.stringify,F=h("_hidden"),R=h("toPrimitive"),M={}.propertyIsEnumerable,N=u("symbol-registry"),B=u("symbols"),$=u("op-symbols"),U=Object.prototype,K="function"==typeof I,j=o.QObject,H=!j||!j.prototype||!j.prototype.findChild,V=a&&d((function(){return 7!=S(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(e,t,n){var i=L(U,t);i&&delete U[t],D(e,t,n),i&&e!==U&&D(U,t,i)}:D,z=function(e){var t=B[e]=S(I.prototype);return t._k=e,t},W=K&&"symbol"==i(I.iterator)?function(e){return"symbol"==i(e)}:function(e){return e instanceof I},q=function(e,t,n){return e===U&&q($,t,n),_(e),t=C(t,!0),_(n),r(B,t)?(n.enumerable?(r(e,F)&&e[F][t]&&(e[F][t]=!1),n=S(n,{enumerable:E(0,!1)})):(r(e,F)||D(e,F,E(1,{})),e[F][t]=!0),V(e,t,n)):D(e,t,n)},Y=function(e,t){_(e);for(var n,i=y(t=w(t)),o=0,r=i.length;r>o;)q(e,n=i[o++],t[n]);return e},X=function(e){var t=M.call(this,e=C(e,!0));return!(this===U&&r(B,e)&&!r($,e))&&(!(t||!r(this,e)||!r(B,e)||r(this,F)&&this[F][e])||t)},Q=function(e,t){if(e=w(e),t=C(t,!0),e!==U||!r(B,t)||r($,t)){var n=L(e,t);return!n||!r(B,t)||r(e,F)&&e[F][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=x(w(e)),i=[],o=0;n.length>o;)r(B,t=n[o++])||t==F||t==c||i.push(t);return i},J=function(e){for(var t,n=e===U,i=x(n?$:w(e)),o=[],a=0;i.length>a;)!r(B,t=i[a++])||n&&!r(U,t)||o.push(B[t]);return o};K||(l((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=g(arguments.length>0?arguments[0]:void 0),t=function t(n){this===U&&t.call($,n),r(this,F)&&r(this[F],e)&&(this[F][e]=!1),V(this,e,E(1,n))};return a&&H&&V(U,e,{configurable:!0,set:t}),z(e)}).prototype,"toString",(function(){return this._k})),A.f=Q,T.f=q,n(132).f=G.f=Z,n(73).f=X,n(72).f=J,a&&!n(32)&&l(U,"propertyIsEnumerable",X,!0),f.f=function(e){return z(h(e))}),s(s.G+s.W+s.F*!K,{Symbol:I});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)h(ee[te++]);for(var ne=P(h.store),ie=0;ne.length>ie;)m(ne[ie++]);s(s.S+s.F*!K,"Symbol",{for:function(e){return r(N,e+="")?N[e]:N[e]=I(e)},keyFor:function(e){if(!W(e))throw TypeError(e+" is not a symbol!");for(var t in N)if(N[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!K,"Object",{create:function(e,t){return void 0===t?S(e):Y(S(e),t)},defineProperty:q,defineProperties:Y,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:J}),O&&s(s.S+s.F*(!K||d((function(){var e=I();return"[null]"!=k([e])||"{}"!=k({a:e})||"{}"!=k(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=t=i[1],(b(t)||void 0!==e)&&!W(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!W(t))return t}),i[1]=t,k.apply(O,i)}}),I.prototype[R]||n(10)(I.prototype,R,I.prototype.valueOf),p(I,"Symbol"),p(Math,"Math",!0),p(o.JSON,"JSON",!0)},function(e,t,n){"use strict";t.f=n(30)},function(e,t,n){"use strict";var i=n(8),o=n(9),r=n(32),a=n(128),s=n(11).f;e.exports=function(e){var t=o.Symbol||(o.Symbol=r?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){"use strict";var i=n(54),o=n(72),r=n(73);e.exports=function(e){var t=i(e),n=o.f;if(n)for(var a,s=n(e),l=r.f,c=0;s.length>c;)l.call(e,a=s[c++])&&t.push(a);return t}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(42),r=n(132).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":i(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return r(e)}catch(e){return s.slice()}}(e):r(o(e))}},function(e,t,n){"use strict";var i=n(55),o=n(57).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,o)}},function(e,t,n){"use strict";n(134),e.exports=n(9).String.padStart},function(e,t,n){"use strict";var i=n(7),o=n(135),r=n(95);i(i.P+i.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(r),"String",{padStart:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var i=n(25),o=n(136),r=n(33);e.exports=function(e,t,n,a){var s=String(r(e)),l=s.length,c=void 0===n?" ":String(n),d=i(t);if(d<=l||""==c)return s;var u=d-l,p=o.call(c,Math.ceil(u/c.length));return p.length>u&&(p=p.slice(0,u)),a?p+s:s+p}},function(e,t,n){"use strict";var i=n(26),o=n(33);e.exports=function(e){var t=String(o(this)),n="",r=i(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},function(e,t,n){"use strict";n(138),e.exports=n(9).String.padEnd},function(e,t,n){"use strict";var i=n(7),o=n(135),r=n(95);i(i.P+i.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(r),"String",{padEnd:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(140),e.exports=n(9).Object.values},function(e,t,n){"use strict";var i=n(7),o=n(141)(!1);i(i.S,"Object",{values:function(e){return o(e)}})},function(e,t,n){"use strict";var i=n(54),o=n(42),r=n(73).f;e.exports=function(e){return function(t){for(var n,a=o(t),s=i(a),l=s.length,c=0,d=[];l>c;)r.call(a,n=s[c++])&&d.push(e?[n,a[n]]:a[n]);return d}}},function(e,t,n){"use strict";var i=!1;if("undefined"!=typeof ReadableStream)try{new ReadableStream({start:function(e){e.close()}}),i=!0}catch(e){}t.ReadableStream=i?ReadableStream:n(143).ReadableStream},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){for(var n in t)e[n]=t[n]}(t,function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){var o="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},r=n(1).assert;function a(e){return"string"==typeof e||"symbol"===(void 0===e?"undefined":o(e))}function s(e,t,n){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}t.typeIsObject=function(e){return"object"===(void 0===e?"undefined":o(e))&&null!==e||"function"==typeof e},t.createDataProperty=function(e,n,i){r(t.typeIsObject(e)),Object.defineProperty(e,n,{value:i,writable:!0,enumerable:!0,configurable:!0})},t.createArrayFromList=function(e){return e.slice()},t.ArrayBufferCopy=function(e,t,n,i,o){new Uint8Array(e).set(new Uint8Array(n,i,o),t)},t.CreateIterResultObject=function(e,t){r("boolean"==typeof t);var n={};return Object.defineProperty(n,"value",{value:e,enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(n,"done",{value:t,enumerable:!0,writable:!0,configurable:!0}),n},t.IsFiniteNonNegativeNumber=function(e){return!(Number.isNaN(e)||e===1/0||e<0)},t.InvokeOrNoop=function(e,t,n){r(void 0!==e),r(a(t)),r(Array.isArray(n));var i=e[t];if(void 0!==i)return s(i,e,n)},t.PromiseInvokeOrNoop=function(e,n,i){r(void 0!==e),r(a(n)),r(Array.isArray(i));try{return Promise.resolve(t.InvokeOrNoop(e,n,i))}catch(e){return Promise.reject(e)}},t.PromiseInvokeOrPerformFallback=function(e,t,n,i,o){r(void 0!==e),r(a(t)),r(Array.isArray(n)),r(Array.isArray(o));var l=void 0;try{l=e[t]}catch(e){return Promise.reject(e)}if(void 0===l)return i.apply(null,o);try{return Promise.resolve(s(l,e,n))}catch(e){return Promise.reject(e)}},t.TransferArrayBuffer=function(e){return e.slice()},t.ValidateAndNormalizeHighWaterMark=function(e){if(e=Number(e),Number.isNaN(e)||e<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return e},t.ValidateAndNormalizeQueuingStrategy=function(e,n){if(void 0!==e&&"function"!=typeof e)throw new TypeError("size property of a queuing strategy must be a function");return{size:e,highWaterMark:n=t.ValidateAndNormalizeHighWaterMark(n)}}},function(e,t,n){function i(e){this.name="AssertionError",this.message=e||"",this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,e.exports={rethrowAssertionErrorRejection:function(e){e&&e.constructor===i&&setTimeout((function(){throw e}),0)},AssertionError:i,assert:function(e,t){if(!e)throw new i(t)}}},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),a=r.InvokeOrNoop,s=r.PromiseInvokeOrNoop,l=r.ValidateAndNormalizeQueuingStrategy,c=r.typeIsObject,d=n(1),u=d.assert,p=d.rethrowAssertionErrorRejection,g=n(3),h=g.DequeueValue,f=g.EnqueueValueWithSize,m=g.PeekQueueValue,y=g.ResetQueue,v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size,r=n.highWaterMark,a=void 0===r?1:r;o(this,e),this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=[],this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1;var s=t.type;if(void 0!==s)throw new RangeError("Invalid type is specified");this._writableStreamController=new N(this,t,i,a),this._writableStreamController.__startSteps()}return i(e,[{key:"abort",value:function(e){return!1===b(this)?Promise.reject(H("abort")):!0===w(this)?Promise.reject(new TypeError("Cannot abort a stream that already has a writer")):C(this,e)}},{key:"getWriter",value:function(){if(!1===b(this))throw H("getWriter");return _(this)}},{key:"locked",get:function(){if(!1===b(this))throw H("locked");return w(this)}}]),e}();function _(e){return new x(e)}function b(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function w(e){return u(!0===b(e),"IsWritableStreamLocked should only be used on known writable streams"),void 0!==e._writer}function C(e,t){var n=e._state;if("closed"===n)return Promise.resolve(void 0);if("errored"===n)return Promise.reject(e._storedError);var i=new TypeError("Requested to abort");if(void 0!==e._pendingAbortRequest)return Promise.reject(i);u("writable"===n||"erroring"===n,"state must be writable or erroring");var o=!1;"erroring"===n&&(o=!0,t=void 0);var r=new Promise((function(n,i){e._pendingAbortRequest={_resolve:n,_reject:i,_reason:t,_wasAlreadyErroring:o}}));return!1===o&&S(e,i),r}function E(e,t){var n=e._state;"writable"!==n?(u("erroring"===n),G(e)):S(e,t)}function S(e,t){u(void 0===e._storedError,"stream._storedError === undefined"),u("writable"===e._state,"state must be writable");var n=e._writableStreamController;u(void 0!==n,"controller must not be undefined"),e._state="erroring",e._storedError=t;var i=e._writer;void 0!==i&&F(i,t),!1===P(e)&&!0===n._started&&G(e)}function G(e){u("erroring"===e._state,"stream._state === erroring"),u(!1===P(e),"WritableStreamHasOperationMarkedInFlight(stream) === false"),e._state="errored",e._writableStreamController.__errorSteps();for(var t=e._storedError,n=0;n<e._writeRequests.length;n++)e._writeRequests[n]._reject(t);if(e._writeRequests=[],void 0!==e._pendingAbortRequest){var i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,!0===i._wasAlreadyErroring)return i._reject(t),void L(e);e._writableStreamController.__abortSteps(i._reason).then((function(){i._resolve(),L(e)}),(function(t){i._reject(t),L(e)}))}else L(e)}function A(e){u(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0;var t=e._state;u("writable"===t||"erroring"===t),"erroring"===t&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var n=e._writer;void 0!==n&&function(e){u(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(n),u(void 0===e._pendingAbortRequest,"stream._pendingAbortRequest === undefined"),u(void 0===e._storedError,"stream._storedError === undefined")}function T(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function P(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function L(e){u("errored"===e._state,'_stream_.[[state]] is `"errored"`'),void 0!==e._closeRequest&&(u(void 0===e._inFlightCloseRequest),e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var t=e._writer;void 0!==t&&(q(t,e._storedError),t._closedPromise.catch((function(){})))}function D(e,t){u("writable"===e._state),u(!1===T(e));var n=e._writer;void 0!==n&&t!==e._backpressure&&(!0===t?function(e){u(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=new Promise((function(t,n){e._readyPromise_resolve=t,e._readyPromise_reject=n})),e._readyPromiseState="pending"}(n):(u(!1===t),Q(n))),e._backpressure=t}e.exports={AcquireWritableStreamDefaultWriter:_,IsWritableStream:b,IsWritableStreamLocked:w,WritableStream:v,WritableStreamAbort:C,WritableStreamDefaultControllerError:j,WritableStreamDefaultWriterCloseWithErrorPropagation:function(e){var t=e._ownerWritableStream;u(void 0!==t);var n=t._state;return!0===T(t)||"closed"===n?Promise.resolve():"errored"===n?Promise.reject(t._storedError):(u("writable"===n||"erroring"===n),O(e))},WritableStreamDefaultWriterRelease:R,WritableStreamDefaultWriterWrite:M,WritableStreamCloseQueuedOrInFlight:T};var x=function(){function e(t){if(o(this,e),!1===b(t))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===w(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;var n,i=t._state;if("writable"===i)!1===T(t)&&!0===t._backpressure?((n=this)._readyPromise=new Promise((function(e,t){n._readyPromise_resolve=e,n._readyPromise_reject=t})),n._readyPromiseState="pending"):X(this),W(this);else if("erroring"===i)Y(this,t._storedError),this._readyPromise.catch((function(){})),W(this);else if("closed"===i)X(this),function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(this);else{u("errored"===i,"state must be errored");var r=t._storedError;Y(this,r),this._readyPromise.catch((function(){})),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}(this,r),this._closedPromise.catch((function(){}))}}return i(e,[{key:"abort",value:function(e){return!1===I(this)?Promise.reject(V("abort")):void 0===this._ownerWritableStream?Promise.reject(z("abort")):function(e,t){var n=e._ownerWritableStream;return u(void 0!==n),C(n,t)}(this,e)}},{key:"close",value:function(){if(!1===I(this))return Promise.reject(V("close"));var e=this._ownerWritableStream;return void 0===e?Promise.reject(z("close")):!0===T(e)?Promise.reject(new TypeError("cannot close an already-closing stream")):O(this)}},{key:"releaseLock",value:function(){if(!1===I(this))throw V("releaseLock");var e=this._ownerWritableStream;void 0!==e&&(u(void 0!==e._writer),R(this))}},{key:"write",value:function(e){return!1===I(this)?Promise.reject(V("write")):void 0===this._ownerWritableStream?Promise.reject(z("write to")):M(this,e)}},{key:"closed",get:function(){return!1===I(this)?Promise.reject(V("closed")):this._closedPromise}},{key:"desiredSize",get:function(){if(!1===I(this))throw V("desiredSize");if(void 0===this._ownerWritableStream)throw z("desiredSize");return e=this._ownerWritableStream,"errored"===(t=e._state)||"erroring"===t?null:"closed"===t?0:B(e._writableStreamController);var e,t}},{key:"ready",get:function(){return!1===I(this)?Promise.reject(V("ready")):this._readyPromise}}]),e}();function I(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function O(e){var t=e._ownerWritableStream;u(void 0!==t);var n=t._state;if("closed"===n||"errored"===n)return Promise.reject(new TypeError("The stream (in "+n+" state) is not in the writable state and cannot be closed"));u("writable"===n||"erroring"===n),u(!1===T(t));var i,o=new Promise((function(e,n){var i={_resolve:e,_reject:n};t._closeRequest=i}));return!0===t._backpressure&&"writable"===n&&Q(e),i=t._writableStreamController,f(i,"close",0),$(i),o}function k(e,t){"pending"===e._closedPromiseState?q(e,t):function(e,t){u(void 0===e._closedPromise_resolve,"writer._closedPromise_resolve === undefined"),u(void 0===e._closedPromise_reject,"writer._closedPromise_reject === undefined"),u("pending"!==e._closedPromiseState,"writer._closedPromiseState is not pending"),e._closedPromise=Promise.reject(t),e._closedPromiseState="rejected"}(e,t),e._closedPromise.catch((function(){}))}function F(e,t){"pending"===e._readyPromiseState?function(e,t){u(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}(e,t):function(e,t){u(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=Promise.reject(t),e._readyPromiseState="rejected"}(e,t),e._readyPromise.catch((function(){}))}function R(e){var t=e._ownerWritableStream;u(void 0!==t),u(t._writer===e);var n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");F(e,n),k(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function M(e,t){var n=e._ownerWritableStream;u(void 0!==n);var i=n._writableStreamController,o=function(e,t){var n=e._strategySize;if(void 0===n)return 1;try{return n(t)}catch(t){return U(e,t),1}}(i,t);if(n!==e._ownerWritableStream)return Promise.reject(z("write to"));var r=n._state;if("errored"===r)return Promise.reject(n._storedError);if(!0===T(n)||"closed"===r)return Promise.reject(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===r)return Promise.reject(n._storedError);u("writable"===r);var a=function(e){return u(!0===w(e)),u("writable"===e._state),new Promise((function(t,n){var i={_resolve:t,_reject:n};e._writeRequests.push(i)}))}(n);return function(e,t,n){var i={chunk:t};try{f(e,i,n)}catch(t){return void U(e,t)}var o=e._controlledWritableStream;if(!1===T(o)&&"writable"===o._state){var r=K(e);D(o,r)}$(e)}(i,t,o),a}var N=function(){function e(t,n,i,r){if(o(this,e),!1===b(t))throw new TypeError("WritableStreamDefaultController can only be constructed with a WritableStream instance");if(void 0!==t._writableStreamController)throw new TypeError("WritableStreamDefaultController instances can only be created by the WritableStream constructor");this._controlledWritableStream=t,this._underlyingSink=n,this._queue=void 0,this._queueTotalSize=void 0,y(this),this._started=!1;var a=l(i,r);this._strategySize=a.size,this._strategyHWM=a.highWaterMark,D(t,K(this))}return i(e,[{key:"error",value:function(e){if(!1==(!!c(t=this)&&!!Object.prototype.hasOwnProperty.call(t,"_underlyingSink")))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");var t;"writable"===this._controlledWritableStream._state&&j(this,e)}},{key:"__abortSteps",value:function(e){return s(this._underlyingSink,"abort",[e])}},{key:"__errorSteps",value:function(){y(this)}},{key:"__startSteps",value:function(){var e=this,t=a(this._underlyingSink,"start",[this]),n=this._controlledWritableStream;Promise.resolve(t).then((function(){u("writable"===n._state||"erroring"===n._state),e._started=!0,$(e)}),(function(t){u("writable"===n._state||"erroring"===n._state),e._started=!0,E(n,t)})).catch(p)}}]),e}();function B(e){return e._strategyHWM-e._queueTotalSize}function $(e){var t=e._controlledWritableStream;if(!1!==e._started&&void 0===t._inFlightWriteRequest){var n=t._state;if("closed"!==n&&"errored"!==n)if("erroring"!==n){if(0!==e._queue.length){var i=m(e);"close"===i?function(e){var t=e._controlledWritableStream;(function(e){u(void 0===e._inFlightCloseRequest),u(void 0!==e._closeRequest),e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),h(e),u(0===e._queue.length,"queue must be empty once the final write record is dequeued"),s(e._underlyingSink,"close",[]).then((function(){A(t)}),(function(e){!function(e,t){u(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,u("writable"===e._state||"erroring"===e._state),void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),E(e,t)}(t,e)})).catch(p)}(e):function(e,t){var n=e._controlledWritableStream;(function(e){u(void 0===e._inFlightWriteRequest,"there must be no pending write request"),u(0!==e._writeRequests.length,"writeRequests must not be empty"),e._inFlightWriteRequest=e._writeRequests.shift()})(n),s(e._underlyingSink,"write",[t,e]).then((function(){!function(e){u(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(n);var t=n._state;if(u("writable"===t||"erroring"===t),h(e),!1===T(n)&&"writable"===t){var i=K(e);D(n,i)}$(e)}),(function(e){!function(e,t){u(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,u("writable"===e._state||"erroring"===e._state),E(e,t)}(n,e)})).catch(p)}(e,i.chunk)}}else G(t)}}function U(e,t){"writable"===e._controlledWritableStream._state&&j(e,t)}function K(e){return B(e)<=0}function j(e,t){var n=e._controlledWritableStream;u("writable"===n._state),S(n,t)}function H(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function V(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function z(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function W(e){e._closedPromise=new Promise((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"}))}function q(e,t){u(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function Y(e,t){e._readyPromise=Promise.reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function X(e){e._readyPromise=Promise.resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function Q(e){u(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}},function(e,t,n){var i=n(0).IsFiniteNonNegativeNumber,o=n(1).assert;t.DequeueValue=function(e){o("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: DequeueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),o(e._queue.length>0,"Spec-level failure: should never dequeue from an empty queue.");var t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value},t.EnqueueValueWithSize=function(e,t,n){if(o("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: EnqueueValueWithSize should only be used on containers with [[queue]] and [[queueTotalSize]]."),n=Number(n),!i(n))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n},t.PeekQueueValue=function(e){return o("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: PeekQueueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),o(e._queue.length>0,"Spec-level failure: should never peek at an empty queue."),e._queue[0].value},t.ResetQueue=function(e){o("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: ResetQueue should only be used on containers with [[queue]] and [[queueTotalSize]]."),e._queue=[],e._queueTotalSize=0}},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),a=r.ArrayBufferCopy,s=r.CreateIterResultObject,l=r.IsFiniteNonNegativeNumber,c=r.InvokeOrNoop,d=r.PromiseInvokeOrNoop,u=r.TransferArrayBuffer,p=r.ValidateAndNormalizeQueuingStrategy,g=r.ValidateAndNormalizeHighWaterMark,h=n(0),f=h.createArrayFromList,m=h.createDataProperty,y=h.typeIsObject,v=n(1),_=v.assert,b=v.rethrowAssertionErrorRejection,w=n(3),C=w.DequeueValue,E=w.EnqueueValueWithSize,S=w.ResetQueue,G=n(2),A=G.AcquireWritableStreamDefaultWriter,T=G.IsWritableStream,P=G.IsWritableStreamLocked,L=G.WritableStreamAbort,D=G.WritableStreamDefaultWriterCloseWithErrorPropagation,x=G.WritableStreamDefaultWriterRelease,I=G.WritableStreamDefaultWriterWrite,O=G.WritableStreamCloseQueuedOrInFlight,k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size,r=n.highWaterMark;o(this,e),this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,this._readableStreamController=void 0;var a=t.type,s=String(a);if("bytes"===s)void 0===r&&(r=0),this._readableStreamController=new ge(this,t,r);else{if(void 0!==a)throw new RangeError("Invalid type is specified");void 0===r&&(r=1),this._readableStreamController=new oe(this,t,i,r)}}return i(e,[{key:"cancel",value:function(e){return!1===M(this)?Promise.reject(De("cancel")):!0===N(this)?Promise.reject(new TypeError("Cannot cancel a stream that already has a reader")):K(this,e)}},{key:"getReader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mode;if(!1===M(this))throw De("getReader");if(void 0===t)return R(this);if("byob"===(t=String(t)))return F(this);throw new RangeError("Invalid mode is specified")}},{key:"pipeThrough",value:function(e,t){var n=e.writable,i=e.readable;return function(e){try{Promise.prototype.then.call(e,void 0,(function(){}))}catch(e){}}(this.pipeTo(n,t)),i}},{key:"pipeTo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.preventClose,o=n.preventAbort,r=n.preventCancel;if(!1===M(this))return Promise.reject(De("pipeTo"));if(!1===T(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));if(i=Boolean(i),o=Boolean(o),r=Boolean(r),!0===N(this))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"));if(!0===P(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"));var a=R(this),s=A(e),l=!1,c=Promise.resolve();return new Promise((function(n,d){var u,p,g;if(m(t,a._closedPromise,(function(t){!1===o?y((function(){return L(e,t)}),!0,t):v(!0,t)})),m(e,s._closedPromise,(function(e){!1===r?y((function(){return K(t,e)}),!0,e):v(!0,e)})),u=t,p=a._closedPromise,g=function(){!1===i?y((function(){return D(s)})):v()},"closed"===u._state?g():p.then(g).catch(b),!0===O(e)||"closed"===e._state){var h=new TypeError("the destination writable stream closed before all data could be piped to it");!1===r?y((function(){return K(t,h)}),!0,h):v(!0,h)}function f(){var e=c;return c.then((function(){return e!==c?f():void 0}))}function m(e,t,n){"errored"===e._state?n(e._storedError):t.catch(n).catch(b)}function y(t,n,i){function o(){t().then((function(){return _(n,i)}),(function(e){return _(!0,e)})).catch(b)}!0!==l&&(l=!0,"writable"===e._state&&!1===O(e)?f().then(o):o())}function v(t,n){!0!==l&&(l=!0,"writable"===e._state&&!1===O(e)?f().then((function(){return _(t,n)})).catch(b):_(t,n))}function _(e,t){x(s),ne(a),e?d(t):n(void 0)}(function e(){return c=Promise.resolve(),!0===l?Promise.resolve():s._readyPromise.then((function(){return ie(a).then((function(e){var t=e.value;!0!==e.done&&(c=I(s,t).catch((function(){})))}))})).then(e)})().catch((function(e){c=Promise.resolve(),b(e)}))}))}},{key:"tee",value:function(){if(!1===M(this))throw De("tee");var e=B(this,!1);return f(e)}},{key:"locked",get:function(){if(!1===M(this))throw De("locked");return N(this)}}]),e}();function F(e){return new Q(e)}function R(e){return new X(e)}function M(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function N(e){return _(!0===M(e),"IsReadableStreamLocked should only be used on known readable streams"),void 0!==e._reader}function B(e,t){_(!0===M(e)),_("boolean"==typeof t);var n=R(e),i={closedOrErrored:!1,canceled1:!1,canceled2:!1,reason1:void 0,reason2:void 0};i.promise=new Promise((function(e){i._resolve=e}));var o=function e(){var t=e._branch1,n=e._branch2,i=e._teeState;return ie(e._reader).then((function(e){_(y(e));var o=e.value,r=e.done;if(_("boolean"==typeof r),!0===r&&!1===i.closedOrErrored&&(!1===i.canceled1&&se(t),!1===i.canceled2&&se(n),i.closedOrErrored=!0),!0!==i.closedOrErrored){var a=o,s=o;!1===i.canceled1&&le(t,a),!1===i.canceled2&&le(n,s)}}))};o._reader=n,o._teeState=i,o._cloneForBranch2=t;var r=function e(t){var n=e._stream,i=e._teeState;if(i.canceled1=!0,i.reason1=t,!0===i.canceled2){var o=K(n,f([i.reason1,i.reason2]));i._resolve(o)}return i.promise};r._stream=e,r._teeState=i;var a=function e(t){var n=e._stream,i=e._teeState;if(i.canceled2=!0,i.reason2=t,!0===i.canceled1){var o=K(n,f([i.reason1,i.reason2]));i._resolve(o)}return i.promise};a._stream=e,a._teeState=i;var s=Object.create(Object.prototype);m(s,"pull",o),m(s,"cancel",r);var l=new k(s),c=Object.create(Object.prototype);m(c,"pull",o),m(c,"cancel",a);var d=new k(c);return o._branch1=l._readableStreamController,o._branch2=d._readableStreamController,n._closedPromise.catch((function(e){!0!==i.closedOrErrored&&(ce(o._branch1,e),ce(o._branch2,e),i.closedOrErrored=!0)})),[l,d]}function $(e){return _(!0===Z(e._reader)),_("readable"===e._state||"closed"===e._state),new Promise((function(t,n){var i={_resolve:t,_reject:n};e._reader._readIntoRequests.push(i)}))}function U(e){return _(!0===J(e._reader)),_("readable"===e._state),new Promise((function(t,n){var i={_resolve:t,_reject:n};e._reader._readRequests.push(i)}))}function K(e,t){return e._disturbed=!0,"closed"===e._state?Promise.resolve(void 0):"errored"===e._state?Promise.reject(e._storedError):(j(e),e._readableStreamController.__cancelSteps(t).then((function(){})))}function j(e){_("readable"===e._state),e._state="closed";var t=e._reader;if(void 0!==t){if(!0===J(t)){for(var n=0;n<t._readRequests.length;n++)(0,t._readRequests[n]._resolve)(s(void 0,!0));t._readRequests=[]}!function(e){_(void 0!==e._closedPromise_resolve),_(void 0!==e._closedPromise_reject),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(t)}}function H(e,t){_(!0===M(e),"stream must be ReadableStream"),_("readable"===e._state,"state must be readable"),e._state="errored",e._storedError=t;var n=e._reader;if(void 0!==n){if(!0===J(n)){for(var i=0;i<n._readRequests.length;i++)n._readRequests[i]._reject(t);n._readRequests=[]}else{_(Z(n),"reader must be ReadableStreamBYOBReader");for(var o=0;o<n._readIntoRequests.length;o++)n._readIntoRequests[o]._reject(t);n._readIntoRequests=[]}Oe(n,t),n._closedPromise.catch((function(){}))}}function V(e,t,n){var i=e._reader;_(i._readRequests.length>0),i._readRequests.shift()._resolve(s(t,n))}function z(e){return e._reader._readIntoRequests.length}function W(e){return e._reader._readRequests.length}function q(e){var t=e._reader;return void 0!==t&&!1!==Z(t)}function Y(e){var t=e._reader;return void 0!==t&&!1!==J(t)}e.exports={ReadableStream:k,IsReadableStreamDisturbed:function(e){return _(!0===M(e),"IsReadableStreamDisturbed should only be used on known readable streams"),e._disturbed},ReadableStreamDefaultControllerClose:se,ReadableStreamDefaultControllerEnqueue:le,ReadableStreamDefaultControllerError:ce,ReadableStreamDefaultControllerGetDesiredSize:ue};var X=function(){function e(t){if(o(this,e),!1===M(t))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===N(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ee(this,t),this._readRequests=[]}return i(e,[{key:"cancel",value:function(e){return!1===J(this)?Promise.reject(Ie("cancel")):void 0===this._ownerReadableStream?Promise.reject(xe("cancel")):te(this,e)}},{key:"read",value:function(){return!1===J(this)?Promise.reject(Ie("read")):void 0===this._ownerReadableStream?Promise.reject(xe("read from")):ie(this)}},{key:"releaseLock",value:function(){if(!1===J(this))throw Ie("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}},{key:"closed",get:function(){return!1===J(this)?Promise.reject(Ie("closed")):this._closedPromise}}]),e}(),Q=function(){function e(t){if(o(this,e),!M(t))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===he(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(N(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ee(this,t),this._readIntoRequests=[]}return i(e,[{key:"cancel",value:function(e){return Z(this)?void 0===this._ownerReadableStream?Promise.reject(xe("cancel")):te(this,e):Promise.reject(ke("cancel"))}},{key:"read",value:function(e){return Z(this)?void 0===this._ownerReadableStream?Promise.reject(xe("read from")):ArrayBuffer.isView(e)?0===e.byteLength?Promise.reject(new TypeError("view must have non-zero byteLength")):function(e,t){var n=e._ownerReadableStream;return _(void 0!==n),n._disturbed=!0,"errored"===n._state?Promise.reject(n._storedError):function(e,t){var n=e._controlledReadableStream,i=1;t.constructor!==DataView&&(i=t.constructor.BYTES_PER_ELEMENT);var o=t.constructor,r={buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:i,ctor:o,readerType:"byob"};if(e._pendingPullIntos.length>0)return r.buffer=u(r.buffer),e._pendingPullIntos.push(r),$(n);if("closed"===n._state){var a=new t.constructor(r.buffer,r.byteOffset,0);return Promise.resolve(s(a,!0))}if(e._queueTotalSize>0){if(!0===we(e,r)){var l=_e(r);return Ee(e),Promise.resolve(s(l,!1))}if(!0===e._closeRequested){var c=new TypeError("Insufficient bytes to fill elements in the given buffer");return Pe(e,c),Promise.reject(c)}}r.buffer=u(r.buffer),e._pendingPullIntos.push(r);var d=$(n);return me(e),d}(n._readableStreamController,t)}(this,e):Promise.reject(new TypeError("view must be an array buffer view")):Promise.reject(ke("read"))}},{key:"releaseLock",value:function(){if(!Z(this))throw ke("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}},{key:"closed",get:function(){return Z(this)?this._closedPromise:Promise.reject(ke("closed"))}}]),e}();function Z(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function J(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function ee(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?function(e){e._closedPromise=new Promise((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n}))}(e):"closed"===t._state?function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e):(_("errored"===t._state,"state must be errored"),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e,t._storedError),e._closedPromise.catch((function(){})))}function te(e,t){var n=e._ownerReadableStream;return _(void 0!==n),K(n,t)}function ne(e){_(void 0!==e._ownerReadableStream),_(e._ownerReadableStream._reader===e),"readable"===e._ownerReadableStream._state?Oe(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){_(void 0===e._closedPromise_resolve),_(void 0===e._closedPromise_reject),e._closedPromise=Promise.reject(t)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._closedPromise.catch((function(){})),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ie(e){var t=e._ownerReadableStream;return _(void 0!==t),t._disturbed=!0,"closed"===t._state?Promise.resolve(s(void 0,!0)):"errored"===t._state?Promise.reject(t._storedError):(_("readable"===t._state),t._readableStreamController.__pullSteps())}var oe=function(){function e(t,n,i,r){if(o(this,e),!1===M(t))throw new TypeError("ReadableStreamDefaultController can only be constructed with a ReadableStream instance");if(void 0!==t._readableStreamController)throw new TypeError("ReadableStreamDefaultController instances can only be created by the ReadableStream constructor");this._controlledReadableStream=t,this._underlyingSource=n,this._queue=void 0,this._queueTotalSize=void 0,S(this),this._started=!1,this._closeRequested=!1,this._pullAgain=!1,this._pulling=!1;var a=p(i,r);this._strategySize=a.size,this._strategyHWM=a.highWaterMark;var s=this,l=c(n,"start",[this]);Promise.resolve(l).then((function(){s._started=!0,_(!1===s._pulling),_(!1===s._pullAgain),ae(s)}),(function(e){de(s,e)})).catch(b)}return i(e,[{key:"close",value:function(){if(!1===re(this))throw Fe("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");se(this)}},{key:"enqueue",value:function(e){if(!1===re(this))throw Fe("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");return le(this,e)}},{key:"error",value:function(e){if(!1===re(this))throw Fe("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");ce(this,e)}},{key:"__cancelSteps",value:function(e){return S(this),d(this._underlyingSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(this._queue.length>0){var t=C(this);return!0===this._closeRequested&&0===this._queue.length?j(e):ae(this),Promise.resolve(s(t,!1))}var n=U(e);return ae(this),n}},{key:"desiredSize",get:function(){if(!1===re(this))throw Fe("desiredSize");return ue(this)}}]),e}();function re(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingSource")}function ae(e){!1!==function(e){var t=e._controlledReadableStream;return"closed"!==t._state&&"errored"!==t._state&&(!0!==e._closeRequested&&(!1!==e._started&&(!0===N(t)&&W(t)>0||ue(e)>0)))}(e)&&(!0!==e._pulling?(_(!1===e._pullAgain),e._pulling=!0,d(e._underlyingSource,"pull",[e]).then((function(){if(e._pulling=!1,!0===e._pullAgain)return e._pullAgain=!1,ae(e)}),(function(t){de(e,t)})).catch(b)):e._pullAgain=!0)}function se(e){var t=e._controlledReadableStream;_(!1===e._closeRequested),_("readable"===t._state),e._closeRequested=!0,0===e._queue.length&&j(t)}function le(e,t){var n=e._controlledReadableStream;if(_(!1===e._closeRequested),_("readable"===n._state),!0===N(n)&&W(n)>0)V(n,t,!1);else{var i=1;if(void 0!==e._strategySize){var o=e._strategySize;try{i=o(t)}catch(t){throw de(e,t),t}}try{E(e,t,i)}catch(t){throw de(e,t),t}}ae(e)}function ce(e,t){var n=e._controlledReadableStream;_("readable"===n._state),S(e),H(n,t)}function de(e,t){"readable"===e._controlledReadableStream._state&&ce(e,t)}function ue(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}var pe=function(){function e(t,n){o(this,e),this._associatedReadableByteStreamController=t,this._view=n}return i(e,[{key:"respond",value:function(e){if(!1===fe(this))throw Re("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");!function(e,t){if(t=Number(t),!1===l(t))throw new RangeError("bytesWritten must be a finite");_(e._pendingPullIntos.length>0),Ae(e,t)}(this._associatedReadableByteStreamController,e)}},{key:"respondWithNewView",value:function(e){if(!1===fe(this))throw Re("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");!function(e,t){_(e._pendingPullIntos.length>0);var n=e._pendingPullIntos[0];if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=t.buffer,Ae(e,t.byteLength)}(this._associatedReadableByteStreamController,e)}},{key:"view",get:function(){return this._view}}]),e}(),ge=function(){function e(t,n,i){if(o(this,e),!1===M(t))throw new TypeError("ReadableByteStreamController can only be constructed with a ReadableStream instance given a byte source");if(void 0!==t._readableStreamController)throw new TypeError("ReadableByteStreamController instances can only be created by the ReadableStream constructor given a byte source");this._controlledReadableStream=t,this._underlyingByteSource=n,this._pullAgain=!1,this._pulling=!1,ye(this),this._queue=this._queueTotalSize=void 0,S(this),this._closeRequested=!1,this._started=!1,this._strategyHWM=g(i);var r=n.autoAllocateChunkSize;if(void 0!==r&&(!1===Number.isInteger(r)||r<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");this._autoAllocateChunkSize=r,this._pendingPullIntos=[];var a=this,s=c(n,"start",[this]);Promise.resolve(s).then((function(){a._started=!0,_(!1===a._pulling),_(!1===a._pullAgain),me(a)}),(function(e){"readable"===t._state&&Pe(a,e)})).catch(b)}return i(e,[{key:"close",value:function(){if(!1===he(this))throw Me("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");!function(e){var t=e._controlledReadableStream;if(_(!1===e._closeRequested),_("readable"===t._state),e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos[0].bytesFilled>0){var n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Pe(e,n),n}j(t)}}(this)}},{key:"enqueue",value:function(e){if(!1===he(this))throw Me("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(e))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");!function(e,t){var n=e._controlledReadableStream;_(!1===e._closeRequested),_("readable"===n._state);var i=t.buffer,o=t.byteOffset,r=t.byteLength,a=u(i);if(!0===Y(n))if(0===W(n))be(e,a,o,r);else{_(0===e._queue.length);var s=new Uint8Array(a,o,r);V(n,s,!1)}else!0===q(n)?(be(e,a,o,r),Ge(e)):(_(!1===N(n),"stream must not be locked"),be(e,a,o,r))}(this,e)}},{key:"error",value:function(e){if(!1===he(this))throw Me("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");Pe(this,e)}},{key:"__cancelSteps",value:function(e){return this._pendingPullIntos.length>0&&(this._pendingPullIntos[0].bytesFilled=0),S(this),d(this._underlyingByteSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(_(!0===Y(e)),this._queueTotalSize>0){_(0===W(e));var t=this._queue.shift();this._queueTotalSize-=t.byteLength,Ee(this);var n=void 0;try{n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}catch(e){return Promise.reject(e)}return Promise.resolve(s(n,!1))}var i=this._autoAllocateChunkSize;if(void 0!==i){var o=void 0;try{o=new ArrayBuffer(i)}catch(e){return Promise.reject(e)}var r={buffer:o,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(r)}var a=U(e);return me(this),a}},{key:"byobRequest",get:function(){if(!1===he(this))throw Me("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){var e=this._pendingPullIntos[0],t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled);this._byobRequest=new pe(this,t)}return this._byobRequest}},{key:"desiredSize",get:function(){if(!1===he(this))throw Me("desiredSize");return Le(this)}}]),e}();function he(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingByteSource")}function fe(e){return!!y(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function me(e){!1!==function(e){var t=e._controlledReadableStream;return"readable"===t._state&&(!0!==e._closeRequested&&(!1!==e._started&&(!0===Y(t)&&W(t)>0||(!0===q(t)&&z(t)>0||Le(e)>0))))}(e)&&(!0!==e._pulling?(_(!1===e._pullAgain),e._pulling=!0,d(e._underlyingByteSource,"pull",[e]).then((function(){e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,me(e))}),(function(t){"readable"===e._controlledReadableStream._state&&Pe(e,t)})).catch(b)):e._pullAgain=!0)}function ye(e){Se(e),e._pendingPullIntos=[]}function ve(e,t){_("errored"!==e._state,"state must not be errored");var n=!1;"closed"===e._state&&(_(0===t.bytesFilled),n=!0);var i=_e(t);"default"===t.readerType?V(e,i,n):(_("byob"===t.readerType),function(e,t,n){var i=e._reader;_(i._readIntoRequests.length>0),i._readIntoRequests.shift()._resolve(s(t,n))}(e,i,n))}function _e(e){var t=e.bytesFilled,n=e.elementSize;return _(t<=e.byteLength),_(t%n==0),new e.ctor(e.buffer,e.byteOffset,t/n)}function be(e,t,n,i){e._queue.push({buffer:t,byteOffset:n,byteLength:i}),e._queueTotalSize+=i}function we(e,t){var n=t.elementSize,i=t.bytesFilled-t.bytesFilled%n,o=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),r=t.bytesFilled+o,s=r-r%n,l=o,c=!1;s>i&&(l=s-t.bytesFilled,c=!0);for(var d=e._queue;l>0;){var u=d[0],p=Math.min(l,u.byteLength),g=t.byteOffset+t.bytesFilled;a(t.buffer,g,u.buffer,u.byteOffset,p),u.byteLength===p?d.shift():(u.byteOffset+=p,u.byteLength-=p),e._queueTotalSize-=p,Ce(e,p,t),l-=p}return!1===c&&(_(0===e._queueTotalSize,"queue must be empty"),_(t.bytesFilled>0),_(t.bytesFilled<t.elementSize)),c}function Ce(e,t,n){_(0===e._pendingPullIntos.length||e._pendingPullIntos[0]===n),Se(e),n.bytesFilled+=t}function Ee(e){_("readable"===e._controlledReadableStream._state),0===e._queueTotalSize&&!0===e._closeRequested?j(e._controlledReadableStream):me(e)}function Se(e){void 0!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function Ge(e){for(_(!1===e._closeRequested);e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;var t=e._pendingPullIntos[0];!0===we(e,t)&&(Te(e),ve(e._controlledReadableStream,t))}}function Ae(e,t){var n=e._pendingPullIntos[0],i=e._controlledReadableStream;if("closed"===i._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(e,t){t.buffer=u(t.buffer),_(0===t.bytesFilled,"bytesFilled must be 0");var n=e._controlledReadableStream;if(!0===q(n))for(;z(n)>0;)ve(n,Te(e))}(e,n)}else _("readable"===i._state),function(e,t,n){if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range");if(Ce(e,t,n),!(n.bytesFilled<n.elementSize)){Te(e);var i=n.bytesFilled%n.elementSize;if(i>0){var o=n.byteOffset+n.bytesFilled,r=n.buffer.slice(o-i,o);be(e,r,0,r.byteLength)}n.buffer=u(n.buffer),n.bytesFilled-=i,ve(e._controlledReadableStream,n),Ge(e)}}(e,t,n)}function Te(e){var t=e._pendingPullIntos.shift();return Se(e),t}function Pe(e,t){var n=e._controlledReadableStream;_("readable"===n._state),ye(e),S(e),H(n,t)}function Le(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function De(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}function xe(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Ie(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}function Oe(e,t){_(void 0!==e._closedPromise_resolve),_(void 0!==e._closedPromise_reject),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function ke(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}function Fe(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function Re(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function Me(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}},function(e,t,n){var i=n(6),o=n(4),r=n(2);t.TransformStream=i.TransformStream,t.ReadableStream=o.ReadableStream,t.IsReadableStreamDisturbed=o.IsReadableStreamDisturbed,t.ReadableStreamDefaultControllerClose=o.ReadableStreamDefaultControllerClose,t.ReadableStreamDefaultControllerEnqueue=o.ReadableStreamDefaultControllerEnqueue,t.ReadableStreamDefaultControllerError=o.ReadableStreamDefaultControllerError,t.ReadableStreamDefaultControllerGetDesiredSize=o.ReadableStreamDefaultControllerGetDesiredSize,t.AcquireWritableStreamDefaultWriter=r.AcquireWritableStreamDefaultWriter,t.IsWritableStream=r.IsWritableStream,t.IsWritableStreamLocked=r.IsWritableStreamLocked,t.WritableStream=r.WritableStream,t.WritableStreamAbort=r.WritableStreamAbort,t.WritableStreamDefaultControllerError=r.WritableStreamDefaultControllerError,t.WritableStreamDefaultWriterCloseWithErrorPropagation=r.WritableStreamDefaultWriterCloseWithErrorPropagation,t.WritableStreamDefaultWriterRelease=r.WritableStreamDefaultWriterRelease,t.WritableStreamDefaultWriterWrite=r.WritableStreamDefaultWriterWrite},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(1).assert,a=n(0),s=a.InvokeOrNoop,l=a.PromiseInvokeOrPerformFallback,c=a.PromiseInvokeOrNoop,d=a.typeIsObject,u=n(4),p=u.ReadableStream,g=u.ReadableStreamDefaultControllerClose,h=u.ReadableStreamDefaultControllerEnqueue,f=u.ReadableStreamDefaultControllerError,m=u.ReadableStreamDefaultControllerGetDesiredSize,y=n(2),v=y.WritableStream,_=y.WritableStreamDefaultControllerError;function b(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");var n=e._readableController;try{h(n,t)}catch(t){throw e._readableClosed=!0,C(e,t),e._storedError}!0==m(n)<=0&&!1===e._backpressure&&G(e,!0)}function w(e){r(!1===e._errored),r(!1===e._readableClosed);try{g(e._readableController)}catch(e){r(!1)}e._readableClosed=!0}function C(e,t){!1===e._errored&&E(e,t)}function E(e,t){r(!1===e._errored),e._errored=!0,e._storedError=t,!1===e._writableDone&&_(e._writableController,t),!1===e._readableClosed&&f(e._readableController,t)}function S(e){return r(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!1===e._backpressure?Promise.resolve():(r(!0===e._backpressure,"_backpressure should have been initialized"),e._backpressureChangePromise)}function G(e,t){r(e._backpressure!==t,"TransformStreamSetBackpressure() should be called only when backpressure is changed"),void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(t),e._backpressureChangePromise=new Promise((function(t){e._backpressureChangePromise_resolve=t})),e._backpressureChangePromise.then((function(e){r(e!==t,"_backpressureChangePromise should be fulfilled only when backpressure is changed")})),e._backpressure=t}function A(e,t){return b(t._controlledTransformStream,e),Promise.resolve()}function T(e){return!!d(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function P(e){return!!d(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}var L=function(){function e(t,n){o(this,e),this._transformStream=t,this._startPromise=n}return i(e,[{key:"start",value:function(e){var t=this._transformStream;return t._writableController=e,this._startPromise.then((function(){return S(t)}))}},{key:"write",value:function(e){return function(e,t){r(!1===e._errored),r(!1===e._transforming),r(!1===e._backpressure),e._transforming=!0;var n=e._transformer,i=e._transformStreamController;return l(n,"transform",[t,i],A,[t,i]).then((function(){return e._transforming=!1,S(e)}),(function(t){return C(e,t),Promise.reject(t)}))}(this._transformStream,e)}},{key:"abort",value:function(){var e=this._transformStream;e._writableDone=!0,E(e,new TypeError("Writable side aborted"))}},{key:"close",value:function(){var e=this._transformStream;return r(!1===e._transforming),e._writableDone=!0,c(e._transformer,"flush",[e._transformStreamController]).then((function(){return!0===e._errored?Promise.reject(e._storedError):(!1===e._readableClosed&&w(e),Promise.resolve())})).catch((function(t){return C(e,t),Promise.reject(e._storedError)}))}}]),e}(),D=function(){function e(t,n){o(this,e),this._transformStream=t,this._startPromise=n}return i(e,[{key:"start",value:function(e){var t=this._transformStream;return t._readableController=e,this._startPromise.then((function(){return r(void 0!==t._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!0===t._backpressure?Promise.resolve():(r(!1===t._backpressure,"_backpressure should have been initialized"),t._backpressureChangePromise)}))}},{key:"pull",value:function(){var e=this._transformStream;return r(!0===e._backpressure,"pull() should be never called while _backpressure is false"),r(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),G(e,!1),e._backpressureChangePromise}},{key:"cancel",value:function(){var e=this._transformStream;e._readableClosed=!0,E(e,new TypeError("Readable side canceled"))}}]),e}(),x=function(){function e(t){if(o(this,e),!1===P(t))throw new TypeError("TransformStreamDefaultController can only be constructed with a TransformStream instance");if(void 0!==t._transformStreamController)throw new TypeError("TransformStreamDefaultController instances can only be created by the TransformStream constructor");this._controlledTransformStream=t}return i(e,[{key:"enqueue",value:function(e){if(!1===T(this))throw O("enqueue");b(this._controlledTransformStream,e)}},{key:"close",value:function(){if(!1===T(this))throw O("close");!function(e){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");w(e)}(this._controlledTransformStream)}},{key:"error",value:function(e){if(!1===T(this))throw O("error");!function(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");E(e,t)}(this._controlledTransformStream,e)}},{key:"desiredSize",get:function(){if(!1===T(this))throw O("desiredSize");var e=this._controlledTransformStream._readableController;return m(e)}}]),e}(),I=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._transformer=t;var n=t.readableStrategy,i=t.writableStrategy;this._transforming=!1,this._errored=!1,this._storedError=void 0,this._writableController=void 0,this._readableController=void 0,this._transformStreamController=void 0,this._writableDone=!1,this._readableClosed=!1,this._backpressure=void 0,this._backpressureChangePromise=void 0,this._backpressureChangePromise_resolve=void 0,this._transformStreamController=new x(this);var a=void 0,l=new Promise((function(e){a=e})),c=new D(this,l);this._readable=new p(c,n);var d=new L(this,l);this._writable=new v(d,i),r(void 0!==this._writableController),r(void 0!==this._readableController);var u=m(this._readableController);G(this,u<=0);var g=this,h=s(t,"start",[g._transformStreamController]);a(h),l.catch((function(e){!1===g._errored&&(g._errored=!0,g._storedError=e)}))}return i(e,[{key:"readable",get:function(){if(!1===P(this))throw k("readable");return this._readable}},{key:"writable",get:function(){if(!1===P(this))throw k("writable");return this._writable}}]),e}();function O(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function k(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}e.exports={TransformStream:I}},function(e,t,n){e.exports=n(5)}]))},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=!1;try{if("function"==typeof URL&&"object"===i(URL.prototype)&&"origin"in URL.prototype){var r=new URL("b","http://a");r.pathname="c%20d",o="http://a/c%20d"===r.href}}catch(e){}if(o)t.URL=URL;else{var a=n(145).URL,s=n(3).URL;s&&(a.createObjectURL=function(e){return s.createObjectURL.apply(s,arguments)},a.revokeObjectURL=function(e){s.revokeObjectURL(e)}),t.URL=a}},function(e,t,n){"use strict";!function(){var e=Object.create(null);e.ftp=21,e.file=0,e.gopher=70,e.http=80,e.https=443,e.ws=80,e.wss=443;var n=Object.create(null);function i(t){return void 0!==e[t]}function o(){p.call(this),this._isInvalid=!0}function r(e){return""===e&&o.call(this),e.toLowerCase()}function a(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function s(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}n["%2e"]=".",n[".%2e"]="..",n["%2e."]="..",n["%2e%2e"]="..";var l,c=/[a-zA-Z]/,d=/[a-zA-Z0-9\+\-\.]/;function u(t,u,p){function g(e){_.push(e)}var h=u||"scheme start",f=0,m="",y=!1,v=!1,_=[];e:for(;(t[f-1]!==l||0===f)&&!this._isInvalid;){var b=t[f];switch(h){case"scheme start":if(!b||!c.test(b)){if(u){g("Invalid scheme.");break e}m="",h="no scheme";continue}m+=b.toLowerCase(),h="scheme";break;case"scheme":if(b&&d.test(b))m+=b.toLowerCase();else{if(":"!==b){if(u){if(b===l)break e;g("Code point not allowed in scheme: "+b);break e}m="",f=0,h="no scheme";continue}if(this._scheme=m,m="",u)break e;i(this._scheme)&&(this._isRelative=!0),h="file"===this._scheme?"relative":this._isRelative&&p&&p._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"===b?(this._query="?",h="query"):"#"===b?(this._fragment="#",h="fragment"):b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._schemeData+=a(b));break;case"no scheme":if(p&&i(p._scheme)){h="relative";continue}g("Missing scheme."),o.call(this);break;case"relative or authority":if("/"!==b||"/"!==t[f+1]){g("Expected /, got: "+b),h="relative";continue}h="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!==this._scheme&&(this._scheme=p._scheme),b===l){this._host=p._host,this._port=p._port,this._path=p._path.slice(),this._query=p._query,this._username=p._username,this._password=p._password;break e}if("/"===b||"\\"===b)"\\"===b&&g("\\ is an invalid code point."),h="relative slash";else if("?"===b)this._host=p._host,this._port=p._port,this._path=p._path.slice(),this._query="?",this._username=p._username,this._password=p._password,h="query";else{if("#"!==b){var w=t[f+1],C=t[f+2];("file"!==this._scheme||!c.test(b)||":"!==w&&"|"!==w||C!==l&&"/"!==C&&"\\"!==C&&"?"!==C&&"#"!==C)&&(this._host=p._host,this._port=p._port,this._username=p._username,this._password=p._password,this._path=p._path.slice(),this._path.pop()),h="relative path";continue}this._host=p._host,this._port=p._port,this._path=p._path.slice(),this._query=p._query,this._fragment="#",this._username=p._username,this._password=p._password,h="fragment"}break;case"relative slash":if("/"!==b&&"\\"!==b){"file"!==this._scheme&&(this._host=p._host,this._port=p._port,this._username=p._username,this._password=p._password),h="relative path";continue}"\\"===b&&g("\\ is an invalid code point."),h="file"===this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!==b){g("Expected '/', got: "+b),h="authority ignore slashes";continue}h="authority second slash";break;case"authority second slash":if(h="authority ignore slashes","/"!==b){g("Expected '/', got: "+b);continue}break;case"authority ignore slashes":if("/"!==b&&"\\"!==b){h="authority";continue}g("Expected authority, got: "+b);break;case"authority":if("@"===b){y&&(g("@ already seen."),m+="%40"),y=!0;for(var E=0;E<m.length;E++){var S=m[E];if("\t"!==S&&"\n"!==S&&"\r"!==S)if(":"!==S||null!==this._password){var G=a(S);null!==this._password?this._password+=G:this._username+=G}else this._password="";else g("Invalid whitespace in authority.")}m=""}else{if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){f-=m.length,m="",h="host";continue}m+=b}break;case"file host":if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){2!==m.length||!c.test(m[0])||":"!==m[1]&&"|"!==m[1]?(0===m.length||(this._host=r.call(this,m),m=""),h="relative path start"):h="relative path";continue}"\t"===b||"\n"===b||"\r"===b?g("Invalid whitespace in file host."):m+=b;break;case"host":case"hostname":if(":"!==b||v){if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b){if(this._host=r.call(this,m),m="",h="relative path start",u)break e;continue}"\t"!==b&&"\n"!==b&&"\r"!==b?("["===b?v=!0:"]"===b&&(v=!1),m+=b):g("Invalid code point in host/hostname: "+b)}else if(this._host=r.call(this,m),m="",h="port","hostname"===u)break e;break;case"port":if(/[0-9]/.test(b))m+=b;else{if(b===l||"/"===b||"\\"===b||"?"===b||"#"===b||u){if(""!==m){var A=parseInt(m,10);A!==e[this._scheme]&&(this._port=A+""),m=""}if(u)break e;h="relative path start";continue}"\t"===b||"\n"===b||"\r"===b?g("Invalid code point in port: "+b):o.call(this)}break;case"relative path start":if("\\"===b&&g("'\\' not allowed in path."),h="relative path","/"!==b&&"\\"!==b)continue;break;case"relative path":var T;b!==l&&"/"!==b&&"\\"!==b&&(u||"?"!==b&&"#"!==b)?"\t"!==b&&"\n"!==b&&"\r"!==b&&(m+=a(b)):("\\"===b&&g("\\ not allowed in relative path."),(T=n[m.toLowerCase()])&&(m=T),".."===m?(this._path.pop(),"/"!==b&&"\\"!==b&&this._path.push("")):"."===m&&"/"!==b&&"\\"!==b?this._path.push(""):"."!==m&&("file"===this._scheme&&0===this._path.length&&2===m.length&&c.test(m[0])&&"|"===m[1]&&(m=m[0]+":"),this._path.push(m)),m="","?"===b?(this._query="?",h="query"):"#"===b&&(this._fragment="#",h="fragment"));break;case"query":u||"#"!==b?b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._query+=s(b)):(this._fragment="#",h="fragment");break;case"fragment":b!==l&&"\t"!==b&&"\n"!==b&&"\r"!==b&&(this._fragment+=b)}f++}}function p(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function g(e,t){void 0===t||t instanceof g||(t=new g(String(t))),this._url=e,p.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");u.call(this,n,null,t)}g.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return""===this._username&&null===this._password||(e=this._username+(null!==this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){p.call(this),u.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||u.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],u.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"===this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"===e[0]&&(e=e.slice(1)),u.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"===this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"===e[0]&&(e=e.slice(1)),u.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null";case"blob":try{return new g(this._schemeData).origin||"null"}catch(e){}return"null"}return(e=this.host)?this._scheme+"://"+e:""}},t.URL=g}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocument=function(e){var t,n=new I;if("string"==typeof e)t={url:e};else if((0,r.isArrayBuffer)(e))t={data:e};else if(e instanceof O)t={range:e};else{if("object"!==E(e))throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=e}var i=Object.create(null),o=null,s=null;for(var c in t)if("url"!==c||"undefined"==typeof window)if("range"!==c)if("worker"!==c)if("data"!==c||t[c]instanceof Uint8Array)i[c]=t[c];else{var d=t[c];if("string"==typeof d)i[c]=(0,r.stringToBytes)(d);else if("object"!==E(d)||null===d||isNaN(d.length)){if(!(0,r.isArrayBuffer)(d))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");i[c]=new Uint8Array(d)}else i[c]=new Uint8Array(d)}else s=t[c];else o=t[c];else i[c]=new r.URL(t[c],window.location).href;i.rangeChunkSize=i.rangeChunkSize||65536,i.CMapReaderFactory=i.CMapReaderFactory||a.DOMCMapReaderFactory,i.ignoreErrors=!0!==i.stopAtErrors,i.pdfBug=!0===i.pdfBug;var g=Object.values(r.NativeImageDecoding);if(void 0!==i.nativeImageDecoderSupport&&g.includes(i.nativeImageDecoderSupport)||(i.nativeImageDecoderSupport=l.apiCompatibilityParams.nativeImageDecoderSupport||r.NativeImageDecoding.DECODE),Number.isInteger(i.maxImageSize)||(i.maxImageSize=-1),"boolean"!=typeof i.isEvalSupported&&(i.isEvalSupported=!0),"boolean"!=typeof i.disableFontFace&&(i.disableFontFace=l.apiCompatibilityParams.disableFontFace||!1),"boolean"!=typeof i.disableRange&&(i.disableRange=!1),"boolean"!=typeof i.disableStream&&(i.disableStream=!1),"boolean"!=typeof i.disableAutoFetch&&(i.disableAutoFetch=!1),"boolean"!=typeof i.disableCreateObjectURL&&(i.disableCreateObjectURL=l.apiCompatibilityParams.disableCreateObjectURL||!1),(0,r.setVerbosityLevel)(i.verbosity),!s){var f={postMessageTransfers:i.postMessageTransfers,verbosity:i.verbosity,port:u.GlobalWorkerOptions.workerPort};s=f.port?M.fromPort(f):new M(f),n._worker=s}var m=n.docId;return s.promise.then((function(){if(n.destroyed)throw new Error("Loading aborted");return function(e,t,n,i){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(n&&(t.length=n.length,t.initialData=n.initialData),e.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"2.1.286",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,disableCreateObjectURL:t.disableCreateObjectURL,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,nativeImageDecoderSupport:t.nativeImageDecoderSupport,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,disableCMYKToRGB:t.disableCMYKToRGB}).then((function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t})))}(s,i,o,m).then((function(e){if(n.destroyed)throw new Error("Loading aborted");var t;o?t=new h.PDFDataTransportStream({length:i.length,initialData:i.initialData,disableRange:i.disableRange,disableStream:i.disableStream},o):i.data||(t=P({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream}));var r=new p.MessageHandler(m,e,s.port);r.postMessageTransfers=s.postMessageTransfers;var a=new B(r,n,t,i);n._transport=a,r.send("Ready",null)}))})).catch(n._capability.reject),n},t.setPDFNetworkStreamFactory=function(e){P=e},t.build=t.version=t.PDFPageProxy=t.PDFDocumentProxy=t.PDFWorker=t.PDFDataRangeTransport=t.LoopbackPort=void 0;var o=m(i(147)),r=i(1),a=i(151),s=i(152),l=i(153),c=i(154),d=m(i(3)),u=i(156),p=i(157),g=i(158),h=i(160),f=i(161);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function C(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),e}function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var S,G,A=!1,T=!1;"undefined"==typeof window?(A=!0,T=!0):T=!0,"undefined"!=typeof requirejs&&requirejs.toUrl&&(S=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var P,L="undefined"!=typeof requirejs&&requirejs.load;if(G=T?function(){return new Promise((function(e,t){n.e(13).then(function(){try{var i;i=n(1079),e(i.WorkerMessageHandler)}catch(e){t(e)}}.bind(null,n)).catch(t)}))}:L?function(){return new Promise((function(e,t){requirejs(["pdfjs-dist/build/pdf.worker"],(function(n){try{e(n.WorkerMessageHandler)}catch(e){t(e)}}),t)}))}:null,!S&&"object"===("undefined"==typeof document?"undefined":E(document))&&"currentScript"in document){var D=document.currentScript&&document.currentScript.src;D&&(S=D.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}var x,I=(x=0,function(){function e(){b(this,e),this._capability=(0,r.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+x++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return C(e,[{key:"destroy",value:function(){var e=this;return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then((function(){e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)}))}},{key:"then",value:function(e,t){return(0,r.deprecated)("PDFDocumentLoadingTask.then method, use the `promise` getter instead."),this.promise.then.apply(this.promise,arguments)}},{key:"promise",get:function(){return this._capability.promise}}]),e}()),O=function(){function e(t,n){b(this,e),this.length=t,this.initialData=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=(0,r.createPromiseCapability)()}return C(e,[{key:"addRangeListener",value:function(e){this._rangeListeners.push(e)}},{key:"addProgressListener",value:function(e){this._progressListeners.push(e)}},{key:"addProgressiveReadListener",value:function(e){this._progressiveReadListeners.push(e)}},{key:"onDataRange",value:function(e,t){var n=!0,i=!1,o=void 0;try{for(var r,a=this._rangeListeners[Symbol.iterator]();!(n=(r=a.next()).done);n=!0)(0,r.value)(e,t)}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}}},{key:"onDataProgress",value:function(e){var t=this;this._readyCapability.promise.then((function(){var n=!0,i=!1,o=void 0;try{for(var r,a=t._progressListeners[Symbol.iterator]();!(n=(r=a.next()).done);n=!0)(0,r.value)(e)}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}}))}},{key:"onDataProgressiveRead",value:function(e){var t=this;this._readyCapability.promise.then((function(){var n=!0,i=!1,o=void 0;try{for(var r,a=t._progressiveReadListeners[Symbol.iterator]();!(n=(r=a.next()).done);n=!0)(0,r.value)(e)}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}}))}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(e,t){(0,r.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),e}();t.PDFDataRangeTransport=O;var k=function(){function e(t,n,i){b(this,e),this.loadingTask=i,this._pdfInfo=t,this._transport=n}return C(e,[{key:"getPage",value:function(e){return this._transport.getPage(e)}},{key:"getPageIndex",value:function(e){return this._transport.getPageIndex(e)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(e){return this._transport.getDestination(e)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getOpenActionDestination",value:function(){return this._transport.getOpenActionDestination()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"getStats",value:function(){return this._transport.getStats()}},{key:"cleanup",value:function(){this._transport.startCleanup()}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprint",get:function(){return this._pdfInfo.fingerprint}},{key:"loadingParams",get:function(){return this._transport.loadingParams}}]),e}();t.PDFDocumentProxy=k;var F=function(){function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];b(this,e),this.pageIndex=t,this._pageInfo=n,this._transport=i,this._stats=o?new a.StatTimer:a.DummyStatTimer,this._pdfBug=o,this.commonObjs=i.commonObjs,this.objs=new $,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return C(e,[{key:"getViewport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scale,n=e.rotation,i=void 0===n?this.rotate:n,o=e.dontFlip,s=void 0!==o&&o;return(arguments.length>1||"number"==typeof arguments[0])&&((0,r.deprecated)("getViewport is called with obsolete arguments."),t=arguments[0],i="number"==typeof arguments[1]?arguments[1]:this.rotate,s="boolean"==typeof arguments[2]&&arguments[2]),new a.PageViewport({viewBox:this.view,scale:t,rotation:i,dontFlip:s})}},{key:"getAnnotations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.intent,n=void 0===t?null:t;return this.annotationsPromise&&this.annotationsIntent===n||(this.annotationsPromise=this._transport.getAnnotations(this.pageIndex,n),this.annotationsIntent=n),this.annotationsPromise}},{key:"render",value:function(e){var t=this,n=e.canvasContext,i=e.viewport,o=e.intent,s=void 0===o?"display":o,l=e.enableWebGL,c=void 0!==l&&l,d=e.renderInteractiveForms,u=void 0!==d&&d,p=e.transform,g=void 0===p?null:p,h=e.imageLayer,m=void 0===h?null:h,y=e.canvasFactory,v=void 0===y?null:y,_=e.background,b=void 0===_?null:_,w=e.canvasGraphicsClass,C=void 0===w?null:w,E=e.progress,S=void 0===E?null:E,G=this._stats;G.time("Overall"),this.pendingCleanup=!1;var A="print"===s?"print":"display",T=v||new a.DOMCanvasFactory,P=new f.WebGLContext({enable:c});this.intentStates[A]||(this.intentStates[A]=Object.create(null));var L=this.intentStates[A];L.displayReadyCapability||(L.receivingOperatorList=!0,L.displayReadyCapability=(0,r.createPromiseCapability)(),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1},G.time("Page Request"),this._transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:A,renderInteractiveForms:!0===u}));var D=function(e){var n=L.renderTasks.indexOf(x);n>=0&&L.renderTasks.splice(n,1),t.cleanupAfterRender&&(t.pendingCleanup=!0),t._tryCleanup(),e?x.capability.reject(e):x.capability.resolve(),G.timeEnd("Rendering"),G.timeEnd("Overall")},x=new K({callback:D,params:{canvasContext:n,viewport:i,transform:g,imageLayer:m,background:b,progress:S},objs:this.objs,commonObjs:this.commonObjs,operatorList:L.operatorList,pageNumber:this.pageNumber,canvasFactory:T,canvasGraphicsClass:C,webGLContext:P,useRequestAnimationFrame:"print"!==A,pdfBug:this._pdfBug});L.renderTasks||(L.renderTasks=[]),L.renderTasks.push(x);var I=x.task;return L.displayReadyCapability.promise.then((function(e){t.pendingCleanup?D():(G.time("Rendering"),x.initializeGraphics(e),x.operatorListChanged())})).catch(D),I}},{key:"getOperatorList",value:function(){this.intentStates.oplist||(this.intentStates.oplist=Object.create(null));var e,t=this.intentStates.oplist;return t.opListReadCapability||((e={}).operatorListChanged=function(){if(t.operatorList.lastChunk){t.opListReadCapability.resolve(t.operatorList);var n=t.renderTasks.indexOf(e);n>=0&&t.renderTasks.splice(n,1)}},t.receivingOperatorList=!0,t.opListReadCapability=(0,r.createPromiseCapability)(),t.renderTasks=[],t.renderTasks.push(e),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats.time("Page Request"),this._transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:"oplist"})),t.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.normalizeWhitespace,n=void 0!==t&&t,i=e.disableCombineTextItems,o=void 0!==i&&i,r=100;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:!0===n,combineTextItems:!0!==o},{highWaterMark:r,size:function(e){return e.items.length}})}},{key:"getTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.streamTextContent(e);return new Promise((function(e,n){var i=t.getReader(),o={items:[],styles:Object.create(null)};!function t(){i.read().then((function(n){var i,r=n.value;n.done?e(o):(Object.assign(o.styles,r.styles),(i=o.items).push.apply(i,_(r.items)),t())}),n)}()}))}},{key:"_destroy",value:function(){this.destroyed=!0,this._transport.pageCache[this.pageIndex]=null;var e=[];return Object.keys(this.intentStates).forEach((function(t){"oplist"!==t&&this.intentStates[t].renderTasks.forEach((function(t){var n=t.capability.promise.catch((function(){}));e.push(n),t.cancel()}))}),this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)}},{key:"cleanup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup=!0,this._tryCleanup(e)}},{key:"_tryCleanup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup&&!Object.keys(this.intentStates).some((function(e){var t=this.intentStates[e];return 0!==t.renderTasks.length||t.receivingOperatorList}),this)&&(Object.keys(this.intentStates).forEach((function(e){delete this.intentStates[e]}),this),this.objs.clear(),this.annotationsPromise=null,e&&this._stats instanceof a.StatTimer&&(this._stats=new a.StatTimer),this.pendingCleanup=!1)}},{key:"_startRenderPage",value:function(e,t){var n=this.intentStates[t];n.displayReadyCapability&&n.displayReadyCapability.resolve(e)}},{key:"_renderPageChunk",value:function(e,t){for(var n=this.intentStates[t],i=0,o=e.length;i<o;i++)n.operatorList.fnArray.push(e.fnArray[i]),n.operatorList.argsArray.push(e.argsArray[i]);n.operatorList.lastChunk=e.lastChunk;for(var r=0;r<n.renderTasks.length;r++)n.renderTasks[r].operatorListChanged();e.lastChunk&&(n.receivingOperatorList=!1,this._tryCleanup())}},{key:"pageNumber",get:function(){return this.pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"stats",get:function(){return this._stats instanceof a.StatTimer?this._stats:null}}]),e}();t.PDFPageProxy=F;var R=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];b(this,e),this._listeners=[],this._defer=t,this._deferred=Promise.resolve(void 0)}return C(e,[{key:"postMessage",value:function(e,t){var n=this;if(this._defer){var i=new WeakMap,o={data:function e(n){if("object"!==E(n)||null===n)return n;if(i.has(n))return i.get(n);var o,a;if((o=n.buffer)&&(0,r.isArrayBuffer)(o)){var s=t&&t.includes(o);return a=n===o?n:s?new n.constructor(o,n.byteOffset,n.byteLength):new n.constructor(n),i.set(n,a),a}for(var l in a=Array.isArray(n)?[]:{},i.set(n,a),n){for(var c=void 0,d=n;!(c=Object.getOwnPropertyDescriptor(d,l));)d=Object.getPrototypeOf(d);void 0!==c.value&&"function"!=typeof c.value&&(a[l]=e(c.value))}return a}(e)};this._deferred.then((function(){n._listeners.forEach((function(e){e.call(this,o)}),n)}))}else this._listeners.forEach((function(t){t.call(this,{data:e})}),this)}},{key:"addEventListener",value:function(e,t){this._listeners.push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)}},{key:"terminate",value:function(){this._listeners=[]}}]),e}();t.LoopbackPort=R;var M=function(){var e,t=new WeakMap,n=0;function i(){if(u.GlobalWorkerOptions.workerSrc)return u.GlobalWorkerOptions.workerSrc;if(void 0!==S)return S;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function o(){try{if("undefined"!=typeof window)return window.pdfjsWorker&&window.pdfjsWorker.WorkerMessageHandler}catch(e){}return null}return function(){function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.name,i=void 0===n?null:n,o=e.port,a=void 0===o?null:o,l=e.postMessageTransfers,c=void 0===l||l,d=e.verbosity,u=void 0===d?(0,r.getVerbosityLevel)():d;if(b(this,s),a&&t.has(a))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=i,this.destroyed=!1,this.postMessageTransfers=!1!==c,this.verbosity=u,this._readyCapability=(0,r.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,a)return t.set(a,this),void this._initializeFromPort(a);this._initialize()}return C(s,[{key:"_initializeFromPort",value:function(e){this._port=e,this._messageHandler=new p.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}},{key:"_initialize",value:function(){var e,t,n=this;if("undefined"!=typeof Worker&&!A&&!o()){var a=i();try{(0,r.isSameOrigin)(window.location.href,a)||(e=new r.URL(a,window.location).href,t="importScripts('"+e+"');",a=r.URL.createObjectURL(new Blob([t])));var s=new Worker(a),l=new p.MessageHandler("main","worker",s),c=function(){s.removeEventListener("error",d),l.destroy(),s.terminate(),n.destroyed?n._readyCapability.reject(new Error("Worker was destroyed")):n._setupFakeWorker()},d=function(){n._webWorker||c()};s.addEventListener("error",d),l.on("test",(function(e){s.removeEventListener("error",d),n.destroyed?c():e&&e.supportTypedArray?(n._messageHandler=l,n._port=s,n._webWorker=s,e.supportTransfers||(n.postMessageTransfers=!1),n._readyCapability.resolve(),l.send("configure",{verbosity:n.verbosity})):(n._setupFakeWorker(),l.destroy(),s.terminate())})),l.on("ready",(function(e){if(s.removeEventListener("error",d),n.destroyed)c();else try{u()}catch(e){n._setupFakeWorker()}}));var u=function(){var e=new Uint8Array([n.postMessageTransfers?255:0]);try{l.send("test",e,[e.buffer])}catch(t){(0,r.info)("Cannot use postMessage transfers"),e[0]=0,l.send("test",e)}};return void u()}catch(e){(0,r.info)("The worker has been disabled.")}}this._setupFakeWorker()}},{key:"_setupFakeWorker",value:function(){var t=this;A||((0,r.warn)("Setting up fake worker."),A=!0),function(){if(e)return e.promise;e=(0,r.createPromiseCapability)();var t=o();return t?(e.resolve(t),e.promise):((G||function(){return(0,a.loadScript)(i()).then((function(){return window.pdfjsWorker.WorkerMessageHandler}))})().then(e.resolve,e.reject),e.promise)}().then((function(e){if(t.destroyed)t._readyCapability.reject(new Error("Worker was destroyed"));else{var i=new R;t._port=i;var o="fake"+n++,r=new p.MessageHandler(o+"_worker",o,i);e.setup(r,i);var a=new p.MessageHandler(o,o+"_worker",i);t._messageHandler=a,t._readyCapability.resolve()}})).catch((function(e){t._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))}))}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},{key:"promise",get:function(){return this._readyCapability.promise}},{key:"port",get:function(){return this._port}},{key:"messageHandler",get:function(){return this._messageHandler}}],[{key:"fromPort",value:function(e){if(!e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return t.has(e.port)?t.get(e.port):new s(e)}},{key:"getWorkerSrc",value:function(){return i()}}]),s}()}();t.PDFWorker=M;var N,B=function(){function e(t,n,i,o){b(this,e),this.messageHandler=t,this.loadingTask=n,this.commonObjs=new $,this.fontLoader=new s.FontLoader({docId:n.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this)}),this._params=o,this.CMapReaderFactory=new o.CMapReaderFactory({baseUrl:o.cMapUrl,isCompressed:o.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,r.createPromiseCapability)(),this.setupMessageHandler()}return C(e,[{key:"destroy",value:function(){var e=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,r.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach((function(e){e&&t.push(e._destroy())})),this.pageCache=[],this.pagePromises=[];var n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then((function(){e.fontLoader.clear(),e._networkStream&&e._networkStream.cancelAllRequests(),e.messageHandler&&(e.messageHandler.destroy(),e.messageHandler=null),e.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var e=this.messageHandler,t=this.loadingTask;e.on("GetReader",(function(e,t){var n=this;(0,r.assert)(this._networkStream),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=function(e){n._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=function(){n._fullReader.read().then((function(e){var n=e.value;e.done?t.close():((0,r.assert)((0,r.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))})).catch((function(e){t.error(e)}))},t.onCancel=function(e){n._fullReader.cancel(e)}}),this),e.on("ReaderHeadersReady",(function(e){var n=this,i=(0,r.createPromiseCapability)(),o=this._fullReader;return o.headersReady.then((function(){o.isStreamingSupported&&o.isRangeSupported||(n._lastProgress&&t.onProgress&&t.onProgress(n._lastProgress),o.onProgress=function(e){t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),i.resolve({isStreamingSupported:o.isStreamingSupported,isRangeSupported:o.isRangeSupported,contentLength:o.contentLength})}),i.reject),i.promise}),this),e.on("GetRangeReader",(function(e,t){(0,r.assert)(this._networkStream);var n=this._networkStream.getRangeReader(e.begin,e.end);t.onPull=function(){n.read().then((function(e){var n=e.value;e.done?t.close():((0,r.assert)((0,r.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))})).catch((function(e){t.error(e)}))},t.onCancel=function(e){n.cancel(e)}}),this),e.on("GetDoc",(function(e){var n=e.pdfInfo;this.numPages=n.numPages,this.pdfDocument=new k(n,this,t),t._capability.resolve(this.pdfDocument)}),this),e.on("PasswordRequest",(function(e){var n=this;if(this._passwordCapability=(0,r.createPromiseCapability)(),t.onPassword)try{t.onPassword((function(e){n._passwordCapability.resolve({password:e})}),e.code)}catch(e){this._passwordCapability.reject(e)}else this._passwordCapability.reject(new r.PasswordException(e.message,e.code));return this._passwordCapability.promise}),this),e.on("PasswordException",(function(e){t._capability.reject(new r.PasswordException(e.message,e.code))}),this),e.on("InvalidPDF",(function(e){t._capability.reject(new r.InvalidPDFException(e.message))}),this),e.on("MissingPDF",(function(e){t._capability.reject(new r.MissingPDFException(e.message))}),this),e.on("UnexpectedResponse",(function(e){t._capability.reject(new r.UnexpectedResponseException(e.message,e.status))}),this),e.on("UnknownError",(function(e){t._capability.reject(new r.UnknownErrorException(e.message,e.details))}),this),e.on("DataLoaded",(function(e){t.onProgress&&t.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),this),e.on("StartRenderPage",(function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex];t._stats.timeEnd("Page Request"),t._startRenderPage(e.transparency,e.intent)}}),this),e.on("RenderPageChunk",(function(e){this.destroyed||this.pageCache[e.pageIndex]._renderPageChunk(e.operatorList,e.intent)}),this),e.on("commonobj",(function(t){var n=this;if(!this.destroyed){var i=v(t,3),o=i[0],a=i[1],l=i[2];if(!this.commonObjs.has(o))switch(a){case"Font":var c=this._params;if("error"in l){var u=l.error;(0,r.warn)("Error during font loading: ".concat(u)),this.commonObjs.resolve(o,u);break}var p=null;c.pdfBug&&d.default.FontInspector&&d.default.FontInspector.enabled&&(p={registerFont:function(e,t){d.default.FontInspector.fontAdded(e,t)}});var g=new s.FontFaceObject(l,{isEvalSupported:c.isEvalSupported,disableFontFace:c.disableFontFace,ignoreErrors:c.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:p});this.fontLoader.bind(g).then((function(){n.commonObjs.resolve(o,g)}),(function(t){e.sendWithPromise("FontFallback",{id:o}).finally((function(){n.commonObjs.resolve(o,g)}))}));break;case"FontPath":this.commonObjs.resolve(o,l);break;default:throw new Error("Got unknown common object type ".concat(a))}}}),this),e.on("obj",(function(e){if(!this.destroyed){var t=v(e,4),n=t[0],i=t[1],o=t[2],r=t[3],a=this.pageCache[i];if(!a.objs.has(n))switch(o){case"JpegStream":return new Promise((function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t(new Error("Error during JPEG image loading"))},n.src=r})).then((function(e){a.objs.resolve(n,e)}));case"Image":a.objs.resolve(n,r),r&&"data"in r&&r.data.length>8e6&&(a.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type ".concat(o))}}}),this),e.on("DocProgress",(function(e){this.destroyed||t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),this),e.on("PageError",(function(e){if(!this.destroyed){var t=this.pageCache[e.pageNum-1].intentStates[e.intent];if(!t.displayReadyCapability)throw new Error(e.error);if(t.displayReadyCapability.reject(e.error),t.operatorList){t.operatorList.lastChunk=!0;for(var n=0;n<t.renderTasks.length;n++)t.renderTasks[n].operatorListChanged()}}}),this),e.on("UnsupportedFeature",this._onUnsupportedFeature,this),e.on("JpegDecode",(function(e){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));if("undefined"==typeof document)return Promise.reject(new Error('"document" is not defined.'));var t=v(e,2),n=t[0],i=t[1];return 3!==i&&1!==i?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise((function(e,t){var o=new Image;o.onload=function(){var t=o.width,n=o.height,r=t*n,a=4*r,s=new Uint8ClampedArray(r*i),l=document.createElement("canvas");l.width=t,l.height=n;var c=l.getContext("2d");c.drawImage(o,0,0);var d=c.getImageData(0,0,t,n).data;if(3===i)for(var u=0,p=0;u<a;u+=4,p+=3)s[p]=d[u],s[p+1]=d[u+1],s[p+2]=d[u+2];else if(1===i)for(var g=0,h=0;g<a;g+=4,h++)s[h]=d[g];e({data:s,width:t,height:n})},o.onerror=function(){t(new Error("JpegDecode failed to load image"))},o.src=n}))}),this),e.on("FetchBuiltInCMap",(function(e){return this.destroyed?Promise.reject(new Error("Worker was destroyed")):this.CMapReaderFactory.fetch({name:e.name})}),this)}},{key:"_onUnsupportedFeature",value:function(e){var t=e.featureId;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(e){var t=this;if(!Number.isInteger(e)||e<=0||e>this.numPages)return Promise.reject(new Error("Invalid page request"));var n=e-1;if(n in this.pagePromises)return this.pagePromises[n];var i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then((function(e){if(t.destroyed)throw new Error("Transport destroyed");var i=new F(n,e,t,t._params.pdfBug);return t.pageCache[n]=i,i}));return this.pagePromises[n]=i,i}},{key:"getPageIndex",value:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch((function(e){return Promise.reject(new Error(e))}))}},{key:"getAnnotations",value:function(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getOpenActionDestination",value:function(){return this.messageHandler.sendWithPromise("getOpenActionDestination",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var e=this;return this.messageHandler.sendWithPromise("GetMetadata",null).then((function(t){return{info:t[0],metadata:t[1]?new g.Metadata(t[1]):null,contentDispositionFilename:e._fullReader?e._fullReader.filename:null}}))}},{key:"getStats",value:function(){return this.messageHandler.sendWithPromise("GetStats",null)}},{key:"startCleanup",value:function(){var e=this;this.messageHandler.sendWithPromise("Cleanup",null).then((function(){for(var t=0,n=e.pageCache.length;t<n;t++){var i=e.pageCache[t];i&&i.cleanup()}e.commonObjs.clear(),e.fontLoader.clear()}))}},{key:"loadingParams",get:function(){var e=this._params;return(0,r.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableCreateObjectURL:e.disableCreateObjectURL,disableFontFace:e.disableFontFace,nativeImageDecoderSupport:e.nativeImageDecoderSupport})}}]),e}(),$=function(){function e(){b(this,e),this._objs=Object.create(null)}return C(e,[{key:"_ensureObj",value:function(e){return this._objs[e]?this._objs[e]:this._objs[e]={capability:(0,r.createPromiseCapability)(),data:null,resolved:!1}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)return this._ensureObj(e).capability.promise.then(t),null;var n=this._objs[e];if(!n||!n.resolved)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}},{key:"has",value:function(e){var t=this._objs[e];return!!t&&t.resolved}},{key:"resolve",value:function(e,t){var n=this._ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)}},{key:"clear",value:function(){this._objs=Object.create(null)}}]),e}(),U=function(){function e(t){b(this,e),this._internalRenderTask=t,this.onContinue=null}return C(e,[{key:"cancel",value:function(){this._internalRenderTask.cancel()}},{key:"then",value:function(e,t){return(0,r.deprecated)("RenderTask.then method, use the `promise` getter instead."),this.promise.then.apply(this.promise,arguments)}},{key:"promise",get:function(){return this._internalRenderTask.capability.promise}}]),e}(),K=(N=new WeakSet,function(){function e(t){var n=t.callback,i=t.params,o=t.objs,a=t.commonObjs,s=t.operatorList,l=t.pageNumber,d=t.canvasFactory,u=t.canvasGraphicsClass,p=t.webGLContext,g=t.useRequestAnimationFrame,h=void 0!==g&&g,f=t.pdfBug,m=void 0!==f&&f;b(this,e),this.callback=n,this.params=i,this.objs=o,this.commonObjs=a,this.operatorListIdx=null,this.operatorList=s,this.pageNumber=l,this.canvasFactory=d,this.CanvasGraphics=u||c.CanvasGraphics,this.webGLContext=p,this._pdfBug=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,r.createPromiseCapability)(),this.task=new U(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}var t,n;return C(e,[{key:"initializeGraphics",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.cancelled){if(this._canvas){if(N.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");N.add(this._canvas)}this._pdfBug&&d.default.StepperManager&&d.default.StepperManager.enabled&&(this.stepper=d.default.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var t=this.params,n=t.canvasContext,i=t.viewport,o=t.transform,r=t.imageLayer,a=t.background;this.gfx=new this.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,r),this.gfx.beginDrawing({transform:o,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}}},{key:"cancel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&N.delete(this._canvas),this.callback(e||new a.RenderingCancelledException("Rendering cancelled, page ".concat(this.pageNumber),"canvas"))}},{key:"operatorListChanged",value:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var e=this;this._useRequestAnimationFrame?window.requestAnimationFrame((function(){e._nextBound().catch(e.cancel.bind(e))})):Promise.resolve().then(this._nextBound).catch(this.cancel.bind(this))}},{key:"_next",value:(t=o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled){e.next=2;break}return e.abrupt("return");case 2:try{this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this.params.progress),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&N.delete(this._canvas),this.callback()))}catch(e){this.capability.reject(e)}case 3:case"end":return e.stop()}}),e,this)})),n=function(){var e=this,n=arguments;return new Promise((function(i,o){var r=t.apply(e,n);function a(e){y(r,i,o,a,s,"next",e)}function s(e){y(r,i,o,a,s,"throw",e)}a(void 0)}))},function(){return n.apply(this,arguments)})}]),e}());t.version="2.1.286",t.build="7525e341"},function(e,t,n){"use strict";e.exports=n(148)},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=function(){return this||"object"===("undefined"==typeof self?"undefined":i(self))&&self}()||Function("return this")(),r=o.regeneratorRuntime&&Object.getOwnPropertyNames(o).indexOf("regeneratorRuntime")>=0,a=r&&o.regeneratorRuntime;if(o.regeneratorRuntime=void 0,e.exports=n(149),r)o.regeneratorRuntime=a;else try{delete o.regeneratorRuntime}catch(e){o.regeneratorRuntime=void 0}},function(e,t,n){"use strict";(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(n){var i=Object.prototype,o=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag",c="object"===t(e),d=n.regeneratorRuntime;if(d)c&&(e.exports=d);else{(d=n.regeneratorRuntime=c?e.exports:{}).wrap=m;var u={},p={};p[a]=function(){return this};var g=Object.getPrototypeOf,h=g&&g(g(T([])));h&&h!==i&&o.call(h,a)&&(p=h);var f=b.prototype=v.prototype=Object.create(p);_.prototype=f.constructor=b,b.constructor=_,b[l]=_.displayName="GeneratorFunction",d.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},d.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(f),e},d.awrap=function(e){return{__await:e}},w(C.prototype),C.prototype[s]=function(){return this},d.AsyncIterator=C,d.async=function(e,t,n,i){var o=new C(m(e,t,n,i));return d.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(f),f[l]="Generator",f[a]=function(){return this},f.toString=function(){return"[object Generator]"},d.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},d.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(G),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),G(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var o=i.arg;G(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}}}function m(e,t,n,i){var o=t&&t.prototype instanceof v?t:v,r=Object.create(o.prototype),a=new A(i||[]);return r._invoke=function(e,t,n){var i="suspendedStart";return function(o,r){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===o)throw r;return{value:void 0,done:!0}}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=y(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),r}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function v(){}function _(){}function b(){}function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){var n;this._invoke=function(i,r){function a(){return new Promise((function(n,a){!function n(i,r,a,s){var l=y(e[i],e,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"===t(d)&&o.call(d,"__await")?Promise.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):Promise.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}(i,r,n,a)}))}return n=n?n.then(a,a):a()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var i=y(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,u;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function G(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}}(function(){return this||"object"===("undefined"==typeof self?"undefined":t(self))&&self}()||Function("return this")())}).call(this,n(150)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLinkAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,o=t.target,r=t.rel;if(e.href=e.title=n?(0,i.removeNullCharacters)(n):"",n){var a=Object.values(g),s=a.includes(o)?o:g.NONE;e.target=h[s],e.rel="string"==typeof r?r:"noopener noreferrer nofollow"}},t.getFilenameFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("?"),i=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",i)+1,i)},t.loadScript=function(e){return new Promise((function(t,n){var i=document.createElement("script");i.src=e,i.onload=t,i.onerror=function(){n(new Error("Cannot load script at: ".concat(i.src)))},(document.head||document.documentElement).appendChild(i)}))},t.DummyStatTimer=t.StatTimer=t.DOMSVGFactory=t.DOMCMapReaderFactory=t.DOMCanvasFactory=t.DEFAULT_LINK_REL=t.LinkTarget=t.RenderingCancelledException=t.PageViewport=void 0;var i=n(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}t.DEFAULT_LINK_REL="noopener noreferrer nofollow";var s="http://www.w3.org/2000/svg",l=function(){function e(){o(this,e)}return a(e,[{key:"create",value:function(e,t){if(e<=0||t<=0)throw new Error("invalid canvas size");var n=document.createElement("canvas"),i=n.getContext("2d");return n.width=e,n.height=t,{canvas:n,context:i}}},{key:"reset",value:function(e,t,n){if(!e.canvas)throw new Error("canvas is not specified");if(t<=0||n<=0)throw new Error("invalid canvas size");e.canvas.width=t,e.canvas.height=n}},{key:"destroy",value:function(e){if(!e.canvas)throw new Error("canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}]),e}();t.DOMCanvasFactory=l;var c=function(){function e(t){var n=t.baseUrl,i=void 0===n?null:n,r=t.isCompressed,a=void 0!==r&&r;o(this,e),this.baseUrl=i,this.isCompressed=a}return a(e,[{key:"fetch",value:function(e){var t=this,n=e.name;return this.baseUrl?n?new Promise((function(e,o){var r=t.baseUrl+n+(t.isCompressed?".bcmap":""),a=new XMLHttpRequest;a.open("GET",r,!0),t.isCompressed&&(a.responseType="arraybuffer"),a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE){var n;if((200===a.status||0===a.status)&&(t.isCompressed&&a.response?n=new Uint8Array(a.response):!t.isCompressed&&a.responseText&&(n=(0,i.stringToBytes)(a.responseText)),n))return void e({cMapData:n,compressionType:t.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE});o(new Error("Unable to load "+(t.isCompressed?"binary ":"")+"CMap at: "+r))}},a.send(null)})):Promise.reject(new Error("CMap name must be specified.")):Promise.reject(new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.'))}}]),e}();t.DOMCMapReaderFactory=c;var d=function(){function e(){o(this,e)}return a(e,[{key:"create",value:function(e,t){(0,i.assert)(e>0&&t>0,"Invalid SVG dimensions");var n=document.createElementNS(s,"svg:svg");return n.setAttribute("version","1.1"),n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+e+" "+t),n}},{key:"createElement",value:function(e){return(0,i.assert)("string"==typeof e,"Invalid SVG element type"),document.createElementNS(s,e)}}]),e}();t.DOMSVGFactory=d;var u=function(){function e(t){var n=t.viewBox,i=t.scale,r=t.rotation,a=t.offsetX,s=void 0===a?0:a,l=t.offsetY,c=void 0===l?0:l,d=t.dontFlip,u=void 0!==d&&d;o(this,e),this.viewBox=n,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=c;var p,g,h,f,m,y,v,_,b=(n[2]+n[0])/2,w=(n[3]+n[1])/2;switch(r=(r%=360)<0?r+360:r){case 180:p=-1,g=0,h=0,f=1;break;case 90:p=0,g=1,h=1,f=0;break;case 270:p=0,g=-1,h=-1,f=0;break;default:p=1,g=0,h=0,f=-1}u&&(h=-h,f=-f),0===p?(m=Math.abs(w-n[1])*i+s,y=Math.abs(b-n[0])*i+c,v=Math.abs(n[3]-n[1])*i,_=Math.abs(n[2]-n[0])*i):(m=Math.abs(b-n[0])*i+s,y=Math.abs(w-n[1])*i+c,v=Math.abs(n[2]-n[0])*i,_=Math.abs(n[3]-n[1])*i),this.transform=[p*i,g*i,h*i,f*i,m-p*i*b-h*i*w,y-g*i*b-f*i*w],this.width=v,this.height=_}return a(e,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,i=void 0===n?this.scale:n,o=t.rotation,r=void 0===o?this.rotation:o,a=t.dontFlip,s=void 0!==a&&a;return new e({viewBox:this.viewBox.slice(),scale:i,rotation:r,offsetX:this.offsetX,offsetY:this.offsetY,dontFlip:s})}},{key:"convertToViewportPoint",value:function(e,t){return i.Util.applyTransform([e,t],this.transform)}},{key:"convertToViewportRectangle",value:function(e){var t=i.Util.applyTransform([e[0],e[1]],this.transform),n=i.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}},{key:"convertToPdfPoint",value:function(e,t){return i.Util.applyInverseTransform([e,t],this.transform)}}]),e}();t.PageViewport=u;var p=function(){function e(e,t){this.message=e,this.type=t}return e.prototype=new Error,e.prototype.name="RenderingCancelledException",e.constructor=e,e}();t.RenderingCancelledException=p;var g={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};t.LinkTarget=g;var h=["","_self","_blank","_parent","_top"],f=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o(this,e),this.enabled=!!t,this.started=Object.create(null),this.times=[]}return a(e,[{key:"time",value:function(e){this.enabled&&(e in this.started&&(0,i.warn)("Timer is already running for "+e),this.started[e]=Date.now())}},{key:"timeEnd",value:function(e){this.enabled&&(e in this.started||(0,i.warn)("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e])}},{key:"toString",value:function(){for(var e=this.times,t="",n=0,i=0,o=e.length;i<o;++i){var r=e[i].name;r.length>n&&(n=r.length)}for(var a=0,s=e.length;a<s;++a){var l=e[a],c=l.end-l.start;t+="".concat(l.name.padEnd(n)," ").concat(c,"ms\n")}return t}}]),e}();t.StatTimer=f;var m=function(){function e(){o(this,e),(0,i.unreachable)("Cannot initialize DummyStatTimer.")}return a(e,null,[{key:"time",value:function(e){}},{key:"timeEnd",value:function(e){}},{key:"toString",value:function(){return""}}]),e}();t.DummyStatTimer=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i,o=(i=n(147))&&i.__esModule?i:{default:i},r=n(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function g(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var h,f=function(){function e(t){var n=t.docId,i=t.onUnsupportedFeature;u(this,e),this.constructor===e&&(0,r.unreachable)("Cannot initialize BaseFontLoader."),this.docId=n,this._onUnsupportedFeature=i,this.nativeFontFaces=[],this.styleElement=null}var t,n;return g(e,[{key:"addNativeFontFace",value:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)}},{key:"insertRule",value:function(e){var t=this.styleElement;t||((t=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_".concat(this.docId),document.documentElement.getElementsByTagName("head")[0].appendChild(t));var n=t.sheet;n.insertRule(e,n.cssRules.length)}},{key:"clear",value:function(){this.nativeFontFaces.forEach((function(e){document.fonts.delete(e)})),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:(t=o.default.mark((function e(t){var n,i,a=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.attached&&!t.missingFile){e.next=2;break}return e.abrupt("return");case 2:if(t.attached=!0,!this.isFontLoadingAPISupported){e.next=19;break}if(!(n=t.createNativeFontFace())){e.next=18;break}return this.addNativeFontFace(n),e.prev=7,e.next=10,n.loaded;case 10:e.next=18;break;case 12:throw e.prev=12,e.t0=e.catch(7),this._onUnsupportedFeature({featureId:r.UNSUPPORTED_FEATURES.font}),(0,r.warn)("Failed to load font '".concat(n.family,"': '").concat(e.t0,"'.")),t.disableFontFace=!0,e.t0;case 18:return e.abrupt("return");case 19:if(!(i=t.createFontFaceRule())){e.next=25;break}if(this.insertRule(i),!this.isSyncFontLoadingSupported){e.next=24;break}return e.abrupt("return");case 24:return e.abrupt("return",new Promise((function(e){var n=a._queueLoadingCallback(e);a._prepareFontLoadEvent([i],[t],n)})));case 25:case"end":return e.stop()}}),e,this,[[7,12]])})),n=function(){var e=this,n=arguments;return new Promise((function(i,o){var r=t.apply(e,n);function a(e){d(r,i,o,a,s,"next",e)}function s(e){d(r,i,o,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)})},{key:"_queueLoadingCallback",value:function(e){(0,r.unreachable)("Abstract method `_queueLoadingCallback`.")}},{key:"_prepareFontLoadEvent",value:function(e,t,n){(0,r.unreachable)("Abstract method `_prepareFontLoadEvent`.")}},{key:"isFontLoadingAPISupported",get:function(){(0,r.unreachable)("Abstract method `isFontLoadingAPISupported`.")}},{key:"isSyncFontLoadingSupported",get:function(){(0,r.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,r.unreachable)("Abstract method `_loadTestFont`.")}}]),e}();t.FontLoader=h,t.FontLoader=h=function(e){function t(e){var n;return u(this,t),(n=s(this,l(t).call(this,e))).loadingContext={requests:[],nextRequestId:0},n.loadTestFontId=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,e),g(t,[{key:"_queueLoadingCallback",value:function(e){var t=this.loadingContext,n={id:"pdfjs-font-loading-".concat(t.nextRequestId++),done:!1,complete:function(){for((0,r.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.requests.length>0&&t.requests[0].done;){var e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(n),n}},{key:"_prepareFontLoadEvent",value:function(e,t,n){function i(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function o(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}var a,s,l=document.createElement("canvas");l.width=1,l.height=1;var c=l.getContext("2d"),d=0,u="lt".concat(Date.now()).concat(this.loadTestFontId++),p=this._loadTestFont,g=i(p=o(p,976,u.length,u),16);for(a=0,s=u.length-3;a<s;a+=4)g=g-1482184792+i(u,a)|0;a<u.length&&(g=g-1482184792+i(u+"XXX",a)|0),p=o(p,16,4,(0,r.string32)(g));var h="url(data:font/opentype;base64,".concat(btoa(p),");"),f='@font-face {font-family:"'.concat(u,'";src:').concat(h,"}");this.insertRule(f);var m=[];for(a=0,s=t.length;a<s;a++)m.push(t[a].loadedName);m.push(u);var y=document.createElement("div");for(y.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),a=0,s=m.length;a<s;++a){var v=document.createElement("span");v.textContent="Hi",v.style.fontFamily=m[a],y.appendChild(v)}document.body.appendChild(y),function e(t,n){if(++d>30)return(0,r.warn)("Load test font never loaded."),void n();c.font="30px "+t,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(u,(function(){document.body.removeChild(y),n.complete()}))}},{key:"isFontLoadingAPISupported",get:function(){var e="undefined"!=typeof document&&!!document.fonts;if(e&&"undefined"!=typeof navigator){var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]<63&&(e=!1)}return(0,r.shadow)(this,"isFontLoadingAPISupported",e)}},{key:"isSyncFontLoadingSupported",get:function(){var e=!1;if("undefined"==typeof navigator)e=!0;else{var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,r.shadow)(this,"isSyncFontLoadingSupported",e)}},{key:"_loadTestFont",get:function(){return(0,r.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}}]),t}(f);var m={get value(){return(0,r.shadow)(this,"value",(0,r.isEvalSupported)())}},y=function(){function e(t,n){var i=n.isEvalSupported,o=void 0===i||i,r=n.disableFontFace,a=void 0!==r&&r,s=n.ignoreErrors,l=void 0!==s&&s,c=n.onUnsupportedFeature,d=void 0===c?null:c,p=n.fontRegistry,g=void 0===p?null:p;for(var h in u(this,e),this.compiledGlyphs=Object.create(null),t)this[h]=t[h];this.isEvalSupported=!1!==o,this.disableFontFace=!0===a,this.ignoreErrors=!0===l,this._onUnsupportedFeature=d,this.fontRegistry=g}return g(e,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var e=(0,r.bytesToString)(new Uint8Array(this.data)),t="url(data:".concat(this.mimetype,";base64,").concat(btoa(e),");"),n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return this.fontRegistry&&this.fontRegistry.registerFont(this,t),n}},{key:"getPathGenerator",value:function(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];var n,i;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:r.UNSUPPORTED_FEATURES.font}),(0,r.warn)('getPathGenerator - ignoring character: "'.concat(e,'".')),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&m.value){for(var o,a="",s=0,l=n.length;s<l;s++)o=void 0!==(i=n[s]).args?i.args.join(","):"",a+="c."+i.cmd+"("+o+");\n";return this.compiledGlyphs[t]=new Function("c","size",a)}return this.compiledGlyphs[t]=function(e,t){for(var o=0,r=n.length;o<r;o++){"scale"===(i=n[o]).cmd&&(i.args=[t,-t]);try{e[i.cmd].apply(e,i.args)}catch(t){throw"function"!=typeof e[i.cmd]?new Error("Unsupported drawing command: "+i.cmd):t}}}}}]),e}();t.FontFaceObject=y},function(e,t,n){"use strict";var i=Object.create(null),o=n(4),r="undefined"!=typeof navigator&&navigator.userAgent||"",a=/Trident/.test(r),s=/CriOS/.test(r);(a||s)&&(i.disableCreateObjectURL=!0),o()&&(i.disableFontFace=!0,i.nativeImageDecoderSupport="none"),t.apiCompatibilityParams=Object.freeze(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var i=n(1),o=n(155),r={get value(){return(0,i.shadow)(r,"value",(0,i.isLittleEndian)())}};function a(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],i=e[2],o=e[3],r=e[4],a=e[5],s=t*o-n*i,l=n*i-t*o;return[o/s,n/l,i/l,t/s,(o*r-i*a)/l,(n*r-t*a)/s]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,i,o,r,a){var s=this._transformMatrix;this._transformMatrix=[s[0]*t+s[2]*n,s[1]*t+s[3]*n,s[0]*i+s[2]*o,s[1]*i+s[3]*o,s[0]*r+s[2]*a+s[4],s[1]*r+s[3]*a+s[5]],e._originalTransform(t,n,i,o,r,a)},e.setTransform=function(t,n,i,o,r,a){this._transformMatrix=[t,n,i,o,r,a],e._originalSetTransform(t,n,i,o,r,a)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=this._transformMatrix;this._transformMatrix=[i[0]*t+i[2]*n,i[1]*t+i[3]*n,i[0]*-n+i[2]*t,i[1]*-n+i[3]*t,i[4],i[5]],this._originalRotate(e)})}var s=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,i){var o;return void 0!==this.cache[e]?(o=this.cache[e],this.canvasFactory.reset(o,t,n),o.context.setTransform(1,0,0,1,0,0)):(o=this.canvasFactory.create(t,n),this.cache[e]=o),i&&a(o.context),o},clear:function(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}(),l=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),c=function(){function e(e,t,n,i,o,r){this.ctx=e,this.current=new l,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.webGLContext=o,this.imageLayer=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new s(this.canvasFactory),e&&a(e),this._cachedGetSinglePixelWidth=null}function t(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)e.putImageData(t,0,0);else{var n,o,a,s,l,c=t.height,d=t.width,u=c%16,p=(c-u)/16,g=0===u?p:p+1,h=e.createImageData(d,16),f=0,m=t.data,y=h.data;if(t.kind===i.ImageKind.GRAYSCALE_1BPP){var v=m.byteLength,_=new Uint32Array(y.buffer,0,y.byteLength>>2),b=_.length,w=d+7>>3,C=4294967295,E=r.value?4278190080:255;for(o=0;o<g;o++){for(s=o<p?16:u,n=0,a=0;a<s;a++){for(var S=v-f,G=0,A=S>w?d:8*S-7,T=-8&A,P=0,L=0;G<T;G+=8)L=m[f++],_[n++]=128&L?C:E,_[n++]=64&L?C:E,_[n++]=32&L?C:E,_[n++]=16&L?C:E,_[n++]=8&L?C:E,_[n++]=4&L?C:E,_[n++]=2&L?C:E,_[n++]=1&L?C:E;for(;G<A;G++)0===P&&(L=m[f++],P=128),_[n++]=L&P?C:E,P>>=1}for(;n<b;)_[n++]=0;e.putImageData(h,0,16*o)}}else if(t.kind===i.ImageKind.RGBA_32BPP){for(a=0,l=16*d*4,o=0;o<p;o++)y.set(m.subarray(f,f+l)),f+=l,e.putImageData(h,0,a),a+=16;o<g&&(l=d*u*4,y.set(m.subarray(f,f+l)),e.putImageData(h,0,a))}else{if(t.kind!==i.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(l=d*(s=16),o=0;o<g;o++){for(o>=p&&(l=d*(s=u)),n=0,a=l;a--;)y[n++]=m[f++],y[n++]=m[f++],y[n++]=m[f++],y[n++]=255;e.putImageData(h,0,16*o)}}}}function n(e,t){for(var n=t.height,i=t.width,o=n%16,r=(n-o)/16,a=0===o?r:r+1,s=e.createImageData(i,16),l=0,c=t.data,d=s.data,u=0;u<a;u++){for(var p=u<r?16:o,g=3,h=0;h<p;h++)for(var f=0,m=0;m<i;m++){if(!f){var y=c[l++];f=128}d[g]=y&f?0:255,g+=4,f>>=1}e.putImageData(s,0,16*u)}}function c(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","_path"],i=0,o=n.length;i<o;i++){var r=n[i];void 0!==e[r]&&(t[r]=e[r])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function d(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function u(e,t,n,i){for(var o=e.length,r=3;r<o;r+=4){var a=e[r];if(0===a)e[r-3]=t,e[r-2]=n,e[r-1]=i;else if(a<255){var s=255-a;e[r-3]=e[r-3]*a+t*s>>8,e[r-2]=e[r-2]*a+n*s>>8,e[r-1]=e[r-1]*a+i*s>>8}}}function p(e,t,n){for(var i=e.length,o=3;o<i;o+=4){var r=n?n[e[o]]:e[o];t[o]=t[o]*r*(1/255)|0}}function g(e,t,n){for(var i=e.length,o=3;o<i;o+=4){var r=77*e[o-3]+152*e[o-2]+28*e[o-1];t[o]=n?t[o]*n[r>>8]>>8:t[o]*r>>16}}function h(e,t,n,i){var o=t.canvas,r=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var a=t.backdrop||null;if(!t.transferMap&&i.isEnabled){var s=i.composeSMask({layer:n.canvas,mask:o,properties:{subtype:t.subtype,backdrop:a}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(s,t.offsetX,t.offsetY)}!function(e,t,n,i,o,r,a){var s,l=!!r,c=l?r[0]:0,d=l?r[1]:0,h=l?r[2]:0;s="Luminosity"===o?g:p;for(var f=Math.min(i,Math.ceil(1048576/n)),m=0;m<i;m+=f){var y=Math.min(f,i-m),v=e.getImageData(0,m,n,y),_=t.getImageData(0,m,n,y);l&&u(v.data,c,d,h),s(v.data,_.data,a),e.putImageData(_,0,m)}}(r,n,o.width,o.height,t.subtype,a,t.transferMap),e.drawImage(o,0,0)}var f=["butt","round","square"],m=["miter","round","bevel"],y={},v={};for(var _ in e.prototype={beginDrawing:function(e){var t=e.transform,n=e.viewport,i=e.transparency,o=void 0!==i&&i,r=e.background,a=void 0===r?null:r,s=this.ctx.canvas.width,l=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=a||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,s,l),this.ctx.restore(),o){var c=this.cachedCanvases.getCanvas("transparent",s,l,!0);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),d(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,n.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,o,r){var a=e.argsArray,s=e.fnArray,l=t||0,c=a.length;if(c===l)return l;for(var d,u=c-l>10&&"function"==typeof n,p=u?Date.now()+15:0,g=0,h=this.commonObjs,f=this.objs;;){if(void 0!==o&&l===o.nextBreakPoint)return o.breakIt(l,n),l;if((d=s[l])!==i.OPS.dependency)this[d].apply(this,a[l]);else for(var m=a[l],y=0,v=m.length;y<v;y++){var _=m[y],b="g"===_[0]&&"_"===_[1]?h:f;if(!b.has(_))return b.get(_,n),l}if(l++,r&&r(l,c),l===c)return l;if(u&&++g>10){if(Date.now()>p)return n(),l;g=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=f[e]},setLineJoin:function(e){this.ctx.lineJoin=m[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)},setRenderingIntent:function(e){},setFlatness:function(e){},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],o=i[0],r=i[1];switch(o){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=r?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,i="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(i,t,n,!0),r=this.ctx,a=r.mozCurrentTransform;this.ctx.save();var s=o.context;s.scale(1/e.scaleX,1/e.scaleY),s.translate(-e.offsetX,-e.offsetY),s.transform.apply(s,a),e.startTransformInverse=s.mozCurrentTransformInverse,c(r,s),this.ctx=s,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),(this.composeSmask||h)(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),c(e,this.ctx),this.current.resumeSMaskCtx=e;var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),(this.composeSmask||h)(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),c(e,this.ctx);var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,n,i,o,r){this.ctx.transform(e,t,n,i,o,r),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,o=this.current,r=o.x,a=o.y,s=0,l=0,c=e.length;s<c;s++)switch(0|e[s]){case i.OPS.rectangle:r=t[l++],a=t[l++];var d=t[l++],u=t[l++];0===d&&(d=this.getSinglePixelWidth()),0===u&&(u=this.getSinglePixelWidth());var p=r+d,g=a+u;this.ctx.moveTo(r,a),this.ctx.lineTo(p,a),this.ctx.lineTo(p,g),this.ctx.lineTo(r,g),this.ctx.lineTo(r,a),this.ctx.closePath();break;case i.OPS.moveTo:r=t[l++],a=t[l++],n.moveTo(r,a);break;case i.OPS.lineTo:r=t[l++],a=t[l++],n.lineTo(r,a);break;case i.OPS.curveTo:r=t[l+4],a=t[l+5],n.bezierCurveTo(t[l],t[l+1],t[l+2],t[l+3],r,a),l+=6;break;case i.OPS.curveTo2:n.bezierCurveTo(r,a,t[l],t[l+1],t[l+2],t[l+3]),r=t[l+2],a=t[l+3],l+=4;break;case i.OPS.curveTo3:r=t[l+2],a=t[l+3],n.bezierCurveTo(t[l],t[l+1],r,a,r,a),l+=4;break;case i.OPS.closePath:n.closePath()}o.setCurrentPoint(r,a)},closePath:function(){this.ctx.closePath()},stroke:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.strokeColor;t.lineWidth=this.current.lineWidth,t.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type?(t.save(),t.strokeStyle=n.getPattern(t,this),t.stroke(),t.restore()):t.stroke(),e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.fillColor,i=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),i=!0),this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill(),i&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=y},eoClip:function(){this.pendingClip=v},beginText:function(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.setTransform.apply(t,i.transform),t.translate(i.x,i.y);try{i.addToPath(t,i.fontSize)}catch(e){console.warn("Couldn't add to path:"+e.message)}}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),o=this.current;if(!n)throw new Error("Can't find font for ".concat(e));if(o.fontMatrix=n.fontMatrix?n.fontMatrix:i.FONT_IDENTITY_MATRIX,0!==o.fontMatrix[0]&&0!==o.fontMatrix[3]||(0,i.warn)("Invalid font matrix for font "+e),t<0?(t=-t,o.fontDirection=-1):o.fontDirection=1,this.current.font=n,this.current.fontSize=t,!n.isType3Font){var r=n.loadedName||"sans-serif",a=n.black?"900":n.bold?"bold":"normal",s=n.italic?"italic":"normal",l='"'.concat(r,'", ').concat(n.fallbackName),c=t<16?16:t>100?100:t;this.current.fontSizeScale=t/c,this.ctx.font="".concat(s," ").concat(a," ").concat(c,"px ").concat(l)}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,i,o,r){this.current.textMatrix=[e,t,n,i,o,r],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,n,o,r){var a,s=this.ctx,l=this.current,c=l.font,d=l.textRenderingMode,u=l.fontSize/l.fontSizeScale,p=d&i.TextRenderingMode.FILL_STROKE_MASK,g=!!(d&i.TextRenderingMode.ADD_TO_PATH_FLAG),h=l.patternFill&&c.data;(c.disableFontFace||g||h)&&(a=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||h?(s.save(),s.translate(t,n),s.beginPath(),a(s,u),o&&s.setTransform.apply(s,o),p!==i.TextRenderingMode.FILL&&p!==i.TextRenderingMode.FILL_STROKE||s.fill(),p!==i.TextRenderingMode.STROKE&&p!==i.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(p!==i.TextRenderingMode.FILL&&p!==i.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n,r),p!==i.TextRenderingMode.STROKE&&p!==i.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n,r)),g&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:s.mozCurrentTransform,x:t,y:n,fontSize:u,addToPath:a})},get isFontSubpixelAAEnabled(){var e=this.canvasFactory.create(10,10).context;e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,o=3;o<t.length;o+=4)if(t[o]>0&&t[o]<255){n=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n&&n.isType3Font)return this.showType3Text(e);var o=t.fontSize;if(0!==o){var r,a=this.ctx,s=t.fontSizeScale,l=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,u=t.textHScale*d,p=e.length,g=n.vertical,h=g?1:-1,f=n.defaultVMetrics,m=o*t.fontMatrix[0],y=t.textRenderingMode===i.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;if(a.save(),t.patternFill){a.save();var v=t.fillColor.getPattern(a,this);r=a.mozCurrentTransform,a.restore(),a.fillStyle=v}a.transform.apply(a,t.textMatrix),a.translate(t.x,t.y+t.textRise),d>0?a.scale(u,-1):a.scale(u,1);var _=t.lineWidth,b=t.textMatrixScale;if(0===b||0===_){var w=t.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;w!==i.TextRenderingMode.STROKE&&w!==i.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,_=.65*this.getSinglePixelWidth())}else _/=b;1!==s&&(a.scale(s,s),_/=s),a.lineWidth=_;var C,E=0;for(C=0;C<p;++C){var S=e[C];if((0,i.isNum)(S))E+=h*S*o/1e3;else{var G,A,T,P,L,D,x,I=!1,O=(S.isSpace?c:0)+l,k=S.unicode,F=S.accent,R=S.width;if(g?(L=S.vmetric||f,D=-(D=S.vmetric?L[1]:.5*R)*m,x=L[2]*m,R=L?-L[0]:R,G=D/s,A=(E+x)/s):(G=E/s,A=0),n.remeasure&&R>0){var M=1e3*a.measureText(k).width/o*s;if(R<M&&this.isFontSubpixelAAEnabled){var N=R/M;I=!0,a.save(),a.scale(N,1),G/=N}else R!==M&&(G+=(R-M)/2e3*o/s)}var B=R*m+O*d;(S.isInFont||n.missingFile)&&(y&&!F?a.fillText(k,G,A,B):(this.paintChar(k,G,A,r,B),F&&(T=G+F.offset.x/s,P=A-F.offset.y/s,this.paintChar(F.fontChar,T,P,r,B)))),E+=B,I&&a.restore()}}g?t.y-=E*u:t.x+=E*u,a.restore()}},showType3Text:function(e){var t,n,o,r,a=this.ctx,s=this.current,l=s.font,c=s.fontSize,d=s.fontDirection,u=l.vertical?1:-1,p=s.charSpacing,g=s.wordSpacing,h=s.textHScale*d,f=s.fontMatrix||i.FONT_IDENTITY_MATRIX,m=e.length;if(s.textRenderingMode!==i.TextRenderingMode.INVISIBLE&&0!==c){for(this._cachedGetSinglePixelWidth=null,a.save(),a.transform.apply(a,s.textMatrix),a.translate(s.x,s.y),a.scale(h,d),t=0;t<m;++t)if(n=e[t],(0,i.isNum)(n))r=u*n*c/1e3,this.ctx.translate(r,0),s.x+=r*h;else{var y=(n.isSpace?g:0)+p,v=l.charProcOperatorList[n.operatorListId];v?(this.processingType3=n,this.save(),a.scale(c,c),a.transform.apply(a,f),this.executeOperatorList(v),this.restore(),o=i.Util.applyTransform([n.width,0],f)[0]*c+y,a.translate(o,0),s.x+=o*h):(0,i.warn)('Type3 character "'.concat(n.operatorListId,'" is not available.'))}a.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,n,i,o,r){this.ctx.rect(n,i,o-n,r-i),this.clip(),this.endPath()},getColorN_Pattern:function(e){var t,n=this;if("TilingPattern"===e[0]){var i=e[1],r=this.baseTransform||this.ctx.mozCurrentTransform.slice(),a=this,s={createCanvasGraphics:function(e){return new a.constructor(e,n.commonObjs,n.objs,n.canvasFactory,n.webGLContext)}};t=new o.TilingPattern(e,i,this.ctx,s,r)}else t=(0,o.getShadingPatternFromIR)(e);return t},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var o=i.Util.makeCssRgb(e,t,n);this.ctx.strokeStyle=o,this.current.strokeColor=o},setFillRGBColor:function(e,t,n){var o=i.Util.makeCssRgb(e,t,n);this.ctx.fillStyle=o,this.current.fillColor=o,this.current.patternFill=!1},setStrokeCMYKColor:function(e,t,n,o){var r=i.Util.makeCssCMYK(e,t,n,o);this.ctx.strokeStyle=r,this.current.strokeColor=r},setFillCMYKColor:function(e,t,n,o){var r=i.Util.makeCssCMYK(e,t,n,o);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var n=(0,o.getShadingPatternFromIR)(e);t.fillStyle=n.getPattern(t,this,!0);var r=t.mozCurrentTransformInverse;if(r){var a=t.canvas,s=a.width,l=a.height,c=i.Util.applyTransform([0,0],r),d=i.Util.applyTransform([0,l],r),u=i.Util.applyTransform([s,0],r),p=i.Util.applyTransform([s,l],r),g=Math.min(c[0],d[0],u[0],p[0]),h=Math.min(c[1],d[1],u[1],p[1]),f=Math.max(c[0],d[0],u[0],p[0]),m=Math.max(c[1],d[1],u[1],p[1]);this.ctx.fillRect(g,h,f-g,m-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,i.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,i.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,t){var n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(e){this.save();var t=this.ctx;e.isolated||(0,i.info)("TODO: Support non-isolated groups."),e.knockout&&(0,i.warn)("Knockout groups not supported.");var n=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var o=i.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),r=[0,0,t.canvas.width,t.canvas.height];o=i.Util.intersect(o,r)||[0,0,0,0];var a=Math.floor(o[0]),s=Math.floor(o[1]),l=Math.max(Math.ceil(o[2])-a,1),d=Math.max(Math.ceil(o[3])-s,1),u=1,p=1;l>4096&&(u=l/4096,l=4096),d>4096&&(p=d/4096,d=4096);var g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);var h=this.cachedCanvases.getCanvas(g,l,d,!0),f=h.context;f.scale(1/u,1/p),f.translate(-a,-s),f.transform.apply(f,n),e.smask?this.smaskStack.push({canvas:h.canvas,context:f,offsetX:a,offsetY:s,scaleX:u,scaleY:p,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,s),t.scale(u,p)),c(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),d(this.ctx),this.current=new l,Array.isArray(e)&&4===e.length){var i=e[2]-e[0],o=e[3]-e[1];this.ctx.rect(e[0],e[1],i,o),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,t,n){var o=this.objs.get(e);if(o){this.save();var r=this.ctx;if(r.scale(1/t,-1/n),r.drawImage(o,0,0,o.width,o.height,0,-n,t,n),this.imageLayer){var a=r.mozCurrentTransformInverse,s=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:s[0],top:s[1],width:t/a[0],height:n/a[3]})}this.restore()}else(0,i.warn)("Dependent image isn't ready yet")},paintImageMaskXObject:function(e){var t=this.ctx,i=e.width,o=e.height,r=this.current.fillColor,a=this.current.patternFill,s=this.processingType3;if(s&&void 0===s.compiled&&(s.compiled=i<=1e3&&o<=1e3?function(e){var t,n,i,o,r=e.width,a=e.height,s=r+1,l=new Uint8Array(s*(a+1)),c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),d=r+7&-8,u=e.data,p=new Uint8Array(d*a),g=0;for(t=0,o=u.length;t<o;t++)for(var h=128,f=u[t];h>0;)p[g++]=f&h?0:255,h>>=1;var m=0;for(0!==p[g=0]&&(l[0]=1,++m),n=1;n<r;n++)p[g]!==p[g+1]&&(l[n]=p[g]?2:1,++m),g++;for(0!==p[g]&&(l[n]=2,++m),t=1;t<a;t++){i=t*s,p[(g=t*d)-d]!==p[g]&&(l[i]=p[g]?1:8,++m);var y=(p[g]?4:0)+(p[g-d]?8:0);for(n=1;n<r;n++)c[y=(y>>2)+(p[g+1]?4:0)+(p[g-d+1]?8:0)]&&(l[i+n]=c[y],++m),g++;if(p[g-d]!==p[g]&&(l[i+n]=p[g]?2:4,++m),m>1e3)return null}for(i=t*s,0!==p[g=d*(a-1)]&&(l[i]=8,++m),n=1;n<r;n++)p[g]!==p[g+1]&&(l[i+n]=p[g]?4:8,++m),g++;if(0!==p[g]&&(l[i+n]=4,++m),m>1e3)return null;var v=new Int32Array([0,s,-1,0,-s,0,0,0,1]),_=[];for(t=0;m&&t<=a;t++){for(var b=t*s,w=b+r;b<w&&!l[b];)b++;if(b!==w){var C,E=[b%s,t],S=l[b],G=b;do{var A=v[S];do{b+=A}while(!l[b]);5!==(C=l[b])&&10!==C?(S=C,l[b]=0):(S=C&51*S>>4,l[b]&=S>>2|S<<2),E.push(b%s),E.push(b/s|0),--m}while(G!==b);_.push(E),--t}}return function(e){e.save(),e.scale(1/r,-1/a),e.translate(0,-a),e.beginPath();for(var t=0,n=_.length;t<n;t++){var i=_[t];e.moveTo(i[0],i[1]);for(var o=2,s=i.length;o<s;o+=2)e.lineTo(i[o],i[o+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:i,height:o}):null),s&&s.compiled)s.compiled(t);else{var l=this.cachedCanvases.getCanvas("maskCanvas",i,o),c=l.context;c.save(),n(c,e),c.globalCompositeOperation="source-in",c.fillStyle=a?r.getPattern(c,this):r,c.fillRect(0,0,i,o),c.restore(),this.paintInlineImageXObject(l.canvas)}},paintImageMaskXObjectRepeat:function(e,t,i,o){var r=e.width,a=e.height,s=this.current.fillColor,l=this.current.patternFill,c=this.cachedCanvases.getCanvas("maskCanvas",r,a),d=c.context;d.save(),n(d,e),d.globalCompositeOperation="source-in",d.fillStyle=l?s.getPattern(d,this):s,d.fillRect(0,0,r,a),d.restore();for(var u=this.ctx,p=0,g=o.length;p<g;p+=2)u.save(),u.transform(t,0,0,i,o[p],o[p+1]),u.scale(1,-1),u.drawImage(c.canvas,0,0,r,a,0,-1,1,1),u.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,i=this.current.fillColor,o=this.current.patternFill,r=0,a=e.length;r<a;r++){var s=e[r],l=s.width,c=s.height,d=this.cachedCanvases.getCanvas("maskCanvas",l,c),u=d.context;u.save(),n(u,s),u.globalCompositeOperation="source-in",u.fillStyle=o?i.getPattern(u,this):i,u.fillRect(0,0,l,c),u.restore(),t.save(),t.transform.apply(t,s.transform),t.scale(1,-1),t.drawImage(d.canvas,0,0,l,c,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,i.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,o){var r=this.objs.get(e);if(r){for(var a=r.width,s=r.height,l=[],c=0,d=o.length;c<d;c+=2)l.push({transform:[t,0,0,n,o[c],o[c+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(r,l)}else(0,i.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){var n=e.width,i=e.height,o=this.ctx;this.save(),o.scale(1/n,-1/i);var r,a,s=o.mozCurrentTransformInverse,l=s[0],c=s[1],d=Math.max(Math.sqrt(l*l+c*c),1),u=s[2],p=s[3],g=Math.max(Math.sqrt(u*u+p*p),1);if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)r=e;else{var h=(a=this.cachedCanvases.getCanvas("inlineImage",n,i)).context;t(h,e),r=a.canvas}for(var f=n,m=i,y="prescale1";d>2&&f>1||g>2&&m>1;){var v=f,_=m;d>2&&f>1&&(d/=f/(v=Math.ceil(f/2))),g>2&&m>1&&(g/=m/(_=Math.ceil(m/2))),(h=(a=this.cachedCanvases.getCanvas(y,v,_)).context).clearRect(0,0,v,_),h.drawImage(r,0,0,f,m,0,0,v,_),r=a.canvas,f=v,m=_,y="prescale1"===y?"prescale2":"prescale1"}if(o.drawImage(r,0,0,f,m,0,-i,n,i),this.imageLayer){var b=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:e,left:b[0],top:b[1],width:n/s[0],height:i/s[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,n){var i=this.ctx,o=e.width,r=e.height,a=this.cachedCanvases.getCanvas("inlineImage",o,r);t(a.context,e);for(var s=0,l=n.length;s<l;s++){var c=n[s];if(i.save(),i.transform.apply(i,c.transform),i.scale(1,-1),i.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,-1,1,1),this.imageLayer){var d=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:e,left:d[0],top:d[1],width:o,height:r})}i.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){(0,i.warn)("Unsupported 'paintXObject' command.")},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){},beginMarkedContentProps:function(e,t){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===v?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth:function(e){if(null===this._cachedGetSinglePixelWidth){var t=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1],t[2]*t[2]+t[3]*t[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]}},i.OPS)e.prototype[i.OPS[_]]=e.prototype[_];return e}();t.CanvasGraphics=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShadingPatternFromIR=function(e){var t=o[e[0]];if(!t)throw new Error("Unknown IR type: ".concat(e[0]));return t.fromIR(e)},t.TilingPattern=void 0;var i=n(1),o={RadialAxial:{fromIR:function(e){var t=e[1],n=e[2],i=e[3],o=e[4],r=e[5],a=e[6],s=e[7];return{type:"Pattern",getPattern:function(e){var l;"axial"===t?l=e.createLinearGradient(i[0],i[1],o[0],o[1],s):"radial"===t&&(l=e.createRadialGradient(i[0],i[1],r,o[0],o[1],a,s));for(var c=0,d=n.length;c<d;++c){var u=n[c];l.addColorStop(u[0],u[1])}return l}}}}},r=function(){function e(e,t,n,i,o,r,a,s){var l,c=t.coords,d=t.colors,u=e.data,p=4*e.width;c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=r,r=a,a=l),c[i+1]>c[o+1]&&(l=i,i=o,o=l,l=a,a=s,s=l),c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=r,r=a,a=l);var g=(c[n]+t.offsetX)*t.scaleX,h=(c[n+1]+t.offsetY)*t.scaleY,f=(c[i]+t.offsetX)*t.scaleX,m=(c[i+1]+t.offsetY)*t.scaleY,y=(c[o]+t.offsetX)*t.scaleX,v=(c[o+1]+t.offsetY)*t.scaleY;if(!(h>=v))for(var _,b,w,C,E,S,G,A,T,P=d[r],L=d[r+1],D=d[r+2],x=d[a],I=d[a+1],O=d[a+2],k=d[s],F=d[s+1],R=d[s+2],M=Math.round(h),N=Math.round(v),B=M;B<=N;B++){B<m?(_=g-(g-f)*(T=B<h?0:h===m?1:(h-B)/(h-m)),b=P-(P-x)*T,w=L-(L-I)*T,C=D-(D-O)*T):(_=f-(f-y)*(T=B>v?1:m===v?0:(m-B)/(m-v)),b=x-(x-k)*T,w=I-(I-F)*T,C=O-(O-R)*T),E=g-(g-y)*(T=B<h?0:B>v?1:(h-B)/(h-v)),S=P-(P-k)*T,G=L-(L-F)*T,A=D-(D-R)*T;for(var $=Math.round(Math.min(_,E)),U=Math.round(Math.max(_,E)),K=p*B+4*$,j=$;j<=U;j++)T=(T=(_-j)/(_-E))<0?0:T>1?1:T,u[K++]=b-(b-S)*T|0,u[K++]=w-(w-G)*T|0,u[K++]=C-(C-A)*T|0,u[K++]=255}}function t(t,n,i){var o,r,a=n.coords,s=n.colors;switch(n.type){case"lattice":var l=n.verticesPerRow,c=Math.floor(a.length/l)-1,d=l-1;for(o=0;o<c;o++)for(var u=o*l,p=0;p<d;p++,u++)e(t,i,a[u],a[u+1],a[u+l],s[u],s[u+1],s[u+l]),e(t,i,a[u+l+1],a[u+1],a[u+l],s[u+l+1],s[u+1],s[u+l]);break;case"triangles":for(o=0,r=a.length;o<r;o+=3)e(t,i,a[o],a[o+1],a[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}return function(e,n,i,o,r,a,s,l){var c,d,u,p,g=Math.floor(e[0]),h=Math.floor(e[1]),f=Math.ceil(e[2])-g,m=Math.ceil(e[3])-h,y=Math.min(Math.ceil(Math.abs(f*n[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(m*n[1]*1.1)),3e3),_=f/y,b=m/v,w={coords:i,colors:o,offsetX:-g,offsetY:-h,scaleX:1/_,scaleY:1/b},C=y+4,E=v+4;if(l.isEnabled)c=l.drawFigures({width:y,height:v,backgroundColor:a,figures:r,context:w}),(d=s.getCanvas("mesh",C,E,!1)).context.drawImage(c,2,2),c=d.canvas;else{var S=(d=s.getCanvas("mesh",C,E,!1)).context,G=S.createImageData(y,v);if(a){var A=G.data;for(u=0,p=A.length;u<p;u+=4)A[u]=a[0],A[u+1]=a[1],A[u+2]=a[2],A[u+3]=255}for(u=0;u<r.length;u++)t(G,r[u],w);S.putImageData(G,2,2),c=d.canvas}return{canvas:c,offsetX:g-2*_,offsetY:h-2*b,scaleX:_,scaleY:b}}}();o.Mesh={fromIR:function(e){var t=e[2],n=e[3],o=e[4],a=e[5],s=e[6],l=e[8];return{type:"Pattern",getPattern:function(e,c,d){var u;if(d)u=i.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(u=i.Util.singularValueDecompose2dScale(c.baseTransform),s){var p=i.Util.singularValueDecompose2dScale(s);u=[u[0]*p[0],u[1]*p[1]]}var g=r(a,u,t,n,o,d?null:l,c.cachedCanvases,c.webGLContext);return d||(e.setTransform.apply(e,c.baseTransform),s&&e.transform.apply(e,s)),e.translate(g.offsetX,g.offsetY),e.scale(g.scaleX,g.scaleY),e.createPattern(g.canvas,"no-repeat")}}}},o.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var a=function(){var e=1,t=2;function n(e,t,n,i,o){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=i,this.baseTransform=o,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(e){var t=this.operatorList,n=this.bbox,o=this.xstep,r=this.ystep,a=this.paintType,s=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+s);var d=n[0],u=n[1],p=n[2],g=n[3],h=[d,u],f=[d+o,u+r],m=f[0]-h[0],y=f[1]-h[1],v=i.Util.singularValueDecompose2dScale(this.matrix),_=i.Util.singularValueDecompose2dScale(this.baseTransform),b=[v[0]*_[0],v[1]*_[1]];m=Math.min(Math.ceil(Math.abs(m*b[0])),3e3),y=Math.min(Math.ceil(Math.abs(y*b[1])),3e3);var w=e.cachedCanvases.getCanvas("pattern",m,y,!0),C=w.context,E=c.createCanvasGraphics(C);E.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(E,a,l),this.setScale(m,y,o,r),this.transformToScale(E);var S=[1,0,0,1,-h[0],-h[1]];return E.transform.apply(E,S),this.clipBbox(E,n,d,u,p,g),E.executeOperatorList(t),w.canvas},setScale:function(e,t,n,i){this.scale=[e/n,t/i]},transformToScale:function(e){var t=this.scale,n=[t[0],0,0,t[1],0,0];e.transform.apply(e,n)},scaleToContext:function(){var e=this.scale;this.ctx.scale(1/e[0],1/e[1])},clipBbox:function(e,t,n,i,o,r){if(Array.isArray(t)&&4===t.length){var a=o-n,s=r-i;e.ctx.rect(n,i,a,s),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(n,o,r){var a=n.ctx,s=n.current;switch(o){case e:var l=this.ctx;a.fillStyle=l.fillStyle,a.strokeStyle=l.strokeStyle,s.fillColor=l.fillStyle,s.strokeColor=l.strokeStyle;break;case t:var c=i.Util.makeCssRgb(r[0],r[1],r[2]);a.fillStyle=c,a.strokeStyle=c,s.fillColor=c,s.strokeColor=c;break;default:throw new i.FormatError("Unsupported paint type: ".concat(o))}},getPattern:function(e,t){var n=this.createPatternCanvas(t);return(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix),this.scaleToContext(),e.createPattern(n,"repeat")}},n}();t.TilingPattern=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;var i=Object.create(null);t.GlobalWorkerOptions=i,i.workerPort=void 0===i.workerPort?null:i.workerPort,i.workerSrc=void 0===i.workerSrc?"":i.workerSrc},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=h;var i,o=(i=n(147))&&i.__esModule?i:{default:i},r=n(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){s(r,i,o,a,l,"next",e)}function l(e){s(r,i,o,a,l,"throw",e)}a(void 0)}))}}function c(e,t){return d.apply(this,arguments)}function d(){return(d=l(o.default.mark((function e(t,n){var i,r=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.length>2&&void 0!==r[2]?r[2]:null,t){e.next=3;break}return e.abrupt("return");case 3:return e.abrupt("return",t.apply(i,n));case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function u(e){if("object"!==a(e))return e;switch(e.name){case"AbortException":return new r.AbortException(e.message);case"MissingPDFException":return new r.MissingPDFException(e.message);case"UnexpectedResponseException":return new r.UnexpectedResponseException(e.message,e.status);default:return new r.UnknownErrorException(e.message,e.details)}}function p(e){return!(e instanceof Error)||e instanceof r.AbortException||e instanceof r.MissingPDFException||e instanceof r.UnexpectedResponseException||e instanceof r.UnknownErrorException?e:new r.UnknownErrorException(e.message,e.toString())}function g(e,t,n){t?e.resolve():e.reject(n)}function h(e,t,n){var i=this;this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null);var o=this.callbacksCapabilities=Object.create(null),r=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(e){var t=e.data;if(t.targetName===i.sourceName)if(t.stream)i._processStreamMessage(t);else if(t.isReply){var a=t.callbackId;if(!(t.callbackId in o))throw new Error("Cannot resolve callback ".concat(a));var s=o[a];delete o[a],"error"in t?s.reject(u(t.error)):s.resolve(t.data)}else{if(!(t.action in r))throw new Error("Unknown action from worker: ".concat(t.action));var l=r[t.action];if(t.callbackId){var c=i.sourceName,d=t.sourceName;Promise.resolve().then((function(){return l[0].call(l[1],t.data)})).then((function(e){n.postMessage({sourceName:c,targetName:d,isReply:!0,callbackId:t.callbackId,data:e})}),(function(e){n.postMessage({sourceName:c,targetName:d,isReply:!0,callbackId:t.callbackId,error:p(e)})}))}else t.streamId?i._createStreamSink(t):l[0].call(l[1],t.data)}},n.addEventListener("message",this._onComObjOnMessage)}h.prototype={on:function(e,t,n){var i=this.actionHandler;if(i[e])throw new Error('There is already an actionName called "'.concat(e,'"'));i[e]=[t,n]},send:function(e,t,n){var i={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t};this.postMessage(i,n)},sendWithPromise:function(e,t,n){var i=this.callbackId++,o={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t,callbackId:i},a=(0,r.createPromiseCapability)();this.callbacksCapabilities[i]=a;try{this.postMessage(o,n)}catch(e){a.reject(e)}return a.promise},sendWithStream:function(e,t,n,i){var o=this,a=this.streamId++,s=this.sourceName,l=this.targetName;return new r.ReadableStream({start:function(n){var i=(0,r.createPromiseCapability)();return o.streamControllers[a]={controller:n,startCall:i,isClosed:!1},o.postMessage({sourceName:s,targetName:l,action:e,streamId:a,data:t,desiredSize:n.desiredSize}),i.promise},pull:function(e){var t=(0,r.createPromiseCapability)();return o.streamControllers[a].pullCall=t,o.postMessage({sourceName:s,targetName:l,stream:"pull",streamId:a,desiredSize:e.desiredSize}),t.promise},cancel:function(e){var t=(0,r.createPromiseCapability)();return o.streamControllers[a].cancelCall=t,o.streamControllers[a].isClosed=!0,o.postMessage({sourceName:s,targetName:l,stream:"cancel",reason:e,streamId:a}),t.promise}},n)},_createStreamSink:function(e){var t=this,n=this,i=this.actionHandler[e.action],o=e.streamId,a=e.desiredSize,s=this.sourceName,l=e.sourceName,d=(0,r.createPromiseCapability)(),u=function(e){var n=e.stream,i=e.chunk,r=e.transfers,a=e.success,c=e.reason;t.postMessage({sourceName:s,targetName:l,stream:n,streamId:o,chunk:i,success:a,reason:c},r)},p={enqueue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.isCancelled){var i=this.desiredSize;this.desiredSize-=t,i>0&&this.desiredSize<=0&&(this.sinkCapability=(0,r.createPromiseCapability)(),this.ready=this.sinkCapability.promise),u({stream:"enqueue",chunk:e,transfers:n})}},close:function(){this.isCancelled||(this.isCancelled=!0,u({stream:"close"}),delete n.streamSinks[o])},error:function(e){this.isCancelled||(this.isCancelled=!0,u({stream:"error",reason:e}))},sinkCapability:d,onPull:null,onCancel:null,isCancelled:!1,desiredSize:a,ready:null};p.sinkCapability.resolve(),p.ready=p.sinkCapability.promise,this.streamSinks[o]=p,c(i[0],[e.data,p],i[1]).then((function(){u({stream:"start_complete",success:!0})}),(function(e){u({stream:"start_complete",success:!1,reason:e})}))},_processStreamMessage:function(e){var t=this,n=this.sourceName,i=e.sourceName,o=e.streamId,a=function(e){var r=e.stream,a=e.success,s=e.reason;t.comObj.postMessage({sourceName:n,targetName:i,stream:r,success:a,streamId:o,reason:s})},s=function(){Promise.all([t.streamControllers[e.streamId].startCall,t.streamControllers[e.streamId].pullCall,t.streamControllers[e.streamId].cancelCall].map((function(e){return e&&(t=e.promise,Promise.resolve(t).catch((function(){})));var t}))).then((function(){delete t.streamControllers[e.streamId]}))};switch(e.stream){case"start_complete":g(this.streamControllers[e.streamId].startCall,e.success,u(e.reason));break;case"pull_complete":g(this.streamControllers[e.streamId].pullCall,e.success,u(e.reason));break;case"pull":if(!this.streamSinks[e.streamId]){a({stream:"pull_complete",success:!0});break}this.streamSinks[e.streamId].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[e.streamId].sinkCapability.resolve(),this.streamSinks[e.streamId].desiredSize=e.desiredSize,c(this.streamSinks[e.streamId].onPull).then((function(){a({stream:"pull_complete",success:!0})}),(function(e){a({stream:"pull_complete",success:!1,reason:e})}));break;case"enqueue":(0,r.assert)(this.streamControllers[e.streamId],"enqueue should have stream controller"),this.streamControllers[e.streamId].isClosed||this.streamControllers[e.streamId].controller.enqueue(e.chunk);break;case"close":if((0,r.assert)(this.streamControllers[e.streamId],"close should have stream controller"),this.streamControllers[e.streamId].isClosed)break;this.streamControllers[e.streamId].isClosed=!0,this.streamControllers[e.streamId].controller.close(),s();break;case"error":(0,r.assert)(this.streamControllers[e.streamId],"error should have stream controller"),this.streamControllers[e.streamId].controller.error(u(e.reason)),s();break;case"cancel_complete":g(this.streamControllers[e.streamId].cancelCall,e.success,u(e.reason)),s();break;case"cancel":if(!this.streamSinks[e.streamId])break;c(this.streamSinks[e.streamId].onCancel,[u(e.reason)]).then((function(){a({stream:"cancel_complete",success:!0})}),(function(e){a({stream:"cancel_complete",success:!1,reason:e})})),this.streamSinks[e.streamId].sinkCapability.reject(u(e.reason)),this.streamSinks[e.streamId].isCancelled=!0,delete this.streamSinks[e.streamId];break;default:throw new Error("Unexpected stream case")}},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=n(1),o=n(159);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,i.assert)("string"==typeof t,"Metadata: input is not a string"),t=this._repair(t);var n=(new o.SimpleXMLParser).parseFromString(t);this._metadata=Object.create(null),n&&this._parse(n)}var t,n,a;return t=e,(n=[{key:"_repair",value:function(e){return e.replace(/^([^<]+)/,"").replace(/>\\376\\377([^<]+)/g,(function(e,t){for(var n=t.replace(/\\([0-3])([0-7])([0-7])/g,(function(e,t,n,i){return String.fromCharCode(64*t+8*n+1*i)})).replace(/&(amp|apos|gt|lt|quot);/g,(function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error("_repair: ".concat(t," isn't defined."))})),i="",o=0,r=n.length;o<r;o+=2){var a=256*n.charCodeAt(o)+n.charCodeAt(o+1);i+=a>=32&&a<127&&60!==a&&62!==a&&38!==a?String.fromCharCode(a):"&#x"+(65536+a).toString(16).substring(1)+";"}return">"+i}))}},{key:"_parse",value:function(e){var t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var n=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===n&&t.hasChildNodes())for(var i=t.childNodes,o=0,r=i.length;o<r;o++){var a=i[o];if("rdf:description"===a.nodeName.toLowerCase())for(var s=0,l=a.childNodes.length;s<l;s++)if("#text"!==a.childNodes[s].nodeName.toLowerCase()){var c=a.childNodes[s],d=c.nodeName.toLowerCase();this._metadata[d]=c.textContent.trim()}}}},{key:"get",value:function(e){var t=this._metadata[e];return void 0!==t?t:null}},{key:"getAll",value:function(){return this._metadata}},{key:"has",value:function(e){return void 0!==this._metadata[e]}}])&&r(t.prototype,n),a&&r(t,a),e}();t.Metadata=a},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=void 0;var p=0,g=-2,h=-3,f=-4,m=-5,y=-6,v=-9;function _(e,t){var n=e[t];return" "===n||"\n"===n||"\r"===n||"\t"===n}var b=function(){function e(){c(this,e)}return u(e,[{key:"_resolveEntities",value:function(e){var t=this;return e.replace(/&([^;]+);/g,(function(e,n){if("#x"===n.substring(0,2))return String.fromCharCode(parseInt(n.substring(2),16));if("#"===n.substring(0,1))return String.fromCharCode(parseInt(n.substring(1),10));switch(n){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return t.onResolveEntity(n)}))}},{key:"_parseContent",value:function(e,t){var n,i=t,o=[];function r(){for(;i<e.length&&_(e,i);)++i}for(;i<e.length&&!_(e,i)&&">"!==e[i]&&"/"!==e[i];)++i;for(n=e.substring(t,i),r();i<e.length&&">"!==e[i]&&"/"!==e[i]&&"?"!==e[i];){r();for(var a,s="";i<e.length&&!_(e,i)&&"="!==e[i];)s+=e[i],++i;if(r(),"="!==e[i])return null;++i,r();var l=e[i];if('"'!==l&&"'"!==l)return null;var c=e.indexOf(l,++i);if(c<0)return null;a=e.substring(i,c),o.push({name:s,value:this._resolveEntities(a)}),i=c+1,r()}return{name:n,attributes:o,parsed:i-t}}},{key:"_parseProcessingInstruction",value:function(e,t){for(var n,i=t;i<e.length&&!_(e,i)&&">"!==e[i]&&"/"!==e[i];)++i;n=e.substring(t,i),function(){for(;i<e.length&&_(e,i);)++i}();for(var o=i;i<e.length&&("?"!==e[i]||">"!==e[i+1]);)++i;return{name:n,value:e.substring(o,i),parsed:i-t}}},{key:"parseXml",value:function(e){for(var t=0;t<e.length;){var n=t;if("<"===e[t]){var i=void 0;switch(e[++n]){case"/":if(++n,(i=e.indexOf(">",n))<0)return void this.onError(v);this.onEndElement(e.substring(n,i)),n=i+1;break;case"?":++n;var o=this._parseProcessingInstruction(e,n);if("?>"!==e.substring(n+o.parsed,n+o.parsed+2))return void this.onError(h);this.onPi(o.name,o.value),n+=o.parsed+2;break;case"!":if("--"===e.substring(n+1,n+3)){if((i=e.indexOf("--\x3e",n+3))<0)return void this.onError(m);this.onComment(e.substring(n+3,i)),n=i+3}else if("[CDATA["===e.substring(n+1,n+8)){if((i=e.indexOf("]]>",n+8))<0)return void this.onError(g);this.onCdata(e.substring(n+8,i)),n=i+3}else{if("DOCTYPE"!==e.substring(n+1,n+8))return void this.onError(y);var r=e.indexOf("[",n+8),a=!1;if((i=e.indexOf(">",n+8))<0)return void this.onError(f);if(r>0&&i>r){if((i=e.indexOf("]>",n+8))<0)return void this.onError(f);a=!0}var s=e.substring(n+8,i+(a?1:0));this.onDoctype(s),n=i+(a?2:1)}break;default:var l=this._parseContent(e,n);if(null===l)return void this.onError(y);var c=!1;if("/>"===e.substring(n+l.parsed,n+l.parsed+2))c=!0;else if(">"!==e.substring(n+l.parsed,n+l.parsed+1))return void this.onError(v);this.onBeginElement(l.name,l.attributes,c),n+=l.parsed+(c?2:1)}}else{for(;n<e.length&&"<"!==e[n];)n++;var d=e.substring(t,n);this.onText(this._resolveEntities(d))}t=n}}},{key:"onResolveEntity",value:function(e){return"&".concat(e,";")}},{key:"onPi",value:function(e,t){}},{key:"onComment",value:function(e){}},{key:"onCdata",value:function(e){}},{key:"onDoctype",value:function(e){}},{key:"onText",value:function(e){}},{key:"onBeginElement",value:function(e,t,n){}},{key:"onEndElement",value:function(e){}},{key:"onError",value:function(e){}}]),e}(),w=function(){function e(t,n){c(this,e),this.nodeName=t,this.nodeValue=n,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}return u(e,[{key:"hasChildNodes",value:function(){return this.childNodes&&this.childNodes.length>0}},{key:"firstChild",get:function(){return this.childNodes&&this.childNodes[0]}},{key:"nextSibling",get:function(){var e=this.parentNode.childNodes;if(e){var t=e.indexOf(this);if(-1!==t)return e[t+1]}}},{key:"textContent",get:function(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}}]),e}(),C=function(e){function t(){var e;return c(this,t),(e=r(this,s(t).call(this)))._currentFragment=null,e._stack=null,e._errorCode=p,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),u(t,[{key:"parseFromString",value:function(e){if(this._currentFragment=[],this._stack=[],this._errorCode=p,this.parseXml(e),this._errorCode===p){var t=o(this._currentFragment,1)[0];if(t)return{documentElement:t}}}},{key:"onResolveEntity",value:function(e){switch(e){case"apos":return"'"}return a(s(t.prototype),"onResolveEntity",this).call(this,e)}},{key:"onText",value:function(e){if(!function(e){for(var t=0,n=e.length;t<n;t++)if(!_(e,t))return!1;return!0}(e)){var t=new w("#text",e);this._currentFragment.push(t)}}},{key:"onCdata",value:function(e){var t=new w("#text",e);this._currentFragment.push(t)}},{key:"onBeginElement",value:function(e,t,n){var i=new w(e);i.childNodes=[],this._currentFragment.push(i),n||(this._stack.push(this._currentFragment),this._currentFragment=i.childNodes)}},{key:"onEndElement",value:function(e){this._currentFragment=this._stack.pop()||[];var t=this._currentFragment[this._currentFragment.length-1];if(t)for(var n=0,i=t.childNodes.length;n<i;n++)t.childNodes[n].parentNode=t}},{key:"onError",value:function(e){this._errorCode=e}}]),t}(b);t.SimpleXMLParser=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var i,o=(i=n(147))&&i.__esModule?i:{default:i},r=n(1);function a(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function s(e){a(r,i,o,s,l,"next",e)}function l(e){a(r,i,o,s,l,"throw",e)}s(void 0)}))}}var l=function(){function e(e,t){var n=this;(0,r.assert)(t),this._queuedChunks=[];var i=e.initialData;if(i&&i.length>0){var o=new Uint8Array(i).buffer;this._queuedChunks.push(o)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._contentLength=e.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((function(e,t){n._onReceiveData({begin:e,chunk:t})})),this._pdfDataRangeTransport.addProgressListener((function(e){n._onProgress({loaded:e})})),this._pdfDataRangeTransport.addProgressiveReadListener((function(e){n._onReceiveData({chunk:e})})),this._pdfDataRangeTransport.transportReady()}function t(e,t){this._stream=e,this._done=!1,this._filename=null,this._queuedChunks=t||[],this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}var n,i;function a(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}return e.prototype={_onReceiveData:function(e){var t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{var n=this._rangeReaders.some((function(n){return n._begin===e.begin&&(n._enqueue(t),!0)}));(0,r.assert)(n)}},_onProgress:function(e){if(this._rangeReaders.length>0){var t=this._rangeReaders[0];t.onProgress&&t.onProgress({loaded:e.loaded})}},_removeRangeReader:function(e){var t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)},getFullReader:function(){(0,r.assert)(!this._fullRequestReader);var e=this._queuedChunks;return this._queuedChunks=null,new t(this,e)},getRangeReader:function(e,t){var n=new a(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n},cancelAllRequests:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach((function(t){t.cancel(e)})),this._pdfDataRangeTransport.abort()}},t.prototype={_enqueue:function(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e))},get headersReady(){return this._headersReady},get filename(){return this._filename},get isRangeSupported(){return this._stream._isRangeSupported},get isStreamingSupported(){return this._stream._isStreamingSupported},get contentLength(){return this._stream._contentLength},read:(n=s(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._queuedChunks.length>0)){e.next=3;break}return t=this._queuedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 3:if(!this._done){e.next=5;break}return e.abrupt("return",{value:void 0,done:!0});case 5:return n=(0,r.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]}},a.prototype={_enqueue:function(e){this._done||(0===this._requests.length?this._queuedChunk=e:(this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))},get isStreamingSupported(){return!1},read:(i=s(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,r.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._stream._removeRangeReader(this)}},e}();t.PDFDataTransportStream=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var i=n(1);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(t){var n=t.enable,i=void 0!==n&&n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!0===i}var t,n,r;return t=e,(n=[{key:"composeSMask",value:function(e){var t=e.layer,n=e.mask,i=e.properties;return a.composeSMask(t,n,i)}},{key:"drawFigures",value:function(e){var t=e.width,n=e.height,i=e.backgroundColor,o=e.figures,r=e.context;return a.drawFigures(t,n,i,o,r)}},{key:"clear",value:function(){a.cleanup()}},{key:"isEnabled",get:function(){var e=this._enabled;return e&&(e=a.tryInitGL()),(0,i.shadow)(this,"isEnabled",e)}}])&&o(t.prototype,n),r&&o(t,r),e}();t.WebGLContext=r;var a=function(){function e(e,t,n){var i=e.createShader(n);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(i);throw new Error("Error during shader compilation: "+o)}return i}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function n(t,n){return e(t,n,t.FRAGMENT_SHADER)}function i(e,t){for(var n=e.createProgram(),i=0,o=t.length;i<o;++i)e.attachShader(n,t[i]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var r=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+r)}return n}function o(e,t,n){e.activeTexture(n);var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),i}var r,a;function s(){r||(a=document.createElement("canvas"),r=a.getContext("webgl",{premultipliedalpha:!1}))}var l=null,c=null;return{tryInitGL:function(){try{return s(),!!r}catch(e){}return!1},composeSMask:function(e,c,d){var u=e.width,p=e.height;l||function(){var e,o;s(),e=a,a=null,o=r,r=null;var c=i(o,[t(o,"  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             "),n(o,"  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ")]);o.useProgram(c);var d={};d.gl=o,d.canvas=e,d.resolutionLocation=o.getUniformLocation(c,"u_resolution"),d.positionLocation=o.getAttribLocation(c,"a_position"),d.backdropLocation=o.getUniformLocation(c,"u_backdrop"),d.subtypeLocation=o.getUniformLocation(c,"u_subtype");var u=o.getAttribLocation(c,"a_texCoord"),p=o.getUniformLocation(c,"u_image"),g=o.getUniformLocation(c,"u_mask"),h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.bufferData(o.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),o.STATIC_DRAW),o.enableVertexAttribArray(u),o.vertexAttribPointer(u,2,o.FLOAT,!1,0,0),o.uniform1i(p,0),o.uniform1i(g,1),l=d}();var g=l,h=g.canvas,f=g.gl;h.width=u,h.height=p,f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.uniform2f(g.resolutionLocation,u,p),d.backdrop?f.uniform4f(g.resolutionLocation,d.backdrop[0],d.backdrop[1],d.backdrop[2],1):f.uniform4f(g.resolutionLocation,0,0,0,0),f.uniform1i(g.subtypeLocation,"Luminosity"===d.subtype?1:0);var m=o(f,e,f.TEXTURE0),y=o(f,c,f.TEXTURE1),v=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,v),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,u,0,0,p,0,p,u,0,u,p]),f.STATIC_DRAW),f.enableVertexAttribArray(g.positionLocation),f.vertexAttribPointer(g.positionLocation,2,f.FLOAT,!1,0,0),f.clearColor(0,0,0,0),f.enable(f.BLEND),f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA),f.clear(f.COLOR_BUFFER_BIT),f.drawArrays(f.TRIANGLES,0,6),f.flush(),f.deleteTexture(m),f.deleteTexture(y),f.deleteBuffer(v),h},drawFigures:function(e,o,l,d,u){c||function(){var e,o;s(),e=a,a=null,o=r,r=null;var l=i(o,[t(o,"  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             "),n(o,"  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ")]);o.useProgram(l);var d={};d.gl=o,d.canvas=e,d.resolutionLocation=o.getUniformLocation(l,"u_resolution"),d.scaleLocation=o.getUniformLocation(l,"u_scale"),d.offsetLocation=o.getUniformLocation(l,"u_offset"),d.positionLocation=o.getAttribLocation(l,"a_position"),d.colorLocation=o.getAttribLocation(l,"a_color"),c=d}();var p=c,g=p.canvas,h=p.gl;g.width=e,g.height=o,h.viewport(0,0,h.drawingBufferWidth,h.drawingBufferHeight),h.uniform2f(p.resolutionLocation,e,o);var f,m,y,v=0;for(f=0,m=d.length;f<m;f++)switch(d[f].type){case"lattice":v+=((y=d[f].coords.length/d[f].verticesPerRow|0)-1)*(d[f].verticesPerRow-1)*6;break;case"triangles":v+=d[f].coords.length}var _=new Float32Array(2*v),b=new Uint8Array(3*v),w=u.coords,C=u.colors,E=0,S=0;for(f=0,m=d.length;f<m;f++){var G=d[f],A=G.coords,T=G.colors;switch(G.type){case"lattice":var P=G.verticesPerRow;y=A.length/P|0;for(var L=1;L<y;L++)for(var D=L*P+1,x=1;x<P;x++,D++)_[E]=w[A[D-P-1]],_[E+1]=w[A[D-P-1]+1],_[E+2]=w[A[D-P]],_[E+3]=w[A[D-P]+1],_[E+4]=w[A[D-1]],_[E+5]=w[A[D-1]+1],b[S]=C[T[D-P-1]],b[S+1]=C[T[D-P-1]+1],b[S+2]=C[T[D-P-1]+2],b[S+3]=C[T[D-P]],b[S+4]=C[T[D-P]+1],b[S+5]=C[T[D-P]+2],b[S+6]=C[T[D-1]],b[S+7]=C[T[D-1]+1],b[S+8]=C[T[D-1]+2],_[E+6]=_[E+2],_[E+7]=_[E+3],_[E+8]=_[E+4],_[E+9]=_[E+5],_[E+10]=w[A[D]],_[E+11]=w[A[D]+1],b[S+9]=b[S+3],b[S+10]=b[S+4],b[S+11]=b[S+5],b[S+12]=b[S+6],b[S+13]=b[S+7],b[S+14]=b[S+8],b[S+15]=C[T[D]],b[S+16]=C[T[D]+1],b[S+17]=C[T[D]+2],E+=12,S+=18;break;case"triangles":for(var I=0,O=A.length;I<O;I++)_[E]=w[A[I]],_[E+1]=w[A[I]+1],b[S]=C[T[I]],b[S+1]=C[T[I]+1],b[S+2]=C[T[I]+2],E+=2,S+=3}}l?h.clearColor(l[0]/255,l[1]/255,l[2]/255,1):h.clearColor(0,0,0,0),h.clear(h.COLOR_BUFFER_BIT);var k=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,k),h.bufferData(h.ARRAY_BUFFER,_,h.STATIC_DRAW),h.enableVertexAttribArray(p.positionLocation),h.vertexAttribPointer(p.positionLocation,2,h.FLOAT,!1,0,0);var F=h.createBuffer();return h.bindBuffer(h.ARRAY_BUFFER,F),h.bufferData(h.ARRAY_BUFFER,b,h.STATIC_DRAW),h.enableVertexAttribArray(p.colorLocation),h.vertexAttribPointer(p.colorLocation,3,h.UNSIGNED_BYTE,!1,0,0),h.uniform2f(p.scaleLocation,u.scaleX,u.scaleY),h.uniform2f(p.offsetLocation,u.offsetX,u.offsetY),h.drawArrays(h.TRIANGLES,0,v),h.flush(),h.deleteBuffer(k),h.deleteBuffer(F),g},cleanup:function(){l&&l.canvas&&(l.canvas.width=0,l.canvas.height=0),c&&c.canvas&&(c.canvas.width=0,c.canvas.height=0),l=null,c=null}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var i,o=n(1),r=(i=n(3))&&i.__esModule?i:{default:i},a=function(){var e=/\S/,t=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];function n(n,i,r){var a,s=document.createElement("span"),l={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(n._textDivs.push(s),a=i.str,!e.test(a))return l.isWhitespace=!0,void n._textDivProperties.set(s,l);var c=o.Util.transform(n._viewport.transform,i.transform),d=Math.atan2(c[1],c[0]),u=r[i.fontName];u.vertical&&(d+=Math.PI/2);var p,g,h=Math.sqrt(c[2]*c[2]+c[3]*c[3]),f=h;if(u.ascent?f=u.ascent*f:u.descent&&(f=(1+u.descent)*f),0===d?(p=c[4],g=c[5]-f):(p=c[4]+f*Math.sin(d),g=c[5]-f*Math.cos(d)),t[1]=p,t[3]=g,t[5]=h,t[7]=u.fontFamily,l.style=t.join(""),s.setAttribute("style",l.style),s.textContent=i.str,n._fontInspectorEnabled&&(s.dataset.fontName=i.fontName),0!==d&&(l.angle=d*(180/Math.PI)),i.str.length>1&&(u.vertical?l.canvasWidth=i.height*n._viewport.scale:l.canvasWidth=i.width*n._viewport.scale),n._textDivProperties.set(s,l),n._textContentStream&&n._layoutText(s),n._enhanceTextSelection){var m=1,y=0;0!==d&&(m=Math.cos(d),y=Math.sin(d));var v,_,b=(u.vertical?i.height:i.width)*n._viewport.scale,w=h;0!==d?(v=[m,y,-y,m,p,g],_=o.Util.getAxialAlignedBoundingBox([0,0,b,w],v)):_=[p,g,p+b,g+w],n._bounds.push({left:_[0],top:_[1],right:_[2],bottom:_[3],div:s,size:[b,w],m:v})}}function i(e){if(!e._canceled){var t=e._textDivs,n=e._capability,i=t.length;if(i>1e5)return e._renderingDone=!0,void n.resolve();if(!e._textContentStream)for(var o=0;o<i;o++)e._layoutText(t[o]);e._renderingDone=!0,n.resolve()}}function a(e){for(var t=e._bounds,n=e._viewport,i=function(e,t,n){var i=n.map((function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}}));s(e,i);var o=new Array(n.length);return i.forEach((function(e){var t=e.index;o[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}})),n.map((function(t,n){var r=o[n],a=i[n];a.x1=t.top,a.y1=e-r.right,a.x2=t.bottom,a.y2=e-r.left,a.index=n,a.x1New=void 0,a.x2New=void 0})),s(t,i),i.forEach((function(e){var t=e.index;o[t].top=e.x1New,o[t].bottom=e.x2New})),o}(n.width,n.height,t),r=0;r<i.length;r++){var a=t[r].div,l=e._textDivProperties.get(a);if(0!==l.angle){var c=i[r],d=t[r],u=d.m,p=u[0],g=u[1],h=[[0,0],[0,d.size[1]],[d.size[0],0],d.size],f=new Float64Array(64);h.forEach((function(e,t){var n=o.Util.applyTransform(e,u);f[t+0]=p&&(c.left-n[0])/p,f[t+4]=g&&(c.top-n[1])/g,f[t+8]=p&&(c.right-n[0])/p,f[t+12]=g&&(c.bottom-n[1])/g,f[t+16]=g&&(c.left-n[0])/-g,f[t+20]=p&&(c.top-n[1])/p,f[t+24]=g&&(c.right-n[0])/-g,f[t+28]=p&&(c.bottom-n[1])/p,f[t+32]=p&&(c.left-n[0])/-p,f[t+36]=g&&(c.top-n[1])/-g,f[t+40]=p&&(c.right-n[0])/-p,f[t+44]=g&&(c.bottom-n[1])/-g,f[t+48]=g&&(c.left-n[0])/g,f[t+52]=p&&(c.top-n[1])/-p,f[t+56]=g&&(c.right-n[0])/g,f[t+60]=p&&(c.bottom-n[1])/-p}));var m=function(e,t,n){for(var i=0,o=0;o<n;o++){var r=e[t++];r>0&&(i=i?Math.min(r,i):r)}return i},y=1+Math.min(Math.abs(p),Math.abs(g));l.paddingLeft=m(f,32,16)/y,l.paddingTop=m(f,48,16)/y,l.paddingRight=m(f,0,16)/y,l.paddingBottom=m(f,16,16)/y,e._textDivProperties.set(a,l)}else l.paddingLeft=t[r].left-i[r].left,l.paddingTop=t[r].top-i[r].top,l.paddingRight=i[r].right-t[r].right,l.paddingBottom=i[r].bottom-t[r].bottom,e._textDivProperties.set(a,l)}}function s(e,t){t.sort((function(e,t){return e.x1-t.x1||e.index-t.index}));var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach((function(e){for(var t=0;t<n.length&&n[t].end<=e.y1;)t++;for(var i,o,r=n.length-1;r>=0&&n[r].start>=e.y2;)r--;var a,s,l=-1/0;for(a=t;a<=r;a++){var c;(c=(o=(i=n[a]).boundary).x2>e.x1?o.index>e.index?o.x1New:e.x1:void 0===o.x2New?(o.x2+e.x1)/2:o.x2New)>l&&(l=c)}for(e.x1New=l,a=t;a<=r;a++)void 0===(o=(i=n[a]).boundary).x2New?o.x2>e.x1?o.index>e.index&&(o.x2New=o.x2):o.x2New=l:o.x2New>l&&(o.x2New=Math.max(l,o.x2));var d=[],u=null;for(a=t;a<=r;a++){var p=(o=(i=n[a]).boundary).x2>e.x2?o:e;u===p?d[d.length-1].end=i.end:(d.push({start:i.start,end:i.end,boundary:p}),u=p)}for(n[t].start<e.y1&&(d[0].start=e.y1,d.unshift({start:n[t].start,end:e.y1,boundary:n[t].boundary})),e.y2<n[r].end&&(d[d.length-1].end=e.y2,d.push({start:e.y2,end:n[r].end,boundary:n[r].boundary})),a=t;a<=r;a++)if(void 0===(o=(i=n[a]).boundary).x2New){var g=!1;for(s=t-1;!g&&s>=0&&n[s].start>=o.y1;s--)g=n[s].boundary===o;for(s=r+1;!g&&s<n.length&&n[s].end<=o.y2;s++)g=n[s].boundary===o;for(s=0;!g&&s<d.length;s++)g=d[s].boundary===o;g||(o.x2New=l)}Array.prototype.splice.apply(n,[t,r-t+1].concat(d))})),n.forEach((function(t){var n=t.boundary;void 0===n.x2New&&(n.x2New=Math.max(e,n.x2))}))}function l(e){var t=e.textContent,n=e.textContentStream,i=e.container,a=e.viewport,s=e.textDivs,l=e.textContentItemsStr,c=e.enhanceTextSelection;this._textContent=t,this._textContentStream=n,this._container=i,this._viewport=a,this._textDivs=s||[],this._textContentItemsStr=l||[],this._enhanceTextSelection=!!c,this._fontInspectorEnabled=!(!r.default.FontInspector||!r.default.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,o.createPromiseCapability)(),this._renderTimer=null,this._bounds=[]}return l.prototype={get promise(){return this._capability.promise},cancel:function(){this._reader&&(this._reader.cancel(new o.AbortException("text layer task cancelled")),this._reader=null),this._canceled=!0,null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_processItems:function(e,t){for(var i=0,o=e.length;i<o;i++)this._textContentItemsStr.push(e[i].str),n(this,e[i],t)},_layoutText:function(e){var t=this._container,n=this._textDivProperties.get(e);if(!n.isWhitespace){var i=e.style.fontSize,o=e.style.fontFamily;i===this._layoutTextLastFontSize&&o===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=i+" "+o,this._layoutTextLastFontSize=i,this._layoutTextLastFontFamily=o);var r=this._layoutTextCtx.measureText(e.textContent).width,a="";0!==n.canvasWidth&&r>0&&(n.scale=n.canvasWidth/r,a="scaleX(".concat(n.scale,")")),0!==n.angle&&(a="rotate(".concat(n.angle,"deg) ").concat(a)),a.length>0&&(n.originalTransform=a,e.style.transform=a),this._textDivProperties.set(e,n),t.appendChild(e)}},_render:function(e){var t=this,n=(0,o.createPromiseCapability)(),r=Object.create(null),a=document.createElement("canvas");if(a.mozOpaque=!0,this._layoutTextCtx=a.getContext("2d",{alpha:!1}),this._textContent){var s=this._textContent.items,l=this._textContent.styles;this._processItems(s,l),n.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function e(){t._reader.read().then((function(i){var o=i.value;i.done?n.resolve():(Object.assign(r,o.styles),t._processItems(o.items,r),e())}),n.reject)}()}n.promise.then((function(){r=null,e?t._renderTimer=setTimeout((function(){i(t),t._renderTimer=null}),e):i(t)}),this._capability.reject)},expandTextDivs:function(e){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(a(this),this._bounds=null);for(var t=0,n=this._textDivs.length;t<n;t++){var i=this._textDivs[t],o=this._textDivProperties.get(i);if(!o.isWhitespace)if(e){var r="",s="";1!==o.scale&&(r="scaleX("+o.scale+")"),0!==o.angle&&(r="rotate("+o.angle+"deg) "+r),0!==o.paddingLeft&&(s+=" padding-left: "+o.paddingLeft/o.scale+"px;",r+=" translateX("+-o.paddingLeft/o.scale+"px)"),0!==o.paddingTop&&(s+=" padding-top: "+o.paddingTop+"px;",r+=" translateY("+-o.paddingTop+"px)"),0!==o.paddingRight&&(s+=" padding-right: "+o.paddingRight/o.scale+"px;"),0!==o.paddingBottom&&(s+=" padding-bottom: "+o.paddingBottom+"px;"),""!==s&&i.setAttribute("style",o.style+s),""!==r&&(i.style.transform=r)}else i.style.padding=0,i.style.transform=o.originalTransform||""}}}},function(e){var t=new l({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var i=n(151),o=n(1);function r(e,t,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function h(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var f=function(){function e(){p(this,e)}return h(e,null,[{key:"create",value:function(e){switch(e.data.annotationType){case o.AnnotationType.LINK:return new y(e);case o.AnnotationType.TEXT:return new v(e);case o.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new b(e);case"Btn":return e.data.radioButton?new C(e):e.data.checkBox?new w(e):new E(e);case"Ch":return new S(e)}return new _(e);case o.AnnotationType.POPUP:return new G(e);case o.AnnotationType.LINE:return new T(e);case o.AnnotationType.SQUARE:return new P(e);case o.AnnotationType.CIRCLE:return new L(e);case o.AnnotationType.POLYLINE:return new D(e);case o.AnnotationType.INK:return new I(e);case o.AnnotationType.POLYGON:return new x(e);case o.AnnotationType.HIGHLIGHT:return new O(e);case o.AnnotationType.UNDERLINE:return new k(e);case o.AnnotationType.SQUIGGLY:return new F(e);case o.AnnotationType.STRIKEOUT:return new R(e);case o.AnnotationType.STAMP:return new M(e);case o.AnnotationType.FILEATTACHMENT:return new N(e);default:return new m(e)}}}]),e}(),m=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p(this,e),this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,this.svgFactory=t.svgFactory,n&&(this.container=this._createContainer(i))}return h(e,[{key:"_createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data,n=this.page,i=this.viewport,r=document.createElement("section"),a=t.rect[2]-t.rect[0],s=t.rect[3]-t.rect[1];r.setAttribute("data-annotation-id",t.id);var l=o.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(r.style.transform="matrix("+i.transform.join(",")+")",r.style.transformOrigin=-l[0]+"px "+-l[1]+"px",!e&&t.borderStyle.width>0){r.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==o.AnnotationBorderStyleType.UNDERLINE&&(a-=2*t.borderStyle.width,s-=2*t.borderStyle.width);var c=t.borderStyle.horizontalCornerRadius,d=t.borderStyle.verticalCornerRadius;if(c>0||d>0){var u=c+"px / "+d+"px";r.style.borderRadius=u}switch(t.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:r.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:r.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:r.style.borderBottomStyle="solid"}t.color?r.style.borderColor=o.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):r.style.borderWidth=0}return r.style.left=l[0]+"px",r.style.top=l[1]+"px",r.style.width=a+"px",r.style.height=s+"px",r}},{key:"_createPopup",value:function(e,t,n){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));var i=new A({container:e,trigger:t,color:n.color,title:n.title,contents:n.contents,hideWrapper:!0}).render();i.style.left=e.style.width,e.appendChild(i)}},{key:"render",value:function(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}}]),e}(),y=function(e){function t(e){p(this,t);var n=!!(e.data.url||e.data.dest||e.data.action);return s(this,c(t).call(this,e,n))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="linkAnnotation";var e=this.data,t=this.linkService,n=document.createElement("a");return(0,i.addLinkAttributes)(n,{url:e.url,target:e.newWindow?i.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel}),e.url||(e.action?this._bindNamedAction(n,e.action):this._bindLink(n,e.dest)),this.container.appendChild(n),this.container}},{key:"_bindLink",value:function(e,t){var n=this;e.href=this.linkService.getDestinationHash(t),e.onclick=function(){return t&&n.linkService.navigateTo(t),!1},t&&(e.className="internalLink")}},{key:"_bindNamedAction",value:function(e,t){var n=this;e.href=this.linkService.getAnchorUrl(""),e.onclick=function(){return n.linkService.executeNamedAction(t),!1},e.className="internalLink"}}]),t}(m),v=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="textAnnotation";var e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}]),t}(m),_=function(e){function t(){return p(this,t),s(this,c(t).apply(this,arguments))}return d(t,e),h(t,[{key:"render",value:function(){return this.container}}]),t}(m),b=function(e){function t(e){p(this,t);var n=e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue;return s(this,c(t).call(this,e,n))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="textWidgetAnnotation";var e=null;if(this.renderInteractiveForms){if(this.data.multiLine?(e=document.createElement("textarea")).textContent=this.data.fieldValue:((e=document.createElement("input")).type="text",e.setAttribute("value",this.data.fieldValue)),e.disabled=this.data.readOnly,null!==this.data.maxLen&&(e.maxLength=this.data.maxLen),this.data.comb){var t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;e.classList.add("comb"),e.style.letterSpacing="calc("+t+"px - 1ch)"}}else{(e=document.createElement("div")).textContent=this.data.fieldValue,e.style.verticalAlign="middle",e.style.display="table-cell";var n=null;this.data.fontRefName&&this.page.commonObjs.has(this.data.fontRefName)&&(n=this.page.commonObjs.get(this.data.fontRefName)),this._setTextStyle(e,n)}return null!==this.data.textAlignment&&(e.style.textAlign=["left","center","right"][this.data.textAlignment]),this.container.appendChild(e),this.container}},{key:"_setTextStyle",value:function(e,t){var n=e.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",t){n.fontWeight=t.black?t.bold?"900":"bold":t.bold?"bold":"normal",n.fontStyle=t.italic?"italic":"normal";var i=t.loadedName?'"'+t.loadedName+'", ':"",o=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=i+o}}}]),t}(_),w=function(e){function t(e){return p(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation checkBox";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(_),C=function(e){function t(e){return p(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation radioButton";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="radio",e.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(_),E=function(e){function t(){return p(this,t),s(this,c(t).apply(this,arguments))}return d(t,e),h(t,[{key:"render",value:function(){var e=r(c(t.prototype),"render",this).call(this);return e.className="buttonWidgetAnnotation pushButton",e}}]),t}(y),S=function(e){function t(e){return p(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="choiceWidgetAnnotation";var e=document.createElement("select");e.disabled=this.data.readOnly,this.data.combo||(e.size=this.data.options.length,this.data.multiSelect&&(e.multiple=!0));for(var t=0,n=this.data.options.length;t<n;t++){var i=this.data.options[t],o=document.createElement("option");o.textContent=i.displayValue,o.value=i.exportValue,this.data.fieldValue.includes(i.displayValue)&&o.setAttribute("selected",!0),e.appendChild(o)}return this.container.appendChild(e),this.container}}]),t}(_),G=function(e){function t(e){p(this,t);var n=!(!e.data.title&&!e.data.contents);return s(this,c(t).call(this,e,n))}return d(t,e),h(t,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var e='[data-annotation-id="'+this.data.parentId+'"]',t=this.layer.querySelector(e);if(!t)return this.container;var n=new A({container:this.container,trigger:t,color:this.data.color,title:this.data.title,contents:this.data.contents}),i=parseFloat(t.style.left),o=parseFloat(t.style.width);return this.container.style.transformOrigin=-(i+o)+"px -"+t.style.top,this.container.style.left=i+o+"px",this.container.appendChild(n.render()),this.container}}]),t}(m),A=function(){function e(t){p(this,e),this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}return h(e,[{key:"render",value:function(){var e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);var t=document.createElement("div");t.className="popup";var n=this.color;if(n){var i=.7*(255-n[0])+n[0],r=.7*(255-n[1])+n[1],a=.7*(255-n[2])+n[2];t.style.backgroundColor=o.Util.makeCssRgb(0|i,0|r,0|a)}var s=this._formatContents(this.contents),l=document.createElement("h1");return l.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),t.appendChild(l),t.appendChild(s),e.appendChild(t),e}},{key:"_formatContents",value:function(e){for(var t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/),i=0,o=n.length;i<o;++i){var r=n[i];t.appendChild(document.createTextNode(r)),i<o-1&&t.appendChild(document.createElement("br"))}return t}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}},{key:"_hide",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}]),e}(),T=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="lineAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),o=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width),o.setAttribute("stroke","transparent"),i.appendChild(o),this.container.append(i),this._createPopup(this.container,o,e),this.container}}]),t}(m),P=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="squareAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),o=e.borderStyle.width,r=this.svgFactory.createElement("svg:rect");return r.setAttribute("x",o/2),r.setAttribute("y",o/2),r.setAttribute("width",t-o),r.setAttribute("height",n-o),r.setAttribute("stroke-width",o),r.setAttribute("stroke","transparent"),r.setAttribute("fill","none"),i.appendChild(r),this.container.append(i),this._createPopup(this.container,r,e),this.container}}]),t}(m),L=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="circleAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),o=e.borderStyle.width,r=this.svgFactory.createElement("svg:ellipse");return r.setAttribute("cx",t/2),r.setAttribute("cy",n/2),r.setAttribute("rx",t/2-o/2),r.setAttribute("ry",n/2-o/2),r.setAttribute("stroke-width",o),r.setAttribute("stroke","transparent"),r.setAttribute("fill","none"),i.appendChild(r),this.container.append(i),this._createPopup(this.container,r,e),this.container}}]),t}(m),D=function(e){function t(e){var n;p(this,t);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(n=s(this,c(t).call(this,e,i,!0))).containerClassName="polylineAnnotation",n.svgElementName="svg:polyline",n}return d(t,e),h(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),o=e.vertices,r=[],a=0,s=o.length;a<s;a++){var l=o[a].x-e.rect[0],c=e.rect[3]-o[a].y;r.push(l+","+c)}r=r.join(" ");var d=e.borderStyle.width,u=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",r),u.setAttribute("stroke-width",d),u.setAttribute("stroke","transparent"),u.setAttribute("fill","none"),i.appendChild(u),this.container.append(i),this._createPopup(this.container,u,e),this.container}}]),t}(m),x=function(e){function t(e){var n;return p(this,t),(n=s(this,c(t).call(this,e))).containerClassName="polygonAnnotation",n.svgElementName="svg:polygon",n}return d(t,e),t}(D),I=function(e){function t(e){var n;p(this,t);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(n=s(this,c(t).call(this,e,i,!0))).containerClassName="inkAnnotation",n.svgElementName="svg:polyline",n}return d(t,e),h(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),o=e.inkLists,r=0,a=o.length;r<a;r++){for(var s=o[r],l=[],c=0,d=s.length;c<d;c++){var u=s[c].x-e.rect[0],p=e.rect[3]-s[c].y;l.push(u+","+p)}l=l.join(" ");var g=e.borderStyle.width,h=this.svgFactory.createElement(this.svgElementName);h.setAttribute("points",l),h.setAttribute("stroke-width",g),h.setAttribute("stroke","transparent"),h.setAttribute("fill","none"),this._createPopup(this.container,h,e),i.appendChild(h)}return this.container.append(i),this.container}}]),t}(m),O=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(m),k=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(m),F=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(m),R=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(m),M=function(e){function t(e){p(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,e),h(t,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(m),N=function(e){function t(e){var n;p(this,t);var r=(n=s(this,c(t).call(this,e,!0))).data.file,a=r.filename,d=r.content;return n.filename=(0,i.getFilenameFromUrl)(a),n.content=d,n.linkService.eventBus&&n.linkService.eventBus.dispatch("fileattachmentannotation",{source:l(l(n)),id:(0,o.stringToPDFString)(a),filename:a,content:d}),n}return d(t,e),h(t,[{key:"render",value:function(){this.container.className="fileAttachmentAnnotation";var e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}},{key:"_download",value:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,o.warn)("Download cannot be started due to unavailable download manager")}}]),t}(m),B=function(){function e(){p(this,e)}return h(e,null,[{key:"render",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var o=e.annotations[t];if(o){var r=f.create({data:o,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:e.renderInteractiveForms||!1,svgFactory:new i.DOMSVGFactory});r.isRenderable&&e.div.appendChild(r.render())}}}},{key:"update",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var i=e.annotations[t],o=e.div.querySelector('[data-annotation-id="'+i.id+'"]');o&&(o.style.transform="matrix("+e.viewport.transform.join(",")+")")}e.div.removeAttribute("hidden")}}]),e}();t.AnnotationLayer=B},function(e,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var a,s=r(1),l=r(151),c=(a=r(4))&&a.__esModule?a:{default:a},d=function(){throw new Error("Not implemented: SVGGraphics")};i.SVGGraphics=d;var u={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},p=function(){for(var e=new Uint8Array([137,80,78,71,13,10,26,10]),i=new Int32Array(256),r=0;r<256;r++){for(var a=r,l=0;l<8;l++)a=1&a?3988292384^a>>1&2147483647:a>>1&2147483647;i[r]=a}function d(e,t,n,o){var r=o,a=t.length;n[r]=a>>24&255,n[r+1]=a>>16&255,n[r+2]=a>>8&255,n[r+3]=255&a,n[r+=4]=255&e.charCodeAt(0),n[r+1]=255&e.charCodeAt(1),n[r+2]=255&e.charCodeAt(2),n[r+3]=255&e.charCodeAt(3),r+=4,n.set(t,r);var s=function(e,t,n){for(var o=-1,r=t;r<n;r++){var a=255&(o^e[r]);o=o>>>8^i[a]}return-1^o}(n,o+4,r+=t.length);n[r]=s>>24&255,n[r+1]=s>>16&255,n[r+2]=s>>8&255,n[r+3]=255&s}function u(e){var t=e.length,n=Math.ceil(t/65535),i=new Uint8Array(2+t+5*n+4),o=0;i[o++]=120,i[o++]=156;for(var r=0;t>65535;)i[o++]=0,i[o++]=255,i[o++]=255,i[o++]=0,i[o++]=0,i.set(e.subarray(r,r+65535),o),o+=65535,r+=65535,t-=65535;i[o++]=1,i[o++]=255&t,i[o++]=t>>8&255,i[o++]=255&~t,i[o++]=(65535&~t)>>8&255,i.set(e.subarray(r),o),o+=e.length-r;var a=function(e,t,n){for(var i=1,o=0,r=t;r<n;++r)o=(o+(i=(i+(255&e[r]))%65521))%65521;return o<<16|i}(e,0,e.length);return i[o++]=a>>24&255,i[o++]=a>>16&255,i[o++]=a>>8&255,i[o++]=255&a,i}function p(i,r,a,l){var p,g,h,f=i.width,m=i.height,y=i.data;switch(r){case s.ImageKind.GRAYSCALE_1BPP:g=0,p=1,h=f+7>>3;break;case s.ImageKind.RGB_24BPP:g=2,p=8,h=3*f;break;case s.ImageKind.RGBA_32BPP:g=6,p=8,h=4*f;break;default:throw new Error("invalid format")}var v,_,b=new Uint8Array((1+h)*m),w=0,C=0;for(v=0;v<m;++v)b[w++]=0,b.set(y.subarray(C,C+h),w),C+=h,w+=h;if(r===s.ImageKind.GRAYSCALE_1BPP&&l)for(w=0,v=0;v<m;v++)for(w++,_=0;_<h;_++)b[w++]^=255;var E=new Uint8Array([f>>24&255,f>>16&255,f>>8&255,255&f,m>>24&255,m>>16&255,m>>8&255,255&m,p,g,0,0,0]),S=function(e){if(!(0,c.default)())return u(e);try{var i;i=parseInt(o.versions.node)>=8?e:new t(e);var r=n(1267).deflateSync(i,{level:9});return r instanceof Uint8Array?r:new Uint8Array(r)}catch(e){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return u(e)}(b),G=e.length+36+E.length+S.length,A=new Uint8Array(G),T=0;return A.set(e,T),d("IHDR",E,A,T+=e.length),d("IDATA",S,A,T+=12+E.length),T+=12+S.length,d("IEND",new Uint8Array(0),A,T),(0,s.createObjectURL)(A,"image/png",a)}return function(e,t,n){return p(e,void 0===e.kind?s.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}(),g=function(){function e(){this.fontSizeScale=1,this.fontWeight=u.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=u.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}();i.SVGGraphics=d=function(){function e(e){if(Number.isInteger(e))return e.toString();var t=e.toFixed(10),n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function t(t){if(0===t[4]&&0===t[5]){if(0===t[1]&&0===t[2])return 1===t[0]&&1===t[3]?"":"scale("+e(t[0])+" "+e(t[3])+")";if(t[0]===t[3]&&t[1]===-t[2])return"rotate("+e(180*Math.acos(t[0])/Math.PI)+")"}else if(1===t[0]&&0===t[1]&&0===t[2]&&1===t[3])return"translate("+e(t[4])+" "+e(t[5])+")";return"matrix("+e(t[0])+" "+e(t[1])+" "+e(t[2])+" "+e(t[3])+" "+e(t[4])+" "+e(t[5])+")"}function n(e,t,n){this.svgFactory=new l.DOMSVGFactory,this.current=new g,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n}var i="http://www.w3.org/1999/xlink",o=["butt","round","square"],r=["miter","round","bevel"],a=0,c=0;return n.prototype={save:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null},group:function(e){this.save(),this.executeOpTree(e),this.restore()},loadDependencies:function(e){for(var t=this,n=e.fnArray,i=n.length,o=e.argsArray,r=0;r<i;r++)if(s.OPS.dependency===n[r])for(var a=o[r],l=0,c=a.length;l<c;l++){var d,u=a[l],p="g_"===u.substring(0,2);d=new Promise(p?function(e){t.commonObjs.get(u,e)}:function(e){t.objs.get(u,e)}),this.current.dependencies.push(d)}return Promise.all(this.current.dependencies)},transform:function(e,t,n,i,o,r){var a=[e,t,n,i,o,r];this.transformMatrix=s.Util.transform(this.transformMatrix,a),this.tgrp=null},getSVG:function(e,t){var n=this;this.viewport=t;var i=this._initialize(t);return this.loadDependencies(e).then((function(){n.transformMatrix=s.IDENTITY_MATRIX;var t=n.convertOpList(e);return n.executeOpTree(t),i}))},convertOpList:function(e){var t=e.argsArray,n=e.fnArray,i=n.length,o=[],r=[];for(var a in s.OPS)o[s.OPS[a]]=a;for(var l=0;l<i;l++){var c=n[l];r.push({fnId:c,fn:o[c],args:t[l]})}return function(e){for(var t=[],n=[],i=e.length,o=0;o<i;o++)"save"!==e[o].fn?"restore"===e[o].fn?t=n.pop():t.push(e[o]):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items);return t}(r)},executeOpTree:function(e){for(var t=e.length,n=0;n<t;n++){var i=e[n].fn,o=e[n].fnId,r=e[n].args;switch(0|o){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(r);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(r[0],r[1]);break;case s.OPS.setFont:this.setFont(r);break;case s.OPS.showText:case s.OPS.showSpacedText:this.showText(r[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(r[0],r[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(r[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(r[0]);break;case s.OPS.setHScale:this.setHScale(r[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(r[0],r[1],r[2],r[3],r[4],r[5]);break;case s.OPS.setTextRise:this.setTextRise(r[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(r[0]);break;case s.OPS.setLineWidth:this.setLineWidth(r[0]);break;case s.OPS.setLineJoin:this.setLineJoin(r[0]);break;case s.OPS.setLineCap:this.setLineCap(r[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(r[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(r[0],r[1],r[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(r[0],r[1],r[2]);break;case s.OPS.setDash:this.setDash(r[0],r[1]);break;case s.OPS.setGState:this.setGState(r[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintJpegXObject:this.paintJpegXObject(r[0],r[1],r[2]);break;case s.OPS.paintImageXObject:this.paintImageXObject(r[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(r[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(r[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(r[0],r[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(r[0],r[1],r[2],r[3],r[4],r[5]);break;case s.OPS.constructPath:this.constructPath(r[0],r[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(e[n].items);break;default:(0,s.warn)("Unimplemented operator "+i)}}},setWordSpacing:function(e){this.current.wordSpacing=e},setCharSpacing:function(e){this.current.charSpacing=e},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(t,n,i,o,r,a){var s=this.current;this.current.textMatrix=this.current.lineMatrix=[t,n,i,o,r,a],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,s.xcoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",e(s.fontSize)+"px"),s.tspan.setAttributeNS(null,"y",e(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.appendChild(s.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=s.IDENTITY_MATRIX,this.current.lineMatrix=s.IDENTITY_MATRIX,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.txtElement=this.svgFactory.createElement("svg:text"),this.current.txtgrp=this.svgFactory.createElement("svg:g"),this.current.xcoords=[]},moveText:function(t,n){var i=this.current;this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n,i.xcoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",e(i.fontSize)+"px"),i.tspan.setAttributeNS(null,"y",e(-i.y))},showText:function(n){var i=this.current,o=i.font,r=i.fontSize;if(0!==r){var a,l=i.charSpacing,c=i.wordSpacing,d=i.fontDirection,p=i.textHScale*d,g=n.length,h=o.vertical,f=r*i.fontMatrix[0],m=0;for(a=0;a<g;++a){var y=n[a];if(null!==y)if((0,s.isNum)(y))m+=-y*r*.001;else{var v=y.width,_=y.fontChar,b=v*f+((y.isSpace?c:0)+l)*d;y.isInFont||o.missingFile?(i.xcoords.push(i.x+m*p),i.tspan.textContent+=_,m+=b):m+=b}else m+=d*c}h?i.y-=m*p:i.x+=m*p,i.tspan.setAttributeNS(null,"x",i.xcoords.map(e).join(" ")),i.tspan.setAttributeNS(null,"y",e(-i.y)),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",e(i.fontSize)+"px"),i.fontStyle!==u.fontStyle&&i.tspan.setAttributeNS(null,"font-style",i.fontStyle),i.fontWeight!==u.fontWeight&&i.tspan.setAttributeNS(null,"font-weight",i.fontWeight);var w=i.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;w===s.TextRenderingMode.FILL||w===s.TextRenderingMode.FILL_STROKE?(i.fillColor!==u.fillColor&&i.tspan.setAttributeNS(null,"fill",i.fillColor),i.fillAlpha<1&&i.tspan.setAttributeNS(null,"fill-opacity",i.fillAlpha)):i.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?i.tspan.setAttributeNS(null,"fill","transparent"):i.tspan.setAttributeNS(null,"fill","none"),w!==s.TextRenderingMode.STROKE&&w!==s.TextRenderingMode.FILL_STROKE||this._setStrokeAttributes(i.tspan);var C=i.textMatrix;0!==i.textRise&&((C=C.slice())[5]+=i.textRise),i.txtElement.setAttributeNS(null,"transform",t(C)+" scale(1, -1)"),i.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),i.txtElement.appendChild(i.tspan),i.txtgrp.appendChild(i.txtElement),this._ensureTransformGroup().appendChild(i.txtElement)}},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},addFontStyle:function(e){this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=(0,s.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'+e.loadedName+'"; src: url('+t+"); }\n"},setFont:function(t){var n=this.current,i=this.commonObjs.get(t[0]),o=t[1];this.current.font=i,this.embedFonts&&i.data&&!this.embeddedFonts[i.loadedName]&&(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),n.fontMatrix=i.fontMatrix?i.fontMatrix:s.FONT_IDENTITY_MATRIX;var r=i.black?i.bold?"bolder":"bold":i.bold?"bold":"normal",a=i.italic?"italic":"normal";o<0?(o=-o,n.fontDirection=-1):n.fontDirection=1,n.fontSize=o,n.fontFamily=i.loadedName,n.fontWeight=r,n.fontStyle=a,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",e(-n.y)),n.xcoords=[]},endText:function(){var e=this.current;e.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())},setLineWidth:function(e){e>0&&(this.current.lineWidth=e)},setLineCap:function(e){this.current.lineCap=o[e]},setLineJoin:function(e){this.current.lineJoin=r[e]},setMiterLimit:function(e){this.current.miterLimit=e},setStrokeAlpha:function(e){this.current.strokeAlpha=e},setStrokeRGBColor:function(e,t,n){var i=s.Util.makeCssRgb(e,t,n);this.current.strokeColor=i},setFillAlpha:function(e){this.current.fillAlpha=e},setFillRGBColor:function(e,t,n){var i=s.Util.makeCssRgb(e,t,n);this.current.fillColor=i,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[]},setDash:function(e,t){this.current.dashArray=e,this.current.dashPhase=t},constructPath:function(t,n){var i=this.current,o=i.x,r=i.y;i.path=this.svgFactory.createElement("svg:path");for(var a=[],l=t.length,c=0,d=0;c<l;c++)switch(0|t[c]){case s.OPS.rectangle:o=n[d++],r=n[d++];var u=o+n[d++],p=r+n[d++];a.push("M",e(o),e(r),"L",e(u),e(r),"L",e(u),e(p),"L",e(o),e(p),"Z");break;case s.OPS.moveTo:o=n[d++],r=n[d++],a.push("M",e(o),e(r));break;case s.OPS.lineTo:o=n[d++],r=n[d++],a.push("L",e(o),e(r));break;case s.OPS.curveTo:o=n[d+4],r=n[d+5],a.push("C",e(n[d]),e(n[d+1]),e(n[d+2]),e(n[d+3]),e(o),e(r)),d+=6;break;case s.OPS.curveTo2:o=n[d+2],r=n[d+3],a.push("C",e(o),e(r),e(n[d]),e(n[d+1]),e(n[d+2]),e(n[d+3])),d+=4;break;case s.OPS.curveTo3:o=n[d+2],r=n[d+3],a.push("C",e(n[d]),e(n[d+1]),e(o),e(r),e(o),e(r)),d+=4;break;case s.OPS.closePath:a.push("Z")}i.path.setAttributeNS(null,"d",a.join(" ")),i.path.setAttributeNS(null,"fill","none"),this._ensureTransformGroup().appendChild(i.path),i.element=i.path,i.setCurrentPoint(o,r)},endPath:function(){if(this.pendingClip){var e=this.current,n="clippath"+a;a++;var i=this.svgFactory.createElement("svg:clipPath");i.setAttributeNS(null,"id",n),i.setAttributeNS(null,"transform",t(this.transformMatrix));var o=e.element.cloneNode(!0);"evenodd"===this.pendingClip?o.setAttributeNS(null,"clip-rule","evenodd"):o.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,i.appendChild(o),this.defs.appendChild(i),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach((function(e){e.clipGroup=null})),i.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl="url(#"+n+")",this.tgrp=null}},clip:function(e){this.pendingClip=e},closePath:function(){var e=this.current;if(e.path){var t=e.path.getAttributeNS(null,"d");t+="Z",e.path.setAttributeNS(null,"d",t)}},setLeading:function(e){this.current.leading=-e},setTextRise:function(e){this.current.textRise=e},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setHScale:function(e){this.current.textHScale=e/100},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],o=i[0],r=i[1];switch(o){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"Font":this.setFont(r);break;case"CA":this.setStrokeAlpha(r);break;case"ca":this.setFillAlpha(r);break;default:(0,s.warn)("Unimplemented graphic state "+o)}}},fill:function(){var e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())},stroke:function(){var e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())},_setStrokeAttributes:function(t){var n=this.current;t.setAttributeNS(null,"stroke",n.strokeColor),t.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",e(n.miterLimit)),t.setAttributeNS(null,"stroke-linecap",n.lineCap),t.setAttributeNS(null,"stroke-linejoin",n.lineJoin),t.setAttributeNS(null,"stroke-width",e(n.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",n.dashArray.map(e).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",e(n.dashPhase)+"px")},eoFill:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.closePath(),this.eoFillStroke()},paintSolidColorImageMask:function(){var e=this.current,t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",e.fillColor),this._ensureTransformGroup().appendChild(t)},paintJpegXObject:function(t,n,o){var r=this.objs.get(t),a=this.svgFactory.createElement("svg:image");a.setAttributeNS(i,"xlink:href",r.src),a.setAttributeNS(null,"width",e(n)),a.setAttributeNS(null,"height",e(o)),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",e(-o)),a.setAttributeNS(null,"transform","scale("+e(1/n)+" "+e(-1/o)+")"),this._ensureTransformGroup().appendChild(a)},paintImageXObject:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,s.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(t,n){var o=t.width,r=t.height,a=p(t,this.forceDataSchema,!!n),s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",e(o)),s.setAttributeNS(null,"height",e(r)),this.current.element=s,this.clip("nonzero");var l=this.svgFactory.createElement("svg:image");l.setAttributeNS(i,"xlink:href",a),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",e(-r)),l.setAttributeNS(null,"width",e(o)+"px"),l.setAttributeNS(null,"height",e(r)+"px"),l.setAttributeNS(null,"transform","scale("+e(1/o)+" "+e(-1/r)+")"),n?n.appendChild(l):this._ensureTransformGroup().appendChild(l)},paintImageMaskXObject:function(t){var n=this.current,i=t.width,o=t.height,r=n.fillColor;n.maskId="mask"+c++;var a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",n.maskId);var s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",e(i)),s.setAttributeNS(null,"height",e(o)),s.setAttributeNS(null,"fill",r),s.setAttributeNS(null,"mask","url(#"+n.maskId+")"),this.defs.appendChild(a),this._ensureTransformGroup().appendChild(s),this.paintInlineImageXObject(t,a)},paintFormXObjectBegin:function(t,n){if(Array.isArray(t)&&6===t.length&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),n){var i=n[2]-n[0],o=n[3]-n[1],r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x",n[0]),r.setAttributeNS(null,"y",n[1]),r.setAttributeNS(null,"width",e(i)),r.setAttributeNS(null,"height",e(o)),this.current.element=r,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){},_initialize:function(e){var n=this.svgFactory.create(e.width,e.height),i=this.svgFactory.createElement("svg:defs");n.appendChild(i),this.defs=i;var o=this.svgFactory.createElement("svg:g");return o.setAttributeNS(null,"transform",t(e.transform)),n.appendChild(o),this.svg=o,n},_ensureClipGroup:function(){if(!this.current.clipGroup){var e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup},_ensureTransformGroup:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",t(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}},n}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var o,r=(o=i(147))&&o.__esModule?o:{default:o},a=i(1),s=i(166);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){g(r,i,o,a,s,"next",e)}function s(e){g(r,i,o,a,s,"throw",e)}a(void 0)}))}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}var v=n(161),_=n(517),b=n(518),w=n(516),C=/^file:\/\/\/[a-zA-Z]:\//,E=function(){function e(t){var n,i;f(this,e),this.source=t,this.url=(n=t.url,"file:"===(i=w.parse(n)).protocol||i.host?i:/^[a-z]:[/\\]/i.test(n)?w.parse("file:///".concat(n)):(i.host||(i.protocol="file:"),i)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequest=null,this._rangeRequestReaders=[]}return y(e,[{key:"getFullReader",value:function(){return(0,a.assert)(!this._fullRequest),this._fullRequest=this.isFsUrl?new L(this):new T(this),this._fullRequest}},{key:"getRangeReader",value:function(e,t){var n=this.isFsUrl?new D(this,e,t):new P(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequest&&this._fullRequest.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}();t.PDFNodeStream=E;var S=function(){function e(t){f(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;var n=t.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)(),this._headersCapability=(0,a.createPromiseCapability)()}var t;return y(e,[{key:"read",value:(t=h(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),G=function(){function e(t){f(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)();var n=t.source;this._isStreamingSupported=!n.disableStream}var t;return y(e,[{key:"read",value:(t=h(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}();function A(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}var T=function(e){function t(e){var n;f(this,t);var i=function(t){if(404===t.statusCode){var i=new a.MissingPDFException('Missing PDF "'.concat(n._url,'".'));return n._storedError=i,void n._headersCapability.reject(i)}n._headersCapability.resolve(),n._setReadableStream(t);var o=function(e){return n._readableStream.headers[e.toLowerCase()]},r=(0,s.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:e.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),l=r.allowRangeRequests,c=r.suggestedLength;n._isRangeSupported=l,n._contentLength=c||n._contentLength,n._filename=(0,s.extractFilenameFromHeader)(o)};return(n=c(this,d(t).call(this,e)))._request=null,"http:"===n._url.protocol?n._request=_.request(A(n._url,e.httpHeaders),i):n._request=b.request(A(n._url,e.httpHeaders),i),n._request.on("error",(function(e){n._storedError=e,n._headersCapability.reject(e)})),n._request.end(),n}return u(t,e),t}(S),P=function(e){function t(e,n,i){var o;for(var r in f(this,t),(o=c(this,d(t).call(this,e)))._httpHeaders={},e.httpHeaders){var s=e.httpHeaders[r];void 0!==s&&(o._httpHeaders[r]=s)}o._httpHeaders.Range="bytes=".concat(n,"-").concat(i-1);var l=function(e){if(404!==e.statusCode)o._setReadableStream(e);else{var t=new a.MissingPDFException('Missing PDF "'.concat(o._url,'".'));o._storedError=t}};return o._request=null,"http:"===o._url.protocol?o._request=_.request(A(o._url,o._httpHeaders),l):o._request=b.request(A(o._url,o._httpHeaders),l),o._request.on("error",(function(e){o._storedError=e})),o._request.end(),o}return u(t,e),t}(G),L=function(e){function t(e){var n;f(this,t),n=c(this,d(t).call(this,e));var i=decodeURIComponent(n._url.path);return C.test(n._url.href)&&(i=i.replace(/^\//,"")),v.lstat(i,(function(e,t){if(e)return"ENOENT"===e.code&&(e=new a.MissingPDFException('Missing PDF "'.concat(i,'".'))),n._storedError=e,void n._headersCapability.reject(e);n._contentLength=t.size,n._setReadableStream(v.createReadStream(i)),n._headersCapability.resolve()})),n}return u(t,e),t}(S),D=function(e){function t(e,n,i){var o;f(this,t),o=c(this,d(t).call(this,e));var r=decodeURIComponent(o._url.path);return C.test(o._url.href)&&(r=r.replace(/^\//,"")),o._setReadableStream(v.createReadStream(r,{start:n,end:i-1})),o}return u(t,e),t}(G)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&/^file:/.test(t)?new i.MissingPDFException('Missing PDF "'+t+'".'):new i.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){var t=e("Content-Disposition");if(t){var n=(0,o.getFilenameFromContentDispositionHeader)(t);if(/\.pdf$/i.test(n))return n}return null},t.validateRangeRequestCapabilities=function(e){var t=e.getResponseHeader,n=e.isHttp,o=e.rangeChunkSize,r=e.disableRange;(0,i.assert)(o>0,"Range chunk size must be larger than zero");var a={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t("Content-Length"),10);return Number.isInteger(s)?(a.suggestedLength=s,s<=2*o||r||!n||"bytes"!==t("Accept-Ranges")||"identity"!==(t("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a):a},t.validateResponseStatus=function(e){return 200===e||206===e};var i=n(1),o=n(167)},function(e,t,n){"use strict";function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){var t=!0,n=a("filename\\*","i").exec(e);if(n){var o=c(n=n[1]);return l(o=u(o=d(o=unescape(o))))}if(n=function(e){for(var t,n=[],o=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(t=o.exec(e));){var r=i(t,4),s=r[1],l=r[2],u=r[3];if((s=parseInt(s,10))in n){if(0===s)break}else n[s]=[l,u]}var p=[];for(s=0;s<n.length&&s in n;++s){var g=i(n[s],2);l=g[0],u=c(u=g[1]),l&&(u=unescape(u),0===s&&(u=d(u))),p.push(u)}return p.join("")}(e))return l(u(n));if(n=a("filename","i").exec(e)){var r=c(n=n[1]);return l(r=u(r))}function a(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function s(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{var i=new TextDecoder(e,{fatal:!0}),o=Array.from(n,(function(e){return 255&e.charCodeAt(0)}));n=i.decode(new Uint8Array(o)),t=!1}catch(i){if(/^utf-?8$/i.test(e))try{n=decodeURIComponent(escape(n)),t=!1}catch(e){}}}return n}function l(e){return t&&/[\x80-\xff]/.test(e)&&(e=s("utf-8",e),t&&(e=s("iso-8859-1",e))),e}function c(e){if(e.startsWith('"')){for(var t=e.slice(1).split('\\"'),n=0;n<t.length;++n){var i=t[n].indexOf('"');-1!==i&&(t[n]=t[n].slice(0,i),t.length=n+1),t[n]=t[n].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function d(e){var t=e.indexOf("'");return-1===t?e:s(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function u(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,n,i){if("q"===n||"Q"===n)return s(t,i=(i=i.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{i=atob(i)}catch(e){}return s(t,i)}))}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var i,o=(i=n(147))&&i.__esModule?i:{default:i},r=n(1),a=n(166);function s(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){s(r,i,o,a,l,"next",e)}function l(e){s(r,i,o,a,l,"throw",e)}a(void 0)}))}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function p(e,t,n){return{method:"GET",headers:e,signal:n&&n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}var g=function(){function e(t){c(this,e),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return u(e,[{key:"getFullReader",value:function(){return(0,r.assert)(!this._fullRequestReader),this._fullRequestReader=new h(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){var n=new f(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}();t.PDFFetchStream=g;var h=function(){function e(t){var n=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0,this._filename=null;var i=t.source;for(var o in this._withCredentials=i.withCredentials,this._contentLength=i.length,this._headersCapability=(0,r.createPromiseCapability)(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._headers=new Headers,this._stream.httpHeaders){var s=this._stream.httpHeaders[o];void 0!==s&&this._headers.append(o,s)}var l=i.url;fetch(l,p(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,l);n._reader=e.body.getReader(),n._headersCapability.resolve();var t=function(t){return e.headers.get(t)},i=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:n._stream.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),o=i.allowRangeRequests,s=i.suggestedLength;n._isRangeSupported=o,n._contentLength=s||n._contentLength,n._filename=(0,a.extractFilenameFromHeader)(t),!n._isStreamingSupported&&n._isRangeSupported&&n.cancel(new r.AbortException("streaming is disabled"))})).catch(this._headersCapability.reject),this.onProgress=null}var t;return u(e,[{key:"read",value:(t=l(o.default.mark((function e(){var t,n,i,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._headersCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(i=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:i});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),r=new Uint8Array(n).buffer,e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),f=function(){function e(t,n,i){var o=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0;var s=t.source;for(var l in this._withCredentials=s.withCredentials,this._readCapability=(0,r.createPromiseCapability)(),this._isStreamingSupported=!s.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=new Headers,this._stream.httpHeaders){var d=this._stream.httpHeaders[l];void 0!==d&&this._headers.append(l,d)}var u=n+"-"+(i-1);this._headers.append("Range","bytes="+u);var g=s.url;fetch(g,p(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,g);o._readCapability.resolve(),o._reader=e.body.getReader()})),this.onProgress=null}var t;return u(e,[{key:"read",value:(t=l(o.default.mark((function e(){var t,n,i,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(i=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:i});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),r=new Uint8Array(n).buffer,e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=f,t.NetworkManager=d;var i=s(n(147)),o=n(1),r=n(166),a=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,i,o,r,a){try{var s=e[r](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function a(e){l(r,i,o,a,s,"next",e)}function s(e){l(r,i,o,a,s,"throw",e)}a(void 0)}))}}function d(e,t){this.url=e,t=t||{},this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this.withCredentials=t.withCredentials||!1,this.getXhr=t.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null),this.loadedRequests=Object.create(null)}function u(e){var t=e.response;return"string"!=typeof t?t:(0,o.stringToBytes)(t).buffer}var p,g,h=function(){try{var e=new XMLHttpRequest;return e.open("GET",a.default.location.href),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return!1}}();function f(e){this._source=e,this._manager=new d(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}function m(e,t){this._manager=e;var n={onHeadersReceived:this._onHeadersReceived.bind(this),onProgressiveData:t.disableStream?null:this._onProgressiveData.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}function y(e,t,n){this._manager=e;var i={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=e.requestRange(t,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}d.prototype={requestRange:function(e,t,n){var i={begin:e,end:t};for(var o in n)i[o]=n[o];return this.request(i)},requestFull:function(e){return this.request(e)},request:function(e){var t=this.getXhr(),n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};for(var o in t.open("GET",this.url),t.withCredentials=this.withCredentials,this.httpHeaders){var r=this.httpHeaders[o];void 0!==r&&t.setRequestHeader(o,r)}if(this.isHttp&&"begin"in e&&"end"in e){var a=e.begin+"-"+(e.end-1);t.setRequestHeader("Range","bytes="+a),i.expectedStatus=206}else i.expectedStatus=200;return h&&e.onProgressiveData?(t.responseType="moz-chunked-arraybuffer",i.onProgressiveData=e.onProgressiveData,i.mozChunked=!0):t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n},onProgress:function(e,t){var n=this.pendingRequests[e];if(n){if(n.mozChunked){var i=u(n.xhr);n.onProgressiveData(i)}var o=n.onProgress;o&&o(t)}},onStateChange:function(e,t){var n=this.pendingRequests[e];if(n){var i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4===i.readyState&&e in this.pendingRequests)if(delete this.pendingRequests[e],0===i.status&&this.isHttp)n.onError&&n.onError(i.status);else{var o=i.status||200;if(200===o&&206===n.expectedStatus||o===n.expectedStatus){this.loadedRequests[e]=!0;var r=u(i);if(206===o){var a=i.getResponseHeader("Content-Range"),s=/bytes (\d+)-(\d+)\/(\d+)/.exec(a),l=parseInt(s[1],10);n.onDone({begin:l,chunk:r})}else n.onProgressiveData?n.onDone(null):r?n.onDone({begin:0,chunk:r}):n.onError&&n.onError(i.status)}else n.onError&&n.onError(i.status)}}},hasPendingRequests:function(){for(var e in this.pendingRequests)return!0;return!1},getRequestXhr:function(e){return this.pendingRequests[e].xhr},isStreamingRequest:function(e){return!!this.pendingRequests[e].onProgressiveData},isPendingRequest:function(e){return e in this.pendingRequests},isLoadedRequest:function(e){return e in this.loadedRequests},abortAllRequests:function(){for(var e in this.pendingRequests)this.abortRequest(0|e)},abortRequest:function(e){var t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},f.prototype={_onRangeRequestReaderClosed:function(e){var t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)},getFullReader:function(){return(0,o.assert)(!this._fullRequestReader),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader},getRangeReader:function(e,t){var n=new y(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n},cancelAllRequests:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}},m.prototype={_onHeadersReceived:function(){var e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=function(e){return t.getResponseHeader(e)},i=(0,r.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),o=i.allowRangeRequests,a=i.suggestedLength;o&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(n);var s=this._manager;s.isStreamingRequest(e)?this._isStreamingSupported=!0:this._isRangeSupported&&s.abortRequest(e),this._headersReceivedCapability.resolve()},_onProgressiveData:function(e){this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._cachedChunks.push(e)},_onDone:function(e){e&&this._onProgressiveData(e.chunk),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[])},_onError:function(e){var t=this._url,n=(0,r.createResponseStatusError)(e,t);this._storedError=n,this._headersReceivedCapability.reject(n),this._requests.forEach((function(e){e.reject(n)})),this._requests=[],this._cachedChunks=[]},_onProgress:function(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})},get filename(){return this._filename},get isRangeSupported(){return this._isRangeSupported},get isStreamingSupported(){return this._isStreamingSupported},get contentLength(){return this._contentLength},get headersReady(){return this._headersReceivedCapability.promise},read:(p=c(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._storedError){e.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){e.next=5;break}return t=this._cachedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 5:if(!this._done){e.next=7;break}return e.abrupt("return",{value:void 0,done:!0});case 7:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 10:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)}),cancel:function(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},y.prototype={_close:function(){this.onClosed&&this.onClosed(this)},_onDone:function(e){var t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._close()},_onProgress:function(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})},get isStreamingSupported(){return!1},read:(g=c(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}])},e.exports=r()}).call(this,n(203).Buffer,n(105),n(165))},,,,,,,,,,function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WINDOW_STATUS_BLOCKED=void 0,n(19),n(24),n(58),n(45),n(9),n(83),n(129);var o=n(1),r=i(n(385)),a=i(n(535)),s=n(766);const l=n(1125),c=n(473),{FILE_FORMATS:d}=n(12);function u(e){this._settings=e,this.setQueryLimit(10),this._currentFolder=null,this._folders={},this._actions=[],this._filterFileTypes=new Set,this.PREVIOUS_SELECTED_FOLDER_PATH=[],this.getPreviousSelectedFolder().then(e=>{e&&this.setCurrentFolder(e)})}t.WINDOW_STATUS_BLOCKED="window-blocked",o.GObject.inheritAndMix(u,o.GObject,[o.GEventTarget]),u.DriveEvent=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.source=e,this.type=t,this.data=n},o.GObject.inherit(u.DriveEvent,o.GEvent),u.DriveEvent.type=null,u.DriveEvent.source=null,u.DriveEvent.data=null,u.DriveEvent.Type={Added:0,UserUpdated:1,FolderSwitchRequired:2,FileDeleted:3},u.ExceptionCode={InvalidCredentials:1};class p extends a.default{constructor(e,t){super(e),this.code=t,this.__proto__=p.prototype,this.name="CloudException"}toString(){return"[Object CloudException]"}}function g(e){return e.type||e.mime}u.CloudException=p,u.prototype._driveSettings=null,u.prototype.setDriveSettings=function(e){this._driveSettings=l.from(e)},u.prototype.shouldOnlyListOwnedFiles=function(){return!!this._driveSettings&&this._driveSettings.onlyListFilesOwnedByUser},u.prototype._queryLimit=null,u.prototype._currentFolder=null,u.prototype.SORT_TYPES=s.GFilesPanelSortTypes,u.prototype.FILTER_FILE_TYPES=s.GFilesPanelFileTypesFilter,u.prototype._sortType=u.prototype.SORT_TYPES.UPDATED,u.prototype._filterFileTypes=null,u.prototype._sortDirection=s.GFilesPanelSortDirections.DESCEND,u.prototype._folders=null,u.prototype._corporateStorage=null,u.prototype._actions=null,u.prototype._defaultEmpyMessage=null,u.prototype.CURRENT_FOLDER_PROP="designer.filespanel.base-drive.current-folder",u.prototype.getUser=function(){throw Error("Not implemented!")},u.prototype._driveInstalled=!1,u.getInstance=function(){throw Error("Not implemented!")},u.prototype.hasUserProfile=function(){return!1},u.prototype.getSortType=function(){return this._sortType},u.prototype.setSortType=function(e){Object.values(this.SORT_TYPES).includes(e)&&(this._sortType=e)},u.prototype.getAvailableFileTypesFilter=function(){return this._driveSettings&&this._driveSettings.supportedFileFilters?this._driveSettings.supportedFileFilters:this.FILTER_FILE_TYPES},u.prototype.getSelectedFilterForFileTypes=function(){return Array.from(this._filterFileTypes)},u.prototype.addFileTypeToSelectedFilter=function(e){this._isFilterFileTypeSupported(e)&&this._filterFileTypes.add(e)},u.prototype.deleteFileTypeFromSelectedFilter=function(e){this._isFilterFileTypeSupported(e)&&this._filterFileTypes.delete(e)},u.prototype._isFilterFileTypeSupported=function(e){return this.getAvailableFileTypesFilter().some(t=>t.type===e)},u.prototype.clearAllFileTypesFromSelectedFilter=function(){this._filterFileTypes=new Set},u.prototype.getSortDirection=function(){return this._sortDirection},u.prototype.setSortDirection=function(e){Object.values(s.GFilesPanelSortDirections).includes(e)&&(this._sortDirection=e)},u.prototype.hasMoreItemsToLoad=function(){return!1},u.prototype.setQueryLimit=function(e){return this._queryLimit=parseInt(e,10),this},u.prototype.isInstalled=function(){return this._driveInstalled},u.prototype.install=function(e){return this._driveInstalled=!0,Promise.resolve()},u.prototype.uninstall=function(){return this._driveInstalled=!1,Promise.resolve()},u.prototype.getQueryLimit=function(){return this._queryLimit},u.prototype.setCurrentFolder=function(e){return this._currentFolder=e,gContainer.setProperty(this.CURRENT_FOLDER_PROP,JSON.stringify(e)),this},u.prototype.isFolderSharedWithMeFolder=function(e){return!1},u.prototype.getCurrentFolder=function(){return this._currentFolder},u.prototype.fetchFolders=function(e){throw Error("Not implemented!")},u.prototype.isLoadFoldersOnDemandSupported=function(){return!1},u.prototype.hasFolders=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.fetchFolders("name",e,1).then(e=>!!e&&e.length>0)},u.prototype.getFolders=function(){return this._folders},u.prototype.createFolder=function(e){throw Error("Not implemented!")},u.prototype.navigateToParentFolder=function(){throw Error("Not implemented!")},u.prototype.getFile=function(e){throw Error("Not implemented!")},u.prototype.getFolder=function(e){throw Error("Not implemented!")},u.prototype.getRawFile=function(e,t,n){throw Error("Not implemented!")},u.prototype.openFile=async function(e,t){return new Promise((e,t)=>{t("Not implemented!")})},u.prototype.saveNewFile=function(e,t){throw Error("Not implemented!")},u.prototype.fetchFiles=function(e,t,n){throw Error("Not implemented!")},u.prototype.fetchRecentFiles=async function(){return[]},u.prototype.filterSupportedFileFormats=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.getSupportedMIMETypes();return e.filter(e=>t.includes(e.getMimeType()))},u.prototype.renameItem=function(e,t){throw Error("Not implemented!")},u.prototype.isItemAllowedToBeRendered=function(e){throw Error("Not implemented!")},u.prototype.itemRequiresLazyUpdate=async function(e){return!1},u.prototype.getItemLazyUpdate=async function(e){return e},u.prototype.isFileAllowedToBeOpened=function(e){throw Error("Not implemented!")},u.prototype.deleteItem=function(e){throw Error("Not implemented!")},u.prototype.cutPaste=function(e){throw Error("Not implemented!")},u.prototype.fileMove=function(e,t){throw Error("Not implemented!")},u.prototype.copyPaste=function(e){throw Error("Not implemented!")},u.prototype.supportsCorporateStorage=function(){return!1},u.prototype.setCorporateStorage=async function(e){this._corporateStorage=e},u.prototype.initLastCorporateStorage=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";const n=this;async function i(e){if(!e)return null;const i=await n.getCorporateStorages();return i.length?i.find(n=>n[t]===e):null}async function o(e){n.setCorporateStorage(e);let t=await n.getPreviousSelectedFolder();n.setCurrentFolder(t||n.getRootFolder())}return e&&this.supportsCorporateStorage()?gContainer.getProperty(e).then(i).then(o):o(null)},u.prototype.saveLastTeamDriveId=function(e,t){if(!e)throw new r.default("Invalid arguments for saving last team drive id");return gContainer.setProperty(e,t),this},u.prototype.getCorporateStorage=function(){return this._corporateStorage},u.prototype.getCorporateStorages=async function(){return[]},u.prototype.isRootFolder=function(e){throw new Error("Not implemented!")},u.prototype.getRootFolder=function(){throw new Error("Not implemented!")},u.prototype.supportsSaveCollisionFlow=function(){return!1},u.prototype.requiresOverwriteCollisionHandling=function(){return!1},u.prototype.fileExists=async function(e,t,n){throw new Error("Not implemented!")},u.prototype.folderExists=function(e,t){throw new Error("Not implemented!")},u.prototype.getPreviousSelectedFolder=function(){return this.CURRENT_FOLDER_PROP?gContainer.getProperty(this.CURRENT_FOLDER_PROP).then(JSON.parse).catch(e=>{console.log("Current folder is not set",e.message)}):Promise.resolve(null)},u.prototype.clearPreviousSelectedFolder=function(){return gContainer.removeProperty(this.CURRENT_FOLDER_PROP)},u.prototype.getSupportedExtensions=function(){return this.getSupportedFileFormats().map(e=>{let{ext:t}=e;return t.toLowerCase()})},u.prototype.getSupportedMIMETypes=function(){return this.getSupportedFileFormats().map(e=>g(e))},u.prototype.filterTypesWithSearchString=function(e,t){if(!t||!e)return e;let n;if((t=t.toLowerCase()).startsWith(".")?n=t.slice(1):t.startsWith("*.")&&(n=t.slice(2)),!n)return e;const i=this.getSupportedFileFormats(),o=i.filter(t=>e.includes(g(t))).map(e=>e.ext).filter(e=>e.startsWith(n));if(o.length>0){return i.filter(e=>o.includes(e.ext)).map(g)}return[]},u.prototype.getSupportedFileFormats=function(){return this._driveSettings&&this._driveSettings.supportedFileFormats?this._driveSettings.supportedFileFormats:d},u.prototype.getDefaultFileFormat=function(){return this.getSupportedFileFormats().find(e=>e.default)},u.prototype.findFileFormatByExtension=function(e){return this.getSupportedFileFormats().find(t=>{let{ext:n}=t;return!!n&&n.toLowerCase()===e.toLowerCase()})},u.prototype.lookupByMimeType=function(e){const t=e.toLowerCase();return this.getSupportedFileFormats().find(e=>{const n=g(e);return!!n&&n.toLowerCase()===t})},u.prototype.getFileFormat=function(e){var t=this.findFileFormatByExtension(e.extension||e.ext);return t||(t=this.lookupByMimeType(e.type)),t},u.prototype.isFileSupported=function(e){return!(!e||!(this.getSupportedMIMETypes().includes(e.type)||this.getSupportedMIMETypes().includes(e.mimeType)||e.extension&&this.getSupportedExtensions().includes(e.extension.toLowerCase())))},u.prototype.canAccessFile=async function(){return!0},u.prototype.addAction=function(e){this._actions.push(e)},u.prototype.getActions=function(){return this._actions},u.prototype.setDefaultEmptyMessage=function(e){this._defaultEmpyMessage=e},u.prototype.getDefaultEmptyMessage=function(){return this._defaultEmpyMessage},u.prototype.generatePreviousSelectedFolderPath=function(){throw new Error("Not implemented!")},u.prototype.containsInPreviousPath=function(e){return this.PREVIOUS_SELECTED_FOLDER_PATH.find(t=>t===e.getId())},u.prototype.resetPreviousSelectedFolderPath=function(){this.PREVIOUS_SELECTED_FOLDER_PATH=[]},u.prototype.removeLoadedFolderFromPreviousPath=function(e){this.PREVIOUS_SELECTED_FOLDER_PATH=this.PREVIOUS_SELECTED_FOLDER_PATH.filter(t=>t!==e.getId())},u.prototype.hasTitleValidation=function(){return!1},u.prototype.getTitleValidator=function(){throw Error("NOT IMPLEMENTED")},u.prototype.loadExampleFiles=async function(){return Promise.resolve([])},u.prototype.isAssetsSharedWithMeFolder=function(){return!1},u.prototype.getSharedFilesWithMeFolder=function(){return null},u.prototype.getDriveIdPropertyName=function(){return"id"},u.Provider=c.Provider;var h=u;t.default=h},function(e,t){e.exports={nodeEnv:"production",isBeta:!1,storeVendor:"",isCorel:!1,isTeams:"teams.coreldraw.app"===window.location.hostname}},function(e,t,n){"use strict";n(3);var i=n(1);function o(){}i.GObject.inherit(o,i.GEvent),o.prototype.toString=function(){return"[Object GMenuOpenEvent]"},o.EVENT=new o,e.exports=o},function(e,t,n){"use strict";var i=n(1);function o(e){this.user=e}i.GObject.inherit(o,i.GEvent),o.prototype.user=null,e.exports=o},function(e,t,n){"use strict";n(3);var i=n(1),o=n(353);function r(){o.call(this)}i.GObject.inherit(r,o),r.prototype.getOrientation=function(){return null},r.prototype.getMinimumWidth=function(){throw new Error("Not implemented.")},r.prototype.getDefaultWidth=function(){throw new Error("Not implemented.")},r.prototype.getSettingWidth=function(){return gDesigner.getSetting("sidebars_width_".concat(this.getId()),this.getDefaultWidth())},r.prototype.isResizeable=function(){return!1},r.prototype.isDeactivatable=function(){return!0},r.prototype.relayout=function(){},r.prototype.resize=function(){},r.prototype.init=function(e){},r.prototype.activate=function(){},r.prototype.isToolAllowed=function(e){return!0},r.prototype.deactivate=function(){},r.prototype.getTouchTools=function(e){let{disableContextSensitive:t=!1}=e;return null},r.prototype.updateBadge=function(e){return!1},r.prototype.toString=function(){return"[Object GSidebar]"},e.exports=r},function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t){this.type=e,this.sidebar=t}i.GObject.inherit(o,i.GEvent),o.Type={Deactivated:10,Activated:11,ChildAdded:12,ChildRemoved:14},o.prototype.type=null,o.prototype.sidebar=null,o.prototype.toString=function(){return"[Object GSidebars.SidebarEvent]"},e.exports=o},function(e,t,n){"use strict";n(3);var i=n(1);function o(e){this.status=e}i.GObject.inherit(o,i.GEvent),o.Status={Init:0,Ready:1},o.prototype.status=null,o.prototype.toString=function(){return"[Object GApplicationStatusEvent]"},e.exports=o},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(56),s=n(18),l=n(94);function c(){c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GClipAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GClipAction","tooltip-description")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Clip.mp4",learnMore:"https://documentation.designer.io/organizing-your-designs/clipping-masking/"})}}i.GObject.inherit(c,l),c.ID="modify.clip",c.TITLE=new i.GLocaleKey("GClipAction","title"),c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getIcon=function(){return"gravit-icon-clip-circle"},c.prototype.getCategory=function(){return s.CATEGORY_MODIFY},c.prototype.getGroup=function(){return"structure-group"},c.prototype.isEnabled=function(){if(!l.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();return t&&t.length>1}return!1},c.prototype.getShortcut=function(){return[o.GKey.Constant.OPTION,o.GKey.Constant.META,"M"]},c.prototype.execute=function(e,t){var n=gDesigner.getActiveDocument().getEditor(),o=gDesigner.getActiveDocument().getScene(),a=i.GNode.order(n.getIndividualSelection().slice(),e),s=a.shift();if(!s.isLocked()){var l,c=s.getPaintBBox();t||n.beginTransaction();try{l=new Set;for(var d=0;d<a.length;++d)l.add(a[d].getParent());try{(0,r.blockChanges)(n,l,o,s);for(d=0;d<a.length;++d){var u=a[d];u.validateInsertion(s)&&u.getPaintBBox()&&c&&u.getPaintBBox().intersectsRect(c)&&(u.getParent().removeChild(u),s.appendChild(u))}}finally{(0,r.releaseChanges)(n,l,o,s),n.updateSelection(!1,[s])}}finally{t||n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GClipAction","text.clip-selecion")))}}},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]},c.prototype.toString=function(){return"[Object GClipAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(94);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GConvertToPathAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GConvertToPathAction","tooltip-description")),shortcut:l.SHORTCUT,learnMore:"https://documentation.designer.io/basics/modify-paths/#convert-to-path-raw-path"})}}i.GObject.inherit(l,s),l.ID="modify.converttopath",l.TITLE=new i.GLocaleKey("GConvertToPathAction","title"),l.SHORTCUT=[o.GKey.Constant.META,o.GKey.Constant.SHIFT,"P"],l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},l.prototype.getIcon=function(){return"gravit-icon-convert-to-path"},l.prototype.getGroup=function(){return"structure/modify"},l.prototype.getShortcut=function(){return l.SHORTCUT},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t)for(var n=0;n<t.length;++n)if(!(t[n]instanceof i.GPath)&&!(t[n]instanceof i.GImage)&&!(t[n]instanceof i.GPathsGraph)&&(t[n]instanceof i.GPathBase||t[n].hasMixin(i.GVertexSource)&&!(t[n]instanceof i.GCompoundPath)))return!0}return!1},l.prototype.execute=function(){gDesigner.getActiveDocument().getEditor().convertSelectionToPaths()},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GConvertToPathAction]"},e.exports=l},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(56),s=n(18),l=n(94);function c(){c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GGroupAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GGroupAction","tooltip-description")),shortcut:c.SHORTCUT,learnMore:"https://documentation.designer.io/organizing-your-designs/groups/"})}}i.GObject.inherit(c,l),c.ID="modify.group",c.TITLE=new i.GLocaleKey("GGroupAction","title"),c.SHORTCUT=[o.GKey.Constant.META,"G"],c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getIcon=function(){return"gravit-icon-group"},c.prototype.getCategory=function(){return s.CATEGORY_MODIFY},c.prototype.getGroup=function(){return"structure-group"},c.prototype.getShortcut=function(){return c.SHORTCUT},c.prototype.isEnabled=function(){if(!l.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t&&t.length>0)for(var n=new i.GGroup,o=t.length-1;o>=0;--o){var r=t[o];if(r.validateInsertion(n)&&!r.getParent().isLocked()&&n.validateInsertion(r.getParent()))return!0}}return!1},c.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=i.GNode.order(e.getIndividualSelection().slice());e.beginTransaction();try{for(var n=new i.GGroup,o=[],a=0;a<t.length;++a){(p=t[a]).validateInsertion(n)&&o.push(p)}if(o.length>0){var s=o[o.length-1],l=s.getParent(),c=s.getNext();if(!l.isLocked()&&n.validateInsertion(l)){l.insertChild(n,c);var d,u=gDesigner.getActiveDocument().getScene();try{d=new Set;for(a=0;a<o.length;++a)d.add(o[a].getParent());(0,r.blockChanges)(e,d,u,n);for(a=0;a<o.length;++a){var p;(p=o[a]).getParent().removeChild(p),n.appendChild(p)}}finally{(0,r.releaseChanges)(e,d,u,n)}}e.updateSelection(!1,[n])}}finally{e.commitTransaction(i.GLocale.get(new i.GLocaleKey("GGroupAction","title")))}},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GGroupAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26),s=n(144);const l=n(399);function c(){}i.GObject.inherit(c,a),c.ID="file.open",c.TITLE=new i.GLocaleKey("GOpenAction","title"),c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return r.CATEGORY_FILE},c.prototype.getGroup=function(){return"file-open"},c.prototype.getShortcut=function(){return[o.GKey.Constant.META,"O"]},c.prototype.isEnabled=function(e){return(e=e||gDesigner.getDefaultStorage()).canPromptOpen()&&gDesigner.getApplicationManager().isOpenFilesFromLocalEnabled()},c.prototype.isVisible=function(){return o.GPlatform.webBrowser!==o.GPlatform.constructor.WebBrowser.Safari},c.prototype.execute=function(e,t){new l(()=>{(e=e||gDesigner.getDefaultStorage()).openPrompt(s.FileTypes.filter(e=>e.load),e=>{gDesigner.openDocument(e),t&&t()},!1)},()=>{gDesigner.stats("action-cancelled_anonymous",this.getId())})},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-touch-file-open":""},c.prototype.toString=function(){return"[Object GOpenAction]"},e.exports=c},function(e,t,n){var i;!function(o,r){"use strict";var a="model",s="name",l="type",c="vendor",d="version",u="mobile",p="tablet",g="smarttv",h=function(e){var t={};for(var n in e)t[e[n].toUpperCase()]=e[n];return t},f=function(e,t){return"string"==typeof e&&-1!==m(t).indexOf(m(e))},m=function(e){return e.toLowerCase()},y=function(e,t){if("string"==typeof e)return e=e.replace(/^\s+|\s+$/g,""),void 0===t?e:e.substring(0,255)},v=function(e,t){for(var n,i,o,r,a,s,l=0;l<t.length&&!a;){var c=t[l],d=t[l+1];for(n=i=0;n<c.length&&!a;)if(a=c[n++].exec(e))for(o=0;o<d.length;o++)s=a[++i],"object"==typeof(r=d[o])&&r.length>0?2==r.length?"function"==typeof r[1]?this[r[0]]=r[1].call(this,s):this[r[0]]=r[1]:3==r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?this[r[0]]=s?s.replace(r[1],r[2]):void 0:this[r[0]]=s?r[1].call(this,s,r[2]):void 0:4==r.length&&(this[r[0]]=s?r[3].call(this,s.replace(r[1],r[2])):void 0):this[r]=s||void 0;l+=2}},_=function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(f(t[n][i],e))return"?"===n?void 0:n}else if(f(t[n],e))return"?"===n?void 0:n;return e},b={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},w={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[s,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[s,d],[/opios[\/ ]+([\w\.]+)/i],[d,[s,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[d,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,d],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[d,[s,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[d,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[s,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[d,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],d],[/\bfocus\/([\w\.]+)/i],[d,[s,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[d,[s,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[d,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[s,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[d,[s,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[d,[s,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],d],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[s,d],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[s],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[s,"Facebook"],d],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[s,d],[/\bgsa\/([\w\.]+) .*safari\//i],[d,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[d,[s,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],d],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[d,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[s,d],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[d,[s,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[d,s],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[s,[d,_,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[s,d],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[s,"Netscape"],d],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[d,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[s,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",m]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",m]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",m]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[a,[c,"Samsung"],[l,p]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[a,[c,"Samsung"],[l,u]],[/((ipod|iphone)\d+,\d+)/i],[a,[c,"Apple"],[l,u]],[/(ipad\d+,\d+)/i],[a,[c,"Apple"],[l,p]],[/\((ip(?:hone|od)[\w ]*);/i],[a,[c,"Apple"],[l,u]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[c,"Apple"],[l,p]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[a,[c,"Huawei"],[l,p]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[a,[c,"Huawei"],[l,u]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[a,/_/g," "],[c,"Xiaomi"],[l,u]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[a,/_/g," "],[c,"Xiaomi"],[l,p]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[c,"OPPO"],[l,u]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[a,[c,"Vivo"],[l,u]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[a,[c,"Realme"],[l,u]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[a,[c,"Motorola"],[l,u]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[a,[c,"Motorola"],[l,p]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[a,[c,"LG"],[l,p]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[a,[c,"LG"],[l,u]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[a,[c,"Lenovo"],[l,p]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[a,/_/g," "],[c,"Nokia"],[l,u]],[/(pixel c)\b/i],[a,[c,"Google"],[l,p]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[a,[c,"Google"],[l,u]],[/droid.+ ([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[c,"Sony"],[l,u]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[a,"Xperia Tablet"],[c,"Sony"],[l,p]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[a,[c,"OnePlus"],[l,u]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[a,[c,"Amazon"],[l,p]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[a,/(.+)/g,"Fire Phone $1"],[c,"Amazon"],[l,u]],[/(playbook);[-\w\),; ]+(rim)/i],[a,c,[l,p]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[a,[c,"BlackBerry"],[l,u]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[a,[c,"ASUS"],[l,p]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[a,[c,"ASUS"],[l,u]],[/(nexus 9)/i],[a,[c,"HTC"],[l,p]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[c,[a,/_/g," "],[l,u]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[a,[c,"Acer"],[l,p]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[a,[c,"Meizu"],[l,u]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[a,[c,"Sharp"],[l,u]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[c,a,[l,u]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[c,a,[l,p]],[/(surface duo)/i],[a,[c,"Microsoft"],[l,p]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[a,[c,"Fairphone"],[l,u]],[/(u304aa)/i],[a,[c,"AT&T"],[l,u]],[/\bsie-(\w*)/i],[a,[c,"Siemens"],[l,u]],[/\b(rct\w+) b/i],[a,[c,"RCA"],[l,p]],[/\b(venue[\d ]{2,7}) b/i],[a,[c,"Dell"],[l,p]],[/\b(q(?:mv|ta)\w+) b/i],[a,[c,"Verizon"],[l,p]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[a,[c,"Barnes & Noble"],[l,p]],[/\b(tm\d{3}\w+) b/i],[a,[c,"NuVision"],[l,p]],[/\b(k88) b/i],[a,[c,"ZTE"],[l,p]],[/\b(nx\d{3}j) b/i],[a,[c,"ZTE"],[l,u]],[/\b(gen\d{3}) b.+49h/i],[a,[c,"Swiss"],[l,u]],[/\b(zur\d{3}) b/i],[a,[c,"Swiss"],[l,p]],[/\b((zeki)?tb.*\b) b/i],[a,[c,"Zeki"],[l,p]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[c,"Dragon Touch"],a,[l,p]],[/\b(ns-?\w{0,9}) b/i],[a,[c,"Insignia"],[l,p]],[/\b((nxa|next)-?\w{0,9}) b/i],[a,[c,"NextBook"],[l,p]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[c,"Voice"],a,[l,u]],[/\b(lvtel\-)?(v1[12]) b/i],[[c,"LvTel"],a,[l,u]],[/\b(ph-1) /i],[a,[c,"Essential"],[l,u]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[a,[c,"Envizen"],[l,p]],[/\b(trio[-\w\. ]+) b/i],[a,[c,"MachSpeed"],[l,p]],[/\btu_(1491) b/i],[a,[c,"Rotor"],[l,p]],[/(shield[\w ]+) b/i],[a,[c,"Nvidia"],[l,p]],[/(sprint) (\w+)/i],[c,a,[l,u]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[c,"Microsoft"],[l,u]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[c,"Zebra"],[l,p]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[c,"Zebra"],[l,u]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[c,a,[l,"console"]],[/droid.+; (shield) bui/i],[a,[c,"Nvidia"],[l,"console"]],[/(playstation [345portablevi]+)/i],[a,[c,"Sony"],[l,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[a,[c,"Microsoft"],[l,"console"]],[/smart-tv.+(samsung)/i],[c,[l,g]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[c,"Samsung"],[l,g]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[c,"LG"],[l,g]],[/(apple) ?tv/i],[c,[a,"Apple TV"],[l,g]],[/crkey/i],[[a,"Chromecast"],[c,"Google"],[l,g]],[/droid.+aft(\w)( bui|\))/i],[a,[c,"Amazon"],[l,g]],[/\(dtv[\);].+(aquos)/i],[a,[c,"Sharp"],[l,g]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[c,y],[a,y],[l,g]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,g]],[/((pebble))app/i],[c,a,[l,"wearable"]],[/droid.+; (glass) \d/i],[a,[c,"Google"],[l,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[a,[c,"Zebra"],[l,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[c,[l,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[a,[l,u]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[a,[l,p]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,p]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[l,u]],[/(android[-\w\. ]{0,9});.+buil/i],[a,[c,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[d,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[s,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,s]],os:[[/microsoft (windows) (vista|xp)/i],[s,d],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[s,[d,_,b]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,"Windows"],[d,_,b]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[s,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[s,"Mac OS"],[d,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[d,s],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[s,d],[/\(bb(10);/i],[d,[s,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[d,[s,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[d,[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[s,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[s,"Chromium OS"],d],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[s,d],[/(sunos) ?([\w\.\d]*)/i],[[s,"Solaris"],d],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[s,d]]},C=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof C))return new C(e,t).getResult();var n=e||(void 0!==o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),i=t?function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n}(w,t):w;return this.getBrowser=function(){var e,t={};return t[s]=void 0,t[d]=void 0,v.call(t,n,i.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return v.call(e,n,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return v.call(e,n,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return v.call(e,n,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return v.call(e,n,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n="string"==typeof e&&e.length>255?y(e,255):e,this},this.setUA(n),this};C.VERSION="0.7.28",C.BROWSER=h([s,d,"major"]),C.CPU=h(["architecture"]),C.DEVICE=h([a,c,l,"console",u,g,p,"wearable","embedded"]),C.ENGINE=C.OS=h([s,d]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=C),t.UAParser=C):n(381)?void 0===(i=function(){return C}.call(t,n,t,e))||(e.exports=i):void 0!==o&&(o.UAParser=C);var E=void 0!==o&&(o.jQuery||o.Zepto);if(E&&!E.ua){var S=new C;E.ua=S.getResult(),E.ua.get=function(){return S.getUA()},E.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var n in t)E.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){var i={"./glangulargradientshader":328,"./glangulargradientshader.js":328,"./glbendblurshader":286,"./glbendblurshader.js":286,"./glbendshader":428,"./glbendshader.js":428,"./glblendshader":317,"./glblendshader.js":317,"./glbloomshader":429,"./glbloomshader.js":429,"./glblurshader":187,"./glblurshader.js":187,"./glbrightnesscontrastshader":430,"./glbrightnesscontrastshader.js":430,"./glbulgepinchshader":431,"./glbulgepinchshader.js":431,"./glclipblurshader":329,"./glclipblurshader.js":329,"./glcoloradjustshader":432,"./glcoloradjustshader.js":432,"./glcolorhalftoneshader":433,"./glcolorhalftoneshader.js":433,"./gldenoiseshader":434,"./gldenoiseshader.js":434,"./gldotscreenshader":435,"./gldotscreenshader.js":435,"./gldrunkshader":436,"./gldrunkshader.js":436,"./gledgeworkshader":437,"./gledgeworkshader.js":437,"./glfisheyeshader":438,"./glfisheyeshader.js":438,"./glhexagonalshader":439,"./glhexagonalshader.js":439,"./glhuesaturationshader":440,"./glhuesaturationshader.js":440,"./glinkshader":441,"./glinkshader.js":441,"./glinnerglowshader":442,"./glinnerglowshader.js":442,"./gllensblurshader":443,"./gllensblurshader.js":443,"./glnoiseshader":444,"./glnoiseshader.js":444,"./glouterglowshader":445,"./glouterglowshader.js":445,"./glrecolourshader":446,"./glrecolourshader.js":446,"./glsepiashader":447,"./glsepiashader.js":447,"./glsketchshader":448,"./glsketchshader.js":448,"./glstrokelayershader":449,"./glstrokelayershader.js":449,"./glswirlshader":450,"./glswirlshader.js":450,"./gltiltshiftshader":451,"./gltiltshiftshader.js":451,"./gltoonshader":452,"./gltoonshader.js":452,"./gltrueblurshader":453,"./gltrueblurshader.js":453,"./glunsharpmaskshader":454,"./glunsharpmaskshader.js":454,"./glvibranceshader":455,"./glvibranceshader.js":455,"./glvignetteshader":456,"./glvignetteshader.js":456,"./glwarpshader":457,"./glwarpshader.js":457,"./glzoomblurshader":458,"./glzoomblurshader.js":458};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=727},,function(e,t,n){(function(e,i){var o=n(516),r=n(607).spawn,a=n(161);t.XMLHttpRequest=function(){"use strict";var t,s,l=this,c=n(517),d=n(518),u={},p=!1,g={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},h={},f={},m=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],y=["TRACE","TRACK","CONNECT"],v=!1,_=!1,b={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;this.open=function(e,t,n,i,o){if(this.abort(),_=!1,!function(e){return e&&-1===y.indexOf(e)}(e))throw new Error("SecurityError: Request method not allowed");u={method:e,url:t.toString(),async:"boolean"!=typeof n||n,user:i||null,password:o||null},w(this.OPENED)},this.setDisableHeaderCheck=function(e){p=e},this.setRequestHeader=function(e,t){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(function(e){return p||e&&-1===m.indexOf(e.toLowerCase())}(e)){if(v)throw new Error("INVALID_STATE_ERR: send flag is true");e=f[e.toLowerCase()]||e,f[e.toLowerCase()]=e,h[e]=h[e]?h[e]+", "+t:t}else console.warn('Refused to set unsafe header "'+e+'"')},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&s&&s.headers&&s.headers[e.toLowerCase()]&&!_?s.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||_)return"";var e="";for(var t in s.headers)"set-cookie"!==t&&"set-cookie2"!==t&&(e+=t+": "+s.headers[t]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&f[e.toLowerCase()]?h[f[e.toLowerCase()]]:""},this.send=function(n){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(v)throw new Error("INVALID_STATE_ERR: send has already been called");var p,m=!1,y=!1,b=o.parse(u.url);switch(b.protocol){case"https:":m=!0;case"http:":p=b.hostname;break;case"file:":y=!0;break;case void 0:case null:case"":p="localhost";break;default:throw new Error("Protocol not supported.")}if(y){if("GET"!==u.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(u.async)a.readFile(b.pathname,"utf8",(function(e,t){e?l.handleError(e):(l.status=200,l.responseText=t,w(l.DONE))}));else try{this.responseText=a.readFileSync(b.pathname,"utf8"),this.status=200,w(l.DONE)}catch(e){this.handleError(e)}}else{var C=b.port||(m?443:80),E=b.pathname+(b.search?b.search:"");for(var S in g)f[S.toLowerCase()]||(h[S]=g[S]);if(h.Host=p,m&&443===C||80===C||(h.Host+=":"+b.port),u.user){void 0===u.password&&(u.password="");var G=new e(u.user+":"+u.password);h.Authorization="Basic "+G.toString("base64")}"GET"===u.method||"HEAD"===u.method?n=null:n?(h["Content-Length"]=e.isBuffer(n)?n.length:e.byteLength(n),h["Content-Type"]||(h["Content-Type"]="text/plain;charset=UTF-8")):"POST"===u.method&&(h["Content-Length"]=0);var A={host:p,port:C,path:E,method:u.method,headers:h,agent:!1,withCredentials:l.withCredentials};if(_=!1,u.async){var T=m?d.request:c.request;v=!0,l.dispatchEvent("readystatechange");var P=function(e){l.handleError(e)};t=T(A,(function e(n){if(301!==(s=n).statusCode&&302!==s.statusCode&&303!==s.statusCode&&307!==s.statusCode)s.setEncoding("utf8"),w(l.HEADERS_RECEIVED),l.status=s.statusCode,s.on("data",(function(e){e&&(l.responseText+=e),v&&w(l.LOADING)})),s.on("end",(function(){v&&(w(l.DONE),v=!1)})),s.on("error",(function(e){l.handleError(e)}));else{u.url=s.headers.location;var i=o.parse(u.url);p=i.hostname;var r={hostname:i.hostname,port:i.port,path:i.path,method:303===s.statusCode?"GET":u.method,headers:h,withCredentials:l.withCredentials};(t=T(r,e).on("error",P)).end()}})).on("error",P),n&&t.write(n),t.end(),l.dispatchEvent("loadstart")}else{var L=".node-xmlhttprequest-content-"+i.pid,D=".node-xmlhttprequest-sync-"+i.pid;a.writeFileSync(D,"","utf8");for(var x="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(m?"s":"")+".request;var options = "+JSON.stringify(A)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+L+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+D+"');});response.on('error', function(error) {fs.writeFileSync('"+L+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+D+"');});}).on('error', function(error) {fs.writeFileSync('"+L+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+D+"');});"+(n?"req.write('"+JSON.stringify(n).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",I=r(i.argv[0],["-e",x]);a.existsSync(D););var O=JSON.parse(a.readFileSync(L,"utf8"));I.stdin.end(),a.unlinkSync(L),O.err?l.handleError(O.err):(s=O.data,l.status=O.data.statusCode,l.responseText=O.data.text,w(l.DONE))}}},this.handleError=function(e){this.status=0,this.statusText=e,this.responseText=e.stack,_=!0,w(this.DONE),this.dispatchEvent("error")},this.abort=function(){t&&(t.abort(),t=null),h=g,this.status=0,this.responseText="",this.responseXML="",_=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!v||this.readyState===this.DONE||(v=!1,w(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(e,t){e in b||(b[e]=[]),b[e].push(t)},this.removeEventListener=function(e,t){e in b&&(b[e]=b[e].filter((function(e){return e!==t})))},this.dispatchEvent=function(e){if("function"==typeof l["on"+e]&&l["on"+e](),e in b)for(var t=0,n=b[e].length;t<n;t++)b[e][t].call(l)};var w=function(e){e!=l.LOADING&&l.readyState===e||(l.readyState=e,(u.async||l.readyState<l.OPENED||l.readyState===l.DONE)&&l.dispatchEvent("readystatechange"),l.readyState!==l.DONE||_||(l.dispatchEvent("load"),l.dispatchEvent("loadend")))}}}).call(this,n(203).Buffer,n(165))},,,function(e,t,n){(function(e){!function(e){var t=function(){try{return!!Symbol.iterator}catch(e){return!1}}(),n=function(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t&&(n[Symbol.iterator]=function(){return n}),n},i=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},o=function(e){return decodeURIComponent(String(e).replace(/\+/g," "))};(function(){try{var t=e.URLSearchParams;return"a=1"===new t("?a=1").toString()&&"function"==typeof t.prototype.set&&"function"==typeof t.prototype.entries}catch(e){return!1}})()||function(){var o=function(e){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var t=typeof e;if("undefined"===t);else if("string"===t)""!==e&&this._fromString(e);else if(e instanceof o){var n=this;e.forEach((function(e,t){n.append(t,e)}))}else{if(null===e||"object"!==t)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(e))for(var i=0;i<e.length;i++){var r=e[i];if("[object Array]"!==Object.prototype.toString.call(r)&&2===r.length)throw new TypeError("Expected [string, any] as entry at index "+i+" of URLSearchParams's input");this.append(r[0],r[1])}else for(var a in e)e.hasOwnProperty(a)&&this.append(a,e[a])}},r=o.prototype;r.append=function(e,t){e in this._entries?this._entries[e].push(String(t)):this._entries[e]=[String(t)]},r.delete=function(e){delete this._entries[e]},r.get=function(e){return e in this._entries?this._entries[e][0]:null},r.getAll=function(e){return e in this._entries?this._entries[e].slice(0):[]},r.has=function(e){return e in this._entries},r.set=function(e,t){this._entries[e]=[String(t)]},r.forEach=function(e,t){var n;for(var i in this._entries)if(this._entries.hasOwnProperty(i)){n=this._entries[i];for(var o=0;o<n.length;o++)e.call(t,n[o],i,this)}},r.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),n(e)},r.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),n(e)},r.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),n(e)},t&&(r[Symbol.iterator]=r.entries),r.toString=function(){var e=[];return this.forEach((function(t,n){e.push(i(n)+"="+i(t))})),e.join("&")},e.URLSearchParams=o}();var r=e.URLSearchParams.prototype;"function"!=typeof r.sort&&(r.sort=function(){var e=this,t=[];this.forEach((function(n,i){t.push([i,n]),e._entries||e.delete(i)})),t.sort((function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0})),e._entries&&(e._entries={});for(var n=0;n<t.length;n++)this.append(t[n][0],t[n][1])}),"function"!=typeof r._fromString&&Object.defineProperty(r,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(e){if(this._entries)this._entries={};else{var t=[];this.forEach((function(e,n){t.push(n)}));for(var n=0;n<t.length;n++)this.delete(t[n])}var i,r=(e=e.replace(/^\?/,"")).split("&");for(n=0;n<r.length;n++)i=r[n].split("="),this.append(o(i[0]),i.length>1?o(i[1]):"")}})}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this),function(e){if(function(){try{var t=new e.URL("b","http://a");return t.pathname="c d","http://a/c%20d"===t.href&&t.searchParams}catch(e){return!1}}()||function(){var t=e.URL,n=function(t,n){"string"!=typeof t&&(t=String(t)),n&&"string"!=typeof n&&(n=String(n));var i,o=document;if(n&&(void 0===e.location||n!==e.location.href)){n=n.toLowerCase(),(i=(o=document.implementation.createHTMLDocument("")).createElement("base")).href=n,o.head.appendChild(i);try{if(0!==i.href.indexOf(n))throw new Error(i.href)}catch(e){throw new Error("URL unable to set base "+n+" due to "+e)}}var r=o.createElement("a");r.href=t,i&&(o.body.appendChild(r),r.href=r.href);var a=o.createElement("input");if(a.type="url",a.value=t,":"===r.protocol||!/:/.test(r.href)||!a.checkValidity()&&!n)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:r});var s=new e.URLSearchParams(this.search),l=!0,c=!0,d=this;["append","delete","set"].forEach((function(e){var t=s[e];s[e]=function(){t.apply(s,arguments),l&&(c=!1,d.search=s.toString(),c=!0)}})),Object.defineProperty(this,"searchParams",{value:s,enumerable:!0});var u=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==u&&(u=this.search,c&&(l=!1,this.searchParams._fromString(this.search),l=!0))}})},i=n.prototype;["hash","host","hostname","port","protocol"].forEach((function(e){!function(e){Object.defineProperty(i,e,{get:function(){return this._anchorElement[e]},set:function(t){this._anchorElement[e]=t},enumerable:!0})}(e)})),Object.defineProperty(i,"search",{get:function(){return this._anchorElement.search},set:function(e){this._anchorElement.search=e,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(i,{toString:{get:function(){var e=this;return function(){return e.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(e){this._anchorElement.href=e,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(e){this._anchorElement.pathname=e},enumerable:!0},origin:{get:function(){var e={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=e&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(e){},enumerable:!0},username:{get:function(){return""},set:function(e){},enumerable:!0}}),n.createObjectURL=function(e){return t.createObjectURL.apply(t,arguments)},n.revokeObjectURL=function(e){return t.revokeObjectURL.apply(t,arguments)},e.URL=n}(),void 0!==e.location&&!("origin"in e.location)){var t=function(){return e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")};try{Object.defineProperty(e.location,"origin",{get:t,enumerable:!0})}catch(n){setInterval((function(){e.location.origin=t()}),100)}}}(void 0!==e?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this)}).call(this,n(105))},,,,,,,,,,,,,function(e,t){String.prototype.codePointAt||function(){"use strict";var e=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}(),t=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,i=e?Number(e):0;if(i!=i&&(i=0),!(i<0||i>=n)){var o,r=t.charCodeAt(i);return r>=55296&&r<=56319&&n>i+1&&(o=t.charCodeAt(i+1))>=56320&&o<=57343?1024*(r-55296)+o-56320+65536:r}};e?e(String.prototype,"codePointAt",{value:t,configurable:!0,writable:!0}):String.prototype.codePointAt=t}()},,,,function(e,t,n){"use strict";n(28),n(83);var i=n(1);function o(e,t,n,o){this._dialog=$("<div></div>"),this._replacedFonts={},this.opened=!1,this._document=e,this._callbacks=[],this._keepFontsButton=$("<button>"+i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","action.keep-fonts"))+"</button>").on("click",()=>this._keepFonts()),this._hasFakeTextNodes()||(this._keepFontsButton.addClass("g-disabled"),this._keepFontsButton.attr("disabled",!0)),o&&this._callbacks.push(o),$("<div></div>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","text.fonts-missing"))).appendTo(this._dialog),$("<div></div>").addClass("subtitle").text(i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","text.fonts-not-found"))).appendTo(this._dialog),this._fontsContainer=$("<div></div>").addClass("fonts-container").appendTo(this._dialog),this.setMissingFonts(t);var r=[];r.push(this._keepFontsButton),e&&r.unshift($("<button>"+i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","action.replace-fonts"))+"</button>").on("click",this._replaceFonts.bind(this))),this.setProviderEnablers(n),this._dialog.gDialog({releaseOnClose:!0,className:"g-missingfonts-dialog",buttons:r})}i.GObject.inherit(o,i.GObject),o.prototype.getMissingFonts=function(){var e=[];return this._fontsContainer.find(".postscriptname").each((t,n)=>e.push($(n).data("font"))),e},o.prototype.setProviderEnablers=function(e){if(e&&e.length>0){$("<div></div>").addClass("subtitle").text(i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","text.turn-disabled-function"))+":").css({marginTop:"5px"}).appendTo(this._dialog);for(var t=0;t<e.length;t++)$(e[t]).appendTo(this._dialog)}},o.prototype.setMissingFonts=function(e){if(e){var t=Object.keys(this._replacedFonts);if(Array.isArray(e)){var n=gDesigner.getWorkspace().getFontManager().getDefaultFont();this._keepFontsButton.show(),e.forEach(e=>{this._replacedFonts[e]=n.getFamily()})}else this._keepFontsButton.hide(),Object.keys(e).forEach(t=>{this._replacedFonts[t]=e[t]});var i=this;Object.keys(this._replacedFonts).forEach(e=>{if(!(t.indexOf(e)>=0)){var o=$("<div></div>").addClass("font-row").appendTo(this._fontsContainer);$("<div></div>").addClass("postscriptname").data("font",e).text(e).appendTo(o),$("<input/>").addClass("g-select").data("font",e).attr("type","button").gFontsButton({assignFontCallback:function(e,t){i._replacedFonts[t.data("font")]=e}}).val(i._replacedFonts[e]||n.getFamily()).appendTo(o)}})}else this._keepFontsButton.hide()},o.prototype.open=function(e){var t=e||i.GLocale.get(new i.GLocaleKey("GMissingFontsDialog","action.keep-fonts"));this._keepFontsButton.text(t),this.opened=!0,this._dialog.gDialog("open",!1)},o.prototype.close=function(e){this.opened=!1,this._callbacks.forEach(t=>{t(e?this._replacedFonts:null)}),this._dialog.gDialog("close")},o.prototype._keepFonts=function(){gDesigner.stats("missingfonts_keep_fonts");var e=this._document.getScene();if(e){var t=e.getProperty("cst")||[];Object.keys(this._replacedFonts).forEach(e=>{!t.indexOf(e)>=0&&t.push(e)}),e.setProperty("cst",t),this.close()}else this.close()},o.prototype._hasFakeTextNodes=function(){var e=!1;const t=this._document&&this._document.getScene();return t&&t.acceptChildren(t=>{if(t instanceof i.GText&&(t.isFakeText()||t.hasEmbeddedFonts()))return e=!0,!1}),e},o.prototype._replaceFonts=function(){gDesigner.stats("missingfonts_replace_fonts"),this._document.getScene().acceptChildren(e=>{if(e instanceof i.GText)if(e.isFakeText()||!e.$fontFamilies)e.replaceFonts(this._replacedFonts,e.hasEmbeddedFonts());else{var t=gDesigner.getWorkspace().getFontManager().getDefaultFont(),n=Object.keys(this._replacedFonts),o=e.getContent();o&&(o.forEach((i,o)=>{var r=e.$fontFamilies&&e.$fontFamilies[o]||i.fontFamily;-1!==n.indexOf(r)&&(i.fontFamily=this._replacedFonts[r]||t.getFamily())}),e._runsDirty=!0,e.$content=JSON.stringify(o),e.setText(o),e.repaint())}else if(e instanceof i.GStyle){var r=e.getProperty("_tff");this._replacedFonts instanceof i.GFont?e.setProperties(["_tff","_tfs","_tfw"],[this._replacedFonts.getFamily(),this._replacedFonts.getStyle(),this._replacedFonts.getWeight()]):r&&this._replacedFonts[r]&&e.setProperty("_tff",this._replacedFonts[r])}}),this.close(!0)},e.exports=o},function(e,t,n){"use strict";var i=n(47),o=n(236).start,r=n(414)("trimStart"),a=r?function(){return o(this)}:"".trimStart;i({target:"String",proto:!0,name:"trimStart",forced:r},{trimStart:a,trimLeft:a})},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="file.open-recent",a.TITLE=new i.GLocaleKey("GOpenRecentAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_FILE_OPEN_RECENT},a.prototype.getGroup=function(){return"file-open/open-recent"},a.prototype.isEnabled=function(e){return!1},a.prototype.execute=function(){},a.prototype.toString=function(){return"[Object GOpenRecentAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(43),o={"gravit-cloud":"gravit-icon-cloud","modify.merge":"gravit-icon-merge-union","view.play":"gravit-icon-presentation","edit.paste.in-place":"gravit-icon-paste-in-place","file.install-to-desktop":"gravit-icon-install"};o["arrange.align."+i.GEditor.ArrangeAlignType.AlignLeft]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="53 2 20 20" width="20" height="20"><rect id="align-area" x="62" y="9" width="4" height="12" transform="rotate(-90 64 15)" fill="#FFF"/><rect id="align-area" x="60" y="5" width="4" height="8" transform="rotate(-90 62 9)" fill="#FFF"/><rect id="align-shape" x="54" y="3" width="2" height="18" transform="rotate(-180 55 12)" fill="#3A98FF"/></svg>',o["arrange.align."+i.GEditor.ArrangeAlignType.AlignCenter]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="77 2 20 20" width="20" height="20"><rect id="align-shape" x="86" y="3" width="2" height="18" transform="rotate(180 87 12)" fill="#3A98FF"/><rect id="align-area" x="85" y="3" width="4" height="12" transform="rotate(90 87 9)" fill="#FFF"/><rect id="align-area" x="85" y="11" width="4" height="8" transform="rotate(90 87 15)" fill="#FFF"/></svg>',o["arrange.align."+i.GEditor.ArrangeAlignType.AlignRight]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="103 2 20 20" width="20" height="20"><rect id="align-area" x="110" y="9" width="4" height="12" transform="rotate(90 112 15)" fill="#FFF"/><rect id="align-area" x="112" y="5" width="4" height="8" transform="rotate(90 114 9)" fill="#FFF"/><rect id="align-shape" x="120" y="3" width="2" height="18" transform="rotate(180 121 12)" fill="#3A98FF"/></svg>',o["arrange.align."+i.GEditor.ArrangeAlignType.AlignTop]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="128 2 20 20" width="20" height="20"><rect id="align-area" x="133" y="7" width="4" height="12" fill="#FFF"/><rect id="align-area" x="139" y="7" width="4" height="8" fill="#FFF"/><rect id="align-shape" x="137" y="-5" width="2" height="18" transform="rotate(-90 138 4)" fill="#3A98FF"/></svg>',o["arrange.align."+i.GEditor.ArrangeAlignType.AlignMiddle]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="156 1.9999999999999982 20 20" width="20" height="20"><rect id="align-shape" x="165" y="3" width="2" height="18" transform="rotate(90 166 12)" fill="#3A98FF"/><rect id="align-area" x="161" y="6" width="4" height="12" transform="rotate(-180 163 12)" fill="#FFF"/><rect id="align-area" x="167" y="8" width="4" height="8" transform="rotate(-180 169 12)" fill="#FFF"/></svg>',o["arrange.align."+i.GEditor.ArrangeAlignType.AlignBottom]='<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="181 2 20 20" width="20" height="20"><rect id="align-area" x="186" y="5" width="4" height="12" transform="rotate(180 188 11)" fill="#FFF"/><rect id="align-area" x="192" y="9" width="4" height="8" transform="rotate(180 194 13)" fill="#FFF"/><rect id="align-shape" x="190" y="11" width="2" height="18" transform="rotate(-90 191 20)" fill="#3A98FF"/></svg>',o["arrange.order."+i.GEditor.ArrangeOrderType.BringForward]="gravit-icon-bring-front",o["arrange.order."+i.GEditor.ArrangeOrderType.SendBackward]="gravit-icon-bring-back",o["arrange.order."+i.GEditor.ArrangeOrderType.SendToFront]="gravit-icon-send-to-front",o["arrange.order."+i.GEditor.ArrangeOrderType.SendToBack]="gravit-icon-send-to-back",e.exports=o},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.updateFileFn=t.syncImagesToCloud=t.listFilesFn=t.fetchRequest=t.default=t.createFileAndGetSignedPutUrlsFn=void 0,n(9),n(14),n(129),n(63),n(19),n(158),n(201),n(166),n(167),n(25),n(83),n(24),n(90),n(3);var o=i(n(206));const r=n(388),a=async function(e,t,n,i,a,s,l,c,d){try{var u=new o.default;const S=i.length;for(var p=0;p<S;++p){var g=i[p];if(g.cloud){u.addEntry(new o.default.Entry(g.cloud,g.uuid,g.references));continue}var h=/^data:.{0,255};base64,/i.exec(g.value);if(!h)continue;var f=r(g.value);let l=await e({md5:f}),G=l?l[0]:null;if(G)u.addEntry(new o.default.Entry(o.default.CLOUD_PROTOCOL+"://id="+G.id,g.uuid,g.references));else if(g.references>0){for(var m=t,y=0;y<n.length;++y){var v=n[y],_=o.default.PROTOCOL+"://"+g.uuid;if((v.url+"").startsWith(o.default.PROTOCOL)&&v.url===_){v.name&&(m=v.name);break}}var b=g.value,w=h[1]||"application/octet-stream";let e;function C(e,t,n){var i,o=e.split(",");try{i=atob(o[1])}catch(e){i=""}for(var r=i.length,a=new Uint8Array(r);r--;)a[r]=i.charCodeAt(r);return new File([a],t,{type:n})}({urls:e,file:G}=await a(m,w));var E=C(b,c+"-"+G.id+".txt",w);let i={method:"PUT",headers:{"Cache-Control":"public, max-age=31536000"},body:E};w&&(i.headers=Object.assign(i.headers,{"Content-Type":w}));if(!(await fetch(e.url,i)).ok)throw new Error("failed to upload");await s(E,G.id,f),u.addEntry(new o.default.Entry(o.default.CLOUD_PROTOCOL+"://id="+G.id,g.uuid,g.references)),d&&d(p/S)}}return l&&l(u)}catch(e){return Promise.reject(e)}};t.syncImagesToCloud=a;const s=(e,t,n)=>{var i=n&&n.method||"GET",o=n&&n.body&&JSON.stringify(n.body),r=Object.assign({"Content-Type":"application/json",Accept:"json",Authorization:t||""},n&&n.headers);if(n&&n.query){var a=n.query,s=new URLSearchParams;for(var l in a)s.append(l,a[l]);e=e+"/?"+s.toString()}var c={credentials:"include",headers:r,method:i};return o&&"GET"!==i&&(c.body=o),fetch(e,c).then(e=>e.json())};t.fetchRequest=s;t.listFilesFn=(e,t,n)=>s("".concat(n,"/file"),t,{query:e});t.createFileAndGetSignedPutUrlsFn=async function(e,t,n,i){var o={method:"POST",body:{name:e,type:t,trashed:null}};const r=await s("".concat(n,"/file"),i,o);var a={method:"PUT",body:{id:r.id,type:t}};return{urls:await s("".concat(n,"/file/").concat(r.id,"/urls"),i,a),file:r}};t.updateFileFn=async function(e,t,n,i,o,r,a){const l=r&&a?await a(e):null;return await s("".concat(i,"/file/").concat(t),o,{method:"PUT",body:{md5:n,trashed:!1,sha256:l}})};var l={syncImagesToCloud:a};t.default=l},function(e,t,n){"use strict";n(25);var i=n(198);const{License:o,LicenseType:r,DateAPI:a}=n(12),{defaultUserSettings:{license:{offlineCountdown:s,offlineExpirationTime:l}}}=n(12).defaultUserSettings,c=n(698),d=n(994);e.exports=class{static newLicense(e){return c.updateLicense(e),this._newLicense(e)}static newDefaultLicense(){return this._newLicense({license:r.Default})}static newOfflineLicense(){const e=c.getLicense();if(e){const t=a.addTime(a.addTime(new Date(e.lastUpdate),e.offlineExpirationTime||l),e.offlineCountdown||s);return this._newLicense(Object.assign(e,{offline:!0,offlineExpire:t}))}return this._newLicense({license:r.Default,offline:!0})}static _newLicense(e){return this._isDevLicense()?new d(e):new o(e)}static _isDevLicense(){if(i.IS_TRUNK)return!0;if(i.IS_RC){const e=gDesigner.getSyncUser();return!!e&&!e.isDeactivated()&&e.isEmailVerified()&&e.isGravitAccount()}return!1}}},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.cdrFormatVersionToReleaseYear=function(e){return parseFloat(e)+2e3-2},t.prepareCDRforSaving=t.default=void 0,t.releaseYearToCdrFormatVersion=function(e){return e&&e>=2020?e-2e3+2:0},n(9),n(168);var o=n(1),r=i(n(200)),a=i(n(77));const s=n(996),l=async function(e,t,n,i,l){if(!gDesigner.getCDRIntegrationEngine())return t(),!1;const c=await gDesigner.getUser();n.userName=c?c.getFullUserName():o.GLocale.get(new o.GLocaleKey("GDocument","text.default-export-author"));const d=n=>{if(n.status!==a.default.Saving&&e.removeEventListener(r.default,d),n.status===a.default.SaveFailed){let e="unexpected";try{if(n.data&&n.data instanceof s&&n.data.errCode==s.Type.TooBigFileSize){e="expected.too-big-file-size";let n=new Error(this.getTitle()+": "+o.GLocale.get(new o.GLocaleKey("GCommonNames","text.file-too-large-cannot-be-processed")));n.code=507,t(n)}}finally{gDesigner.stats("filespanel_export_cdr-failed",e)}}else n.status===a.default.Saved&&gDesigner.stats("filespanel_export_cdr-ok")};return e.addEventListener(r.default,d),gDesigner.getCDRIntegrationEngine().saveCDRDocument(e,n,async e=>{l(e)},t,i)};t.prepareCDRforSaving=l;var c={prepareCDRforSaving:l};t.default=c},function(e,t,n){"use strict";var i=n(17);n(9),n(19),n(24),n(111),n(90),n(25),n(3),n(83),n(14),n(29);var o=n(1),r=n(32),a=n(534),s=i(n(699)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var a=o?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=e[r]}i.default=e,n&&n.set(e,i);return i}(n(701)),c=i(n(535));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}const u=n(997),p=n(536),{HTTP_STATUS_CODES:g}=n(12);function h(e){this.setTokenIssuer(e)}h.TRIAL_UNTIL_FAIL=3,h.isUsageLimitError=function(e){return!(!e||!e.error)&&(403===Number(e.error.code)&&e.error.errors.some(e=>"usageLimits"===e.domain))},h.ExceptionCode={LoginAborted:1};class f extends c.default{constructor(e,t){super(e),this.code=t,this.__proto__=f.prototype,this.name="GoogleDriveException"}toString(){return"[Object GoogleDriveException]"}}h.GoogleDriveException=f,h.prototype.setTokenIssuer=function(e){this._tokenIssuer=e},h.prototype.getTokenIssuerSettings=function(){return this._tokenIssuer?this._tokenIssuer.getSettings():null},h.prototype.getSettings=function(){return this.getTokenIssuerSettings()},h.prototype.getAccessToken=async function(){return this._tokenIssuer&&(this._accessToken=await this._tokenIssuer.get()),this._accessToken},h.prototype.upload=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.DefaultUploadType,o=arguments.length>4?arguments[4]:void 0;switch(i){case h.UploadType.Simple:return this._simpleUpload(e,t,n);case h.UploadType.Resumable:return this._resumableUpload(e,t,n,o)}},h.prototype.isCorporate=function(){if(!this.getTokenIssuerSettings())throw"No Token Issuer for Google";return this.getTokenIssuerSettings().corporate},h.prototype.getCorporateProviderName=function(){return"google"},h.prototype.getFilePermissions=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.getTokenIssuerSettings()||!this.getTokenIssuerSettings().corporate)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));if(!e)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.no-file-found")));let n=[];const i=await this.getAccessToken(),r={fields:"*",supportsAllDrives:!0,pageSize:50};return new Promise((o,a)=>{!function l(c){const d=new URL("https://www.googleapis.com/drive/v3/files/".concat(e,"/permissions")),u=Object.assign({},r);c&&(u.pageToken=c);for(var p in u)d.searchParams.append(p,u[p]);return fetch(d.toString(),{method:"GET",headers:new Headers({Authorization:"Bearer ".concat(i)})}).then(e=>e.json()).then(e=>{const{permissions:i,nextPageToken:r}=e;i.length&&(n=n.concat(i)),r?setTimeout((function(){l(r)})):o(t?n:n.map(e=>{let{emailAddress:t,role:n}=e;return{email:t,role:s.default[n],externalRole:n}}))}).catch(e=>a(e))}()})},h.prototype.createOrUpdateUserShare=async function(e,t){if(!e)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.no-file-found")));if(!this.getTokenIssuerSettings()||!this.getTokenIssuerSettings().corporate)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));const{role:n,emailAddress:i}=t;if(!n||!i)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.not-enough-parameters")));const r=await this.getShareIdForEmail(e,i).catch(()=>[]),a={type:"user",emailAddress:i,role:l.default[n.id]};if(r&&r.length>0){const t=await this.removeShare(e,r[0]);if(t.error){const{error:{errors:[{message:e}]}}=t;return Promise.reject(e)}if(a.role===l.NoAccessId)return t}return this._createShare(e,a).then(e=>{if(e.error){const{error:{errors:[{message:t}]}}=e;return Promise.reject(t)}return e})},h.prototype.createDomainShare=function(e,t){if(!e)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.no-file-found")));if(!this.getTokenIssuerSettings()||!this.getTokenIssuerSettings().corporate)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));const{role:n,domain:i}=t;if(!n||!i)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.not-enough-parameters")));const r={type:"domain",domain:i,role:l.default[n.id],allowFileDiscovery:!0};return this._createShare(e,r)},h.prototype._createShare=async function(e,t){if(!this.getTokenIssuerSettings()||!this.getTokenIssuerSettings().corporate)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));const n=new URL("https://www.googleapis.com/drive/v3/files/".concat(e,"/permissions")),i=await this.getAccessToken(),r={fields:"*",supportsAllDrives:!0,sendNotificationEmail:!1};for(var a in r)n.searchParams.append(a,r[a]);return fetch(n.toString(),{method:"POST",headers:new Headers({Authorization:"Bearer ".concat(i),"Content-Type":"application/json"}),body:JSON.stringify(t)}).then(e=>e.json())},h.prototype.getShareIdForEmail=async function(e,t){return this.getTokenIssuerSettings()&&this.getTokenIssuerSettings().corporate?(await this.getFilePermissions(e,!0)).filter(e=>{let{emailAddress:n}=e;return n===t}):Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")))},h.prototype.removeShare=async function(e,t){let{id:n}=t;if(!this.getTokenIssuerSettings()||!this.getTokenIssuerSettings().corporate)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","error.only-for-corporate")));const i=new URL("https://www.googleapis.com/drive/v3/files/".concat(e,"/permissions/").concat(n)),r=await this.getAccessToken(),a={fields:"*",supportsAllDrives:!0};for(var s in a)i.searchParams.append(s,a[s]);return fetch(i.toString(),{method:"DELETE",headers:new Headers({Authorization:"Bearer ".concat(r)})}).then(e=>204!==e.status?e.json():e)},h.prototype._simpleUpload=async function(e,t,n){const i=await this.getAccessToken();return new Promise((o,r)=>{var a=new FormData;a.append("metadata",new Blob([JSON.stringify(n)],{type:"application/json"})),a.append("file",t);var s=new URL("https://www.googleapis.com/upload/drive/v3/files/".concat(e||"")),l={uploadType:"multipart",fields:"*"};for(var c in n.hasOwnProperty("driveId")&&(l.supportsAllDrives=!0),l)s.searchParams.append(c,l[c]);fetch(s.toString(),{method:e?"PATCH":"POST",headers:new Headers({Authorization:"Bearer ".concat(i)}),body:a}).then(e=>e.json()).then(e=>{console.log(e),o(e)}).catch(e=>{console.error(e),r(e)})})},h.prototype._resumableUpload=async function(e,t,n,i){const o=await this.getAccessToken();return new Promise((r,a)=>{var s=n.mimeType||"application/octet-stream";const l={fields:"*"};n.hasOwnProperty("driveId")&&(l.supportsAllDrives=!0),new u({file:t,fileId:e,token:o,contentType:s,metadata:n,params:l,onComplete:function(e){var t;try{t="string"==typeof e?JSON.parse(e):e}catch(n){t=e}r(t)},onError:function(e){a(e)},onProgress:function(e){i&&i(e.loaded/e.total)}}).upload()})},h.prototype._request=async function(e,t,n,i){i="number"==typeof i?i:0;const o=await this.getAccessToken(),a={Authorization:"Bearer ".concat(o)},s=t.headers?Object.assign(a,t.headers):a;return delete t.headers,fetch(e,Object.assign({headers:new Headers(s),signal:n},t)).then(async o=>{if(!o.ok&&403===o.status){var a=await o.json();return h.isUsageLimitError(a)&&i<h.TRIAL_UNTIL_FAIL?(await(0,r.sleep)(1e3*Math.pow(1+i,2)),this._request(e,t,n,++i)):Promise.reject(a)}return o})},h.prototype._requestWithProgress=async function(e,t,n,i,o){o="number"==typeof o?o:0;const s=await this.getAccessToken(),l={Authorization:"Bearer ".concat(s)},c=t.headers?Object.assign(l,t.headers):l;delete t.headers;const d=await fetch(e,Object.assign({headers:new Headers(c),signal:n},t));if(!d.ok&&403===d.status){var u=await d.json();return h.isUsageLimitError(u)&&o<h.TRIAL_UNTIL_FAIL?(await(0,r.sleep)(1e3*Math.pow(1+o,2)),this._requestWithProgress(e,t,n,i,++o)):Promise.reject(u)}return(0,a.readResponseWithProgress)(d,i,!0)},h.prototype.getFile=function(e,t,n,i){var o=new URL("https://www.googleapis.com/drive/v3/files/".concat(e,"?alt=media"));for(var r in t)o.searchParams.append(r,t[r]);return this._requestWithProgress(o.toString(),{method:"GET"},n,i).then(e=>e.blob())},h.prototype.getFileDetails=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n=new URL("https://www.googleapis.com/drive/v3/files/".concat(e,"?fields=*"));for(var i in t)n.searchParams.append(i,t[i]);return this._request(n.toString(),{method:"GET"}).then(e=>e.ok?e.json():e.json().then(e=>Promise.reject(e)))},h.prototype.fileExists=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.getFileDetails(e,t).then(()=>!0).catch(e=>{if(e.error){if(e.error.code===g.NOT_FOUND)return!1;const t=new Error(e.error.message);throw t.code=e.error.code,t}throw new Error})},h.prototype.updateFileDetails=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(Object.keys(t).length<1)return Promise.resolve();var i=new URL("https://www.googleapis.com/drive/v3/files/".concat(e));for(var o in n)i.searchParams.append(o,n[o]);return this._request(i.toString(),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},h.prototype.searchFiles=function(e){var t=new URL("https://www.googleapis.com/drive/v3/files");for(var n in e)t.searchParams.append(n,e[n]);return this._request(t.toString(),{method:"GET"}).then(e=>e.json())},h.prototype.searchTeamDrives=function(e){var t=new URL("https://www.googleapis.com/drive/v3/drives");for(var n in e)t.searchParams.append(n,e[n]);return this._request(t.toString(),{method:"GET"}).then(e=>e.json())},h.prototype.getAccountByEmail=function(e){if(!e||e.indexOf("@")<=0)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GShareDialog","text.invalid-email")).replace("%email",e));var t=new URL("https://www.googleapis.com/admin/directory/v1/users/".concat(e,"?viewType=domain_public"));return this._request(t.toString(),{method:"GET"}).then(e=>e.json())},h.prototype.supportsEmailDomainCheck=async function(){const e=await this.getTokenInfo().catch(()=>null);if(!e)return!1;const{scope:t}=e;return Array.isArray(t)?t.some(e=>n(e)):n(t);function n(e){return e.indexOf("admin.directory.user")>=0}},h.prototype.getTokenInfo=async function(){var e=new URL("https://www.googleapis.com/oauth2/v1/tokeninfo?access_token=".concat(await this.getAccessToken()));return this._request(e.toString(),{method:"GET"}).then(e=>e.json())},h.MimeType={Folder:"application/vnd.google-apps.folder"},h.Kind={TeamDrive:"drive#teamDrive",Drive:"drive#drive"},h.UploadType={Simple:"simple",Resumable:"resumeable"},h.DefaultUploadType=h.UploadType.Resumable,h.CloudToGoogleRoleMap=l.default,h.GoogleToCloudRoleMap=s.default,h.SearchEngine={Sorts:{Ascending:"",Descending:"desc"},OrderBy:{CreatedTime:"createdTime",ModifiedTime:"modifiedTime",Name:"name",ViewedByMeTime:"viewedByMeTime"}},h.build=function(e){if(!e){if(!gContainer.getGoogleAPI().isLoaded())throw Error("Google Drive Client not loaded!");e=gContainer.getGoogleAPI().getTokenConfiguration({corporate:!1,accountId:this._accountId})}return new h(new p(e))},e.exports=h},,,function(e,t,n){"use strict";var i=n(49),o=n(250),r=n(52),a=n(95),s=n(1265),l=n(57),c=n(145),d=n(251);o("search",(function(e,t,n){return[function(t){var n=a(this),o=null==t?void 0:c(t,e);return o?i(o,t,n):new RegExp(t)[e](l(n))},function(e){var i=r(this),o=l(e),a=n(t,i,o);if(a.done)return a.value;var c=i.lastIndex;s(c,0)||(i.lastIndex=0);var u=d(i,o);return s(i.lastIndex,c)||(i.lastIndex=c),null===u?-1:u.index}]}))},,,,,,function(e,t,n){"use strict";n(14),n(63),n(3),n(168);var i=n(1);function o(){}o.prototype.OPACITY_DEFAULT={min:0,max:100,custom:!0,cssClass:"opacity"};var r=function(e,t){var n=$(e).data("options").min;return(t-n)/($(e).data("options").max-n)*100},a=function(e,t){$(e).trigger(t)},s=function(e,t,n){var i=function(e,t,n){var i=$(e).data("options").min,o=$(e).data("options").max,r=$(e).find(".g-input-slider-track"),a=$(e).find(".g-input-slider-thumb"),s=r.width();t||(t=a.offset().left-r.offset().left);var l=100*t/s;l<0?l=0:l>100&&(l=100),n&&a.css("left",l+"%");var c=l*(o-i)/100+i;return c>o?c=o:c<i&&(c=i),c}(e,t,n);$(e).attr("value",i),l(e,r(e,i)),a(e,"input")},l=function(e,t){$(e).data("options").generic&&($(e).find(".g-input-slider-track .g-input-slider-background").remove(),$(e).find(".g-input-slider-track").append($("<div/>").addClass("g-input-slider-background").css({width:t+"%"})))};var c={init:function(e,t){return this.each((function(){t||(t=this);var n,i=e.min,o=e.max;e.generic=!e.background&&!e.custom,!e.maxDecimal&&e.step&&(e.maxDecimal=(n=e.step,Math.floor(n)===n?0:n.toString().split(".")[1].length||0));var l=50;l<i?l=i:l>o&&(l=o);var c=e.generic?10:8;$(t).addClass("g-input-slider").addClass(e.generic?"generic":"custom").addClass(e.cssClass?e.cssClass:"").attr("value",l).attr("min",i).attr("max",o).data("options",e),e.generic||$(t).css("background",e.background);var d=$("<div></div>").addClass("g-input-slider-track").addClass(e.generic?"generic":"custom"),u=$("<div></div>").addClass("g-input-slider-thumb").addClass(e.generic?"generic":"custom");e.richTooltipConfig&&u.gRichTooltip(e.richTooltipConfig),d.append(u);var p=!1,g=function(e){if("disabled"!==$(t).attr("disabled")){var n=e.clientX,i=$(t).offset().left;s(t,n=n-i-c/2,!0)}};$(d).on("mousedown",(function(e){1==e.which&&(p=!0,$(u).addClass("active"),e.isTrusted&&g(e))})),$(t).on("mousedown",(function(e){1==e.which&&(p=!0,$(u).addClass("active"),e.isTrusted&&g(e))}));let h=!1;$(u).on("mousedown",()=>{h=!0});let f=!1;$(t).on("touchstart",()=>{f=!1}),$(t).on("touchmove",()=>{f=!0}),$(window).on("mousemove",(function(e){p&&(e.isTrusted||h)&&(g(e),e.preventDefault())})).mouseup((function(e){h=!1,p&&(f||(e=>!e.originalEvent.cancelable)(e)||g(e),p=!1,"disabled"!==$(t).attr("disabled")&&function(e){$(e).find(".g-input-slider-thumb").css("left",r(e,$(e).attr("value"))+"%"),a(e,"change")}(t),$(u).removeClass("active"))})),$(t).append(d)}))},value:function(e){var t=$(this);if(t.data("options")){var n=t.data("options").min,o=t.data("options").max,a=t.data("options").maxDecimal?t.data("options").maxDecimal:0;if(void 0===e)return isNaN(t.attr("value"))?parseFloat(t.attr("value")):i.GUtil.formatNumber(t.attr("value"),a);isNaN(e)||(e=i.GUtil.formatNumber(e,a)),e>o?e=o:e<n&&(e=n);var s=r(this,e);t.find(".g-input-slider-thumb").css("left",s+"%"),l(this,s),t.attr("value",e)}return this},minValue:function(){return $(this).data("options").min},maxValue:function(){return $(this).data("options").max},disabled:function(){return arguments.length?$(this).attr("disabled",arguments[0]):$(this).attr("disabled")}};e.exports=o,$.fn.gInputSlider=function(e){return c[e]?c[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GFilesPanelSortTypes=t.GFilesPanelSortDirections=t.GFilesPanelFileTypesFilter=t.GFilesPanelClipboardModes=void 0;const i=[{id:"gvdesign",name:new(n(39))("GFilesPanel","text.filter-type-gvdesign"),type:"application/gravit+design"}];t.GFilesPanelFileTypesFilter=i;const o={UPDATED:"updated",NAME:"name",CREATED:"created"};t.GFilesPanelSortTypes=o;const r={ASCEND:!0,DESCEND:!1};t.GFilesPanelSortDirections=r;const a={DEFAULT:1,COPY:2,CUT:3};t.GFilesPanelClipboardModes=a;var s={GFilesPanelSortTypes:o,GFilesPanelSortDirections:r,GFilesPanelClipboardModes:a};t.default=s},function(e,t,n){"use strict";const i=n(1129),o=n(76),{Runtime:r,msTeamsMode:a}=n(12),{storeVendor:s}=n(716),l="darwin",c="win32",d="linux";class u{static getRuntimeCode(){const e=u.getRuntime();return e&&e.code}static getRuntime(){let e;if(a)e=r.TeamsApp;else if(gContainer.getRuntime()===o.Runtime.PWA)e=r.PWA,s===i.GooglePlay&&(e=r.PWAPlayStore);else if(gContainer.getRuntime()===o.Runtime.Browser)e=r.Browser;else if(gContainer.getRuntime()===o.Runtime.Electron){var t=gContainer.getPlatform();e=t===l?r.Mac:t===c?r.Windows:t===d?r.Linux:t,s&&(s===i.Apple?e=r.AppleStore:s===i.Windows&&(e=r.WindowsStore))}else gContainer.getRuntime()===o.Runtime.Chrome?(e=r.ChromeApp,s===i.ChromeWeb&&(e=r.ChromeWebStore)):gContainer.getRuntime()===o.Runtime.IPad&&(e=r.iPadOS);return e}}e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.downloadActiveFile=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!window.gDesigner)return!1;const n=window.gDesigner.getActiveDocument();if(!n)return!1;if(!window.gContainer)return!1;const i=window.gContainer.getStorage();if(!i)return!1;e=e||n.getExtension();const o="".concat(n.getTitle()||"Design",".").concat(e);return i.download(o,e=>{n.store(e,console.log,console.error,t)}),!0},t.downloadDataURI=function e(t,n,i,o){if(t instanceof Blob){var r=new FileReader;r.onloadend=()=>{a(r.result)},r.readAsArrayBuffer(t)}else"string"==typeof t?e(new Blob([t],o),n,i,o):a(t);function a(e){gContainer.download({buffer:e,name:n,extension:i,mime:o})}},n(14),n(29),n(63),n(19),n(158),n(201),n(166),n(167);var i=n(1),o=n(1095),r=/["\*\/:<>\?\\\|]/g,a=/[\0-\x1F\x80-\x9F]/g,s=/^\.+$/,l=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\.(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,c=/[ \.]+$/;i.GUtil.sanitizeFilename=function(e,t){return t=t||"_",e.replace(r,t).replace(a,t).replace(s,t).replace(l,t).replace(c,t).substr(0,255)},i.GUtil.dataUrlToBlob=function(e){if(!/^data:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){0,255};ba[s\u017F]e64,/i.exec(e)){const t=e.split(","),n=t[0].split(":")[1],i=t[1];return new Blob([i],{type:n})}var t,n=e.split(";base64,"),i=n[0].split(":")[1];try{t=window.atob(n[1])}catch(e){t=""}for(var o=t.length,r=new Uint8Array(o),a=0;a<o;++a)r[a]=t.charCodeAt(a);return new Blob([r],{type:i})},i.GUtil.readACVFile=function(e){var t=new o(e),n={rgb:[],r:[],g:[],b:[]};t.seek(4);var i=t.getUint16(),r=["r","g","b"],a=null,s=null,l=null,c=null,d=null;for(n.rgb.push([0,t.getUint16()]),t.seek(t.tell()+2),c=1;c<i;c++)l=t.getUint16(),s=t.getUint16(),n.rgb.push([s,l]);for(c=0;c<3;c++)for(i=t.getUint16(),a=n[r[c]],d=0;d<i;d++)l=t.getUint16(),s=t.getUint16(),a.push([s,l]);return n}},function(e,t,n){"use strict";n(9),n(25),n(14),n(29),n(19),n(24),n(111),n(90),n(28),n(3);var i=n(1),o=n(238),r=n(32);const{gApi:a,GLoginDialog:s,DESIGNER:{TITLE:l}={}}=n(12),c=n(76),d=n(1136),u=n(767),p=function(e){return gContainer.signWithOAuth(e)};function g(e){this._closeCallback=e}function h(e){this._callback=e,this._loginConfiguration={}}i.GObject.inherit(g,s.Impl),g.prototype.openOAuth=function(e){let{dialog:t,provider:n}=e;p(n).then(e=>t._postLogin(e)).catch(e=>t._handleError(e))},g.prototype.openPurchaseFlow=async function(e){let{dialog:t,options:n={}}=e;await gDesigner.openPaymentDialog(null,n).catch(()=>null),t.close()},g.prototype.openExternalLink=function(e){let{link:t}=e;gContainer.openExternalLink(null,t)},g.prototype.close=function(){this._closeCallback()},g.prototype.getLanguage=function(){return i.GLocale.getLanguage()},i.GObject.inherit(h,i.GObject),h.prototype._callback=null,h.prototype._newTitle=null,h.prototype._oldTitle=null,h.prototype._loginConfiguration=null,h.prototype._popupInfo=null,h.prototype.open=function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=u.getRuntimeCode();this._loginConfiguration=Object.assign({runtime:n},t);const{anonymous:o=!1,animate:r=!1,version:l="",options:c={}}=t;let h;if(this._oldTitle=document.title,this._newTitle=i.GLocale.get(new i.GLocaleKey("GEmbeddedLogin","text.title")),document.title=this._newTitle,gDesigner.isOffline()){this._frame=$("<div></div>").addClass("cross-frame").toggleClass("g-anonymous",o).appendTo($("body"));const e=new g(()=>this.close());new s({impl:e,gApi:a,origin:location.origin,anonymous:o,version:l,options:c,runtime:n}).open(this._frame)}else{const t=this._buildURL(this._loginConfiguration);this._crossFrame=new d({className:o?"g-anonymous":"",oauth:e=>p(e.provider).then(e=>this._crossFrame.postMessage({cmd:"postLogin",user:e},"*")).catch(t=>this._handleOAuthError(e.provider,t)),close:function(){let{token:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.close(t)}}).open(t),r&&(h=this._crossFrame.getFrame(),h.css({position:"fixed",height:"300%"}),h.on("load",f))}function f(){h&&(h.animate({height:"100%"},"slow"),h.off("load",f))}},h.prototype._handleOAuthError=function(e,t){t&&t.code===a.ERROR_CODES.ERR_POPUP_HAS_BEEN_BLOCKED?this._showPopupInfo(e):this._crossFrame.postMessage({cmd:"error",error:t},"*")},h.prototype._showPopupInfo=function(e){this._popupInfo&&this._popupInfo.remove();const t=e.charAt(0).toUpperCase()+e.slice(1);this._popupInfo=$("<div/>").addClass("g-embedded-login").addClass("popup-info").append($("<div/>").addClass("container").append($("<div/>").addClass("message").html(i.GLocale.get(new i.GLocaleKey("GEmbeddedLogin","text.pop-has-been-blocked")).replace("%provider",t).replace("%app",l))).append($("<img/>").addClass("close-button").attr("src","assets/icon/login/close.svg").on("click",()=>{this._popupInfo.remove()}))),this._popupInfo.find("a").on("click",t=>{t.preventDefault(),this._popupInfo.remove(),p(e).then(e=>{this._crossFrame.postMessage({cmd:"postLogin",user:e},"*")}).catch(e=>{this._crossFrame.postMessage({cmd:"error",error:e},"*")})}),this._popupInfo.appendTo($("body"))},h.prototype._buildURL=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{anonymous:t=!1,signup:n=!1,closeable:s=!0,flow:l,options:d={},runtime:u}=e;let p,g,h,f;if(gContainer.getRuntime()===c.Runtime.Electron){const e=gContainer.getPlatform();"darwin"!==e&&"win32"!==e||(p=window.btoa("designer://")),g=(0,r.stringToBase64String)(gDesigner.getAssetsURL())}else g=(0,r.stringToBase64String)(location.origin);const m=new URL("".concat(a.url,"/pro/login")),y=m.searchParams,v=gDesigner.getSignupOptions();v&&Object.entries(v).forEach(e=>{let[t,n]=e;n&&y.set(t,n)}),g&&y.set("webUrl",g),p&&y.set("appUrl",p),(gDesigner.showCreateAccount()||n||v)&&y.set("newuser",!0),gDesigner.enterpriseLoginForm()&&y.set("enterprise","1"),t&&y.set("anonymous",t),s||y.set("closeable",s),l&&y.set("flow",l),gContainer.shouldBypassEmailVerification()&&y.set("bypassEmailVerification",!0),u&&y.set("runtime",u);var _=new URL(window.location.href);if(_.searchParams)h=_.searchParams.get("token"),f=_.searchParams.get("d");else{for(var b,w={};b=o.GRegex.URLQuery.NextParameter.exec(window.location.href);)w[b[1]]=b[2];h=w.token,f=w.d}return h&&y.set("token",h),f&&y.set("d",f),Object.keys(d).forEach(e=>{y.set(e,d[e])}),y.set("lang",i.GLocale.getLanguage()),m.toString()},h.prototype.close=async function(e){e&&a.setAuthorizationToken&&a.setAuthorizationToken(e);const t=await gDesigner.getUser();t&&(this._isDeactivatedUser(t)?this._handleDeactivatedUser(t):(document.title===this._newTitle&&(document.title=this._oldTitle),this._crossFrame?this._crossFrame.close():this._frame&&this._frame.remove(),this._callback&&this._callback(t)))},h.prototype._isDeactivatedUser=function(e){return(!this._loginConfiguration.anonymous||!gContainer.shouldBypassEmailVerification())&&e.isDeactivated()},h.prototype._handleDeactivatedUser=function(e){if(this._crossFrame){const{flow:e}=this._loginConfiguration;if("purchase_flow_new"===e){const e=this._buildURL(Object.assign(this._loginConfiguration,{flow:void 0}));this._crossFrame.getFrame().attr("src",e)}}gDesigner.openDeactivatedUserDialog(e)},e.exports=h},function(e,t,n){"use strict";n(25),n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(26),l=n(1385),c=n(399),d=n(400);const u=n(77),p=n(36);function g(e){this._options=e||null,g.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GExportAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GExportAction","tooltip-description")),shortcut:g.SHORTCUT,learnMore:"https://documentation.designer.io/import-export/export/"}),[r.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GExportAction","text.try-this-feature-pro-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GExportAction","text.try-this-feature-pro-tooltip-description")),learnMore:"https://documentation.designer.io/import-export/export/#advanced-export",upgradeToProStatsValue:"file.export",middle:!1,side:!0}),[r.TOOLTIP_AREA.MAIN_MENU.TRY_EXP_PDF_ADVANCED_SETTING]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GExportAction","text.try-export-pdf-advanced-setting-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GExportAction","text.try-export-pdf-advanced-setting-tooltip-description")),learnMore:"https://documentation.designer.io/import-export/export/#advanced-export",upgradeToProStatsValue:"file.export.pdf",middle:!1,side:!0})},this._initProTooltip()}i.GObject.inherit(g,s),g.ID="file.export",g.TITLE=new i.GLocaleKey("GExportAction","title"),g.SHORTCUT=[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"E"],g.TOOLTIP_CONFIG=null,g.prototype._initProTooltip=function(){g.TOOLTIP_CONFIG[r.TOOLTIP_AREA.TOOLBAR]=r.GRichTooltipConfig.from(Object.assign(g.TOOLTIP_CONFIG[r.TOOLTIP_AREA.TOOLBAR].getConfig(),{isPro:gDesigner.isProTooltipNeeded(g.ID)}))},g.prototype.getId=function(){return this._options&&this._options.format?g.ID+"."+this._options.format:g.ID},g.prototype.getTitle=function(){return this._options?new i.GLocaleKey("GExportAction","title.advanced-options"):g.TITLE},g.prototype.getGroupIcon=function(){return this._options?null:"gravit-icon-export"},g.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-export":null},g.prototype.getCategory=function(){return this._options&&"pdf"==this._options.format?a.CATEGORY_FILE_EXPORT_PDF:a.CATEGORY_FILE_EXPORT},g.prototype.getGroup=function(){return this._options?"export/file-type/export":"export/export"},g.prototype.isPro=function(){return!0},g.prototype.getShortcut=function(){return this._options?null:g.SHORTCUT},g.prototype.isEnabled=function(){if(!gDesigner.getApplicationManager().isExportEnabled())return!1;return!!gDesigner.getActiveDocument()},g.prototype.execute=function(){const e=arguments[0],t=gDesigner.getActiveDocument(),n=this;function o(t){new l(t,n._options||e,n.getId()).open()}t&&t.isCommercialProductFile()?t.openPaywall(this.getId()):t.hasPagesWithInfiniteEmptyCanvas()?p.alert(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))):new c(()=>{$(".g-export-dialog").length||(t.isNew()?p.confirm(i.GLocale.get(new i.GLocaleKey("GExportAction","text.save-before-export")),e=>{e?gDesigner.executeAction(d.ID,[t,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{documentStatus:t=null}=e;t&&t===u.Saved&&o(gDesigner.getActiveDocument())},!0],"unsavedhandler"):o(t)},i.GLocale.get(new i.GLocaleKey("GLocale","no")),i.GLocale.get(new i.GLocaleKey("GLocale","yes"))):o(t))},()=>{gDesigner.stats("action-cancelled_anonymous",this.getId())})},g.prototype.getTooltipArea=function(){return this._options&&"pdf"===this._options.format?r.TOOLTIP_AREA.MAIN_MENU.TRY_EXP_PDF_ADVANCED_SETTING:r.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON},g.prototype.getTooltipConfig=function(e){return this._options?"pdf"===this._options.format&&e&&g.TOOLTIP_CONFIG[e]||null:e&&g.TOOLTIP_CONFIG[e]||null},g.prototype.toString=function(){return"[Object GExportAction]"},e.exports=g},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.lookupByMimeType=t.lookupByExtension=t.default=t.TYPES=t.FILE_MIME_TYPES=t.FILE_EXTENSIONS=t.DEFAULT_TYPE=void 0,n(45),n(83),n(19),n(24),n(28),n(9),n(58),n(25),n(171);var o=n(1),r=n(12),a=i(n(106)),s=i(n(202)),l=i(n(144)),c=i(n(77)),d=i(n(715)),u=n(534);const p=n(151),{FILE_FORMATS:g,FOLDER_FORMAT:h,MAX_FOLDER_DEPTH_FOR_CLOUD:f}=n(12);let m;function y(){d.default.apply(this,arguments),this.CURRENT_FOLDER=this.getRootFolder(),this.FOLDERS={},this.QUERY_LIMIT=10,this.EXAMPLE_FILES_CACHE=[],this.getPreviousSelectedFolder().then(e=>{e&&this.setCurrentFolder(e)}),this.setDefaultEmptyMessage({title:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.message-explore-cloud-templates"))})}o.GObject.inherit(y,d.default),y.prototype.CURRENT_FOLDER_PROP="designer.filespanel.cloud-drive.current-folder",y.getInstance=function(){return m||(m=new y),m},y.prototype.getPreviousSelectedFolder=function(){return d.default.prototype.getPreviousSelectedFolder.apply(this,arguments).then(e=>e?this._convertToFolderElement(e):e)},y.prototype.setQueryLimit=function(e){return this.QUERY_LIMIT=parseInt(e,10),this},y.prototype.setCurrentFolder=function(e){return this.CURRENT_FOLDER=e,gContainer.setProperty(this.CURRENT_FOLDER_PROP,JSON.stringify(e)),this},y.prototype.isRootFolder=function(e){return!(e=void 0!==e?e:this.getCurrentFolder())||e&&"object"==typeof e&&!e.id},y.prototype.getRootFolder=function(){return p.from({id:null,name:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.my-cloud"))})},y.prototype.getFolder=function(e){return r.gApi.getFile(e.id||e).then(e=>this._convertToFolderElement(e))},y.prototype.getCurrentFolder=function(){return this.CURRENT_FOLDER},y.prototype.buildFoldersHierarchy=function(e){var t={},n=new Set,i={};if(!e.length)return t;for(let t=0;t<e.length;t++){let n=a.default.definePath(e[t]);i[n]=e[t]}function o(e){let t=new Set;for(;e&&e.parent;){if(e.id===e.parent)return console.warn("Invalid folder"),e.parent=null,[];if(t.has(e.parent))return console.warn("Invalid folder"),e.parent=null,[];t.add(e.parent),e=i[e.parent]}return[...t]}return e.forEach(e=>{if(n.has(e.id))return;let i={path:o(e),folder:e};if(i.path.length>f)for(let e=0;e<i.path.length-f;e++)n.add(i.path[e]);else t[e.id]=i}),t},y.prototype.isLoadFoldersOnDemandSupported=function(){return!0},y.prototype.fetchFolders=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object.keys(this.FOLDERS).length||await this._buildFolderStructure(e),this.isRootFolder(t)&&this.generatePreviousSelectedFolderPath(),t=t||this.CURRENT_FOLDER,r.gApi.listFiles({type:h,parent:this._extractId(t),sort:e+"",limit:n>0?n:100,skip:i}).then(e=>this._convertToFolderElement(e))},y.prototype._convertToFolderElement=function(e){const t=e=>{var t=p.from(e);return t.setItemType(p.Type.Folder),t.setPermissions([p.Permission.Open,p.Permission.Copy,p.Permission.Editing,p.Permission.Rename,p.Permission.CutPaste,p.Permission.Delete]),t};return e instanceof Array?e.map(t):t(e)},y.prototype._buildFolderStructure=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc";if(Object.keys(this.FOLDERS).length)return;const t=await r.gApi.listFiles({type:h,parent:"*",sort:e+"",limit:Number.MAX_SAFE_INTEGER});this.FOLDERS=this.buildFoldersHierarchy(t),!this.CURRENT_FOLDER||this.FOLDERS[this.CURRENT_FOLDER.id]||this.isRootFolder(this.CURRENT_FOLDER)||this._isCustomFolder(this.CURRENT_FOLDER)||this.setCurrentFolder(null)},y.prototype._isCustomFolder=function(e){return!1},y.prototype.getFolders=function(){return this.FOLDERS},y.prototype.createFolder=function(e){return a.default.createFolder(e,this.CURRENT_FOLDER)},y.prototype.navigateToParentFolder=function(){var e=this.CURRENT_FOLDER&&this.CURRENT_FOLDER.parent?this.FOLDERS[this.CURRENT_FOLDER.parent].folder:null;return this.setCurrentFolder(e),this},y.prototype.getFile=function(e){return r.gApi.getFile(e,!0).then(e=>a.default.convertToCloudItem(e))},y.prototype.getRawFile=async function(e,t,n){const i=await r.gApi.getFileExtended(e.id),o=await fetch(i.getFileDataURL(),{signal:t});return(0,u.readResponseWithProgress)(o,n.progress,!0).then(e=>e.blob())},y.prototype.openFile=function(e,t){return new Promise(async(n,i)=>{try{const i=await s.default.from(gDesigner.getDefaultStorage(),e,void 0,void 0,e.autosave);gDesigner.openDocument(i,t),n()}catch(e){i(e)}})},y.prototype.saveNewFile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;n=n||b.ext.toUpperCase();var u=e.getScene();if(e.hasPagesWithInfiniteEmptyCanvas())return Promise.reject({message:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas")),dontExtend:!0});let p=gDesigner.getWindows().getActiveWindow().getView();const g=p.getZoom(),h=p.getScrollX(),f=p.getScrollY(),m=u.getActivePage(),y=m.getReferenceId(),v=u.getActivePage().getGeometryBBox();return r.gApi.createFile({name:t,parent:this._extractId(this.CURRENT_FOLDER),type:(E(n)||b).type,app:"designer",unit:u.getProperty("ut"),width:v.getWidth(),height:v.getHeight(),trashed:null}).then(async r=>{r.type===b.type&&u.setCloudSynchronization(r.id);const m=r.type!==b.type;await e.saveAnnotations(m),i=e.updateSaveOptionsLastModifiedDate(i);var v=await s.default.from(gDesigner.getDefaultStorage(),r.id);e.setStorageItem(v);var _=new l.default(v);return _.deserializeData(o.GNode.serialize(u,i)).then(async()=>(e.getFileFormatVersion()&&_.setFileFormatVersion(e.getFileFormatVersion()),await _.saveAnnotations(m,!0),(u=_.getScene()).iteratePages(e=>{if(e.getReferenceId()===y)return u.setActivePage(e),!1}),gDesigner.addDocument(_),d?d(c.default.Loaded):gDesigner.removeDocument(e,null,!0),p=gDesigner.getWindows().getActiveWindow().getView(),p.transform(h,f,g),i=_.updateSaveOptionsLastModifiedDate(i),o.GUtil.prepareForSaving(u,n),a.default.performSave(_,()=>{_.getFileFormatVersion()&&_.getStorageItem().storeFileFormatVersion(_.getFileFormatVersion()),d&&d(c.default.Saved)},()=>{d&&d(c.default.SaveFailed)},i),e.isCloudFile()||e.setTitle(t),r)).catch(e=>(console.error(e),new Promise((e,t)=>{t(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-saving-file")))})))}).catch(e=>(console.error(e),new Promise((e,t)=>{t(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-saving-file")))})))},y.prototype.fetchRecentFiles=function(){const e=this._getFileTypesForFilter().map(e=>({type:e}));return a.default.getRecentStorageItems(e).then(e=>this._convertAndUpdateCloudItems(e))},y.prototype.fetchFiles=function(e,t,n){var i={type:this._getFileTypesForFilter().join("|"),parent:this._extractId(this.CURRENT_FOLDER),limit:this.QUERY_LIMIT+"",skip:t+"",sort:n+""};return e&&(i.name=e,i.parent="*"),r.gApi.listFiles(i).then(e=>this._convertAndUpdateCloudItems(e))},y.prototype._convertAndUpdateCloudItems=function(e){return a.default.convertToCloudItem(e)},y.prototype._getFileTypesForFilter=function(){const e=this.getSelectedFilterForFileTypes();return 0!==e.length?e:this.getSupportedMIMETypes()},y.prototype.renameItem=function(e,t){return r.gApi.updateFile(e.id,{name:t})},y.prototype.isItemAllowedToBeRendered=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!t&&!n)||a.default.definePath(this.CURRENT_FOLDER)===e.parent},y.prototype.deleteItem=function(e){return r.gApi.updateFile(e.id,{trashed:!0}).then(()=>r.gApi.deleteFile(e.id))},y.prototype.cutPaste=function(e){var t=a.default.definePath(this.CURRENT_FOLDER);return a.default.changePathTree(e,t)},y.prototype.fileMove=function(e,t){return a.default.changePathTree([e],t.id)},y.prototype.copyPaste=function(e){const t=a.default.definePath(this.CURRENT_FOLDER);return Promise.all(e.map(async e=>{const{id:n}=await r.gApi.copyFile(e.id,{parent:t});return{id:n,parent:t}}))},y.prototype.supportsSaveCollisionFlow=function(){return!0},y.prototype._extractId=function(e){return e?"string"==typeof e?e||null:e.id||null:null},y.prototype.fileExists=async function(e,t,n){n=n||this.CURRENT_FOLDER;var i={type:this.getSupportedFileFormats().find(e=>e.ext.toLocaleLowerCase()===t.toLocaleLowerCase()).type,parent:this._extractId(n),name:'"'.concat(e,'"')};return r.gApi.listFiles(i).then(e=>!!e.length)},y.prototype.folderExists=function(e,t){return t=t||this.CURRENT_FOLDER,r.gApi.listFiles({type:h,parent:this._extractId(t),name:'"'.concat(e,'"')}).then(e=>!!e.length)},y.prototype.generatePreviousSelectedFolderPath=function(){if(!this.PREVIOUS_SELECTED_FOLDER_PATH.length&&this.CURRENT_FOLDER){const e=this.FOLDERS&&this.FOLDERS[this.CURRENT_FOLDER.getId()];if(!e)return;this.PREVIOUS_SELECTED_FOLDER_PATH=this.PREVIOUS_SELECTED_FOLDER_PATH.concat(e.path),this.PREVIOUS_SELECTED_FOLDER_PATH.find(t=>t===e.folder.id)||this.PREVIOUS_SELECTED_FOLDER_PATH.push(e.folder.id)}},y.prototype.loadExampleFiles=async function(){0===this.EXAMPLE_FILES_CACHE.length&&(this.EXAMPLE_FILES_CACHE=await r.gApi.getExampleFiles().catch(()=>[]));const e=this.getSelectedFilterForFileTypes();let t=this.EXAMPLE_FILES_CACHE;return 0!==e.length&&(t=t.filter(e=>this._getFileTypesForFilter().includes(e.type))),t.map(e=>{let t=p.from(e);return t.setPermissions([p.Permission.Open]),t})};var v=y;t.default=v;const _=Object.assign({FOLDER:h},g.reduce((e,t)=>(e[t.ext.toUpperCase()+"_FILE"]=t,e),{}));t.TYPES=_;const b=Object.values(_).find(e=>e.default);t.DEFAULT_TYPE=b;const w=g.map(e=>{let{ext:t}=e;return t.toUpperCase()});t.FILE_EXTENSIONS=w;const C=g.map(e=>{let{type:t}=e;return t});t.FILE_MIME_TYPES=C;t.lookupByMimeType=e=>Object.values(_).find(t=>{let{type:n}=t;return!!n&&n.toLowerCase()===e.toLowerCase()});const E=e=>Object.values(_).find(t=>{let{ext:n}=t;return!!n&&n.toLowerCase()===e.toLowerCase()});t.lookupByExtension=E},function(e,t,n){"use strict";e.exports={Info:{id:"info"},Header:{id:"header"},Toolbar:{id:"toolbar"},Panels:{id:"panels"},Footer:{id:"footer"},LeftSidebars:{id:"left-sidebars"},RightSidebars:{id:"right-sidebars"},Windows:{id:"windows"},AssistantBar:{id:"assistant-bar"}}},function(e,t,n){"use strict";n(3),n(19),n(24),n(171);var i=n(43),o=n(1),r=n(78),a=n(548),s=n(719),l=n(354),c=n(1048),d=n(1145),u=n(1050),p=n(1146),g=n(1148),h=n(1149),f=n(1150),m=n(1153),y=n(1154),v=n(1155),_=n(1156),b=n(1157),w=n(1158),C=n(1400),E=n(1047);const S=n(118),G=n(193),A=n(720);function T(){s.call(this),this._propertyPanels=[],this._touchTools=[]}o.GObject.inherit(T,s),T.ACCORDIONS=[c.prototype.toString(),d.prototype.toString(),u.prototype.toString(),p.prototype.toString()],T.APPEARANCE_PROPERTIES=[w.prototype.toString(),y.prototype.toString(),m.prototype.toString(),h.prototype.toString(),b.prototype.toString(),f.prototype.toString(),v.prototype.toString(),_.prototype.toString(),g.prototype.toString(),c.prototype.toString()],T.ID=G.SidebarsIds.GInspectorSidebar,T.TITLE=new o.GLocaleKey("GInspectorSidebar","title"),T.prototype._touchTools=null,T.prototype._htmlElement=null,T.prototype._propertyPanels=null,T.prototype._document=null,T.prototype._elements=null,T.prototype._transformMode=!1,T.prototype._appearancePanel=null,T.prototype._versionHistoryPanel=null,T.prototype._versionHistoryProperties=null,T.prototype._versionHistoryMode=!1,T.prototype.getId=function(){return T.ID},T.prototype.getTitle=function(){return T.TITLE},T.prototype.isEnabled=function(){return!!this._document},T.prototype.isVisible=function(){return!(!gDesigner.getApplicationManager().isInspectEnabled()&&gDesigner.getActiveDocument())},T.prototype.getOrientation=function(){return l.Orientation.Right},T.prototype.getMinimumWidth=function(){return 300},T.prototype.isResizeable=function(){return!1},T.prototype.getDefaultWidth=function(){return 300},T.prototype.init=function(e){s.prototype.init.call(this,e),this._htmlElement=e;var t=$("<div></div>").addClass("panels scrolling-panels").appendTo(this._htmlElement),n=$("<div></div>").addClass("panels sticky-panels").appendTo(this._htmlElement),i=$("<div></div>").addClass("toolbar appearance-toolbar");this._appearancePanel=$("<div></div>").css("display","none").addClass("properties-panel").addClass("appearance-properties-panel"),$("<label></label>").addClass("appearance-toolbar-title").text(o.GLocale.get(new o.GLocaleKey("GAppearanceProperties","title"))).appendTo(i);for(var r=function(e){var o=e.isSticky()?n:t,r=$("<div></div>").css("display","none").addClass("properties-panel"),a=$("<hr/>"),s=$("<div></div>").addClass("toolbar");if($.inArray(e.toString(),T.APPEARANCE_PROPERTIES)>-1){var l=$("<div></div>").addClass("appearance-property-panel");e.init(l,i),a.appendTo(l),this._appearancePanel.append(l),i.appendTo(o),this._appearancePanel.appendTo(o),s=i,r=l}else a.appendTo(o),e.init(r,s),""!==s.html()?s.appendTo(o):s=null,r.appendTo(o);this._propertyPanels.push({panel:r,toolbar:s,divider:a,properties:e})}.bind(this),a=0;a<gravit.properties.length;++a)r(gravit.properties[a]);this._activeTool(gDesigner.getToolManager().getActiveTool()),this._updatePropertyPanels(),this._initVersionHistoryPanel(),gDesigner.getRightSidebars().addEventListener(A,this._sidebarEvent,this),gDesigner.addEventListener(S,this._settingChanged,this)},T.prototype._getPropertyPanel=function(e){return this._propertyPanels.find(t=>t.properties instanceof e)||null},T.prototype.openFillPatternChooser=function(){const e=this._getPropertyPanel(d);e&&e.properties.openPatternChooser()},T.prototype.openBorderPatternChooser=function(){const e=this._getPropertyPanel(u);e&&e.properties.openPatternChooser()},T.prototype.openFillEyeDropper=function(e,t){const n=this._getPropertyPanel(d);n&&n.properties.openEyeDropper(e,t)},T.prototype.openBorderEyeDropper=function(e,t){const n=this._getPropertyPanel(u);n&&n.properties.openEyeDropper(e,t)},T.prototype.openTextColorEyeDropper=function(e,t){const n=this._getPropertyPanel(b);n&&n.properties.openEyeDropper(e,t)},T.prototype.setPathPointsNodeType=function(e){const t=this._getPropertyPanel(m);t&&t.properties.assignNodeType(e)},T.prototype._sidebarEvent=function(e){gDesigner.isTouchEnabled()&&e.type===A.Type.Activated&&e.sidebar&&e.sidebar.getId()===G.SidebarsIds.GAnnotationsSidebar&&this._updatePropertyPanels()},T.prototype.activate=function(){gDesigner.addEventListener(r,this._documentEvent,this),gDesigner.getToolManager().addEventListener(i.GToolManager.ToolChangedEvent,this._toolChangedEvent,this);var e=gDesigner.getActiveDocument();e&&this._activateDocument(e)},T.prototype.deactivate=function(){gDesigner.removeEventListener(r,this._documentEvent,this),gDesigner.getToolManager().removeEventListener(i.GToolManager.ToolChangedEvent,this._toolChangedEvent,this),this._document&&this._deactivateDocument()},T.prototype._initVersionHistoryPanel=function(){this._versionHistoryPanel=$("<div />").css("display","none").addClass("panels history-panel").appendTo(this._htmlElement);var e=$("<div></div>").addClass("properties-panel version-history-panel"),t=$("<div></div>").addClass("toolbar");this._versionHistoryProperties=new C,this._versionHistoryProperties.init(e,t),this._versionHistoryPanel.append(t).append(e),gDesigner.addEventListener(E,this._updateVersionsPanel,this)},T.prototype._updateVersionsPanel=function(e){if(e.type===E.Type.Enable){var t;switch(this._versionHistoryMode=!0,this.getOrientation()){case l.Orientation.Left:t=gDesigner.getLeftSidebars();break;case l.Orientation.Right:t=gDesigner.getRightSidebars()}t.setActiveSidebar(this.getId()),gDesigner.setPartVisible(t.getSidebarsPart(),!0),this._htmlElement.find(".panels").css("display","none"),this._versionHistoryPanel.appendTo(this._htmlElement),this._versionHistoryPanel.css("display","")}else e.type===E.Type.Disable&&(this._versionHistoryMode=!1,this._htmlElement.find(".panels").css("display",""),this._versionHistoryPanel.css("display","none"),this._updatePropertyPanels(!1));gDesigner.isTouchEnabled()&&this._updateVersionsPanelTouch()},T.prototype._documentEvent=function(e){e.type===r.Type.Activated?this._activateDocument(e.document):e.type===r.Type.Deactivated?this._deactivateDocument():e.type===r.Type.StorageItemUpdated&&this._updatePropertyPanels(!1,e.data?e.data:null)},T.prototype._activateDocument=function(e){this._document&&this._deactivateDocument(),this._document=e;var t=this._document.getScene(),n=this._document.getEditor();gDesigner.getToolManager().addEventListener(i.GToolManager.ToolChangedEvent,this._updateFromToolOrSelection,this),n.addEventListener(i.GEditor.SelectionChangedEvent,this._updateFromToolOrSelection,this),t.addEventListener(o.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),this._updateFromToolOrSelection(),this.trigger(a.UPDATE_EVENT)},T.prototype._deactivateDocument=function(){var e=this._document.getScene(),t=this._document.getEditor();gDesigner.getToolManager().removeEventListener(i.GToolManager.ToolChangedEvent,this._updateFromToolOrSelection,this),t.removeEventListener(i.GEditor.SelectionChangedEvent,this._updateFromToolOrSelection,this),e.removeEventListener(o.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),this._document=null,this._elements=null,this._updatePropertyPanels(!0),this.trigger(a.UPDATE_EVENT)},T.prototype._toolChangedEvent=function(e){var t=e.previousTool,n=e.newTool;t&&t instanceof i.GSelectTool&&(e.light||this._updateTransformMode(!1),t.removeEventListener(i.GSelectTool.Event,this._selectToolEvent,this)),this._activeTool(n)},T.prototype._activeTool=function(e){e&&e instanceof i.GSelectTool&&e.addEventListener(i.GSelectTool.Event,this._selectToolEvent,this)},T.prototype._selectToolEvent=function(e){e.type===i.GSelectTool.Event.Type.EditModeChanged&&this._updateTransformMode(e.args.mode===i.GSelectTool.EditMode.Transform)},T.prototype._updateTransformMode=function(e){e!==this._transformMode&&(this._transformMode=e,this._updatePropertyPanels(!1))},T.prototype._afterFlagChangeEvent=function(e){e.node instanceof o.GPage&&e.flag===o.GNode.Flag.Active&&!this._document.getEditor().hasSelection()&&this._updateFromToolOrSelection()},T.prototype._updateFromToolOrSelection=function(e){var t=this._document.getEditor();if(this._document&&t&&(this._elements=t.getSelection(),this._elements&&this._elements.length&&(this._elements=t.filterIndividualElements(this._elements.filter(e=>!e.hasMixin(o.GAnnotation)))),!this._elements||0===this._elements.length)){var n=gDesigner.getToolManager().getActiveTool(),r=null;n instanceof i.GItemTool&&(r=n.getDefaultStyle())?this._elements=[r]:this._elements=[this._document.getScene().getActivePage()]}this._updatePropertyPanels(!1)},T.prototype._updatePropertyPanels=function(e,t){var n=!1,i=null,o=null;this._touchTools=[];for(var r=0;r<this._propertyPanels.length;++r){var a=this._propertyPanels[r],s=a.properties,l=s.isAvailable(this._transformMode);if(l&&(l=a.properties.update(e?null:this._document,this._elements?this._elements:null,t||null)),l){const e=a.properties.getTouchTools();e&&(this._touchTools=this._touchTools.concat(e))}a.panel.css("display",l?"":"none"),a.toolbar&&(a.toolbar.css("display",l?"":"none"),s instanceof _&&l&&(o=a.toolbar),$.inArray(a.properties.toString(),T.ACCORDIONS)>-1&&l&&(a.toolbar.addClass("appearance-panel-toggle-btn").gAccordion("init",".properties-panel","label"),this._htmlElement.find(".appearance-panel-toggle-btn button.g-accordion")[gDesigner.isTouchEnabled()?"hide":"show"]()));var c=l&&n&&s.isGroup(i);a.divider.css("display",c?"":"none"),n=n||l,l&&(i=s,this._appearancePanel.css("display",""));const d=this._isPropertiesEnabled(a.properties);a.toolbar&&a.toolbar.toggleClass("g-disabled",!d),a.panel&&a.panel.toggleClass("g-disabled",!d)}o&&gDesigner.isTouchEnabled()&&o.css("display","");var d=$("<hr/>").addClass("appearance-divider");0===$(".appearance-divider").length&&$(".appearance-toolbar:first").before(d),$(".appearance-divider").css("display","none"===$(".appearance-toolbar:first").css("display")?"none":""),$(".appearance-properties-panel >div >hr:visible:last").css("display","none"),$(".sidebar-inspector").find(".toolbar").removeClass("last-toolbar"),$(".sidebar-inspector").find(".toolbar").filter(":visible").filter(":last").addClass("last-toolbar"),gDesigner.isTouchEnabled()&&this._fireUpdateEvent(),this._updateUI()},T.prototype._updateUI=function(){let e=this._htmlElement.find(".group-frame-property-panel"),t=this._htmlElement.find(".frame-property-panel"),n=this._htmlElement.find(".item-property-panel"),i=this._htmlElement.find(".symbol-instance-toolbar"),o=this._htmlElement.find(".symbol-instance-panel"),r=null;r=gDesigner.isTouchEnabled()?this._htmlElement.find(".appearance-properties-panel .appearance-property-panel:last-child"):this._htmlElement.find(".scene-properties-panel").next(),r&&(o.insertAfter(r),i.insertAfter(r),n.next().insertAfter(r),n.insertAfter(r),t.next().insertAfter(r),t.insertAfter(r),e.next().insertAfter(r),e.insertAfter(r))},T.prototype._settingChanged=function(e){"touch"===e.key&&(this._htmlElement.find(".appearance-panel-toggle-btn button.g-accordion")[gDesigner.isTouchEnabled()?"hide":"show"](),this._updateUI(),this._updatePropertyPanels())},T.prototype._isPropertiesEnabled=function(e){return!0},T.prototype.getTouchTools=function(){let{disableContextSensitive:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e?this._getAllTouchTools():this._touchTools},T.prototype._getAllTouchTools=function(){return[...new Set(this._propertyPanels.reduce((e,t)=>{const n=t.properties.getTouchTools();return n&&(e=e.concat(n)),e},[]))]},T.prototype.toString=function(){return"[Object GInspectorSidebar]"},n(1401)(T),e.exports=T},function(e,t,n){"use strict";var i=n(47),o=n(6),r=n(22),a=n(114),s=n(1396),l=n(1397),c=n(27),d=o.RangeError,u=o.String,p=Math.floor,g=r(l),h=r("".slice),f=r(1..toFixed),m=function(e,t,n){return 0===t?n:t%2==1?m(e,t-1,n*e):m(e*e,t/2,n)},y=function(e,t,n){for(var i=-1,o=n;++i<6;)o+=t*e[i],e[i]=o%1e7,o=p(o/1e7)},v=function(e,t){for(var n=6,i=0;--n>=0;)i+=e[n],e[n]=p(i/t),i=i%t*1e7},_=function(e){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==e[t]){var i=u(e[t]);n=""===n?i:n+g("0",7-i.length)+i}return n};i({target:"Number",proto:!0,forced:c((function(){return"0.000"!==f(8e-5,3)||"1"!==f(.9,0)||"1.25"!==f(1.255,2)||"1000000000000000128"!==f(0xde0b6b3a7640080,0)}))||!c((function(){f({})}))},{toFixed:function(e){var t,n,i,o,r=s(this),l=a(e),c=[0,0,0,0,0,0],p="",f="0";if(l<0||l>20)throw d("Incorrect fraction digits");if(r!=r)return"NaN";if(r<=-1e21||r>=1e21)return u(r);if(r<0&&(p="-",r=-r),r>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(r*m(2,69,1))-69)<0?r*m(2,-t,1):r/m(2,t,1),n*=4503599627370496,(t=52-t)>0){for(y(c,0,n),i=l;i>=7;)y(c,1e7,0),i-=7;for(y(c,m(10,i,1),0),i=t-1;i>=23;)v(c,1<<23),i-=23;v(c,1<<i),y(c,1,1),v(c,2),f=_(c)}else y(c,0,n),y(c,1<<-t,0),f=_(c)+g("0",l);return f=l>0?p+((o=f.length)<=l?"0."+g("0",l-o)+f:h(f,0,o-l)+"."+h(f,o-l)):p+f}})},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16),a=n(56),s=n(18),l=n(26);function c(e){this._type=e,this._title=new o.GLocaleKey("GAlignAction","title."+e),c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.SIDEBAR]:{[i.GEditor.ArrangeAlignType.AlignLeft]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-left-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-left-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-left"}),[i.GEditor.ArrangeAlignType.AlignCenter]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-center-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-center-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-center"}),[i.GEditor.ArrangeAlignType.AlignRight]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-right-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-right-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-right"}),[i.GEditor.ArrangeAlignType.AlignTop]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-top-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-top-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-top"}),[i.GEditor.ArrangeAlignType.AlignMiddle]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-middle-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-middle-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-middle"}),[i.GEditor.ArrangeAlignType.AlignBottom]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-bottom-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GAlignAction","text.align-bottom-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/align/#align-bottom"})}}}o.GObject.inherit(c,l),c.ID="arrange.align",c.TOOLTIP_CONFIG=null,c.prototype._type=null,c.prototype._title=null,c.prototype.getId=function(){return c.ID+"."+this._type},c.prototype.getTitle=function(){return this._title},c.prototype.getCategory=function(){return s.CATEGORY_MODIFY_ALIGN},c.prototype.getGroup=function(){var e="";switch(this._type){case i.GEditor.ArrangeAlignType.AlignLeft:case i.GEditor.ArrangeAlignType.AlignCenter:case i.GEditor.ArrangeAlignType.AlignRight:e="horizontal";break;case i.GEditor.ArrangeAlignType.AlignTop:case i.GEditor.ArrangeAlignType.AlignMiddle:case i.GEditor.ArrangeAlignType.AlignBottom:e="vertical";break;case i.GEditor.ArrangeAlignType.AlignJustifyHorizontal:case i.GEditor.ArrangeAlignType.AlignJustifyVertical:e="justify"}return"arrange/align-"+e},c.prototype.getShortcut=function(){const e=[r.GKey.Constant.OPTION];switch(this._type){case i.GEditor.ArrangeAlignType.AlignLeft:return e.concat("A");case i.GEditor.ArrangeAlignType.AlignCenter:return e.concat("H");case i.GEditor.ArrangeAlignType.AlignRight:return e.concat("D");case i.GEditor.ArrangeAlignType.AlignTop:return e.concat("W");case i.GEditor.ArrangeAlignType.AlignMiddle:return e.concat("V");case i.GEditor.ArrangeAlignType.AlignBottom:return e.concat("S");default:return null}},c.prototype.isEnabled=function(e,t,n){var i=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor():null;return!(!(e=e||(i?i.getIndividualSelection():null))||!e.length)},c.prototype.execute=function(e,t,n){var o=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor():null;if(e=e||(o?o.getIndividualSelection():null),o&&e&&1===e.length&&!n){var r=i.GElementEditor.getEditor(e[0]);if(!r||!r.isAlignPartsAllowed())if(o.getScene().isFixedSized())n=o.getScene().getActivePage().getGeometryBBox();else n=o.getScene().getPaintBBox()}gDesigner.getActiveDocument().getEditor().arrangeAlign(this._type,e,t,n)},c.prototype._isAlignOnlyCategory=function(){switch(this._type){case i.GEditor.ArrangeAlignType.AlignLeft:case i.GEditor.ArrangeAlignType.AlignCenter:case i.GEditor.ArrangeAlignType.AlignRight:case i.GEditor.ArrangeAlignType.AlignTop:case i.GEditor.ArrangeAlignType.AlignMiddle:case i.GEditor.ArrangeAlignType.AlignBottom:return!0;default:return!1}},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]&&c.TOOLTIP_CONFIG[e][this._type]||null},c.prototype.toString=function(){return"[Object GAlignAction]"},e.exports=c},function(e,t,n){"use strict";n(297),n(3);var i=n(43),o=n(1),r=n(56),a=n(18),s=n(26);function l(e){this._type=e,this._title=new o.GLocaleKey("GDistributeAction","title."+e),l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.SIDEBAR]:{[l.Type.Horizontal]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GDistributeAction","text.horizontal-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GDistributeAction","text.horizontal-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/distribute/"}),[l.Type.Vertical]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GDistributeAction","text.vertical-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GDistributeAction","text.vertical-tooltip-description")),learnMore:"https://documentation.designer.io/arrange-objects/distribute/"})}}}o.GObject.inherit(l,s),l.Type={Horizontal:"horizontal",Vertical:"vertical"},l.TOOLTIP_CONFIG=null,l.ID="arrange.distribute",l.prototype._type=null,l.prototype._title=null,l.prototype.getId=function(){return l.ID+"."+this._type},l.prototype.getTitle=function(){return this._title},l.prototype.getIcon=function(){switch(this._type){case l.Type.Horizontal:return'<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="3 2 20 20" width="20" height="20"><rect id="align-area" x="4" y="6" width="4" height="12" fill="#FFF"/><rect id="align-area" x="18" y="8" width="4" height="8" fill="#FFF"/><rect id="align-shape" x="10" y="3" width="2" height="18" fill="#3A98FF"/><rect id="align-shape" x="14" y="3" width="2" height="18" fill="#3A98FF"/></svg>';case l.Type.Vertical:return'<svg class="align-svg" xmlns="http://www.w3.org/2000/svg" style="isolation:isolate" viewBox="28 2 20 20" width="20" height="20"><rect id="align-area" x="36" y="13" width="4" height="12" transform="rotate(-90 38 19)" fill="#FFF"/><rect id="align-area" x="36" y="1" width="4" height="8" transform="rotate(-90 38 5)" fill="#FFF"/><rect id="align-shape" x="37" y="5" width="2" height="18" transform="rotate(-90 38 14)" fill="#3A98FF"/><rect id="align-shape" x="37" y="1" width="2" height="18" transform="rotate(-90 38 10)" fill="#3A98FF"/></svg>';default:return null}},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_ALIGN},l.prototype.getGroup=function(){return"arrange/align-distribute"},l.prototype.getShortcut=function(){return null},l.prototype.isEnabled=function(e,t,n){return!!(e=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null))&&(t?e.length>1:n>0?e.length>=2:e.length>2)},l.prototype.execute=function(e,t,n){var r=gDesigner.getActiveDocument(),a=r.getScene();e||(e=r.getEditor().getSelection());var s=e=r.getEditor().filterIndividualElements(e);e=[];for(let t=0;t<s.length;++t){var c=s[t];if(c.hasMixin(o.GElement.Transform)){var d=c.getGeometryBBox();if(!d||d.getWidth()+d.getHeight()===0)continue;e.push({elbbox:d,element:c})}}if(!t)for(let n=0;n<e.length;++n)t=t?t.united(e[n].elbbox):e[n].elbbox;if(t&&!t.isEmpty())if(this._type===l.Type.Horizontal){e.sort((function(e,t){return e.elbbox.getX()+e.elbbox.getWidth()/2-t.elbbox.getX()-t.elbbox.getWidth()/2}));let r=null;if(!n)if(e.length>1){let i=0;for(let t=0;t<e.length;++t)i+=e[t].elbbox.getWidth();i<=t.getWidth()?n=(t.getWidth()-i)/(e.length-1):r=(t.getWidth()-e[0].elbbox.getWidth()/2-e[e.length-1].elbbox.getWidth()/2)/(e.length-1)}else n=0;i.GEditor.tryRunTransaction(a,function(){var i=t.getX();if(null===r)for(let t=0;t<e.length;++t)i!==e[t].elbbox.getX()&&e[t].element.transform(new o.GTransform(1,0,0,1,i-e[t].elbbox.getX(),0),!0),i+=e[t].elbbox.getWidth()+n;else{var a=i+e[0].elbbox.getWidth()/2;for(let t=0;t<e.length;++t){var s=a+r*t-e[t].elbbox.getWidth()/2;s!==e[t].elbbox.getX()&&e[t].element.transform(new o.GTransform(1,0,0,1,s-e[t].elbbox.getX(),0),!0)}}}.bind(this),o.GLocale.get(this.getTitle()))}else if(this._type===l.Type.Vertical){e.sort((function(e,t){return e.elbbox.getY()+e.elbbox.getHeight()/2-(t.elbbox.getY()+t.elbbox.getHeight()/2)}));let r=null;if(!n)if(e.length>1){let i=0;for(let t=0;t<e.length;++t)i+=e[t].elbbox.getHeight();i<=t.getHeight()?n=(t.getHeight()-i)/(e.length-1):r=(t.getHeight()-e[0].elbbox.getHeight()/2-e[e.length-1].elbbox.getHeight()/2)/(e.length-1)}else n=0;i.GEditor.tryRunTransaction(a,function(){var i=t.getY();if(null===r)for(let t=0;t<e.length;++t)i!==e[t].elbbox.getY()&&e[t].element.transform(new o.GTransform(1,0,0,1,0,i-e[t].elbbox.getY()),!0),i+=e[t].elbbox.getHeight()+n;else{var a=i+e[0].elbbox.getHeight()/2;for(let t=0;t<e.length;++t){var s=a+r*t-e[t].elbbox.getHeight()/2;s!==e[t].elbbox.getX()&&e[t].element.transform(new o.GTransform(1,0,0,1,0,s-e[t].elbbox.getY()),!0)}}}.bind(this),o.GLocale.get(this.getTitle()))}},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]&&l.TOOLTIP_CONFIG[e][this._type]||null},l.prototype.toString=function(){return"[Object GDistributeAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(1);function o(e){this.type=e}i.GObject.inherit(o,i.GEvent),o.prototype.type=null,o.Type={Updated:0},e.exports=o},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16),a=n(56),s=n(18),l=n(26);function c(e){this._type=e,this._title=new o.GLocaleKey("GArrangeAction","title."+e),c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:{[i.GEditor.ArrangeOrderType.BringForward]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GArrangeAction","bring-forward-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GArrangeAction","bring-forward-tooltip-description")),shortcut:c.SHORTCUT[i.GEditor.ArrangeOrderType.BringForward],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Bring_Forward.mp4",learnMore:"https://documentation.designer.io/arrange-objects/stacking-order/"}),[i.GEditor.ArrangeOrderType.SendBackward]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GArrangeAction","send-backward-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GArrangeAction","send-backward-tooltip-description")),shortcut:c.SHORTCUT[i.GEditor.ArrangeOrderType.SendBackward],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Send_Backward.mp4",learnMore:"https://documentation.designer.io/arrange-objects/stacking-order/"})}}}o.GObject.inherit(c,l),c.SHORTCUT={[i.GEditor.ArrangeOrderType.SendToFront]:[r.GKey.Constant.SHIFT,r.GKey.Constant.META,r.GKey.Constant.UP],[i.GEditor.ArrangeOrderType.BringForward]:[r.GKey.Constant.META,r.GKey.Constant.UP],[i.GEditor.ArrangeOrderType.SendBackward]:[r.GKey.Constant.META,r.GKey.Constant.DOWN],[i.GEditor.ArrangeOrderType.SendToBack]:[r.GKey.Constant.SHIFT,r.GKey.Constant.META,r.GKey.Constant.DOWN]},c.TOOLTIP_CONFIG=null,c.ID="arrange.order",c.prototype._type=null,c.prototype._title=null,c.prototype.getId=function(){return c.ID+"."+this._type},c.prototype.getTitle=function(){return this._title},c.prototype.getCategory=function(){return s.CATEGORY_MODIFY_ARRANGE},c.prototype.getGroup=function(){return"arrange/arrange"},c.prototype.getShortcut=function(){return c.SHORTCUT[this._type]||null},c.prototype.isEnabled=function(e){return(e=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null))&&e.length>0},c.prototype.execute=function(e){gDesigner.getActiveDocument().getEditor().arrangeOrder(this._type,e,!1)},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]&&c.TOOLTIP_CONFIG[e][this._type]||null},c.prototype.toString=function(){return"[Object GArrangeAction]"},e.exports=c},function(e,t,n){"use strict";n(19),n(24),n(45),n(3);var i=n(1),o=n(16),r=n(32),a=n(56),s=n(18),l=n(26);function c(e){this._boolOp=e,this._boolOp?this._title=new i.GLocaleKey("GMergeAction","".concat(c.TITLE,".op-").concat(this._boolOp)):this._title=new i.GLocaleKey("GMergeAction",c.TITLE),this._keyDownHandler=this._keyDown.bind(this),this._timeoutID=null,c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:{NaN:null,1:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GMergeAction","union-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GMergeAction","union-tooltip-description")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Boolean_Union.mp4",middle:!1,learnMore:"https://documentation.designer.io/basics/compound-shapes-boolean-operations/"}),2:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GMergeAction","difference-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GMergeAction","difference-tooltip-description")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Boolean_Difference.mp4",middle:!1,learnMore:"https://documentation.designer.io/basics/compound-shapes-boolean-operations/"}),3:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GMergeAction","intersect-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GMergeAction","intersect-tooltip-description")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Boolean_Intersect.mp4",middle:!1,learnMore:"https://documentation.designer.io/basics/compound-shapes-boolean-operations/"}),4:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GMergeAction","substract-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GMergeAction","substract-tooltip-description")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Boolean_Subtract.mp4",middle:!1,learnMore:"https://documentation.designer.io/basics/compound-shapes-boolean-operations/"})}}}i.GObject.inherit(c,l),c.ID="modify.merge",c.TITLE="title",c.SHORTCUT=[o.GKey.Constant.SHIFT,o.GKey.Constant.META,o.GKey.Constant.Y],c.TOOLTIP_CONFIG=null,c.prototype._title=null,c.prototype._id=null,c.prototype._boolOp=null,c.getId=function(e){return e?"".concat(c.ID,".op-").concat(e):c.ID},c.prototype.getId=function(){return c.getId(this._boolOp)},c.prototype.getTitle=function(){return this._title},c.prototype.getIcon=function(){switch(this._boolOp){case i.GVertexPolyBoolean.AND:return"gravit-icon-merge-intersect";case i.GVertexPolyBoolean.XOR:return"gravit-icon-merge-difference";case i.GVertexPolyBoolean.SUB:return"gravit-icon-merge-subtract";case i.GVertexPolyBoolean.OR:return"gravit-icon-merge-union";default:return l.prototype.getIcon.call(this)}},c.prototype.getCategory=function(){return this._boolOp?s.CATEGORY_MODIFY_COMBINE:s.CATEGORY_MODIFY},c.prototype.getGroup=function(){return this._boolOp?"structure-boolean/combine":"structure-group"},c.prototype.getShortcut=function(){return this._boolOp?[]:c.SHORTCUT},c.prototype._getValidItems=function(e,t){var n=[];if(e instanceof i.GGroup||e instanceof i.GCompoundShape)for(var o=e.getFirstChild();null!==o;o=o.getNext())n=n.concat(this._getValidItems(o));else e.hasMixin(i.GVertexSource)&&e.validateInsertion(new i.GCompoundShape)&&n.push(e);return n},c.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection(),n=[];if(t&&t.length){for(var o=0;o<t.length;++o){var r=t[o];if((n=n.concat(this._getValidItems(r))).length>1)return!0}if(1===n.length)return(r=n[0])instanceof i.GCompoundShape||r.getParent()instanceof i.GCompoundShape}}return!1},c.prototype.executeFromShortcut=function(){this._reset(),this.getId()===c.ID&&(document.addEventListener("keydown",this._keyDownHandler,!0),this._timeoutID=setTimeout(()=>{this._reset()},l.SHORTCUT_DELAY)),this.execute.apply(this,arguments)},c.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=i.GNode.order(e.getIndividualSelection().slice());e.beginTransaction();try{if(1===t.length&&(t[0]instanceof i.GCompoundShape||1===this._getValidItems(t[0]).length)&&this._boolOp){if((c=t[0]).getParent()instanceof i.GCompoundShape&&(c instanceof i.GCompoundShape||c.hasMixin(i.GVertexSource)&&!(c instanceof i.GGroup)))c.setProperty("bool",this._boolOp);else if(c instanceof i.GCompoundShape&&c.getFirstChild())for(var n=c.getFirstChild().getNext();null!==n;n=n.getNext())n.setProperty("bool",this._boolOp)}else{for(var o,a=new i.GCompoundShape,s=[],l=0;l<t.length;++l){var c=t[l];s=s.concat(this._getValidItems(c))}if(s.length>1){for(var d=t[t.length-1],u=d.getParent(),p=d.getNext();!a.validateInsertion(u);)p=u.getNext(),u=u.getParent();if(!u)return;u.insertChild(a,p);try{var g=[],h=[];o=new Set;var f=null;for(l=0;l<s.length;l++){(c=s[l]).getParent()instanceof i.GCompoundShape?(g.push(c),f||(f=c.getParent())):h.push(c),o.add(c.getParent())}s=g.concat(h);var m=f||s[0];if((0,r.blockChanges)(e,o,null,a),a.assignStyleFrom(m),m instanceof i.GText){var y=m;if(!y.getPaintLayers().getFillLayers(!0).length&&y.getProperty("_fc")){a.getPaintLayers().clearFillLayers();var v="string"==typeof y.getProperty("_fc")?i.GRGBColor.fromCSSColor(y.getProperty("_fc")):y.getProperty("_fc");a.getPaintLayers().appendChild(new i.GStylable.FillPaintLayer(v))}}for(l=0;l<s.length;++l){var _,b=(c=s[l]).getParent();for(b===f||b instanceof i.GCompoundShape&&this._boolOp===i.GVertexPolyBoolean.OR||(this._boolOp?c.setProperty("bool",this._boolOp):c.setProperty("bool",i.GVertexPolyBoolean.OR)),b.removeChild(c);(b instanceof i.GGroup||b instanceof i.GCompoundShape)&&!b.getFirstChild();)_=b,(b=b.getParent()).removeChild(_);a.appendChild(c)}}finally{(0,r.releaseChanges)(e,o,null,a)}e.updateSelection(!1,[a])}}}finally{e.commitTransaction(this._boolOp?"Combine":"Merge")}},c.prototype._keyDown=function(e){let t;switch(e.preventDefault(),e.stopPropagation(),this._reset(),o.GKey.translateCode(e.code)){case o.GKey.Constant.I:t=i.GVertexPolyBoolean.AND;break;case o.GKey.Constant.S:t=i.GVertexPolyBoolean.SUB;break;case o.GKey.Constant.U:t=i.GVertexPolyBoolean.OR;break;case o.GKey.Constant.X:t=i.GVertexPolyBoolean.XOR;break;default:t=null}t&&gDesigner.executeAction(c.prototype.getId.apply({_boolOp:t}))},c.prototype._reset=function(){document.removeEventListener("keydown",this._keyDownHandler,!0),this._timeoutID&&clearTimeout(this._timeoutID)},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]&&c.TOOLTIP_CONFIG[e][parseInt(this._boolOp)]||null},c.prototype.toString=function(){return"[Object GMergeAction]"},e.exports=c},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(56),s=n(18),l=n(94);function c(){c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSplitAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSplitAction","tooltip-description")),shortcut:c.SHORTCUT,learnMore:"https://documentation.designer.io/organizing-your-designs/groups/"})}}i.GObject.inherit(c,l),c.ID="modify.split",c.TITLE=new i.GLocaleKey("GSplitAction","title"),c.SHORTCUT=[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"G"],c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getIcon=function(){return"gravit-icon-ungroup"},c.prototype.getCategory=function(){return s.CATEGORY_MODIFY},c.prototype.getGroup=function(){return"structure-group"},c.prototype.getShortcut=function(){return c.SHORTCUT},c.prototype.isEnabled=function(){if(!l.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t)for(var n=0;n<t.length;++n){var o=t[n];if(o instanceof i.GGroup||o instanceof i.GCompoundShape||o instanceof i.GSymbol&&!o.getMasterSymbol()||o instanceof i.GShape&&null!==o.getFirstChild())return!0}}return!1},c.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=e.getIndividualSelection().slice();e.beginTransaction();try{var n,o,a=[],s=gDesigner.getActiveDocument().getScene();e.clearSelection();try{o=new Set;for(var l=0;l<t.length;++l)((n=t[l])instanceof i.GShape&&null!==n.getFirstChild()||n instanceof i.GGroup||n instanceof i.GCompoundShape||n instanceof i.GSymbol&&!n.getMasterSymbol())&&o.add(n.getParent());(0,r.blockChanges)(e,o,s);for(l=0;l<t.length;++l)if((n=t[l])instanceof i.GGroup||n instanceof i.GCompoundShape||n instanceof i.GSymbol&&!n.getMasterSymbol()){var d=n.getParent(),u=n.getChildren();try{n.beginUpdate();for(var p=0;p<u.length;++p){var g=u[p];n.removeChild(g),d.insertChild(g,n),a.push(g)}}finally{n.endUpdate()}d.removeChild(n)}else if(n instanceof i.GShape&&null!==n.getFirstChild()){d=n.getParent(),u=n.getChildren();try{n.beginUpdate();for(p=u.length-1;p>=0;--p){g=u[p];n.removeChild(g),d.insertChild(g,n.getNext()),a.push(g)}}finally{n.endUpdate()}a.push(n)}else a.push(n)}finally{(0,r.releaseChanges)(e,o,s)}a.length>0&&e.updateSelection(!1,a)}finally{e.commitTransaction(i.GLocale.get(c.TITLE))}},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GSplitAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(56),a=n(18),s=n(26);function l(e){this._type=e,this._title=new o.GLocaleKey("GTransformAction","title."+e),l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:{[l.Type.Rotate45Left]:null,[l.Type.Rotate90Left]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformAction","rotate-90-left-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformAction","rotate-90-left-tooltip-description")),learnMore:"https://documentation.designer.io/basics/moving-transforming-and-arranging-objects/#rotating-objects"}),[l.Type.Rotate180Left]:null,[l.Type.Rotate45Right]:null,[l.Type.Rotate90Right]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformAction","rotate-90-right-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformAction","rotate-90-right-tooltip-description")),learnMore:"https://documentation.designer.io/basics/moving-transforming-and-arranging-objects/#rotating-objects"}),[l.Type.Rotate180Right]:null,[l.Type.FlipVertical]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformAction","flip-vertical-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformAction","flip-vertical-tooltip-description")),learnMore:"https://documentation.designer.io/basics/moving-transforming-and-arranging-objects/#flipping-objects"}),[l.Type.FlipHorizontal]:r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformAction","flip-horizontal-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformAction","flip-horizontal-tooltip-description")),learnMore:"https://documentation.designer.io/basics/moving-transforming-and-arranging-objects/#flipping-objects"})}}}o.GObject.inherit(l,s),l.Type={Rotate45Left:"rotate-45-left",Rotate90Left:"rotate-90-left",Rotate180Left:"rotate-180-left",Rotate45Right:"rotate-45-right",Rotate90Right:"rotate-90-right",Rotate180Right:"rotate-180-right",FlipVertical:"flip-vertical",FlipHorizontal:"flip-horizontal"},l.TOOLTIP_CONFIG=null,l.ID="arrange.transform",l.prototype._type=null,l.prototype._title=null,l.prototype.getId=function(){return l.ID+"."+this._type},l.prototype.getTitle=function(){return this._title},l.prototype.getIcon=function(){switch(this._type){case l.Type.Rotate90Left:case l.Type.Rotate90Right:return"gravit-icon-rotate";case l.Type.FlipVertical:return"gravit-icon-flip-vertical";case l.Type.FlipHorizontal:return"gravit-icon-flip-horizontal";default:return null}},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_TRANSFORM},l.prototype.getGroup=function(){var e="";switch(this._type){case l.Type.Rotate45Left:case l.Type.Rotate90Left:case l.Type.Rotate180Left:e="rotate-left";break;case l.Type.Rotate45Right:case l.Type.Rotate90Right:case l.Type.Rotate180Right:e="rotate-right";break;case l.Type.FlipVertical:case l.Type.FlipHorizontal:e="flip"}return"arrange/transform-"+e},l.prototype.getShortcut=function(){return null},l.prototype.isEnabled=function(e){let t=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null)||[];return t=t.filter(e=>{var t=i.GElementEditor.getEditor(e);return t&&(t.hasFlag(i.GBoxEditor.Flag.RotateCorners)||t.hasFlag(i.GBoxEditor.Flag.RotateHandle))}),t.length>0},l.prototype.execute=function(e){var t=gDesigner.getActiveDocument(),n=t.getScene();e||(e=t.getEditor().getSelection()),e=(e=t.getEditor().filterIndividualElements(e)).filter(e=>{var t=i.GElementEditor.getEditor(e);return t&&(t.hasFlag(i.GBoxEditor.Flag.RotateCorners)||t.hasFlag(i.GBoxEditor.Flag.RotateHandle))});var r=i.GEditor.getGroupGeometryBBox(e);r&&i.GEditor.tryRunTransaction(n,function(){for(var t=0;t<e.length;++t){var n=e[t];if(n.hasMixin(o.GElement.Transform)&&r){var i=r.getSide(o.GRect.Side.CENTER),a=0,s=1,c=1;switch(this._type){case l.Type.Rotate45Left:a=-45;break;case l.Type.Rotate90Left:a=-90;break;case l.Type.Rotate180Left:a=-180;break;case l.Type.Rotate45Right:a=45;break;case l.Type.Rotate90Right:a=90;break;case l.Type.Rotate180Right:a=180;break;case l.Type.FlipVertical:c=-1;break;case l.Type.FlipHorizontal:s=-1}var d=(new o.GTransform).translated(-i.getX(),-i.getY()).scaled(s,c).rotated(o.GMath.toRadians(a)).translated(i.getX(),i.getY());n.transform(d,!0)}}}.bind(this),o.GLocale.get(this.getTitle()))},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]&&l.TOOLTIP_CONFIG[e][this._type]||null},l.prototype.toString=function(){return"[Object GTransformAction]"},e.exports=l},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(32),r=n(56),a=n(18),s=n(94);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GVectorizeBorderAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GVectorizeBorderAction","tooltip-description")),learnMore:"https://documentation.designer.io/basics/modify-paths/#vectorize-borders"})}}i.GObject.inherit(l,s),l.ID="modify.vectorize",l.TITLE=new i.GLocaleKey("GVectorizeBorderAction","title"),l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},l.prototype.getGroup=function(){return"structure/modify"},l.prototype.getIcon=function(){return"gravit-icon-vectorize-border"},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null,t=!1;if(e)for(var n=0;!t&&n<e.length;++n)if(!(e[n]instanceof i.GImage)&&e[n].hasMixin(i.GVertexSource)&&e[n].hasMixin(i.GStylable)){var o=e[n].getPaintLayers(),r=o?o.getBorderLayers(!0):null;t=r&&r.length>=1}return t},l.prototype.execute=function(){var e,t=gDesigner.getActiveDocument(),n=t?t.getEditor():null,r=(t&&t.getScene(),n?n.getIndividualSelection():null),a=[];if(r)for(var s=0;s<r.length;++s){var l=r[s];!l.hasMixin(i.GVertexSource)||l instanceof i.GImage||!l.hasMixin(i.GStylable)||a.push(l)}if(a.length){var c=function(e,t){if(t instanceof i.GPath)e.getPaths().appendChild(t);else for(var n,o=t.cloneSubPaths(),r=o.getFirstChild();null!==r;r=n)n=r.getNext(),o.removeChild(r),e.getPaths().appendChild(r)};n.beginTransaction();try{var d,u=[],p=function(e){var t=e.getProperty("_ba"),n=e.getProperty("_bw");n=n||1;var o,r=t==i.GStylable.BorderAlignment.Center?.5*n:n,a=new i.GVertexOffsetter(i.GPathUtil.makeClockWise(d),r,t!=i.GStylable.BorderAlignment.Outside,t!=i.GStylable.BorderAlignment.Inside,0,e.getProperty("_blc"),e.getProperty("_bml"));if(t==i.GStylable.BorderAlignment.Center)o=i.GPathUtil.createPathFromVertexSource(a);else{var s=i.GPathUtil.createPathFromVertexSource(d),l=i.GPathUtil.createPathFromVertexSource(a);s&&(o=new i.GCompoundPath,c(o,s),l&&c(o,l))}return o&&(i.GElement.prototype.assignFrom.call(o,d),o.getPaintLayers().clearLayers(),e.$_pt&&o.getPaintLayers().appendChild(new i.GStylable.FillPaintLayer(e.$_pt))),o};e=new Set;for(s=0;s<a.length;++s){var g=a[s].getParent();g&&e.add(g)}try{(0,o.blockChanges)(n,e);for(s=0;s<a.length;++s){var h=(d=a[s]).getParent(),f=d.getNext(),m=null,y=d.getPaintLayers().getBorderLayers(!0);if(y.length>1)i.GUtil.each(y,(function(e,t){var n=p(t);n&&(m||(m=new i.GGroup),m.appendChild(n))}));else if(1==y.length){var v=y.pop();m=p(v)}m?(h.insertChild(m,f),u.push(m),h.removeChild(d)):u.push(d)}}finally{(0,o.releaseChanges)(n,e),u.length&&n.updateSelection(!1,u)}}finally{n.commitTransaction(i.GLocale.get(this.getTitle()))}}},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GVectorizeBorderAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.split-path",s.TITLE=new i.GLocaleKey("GSplitPathAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY_PATH},s.prototype.getGroup=function(){return"structure/path"},s.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"J"]},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-split-path":null},s.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t)for(var n=0;n<t.length;++n)if(t[n]instanceof i.GCompoundPath)return!0}return!1},s.prototype.execute=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument().getEditor(),t=e.getSelection().slice();if(t&&t.length){e.beginTransaction();try{for(var n=[],o=0;o<t.length;++o){var r=t[o];if(r instanceof i.GCompoundPath){var s=new i.GRectangle;i.GElement.prototype.assignFrom.call(s,r);var l=e.splitCompoundPath(r);if(l&&l.length)for(var c=0;c<l.length;++c){var d=l[c];i.GElement.prototype.assignFrom.call(d,s),n.push(d)}}}n.length&&e.updateSelection(!1,n)}finally{e.commitTransaction(i.GLocale.get(this.getTitle()))}}},s.prototype.toString=function(){return"[Object GSplitPathAction]"},e.exports=s},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1),o=n(16),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.detachsymbol",s.TITLE=new i.GLocaleKey("GDetachSymbolAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY_SYMBOL},s.prototype.getGroup=function(){return"structure/modify"},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-detach-symbol":null},s.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,o.GKey.Constant.F8]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t&&t.length)for(var n=t.length-1;n>=0;--n){var o=t[n];if(o instanceof i.GSymbol&&!o.isMaster()&&o.getMasterSymbol())return!0}}return!1},s.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=i.GNode.order(e.getIndividualSelection().slice());if(t.length&&t[0].getScene()){e.beginTransaction();try{for(var n=0,o=0;o<t.length;++o){var r=t[o];r instanceof i.GSymbol&&r.detach()&&n++}}finally{e.commitTransaction(i.GLocale.get(new i.GLocaleKey("GDetachSymbolAction","text.number-detached")).replace("%number",n>1?"s":""))}}},s.prototype.toString=function(){return"[Object GDetachSymbolAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="edit.paste.style",s.TITLE=new i.GLocaleKey("GPasteStyleAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_PASTE},s.prototype.getGroup=function(){return"ccp/paste"},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-paste-style":null},s.prototype.getShortcut=function(){return[o.GKey.Constant.F4]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getClipboardMimeTypes();if(e&&e.indexOf(i.GNode.MIME_TYPE)>=0){var t=gDesigner.getActiveDocument();if(t){var n=t.getEditor().getIndividualSelection();if(n)for(var o=0;o<n.length;++o)if(n[o].hasMixin(i.GStylable))return!0}}return!1},s.prototype.execute=function(){var e=i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE));if((e=gDesigner.getActiveDocument().filterUnrestrictedCommercialFileElements(e))&&e.length>0){for(var t=null,n=0;n<e.length;++n)if(e[n].hasMixin(i.GStylable)){t=e[n];break}if(!t)return;var o=gDesigner.getActiveDocument().getEditor(),r=o.getIndividualSelection();t instanceof i.GText&&gDesigner.getActiveDocument().getScene().getActivePage().appendChild(t),o.beginTransaction();try{for(n=0;n<r.length;++n){var a=r[n];a.hasMixin(i.GStylable)&&a.assignStyleFrom(t)}}finally{o.commitTransaction(i.GLocale.get(this.getTitle())),t instanceof i.GText&&gDesigner.getActiveDocument().getScene().getActivePage().removeChild(t)}}},s.prototype.toString=function(){return"[Object GPasteStyleAction]"},e.exports=s},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=n(16);const r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="edit.paste.replace",s.TITLE=new i.GLocaleKey("GPasteAndReplaceAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-paste-and-replace":null},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_PASTE},s.prototype.getGroup=function(){return"ccp/paste"},s.prototype.getShortcut=function(){return[o.GKey.Constant.OPTION,o.GKey.Constant.COMMAND,"V"]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=t&&t.getSelection();if(n&&n.length>0){if(document.queryCommandSupported("paste"))return!0;const e=gDesigner.getClipboardMimeTypes();if(e&&e.indexOf(i.GNode.MIME_TYPE)>=0)return!0}return!1},s.prototype.execute=function(){gDesigner.getPaste().assignCallback(this._paste.bind(this)),!gDesigner.isTouchDevice()&&document.execCommand("paste")||(gDesigner.getPaste().assignCallback(null),this._paste(i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE))))},s.prototype._paste=function(e){if(e&&e.length>0){const t=gDesigner.getActiveDocument();if(!t)return;const n=t&&t.getEditor();if(!n||!n.hasSelection())return;const o=t.filterUnrestrictedCommercialFileElements(e.filter(e=>e instanceof i.GElement));if(o.length>0){n.beginTransaction();try{let e=[];const t=n.getSelection().slice();this._fixTexts(o),t.forEach(t=>{const n=this._replace(t,o);n&&n.length>0&&(e=e.concat(n))}),n.insertElements(e,!0,!0,!1,!0)}finally{n.commitTransaction(i.GLocale.get(this.getTitle()))}}}},s.prototype._fixTexts=function(e){const t=gDesigner.getActiveDocument(),n=t&&t.getEditor();n&&e.forEach(e=>{e.accept(t=>{if(t instanceof i.GText)return n.insertElements([e],!0,!0,!1),e.getParent().removeChild(e),!1})})},s.prototype._replace=function(e,t){const n=this._getBoundingBox(t);if(!n)return;const o=e.getGeometryBBox(),r=new i.GTransform(1,0,0,1,o.getX()-n.getX(),o.getY()-n.getY()),a=this._clone(t);return a.forEach(e=>{e.hasMixin(i.GElement.Transform)&&e.transform(r,!0)}),e.getParent().removeChild(e),a},s.prototype._clone=function(e){return e.map(e=>e.clone())},s.prototype._getBoundingBox=function(e){let t;return e.forEach(e=>{const n=e.getGeometryBBox();n&&!n.isEmpty()&&(t=t?t.united(n):n)}),t},s.prototype.toString=function(){return"[Object GPasteAndReplaceAction]"},e.exports=s},function(e,t,n){"use strict";n(3);n(43);var i=n(1),o=n(16),r=n(18),a=n(26);n(36);function s(){}i.GObject.inherit(s,a),s.ID="paste.paste",s.TITLE=new i.GLocaleKey("GPasteAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getIcon=function(){return"gravit-icon-paste"},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_PASTE},s.prototype.getGroup=function(){return"ccp/paste"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"V"]},s.prototype.isEnabled=function(){return!!gDesigner.getActiveDocument()},s.prototype.executeFromShortcut=function(){var e=gDesigner.getPaste(),t=null;return e&&(e.assignCallback(null),t=e.getArea()),document.activeElement&&$(document.activeElement).is(":editable")&&!gDesigner.isGravitIME(document.activeElement)||t&&(e.setAllowFocus(!0),t.focus()),!1},s.prototype.execute=function(){gDesigner.getClipboardContent(i.GNode.MIME_TYPE)&&(gDesigner.getPaste().assignCallback(null),gDesigner.getPaste().handlePasteData({[i.GNode.MIME_TYPE]:gDesigner.getClipboardContent(i.GNode.MIME_TYPE)}))},s.prototype.toString=function(){return"[Object GPasteAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17),o=n(12),r=i(n(1451));e.exports=class{constructor(e){this._target=e,this._lastTouchStartEvent=0,this._touchmoved=!1,this._touchStartX=0,this._touchStartY=0,this._handleEventBound=this._tryHandleEvent.bind(this),this._handleScrollEventBound=this._handleScrollEvent.bind(this),this._gestureHelper=new r.default,this.activate(e)}addGesture(e){this._gestureHelper.addGesture(e)}setDelayedTouchEventsEnabled(e){this._gestureHelper.setDelayedTouchEventsEnabled(e)}setClickSuppressionEnabled(e){this._gestureHelper.setClickSuppressionEnabled(e),document.removeEventListener("scroll",this._handleScrollEventBound,!0),e&&document.addEventListener("scroll",this._handleScrollEventBound,!0)}activate(e){this.deactivate(this._target),this._target=e,this._target&&(this._target.addEventListener("touchstart",this._handleEventBound),this._target.addEventListener("touchmove",this._handleEventBound),this._target.addEventListener("touchend",this._handleEventBound),this._target.addEventListener("touchcancel",this._handleEventBound),this._target.addEventListener("gesturestart",this._handleEventBound))}deactivate(e){const t=e||this._target;t&&(t.removeEventListener("touchstart",this._handleEventBound),t.removeEventListener("touchmove",this._handleEventBound),t.removeEventListener("touchend",this._handleEventBound),t.removeEventListener("touchcancel",this._handleEventBound),t.removeEventListener("gesturestart",this._handleEventBound)),document.removeEventListener("scroll",this._handleScrollEventBound,!0),this._target&&delete this._target}_tryHandleEvent(e){this._shouldHandle(e)&&this._handleEvent(e)}_handleEvent(e){switch(e.type){case"touchstart":this._touchStart(e);break;case"touchmove":this._touchMove(e);break;case"touchend":this._touchEnd(e);break;case"touchcancel":this._touchCancel(e);break;case"gesturestart":this._gestureStart(e)}}_touchStart(e){const t=e.targetTouches[0]||e.changedTouches[0];t?(this._touchStartX=t.clientX,this._touchStartY=t.clientY):(this._touchStartX=0,this._touchStartY=0),this._touchmoved=!1,this._gestureHelper.touchStart(e)}_touchMove(e){this._touchmoved=this._wasMoved(e),this._touchmoved&&this._gestureHelper.touchMove(e)}_touchEnd(e){this._touchmoved=!1,this._gestureHelper.touchEnd(e)}_touchCancel(e){this._gestureHelper.touchCancel(e)}_gestureStart(e){this._gestureHelper.gestureStart(e)}_handleScrollEvent(e){this._gestureHelper.scroll(e)}_wasMoved(e){const t=e.changedTouches[0],{clientX:n,clientY:i}=t;return!(Math.abs(n-this._touchStartX)<o.MIN_TOUCH_MOVE_DISTANCE&&Math.abs(i-this._touchStartY)<o.MIN_TOUCH_MOVE_DISTANCE)}_shouldHandle(e){return!e.defaultPrevented}}},function(e,t,n){"use strict";n(25);var i=n(1),o=n(16);const r=n(790);class a extends r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._lastClickPoint=null,this._lastClickEventTime=0,this._config=Object.assign({doubleTapDetection:a.DetectionMode.Target,doubleTapThreshold:0,doubleTapDelay:100},e)}canActivate(){return!0}start(e,t){this._doubleTapTouches=null,e.areThereTwoTouchPointsOnTheTarget()&&(this._doubleTapTouches=Array.from(e.getOriginalEvent().targetTouches)),this._doubleTapTouches||this._config.doubleTapDetection!==a.DetectionMode.Nearby||(this._doubleTapTouches=this._getTwoTouchPointsNearby(e.getOriginalEvent().touches)),this._doubleTapTouches?this._doubleTapTime=Date.now():e.iterateChangedTouches(e=>{this._dispatchEventFromTouch("mousedown",e,o.GMouseEvent.BUTTON_LEFT,!t.isSwiping())})}end(e,t){if(this._doubleTapTouches){return void(this._doubleTapTouches.every(e=>!t.hasActiveIdentifier(e))&&(this._doubleTapTouches=null,Date.now()-this._doubleTapTime<=this._config.doubleTapDelay&&e.iterateChangedTouches(e=>{this._dispatchEventFromTouch("mouseup",e)})))}if(e.iterateChangedTouches(e=>{this._dispatchEventFromTouch("mouseup",e,o.GMouseEvent.BUTTON_LEFT,!t.isSwiping())}),t.isSwiping())return;const n=Date.now();e.iterateChangedTouches(e=>{this._dispatchEventFromTouch("click",e)});const r=e.getOriginalEvent().changedTouches[0];r&&(this._doubleTapTouches||this._isDblClick(r,n)&&this._dispatchEventFromTouch("dblclick",r),this._lastClickEventTime=n,this._lastClickPoint=new i.GPoint(r.screenX,r.screenY))}cancel(e){e.iterateChangedTouches(e=>{this._dispatchEventFromTouch("mouseup",e)})}_isDblClick(e,t){if(this._lastClickPoint&&this._lastClickEventTime){if(i.GMath.ptDist(e.screenX,e.screenY,this._lastClickPoint.getX(),this._lastClickPoint.getY())<=25){if(t-this._lastClickEventTime<=300)return!0}}return!1}_getTwoTouchPointsNearby(e){const t=e.length;if(t>1)for(let n=0;n<t;n++)for(let o=n+1;o<t;o++){const t=e[n],r=e[o];if(i.GMath.ptDist(t.screenX,t.screenY,r.screenX,r.screenY)<=this._config.doubleTapThreshold)return[t,r]}return null}}a.DetectionMode={Target:0,Nearby:1},e.exports=a},function(e,t,n){"use strict";var i=n(16);e.exports=class{canActivate(){return!1}activate(e,t){this._active=!0}deactivate(e,t){this._active=!1}isActive(){return this._active}start(e,t){}move(e,t){}end(e,t){}cancel(e,t){}gesture(e,t){}_dispatchEventFromTouch(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.GMouseEvent.BUTTON_LEFT,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=document.createEvent("MouseEvent");r.initMouseEvent(e,!0,o,window,1,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,n,null),t.target.dispatchEvent(r)}}},function(e,t){e.exports=require("electron")},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.getCollabInfo=l,t.handleCollabsData=async function(e){if(!gDesigner.getActiveDocument()||!gDesigner.getActiveDocument().getStorageItem())return;let t=[];const n=e?await e:gDesigner.getShareManager().getCollaboratorsCached(gDesigner.getActiveDocument());if(n&&n.length)for(let e=0;e<n.length;e++){let i=n[e];if(!i.getRole().is(o.ShareRoles.Viewer)&&!i.getRole().is(o.ShareRoles.NoAccess)){let e=await l(i.getUID());t.push(r.default.createUserMention(i,e))}}let i,s,c,d,u=[];t.length&&(i=t.filter(e=>e.getRole().is(o.ShareRoles.Reviewer)),s=t.filter(e=>e.getRole().is(o.ShareRoles.Approver)),c=t.filter(e=>e.getRole().is(o.ShareRoles.CoAuthor)),d=t.filter(e=>e.getRole().is(o.ShareRoles.Owner)),i&&i.length&&u.push(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_REVIEWERS),s&&s.length&&u.push(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_APPROVERS),c&&c.length&&u.push(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_CO_AUTHORS),d&&d.length&&u.push(a.ADDITIONAL_COLLABORATORS.MENTION_OWNER),u.push(a.ADDITIONAL_COLLABORATORS.MENTION_ALL));return{data:t,allReviewers:i,allApprovers:s,allCoAuthors:c,owner:d,additionalMentions:u}},t.replaceAdditionalCollabShowTextBeforeSend=function(e){return this._mentionsCollection.forEach(t=>{t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL.id?e.replace(a.ADDITIONAL_COLLABORATORS.MENTION_ALL.showText,a.ADDITIONAL_COLLABORATORS.MENTION_ALL.id):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_OWNER.id?e.replace(a.ADDITIONAL_COLLABORATORS.MENTION_OWNER.showText,a.ADDITIONAL_COLLABORATORS.MENTION_OWNER.id):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_REVIEWERS.id?e.replace(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_REVIEWERS.showText,a.ADDITIONAL_COLLABORATORS.MENTION_ALL_REVIEWERS.id):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_APPROVERS.id?e.replace(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_APPROVERS.showText,a.ADDITIONAL_COLLABORATORS.MENTION_ALL_APPROVERS.id):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_CO_AUTHORS.id&&e.replace(a.ADDITIONAL_COLLABORATORS.MENTION_ALL_CO_AUTHORS.showText,a.ADDITIONAL_COLLABORATORS.MENTION_ALL_CO_AUTHORS.id)}),e},t.showAssigneeRow=function(e){if(!e||!e.length)return;e.mentionsInput("getMentions",e=>{if(this._mentionsCollection=e,this._mentionsCollection.length){this._assigneeRow.show();let e=this._mentionsCollection.reduce((e,t)=>{let n=[],i=e.map(e=>e.id);return n=t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_REVIEWERS.id&&this._mentionData&&this._mentionData.allReviewers&&this._mentionData.allReviewers.length?this._mentionData.allReviewers.filter(e=>!i.includes(e.id)):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_APPROVERS.id&&this._mentionData&&this._mentionData.allApprovers&&this._mentionData.allApprovers.length?this._mentionData.allApprovers.filter(e=>!i.includes(e.id)):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL_CO_AUTHORS.id&&this._mentionData&&this._mentionData.allCoAuthors&&this._mentionData.allCoAuthors.length?this._mentionData.allCoAuthors.filter(e=>!i.includes(e.id)):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_ALL.id?this._data.filter(e=>!i.includes(e.id)):t.id===a.ADDITIONAL_COLLABORATORS.MENTION_OWNER.id&&this._owner&&this._owner.length?this._owner.filter(e=>!i.includes(e.id)):i.includes(t.id)?[]:[t],e.push(...n),e},[]);if(1===e.length)this._assigneeSelector.hide(),this._onlyOneAssignee.html(e[0].name),this._onlyOneAssignee.show();else{this._onlyOneAssignee.hide();let t=this._assigneeSelector.find("select");t.find("option").remove(),e.forEach(e=>{t.append($("<option>").attr("value",e.id).text(e.name))}),this._assigneeSelector.show()}c.call(this,e[0].id)}else this._assigneeRow.hide(),this._shouldAssign=!1,this._assigneeCheckBox.prop("checked",this._shouldAssign)})},t.updateAssignee=c,n(9),n(171),n(58),n(19),n(24),n(28),n(14),n(29);var o=n(12),r=i(n(793)),a=n(1234);const s={};async function l(e){return s.hasOwnProperty(e)||(s[e]=o.gApi.getUser(e,!0).catch(()=>null)),s[e]}function c(e){e&&e.length&&(this._assignees=[e])}},function(e,t,n){"use strict";n(25);const i=n(175);class o extends i{constructor(){let{id:e,name:t,last_name:n,email:i,showText:o,avatar:r,role:a,fontWeight:s="normal",type:l="contact",trigger:c="@"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({id:e,name:t,last_name:n,email:i,showText:o,avatar:r,fontWeight:s,type:l,trigger:c}),this.value="",this._role=a}setValue(e){this.value=e}static createUserMention(e,t){let n=e.getFirstName();return new o({id:e.getUID(),name:n,last_name:e.getLastName(),showText:"@"+n,avatar:t?t.avatar:"assets/icon/notification-icon.svg",role:e.getRole(),email:e.getEmail()})}static clone(e){const t=new o;return Object.assign(t,e),t}}e.exports=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GGoogleAPI=t.GDefaultGoogleAPI=void 0,n(9),n(25);var i=n(12),o=n(1);class r{isLoaded(){return!0}init(){let{appId:e,apiKey:t,clientId:n,discoveryDocs:i,scope:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};throw"Not implemented"}isSignedIn(){throw"Not implemented"}listenSignInStateChanges(e){}install(e){}signIn(){throw"Not implemented"}signOut(){throw"Not implemented"}getTokenConfiguration(e){throw"Not implemented"}loadFilePicker(){throw"Not implemented"}openFilePicker(e,t){throw"Not implemented"}getBasicProfile(){throw"Not implemented"}getAccessToken(){throw"Not implemented"}getRefreshToken(){throw"Not implemented"}}t.GGoogleAPI=r;const a=new class extends r{isLoaded(){return!!window.gapi}init(){let{appId:e,apiKey:t,clientId:n,discoveryDocs:i,scope:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._appId=e,this._apiKey=t,this._clientId=n,this._discoveryDocs=i,this._scope=r,new Promise((e,a)=>{gapi.load("client:auth2",{callback:function(){gapi.client.init({apiKey:t,clientId:n,discoveryDocs:i,scope:r}).then(e,a)},timeout:2e4,ontimeout:function(){a(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))},onerror:function(){a(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))}})})}isSignedIn(){return!!this.isLoaded()&&gapi.auth2.getAuthInstance().isSignedIn.get()}listenSignInStateChanges(e){gapi.auth2.getAuthInstance().isSignedIn.listen(e)}install(e){return new Promise((t,n)=>{var i=document.createElement("script");i.async=!0,i.src="https://apis.google.com/js/api.js",i.onload=t,i.onerror=n,(e||document.getElementsByTagName("head")[0]).appendChild(i)})}signIn(){return gapi.auth2.getAuthInstance().signIn({prompt:"select_account"}).then(()=>{})}signOut(){return this._picker&&delete this._picker,gapi.auth2.getAuthInstance().signOut()}getTokenConfiguration(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse(!0);return Object.assign(e,{accessToken:t.access_token,expires:t.expires_at,corporate:!1})}loadFilePicker(){return new Promise((e,t)=>{gapi.load("picker",{timeout:2e4,callback:e,ontimeout:()=>t(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed"))),onerror:()=>t(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))})})}openFilePicker(e,t){try{const t=this.getAccessToken();this._picker||(this._picker=(0,i.GooglePickerBuilder)({appId:this._appId,apiKey:this._apiKey,accessToken:t,language:o.GLocale.getLanguage()})),this._picker.setCallback(t=>{t.action==google.picker.Action.PICKED&&e(t.docs)}),this._picker.setVisible(!0)}catch(e){t&&t(e)}}getBasicProfile(){const e=gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile();return{email:e.getEmail(),imageUrl:e.getImageUrl(),name:e.getName()}}getAccessToken(){return gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse(!0).access_token}getRefreshToken(){return gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse().then(e=>{let{access_token:t,expires_at:n}=e;return{expires:n,accessToken:t}})}};t.GDefaultGoogleAPI=a},function(e,t,n){n(313)("Float64",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUrlSafeBase64=t.isBase64=t.trim=t.decode=t.encode=void 0;var i={"+":"-","/":"_","=":"."},o={"-":"+",_:"/",".":"="};t.encode=function(e){return e.replace(/[+/=]/g,(function(e){return i[e]}))};t.decode=function(e){return e.replace(/[-_.]/g,(function(e){return o[e]}))};t.trim=function(e){return e.replace(/[.=]{1,2}$/,"")};t.isBase64=function(e){return/^[A-Za-z0-9+/]*[=]{0,2}$/.test(e)};t.isUrlSafeBase64=function(e){return/^[A-Za-z0-9_-]*[.]{0,2}$/.test(e)}},function(e,t,n){var i;e.exports=(i=n(46),n(342),n(940),n(941),n(245),n(246),n(484),n(649),n(942),n(650),n(943),n(944),n(945),n(485),n(946),n(213),n(87),n(947),n(948),n(949),n(950),n(951),n(952),n(953),n(954),n(955),n(956),n(957),n(958),n(959),n(960),n(961),n(962),i)},function(e,t,n){var i;e.exports=(i=n(46),function(){if("function"==typeof ArrayBuffer){var e=i.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,i=[],o=0;o<n;o++)i[o>>>2]|=e[o]<<24-o%4*8;t.call(this,i,n)}else t.apply(this,arguments)}).prototype=e}}(),i.lib.WordArray)},function(e,t,n){var i;e.exports=(i=n(46),function(){var e=i,t=e.lib.WordArray,n=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],o=0;o<n;o+=2){var r=t[o>>>2]>>>16-o%4*8&65535;i.push(String.fromCharCode(r))}return i.join("")},parse:function(e){for(var n=e.length,i=[],o=0;o<n;o++)i[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(i,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r+=2){var a=o(t[r>>>2]>>>16-r%4*8&65535);i.push(String.fromCharCode(a))}return i.join("")},parse:function(e){for(var n=e.length,i=[],r=0;r<n;r++)i[r>>>1]|=o(e.charCodeAt(r)<<16-r%2*16);return t.create(i,2*n)}}}(),i.enc.Utf16)},function(e,t,n){var i,o,r,a,s,l;e.exports=(l=n(46),n(649),o=(i=l).lib.WordArray,r=i.algo,a=r.SHA256,s=r.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),i.SHA224=a._createHelper(s),i.HmacSHA224=a._createHmacHelper(s),l.SHA224)},function(e,t,n){var i,o,r,a,s,l,c,d;e.exports=(d=n(46),n(342),n(650),o=(i=d).x64,r=o.Word,a=o.WordArray,s=i.algo,l=s.SHA512,c=s.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=l._doFinalize.call(this);return e.sigBytes-=16,e}}),i.SHA384=l._createHelper(c),i.HmacSHA384=l._createHmacHelper(c),d.SHA384)},function(e,t,n){var i;e.exports=(i=n(46),n(342),function(e){var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,a=t.x64.Word,s=t.algo,l=[],c=[],d=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var i=(2*e+3*t)%5;e=t%5,t=i}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,r=0;r<24;r++){for(var s=0,u=0,p=0;p<7;p++){if(1&o){var g=(1<<p)-1;g<32?u^=1<<g:s^=1<<g-32}128&o?o=o<<1^113:o<<=1}d[r]=a.create(s,u)}}();var u=[];!function(){for(var e=0;e<25;e++)u[e]=a.create()}();var p=s.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,i=this.blockSize/2,o=0;o<i;o++){var r=e[t+2*o],a=e[t+2*o+1];r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(P=n[o]).high^=a,P.low^=r}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var g=0,h=0,f=0;f<5;f++)g^=(P=n[p+5*f]).high,h^=P.low;var m=u[p];m.high=g,m.low=h}for(p=0;p<5;p++){var y=u[(p+4)%5],v=u[(p+1)%5],_=v.high,b=v.low;for(g=y.high^(_<<1|b>>>31),h=y.low^(b<<1|_>>>31),f=0;f<5;f++)(P=n[p+5*f]).high^=g,P.low^=h}for(var w=1;w<25;w++){var C=(P=n[w]).high,E=P.low,S=l[w];S<32?(g=C<<S|E>>>32-S,h=E<<S|C>>>32-S):(g=E<<S-32|C>>>64-S,h=C<<S-32|E>>>64-S);var G=u[c[w]];G.high=g,G.low=h}var A=u[0],T=n[0];for(A.high=T.high,A.low=T.low,p=0;p<5;p++)for(f=0;f<5;f++){var P=n[w=p+5*f],L=u[w],D=u[(p+1)%5+5*f],x=u[(p+2)%5+5*f];P.high=L.high^~D.high&x.high,P.low=L.low^~D.low&x.low}P=n[0];var I=d[s];P.high^=I.high,P.low^=I.low}},_doFinalize:function(){var t=this._data,n=t.words,i=(this._nDataBytes,8*t.sigBytes),r=32*this.blockSize;n[i>>>5]|=1<<24-i%32,n[(e.ceil((i+1)/r)*r>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],d=0;d<l;d++){var u=a[d],p=u.high,g=u.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),g=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),c.push(g),c.push(p)}return new o.init(c,s)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=r._createHelper(p),t.HmacSHA3=r._createHmacHelper(p)}(Math),i.SHA3)},function(e,t,n){var i;e.exports=(i=n(46),function(e){var t=i,n=t.lib,o=n.WordArray,r=n.Hasher,a=t.algo,s=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),d=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=o.create([0,1518500249,1859775393,2400959708,2840853838]),p=o.create([1352829926,1548603684,1836072691,2053994217,0]),g=a.RIPEMD160=r.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var i=t+n,o=e[i];e[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var r,a,g,b,w,C,E,S,G,A,T,P=this._hash.words,L=u.words,D=p.words,x=s.words,I=l.words,O=c.words,k=d.words;for(C=r=P[0],E=a=P[1],S=g=P[2],G=b=P[3],A=w=P[4],n=0;n<80;n+=1)T=r+e[t+x[n]]|0,T+=n<16?h(a,g,b)+L[0]:n<32?f(a,g,b)+L[1]:n<48?m(a,g,b)+L[2]:n<64?y(a,g,b)+L[3]:v(a,g,b)+L[4],T=(T=_(T|=0,O[n]))+w|0,r=w,w=b,b=_(g,10),g=a,a=T,T=C+e[t+I[n]]|0,T+=n<16?v(E,S,G)+D[0]:n<32?y(E,S,G)+D[1]:n<48?m(E,S,G)+D[2]:n<64?f(E,S,G)+D[3]:h(E,S,G)+D[4],T=(T=_(T|=0,k[n]))+A|0,C=A,A=G,G=_(S,10),S=E,E=T;T=P[1]+g+G|0,P[1]=P[2]+b+A|0,P[2]=P[3]+w+C|0,P[3]=P[4]+r+E|0,P[4]=P[0]+a+S|0,P[0]=T},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,i=8*e.sigBytes;t[i>>>5]|=128<<24-i%32,t[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,r=o.words,a=0;a<5;a++){var s=r[a];r[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function f(e,t,n){return e&t|~e&n}function m(e,t,n){return(e|~t)^n}function y(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function _(e,t){return e<<t|e>>>32-t}t.RIPEMD160=r._createHelper(g),t.HmacRIPEMD160=r._createHmacHelper(g)}(Math),i.RIPEMD160)},function(e,t,n){var i,o,r,a,s,l,c,d,u;e.exports=(u=n(46),n(484),n(485),o=(i=u).lib,r=o.Base,a=o.WordArray,s=i.algo,l=s.SHA1,c=s.HMAC,d=s.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,i=c.create(n.hasher,e),o=a.create(),r=a.create([1]),s=o.words,l=r.words,d=n.keySize,u=n.iterations;s.length<d;){var p=i.update(t).finalize(r);i.reset();for(var g=p.words,h=g.length,f=p,m=1;m<u;m++){f=i.finalize(f),i.reset();for(var y=f.words,v=0;v<h;v++)g[v]^=y[v]}o.concat(p),l[0]++}return o.sigBytes=4*d,o}}),i.PBKDF2=function(e,t,n){return d.create(n).compute(e,t)},u.PBKDF2)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.mode.CFB=function(){var e=i.lib.BlockCipherMode.extend();function t(e,t,n,i){var o=this._iv;if(o){var r=o.slice(0);this._iv=void 0}else r=this._prevBlock;i.encryptBlock(r,0);for(var a=0;a<n;a++)e[t+a]^=r[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize;t.call(this,e,n,o,i),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,r=e.slice(n,n+o);t.call(this,e,n,o,i),this._prevBlock=r}}),e}(),i.mode.CFB)},function(e,t,n){var i,o,r;e.exports=(r=n(46),n(87),r.mode.CTR=(i=r.lib.BlockCipherMode.extend(),o=i.Encryptor=i.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,r=this._counter;o&&(r=this._counter=o.slice(0),this._iv=void 0);var a=r.slice(0);n.encryptBlock(a,0),r[i-1]=r[i-1]+1|0;for(var s=0;s<i;s++)e[t+s]^=a[s]}}),i.Decryptor=o,i),r.mode.CTR)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.mode.CTRGladman=function(){var e=i.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,i=255&e;255===t?(t=0,255===n?(n=0,255===i?i=0:++i):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=i}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var i=this._cipher,o=i.blockSize,r=this._iv,a=this._counter;r&&(a=this._counter=r.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);i.encryptBlock(s,0);for(var l=0;l<o;l++)e[n+l]^=s[l]}});return e.Decryptor=n,e}(),i.mode.CTRGladman)},function(e,t,n){var i,o,r;e.exports=(r=n(46),n(87),r.mode.OFB=(i=r.lib.BlockCipherMode.extend(),o=i.Encryptor=i.extend({processBlock:function(e,t){var n=this._cipher,i=n.blockSize,o=this._iv,r=this._keystream;o&&(r=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(r,0);for(var a=0;a<i;a++)e[t+a]^=r[a]}}),i.Decryptor=o,i),r.mode.OFB)},function(e,t,n){var i,o;e.exports=(o=n(46),n(87),o.mode.ECB=((i=o.lib.BlockCipherMode.extend()).Encryptor=i.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),i.Decryptor=i.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),i),o.mode.ECB)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,i=4*t,o=i-n%i,r=n+o-1;e.clamp(),e.words[r>>>2]|=o<<24-r%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.pad.Ansix923)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.pad.Iso10126={pad:function(e,t){var n=4*t,o=n-e.sigBytes%n;e.concat(i.lib.WordArray.random(o-1)).concat(i.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.pad.Iso10126)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.pad.Iso97971={pad:function(e,t){e.concat(i.lib.WordArray.create([2147483648],1)),i.pad.ZeroPadding.pad(e,t)},unpad:function(e){i.pad.ZeroPadding.unpad(e),e.sigBytes--}},i.pad.Iso97971)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},i.pad.ZeroPadding)},function(e,t,n){var i;e.exports=(i=n(46),n(87),i.pad.NoPadding={pad:function(){},unpad:function(){}},i.pad.NoPadding)},function(e,t,n){var i,o,r,a;e.exports=(a=n(46),n(87),o=(i=a).lib.CipherParams,r=i.enc.Hex,i.format.Hex={stringify:function(e){return e.ciphertext.toString(r)},parse:function(e){var t=r.parse(e);return o.create({ciphertext:t})}},a.format.Hex)},function(e,t,n){var i;e.exports=(i=n(46),n(245),n(246),n(213),n(87),function(){var e=i,t=e.lib.BlockCipher,n=e.algo,o=[],r=[],a=[],s=[],l=[],c=[],d=[],u=[],p=[],g=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,i=0;for(t=0;t<256;t++){var h=i^i<<1^i<<2^i<<3^i<<4;h=h>>>8^255&h^99,o[n]=h,r[h]=n;var f=e[n],m=e[f],y=e[m],v=257*e[h]^16843008*h;a[n]=v<<24|v>>>8,s[n]=v<<16|v>>>16,l[n]=v<<8|v>>>24,c[n]=v,v=16843009*y^65537*m^257*f^16843008*n,d[h]=v<<24|v>>>8,u[h]=v<<16|v>>>16,p[h]=v<<8|v>>>24,g[h]=v,n?(n=f^e[e[e[y^f]]],i^=e[e[i]]):n=i=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],f=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,i=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],a=0;a<i;a++)if(a<n)r[a]=t[a];else{var s=r[a-1];a%n?n>6&&a%n==4&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=o[(s=s<<8|s>>>24)>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=h[a/n|0]<<24),r[a]=r[a-n]^s}for(var l=this._invKeySchedule=[],c=0;c<i;c++)a=i-c,s=c%4?r[a]:r[a-4],l[c]=c<4||a<=4?s:d[o[s>>>24]]^u[o[s>>>16&255]]^p[o[s>>>8&255]]^g[o[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,l,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,d,u,p,g,r),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,i,o,r,a,s){for(var l=this._nRounds,c=e[t]^n[0],d=e[t+1]^n[1],u=e[t+2]^n[2],p=e[t+3]^n[3],g=4,h=1;h<l;h++){var f=i[c>>>24]^o[d>>>16&255]^r[u>>>8&255]^a[255&p]^n[g++],m=i[d>>>24]^o[u>>>16&255]^r[p>>>8&255]^a[255&c]^n[g++],y=i[u>>>24]^o[p>>>16&255]^r[c>>>8&255]^a[255&d]^n[g++],v=i[p>>>24]^o[c>>>16&255]^r[d>>>8&255]^a[255&u]^n[g++];c=f,d=m,u=y,p=v}f=(s[c>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&p])^n[g++],m=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[g++],y=(s[u>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&d])^n[g++],v=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^n[g++],e[t]=f,e[t+1]=m,e[t+2]=y,e[t+3]=v},keySize:8});e.AES=t._createHelper(f)}(),i.AES)},function(e,t,n){var i;e.exports=(i=n(46),n(245),n(246),n(213),n(87),function(){var e=i,t=e.lib,n=t.WordArray,o=t.BlockCipher,r=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=r.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var i=a[n]-1;t[n]=e[i>>>5]>>>31-i%32&1}for(var o=this._subKeys=[],r=0;r<16;r++){var c=o[r]=[],d=l[r];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+d)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+d)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var u=this._invSubKeys=[];for(n=0;n<16;n++)u[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),p.call(this,1,1431655765);for(var i=0;i<16;i++){for(var o=n[i],r=this._lBlock,a=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((a^o[l])&d[l])>>>0];this._lBlock=a,this._rBlock=r^s}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,p.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function g(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=o._createHelper(u);var h=r.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=u.createEncryptor(n.create(e.slice(0,2))),this._des2=u.createEncryptor(n.create(e.slice(2,4))),this._des3=u.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(h)}(),i.TripleDES)},function(e,t,n){var i;e.exports=(i=n(46),n(245),n(246),n(213),n(87),function(){var e=i,t=e.lib.StreamCipher,n=e.algo,o=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,i=this._S=[],o=0;o<256;o++)i[o]=o;o=0;for(var r=0;o<256;o++){var a=o%n,s=t[a>>>2]>>>24-a%4*8&255;r=(r+i[o]+s)%256;var l=i[o];i[o]=i[r],i[r]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=r.call(this)},keySize:8,ivSize:0});function r(){for(var e=this._S,t=this._i,n=this._j,i=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var r=e[t];e[t]=e[n],e[n]=r,i|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,i}e.RC4=t._createHelper(o);var a=n.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)r.call(this)}});e.RC4Drop=t._createHelper(a)}(),i.RC4)},function(e,t,n){var i;e.exports=(i=n(46),n(245),n(246),n(213),n(87),function(){var e=i,t=e.lib.StreamCipher,n=e.algo,o=[],r=[],a=[],s=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var i=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)o[n]^=i[n+4&7];if(t){var r=t.words,a=r[0],s=r[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=c>>>16|4294901760&d,p=d<<16|65535&c;for(o[0]^=c,o[1]^=u,o[2]^=d,o[3]^=p,o[4]^=c,o[5]^=u,o[6]^=d,o[7]^=p,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)o[i]=16711935&(o[i]<<8|o[i]>>>24)|4278255360&(o[i]<<24|o[i]>>>8),e[t+i]^=o[i]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)r[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],o=65535&i,s=i>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),i.Rabbit)},function(e,t,n){var i;e.exports=(i=n(46),n(245),n(246),n(213),n(87),function(){var e=i,t=e.lib.StreamCipher,n=e.algo,o=[],r=[],a=[],s=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)l.call(this);for(o=0;o<8;o++)i[o]^=n[o+4&7];if(t){var r=t.words,a=r[0],s=r[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),d=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),u=c>>>16|4294901760&d,p=d<<16|65535&c;for(i[0]^=c,i[1]^=u,i[2]^=d,i[3]^=p,i[4]^=c,i[5]^=u,i[6]^=d,i[7]^=p,o=0;o<4;o++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var i=0;i<4;i++)o[i]=16711935&(o[i]<<8|o[i]>>>24)|4278255360&(o[i]<<24|o[i]>>>8),e[t+i]^=o[i]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)r[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<r[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<r[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<r[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<r[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<r[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<r[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<r[6]>>>0?1:0)|0,this._b=t[7]>>>0<r[7]>>>0?1:0,n=0;n<8;n++){var i=e[n]+t[n],o=65535&i,s=i>>>16,l=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&i)*i|0)+((65535&i)*i|0);a[n]=l^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),i.RabbitLegacy)},function(e,t,n){"use strict";n(262);const{GObject:i,GLocale:o}=n(1),r=n(964);function a(e){let{id:t,level:n=0,name:i,description:o,status:a,pro:s=!1,assignable:l=!0,permissions:c}=e;r.call(this),this.id=t,this.name=i,this.description=o,this.status=a,this.pro=s,this.permissions=c,this.assignable=l,this.level=n}i.inheritAndMix(a,i,[r]),a.prototype.getPermissions=function(){return this.permissions},a.prototype.getDescription=function(){return this.description},a.prototype.getStatus=function(){return this.status},a.prototype.getName=function(){return this.name},a.prototype.getId=function(){return this.id},a.prototype.setId=function(e){this.id=e},a.prototype.getName=function(){return this.name},a.prototype.getLevel=function(){return this.level},a.prototype.isPro=function(){return this.pro},a.prototype.equals=function(e){return e.getId()===this.getId()},a.prototype.hasPermission=function(e){return!!this.permissions[e]},a.prototype.applyPermissions=function(e){this.permissions.applyFrom(e)},a.prototype.isAssignable=function(){return this.assignable},a.prototype.is=function(e){return this.getId()===e.id},e.exports=a},function(e,t,n){"use strict";n(28),n(19),n(9),n(24);const{GObject:i}=n(1),o=n(965);function r(){this._resourceMap=new o,this._controlSubjectState={locked:!1}}i.inherit(r,i),r.prototype._controlSubjectState=null,r.prototype.lockPermissions=function(){this._controlSubjectState.locked=!0,Object.freeze(this._controlSubjectState),Object.freeze(this._resourceMap)},r.prototype.grant=function(e,t){if(this._controlSubjectState.locked)return this;if((e=e instanceof Array?e:[e]).some(e=>this._resourceMap.has(e)))throw"Can't override an existing resource";return e.forEach(e=>this._resourceMap.set(e,t)),this},r.prototype.revoke=function(e){return this._controlSubjectState.locked||(e=e instanceof Array?e:[e]).forEach(e=>{this._resourceMap.has(e)&&this._resourceMap.delete(e)}),this},r.prototype.can=function(e){return e=e instanceof Array?e:[e],Promise.all(e.map(async e=>{if(!this._resourceMap.has(e))return!1;var t=this._resourceMap.get(e);return!t||!!await t(this,e)})).then(e=>e.every(e=>!!e))},r.prototype.canSync=function(e){return(e=e instanceof Array?e:[e]).every(e=>{if(!this._resourceMap.has(e))return!1;const t=this._resourceMap.get(e);if(!t)return!0;return!!t(this,e)})},r.prototype.extend=function(e){if(this._controlSubjectState.locked)return this;if(!(e instanceof r))throw"Not a valid instance to extend";const t=i(this._resourceMap),n=i(e._resourceMap);return this._resourceMap=new o(...t,...n),this;function i(e){return e instanceof Map?e:new Map(Object.entries(e))}},e.exports=r},function(e,t,n){"use strict";function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t&&this._updateFromArguments(t)}n(19),n(24),i.prototype._updateFromArguments=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=new Map(...t);var o=!1;const r=0,a=1,s=i.entries();let l=s.next();do{if(o=l.done,l.value){const e=l.value[r],t=l.value[a];this[e]=t,l=s.next()}}while(!o)},i.prototype.has=function(e){return this.hasOwnProperty(e)},i.prototype.delete=function(e){this.isFrozen()||delete this[e]},i.prototype.set=function(e,t){this.isFrozen()||(this[e]=t)},i.prototype.get=function(e){return this[e]},i.prototype.isFrozen=function(){return Object.isFrozen(this)},Object.freeze(i.prototype),e.exports=i},function(e,t,n){"use strict";n(25);const{GObject:i}=n(1);class o{constructor(e){Object.assign(this,e)}}i.inherit(o,i),o.prototype.applyFrom=function(e){Object.assign(this,e)},e.exports=o},function(e,t,n){"use strict";const{ShareRoles:{CoAuthor:i,Developer:o,Reviewer:r,Approver:a,Owner:s},GFileReviewActions:{ACTION_REQUEST_REVIEW:l,ACTION_REQUEST_APPROVAL:c,ACTION_REOPEN:d,ACTION_APPROVE:u}}=n(12),p=n(387);e.exports={[a.id]:[l,d,u,p.RESOLVE_COMMENT_ANNOTATION,p.RESOLVE_ALL_COMMENT_ANNOTATION,p.REOPEN_COMMENT_ANNOTATION],[i.id]:[p.DELETE_COMMENT_ANNOTATION],[o.id]:[p.DELETE_COMMENT_ANNOTATION,p.RESOLVE_COMMENT_ANNOTATION,p.REOPEN_COMMENT_ANNOTATION],[r.id]:[],[s.id]:[l,c,p.DELETE_COMMENT_ANNOTATION,p.RESOLVE_COMMENT_ANNOTATION,p.REOPEN_COMMENT_ANNOTATION]}},function(e,t,n){"use strict";e.exports={DELETE_COMMENT_ANNOTATION:"DELETE_COMMENT_ANNOTATION",RESOLVE_COMMENT_ANNOTATION:"RESOLVE_COMMENT_ANNOTATION",RESOLVE_ALL_COMMENT_ANNOTATION:"RESOLVE_ALL_COMMENT_ANNOTATION",REOPEN_COMMENT_ANNOTATION:"REOPEN_COMMENT_ANNOTATION"}},function(e,t,n){"use strict";const i=n(232);e.exports={NEWDOCUMENTDIALOG:{HR_UNDER_PRESETS:!1},OFFLINEDIALOG:{HAS_FOOTER:!0},PATHPROPERTIES:{PATH_JOIN_CLASS:""},PURCHASEPANEL:{HAS_PRODUCT_DESCRIPTION:!0,HAS_HIGHLIGHT:!1},SCENEPROPERTIES:{HAS_LOGO_UNDER_SYNC:!0},DESIGNER:{HIGHLIGHT_COLOR:void 0,GUIDELINE_COLOR:void 0,GUIDELINEHINT_COLOR:void 0,DISTANCEHELPER_COLOR:void 0,HIGHLIGHTOUTLINE_COLOR:void 0},USERLOGIN:{loadLogo:()=>$("<div/>").addClass("cloud-logo").load(i["cloud-logo"],()=>{}),OVERLAY_CLASS:""},BRAND_COLOR:"#d72e63",SHOW_BETA_BRANDING:!0}},function(e,t,n){"use strict";const i=new Proxy({},{get:(e,t)=>void 0!==e[t]?e[t]:t});e.exports=i},function(e){e.exports=JSON.parse('[{"family":"Noto Sans Adlam","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansAdlam-Regular.ttf"}],"preview":"assets/font/noto/NotoSansAdlam-Regular.svg","scripts":["ADLAM"]},{"family":"Noto Sans Arabic","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansArabic-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansArabic-Regular.ttf"}],"preview":"assets/font/noto/NotoSansArabic-Regular.svg","scripts":["ARABIC"]},{"family":"Noto Sans Armenian","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansArmenian-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansArmenian-Regular.ttf"}],"preview":"assets/font/noto/NotoSansArmenian-Regular.svg","scripts":["ARMENIAN"]},{"family":"Noto Sans Avestan","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansAvestan-Regular.ttf"}],"preview":"assets/font/noto/NotoSansAvestan-Regular.svg","scripts":["AVESTAN"]},{"family":"Noto Sans Balinese","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBalinese-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBalinese-Regular.svg","scripts":["BALINESE"]},{"family":"Noto Sans Bamum","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBamum-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBamum-Regular.svg","scripts":["BAMUM"]},{"family":"Noto Sans Batak","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBatak-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBatak-Regular.svg","scripts":["BATAK"]},{"family":"Noto Sans Bengali","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansBengali-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBengali-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBengali-Regular.svg","scripts":["BENGALI"]},{"family":"Noto Sans Brahmi","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBrahmi-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBrahmi-Regular.svg","scripts":["BRAHMI"]},{"family":"Noto Sans Buginese","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBuginese-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBuginese-Regular.svg","scripts":["BUGINESE"]},{"family":"Noto Sans Buhid","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansBuhid-Regular.ttf"}],"preview":"assets/font/noto/NotoSansBuhid-Regular.svg","scripts":["BUHID"]},{"family":"Noto Sans Cham","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansCham-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansCham-Regular.ttf"}],"preview":"assets/font/noto/NotoSansCham-Regular.svg","scripts":["CHAM"]},{"family":"Noto Sans Cherokee","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansCherokee-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansCherokee-Regular.ttf"}],"preview":"assets/font/noto/NotoSansCherokee-Regular.svg","scripts":["CHEROKEE"]},{"family":"Noto Sans CJK JP","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansCJKjp-Bold.otf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansCJKjp-Regular.otf"}],"preview":"assets/font/noto/NotoSansCJKjp-Regular.svg","scripts":["KATAKANA","HIRAGANA"]},{"family":"Noto Sans CJK KR","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansCJKkr-Bold.otf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansCJKkr-Regular.otf"}],"preview":"assets/font/noto/NotoSansCJKkr-Regular.svg","scripts":["HANGUL"]},{"family":"Noto Sans Coptic","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansCoptic-Regular.ttf"}],"preview":"assets/font/noto/NotoSansCoptic-Regular.svg","scripts":["COPTIC"]},{"family":"Noto Sans Devanagari","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansDevanagari-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansDevanagari-Regular.ttf"}],"preview":"assets/font/noto/NotoSansDevanagari-Regular.svg","scripts":["DEVANAGARI"]},{"family":"Noto Sans Georgian","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansGeorgian-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansGeorgian-Regular.ttf"}],"preview":"assets/font/noto/NotoSansGeorgian-Regular.svg","scripts":["GEORGIAN"]},{"family":"Noto Sans Hebrew","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansHebrew-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansHebrew-Regular.ttf"}],"preview":"assets/font/noto/NotoSansHebrew-Regular.svg","scripts":["HEBREW"]},{"family":"Noto Sans Javanese","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansJavanese-Regular.ttf"}],"preview":"assets/font/noto/NotoSansJavanese-Regular.svg","scripts":["JAVANESE"]},{"family":"Noto Sans Kaithi","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansKaithi-Regular.ttf"}],"preview":"assets/font/noto/NotoSansKaithi-Regular.svg","scripts":["KAITHI"]},{"family":"Noto Sans Kannada","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansKannada-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansKannada-Regular.ttf"}],"preview":"assets/font/noto/NotoSansKannada-Regular.svg","scripts":["KANNADA"]},{"family":"Noto Sans Khmer","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansKhmer-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansKhmer-Regular.ttf"}],"preview":"assets/font/noto/NotoSansKhmer-Regular.svg","scripts":["KHMER"]},{"family":"Noto Sans Lao","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansLao-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansLao-Regular.ttf"}],"preview":"assets/font/noto/NotoSansLao-Regular.svg","scripts":["LAO"]},{"family":"Noto Sans Lepcha","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansLepcha-Regular.ttf"}],"preview":"assets/font/noto/NotoSansLepcha-Regular.svg","scripts":["LEPCHA"]},{"family":"Noto Sans Limbu","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansLimbu-Regular.ttf"}],"preview":"assets/font/noto/NotoSansLimbu-Regular.svg","scripts":["LIMBU"]},{"family":"Noto Sans Linear B","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansLinearB-Regular.ttf"}],"preview":"assets/font/noto/NotoSansLinearB-Regular.svg","scripts":["LINEAR_B"]},{"family":"Noto Sans Malayalam","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansMalayalam-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansMalayalam-Regular.ttf"}],"preview":"assets/font/noto/NotoSansMalayalam-Regular.svg","scripts":["MALAYALAM"]},{"family":"Noto Sans Mandaic","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansMandaic-Regular.ttf"}],"preview":"assets/font/noto/NotoSansMandaic-Regular.svg","scripts":["MANDAIC"]},{"family":"Noto Sans Mongolian","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansMongolian-Regular.ttf"}],"preview":"assets/font/noto/NotoSansMongolian-Regular.svg","scripts":["MONGOLIAN"]},{"family":"Noto Sans Myanmar","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansMyanmar-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansMyanmar-Regular.ttf"}],"preview":"assets/font/noto/NotoSansMyanmar-Regular.svg","scripts":["MYANMAR"]},{"family":"Noto Sans Old Persian","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansOldPersian-Regular.ttf"}],"preview":"assets/font/noto/NotoSansOldPersian-Regular.svg","scripts":["OLD_PERSIAN"]},{"family":"Noto Sans Osmanya","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansOsmanya-Regular.ttf"}],"preview":"assets/font/noto/NotoSansOsmanya-Regular.svg","scripts":["OSMANYA"]},{"family":"Noto Sans Phoenician","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansPhoenician-Regular.ttf"}],"preview":"assets/font/noto/NotoSansPhoenician-Regular.svg","scripts":["PHOENICIAN"]},{"family":"Noto Sans Runic","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansRunic-Regular.ttf"}],"preview":"assets/font/noto/NotoSansRunic-Regular.svg","scripts":["RUNIC"]},{"family":"Noto Sans Sundanese","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansSundanese-Regular.ttf"}],"preview":"assets/font/noto/NotoSansSundanese-Regular.svg","scripts":["SUNDANESE"]},{"family":"Noto Sans Syriac Eastern","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansSyriacEastern-Regular.ttf"}],"preview":"assets/font/noto/NotoSansSyriacEastern-Regular.svg","scripts":["SYRIAC"]},{"family":"Noto Sans Syriac Estrangela","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansSyriacEstrangela-Regular.ttf"}],"preview":"assets/font/noto/NotoSansSyriacEstrangela-Regular.svg","scripts":["SYRIAC"]},{"family":"Noto Sans Syriac Western","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansSyriacWestern-Regular.ttf"}],"preview":"assets/font/noto/NotoSansSyriacWestern-Regular.svg","scripts":["SYRIAC"]},{"family":"Noto Sans Tagalog","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansTagalog-Regular.ttf"}],"preview":"assets/font/noto/NotoSansTagalog-Regular.svg","scripts":["TAGALOG"]},{"family":"Noto Sans Tai Tham","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansTaiTham-Regular.ttf"}],"preview":"assets/font/noto/NotoSansTaiTham-Regular.svg","scripts":["TAI_THAM"]},{"family":"Noto Sans Tai Viet","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansTaiViet-Regular.ttf"}],"preview":"assets/font/noto/NotoSansTaiViet-Regular.svg","scripts":["TAI_VIET"]},{"family":"Noto Sans Telugu","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansTelugu-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansTelugu-Regular.ttf"}],"preview":"assets/font/noto/NotoSansTelugu-Regular.svg","scripts":["TELUGU"]},{"family":"Noto Sans Thai","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansThai-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansThai-Regular.ttf"}],"preview":"assets/font/noto/NotoSansThai-Regular.svg","scripts":["THAI"]},{"family":"Noto Sans Tibetan","fonts":[{"weight":700,"style":"N","url":"assets/font/noto/NotoSansTibetan-Bold.ttf"},{"weight":400,"style":"N","url":"assets/font/noto/NotoSansTibetan-Regular.ttf"}],"preview":"assets/font/noto/NotoSansTibetan-Regular.svg","scripts":["TIBETAN"]},{"family":"Noto Sans Yi","fonts":[{"weight":400,"style":"N","url":"assets/font/noto/NotoSansYi-Regular.ttf"}],"preview":"assets/font/noto/NotoSansYi-Regular.svg","scripts":["YI"]}]')},,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(9);const i=n(151),o=n(202),r=n(502);function a(){}a.createStorageItem=async function(e){let t=null;switch(e.storage){case i.Storage.Gravit:t=await o.from(gDesigner.getDefaultStorage(),e);break;case i.Storage.GoogleDrive:t=await new r.Item(gDesigner.getDefaultStorage(),e)}return t};var s=a;t.default=s},function(e,t,n){"use strict";e.exports=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;this._status=e,this._statusText=t}isAuthorized(){return!!this._status}getStatusText(){return this._statusText}hasStatusText(){return!!this._statusText}}},function(e,t,n){"use strict";n(9),n(14),n(115),n(19),n(24),n(29),n(3);var i=n(12),o=n(1),r=n(12);const a=n(76),s=n(36),l=n(175);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Forms.SignIn;this._callback=e,this._init(t)}o.GObject.inherit(c,o.GObject),c.Forms={SignIn:"sign-in",SignUp:"sign-up",ResetPassword:"reset-password",Thanks:"thanks"},c.prototype._init=async function(e){this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-login-dialog"}),this._container=$("<div></div>").addClass("container").appendTo(this._dialog),this._buildSignIn(),await this._buildSignUp(),this._buildResetPassword(),this._activatePanel(e)},c.prototype._buildSignIn=function(){let e=$("<div></div>").addClass("panel "+c.Forms.SignIn).appendTo(this._container),t=$("<div></div>").addClass("header").appendTo(e);$("<div></div>").addClass("logo").appendTo(t),$("<div></div>").addClass("text").text(o.GLocale.get(gDesigner.getStoreVendor()?new o.GLocaleKey("GLoginDialog","text.login-dialog-title"):new o.GLocaleKey("GLoginDialog","text.sign-in"))).appendTo(t);let n=$("<div></div>").addClass("body").appendTo(e);$("<div></div>").addClass("title").addClass("simple").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-in-title")))).appendTo(n);let s=$("<div></div>").addClass("subtitle").appendTo(n);gDesigner.getStoreVendor()&&s.append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.not-register")))).append($("<span></span>").addClass("link").addClass("panel").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-up"))).on("click",()=>{gDesigner.stats("login-signup_create-account_open"),this._activatePanel(c.Forms.SignUp)}));let d=$("<div></div>").addClass("message").append($("<span></span>")).appendTo(n);const u=this._createMessageHandler(d);let p=$("<form></form>").attr("id","signin-form").appendTo(n);p.on("submit",e=>{gDesigner.stats("login-signup_login_login"),u(""),e.preventDefault();const t=$(e.target),n=t.find('input[data-property="email"]').val(),o=t.find('input[data-property="password"]').val();return i.gApi.signin({email:n,password:o,app:"designer"}).then(()=>{i.gApi.getUser().then(e=>{this.close(),this._callback(new l(e))}).catch(e=>this._handlerError(e,u))}).catch(e=>this._handlerError(e,u)),!1}),r.HAS_ENTERPRISE?$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-in-login"))).appendTo(p):$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-in-login"))).appendTo(p),$("<input>").attr("type","text").attr("data-property","email").attr("required",!0).appendTo(p),$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-in-password"))).appendTo(p);let g=this._createPasswordInput(),h=$("<span></span>").addClass("forgot-password").append($("<span></span>").addClass("txt").addClass("link").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.forgot-password"))).on("click",()=>{gDesigner.stats("login-signup_login_forgot-password"),r.FORGOT_PWD_LINK?gContainer.openExternalLink(null,"https://idp.corel.com/idp/accountForgotPwd.jsp"):this._activatePanel(c.Forms.ResetPassword)})),f=$("<button></button>").addClass("sign-in").attr("type","submit").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog",r.HAS_ENTERPRISE?"text.sign-in-button":"text.sign-in")))).appendTo(p);r.HAS_ENTERPRISE?(h.appendTo(p),g.appendTo(p),f.appendTo(p)):(g.appendTo(p),$("<div>").addClass("login-button-row").append(h).append(f).appendTo(p));let m=$("<div></div>").addClass("oauth-buttons");if(r.HAS_ENTERPRISE){let e=$("<div></div>").addClass("enterprise-sign-in").appendTo(n),t=$("<div></div>").addClass("content").appendTo(e);t.append($("<div></div>").addClass("header").append($("<div><div/>").addClass("subtitle").html(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.enterprise-sign-in-message"))))),m.append(this._createGoogleButton(new o.GLocaleKey("GLoginDialog","text.enterprise-sign-google")).attr("tabindex",1)).append(this._createMicrosoftButton(new o.GLocaleKey("GLoginDialog","text.enterprise-sign-microsoft")).attr("tabindex",2)).appendTo(t),m.appendTo(t),$("<div></div>").addClass("footer").append($("<span></span>").addClass("message").html(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.enterprise-login-message-1")))).append($("<span></span>").addClass("message").html(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.enterprise-login-message-2")))).appendTo(t)}else{gContainer.getRuntime()!==a.Runtime.Chrome&&($("<div></div>").addClass("sep").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.or")))).appendTo(n),m.append(this._createFacebookButton(new o.GLocaleKey("GLoginDialog","text.sign-facebook")).attr("tabindex",1)).append(this._createGoogleButton(new o.GLocaleKey("GLoginDialog","text.sign-google")).attr("tabindex",2)).appendTo(n)),gDesigner.getStoreVendor()&&$("<footer></footer>").append($("<span></span>").addClass("link").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.continue-without-loggin-in"))).on("click",()=>{this.close(),this._callback(null)})).appendTo(e)}return e},c.prototype._createGoogleButton=function(e){return $("<button></button>").addClass("sign-google oauth column-layout").append($("<span></span>").addClass("icon").addClass("gravit-icon-google")).append($("<span></span>").addClass("txt").text(o.GLocale.get(e))).on("click",()=>{let e=this._getStatMappedForm();gDesigner.stats("login-signup_".concat(e,"_login-google")),this._oauth("google")})},c.prototype._createFacebookButton=function(e){return $("<button></button>").addClass("sign-facebook oauth column-layout").append($("<span></span>").addClass("icon").addClass("gravit-icon-facebook")).append($("<span></span>").addClass("txt").text(o.GLocale.get(e))).on("click",()=>{let e=this._getStatMappedForm();gDesigner.stats("login-signup_".concat(e,"_login-facebook")),this._oauth("facebook")})},c.prototype._createMicrosoftButton=function(e){return $("<button></button>").addClass("sign-microsoft oauth column-layout").append($("<span></span>").addClass("icon").addClass("gravit-icon-microsoft")).append($("<span></span>").addClass("txt").text(o.GLocale.get(e))).on("click",()=>{let e=this._getStatMappedForm();gDesigner.stats("login-signup_".concat(e,"_login-microsoft")),this._oauth("microsoft")})},c.prototype._buildSignUp=async function(){let e=$("<div></div>").addClass("panel "+c.Forms.SignUp).appendTo(this._container),t=$("<div></div>").addClass("header").appendTo(e);$("<div></div>").addClass("logo").appendTo(t),$("<div></div>").addClass("text").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.login-dialog-title"))).appendTo(t);let n=$("<div></div>").addClass("body").appendTo(e);$("<div></div>").addClass("title").addClass("simple").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-up-title")))).appendTo(n),$("<div></div>").addClass("subtitle").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.already-registered")))).append($("<span></span>").addClass("link").addClass("panel").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.login-here"))).on("click",()=>{gDesigner.stats("login-signup_create-account_back-to-login"),this._activatePanel(c.Forms.SignIn)})).appendTo(n);let r=$("<div></div>").addClass("message").append($("<span></span>")).appendTo(n);const s=this._createMessageHandler(r),d=gContainer.getRuntime()===a.Runtime.Electron;let u=$("<form></form>").attr("id","signup-form").appendTo(n);const p=void 0!==window.grecaptcha&&/^(prod|trunk)/.test("production")&&"localhost"!==location.hostname&&!d,g=async e=>{const t=u.find('input[data-property="email"]').val(),n=u.find('input[data-property="firstname"]').val()+" "+u.find('input[data-property="lastname"]').val(),o=u.find('input[data-property="password"]').val();var r=e;const g=u.find('input[data-property="newsletter"]').is(":checked");let h,f;if(d&&(r=await gContainer.generateGoogleRecaptchaToken()),gContainer.getRuntime()===a.Runtime.Electron){const e=gContainer.getPlatform();"darwin"!==e&&"win32"!==e||(h="designer://"),f=gDesigner.getAssetsURL()}else f=location.origin;i.gApi.signup({email:t,name:n,password:o,app:"designer",recaptcha:r,newsletter:g,appUrl:h,webUrl:f}).then(()=>{i.gApi.getUser().then(e=>{e=new l(e),this._buildThanksSignup(e),this._activatePanel(c.Forms.Thanks),this._callback(e)}).catch(e=>this._handlerError(e,s))}).catch(e=>{if(e&&e.errors){const t=new Map(e.errors);s(Array.from(t.values()).join("<br>"))}else s(e.message||"");p&&grecaptcha.reset(this._recaptchaWidget)})};u.on("submit",e=>(gDesigner.stats("login-signup_create-account_create-account"),s(""),e.preventDefault(),p?grecaptcha.execute(this._recaptchaWidget):g(),!1)),$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-email"))).appendTo(u),$("<input>").attr("type","email").attr("data-property","email").attr("autofocus",!0).attr("required",!0).attr("title",o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-email"))).appendTo(u);let h=$("<div></div>").addClass("input-group").appendTo(u);$("<span>").append($("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-first-name")))).append($("<input>").attr("type","text").attr("data-property","firstname").attr("required",!0).attr("title",o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-first-name")))).appendTo(h),$("<span>").append($("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-last-name")))).append($("<input>").attr("type","text").attr("data-property","lastname").attr("required",!0).attr("title",o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-last-name")))).appendTo(h),$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-sign-up-password"))).appendTo(u),this._createPasswordInput().appendTo(u),$("<label></label>").append($("<input>").attr("type","checkbox").on("change",e=>{let t=$(e.target).is(":checked");gDesigner.stats("login-signup_create-account_i-agree",t),u.find('button[type="submit"]').prop("disabled",!t).toggleClass("g-disabled",!t)})).append($("<div></div>").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.agree")))).append($("<span></span>").addClass("link").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.terms-use"))).on("click",e=>(gDesigner.stats("login-signup_create-account_terms-of-use"),gContainer.openExternalLink(e,"https://www.corel.com/en/terms-of-use"),!1))).append($("<span></span>").text("&")).append($("<span></span>").addClass("link").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.privacy-policy"))).on("click",e=>(gDesigner.stats("login-signup_create-account_privacy-policy"),gContainer.openExternalLink(e,"https://www.corel.com/en/corel-privacy-policy"),!1)))).appendTo(u),$("<label></label>").append($("<input>").attr("type","checkbox").attr("data-property","newsletter").prop("checked",!1)).on("change",e=>{gDesigner.stats("login-signup_create-account_subscribe",$(e.target).is(":checked"))}).append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.newsletter")))).appendTo(u);let f=await i.gApi.recaptchaKey();if(p){let e=$(grecaptchaWidget);this._recaptchaWidget=grecaptcha.render(e[0],{sitekey:f,callback:g,size:"invisible"})}$("<button></button>").attr("type","submit").addClass("sign-in").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-up-now")))).addClass("g-disabled").prop("disabled",!0).appendTo(u),gContainer.getRuntime()!==a.Runtime.Chrome&&($("<div></div>").addClass("sep").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.or")))).appendTo(n),$("<div></div>").addClass("oauth-buttons").append(this._createFacebookButton(new o.GLocaleKey("GLoginDialog","text.sign-facebook"))).append(this._createGoogleButton(new o.GLocaleKey("GLoginDialog","text.sign-google"))).appendTo(n));let m=$("<span></span>").addClass("link");return gDesigner.getStoreVendor()&&m.text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.continue-without-loggin-in"))).on("click",()=>{this.close(),this._callback(null)}),$("<footer></footer>").append(m).append(m).appendTo(e),e},c.prototype._buildResetPassword=function(){let e=$("<div></div>").addClass("panel "+c.Forms.ResetPassword).appendTo(this._container),t=$("<div></div>").addClass("header").appendTo(e);$("<div></div>").addClass("logo").appendTo(t),$("<div></div>").addClass("text").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.reset-password-header-title"))).appendTo(t);let n=$("<div></div>").addClass("body").appendTo(e);$("<div></div>").addClass("title").addClass("simple").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.reset-password-title")))).appendTo(n);let r=$("<div></div>").addClass("message").append($("<span></span>")).appendTo(n);const s=this._createMessageHandler(r);let l=$("<form></form>").attr("id","reset-password-form").appendTo(n);return l.on("submit",e=>{gDesigner.stats("login-signup_forgot-password_send-request"),s(""),e.preventDefault();const t=l.find('input[data-property="email"]').val(),n=location.href;let o,r;if(gContainer.getRuntime()===a.Runtime.Electron){const e=gContainer.getPlatform();"darwin"!==e&&"win32"!==e||(o="designer://"),r=gDesigner.getAssetsURL()}else r=location.origin;return i.gApi.resetPassword({email:t,redirect:n,appUrl:o,webUrl:r}).then(e=>{s(e&&e.message,"info")}).catch(e=>this._handlerError(e,s)),!1}),$("<label>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-in-login"))).appendTo(l),$("<input>").attr("type","email").attr("data-property","email").attr("autofocus",!0).attr("required",!0).attr("title",o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.placeholder-reset-password-email"))).appendTo(l),$("<div>").addClass("login-button-row").append($("<span></span>").addClass("link").text("‹ "+o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.back-sign-in"))).on("click",()=>{gDesigner.stats("login-signup_forgot-password_back-to-login"),this._activatePanel(c.Forms.SignIn)})).append($("<button></button>").attr("type","submit").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.reset-password-send"))))).appendTo(l),e},c.prototype._buildThanksSignup=function(e){let t=$("<div></div>").addClass("panel "+c.Forms.Thanks).appendTo(this._container),n=$("<div></div>").addClass("header").appendTo(t);$("<div></div>").addClass("logo").appendTo(n),$("<div></div>").addClass("text").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.login-dialog-title"))).appendTo(n);let i=$("<div></div>").addClass("body").appendTo(t);return $("<div></div>").addClass("title").append($("<span></span>").html(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.sign-up-thanks")).replace("%email",e.getEmail()))).appendTo(i),$("<button></button>").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.ok")))).on("click",this.close.bind(this)).appendTo(i),t},c.prototype._createMessageHandler=function(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";e.removeClass("error info show"),t&&e.addClass("show").addClass(n).find("span").text(t)}},c.prototype._activatePanel=function(e){this._activePanel=e,this._container.find(".panel.g-active").removeClass("g-active"),this._container.find(".panel."+e).addClass("g-active")},c.prototype._oauth=function(e,t){i.gApi.popup("/auth/"+e).then(e=>{this.close(),this._callback(e)}).catch(e=>this._handlerError(e,t))},c.prototype._handlerError=function(e,t){t(e&&e.message||e&&e.errors.toString()||"")},c.prototype._createPasswordInput=function(){let e=$("<div></div>").addClass("input-field"),t=$("<input>").attr("type","password").attr("required",!0).attr("data-property","password").appendTo(e);return $("<span></span>").addClass("icon").addClass("gravit-icon-hide").on("click",e=>{$(e.target).closest("span").toggleClass("gravit-icon-display gravit-icon-hide").hasClass("gravit-icon-hide")?t.attr("type","password"):t.attr("type","text")}).appendTo(e),e},c.prototype._getStatMappedForm=function(){let e=null;switch(this._activePanel){case c.Forms.SignIn:e="login";break;case c.Forms.SignUp:e="create-account";break;case c.Forms.ResetPassword:e="forgot-password";break;case c.Forms.Thanks:e="account-created";break;default:e="login"}return e},c.prototype.open=function(){gDesigner.isOfflineAsync().then(e=>{e?s.alert(o.GLocale.get(new o.GLocaleKey("GLoginDialog","text.you-are-offline"))):this._dialog.gDialog("open",!1)})},c.prototype.close=function(){this._dialog.gDialog("close")},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(533);const{isUTS:o,UTStoCDA:r}=n(990);function a(e,t,n,a){if(!t)throw new i("GCloudAnnotations: no cloud annotations id");if(!e)throw new i("GCloudAnnotations: empty cloud annotations result",t);if(null===e.annotationsCollection&&(e.annotationsCollection=[]),!e.annotationsCollection||!o(e.annotationsCollection)&&!(e.annotationsCollection instanceof Array))throw new i("GCloudAnnotations: no annotationsCollection inside cloud annotations",t);if(!e.lastUpdateTime&&0!==e.lastUpdateTime)throw new i("GCloudAnnotations: no lastUpdateTime inside cloud annotations",t);this.annotationsCollection=e.annotationsCollection,o(this.annotationsCollection)?(this.annotationsCollection=r(this.annotationsCollection),a&&(a.hasUTS=!0)):a&&(a.hasUTS=!1),this.lastUpdateTime=new Date(e.lastUpdateTime).getTime(),this.cid=t,n&&(this.accessToken=n)}a.prototype.annotationsCollection=null,a.prototype.lastUpdateTime=null,a.prototype.cid=null,a.prototype.accessToken=null,a.prototype.toString=function(){return"[GCloudAnnotations]"},e.exports=a},,,,function(e,t,n){"use strict";n(9);var i=n(12);const o=n(264),r=n(754);e.exports=class{constructor(){this._isListening=!1}async checkLicense(){let e;if(gDesigner.isOffline())e=r.newOfflineLicense();else try{e=r.newLicense(await i.gApi.license.get())}catch(t){e=r.newDefaultLicense(),console.info("CheckLicense","exception",t)}this._setApplicationLicense(e)}async _listenLicense(){if(!this._isListening)try{if(!gDesigner.isOffline()){await gDesigner.getUser()&&!gDesigner.isAnonymous()&&(i.gApi.license.listen(e=>{this._setApplicationLicense(r.newLicense(e))}),this._isListening=!0)}}catch(e){console.info("LicenseChanged","exception",e)}}_setApplicationLicense(e){gDesigner.setLicense(e)}async start(){gDesigner.addEventListener(o,this._userLoggedEvent,this),$(window).on("online",this.checkLicense.bind(this)),$(window).on("offline",this.checkLicense.bind(this));try{await this.checkLicense()}catch(e){console.error(e)}try{this._listenLicense()}catch(e){console.error(e)}setInterval(this.checkLicense.bind(this),i.DateAPI.daysToMilliseconds(1))}_userLoggedEvent(){this.checkLicense(),this._listenLicense()}}},function(e,t,n){"use strict";var i=n(12);class o extends i.License{isExpired(e){return super.isExpired(e||gDesigner.now())}isSpecialPriceExpired(e){return super.isSpecialPriceExpired(e||gDesigner.now())}isOfflinePeriodExpired(e){return super.isOfflinePeriodExpired(e||gDesigner.now())}}e.exports=o},function(e,t,n){"use strict";n(9);var i=n(1),o=n(106);e.exports=function(e){e.CommercialProduct=function(t,n,i,o){e.Item.call(this,t,n,i,o)},i.GObject.inherit(e.CommercialProduct,e.Item),e.CommercialProduct.prototype.read=function(e,t,n){o.loadDesignData(this._id,!1).then(t=>{e(t.data)}).catch(t)},e.CommercialProduct.prototype.getPrice=async function(){throw Error("Not implemented")},e.CommercialProduct.prototype.getFormattedPrice=async function(){throw Error("Not implemented")}}},function(e,t,n){"use strict";function i(e,t){null!=e?i.Type.hasOwnProperty(e)?this.errCode=i.Type[e]:this.errCode=i.Type.UnknownError:null!=t&&t>0&&t<=i.Type.UnknownError&&(this.errCode=t)}i.Type={MaxBitmapDim:1,FacingPages:2,OddEvenLayers:3,OtherClientErr:4,TooBigFileSize:5,NoImages:6,UnknownError:7},i.MaxFileSize=471859200,i.prototype.errCode=null,e.exports=i},function(t,n,i){"use strict";i(83),i(45),i(14),i(132);var o=function(){this.interval=1e3,this.maxInterval=6e4};o.prototype.retry=function(e){setTimeout(e,this.interval),this.interval=this.nextInterval_()},o.prototype.reset=function(){this.interval=1e3},o.prototype.nextInterval_=function(){var e=2*this.interval+this.getRandomInt_(0,1e3);return Math.min(e,this.maxInterval)},o.prototype.getRandomInt_=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};var r=function(e){var t=function(){};if(this.file=e.file,this.contentType=e.contentType||this.file.type||"application/octet-stream",this.metadata=e.metadata||{name:this.file.name,mimeType:this.contentType},this.token=e.token,this.onComplete=e.onComplete||t,this.onProgress=e.onProgress||t,this.onError=e.onError||t,this.offset=e.offset||0,this.chunkSize=e.chunkSize||0,this.retryHandler=new o,this.url=e.url,!this.url){var n=e.params||{};n.uploadType="resumable",this.url=this.buildUrl_(e.fileId,n,e.baseUrl)}this.httpMethod=e.fileId?"PATCH":"POST"};r.prototype.upload=function(){var e=new XMLHttpRequest;e.open(this.httpMethod,this.url,!0),e.setRequestHeader("Authorization","Bearer "+this.token),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("X-Upload-Content-Length",this.file.size),e.setRequestHeader("X-Upload-Content-Type",this.contentType),e.onload=function(){if(e.status<400){var t=e.getResponseHeader("Location");this.url=t,this.sendFile_()}else this.onUploadError_(e)}.bind(this),e.onerror=this.onUploadError_.bind(this,e),e.send(JSON.stringify(this.metadata))},r.prototype.sendFile_=function(){var e=this.file,t=this.file.size;(this.offset||this.chunkSize)&&(this.chunkSize&&(t=Math.min(this.offset+this.chunkSize,this.file.size)),e=e.slice(this.offset,t));var n=new XMLHttpRequest;n.open("PUT",this.url,!0),n.setRequestHeader("Content-Type",this.contentType),n.setRequestHeader("Content-Range","bytes "+this.offset+"-"+(t-1)+"/"+this.file.size),n.setRequestHeader("X-Upload-Content-Type",this.file.type),n.upload&&n.upload.addEventListener("progress",this.onProgress),n.onload=this.onContentUploadSuccess_.bind(this,n),n.onerror=this.onContentUploadError_.bind(this,n),n.send(e)},r.prototype.resume_=function(){var e=new XMLHttpRequest;e.open("PUT",this.url,!0),e.setRequestHeader("Content-Range","bytes */"+this.file.size),e.setRequestHeader("X-Upload-Content-Type",this.file.type),e.upload&&e.upload.addEventListener("progress",this.onProgress),e.onload=this.onContentUploadSuccess_.bind(this,e),e.onerror=this.onContentUploadError_.bind(this,e),e.send()},r.prototype.extractRange_=function(e){var t=e.getResponseHeader("Range");t&&(this.offset=parseInt(t.match(/\d+/g).pop(),10)+1)},r.prototype.onContentUploadSuccess_=function(t){200==t.status||201==t.status?this.onComplete(t.response):308==t.status?(this.extractRange_(t),this.retryHandler.reset(),this.sendFile_()):this.onContentUploadError_(e)},r.prototype.onContentUploadError_=function(e){e.status&&e.status<500?this.onError(e.response):this.retryHandler.retry(this.resume_.bind(this))},r.prototype.onUploadError_=function(e){this.onError(e.response)},r.prototype.buildQuery_=function(e){return e=e||{},Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")},r.prototype.buildUrl_=function(e,t,n){var i=n||"https://www.googleapis.com/upload/drive/v3/files/";e&&(i+=e);var o=this.buildQuery_(t);return o&&(i+="?"+o),i},t.exports=r},,,,,,function(e,t,n){(function(t,n,i){!function(t){e.exports=t()}((function(){var e,o,r;return function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof _dereq_&&_dereq_;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,(function(e){var n=t[a][1][e];return o(n||e)}),d,d.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof _dereq_&&_dereq_,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){"use strict";t.exports=function(e){var t=e._SomePromiseArray;function n(e){var n=new t(e),i=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),i}e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},{}],2:[function(e,t,n){"use strict";var i;try{throw new Error}catch(e){i=e}var o=e("./schedule.js"),r=e("./queue.js"),a=e("./util.js");function s(){this._isTickUsed=!1,this._lateQueue=new r(16),this._normalQueue=new r(16),this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=o.isStatic?o(this.drainQueues):o}function l(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function c(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function d(e){this._normalQueue._pushOne(e),this._queueTick()}s.prototype.disableTrampolineIfNecessary=function(){a.hasDevTools&&(this._trampolineEnabled=!1)},s.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(e){setTimeout(e,0)})},s.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},a.hasDevTools?(o.isStatic&&(o=function(e){setTimeout(e,0)}),s.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?l.call(this,e,t,n):this._schedule((function(){setTimeout((function(){e.call(t,n)}),100)}))},s.prototype.invoke=function(e,t,n){this._trampolineEnabled?c.call(this,e,t,n):this._schedule((function(){e.call(t,n)}))},s.prototype.settlePromises=function(e){this._trampolineEnabled?d.call(this,e):this._schedule((function(){e._settlePromises()}))}):(s.prototype.invokeLater=l,s.prototype.invoke=c,s.prototype.settlePromises=d),s.prototype.invokeFirst=function(e,t,n){this._normalQueue.unshift(e,t,n),this._queueTick()},s.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),i=e.shift();t.call(n,i)}else t._settlePromises()}},s.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},t.exports=new s,t.exports.firstLineError=i},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n){var i=function(e,t){this._reject(t)},o=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},r=function(e,t){this._isPending()&&this._resolveCallback(t.target)},a=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){var s=n(i),l=new e(t);l._propagateFrom(this,1);var c=this._target();if(l._setBoundTo(s),s instanceof e){var d={promiseRejectionQueued:!1,promise:l,target:c,bindingPromise:s};c._then(t,o,l._progress,l,d),s._then(r,a,l._progress,l,d)}else l._resolveCallback(c);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=131072|this._bitField,this._boundTo=e):this._bitField=-131073&this._bitField},e.prototype._isBound=function(){return 131072==(131072&this._bitField)},e.bind=function(i,o){var r=n(i),a=new e(t);return a._setBoundTo(r),r instanceof e?r._then((function(){a._resolveCallback(o)}),a._reject,a._progress,a,null):a._resolveCallback(o),a}}},{}],4:[function(e,t,n){"use strict";var i;"undefined"!=typeof Promise&&(i=Promise);var o=e("./promise.js")();o.noConflict=function(){try{Promise===o&&(Promise=i)}catch(e){}return o},t.exports=o},{"./promise.js":23}],5:[function(e,t,n){"use strict";var i=Object.create;if(i){var o=i(null),r=i(null);o[" size"]=r[" size"]=0}t.exports=function(t){var n=e("./util.js"),i=n.canEvaluate;n.isIdentifier;function o(e){return function(e,i){var o;if(null!=e&&(o=e[i]),"function"!=typeof o){var r="Object "+n.classString(e)+" has no method '"+n.toString(i)+"'";throw new t.TypeError(r)}return o}(e,this.pop()).apply(e,this)}function r(e){return e[this]}function a(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}t.prototype.call=function(e){for(var t=arguments.length,n=new Array(t-1),i=1;i<t;++i)n[i-1]=arguments[i];return n.push(e),this._then(o,void 0,void 0,n,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=a;else if(i){var n=(void 0)(e);t=null!==n?n:r}else t=r;return this._then(t,void 0,void 0,e,void 0)}}},{"./util.js":38}],6:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./errors.js"),i=e("./async.js"),o=n.CancellationError;t.prototype._cancel=function(e){if(!this.isCancellable())return this;for(var t,n=this;void 0!==(t=n._cancellationParent)&&t.isCancellable();)n=t;this._unsetCancellable(),n._target()._rejectCallback(e,!1,!0)},t.prototype.cancel=function(e){return this.isCancellable()?(void 0===e&&(e=new o),i.invokeLater(this._cancel,this,e),this):this},t.prototype.cancellable=function(){return this._cancellable()||(i.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0),this},t.prototype.uncancellable=function(){var e=this.then();return e._unsetCancellable(),e},t.prototype.fork=function(e,t,n){var i=this._then(e,t,n,void 0,void 0);return i._setCancellable(),i._cancellationParent=void 0,i}}},{"./async.js":2,"./errors.js":13}],7:[function(e,n,i){"use strict";n.exports=function(){var n,i=e("./async.js"),o=e("./util.js"),r=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,a=null,s=null,l=!1;function c(e){this._parent=e;var t=this._length=1+(void 0===e?0:e._length);m(this,c),t>32&&this.uncycle()}function d(e){for(var t=[],n=0;n<e.length;++n){var i=e[n],o=a.test(i)||"    (No stack trace)"===i,r=o&&p(i);o&&!r&&(l&&" "!==i.charAt(0)&&(i="    "+i),t.push(i))}return t}function u(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){if(e.length<41)return e;return e.substr(0,38)+"..."}(t)+">, no stack trace)"}o.inherits(c,Error),c.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},i=0,o=this;void 0!==o;++i)t.push(o),o=o._parent;for(i=(e=this._length=i)-1;i>=0;--i){var r=t[i].stack;void 0===n[r]&&(n[r]=i)}for(i=0;i<e;++i){var a=n[t[i].stack];if(void 0!==a&&a!==i){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[i]._parent=void 0,t[i]._length=1;var s=i>0?t[i-1]:this;a<e-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var l=s._length+1,c=i-2;c>=0;--c)t[c]._length=l,l++;return}}}},c.prototype.parent=function(){return this._parent},c.prototype.hasParent=function(){return void 0!==this._parent},c.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=c.parseStackAndMessage(e),n=t.message,i=[t.stack],r=this;void 0!==r;)i.push(d(r.stack.split("\n"))),r=r._parent;!function(e){for(var t=e[0],n=1;n<e.length;++n){for(var i=e[n],o=t.length-1,r=t[o],a=-1,s=i.length-1;s>=0;--s)if(i[s]===r){a=s;break}for(s=a;s>=0;--s){var l=i[s];if(t[o]!==l)break;t.pop(),o--}t=i}}(i),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(i),o.notEnumerableProp(e,"stack",function(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");n<t.length&&(t[n]=t[n].join("\n"));return e+"\n"+t.join("\n")}(n,i)),o.notEnumerableProp(e,"__stackCleaned__",!0)}},c.parseStackAndMessage=function(e){var t=e.stack;return{message:e.toString(),stack:d(t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var i=t[n];if("    (No stack trace)"===i||a.test(i))break}return n>0&&(t=t.slice(n)),t}(e):["    (No stack trace)"])}},c.formatAndLogError=function(e,t){if("undefined"!=typeof console){var i;if("object"==typeof e||"function"==typeof e){var o=e.stack;i=t+s(o,e)}else i=t+String(e);"function"==typeof n?n(i):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}},c.unhandledRejection=function(e){c.formatAndLogError(e,"^--- With additional stack trace: ")},c.isSupported=function(){return"function"==typeof m},c.fireRejectionEvent=function(e,t,n,o){var r=!1;try{"function"==typeof t&&(r=!0,"rejectionHandled"===e?t(o):t(n,o))}catch(e){i.throwLater(e)}var a=!1;try{a=y(e,n,o)}catch(e){a=!0,i.throwLater(e)}var s=!1;if(f)try{s=f(e.toLowerCase(),{reason:n,promise:o})}catch(e){s=!0,i.throwLater(e)}a||r||s||"unhandledRejection"!==e||c.formatAndLogError(n,"Unhandled rejection ")};var p=function(){return!1},g=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function h(e){var t=e.match(g);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}c.setBounds=function(e,t){if(c.isSupported()){for(var n,i,o=e.stack.split("\n"),a=t.stack.split("\n"),s=-1,l=-1,d=0;d<o.length;++d){if(u=h(o[d])){n=u.fileName,s=u.line;break}}for(d=0;d<a.length;++d){var u;if(u=h(a[d])){i=u.fileName,l=u.line;break}}s<0||l<0||!n||!i||n!==i||s>=l||(p=function(e){if(r.test(e))return!0;var t=h(e);return!!(t&&t.fileName===n&&s<=t.line&&t.line<=l)})}};var f,m=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():u(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,a=e,s=t;var n=Error.captureStackTrace;return p=function(e){return r.test(e)},function(e,t){Error.stackTraceLimit=Error.stackTraceLimit+6,n(e,t),Error.stackTraceLimit=Error.stackTraceLimit-6}}var i,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return a=/@/,s=t,l=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){i="stack"in e}return!("stack"in o)&&i&&"number"==typeof Error.stackTraceLimit?(a=e,s=t,function(e){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit=Error.stackTraceLimit-6}):(s=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?u(t):t.toString()},null)}(),y=function(){if(o.isNode)return function(e,n,i){return"rejectionHandled"===e?t.emit(e,i):t.emit(e,n,i)};var e=!1,n=!0;try{var i=new self.CustomEvent("test");e=i instanceof CustomEvent}catch(e){}if(!e)try{var r=document.createEvent("CustomEvent");r.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(r)}catch(e){n=!1}n&&(f=function(t,n){var i;return e?i=new self.CustomEvent(t,{detail:n,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(i=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!0,n),!!i&&!self.dispatchEvent(i)});var a={};return a.unhandledRejection="onunhandledRejection".toLowerCase(),a.rejectionHandled="onrejectionHandled".toLowerCase(),function(e,t,n){var i=a[e],o=self[i];return!!o&&("rejectionHandled"===e?o.call(self,n):o.call(self,t,n),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(n=function(e){console.warn(e)},o.isNode&&t.stderr.isTTY?n=function(e){t.stderr.write("[31m"+e+"[39m\n")}:o.isNode||"string"!=typeof(new Error).stack||(n=function(e){console.warn("%c"+e,"color: red")})),c}},{"./async.js":2,"./util.js":38}],8:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./util.js"),i=e("./errors.js"),o=n.tryCatch,r=n.errorObj,a=e("./es5.js").keys,s=i.TypeError;function l(e,t,n){this._instances=e,this._callback=t,this._promise=n}function c(e,t){var n={},i=o(e).call(n,t);return i===r?i:a(n).length?(r.e=new s("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),r):i}return l.prototype.doFilter=function(e){for(var n=this._callback,i=this._promise._boundValue(),a=0,s=this._instances.length;a<s;++a){var l=this._instances[a],d=l===Error||null!=l&&l.prototype instanceof Error;if(d&&e instanceof l)return(u=o(n).call(i,e))===r?(t.e=u.e,t):u;if("function"==typeof l&&!d){var u,p=c(l,e);if(p===r){e=r.e;break}if(p)return(u=o(n).call(i,e))===r?(t.e=u.e,t):u}}return t.e=e,t},l}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(e,t,n){"use strict";t.exports=function(e,t,n){var i=[];function o(){this._trace=new t(r())}function r(){var e=i.length-1;if(e>=0)return i[e]}return o.prototype._pushContext=function(){n()&&void 0!==this._trace&&i.push(this._trace)},o.prototype._popContext=function(){n()&&void 0!==this._trace&&i.pop()},e.prototype._peekContext=r,e.prototype._pushContext=o.prototype._pushContext,e.prototype._popContext=o.prototype._popContext,function(){if(n())return new o}}},{}],10:[function(e,t,n){"use strict";t.exports=function(t,n){var i,o,r=t._getDomain,a=e("./async.js"),s=e("./errors.js").Warning,l=e("./util.js"),c=l.canAttachTrace,d=l.isNode&&(!!Object({NODE_ENV:"production",APP_VERSION:"3.5.71",APP_VERSION_FRIENDLY:"2021.i13",IS_BETA:!1,BUILD_NUM:"7135",COMMIT_SHA:"824b4e4b7f2e5126d4e73a52cecfe04e9940899e",STORE_VENDOR:"",IS_COREL:!1,IS_TRUNK:!1,IS_PROD:!0}).BLUEBIRD_DEBUG||!1);return l.isNode&&0==Object({NODE_ENV:"production",APP_VERSION:"3.5.71",APP_VERSION_FRIENDLY:"2021.i13",IS_BETA:!1,BUILD_NUM:"7135",COMMIT_SHA:"824b4e4b7f2e5126d4e73a52cecfe04e9940899e",STORE_VENDOR:"",IS_COREL:!1,IS_TRUNK:!1,IS_PROD:!0}).BLUEBIRD_DEBUG&&(d=!1),d&&a.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),a.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){n.fireRejectionEvent("rejectionHandled",i,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),n.fireRejectionEvent("unhandledRejection",o,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=function(e){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=e},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return d&&(this._trace=new n(this._peekContext())),this},t.prototype._attachExtraTrace=function(e,t){if(d&&c(e)){var i=this._trace;if(void 0!==i&&t&&(i=i._parent),void 0!==i)i.attachExtraTrace(e);else if(!e.__stackCleaned__){var o=n.parseStackAndMessage(e);l.notEnumerableProp(e,"stack",o.message+"\n"+o.stack.join("\n")),l.notEnumerableProp(e,"__stackCleaned__",!0)}}},t.prototype._warn=function(e){var t=new s(e),i=this._peekContext();if(i)i.attachExtraTrace(t);else{var o=n.parseStackAndMessage(t);t.stack=o.message+"\n"+o.stack.join("\n")}n.formatAndLogError(t,"")},t.onPossiblyUnhandledRejection=function(e){var t=r();o="function"==typeof e?null===t?e:t.bind(e):void 0},t.onUnhandledRejectionHandled=function(e){var t=r();i="function"==typeof e?null===t?e:t.bind(e):void 0},t.longStackTraces=function(){if(a.haveItemsQueued()&&!1===d)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(d=n.isSupported())&&a.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return d&&n.isSupported()},n.isSupported()||(t.longStackTraces=function(){},d=!1),function(){return d}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(e,t,n){"use strict";var i=e("./util.js").isPrimitive;t.exports=function(e){var t=function(){return this},n=function(){throw this},o=function(){},r=function(){throw void 0},a=function(e,t){return 1===t?function(){throw e}:2===t?function(){return e}:void 0};e.prototype.return=e.prototype.thenReturn=function(n){return void 0===n?this.then(o):i(n)?this._then(a(n,2),void 0,void 0,void 0,void 0):(n instanceof e&&n._ignoreRejections(),this._then(t,void 0,void 0,n,void 0))},e.prototype.throw=e.prototype.thenThrow=function(e){return void 0===e?this.then(r):i(e)?this._then(a(e,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,e,void 0)}}},{"./util.js":38}],12:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.reduce;e.prototype.each=function(e){return n(this,e,null,t)},e.each=function(e,i){return n(e,i,null,t)}}},{}],13:[function(e,t,n){"use strict";var i,o,r=e("./es5.js"),a=r.freeze,s=e("./util.js"),l=s.inherits,c=s.notEnumerableProp;function d(e,t){function n(i){if(!(this instanceof n))return new n(i);c(this,"message","string"==typeof i?i:t),c(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return l(n,Error),n}var u=d("Warning","warning"),p=d("CancellationError","cancellation error"),g=d("TimeoutError","timeout error"),h=d("AggregateError","aggregate error");try{i=TypeError,o=RangeError}catch(e){i=d("TypeError","type error"),o=d("RangeError","range error")}for(var f="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<f.length;++m)"function"==typeof Array.prototype[f[m]]&&(h.prototype[f[m]]=Array.prototype[f[m]]);r.defineProperty(h.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),h.prototype.isOperational=!0;var y=0;function v(e){if(!(this instanceof v))return new v(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}h.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",o=i.split("\n"),r=0;r<o.length;++r)o[r]=e+o[r];t+=(i=o.join("\n"))+"\n"}return y--,t},l(v,Error);var _=Error.__BluebirdErrorTypes__;_||(_=a({CancellationError:p,TimeoutError:g,OperationalError:v,RejectionError:v,AggregateError:h}),c(Error,"__BluebirdErrorTypes__",_)),t.exports={Error:Error,TypeError:i,RangeError:o,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:u}},{"./es5.js":14,"./util.js":38}],14:[function(e,t,n){var i=function(){"use strict";return void 0===this}();if(i)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,r={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t};t.exports={isArray:function(e){try{return"[object Array]"===r.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return a}},isES5:i,propertyIsWritable:function(){return!0}}}},{}],15:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,i){return n(this,e,i,t)},e.filter=function(e,i,o){return n(e,i,o,t)}}},{}],16:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=e("./util.js"),r=o.isPrimitive,a=o.thrower;function s(){return this}function l(){throw this}function c(e,t,n){var i,o;return i=r(t)?n?(o=t,function(){return o}):function(e){return function(){throw e}}(t):n?s:l,e._then(i,a,void 0,t,void 0)}function d(e){var o=this.promise,r=this.handler,a=o._isBound()?r.call(o._boundValue()):r();if(void 0!==a){var s=i(a,o);if(s instanceof t)return c(s=s._target(),e,o.isFulfilled())}return o.isRejected()?(n.e=e,n):e}function u(e){var n=this.promise,o=this.handler,r=n._isBound()?o.call(n._boundValue(),e):o(e);if(void 0!==r){var a=i(r,n);if(a instanceof t)return c(a=a._target(),e,!0)}return e}t.prototype._passThroughHandler=function(e,t){if("function"!=typeof e)return this.then();var n={promise:this,handler:e};return this._then(t?d:u,t?d:void 0,void 0,n,void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThroughHandler(e,!0)},t.prototype.tap=function(e){return this._passThroughHandler(e,!1)}}},{"./util.js":38}],17:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./errors.js").TypeError,a=e("./util.js"),s=a.errorObj,l=a.tryCatch,c=[];function d(e,n,o,r){(this._promise=new t(i))._captureStackTrace(),this._stack=r,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(c):c}d.prototype.promise=function(){return this._promise},d.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},d.prototype._continue=function(e){if(e===s)return this._promise._rejectCallback(e.e,!1,!0);var n=e.value;if(!0===e.done)this._promise._resolveCallback(n);else{var i=o(n,this._promise);if(!(i instanceof t)&&null===(i=function(e,n,i){for(var r=0;r<n.length;++r){i._pushContext();var a=l(n[r])(e);if(i._popContext(),a===s){i._pushContext();var c=t.reject(s.e);return i._popContext(),c}var d=o(a,i);if(d instanceof t)return d}return null}(i,this._yieldHandlers,this._promise)))return void this._throw(new r("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",n)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));i._then(this._next,this._throw,void 0,this,null)}},d.prototype._throw=function(e){this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},d.prototype._next=function(e){this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},t.coroutine=function(e,t){if("function"!=typeof e)throw new r("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=Object(t).yieldHandler,i=d,o=(new Error).stack;return function(){var t=e.apply(this,arguments),r=new i(void 0,void 0,n,o);return r._generator=t,r._next(void 0),r.promise()}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new r("fn must be a function\n\n    See http://goo.gl/916lJJ\n");c.push(e)},t.spawn=function(e){if("function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var i=new d(e,this),o=i.promise();return i._run(t.spawn),o}}},{"./errors.js":13,"./util.js":38}],18:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util.js");r.canEvaluate,r.tryCatch,r.errorObj;t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);for(var i=arguments.length,o=new Array(i),r=0;r<i;++r)o[r]=arguments[r];e&&o.pop();var a=new n(o).promise();return void 0!==e?a.spread(e):a}}},{"./util.js":38}],19:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r){var a=t._getDomain,s=e("./async.js"),l=e("./util.js"),c=l.tryCatch,d=l.errorObj,u={},p=[];function g(e,t,n,i){this.constructor$(e),this._promise._captureStackTrace();var o=a();this._callback=null===o?t:o.bind(t),this._preservedValues=i===r?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:p,s.invoke(h,this,void 0)}function h(){this._init$(void 0,-2)}function f(e,t,n,i){var o="object"==typeof n&&null!==n?n.concurrency:0;return new g(e,t,o="number"==typeof o&&isFinite(o)&&o>=1?o:0,i)}l.inherits(g,n),g.prototype._init=function(){},g.prototype._promiseFulfilled=function(e,n){var i=this._values,r=this.length(),a=this._preservedValues,s=this._limit;if(i[n]===u){if(i[n]=e,s>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(s>=1&&this._inFlight>=s)return i[n]=e,void this._queue.push(n);null!==a&&(a[n]=e);var l=this._callback,p=this._promise._boundValue();this._promise._pushContext();var g=c(l).call(p,e,n,r);if(this._promise._popContext(),g===d)return this._reject(g.e);var h=o(g,this._promise);if(h instanceof t){if((h=h._target())._isPending())return s>=1&&this._inFlight++,i[n]=u,h._proxyPromiseArray(this,n);if(!h._isFulfilled())return this._reject(h._reason());g=h._value()}i[n]=g}++this._totalResolved>=r&&(null!==a?this._filter(i,a):this._resolve(i))},g.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var i=e.pop();this._promiseFulfilled(n[i],i)}},g.prototype._filter=function(e,t){for(var n=t.length,i=new Array(n),o=0,r=0;r<n;++r)e[r]&&(i[o++]=t[r]);i.length=o,this._resolve(i)},g.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return"function"!=typeof e?i("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):f(this,e,t,null).promise()},t.map=function(e,t,n,o){return"function"!=typeof t?i("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):f(e,t,n,o).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util.js"),a=r.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var i=new t(n);i._captureStackTrace(),i._pushContext();var o=a(e).apply(this,arguments);return i._popContext(),i._resolveFromSyncValue(o),i}},t.attempt=t.try=function(e,i,s){if("function"!=typeof e)return o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var l=new t(n);l._captureStackTrace(),l._pushContext();var c=r.isArray(i)?a(e).apply(s,i):a(e).call(s,i);return l._popContext(),l._resolveFromSyncValue(c),l},t.prototype._resolveFromSyncValue=function(e){e===r.errorObj?this._rejectCallback(e.e,!1,!0):this._resolveCallback(e,!0)}}},{"./util.js":38}],21:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./util.js"),i=e("./async.js"),o=n.tryCatch,r=n.errorObj;function a(e,t){if(!n.isArray(e))return s.call(this,e,t);var a=o(t).apply(this._boundValue(),[null].concat(e));a===r&&i.throwLater(a.e)}function s(e,t){var n=this._boundValue(),a=void 0===e?o(t).call(n,null):o(t).call(n,null,e);a===r&&i.throwLater(a.e)}function l(e,t){if(!e){var n=this._target()._getCarriedStackTrace();n.cause=e,e=n}var a=o(t).call(this._boundValue(),e);a===r&&i.throwLater(a.e)}t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var n=s;void 0!==t&&Object(t).spread&&(n=a),this._then(n,l,void 0,this,e)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(e,t,n){"use strict";t.exports=function(t,n){var i=e("./util.js"),o=e("./async.js"),r=i.tryCatch,a=i.errorObj;t.prototype.progressed=function(e){return this._then(void 0,void 0,e,void 0,void 0)},t.prototype._progress=function(e){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(e)},t.prototype._progressHandlerAt=function(e){return 0===e?this._progressHandler0:this[(e<<2)+e-5+2]},t.prototype._doProgressWith=function(e){var n=e.value,o=e.handler,s=e.promise,l=e.receiver,c=r(o).call(l,n);if(c===a){if(null!=c.e&&"StopProgressPropagation"!==c.e.name){var d=i.canAttachTrace(c.e)?c.e:new Error(i.toString(c.e));s._attachExtraTrace(d),s._progress(c.e)}}else c instanceof t?c._then(s._progress,null,null,s,void 0):s._progress(c)},t.prototype._progressUnchecked=function(e){for(var i=this._length(),r=this._progress,a=0;a<i;a++){var s=this._progressHandlerAt(a),l=this._promiseAt(a);if(l instanceof t)"function"==typeof s?o.invoke(this._doProgressWith,this,{handler:s,promise:l,receiver:this._receiverAt(a),value:e}):o.invoke(r,l,e);else{var c=this._receiverAt(a);"function"==typeof s?s.call(c,e,l):c instanceof n&&!c._isResolved()&&c._promiseProgressed(e,l)}}}}},{"./async.js":2,"./util.js":38}],23:[function(e,n,i){"use strict";n.exports=function(){var i,o=function(){return new u("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},r=function(){return new G.PromiseInspection(this._target())},a=function(e){return G.reject(new u(e))},s=e("./util.js");i=s.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},s.notEnumerableProp(G,"_getDomain",i);var l={},c=e("./async.js"),d=e("./errors.js"),u=G.TypeError=d.TypeError;G.RangeError=d.RangeError,G.CancellationError=d.CancellationError,G.TimeoutError=d.TimeoutError,G.OperationalError=d.OperationalError,G.RejectionError=d.OperationalError,G.AggregateError=d.AggregateError;var p=function(){},g={},h={e:null},f=e("./thenables.js")(G,p),m=e("./promise_array.js")(G,p,f,a),y=e("./captured_trace.js")(),v=e("./debuggability.js")(G,y),_=e("./context.js")(G,y,v),b=e("./catch_filter.js")(h),w=e("./promise_resolver.js"),C=w._nodebackForPromise,E=s.errorObj,S=s.tryCatch;function G(e){if("function"!=typeof e)throw new u("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==G)throw new u("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,e!==p&&this._resolveFromResolver(e)}function A(e){var t=new G(p);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._progressHandler0=e,t._promise0=e,t._receiver0=e,t._settledValue=e}return G.prototype.toString=function(){return"[object Promise]"},G.prototype.caught=G.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,i=new Array(t-1),o=0;for(n=0;n<t-1;++n){var r=arguments[n];if("function"!=typeof r)return G.reject(new u("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));i[o++]=r}i.length=o;var a=new b(i,e=arguments[n],this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,e,void 0,void 0,void 0)},G.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},G.prototype.then=function(e,t,n){if(v()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var i=".then() only accepts functions but was passed: "+s.classString(e);arguments.length>1&&(i+=", "+s.classString(t)),this._warn(i)}return this._then(e,t,n,void 0,void 0)},G.prototype.done=function(e,t,n){this._then(e,t,n,void 0,void 0)._setIsFinal()},G.prototype.spread=function(e,t){return this.all()._then(e,t,void 0,g,void 0)},G.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},G.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},G.prototype.all=function(){return new m(this).promise()},G.prototype.error=function(e){return this.caught(s.originatesFromRejection,e)},G.getNewLibraryCopy=n.exports,G.is=function(e){return e instanceof G},G.fromNode=function(e){var t=new G(p),n=S(e)(C(t));return n===E&&t._rejectCallback(n.e,!0,!0),t},G.all=function(e){return new m(e).promise()},G.defer=G.pending=function(){var e=new G(p);return new w(e)},G.cast=function(e){var t=f(e);if(!(t instanceof G)){var n=t;(t=new G(p))._fulfillUnchecked(n)}return t},G.resolve=G.fulfilled=G.cast,G.reject=G.rejected=function(e){var t=new G(p);return t._captureStackTrace(),t._rejectCallback(e,!0),t},G.setScheduler=function(e){if("function"!=typeof e)throw new u("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var t=c._schedule;return c._schedule=e,t},G.prototype._then=function(e,t,n,o,r){var a=void 0!==r,s=a?r:new G(p);a||(s._propagateFrom(this,5),s._captureStackTrace());var l=this._target();l!==this&&(void 0===o&&(o=this._boundTo),a||s._setIsMigrated());var d=l._addCallbacks(e,t,n,s,o,i());return l._isResolved()&&!l._isSettlePromisesQueued()&&c.invoke(l._settlePromiseAtPostResolution,l,d),s},G.prototype._settlePromiseAtPostResolution=function(e){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(e)},G.prototype._length=function(){return 131071&this._bitField},G.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},G.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},G.prototype._setLength=function(e){this._bitField=-131072&this._bitField|131071&e},G.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},G.prototype._setRejected=function(){this._bitField=134217728|this._bitField},G.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},G.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},G.prototype._isFinal=function(){return(33554432&this._bitField)>0},G.prototype._cancellable=function(){return(67108864&this._bitField)>0},G.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},G.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},G.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},G.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},G.prototype._isMigrated=function(){return(4194304&this._bitField)>0},G.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[5*e-5+4];if(t!==l)return void 0===t&&this._isBound()?this._boundValue():t},G.prototype._promiseAt=function(e){return 0===e?this._promise0:this[5*e-5+3]},G.prototype._fulfillmentHandlerAt=function(e){return 0===e?this._fulfillmentHandler0:this[5*e-5+0]},G.prototype._rejectionHandlerAt=function(e){return 0===e?this._rejectionHandler0:this[5*e-5+1]},G.prototype._boundValue=function(){var e=this._boundTo;return void 0!==e&&e instanceof G?e.isFulfilled()?e.value():void 0:e},G.prototype._migrateCallbacks=function(e,t){var n=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),o=e._progressHandlerAt(t),r=e._promiseAt(t),a=e._receiverAt(t);r instanceof G&&r._setIsMigrated(),void 0===a&&(a=l),this._addCallbacks(n,i,o,r,a,null)},G.prototype._addCallbacks=function(e,t,n,i,o,r){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),0===a)this._promise0=i,void 0!==o&&(this._receiver0=o),"function"!=typeof e||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===r?e:r.bind(e)),"function"==typeof t&&(this._rejectionHandler0=null===r?t:r.bind(t)),"function"==typeof n&&(this._progressHandler0=null===r?n:r.bind(n));else{var s=5*a-5;this[s+3]=i,this[s+4]=o,"function"==typeof e&&(this[s+0]=null===r?e:r.bind(e)),"function"==typeof t&&(this[s+1]=null===r?t:r.bind(t)),"function"==typeof n&&(this[s+2]=null===r?n:r.bind(n))}return this._setLength(a+1),a},G.prototype._setProxyHandlers=function(e,t){var n=this._length();if(n>=131066&&(n=0,this._setLength(0)),0===n)this._promise0=t,this._receiver0=e;else{var i=5*n-5;this[i+3]=t,this[i+4]=e}this._setLength(n+1)},G.prototype._proxyPromiseArray=function(e,t){this._setProxyHandlers(e,t)},G.prototype._resolveCallback=function(e,t){if(!this._isFollowingOrFulfilledOrRejected()){if(e===this)return this._rejectCallback(o(),!1,!0);var n=f(e,this);if(!(n instanceof G))return this._fulfill(e);var i=1|(t?4:0);this._propagateFrom(n,i);var r=n._target();if(r._isPending()){for(var a=this._length(),s=0;s<a;++s)r._migrateCallbacks(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else r._isFulfilled()?this._fulfillUnchecked(r._value()):this._rejectUnchecked(r._reason(),r._getCarriedStackTrace())}},G.prototype._rejectCallback=function(e,t,n){n||s.markAsOriginatingFromRejection(e);var i=s.ensureErrorObject(e),o=i===e;this._attachExtraTrace(i,!!t&&o),this._reject(e,o?void 0:i)},G.prototype._resolveFromResolver=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,i=S(e)((function(e){null!==t&&(t._resolveCallback(e),t=null)}),(function(e){null!==t&&(t._rejectCallback(e,n),t=null)}));n=!1,this._popContext(),void 0!==i&&i===E&&null!==t&&(t._rejectCallback(i.e,!0,!0),t=null)},G.prototype._settlePromiseFromHandler=function(e,t,n,i){var r;if(!i._isRejected())if(i._pushContext(),r=t!==g||this._isRejected()?S(e).call(t,n):S(e).apply(this._boundValue(),n),i._popContext(),r===E||r===i||r===h){var a=r===i?o():r.e;i._rejectCallback(a,!1,!0)}else i._resolveCallback(r)},G.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},G.prototype._followee=function(){return this._rejectionHandler0},G.prototype._setFollowee=function(e){this._rejectionHandler0=e},G.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},G.prototype._propagateFrom=function(e,t){(1&t)>0&&e._cancellable()&&(this._setCancellable(),this._cancellationParent=e),(4&t)>0&&e._isBound()&&this._setBoundTo(e._boundTo)},G.prototype._fulfill=function(e){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(e)},G.prototype._reject=function(e,t){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(e,t)},G.prototype._settlePromiseAt=function(e){var t=this._promiseAt(e),n=t instanceof G;if(n&&t._isMigrated())return t._unsetIsMigrated(),c.invoke(this._settlePromiseAt,this,e);var i=this._isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,r=this._settledValue,a=this._receiverAt(e);this._clearCallbackDataAtIndex(e),"function"==typeof i?n?this._settlePromiseFromHandler(i,a,r,t):i.call(a,r,t):a instanceof m?a._isResolved()||(this._isFulfilled()?a._promiseFulfilled(r,t):a._promiseRejected(r,t)):n&&(this._isFulfilled()?t._fulfill(r):t._reject(r,o)),e>=4&&4==(31&e)&&c.invokeLater(this._setLength,this,0)},G.prototype._clearCallbackDataAtIndex=function(e){if(0===e)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var t=5*e-5;this[t+3]=this[t+4]=this[t+0]=this[t+1]=this[t+2]=void 0}},G.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},G.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},G.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},G.prototype._queueSettlePromises=function(){c.settlePromises(this),this._setSettlePromisesQueued()},G.prototype._fulfillUnchecked=function(e){if(e===this){var t=o();return this._attachExtraTrace(t),this._rejectUnchecked(t,void 0)}this._setFulfilled(),this._settledValue=e,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},G.prototype._rejectUncheckedCheckError=function(e){var t=s.ensureErrorObject(e);this._rejectUnchecked(e,t===e?void 0:t)},G.prototype._rejectUnchecked=function(e,t){if(e===this){var n=o();return this._attachExtraTrace(n),this._rejectUnchecked(n)}this._setRejected(),this._settledValue=e,this._cleanValues(),this._isFinal()?c.throwLater((function(e){throw"stack"in e&&c.invokeFirst(y.unhandledRejection,void 0,e),e}),void 0===t?e:t):(void 0!==t&&t!==e&&this._setCarriedStackTrace(t),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled())},G.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var e=this._length(),t=0;t<e;t++)this._settlePromiseAt(t)},s.notEnumerableProp(G,"_makeSelfResolutionError",o),e("./progress.js")(G,m),e("./method.js")(G,p,f,a),e("./bind.js")(G,p,f),e("./finally.js")(G,h,f),e("./direct_resolve.js")(G),e("./synchronous_inspection.js")(G),e("./join.js")(G,m,f,p),G.version="2.11.0",G.Promise=G,e("./map.js")(G,m,a,f,p),e("./cancel.js")(G),e("./using.js")(G,a,f,_),e("./generators.js")(G,a,p,f),e("./nodeify.js")(G),e("./call_get.js")(G),e("./props.js")(G,m,f,a),e("./race.js")(G,p,f,a),e("./reduce.js")(G,m,a,f,p),e("./settle.js")(G,m),e("./some.js")(G,m,a),e("./promisify.js")(G,p),e("./any.js")(G),e("./each.js")(G,p),e("./timers.js")(G,p),e("./filter.js")(G,p),s.toFastProperties(G),s.toFastProperties(G.prototype),A({a:1}),A({b:2}),A({c:3}),A(1),A((function(){})),A(void 0),A(!1),A(new G(p)),y.setBounds(c.firstLineError,s.lastLineError),G}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util.js").isArray;function a(e){var i,o=this._promise=new t(n);e instanceof t&&(i=e,o._propagateFrom(i,5)),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(n,a){var s=i(this._values,this._promise);if(s instanceof t){if(s=s._target(),this._values=s,!s._isFulfilled())return s._isPending()?void s._then(e,this._reject,void 0,this,a):void this._reject(s._reason());if(s=s._value(),!r(s)){var l=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(l)}}else if(!r(s))return void this._promise._reject(o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0!==s.length){var c=this.getActualLength(s.length);this._length=c,this._values=this.shouldCopyValues()?new Array(c):this._values;for(var d=this._promise,u=0;u<c;++u){var p=this._isResolved(),g=i(s[u],d);g instanceof t?(g=g._target(),p?g._ignoreRejections():g._isPending()?g._proxyPromiseArray(this,u):g._isFulfilled()?this._promiseFulfilled(g._value(),u):this._promiseRejected(g._reason(),u)):p||this._promiseFulfilled(g,u)}}else-5===a?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{}}}(a))},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype.__hardReject__=a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1,!0)},a.prototype._promiseProgressed=function(e,t){this._promise._progress({index:t,value:e})},a.prototype._promiseFulfilled=function(e,t){this._values[t]=e,++this._totalResolved>=this._length&&this._resolve(this._values)},a.prototype._promiseRejected=function(e,t){this._totalResolved++,this._reject(e)},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util.js":38}],25:[function(e,t,n){"use strict";var i=e("./util.js"),o=i.maybeWrapAsError,r=e("./errors.js"),a=r.TimeoutError,s=r.OperationalError,l=i.haveGetters,c=e("./es5.js");var d,u=/^(?:name|message|stack|cause)$/;function p(e){var t;if(function(e){return e instanceof Error&&c.getPrototypeOf(e)===Error.prototype}(e)){(t=new s(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=c.keys(e),o=0;o<n.length;++o){var r=n[o];u.test(r)||(t[r]=e[r])}return t}return i.markAsOriginatingFromRejection(e),e}function g(e){return function(t,n){if(null!==e){if(t){var i=p(o(t));e._attachExtraTrace(i),e._reject(i)}else if(arguments.length>2){for(var r=arguments.length,a=new Array(r-1),s=1;s<r;++s)a[s-1]=arguments[s];e._fulfill(a)}else e._fulfill(n);e=null}}}if(d=l?function(e){this.promise=e}:function(e){this.promise=e,this.asCallback=g(e),this.callback=this.asCallback},l){var h={get:function(){return g(this.promise)}};c.defineProperty(d.prototype,"asCallback",h),c.defineProperty(d.prototype,"callback",h)}d._nodebackForPromise=g,d.prototype.toString=function(){return"[object PromiseResolver]"},d.prototype.resolve=d.prototype.fulfill=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(e)},d.prototype.reject=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(e)},d.prototype.progress=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(e)},d.prototype.cancel=function(e){this.promise.cancel(e)},d.prototype.timeout=function(){this.reject(new a("timeout"))},d.prototype.isResolved=function(){return this.promise.isResolved()},d.prototype.toJSON=function(){return this.promise.toJSON()},t.exports=d},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(e,t,n){"use strict";t.exports=function(t,n){var i={},o=e("./util.js"),r=e("./promise_resolver.js")._nodebackForPromise,a=o.withAppended,s=o.maybeWrapAsError,l=o.canEvaluate,c=e("./errors").TypeError,d={__isPromisified__:!0},u=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),p=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function g(e){return!u.test(e)}function h(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function f(e,t,n){var i=o.getDataPropertyOrDefault(e,t+n,d);return!!i&&h(i)}function m(e,t,n,i){for(var r=o.inheritedDataKeys(e),a=[],s=0;s<r.length;++s){var l=r[s],d=e[l],u=i===p||p(l);"function"!=typeof d||h(d)||f(e,l,t)||!i(l,d,e,u)||a.push(l,d)}return function(e,t,n){for(var i=0;i<e.length;i+=2){var o=e[i];if(n.test(o))for(var r=o.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===r)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",t))}}(a,t,n),a}var y=l?void 0:function(e,l,c,d){var u=function(){return this}(),p=e;function g(){var o=l;l===i&&(o=this);var c=new t(n);c._captureStackTrace();var d="string"==typeof p&&this!==u?this[p]:e,g=r(c);try{d.apply(o,a(arguments,g))}catch(e){c._rejectCallback(s(e),!0,!0)}return c}return"string"==typeof p&&(e=d),o.notEnumerableProp(g,"__isPromisified__",!0),g};function v(e,t,n,r){for(var a=new RegExp(t.replace(/([$])/,"\\$")+"$"),s=m(e,t,a,n),l=0,c=s.length;l<c;l+=2){var d=s[l],u=s[l+1],p=d+t;if(r===y)e[p]=y(d,i,d,u,t);else{var g=r(u,(function(){return y(d,i,d,u,t)}));o.notEnumerableProp(g,"__isPromisified__",!0),e[p]=g}}return o.toFastProperties(e),e}function _(e,t){return y(e,t,void 0,e)}t.promisify=function(e,t){if("function"!=typeof e)throw new c("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(h(e))return e;var n=_(e,arguments.length<2?i:t);return o.copyDescriptors(e,n,g),n},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");var n=(t=Object(t)).suffix;"string"!=typeof n&&(n="Async");var i=t.filter;"function"!=typeof i&&(i=p);var r=t.promisifier;if("function"!=typeof r&&(r=y),!o.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var a=o.inheritedDataKeys(e),s=0;s<a.length;++s){var l=e[a[s]];"constructor"!==a[s]&&o.isClass(l)&&(v(l.prototype,n,i,r),v(l,n,i,r))}return v(e,n,i,r)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util.js"),a=r.isObject,s=e("./es5.js");function l(e){for(var t=s.keys(e),n=t.length,i=new Array(2*n),o=0;o<n;++o){var r=t[o];i[o]=e[r],i[o+n]=r}this.constructor$(i)}function c(e){var n,r=i(e);return a(r)?(n=r instanceof t?r._then(t.props,void 0,void 0,void 0,void 0):new l(r).promise(),r instanceof t&&n._propagateFrom(r,4),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}r.inherits(l,n),l.prototype._init=function(){this._init$(void 0,-3)},l.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){for(var n={},i=this.length(),o=0,r=this.length();o<r;++o)n[this._values[o+i]]=this._values[o];this._resolve(n)}},l.prototype._promiseProgressed=function(e,t){this._promise._progress({key:this._values[t+this.length()],value:e})},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return c(this)},t.props=function(e){return c(e)}}},{"./es5.js":14,"./util.js":38}],28:[function(e,t,n){"use strict";function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},i.prototype._unshiftOne=function(e){var t=this._capacity;this._checkCapacity(this.length()+1);var n=(this._front-1&t-1^t)-t;this[n]=e,this._front=n,this._length=this.length()+1},i.prototype.unshift=function(e,t,n){this._unshiftOne(n),this._unshiftOne(t),this._unshiftOne(e)},i.prototype.push=function(e,t,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+i-3;this._checkCapacity(i);var r=this._capacity-1;this[o+0&r]=e,this[o+1&r]=t,this[o+2&r]=n,this._length=i},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,n,i,o){for(var r=0;r<o;++r)n[r+i]=e[r+t],e[r+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=i},{}],29:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./util.js").isArray;function a(e,s){var l,c=i(e);if(c instanceof t)return(l=c).then((function(e){return a(e,l)}));if(!r(e))return o("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var d=new t(n);void 0!==s&&d._propagateFrom(s,5);for(var u=d._fulfill,p=d._reject,g=0,h=e.length;g<h;++g){var f=e[g];(void 0!==f||g in e)&&t.cast(f)._then(u,p,void 0,d,null)}return d}t.race=function(e){return a(e,void 0)},t.prototype.race=function(){return a(this,void 0)}}},{"./util.js":38}],30:[function(e,t,n){"use strict";t.exports=function(t,n,i,o,r){var a=t._getDomain,s=e("./async.js"),l=e("./util.js"),c=l.tryCatch,d=l.errorObj;function u(e,n,i,l){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=l===r?[]:null,this._zerothIsAccum=void 0===i,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var c=o(i,this._promise),d=!1,u=c instanceof t;u&&((c=c._target())._isPending()?c._proxyPromiseArray(this,-1):c._isFulfilled()?(i=c._value(),this._gotAccum=!0):(this._reject(c._reason()),d=!0)),u||this._zerothIsAccum||(this._gotAccum=!0);var g=a();this._callback=null===g?n:g.bind(n),this._accum=i,d||s.invoke(p,this,void 0)}function p(){this._init$(void 0,-5)}function g(e,t,n,o){return"function"!=typeof t?i("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new u(e,t,n,o).promise()}l.inherits(u,n),u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},u.prototype._promiseFulfilled=function(e,n){var i=this._values;i[n]=e;var r,a=this.length(),s=this._preservedValues,l=null!==s,u=this._gotAccum,p=this._valuesPhase;if(!p)for(p=this._valuesPhase=new Array(a),r=0;r<a;++r)p[r]=0;if(r=p[n],0===n&&this._zerothIsAccum?(this._accum=e,this._gotAccum=u=!0,p[n]=0===r?1:2):-1===n?(this._accum=e,this._gotAccum=u=!0):0===r?p[n]=1:(p[n]=2,this._accum=e),u){for(var g,h=this._callback,f=this._promise._boundValue(),m=this._reducingIndex;m<a;++m)if(2!==(r=p[m])){if(1!==r)return;if(e=i[m],this._promise._pushContext(),l?(s.push(e),g=c(h).call(f,e,m,a)):g=c(h).call(f,this._accum,e,m,a),this._promise._popContext(),g===d)return this._reject(g.e);var y=o(g,this._promise);if(y instanceof t){if((y=y._target())._isPending())return p[m]=4,y._proxyPromiseArray(this,m);if(!y._isFulfilled())return this._reject(y._reason());g=y._value()}this._reducingIndex=m+1,this._accum=g}else this._reducingIndex=m+1;this._resolve(l?s:this._accum)}},t.prototype.reduce=function(e,t){return g(this,e,t,null)},t.reduce=function(e,t,n,i){return g(e,t,n,i)}}},{"./async.js":2,"./util.js":38}],31:[function(e,o,r){"use strict";var a,s=e("./util");if(s.isNode&&"undefined"==typeof MutationObserver){var l=n.setImmediate,c=t.nextTick;a=s.isRecentNode?function(e){l.call(n,e)}:function(e){c.call(t,e)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?a=void 0!==i?function(e){i(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}:(a=function(e){var t=document.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}).isStatic=!0;o.exports=a},{"./util":38}],32:[function(e,t,n){"use strict";t.exports=function(t,n){var i=t.PromiseInspection;function o(e){this.constructor$(e)}e("./util.js").inherits(o,n),o.prototype._promiseResolved=function(e,t){this._values[e]=t,++this._totalResolved>=this._length&&this._resolve(this._values)},o.prototype._promiseFulfilled=function(e,t){var n=new i;n._bitField=268435456,n._settledValue=e,this._promiseResolved(t,n)},o.prototype._promiseRejected=function(e,t){var n=new i;n._bitField=134217728,n._settledValue=e,this._promiseResolved(t,n)},t.settle=function(e){return new o(e).promise()},t.prototype.settle=function(){return new o(this).promise()}}},{"./util.js":38}],33:[function(e,t,n){"use strict";t.exports=function(t,n,i){var o=e("./util.js"),r=e("./errors.js").RangeError,a=e("./errors.js").AggregateError,s=o.isArray;function l(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(e,t){if((0|t)!==t||t<0)return i("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var n=new l(e),o=n.promise();return n.setHowMany(t),n.init(),o}o.inherits(l,n),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=s(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(e){this._howMany=e},l.prototype._promiseFulfilled=function(e){this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},l.prototype._promiseRejected=function(e){if(this._addRejected(e),this.howMany()>this._canPossiblyFulfill()){for(var t=new a,n=this.length();n<this._values.length;++n)t.push(this._values[n]);this._reject(t)}},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(e){this._values.push(e)},l.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new r(t)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return c(e,t)},t.prototype.some=function(e){return c(this,e)},t._SomePromiseArray=l}},{"./errors.js":13,"./util.js":38}],34:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValue=e._settledValue):(this._bitField=0,this._settledValue=void 0)}t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},t.prototype.isFulfilled=e.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},t.prototype.isRejected=e.prototype._isRejected=function(){return(134217728&this._bitField)>0},t.prototype.isPending=e.prototype._isPending=function(){return 0==(402653184&this._bitField)},t.prototype.isResolved=e.prototype._isResolved=function(){return(402653184&this._bitField)>0},e.prototype.isPending=function(){return this._target()._isPending()},e.prototype.isRejected=function(){return this._target()._isRejected()},e.prototype.isFulfilled=function(){return this._target()._isFulfilled()},e.prototype.isResolved=function(){return this._target()._isResolved()},e.prototype._value=function(){return this._settledValue},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},e.prototype.value=function(){var e=this._target();if(!e.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return e._settledValue},e.prototype.reason=function(){var e=this._target();if(!e.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return e._unsetRejectionIsUnhandled(),e._settledValue},e.PromiseInspection=t}},{}],35:[function(e,t,n){"use strict";t.exports=function(t,n){var i=e("./util.js"),o=i.errorObj,r=i.isObject;function a(e){return e.then}var s={}.hasOwnProperty;return function(e,l){if(r(e)){if(e instanceof t)return e;if(function(e){return s.call(e,"_promise0")}(e)){var c=new t(n);return e._then(c._fulfillUnchecked,c._rejectUncheckedCheckError,c._progressUnchecked,c,null),c}var d=i.tryCatch(a)(e);if(d===o){l&&l._pushContext();c=t.reject(d.e);return l&&l._popContext(),c}if("function"==typeof d)return function(e,r,a){var s=new t(n),l=s;a&&a._pushContext();s._captureStackTrace(),a&&a._popContext();var c=i.tryCatch(r).call(e,(function(e){if(!s)return;s._resolveCallback(e),s=null}),(function(e){if(!s)return;s._rejectCallback(e,!1,!0),s=null}),(function(e){if(!s)return;"function"==typeof s._progress&&s._progress(e)}));!1,s&&c===o&&(s._rejectCallback(c.e,!0,!0),s=null);return l}(e,d,l)}return e}}},{"./util.js":38}],36:[function(e,t,n){"use strict";t.exports=function(t,n){var i=e("./util.js"),o=t.TimeoutError,r=function(e){return a(+this).thenReturn(e)},a=t.delay=function(e,i){if(void 0===i){i=e,e=void 0;var o=new t(n);return setTimeout((function(){o._fulfill()}),i),o}return i=+i,t.resolve(e)._then(r,null,null,i,void 0)};function s(e){var t=this;return t instanceof Number&&(t=+t),clearTimeout(t),e}function l(e){var t=this;throw t instanceof Number&&(t=+t),clearTimeout(t),e}t.prototype.delay=function(e){return a(this,e)},t.prototype.timeout=function(e,t){e=+e;var n=this.then().cancellable();n._cancellationParent=this;var r=setTimeout((function(){!function(e,t){var n;e.isPending()&&(!i.isPrimitive(t)&&t instanceof Error?n=t:("string"!=typeof t&&(t="operation timed out"),n=new o(t)),i.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._cancel(n))}(n,t)}),e);return n._then(s,l,void 0,r,void 0)}}},{"./util.js":38}],37:[function(e,t,n){"use strict";t.exports=function(t,n,i,o){var r=e("./errors.js").TypeError,a=e("./util.js").inherits,s=t.PromiseInspection;function l(e){for(var n=e.length,i=0;i<n;++i){var o=e[i];if(o.isRejected())return t.reject(o.error());e[i]=o._settledValue}return e}function c(e){setTimeout((function(){throw e}),0)}function d(e,n){var o=0,r=e.length,a=t.defer();return function s(){if(o>=r)return a.resolve();var l=function(e){var t=i(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[o++]);if(l instanceof t&&l._isDisposable()){try{l=i(l._getDisposer().tryDispose(n),e.promise)}catch(e){return c(e)}if(l instanceof t)return l._then(s,c,null,null,null)}s()}(),a.promise}function u(e){var t=new s;return t._settledValue=e,t._bitField=268435456,d(this,t).thenReturn(e)}function p(e){var t=new s;return t._settledValue=e,t._bitField=134217728,d(this,t).thenThrow(e)}function g(e,t,n){this._data=e,this._promise=t,this._context=n}function h(e,t,n){this.constructor$(e,t,n)}function f(e){return g.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}g.prototype.data=function(){return this._data},g.prototype.promise=function(){return this._promise},g.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},g.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=null!==t?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},g.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},a(h,g),h.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var o,r=arguments[e-1];if("function"!=typeof r)return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var a=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,a=!1):(o=arguments,e--);for(var s=new Array(e),c=0;c<e;++c){var d=o[c];if(g.isDisposer(d)){var h=d;(d=d.promise())._setDisposable(h)}else{var m=i(d);m instanceof t&&(d=m._then(f,null,null,{resources:s,index:c},void 0))}s[c]=d}var y=t.settle(s).then(l).then((function(e){var t;y._pushContext();try{t=a?r.apply(void 0,e):r.call(void 0,e)}finally{y._popContext()}return t}))._then(u,p,void 0,s,void 0);return s.promise=y,y},t.prototype._setDisposable=function(e){this._bitField=262144|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new h(e,this,o());throw new r}}},{"./errors.js":13,"./util.js":38}],38:[function(e,n,i){"use strict";var o=e("./es5.js"),r="undefined"==typeof navigator,a=function(){try{var e={};return o.defineProperty(e,"f",{get:function(){return 3}}),3===e.f}catch(e){return!1}}(),s={e:{}},l;function c(){try{var e=l;return l=null,e.apply(this,arguments)}catch(e){return s.e=e,s}}function d(e){return l=e,c}var u=function(e,t){var n={}.hasOwnProperty;function i(){for(var i in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,i)&&"$"!==i.charAt(i.length-1)&&(this[i+"$"]=t.prototype[i])}return i.prototype=t.prototype,e.prototype=new i,e.prototype};function p(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function g(e){return!p(e)}function h(e){return p(e)?new Error(A(e)):e}function f(e,t){var n,i=e.length,o=new Array(i+1);for(n=0;n<i;++n)o[n]=e[n];return o[n]=t,o}function m(e,t,n){if(!o.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var i=Object.getOwnPropertyDescriptor(e,t);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function y(e,t,n){if(p(e))return e;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return o.defineProperty(e,t,i),e}function v(e){throw e}var _=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(o.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var i=[],r=Object.create(null);null!=e&&!t(e);){var a;try{a=n(e)}catch(e){return i}for(var s=0;s<a.length;++s){var l=a[s];if(!r[l]){r[l]=!0;var c=Object.getOwnPropertyDescriptor(e,l);null!=c&&null==c.get&&null==c.set&&i.push(l)}}e=o.getPrototypeOf(e)}return i}}var i={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var r in n)if(i.call(n,r))o.push(r);else{for(var a=0;a<e.length;++a)if(i.call(e[a],r))continue e;o.push(r)}return o}}(),b=/this\s*\.\s*\S+\s*=/;function w(e){try{if("function"==typeof e){var t=o.names(e.prototype),n=o.isES5&&t.length>1,i=t.length>0&&!(1===t.length&&"constructor"===t[0]),r=b.test(e+"")&&o.names(e).length>0;if(n||i||r)return!0}return!1}catch(e){return!1}}function C(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}var E=/^[a-z$_][a-z$_0-9]*$/i;function S(e){return E.test(e)}function G(e,t,n){for(var i=new Array(e),o=0;o<e;++o)i[o]=t+o+n;return i}function A(e){try{return e+""}catch(e){return"[no string representation]"}}function T(e){try{y(e,"isOperational",!0)}catch(e){}}function P(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function L(e){return e instanceof Error&&o.propertyIsWritable(e,"stack")}var D="stack"in new Error?function(e){return L(e)?e:new Error(A(e))}:function(e){if(L(e))return e;try{throw new Error(A(e))}catch(e){return e}};function x(e){return{}.toString.call(e)}function I(e,t,n){for(var i=o.names(e),r=0;r<i.length;++r){var a=i[r];if(n(a))try{o.defineProperty(t,a,o.getDescriptor(e,a))}catch(e){}}}var O={isClass:w,isIdentifier:S,inheritedDataKeys:_,getDataPropertyOrDefault:m,thrower:v,isArray:o.isArray,haveGetters:a,notEnumerableProp:y,isPrimitive:p,isObject:g,canEvaluate:r,errorObj:s,tryCatch:d,inherits:u,withAppended:f,maybeWrapAsError:h,toFastProperties:C,filledRange:G,toString:A,canAttachTrace:L,ensureErrorObject:D,originatesFromRejection:P,markAsOriginatingFromRejection:T,classString:x,copyDescriptors:I,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:void 0!==t&&"[object process]"===x(t).toLowerCase()},k;O.isRecentNode=O.isNode&&(k=t.versions.node.split(".").map(Number),0===k[0]&&k[1]>10||k[0]>0),O.isNode&&O.toFastProperties(t);try{throw new Error}catch(e){O.lastLineError=e}n.exports=O},{"./es5.js":14}]},{},[4])(4)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,n(165),n(105),n(1004).setImmediate)},function(e,t,n){(function(e){var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1005),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(105))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var i,o,r,a,s,l=1,c={},d=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick((function(){h(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){h(e.data)},i=function(e){r.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(o=u.documentElement,i=function(e){var t=u.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):i=function(e){setTimeout(h,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),i=function(t){e.postMessage(a+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return c[l]=o,i(l),l++},p.clearImmediate=g}function g(e){delete c[e]}function h(e){if(d)setTimeout(h,0,e);else{var t=c[e];if(t){d=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{g(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(105),n(165))},function(e,t,n){var i,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in i,r=/constructor/i.test(e.HTMLElement)||e.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,d,u){u||(t=c(t));var p,g=this,h="application/octet-stream"===t.type,f=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var o=e["on"+t[i]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){s(e)}}}(g,"writestart progress write writeend".split(" "))};if(g.readyState=g.INIT,o)return p=n().createObjectURL(t),void setTimeout((function(){var e,t;i.href=p,i.download=d,e=i,t=new MouseEvent("click"),e.dispatchEvent(t),f(),l(p),g.readyState=g.DONE}));!function(){if((a||h&&r)&&e.FileReader){var i=new FileReader;return i.onloadend=function(){var t=a?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,g.readyState=g.DONE,f()},i.readAsDataURL(t),void(g.readyState=g.INIT)}(p||(p=n().createObjectURL(t)),h)?e.location.href=p:e.open(p,"_blank")||(e.location.href=p);g.readyState=g.DONE,f(),l(p)}()},u=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(u.abort=function(){},u.readyState=u.INIT=0,u.WRITING=1,u.DONE=2,u.error=u.onwritestart=u.onprogress=u.onwrite=u.onabort=u.onerror=u.onwriteend=null,function(e,t,n){return new d(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this);e.exports?e.exports.saveAs=o:null!==n(1255)&&null!==n(381)&&(void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i))},function(e,t,n){"use strict";n(28),n(129),n(14),n(29),n(45),n(158),n(570);var i=n(1),o=n(341),r=n(230),a=n(1083),s=n(36);function l(e){o.call(this,e)}i.GObject.inherit(l,o);var c=i.GUtil.uuid();l.prototype._totalFonts=0,l.prototype._fontList=null,l.prototype._formattedFontList=null,l.prototype._initialized=!1,l.prototype._initializing=!1,l.prototype._queue=null,l.prototype.addPreviews=function(e){for(var t=0;t<e.length;t++){var n=document.createElement("image");e[t].preview=n}if(e.length){var o=this;for(t=0;t<e.length;t++)e[t].cachedPreview||(e[t].addPreviewCallback=function(e,t){var n=$("<div></div>").addClass("preview-container"),l=document.createElement("div");l.innerHTML=this.displayname||this.family,l.style.fontFamily=this.family,l.style.fontSize=gDesigner.isTouchEnabled()?"20px":"13px",l.style.height=gDesigner.isTouchEnabled()?"30px":"20px",$(l).appendTo(n);var c,d=$("<span></span>").addClass("gravit-icon-trash g-font-delete").attr("name","_SPECIAL_").appendTo(n)[0];l.addEventListener("mouseover",(function(e){e.stopPropagation(),e.preventDefault()})),d.addEventListener("mouseup",e=>{e.stopPropagation(),e.preventDefault();var t=r.getInstance(),n=(e,s)=>{var l=this.fonts;if(s>=l.length){var c=o._formattedFontList.findIndex(e=>e.family===this.family);if(-1===c)return;o._formattedFontList.splice(c,1),o._fontList=[],o._formattedFontList.forEach((function(e){e.fonts.forEach((function(e){o._fontList.push({family:e.family,weight:String(e.weight),style:e.style,subfamily:e.subfamily,displayname:e.displayname})}))})),o._totalFonts--,e.updateItem(a.FONT_LIST,o._fontList.map((function(e){return{family:e.family,weight:e.weight,style:e.style,subfamily:e.subfamily,displayname:e.displayname}}))).done(e=>{for(var n={},o=0;o<this.families.length;o++)n[this.families[o]]="Open Sans";if(gDesigner.getDocuments().forEach(e=>{e.getScene().acceptChildren(e=>{e instanceof i.GText&&e.replaceFonts(n,!0)})}),gDesigner.getWorkspace())for(o=0;o<this.families.length;o++)gDesigner.getWorkspace().getFontManager().removeFont(this.families[o]);r.getInstance().reset(),t&&t.setShowMissingFontsDialog(!0),console.log("successfully updated font list"),this._queue&&this._queue.length&&this._queue.shift().call(this)})}else{var d=l[s],u=d.family+"_"+d.weight+"_"+d.style;e.deleteItem(u).done(()=>{n(e,s+1)})}};s.confirm(i.GLocale.get(new i.GLocaleKey("GImportedFontsProvider","confirm.delete-font")),e=>{e&&(this._queue||(this._queue=[]),this._queue.push(()=>{a.getInstance(e=>{e&&(t&&t.setShowMissingFontsDialog(!1),n(e,0))})}),1===this._queue.length&&this._queue.shift().call(this))})});var u=null;for(c=0;c<o._formattedFontList.length;c++)if(o._formattedFontList[c].family===this.family){u=o._formattedFontList[c];break}u?a.getInstance(e=>{if(e){var t=this.fonts[0];if(t){var n=t.family+"_"+t.weight+"_"+t.style;e.getItem(n).done(e=>{var n=new FileReader;n.onload=()=>{var e=document.createElement("style");e.appendChild(document.createTextNode("@font-face {font-family:"+t.family+";font-style:"+("N"!==t.style?"italic":"normal")+";font-weight:"+t.weight+';src: url("'+n.result+'") format("truetype");}')),document.head.appendChild(e)},n.readAsDataURL(new Blob([e],{type:"application/x-font-ttf"}))})}}}):l.innerHTML="[Unavailable]",e(n)})}},l.prototype.initialize=function(){if(!this._initialized&&!this._initializing){this._initializing=!0;var e=Array.prototype.slice.call(arguments);this.load("%",0,1,{done:function(t,n,i){this._initialized=!0,this._initializing=!1,e.length&&e[0].apply(this,e.slice(1)),this._clearCallbacks()}.bind(this),fail:function(){this._initializing=!1,this._initialized=!0,this._clearCallbacks(!0)}.bind(this)},!0)}},l.prototype.load=function(e,t,n,i,o){if(!this._initialized&&!this._initializing)return this._loadCallbacks.push(function(o){o?i.fail():this.load(e,t,n,i)}.bind(this)),void this.initialize(this.load,e,t,n,i);!this._initializing||o?this._fontList?i.done(this._formattedFontList.filter(t=>e.indexOf("%")>=0?(t.displayname||t.family).toLowerCase().startsWith(e.replace(/%/g,"")):(t.displayname||t.family).toLowerCase()==e.toLowerCase()).slice(t,t+n),!0,null):a.getInstance(o=>{if(!o)return i.fail();o.getItem(a.FONT_LIST).done(o=>{this._fontList=o||[],this._generateFormattedList(),this._totalFonts=this._formattedFontList?this._formattedFontList.length:0,i.done(this._formattedFontList.filter(t=>e.indexOf("%")>=0?(t.displayname||t.family).toLowerCase().startsWith(e.replace(/%/g,"")):(t.displayname||t.family).toLowerCase()==e.toLowerCase()).slice(t,t+n),!0,null),this._clearCallbacks()})}):this._loadCallbacks.push(function(o){o?i.fail():this.load(e,t,n,i)}.bind(this))},l.prototype._generateFormattedList=function(){if(this._fontList){this._formattedFontList=[];for(var e=this._fontList.slice(),t=0;t<e.length;t++){var n=e[t],i=n.displayname||n.family,o=[{weight:parseInt(n.weight),style:n.style,family:n.family,subfamily:n.subfamily||null,displayname:n.displayname||null}],r=[n.family];this._formattedFontList.push({family:null,displayname:i,fonts:o,families:r});for(var a=e.length-1;a>t;a--)i===(e[a].displayname||e[a].family)&&(r.indexOf(e[a].family)<0&&r.push(e[a].family),o.push({weight:parseInt(e[a].weight),style:e[a].style,family:e[a].family,subfamily:e[a].subfamily||null,displayname:e[a].displayname||null}),e.splice(a,1));var s=0,l=r[0].length;if(l>0)for(a=1;a<r.length;a++){if(r[a].toLowerCase().indexOf("regular")>=0){l=0,s=a;break}l>r[a].length&&(l=r[a].length,s=a)}this._formattedFontList[this._formattedFontList.length-1].family=r[s]}}else this._formattedFontList=null},l.prototype._resolveCallbacks=[],l.prototype._loadCallbacks=[],l.prototype._clearCallbacks=function(e){this._resolveCallbacks.forEach((function(t){t(!!e)})),this._resolveCallbacks=[],this._loadCallbacks.forEach((function(e){e()})),this._loadCallbacks=[]},l.prototype.getTotalFonts=function(e){return e?this._formattedFontList.filter(this._searchFilter(e)).length:this._totalFonts},l.prototype.resetProvider=function(){this._fontList=null,this._formattedFontList=null},l.prototype.resolveFont=function(e,t,n,o){if(!this._initialized&&!this._initializing)return this._resolveCallbacks.push(function(i){i?o.fail():this.resolveFont(e,t,n,o)}.bind(this)),void this.initialize(this.resolveFont,e,t,n,o);if(this._initializing)this._resolveCallbacks.push(function(i){i?o.fail():this.resolveFont(e,t,n,o)}.bind(this));else{n=String(n)||"400",t=t||i.GFont.Style.Normal;var r=e+"_"+n+"_"+t;a.getInstance(i=>{if(!i)return o.fail();i.getItem(r).done(a=>{if(a)o.done(a instanceof DataView||a instanceof ArrayBuffer?a:a.buffer);else{if(!this._fontList)return console.warn("NO FONTLIST"),void o.fail();var s=this._fontList.findIndex((function(n){return!(n.family!==e||n.style!==t||!n.subfamily||n.displayname===n.family)}));s>=0?(n=this._fontList[s].weight||"400",r=e+"_"+n+"_"+t,i.getItem(r).done(e=>{e?o.done(e instanceof DataView||e instanceof ArrayBuffer?e:e.buffer):o.fail()})):o.fail()}})})}},l.prototype.getProviderId=function(){return c},e.exports=l},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(28),n(14),n(115),n(129),n(168),n(45),n(29);var i=n(43),o=n(1),r=n(16),a=n(32),s=n(56),l=n(1040),c=n(765),d=n(36);function u(){this.initLayout(),this._container.gOverlay({releaseOnClose:!1,padding:!1})}u.ColorMode={RGB:"rgb",HSV:"hsv",CMYK:"cmyk"},u._ColorModeToFrameworkColorMode={[u.ColorMode.RGB]:o.GColor.ColorModes.RGB,[u.ColorMode.HSV]:o.GColor.ColorModes.HSB,[u.ColorMode.CMYK]:o.GColor.ColorModes.CMYK},u.ColorModeLabel={RGB:"RGB",HSV:"HSB",CMYK:"CMYK"},u.ColorModelFree={RGB:!0},u.ExtendedGamut={COMPONENTS:"cp",COLOR_SLIDER:"cs",MAP:"map"},u.canDragSwatch=!1,u.dragSwatch=null,u.dragDeltaX=0,u.dragDeltaY=0,u.hasDropped=!1,u.EXTEND_DRAG_RANGE=50,o.GObject.inheritAndMix(u,o.GObject),u.enableFileTypes=[{ext:"png",mime:"image/png"},{ext:"jpg",mime:"image/jpeg"},{ext:"jpeg",mime:"image/jpeg"},{ext:"gif",mime:"image/gif"}],u.prototype._container=null,u.prototype._toolbar=null,u.prototype._settingsMenu=null,u.prototype._rgbModeItem=null,u.prototype._hsvModeItem=null,u.prototype._cmykModeItem=null,u.prototype._gradientEditor=null,u.prototype._gradientActions=null,u.prototype._colorEditor=null,u.prototype._patternEditor=null,u.prototype._noiseEditor=null,u.prototype._colorMap=null,u.prototype._colorSlider=null,u.prototype._colorComponents=null,u.prototype._systemColorInput=null,u.prototype._colorPreview=null,u.prototype._colorPreviewOld=null,u.prototype._colorPreviewNew=null,u.prototype._opacitySlider=null,u.prototype._palettes=null,u.prototype._activePalette=null,u.prototype._swatchesScope="user",u.prototype._colorMode=null,u.prototype._oldColor=o.GRGBColor.BLACK,u.prototype._color=o.GRGBColor.BLACK,u.prototype._oldColorOpacity=100,u.prototype._colorOpacity=100,u.prototype._activeGradientStop=null,u.prototype._activeGradient=null,u.prototype._pattern=null,u.prototype._patternUpdateBlocker=!1,u.prototype._texture=null,u.prototype._opacity=null,u.prototype._settings=null,u.prototype._isVisible=!1,u.prototype._extendedGamutInitiated=null,u.prototype._sliderColorThumb=null,u.prototype._sliderOpacityThumb=null,u.prototype._extValue=null,u.prototype.getPattern=function(){return this._pattern},u.prototype.setPattern=function(e){this._updatePattern(e,"set_pattern")},u.prototype.getOpacity=function(){return this._opacity},u.prototype.setOpacity=function(e){this._updateOpacity(e,"set_opacity")},u.prototype.initLayout=function(){this._container=$("<div/>").addClass("pattern-chooser").on("close",function(e,t,n){if(this._settings&&this._settings.onClose&&this._settings.onClose(this._pattern,this._opacity,t,n)){var o=gDesigner.getActiveDocument();o&&(o.getEditor().removeEventListener(i.GEditor.ModifiedEvent,this._closeIfNeeded,this),o.getEditor().keysOn([r.GKey.Constant.OPTION])),gDesigner.getWorkspace().getStyleEdManager()&&gDesigner.getWorkspace().getStyleEdManager().isActivated()&&gDesigner.getWorkspace().getStyleEdManager().removeEventListener(i.GStyleEdManager.EditorEvent,this._styleEditorHandler,this)}}.bind(this)),this._toolbar=$("<div/>").addClass("toolbar").appendTo(this._container),u.PATTERN_TYPES||(u.PATTERN_TYPES=u.initPatternType());var e=u.PATTERN_TYPES.map(u._createPatternOption);this._toolbar.append($("<select></select>").addClass("pattern-type-select").append(e).on("change",e=>{var t=$(e.target).children("option:selected").data("type"),n=$(".colormode-selector").children("option:selected").data("colormode"),i=t.createDefault(this._pattern);null===i?gDesigner.stats("patternchooser_change_type","transparent"):i instanceof o.GBackground?gDesigner.stats("patternchooser_change_type","background"):i instanceof o.GTexturePattern?gDesigner.stats("patternchooser_change_type","texture"):i instanceof o.GNoisePattern?gDesigner.stats("patternchooser_change_type","noise"):i instanceof o.GRadialGradient?gDesigner.stats("patternchooser_change_type","radialgradient"):i instanceof o.GLinearGradient?gDesigner.stats("patternchooser_change_type","lineargradient"):i instanceof o.GAngularGradient?gDesigner.stats("patternchooser_change_type","angulargradient"):i instanceof o.GColor&&gDesigner.stats("patternchooser_change_type","color"),this._updateOpacity(1),this._updatePattern(i,"set_type"),this._updateSwatchesPalette(this._getSwatchScope("global",this._pattern)),this._updateSwatchesPalette(this._getSwatchScope("document",this._pattern)),this.setColorMode(n),this._updateActiveGradient()}));var t=$("<select></select>").addClass("colormode-selector");Array.prototype.forEach.call(Object.keys(u.ColorMode),(function(e){$("<option></option>").addClass("color-mode").data("colormode",u.ColorMode[e]).text(u.ColorModeLabel[e]).appendTo(t).gPro({pro:!u.ColorModelFree[e],feature:e.toLowerCase()})})),t.on("change",a.watchDog.trap(e=>{var t=$(e.target).children("option:selected").data("colormode");u.ColorModelFree[(t||"").toUpperCase()]?gDesigner.stats("patternchooser_change_colormode",t):gDesigner.stats("patternchooser_change_procolormode",t);var n=gDesigner.getActiveDocument().getColorModeElms()||[],i=gDesigner.getActiveDocument().getEditor().getIndividualSelection();i&&(n.push(i[0]),gDesigner.getActiveDocument().setColorModeElms(n)),this.setColorMode(t),this._updateActiveGradient()},e=>{var t=($(e.target).children("option:selected").data("colormode")||"").toUpperCase();return!!gDesigner.isEnabledProFeatures(t.toLowerCase())||!!u.ColorModelFree[t]},e=>{var t=$(e.target).children("option:selected").data("colormode");this.setColorMode(this._colorMode,!0),gDesigner.stats("patternchooser_nonprotriespro_procolormode",t)})).appendTo(this._toolbar),this._gradientEditor=$("<div/>").addClass("gradient-editor").append($("<div/>").addClass("stops")).on("mousedown",function(e){var t=this._gradientEditor.offset(),n=e.pageX-t.left,i={position:n/this._gradientEditor.outerWidth(),color:this._defineStopInitColor(n),opacity:1};this._activeGradient.getStops().push(i);var o=this._insertGradientStop(i);this._setActiveGradientStop(i),this._updatePatternFromActiveGradient(),this._updateOnlineEditorStops(),o.trigger("mousedown")}.bind(this)).appendTo(this._container),this._patternEditor=this._createPatternEditor().appendTo(this._container),this._noiseEditor=this._createNoiseEditor().appendTo(this._container),this._colorEditor=$("<div/>").addClass("color-editor").appendTo(this._container),this._systemColorInput=$("<input>").attr("type","color").css({position:"absolute",visibility:"hidden"}).on("change",function(e){this._updateColor(o.GRGBColor.fromCSSColor($(e.target).val()))}.bind(this)).appendTo(this._colorEditor),this._colorMap=$("<div/>").addClass("color-map").append($("<canvas></canvas>")).append($("<div/>").addClass("overlay").on("mousedown touchstart",this._colorMapMouseDown.bind(this)).on("mousemove",(function(e){e.originalEvent.isTrusted&&(e.preventDefault(),e.stopPropagation())}))).append($("<div/>").addClass("marker")).appendTo(this._colorEditor);var n=$("<div/>").addClass("color-details").appendTo(this._colorEditor);$("<div/>").addClass("color-eyedropper g-flat eye-drop").gEyeDropper().on("colorchange",function(e,t){this._updateColor(new o.GRGBColor(t)),this._updateOpacity(t[3]/255,"eyedropper")}.bind(this)).appendTo(n);var s=$("<div/>").addClass("color-sliders").appendTo(n);this._colorSlider=$("<div>").gColorSlider().css("box-sizing","border-box").on("input",function(){this._updateColorFromColorSlider(!0)}.bind(this)).on("change",function(){gDesigner.stats("patternchooser_change_color-from-colorslider"),this._updateColorFromColorSlider()}.bind(this)).appendTo(s),this._opacitySlider=$("<div/>").gInputSlider(c.prototype.OPACITY_DEFAULT).css("box-sizing","border-box").on("input",function(e){this._updateOpacity($(e.target).gInputSlider("value")/100,"slider",!0)}.bind(this)).on("change",function(e){gDesigner.stats("patternchooser_change_opacity"),this._updateOpacity($(e.target).gInputSlider("value")/100,"slider",!1,!0)}.bind(this)).appendTo(s),this._sliderColorThumb=$(this._colorSlider).find(".g-input-slider-thumb").css("box-sizing","border-box"),this._sliderOpacityThumb=$(this._opacitySlider).find(".g-input-slider-thumb").css("box-sizing","border-box");var l=$("<div/>").addClass("color-preview-container").appendTo(n);this._colorPreview=$("<div/>").addClass("color-preview").css("background",o.GPattern.asCSSBackground(null,0)).appendTo(l),this._colorPreviewOld=$("<div/>").addClass("color-preview-old").appendTo(this._colorPreview),this._colorPreviewNew=$("<div/>").addClass("color-preview-new").appendTo(this._colorPreview),$("<div/>").addClass("color-preview-overlay").appendTo(this._colorPreview),this._colorComponents=$("<div/>").addClass("color-components").appendTo(this._colorEditor),this._gradientActions=$("<div/>").addClass("gradient-actions").append($("<button />").addClass("g-flat").attr("data-action","exchange").attr("data-title",o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.change-stops-order"))).on("click",function(){gDesigner.stats("patternchooser_change_stops-order");for(var e=this._activeGradient.getStops(),t=0;t<e.length;++t)e[t].position=1-e[t].position,this._updateGradientStop(e[t]);this._updatePatternFromActiveGradient()}.bind(this)).append($("<span />").addClass("gravit-icon-exchange"))).append($("<div/>").addClass("g-flat").css("float","right").append($("<button />").addClass("g-flat").attr("data-action","rotate-left").attr("data-title",o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.rotate-gradient-left"))).on("click",function(){gDesigner.stats("patternchooser_rotate_gradient","left"),this._rotateActiveGradient(-45)}.bind(this)).append($("<span />").addClass("gravit-icon-rotate-left"))).append($("<button />").addClass("g-flat").attr("data-action","rotate-right").attr("data-title",o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.rotate-gradient-right"))).on("click",function(){gDesigner.stats("patternchooser_rotate_gradient","right"),this._rotateActiveGradient(45)}.bind(this)).append($("<span />").addClass("gravit-icon-rotate-right")))).appendTo(this._container),this._palettes=$("<div/>").addClass("palettes").appendTo(this._container);var d=function(e){var t=$(e.target).closest("[data-palette]").attr("data-palette");gDesigner.stats("patternchooser_activate_palette",t),this._activatePalette(t)}.bind(this);this._createChoosers(d).appendTo(this._palettes),this._createColorsPalette($("<div/>").attr("data-palette","colors").addClass("palette colors-palette").appendTo(this._palettes)),this._createMixerPalette($("<div/>").attr("data-palette","mixer").addClass("palette mixer-palette").appendTo(this._palettes)),$("<div/>").attr("data-palette","used").addClass("palette used-palette").appendTo(this._palettes);var p=$("<div/>").attr("data-palette","swatches").addClass("palette swatches-palette global").appendTo(this._palettes);const g=this._palettes.find(".chooser").find("button[data-palette=swatches]").hasClass("trial")?" trial":"";this._createSwatchesPalette(p,"global"+g),this._createSwatchesPalette($("<div/>").attr("data-palette","swatches").addClass("palette swatches-palette document").appendTo(this._palettes),"document"),this._swatchesScope=this._getSwatchScope("global",this._pattern),this._activatePalette("colors"),this._container.find("button").each((function(e,t){$(t).on("mousedown",(function(e){e.preventDefault()}))})),this.setColorMode(u.ColorMode.RGB)},u.prototype._createChoosers=function(e){return $("<div/>").addClass("chooser").append($("<button />").attr("data-palette","colors").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.colors"))).on("click",e)).append($("<button />").gPro({feature:"swatches"}).attr("data-palette","swatches").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.swatches"))).on("click",a.watchDog.trap(e,null,()=>gDesigner.stats("patternchooser_nonprotriespro_palette","swatches"),"swatches"))).append($("<button />").attr("data-palette","used").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.in-use"))).on("click",e)).append($("<button />").attr("data-palette","mixer").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.mixer"))).on("click",e))},u.prototype.__getColorModeParams=function(){return{hexWidth:"27%",isTouchEnabled:!1,rgbWidth:"15%",cmykWidth:"18%"}},u.prototype._updateActiveGradient=function(){if(this._activeGradient){const e=this._activeGradient.getStops();if(e&&e.length){const t=u._ColorModeToFrameworkColorMode[this._colorMode]||o.GColor.ColorModes.RGB;e.forEach(e=>{const n=o.GColorHelper.convertColor(e.color,t);n&&(e.color=n),this._updateGradientStop(e)}),this._updatePatternFromActiveGradient()}}},u.prototype.setColorMode=function(e,t){var n=this.__getColorModeParams();if(e!==this._colorMode||t){this._colorMode=e;var i=null;if(this._toolbar.find(".color-mode").each((t,n)=>{var i=$(n),o=i.data("colormode");o&&i.prop("selected",e===o)}),this._colorComponents.empty(),this._colorMode===u.ColorMode.RGB||this._colorMode===u.ColorMode.HSV){this._colorMap.css("display",""),this._colorSlider.css("display",""),this._colorEditor.toggleClass("cmyk-mode",!1),this._opacitySlider.toggleClass("cmyk-mode",!1),$("<label />").css("width",n.hexWidth).attr("data-css","").append($("<input>").attr("type","text").attr("data-long-press-delay","500").gInputBox({keyIncrement:!1,wheelIncrement:!1,mousemoveIncrement:!1}).on("long-press",e=>{n.isTouchEnabled&&(this._currentLongPressTarget=e.target,this._contextMenu.open(e.target))}).on("change",function(t){var n=o.GRGBColor.fromCSSColor($(t.target).val());n||(n=this._color),e===u.ColorMode.HSV&&(n=new o.GHSVColor(o.GColor.rgbToHSV(n.getValue()))),gDesigner.stats("patternchooser_update_color",e),this._updateColor(n,null,!1,!0)}.bind(this)).on("paste keydown keyup",e=>{var t=$(e.target),n=e.target,i=t.val();if("keydown"===e.type){var o=/[0-9a-z\u017F\u212A]/i.test(String.fromCharCode(e.keyCode||e.charCode));if(i.length>=7&&o&&n.selectionStart===n.selectionEnd)return!1}i.startsWith("#")||(i="#"+i,t.val(i));var r=/^#[0-9A-Za-z]{0,6}/.exec(i);r&&r[0]&&i!==r[0]&&t.val(r[0])})).append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.hex")))).appendTo(this._colorComponents),n.isTouchEnabled&&$("<div/>").css("width","11%").appendTo(this._colorComponents);var r=this._colorMode===u.ColorMode.RGB?["R","G","B"]:["H","S","B"];Array.prototype.forEach.call(r,function(e,t){var i=0;switch(e){case"R":case"G":case"B":this._colorMode===u.ColorMode.RGB?i=255:this._colorMode===u.ColorMode.HSV&&(i=100);break;case"H":i=360;break;case"S":i=100}$("<label />").css("width",n.rgbWidth).attr("data-component-index",t).append($("<input>").attr("type","text").gInputBox({minValue:0,maxValue:i})).append($("<span />").text(e)).appendTo(this._colorComponents)}.bind(this))}else this._colorMode===u.ColorMode.CMYK&&(this._colorMap.css("display","none"),this._colorEditor.toggleClass("cmyk-mode",!0),this._opacitySlider.toggleClass("cmyk-mode",!0),this._colorSlider.css("display","none"),Array.prototype.forEach.call(["C","M","Y","K"],function(e,t){$("<label />").addClass("cymk-label").css("width",n.cmykWidth).attr("data-component-index",t).append($("<input>").attr("type","text").gInputBox({minValue:0,maxValue:100,postfix:"%"})).append($("<span />").text(e)).appendTo(this._colorComponents)}.bind(this)),this._color instanceof o.GCMYKColor||(i=new o.GCMYKColor(o.GColor.rgbToCMYK(this._color.toScreen()))));var a=this._updateColorFromColorComponents.bind(this);this._colorComponents.find("[data-component-index] input").each((function(e,t){$(t).on("change",()=>{gDesigner.stats("patternchooser_change_colorinput"),a()})})),$("<label />").css("width","18%").attr("data-opacity","").append($("<input>").attr("type","text").gInputBox({minValue:0,maxValue:100,postfix:"%"}).gInputBox("value",o.GUtil.formatOpacity(100*this._colorOpacity)).on("change",function(e){gDesigner.stats("patternchooser_change_opacity"),this._updateOpacity(o.GLength.parseEquationValue($(e.target).gInputBox("value"))/100,"input")}.bind(this))).append($("<span />").text("A")).appendTo(this._colorComponents),this._updateColorMap(),i?this._updateColor(i,"mode"):this._updateColorComponentsFromColor(),this._relayout()}},u.prototype.open=function(e,t){this._updateSettings(t,!0),this._container.gOverlay("open",e),"used"===this._activePalette&&this._updateUsedPalette(),gDesigner.getWorkspace().getStyleEdManager()&&gDesigner.getWorkspace().getStyleEdManager().isActivated()&&gDesigner.getWorkspace().getStyleEdManager().addEventListener(i.GStyleEdManager.EditorEvent,this._styleEditorHandler,this);var n=gDesigner.getActiveDocument();n&&(n.getEditor().addEventListener(i.GEditor.ModifiedEvent,this._closeIfNeeded,this),n.getEditor().keysOff([r.GKey.Constant.OPTION]))},u.prototype.close=function(){this._container.gOverlay("close")},u.prototype.isOpenned=function(e){return this._container.gOverlay("isOpenned",e)},u.prototype.setActiveGradientStopByIdx=function(e){if(this._activeGradient&&null!==e){var t=this._activeGradient.getStops();if(e>=0&&e<t.length){var n=t[e];this._setActiveGradientStop(n),this._updateOnlineEditorStops()}}},u.prototype._updateSettings=function(e,t){this._settings=t?$.extend({types:[]},e):$.extend({types:[]},this._settings,e);const{types:n,singleOption:i}=this._settings;if(i)this._toolbar.css("display","none");else{"none"===this._toolbar.css("display")&&this._toolbar.css("display","");const e=[];for(let t=0,i=u.PATTERN_TYPES.length;t<i;t++){var o=u.PATTERN_TYPES[t],r=!n.length;if(!r)for(var a=0;a<n.length;++a)if(o.isCompatible(n[a])){r=!0;break}if(r){var s=u._createPatternOption(o);e.push(s)}}this._toolbar.find(".pattern-type-select").empty().append(e)}this._opacitySlider.gInputSlider("disabled",this._settings.hasOwnProperty("hasOpacity")&&!this._settings.hasOpacity),this._patternEditor.find('[data-property="texture_mask"]').prop("disabled",!this._settings.hasMask)},u.prototype._createNoiseEditor=function(){var e=$("<div/>").addClass("noise-editor");$("<div/>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.intensity")),columns:[{width:"auto",content:$("<div/>").attr("data-property","noise_amount").gInputSlider({min:0,max:100}).on("input",function(t){var n=$(t.target),i=parseFloat(n.gInputSlider("value"))/100;if(e.find('[type="text"][data-property="noise_amount"]').gInputBox("value",o.GUtil.formatNumber(100*i,0)),this._pattern){var r=this._pattern.clone();r.setAmount(i),this._updatePattern(r,"noise_amount",null,!0)}}.bind(this)).on("change",function(e){if(gDesigner.stats("patternchooser_change_noise-amount"),this._pattern){var t=this._pattern.clone();t.setAmount(parseFloat($(e.target).gInputSlider("value"))/100),this._updatePattern(t,"noise_amount")}}.bind(this))},{width:"40px",content:$("<input>").attr("data-property","noise_amount").attr("type","text").on("change",function(e){if(gDesigner.stats("patternchooser_change_noise","amount"),this._pattern){var t=this._pattern.clone();t.setAmount(o.GLength.parseEquationValue($(e.target).gInputBox("value"))/100),this._updatePattern(t,"noise_amount")}}.bind(this)).gInputBox({minValue:0,maxValue:100,incrementValue:1})}]}).appendTo(e);var t,n,i;return $("<div/>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.type")),columns:[{width:"auto",content:(t=o.GNoisePattern.Type,n="type",i=$("<select></select>"),t=t||[],Array.prototype.forEach.call(Object.keys(t),(function(e){$("<option></option>").attr("value",t[e]).text(o.GLocale.get(new o.GLocaleKey("GCommonNames","noise."+n+"."+t[e]))).appendTo(i)})),i).attr("data-property","noise_type").on("change",function(e){if(gDesigner.stats("patternchooser_change_noise","type"),this._pattern){var t=this._pattern.clone();t.setType($(e.target).val()),this._updatePattern(t,"noise_type")}}.bind(this))}]}).appendTo(e),e},u.prototype._createPatternEditorFirstRow=function(e,t){return[{padding:!1,content:$("<button>"+o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.choose-image"))+"...</button>").addClass("pattern-choose-image-button").on("click",e)},{width:"auto",content:$("<button />").addClass("paste-btn").addClass("g-flat").append($("<span />").addClass("gravit-icon-paste")).append($("<span />").addClass("title").html(o.GLocale.get(new o.GLocaleKey("GPasteAction","title")))).on("click",t)}]},u.prototype._createPatternEditorMaskRow=function(e){return[{padding:!1,width:"auto",content:$("<span />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.set-transparency-mask")))},{padding:!1,width:"40px",content:$("<label />").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-property","texture_mask").prop("disabled",!0).on("change",e)).append($("<div/>"))}]},u.prototype._createPatternEditorScaleRow=function(e,t,n){return[{width:"auto",content:$("<div/>").attr("data-property","texture_tile").gInputSlider({min:10,max:200}).on("input",e).on("change",t)},{width:"40px",content:$("<input>").attr("data-property","texture_tile").attr("type","text").on("change",n).gInputBox({minValue:10,maxValue:200,incrementValue:1,postfix:"%"})}]},u.prototype._createPatternEditorAdvancedRow=function(e){return[{width:"auto",content:$("<button>"+o.GLocale.get(new o.GLocaleKey("GCommonNames","text.advanced"))+"</button>").on("click",function(){gDesigner.stats("patternchooser_click_advanced"),e.slideToggle()}.bind(this))}]},u.prototype.__getCreatePatternEditorParams=function(){return{isTouchEnabled:!1,repeatWidth:"50%",ghostWidth:"0%",postionWith:"50%",sizeWidth:"52%",unitWidth:"10%"}},u.prototype._createPatternEditor=function(){var e=this.__getCreatePatternEditorParams(),t=$("<div/>").addClass("pattern-editor"),n=function(e,t){var n=$("<select></select>");return e=e||[],Array.prototype.forEach.call(Object.keys(e),(function(i){$("<option></option>").attr("value",e[i]).text(o.GLocale.get(new o.GLocaleKey("GCommonNames","texture."+t+"."+e[i]))).appendTo(n)})),n},i=e=>{gDesigner.stats("patternchooser_change_texture","mask");var t=this._pattern.clone();t.setMask($(e.target).prop("checked")),this._updatePattern(t,"texture_mask")},r=e=>{var n=$(e.target),i=n.attr("data-property"),r=parseFloat(n.gInputSlider("value"))/100;if(t.find('[type="text"][data-property="'+i+'"]').gInputBox("value",o.GUtil.formatNumber(100*r,0)),this._pattern){var a=this._pattern.clone();a.setTileSize(r),this._updatePattern(a,"texture_tile",null,!0)}},a=e=>{if(gDesigner.stats("patternchooser_change_texture","tile"),this._pattern){var t=this._pattern.clone();t.setTileSize(parseFloat($(e.target).gInputSlider("value"))/100),this._updatePattern(t,"texture_tile")}},s=e=>{if(gDesigner.stats("patternchooser_change_texture","tile"),this._pattern){var t=this._pattern.clone();t.setTileSize(o.GLength.parseEquationValue($(e.target).gInputBox("value"))/100),this._updatePattern(t,"texture_tile")}};$("<div/>").addClass("choose-section").append($("<div/>").addClass("pattern-preview-container").append($("<div/>").addClass("pattern-preview"))).append($("<div/>").addClass("pattern-info-container").append($("<div/>").gPropertyRow({clazz:"first-row",columns:this._createPatternEditorFirstRow(()=>{gDesigner.stats("patternchooser_choose_image");var e=gDesigner.getActiveDocument(),t=t||(e?e.getStorage():null)||gDesigner.getDefaultStorage();t&&t.canPromptOpen()&&t.openPrompt(u.enableFileTypes,e=>{e.read(e=>{var t=new FileReader;t.onload=()=>{var e,n=t.result;this._pattern instanceof o.GTexturePattern?(e=this._pattern.clone()).setTexture(n):(e=new o.GTexturePattern(n)).setScene(gDesigner.getActiveDocument().getScene()),this._updatePattern(e,"texture_upload")},t.readAsDataURL(new Blob([e]))})},!1)},()=>{gDesigner.stats("patternchooser_paste_texture");var e=!1,t=o.GNode.deserialize(gDesigner.getClipboardContent(o.GNode.MIME_TYPE));if(t&&t.length)for(var n=0;n<t.length;++n){var i=t[n];if(i.hasMixin(o.GVertexSource)||i instanceof o.GGroup){if(this._pattern){var r=this._pattern.clone();r.setTexture(i),this._updatePattern(r,"texture_paste")}e=!0;break}}e||window.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","arrow-paste.alert")))})})).append($("<div/>").gPropertyRow({columns:[{width:"100%",content:n(o.GTexturePattern.ScaleMode,"scale").attr("data-property","texture_scale").on("change",function(e){if(this._pattern){var t=this._pattern.clone();t.setScaleMode($(e.target).val()),(0,o.GTexturePattern.ScaleSettings[$(e.target).val()])(t),gDesigner.stats("patternchooser_change_texture",t.getScaleMode()),this._updatePattern(t,"texture_pattern")}}.bind(this))}]})).append($("<div/>").gPropertyRow({columns:e.isTouchEnabled?this._createPatternEditorMaskRow(i):this._createPatternEditorScaleRow(r,a,s)}))).appendTo(t),$("<div/>").addClass(e.isTouchEnabled?"scale":"").gPropertyRow({columns:e.isTouchEnabled?this._createPatternEditorScaleRow(r,a,s):this._createPatternEditorMaskRow(i)}).appendTo(t);var l=$("<div/>").addClass("pattern-advanced-settings");return $("<div/>").gPropertyRow({columns:this._createPatternEditorAdvancedRow(l)}).appendTo(t),$("<div/>").gPropertyRow({columns:[{label:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.repeat")),width:e.repeatWidth,content:n(o.GTexturePattern.RepeatMode,"repeat").attr("data-property","texture_repeat").on("change",function(e){if(gDesigner.stats("patternchooser_change_texture","repeat"),this._pattern){var t=this._pattern.clone();t.setRepeatMode($(e.target).val()),this._updatePattern(t,"texture_repeat")}}.bind(this))},{width:e.ghostWidth},{label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.position")),width:e.postionWith,content:n(o.GTexturePattern.PositionMode,"position").attr("data-property","texture_position").on("change",function(e){if(gDesigner.stats("patternchooser_change_texture","position"),this._pattern){var t=this._pattern.clone();t.setPosition($(e.target).val()),this._updatePattern(t,"texture_position")}}.bind(this))}]}).gPropertyRow({columns:[{label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.size")),width:e.sizeWidth,content:n(o.GTexturePattern.SizeMode,"size").attr("data-property","texture_size").on("change",function(e){if(gDesigner.stats("patternchooser_change_texture","size"),this._pattern){var t=this._pattern.clone();t.setSizeMode($(e.target).val()),this._updatePattern(t,"texture_size")}}.bind(this))},{width:e.ghostWidth},{label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width")),width:"20%",content:$("<input>").attr("data-property","texture_size_w").attr("type","text").on("change",function(e){if(gDesigner.stats("patternchooser_change_texture","size"),this._pattern){var t=o.GLength.parseEquationValue($(e.target).val());if(null!==t&&t>=0){var n=this._pattern.clone();n.setWidth(t),this._updatePattern(n,"texture_size")}}}.bind(this)).gInputBox()},{label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.height")),width:"20%",content:$("<input>").attr("data-property","texture_size_h").attr("type","text").on("change",function(e){if(gDesigner.stats("patternchooser_change_texture","size-h"),this._pattern){var t=o.GLength.parseEquationValue($(e.target).val());if(null!==t&&t>=0){var n=this._pattern.clone();n.setHeight(t),this._updatePattern(n,"texture_size")}}}.bind(this)).gInputBox()},{label:e.isTouchEnabled?"":o.GLocale.get(new o.GLocaleKey("GCommonNames","text.unit")),width:e.unitWidth,content:$("<label />").attr("data-property","texture_size_u")}]}).appendTo(l),l.appendTo(t),t},u.prototype.__getCreatePaletteSwatchParamas=function(){return{isTouchEnabled:!1}},u.prototype._findOrCreateLastSwitchContiner=function(e){var t=e.find(".swatches:last");t.length>0?t.find(".swatch").length>=8&&(t=$("<div/>").addClass("swatches").appendTo(e)):t=$("<div/>").addClass("swatches").appendTo(e);return t},u.prototype._createPaletteSwatch=function(e,t,n,i){var a=this.__getCreatePaletteSwatchParamas(),s=e instanceof o.GSwatch?e:new o.GSwatch(e),l=t;a.isTouchEnabled&&(l=i?$("<div/>").addClass("swatches").appendTo(t):this._findOrCreateLastSwitchContiner(t));var c=function(e){if(!u.canDragSwatch)return e.preventDefault(),void e.stopPropagation();var t=$(e.target).closest(".swatch"),n=t.offset(),i=e.originalEvent;i.stopPropagation(),u.dragSwatch=t,u.hasDropped=!1,u.dragDeltaX=i.pageX-n.left,u.dragDeltaY=i.pageY-n.top,i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("text/plain","dummy_data")}.bind(this),d=function(e){var t=e.originalEvent;t.stopPropagation(),l.find(".grid-drag-overlay").remove();var n=!1,i=$(".pattern-chooser"),r=i.offset().top,a=i.offset().left,s=a+i.width(),c=r+i.height(),d=t.pageX,p=t.pageY;if((d>s||d<a||p>c||p<r)&&(n=!0),u.dragSwatch&&n){var g=gDesigner.getActiveDocument().getEditor();g.beginTransaction();try{var h=u.dragSwatch.data("swatch"),f=this._getSwatchScope(u.dragSwatch.closest(".swatches-wrapper").hasClass("global")?"global":"document",h.getProperty("_pt")),m=gDesigner.getSwatches(f);if(h&&m){for(var y=0;y<m.length;++y)if(o.GUtil.equals(h,m[y])){(m=m.slice()).splice(y,1);break}gDesigner.setSwatches(f,m)}}finally{g.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.remove-swatch")),{chooserOn:!0})}}u.hasDropped=!1}.bind(this),p=s.getProperty("_pt"),g=s.getProperty("_op"),h=$("<div/>").addClass("swatch").css("background",o.GPattern.asCSSBackground(p,g)).data("swatch",s).attr("draggable",n).attr("data-long-press-delay","500").on("long-press",e=>{a.isTouchEnabled&&(this._currentLongPressTarget=e.target,this._contextMenu.open(e.target))}).on("click",function(e){gDesigner.stats("patternchooser_click_swatch");var t=$(e.target).closest(".swatch").data("swatch"),n=t.getProperty("_pt"),i=t.getProperty("_op"),a=$(".colormode-selector").children("option:selected").data("colormode");if(r.GPlatform.modifiers.optionKey){var s=gDesigner.getActiveDocument().getEditor().selectFromPattern(n,!0);if(s){$(".g-overlay .pattern-chooser").length>0&&$(".g-overlay .pattern-chooser").gOverlay("close"),gDesigner.getActiveDocument().getEditor().updateSelection(!1,s),gDesigner.getActiveDocument().getEditor().blinkSelection(2e3,4);for(var l=$(".fill-properties-panel .g-pattern-chooser .preview"),c=0;c<l.length;++c)if($(l[c]).data("gpatterntarget")&&o.GUtil.equals($(l[c]).data("gpatterntarget").pattern,n)){$(l[c]).trigger("click");break}}}else this._updateOpacity(i),this._updatePattern(n,"set_type",!0);this.setColorMode(a)}.bind(this)).appendTo(l);s.isCMYK()&&this._addCmykIcon(h),n&&h.on("mousedown",(function(e){u.canDragSwatch=$(e.target).hasClass("swatch")})).on("dragenter",(function(){(function(e){let t=u.dragSwatch.closest(".swatches-wrapper").hasClass("global"),n=e.closest(".swatches-wrapper").hasClass("global"),i=u.dragSwatch.data("swatch").isCMYK()===e.data("swatch").isCMYK();return!(!(t&&n||!t&&!n)||!i)})($(this))&&$(this).addClass("g-drop")})).on("dragleave",(function(){$(this).removeClass("g-drop")})).on("dragstart",c).on("dragend",d).on("dragover",(function(e){e.preventDefault()})).on("drop",function(){l.find(".grid-drag-overlay").remove();var e=u.dragSwatch.closest(".swatches-wrapper").find(".g-drop");if(e.removeClass("g-drop"),u.dragSwatch&&e.length>0){var t=u.dragSwatch.data("swatch"),n=$(e).data("swatch"),i=this._getSwatchScope(u.dragSwatch.closest(".swatches-wrapper").hasClass("global")?"global":"document",t.getProperty("_pt")),r=gDesigner.getSwatches(i),a=-1,s=-1;if(t&&r&&n){for(var c=0;c<r.length;++c)o.GUtil.equals(t,r[c])?a=c:o.GUtil.equals(n,r[c])&&(s=c);a>-1&&s>-1&&((r=r.slice()).splice(a,1),r.splice(s,0,t)),gDesigner.setSwatches(i,r)}}}.bind(this))},u.prototype._addCmykIcon=function(e){e.append($("<div/>").addClass("cmyk-swatch").append($("<div/>").addClass("cmyk-icon c")).append($("<div/>").addClass("cmyk-icon m")).append($("<div/>").addClass("cmyk-icon y")).append($("<div/>").addClass("cmyk-icon k")))},u.prototype.__getCreateColorsPaletteParams=function(){return{isTouchEnabled:!1}},u.prototype._createColorsPalette=function(e){var t=this.__getCreatePaletteSwatchParamas(),n=$("<div/>").addClass("swatches").appendTo(e);t.isTouchEnabled&&(n=e);var i=[0,0,0],r=[255,255,255];this._createPaletteSwatch(new o.GRGBColor(i),n,!1,!1);for(var a=1;a<=10;a+=1)this._createPaletteSwatch(new o.GRGBColor(o.GRGBColor.blend(i,r,a*(1/11))),n,!1,!1);this._createPaletteSwatch(new o.GRGBColor(r),n,!1,!1);var s=[[152,0,0],[255,0,0],[255,153,0],[255,255,0],[0,255,0],[0,255,255],[0,150,136],[96,125,139],[74,134,232],[0,0,255],[153,0,255],[255,0,255]],l=[];for(let n=-1;n<l.length;++n){var c=e;t.isTouchEnabled||(c=$("<div/>").addClass("swatches").appendTo(e));var d=null,u=0;n>=0&&(d=l[n].color,u=l[n].factor);for(let e=0;e<s.length;++e){var p=s[e],g=d?o.GRGBColor.blend(p,d,u):p;this._createPaletteSwatch(new o.GRGBColor(g),c,!1,!1)}}},u.prototype._createMixerPalette=function(e){for(var t=$("<div/>").attr("data-container","tints").addClass("swatches").append($("<label />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.tints")))).appendTo(e),n=$("<div/>").attr("data-container","shades").append($("<label />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.shades")))).addClass("swatches").appendTo(e),i=$("<div/>").attr("data-container","tones").append($("<label />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.tones")))).addClass("swatches").appendTo(e),r=$("<div/>").attr("data-container","mixes").append($("<label />").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.mixes")))).addClass("swatches").appendTo(e),a=1;a<=10;a+=1)this._createPaletteSwatch(o.GRGBColor.WHITE,t),this._createPaletteSwatch(o.GRGBColor.WHITE,n),this._createPaletteSwatch(o.GRGBColor.WHITE,i),this._createPaletteSwatch(o.GRGBColor.WHITE,r);this._updateMixerPalette()},u.prototype.__getUpdateMixerPaletteParams=function(){return{maxCount:10}},u.prototype._updateMixerPalette=function(){var e=this.__getUpdateMixerPaletteParams();function t(e,t,n){$(t[n]).css("background",o.GPattern.asCSSBackground(e)).data("swatch",new o.GSwatch(e))}for(var n=[255,255,255],i=[0,0,0],r=[128,128,128],a=this._color.toScreen(),s=this._palettes.find('.mixer-palette [data-container="tints"] .swatch'),l=this._palettes.find('.mixer-palette [data-container="shades"] .swatch'),c=this._palettes.find('.mixer-palette [data-container="tones"] .swatch'),d=this._palettes.find('.mixer-palette [data-container="mixes"] .swatch'),u=0;u<e.maxCount;u+=1){var p=(u+1)/(1*e.maxCount);t(new o.GRGBColor(o.GRGBColor.blend(a,n,p)),s,u),t(new o.GRGBColor(o.GRGBColor.blend(a,i,p)),l,u),t(new o.GRGBColor(o.GRGBColor.blend(a,r,p)),c,u),t(new o.GRGBColor(o.GRGBColor.blend(a,this._oldColor.toScreen(),p)),d,u)}},u.prototype.__getCreateUsedPaletteParams=function(){return{isTouchEnabled:!1,maxCount:12}},u.prototype._createUsedPalette=function(e){var t=this.__getCreateUsedPaletteParams();let n;t.isTouchEnabled||(n=$("<div/>").addClass("swatches").appendTo(e));for(var i=0;i<t.maxCount;i+=1)this._createPaletteSwatch(o.GRGBColor.WHITE,t.isTouchEnabled?e:n,!1,!1)},u.prototype._updateUsedPalette=function(){var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getDocumentColors():[];$(".palettes > .used-palette").empty(),this._createUsedPalette($(".palettes > .used-palette"));for(var t=12,n=0;n<t;n+=1){var i=n<e.length,r=i?e[n]:null,a=this._palettes.find(".used-palette .swatches .swatch")[n],s=new o.GSwatch(r);i&&$(a).css("background",o.GPattern.asCSSBackground(r)).data("swatch",s),$(a).css("display",i?"":"none"),s.isCMYK()&&this._addCmykIcon($(a)),n%11==0&&i&&(t+=12,this._createUsedPalette($(".palettes > .used-palette")))}},u.prototype._createSwatchesPalette=function(e,t){var n=$("<span/>").text("global"===t?o.GLocale.get(new o.GLocaleKey("GCommonNames","text.global")):o.GLocale.get(new o.GLocaleKey("GCommonNames","text.document"))),i=$("<div/>").addClass("swatches-wrapper").addClass(t),r=$("<div/>").addClass("toolbar").addClass(t).append(n).append($("<button/>").append("<span/>").attr("data-title",o.GLocale.get(new o.GLocaleKey("GCommonNames","text.import-swatches"))).addClass("swatch-icon").addClass("gravit-icon-swatches-import").on("click",()=>{gDesigner.stats("patternchooser_import_swatches"),gDesigner.importSwatches(t)})).append($("<button/>").append("<span/>").attr("data-title",o.GLocale.get(new o.GLocaleKey("GCommonNames","text.export-swatches"))).addClass("swatch-icon").addClass("gravit-icon-swatches-export").on("click",()=>{gDesigner.stats("patternchooser_export_swatches"),gDesigner.exportSwatches(t)})).appendTo(e);i.appendTo(e),r.gAccordion(i,"span",!1)},u.prototype._getSwatchScope=function(e,t){return t&&t instanceof o.GLinearGradient?e+"-linear-gradient":t&&t instanceof o.GRadialGradient?e+"-radial-gradient":t&&t instanceof o.GAngularGradient?e+"-angular-gradient":t&&t instanceof o.GTexturePattern&&!(t instanceof o.GNoisePattern)?e+"-texture-pattern":t&&t instanceof o.GNoisePattern?e+"-noise-pattern":e},u.prototype.__getUpdateSwatchesPaletteParams=function(){return{isTouchEnabled:!1}},u.prototype._updateSwatchesPalette=function(e){var t=this.__getUpdateSwatchesPaletteParams(),n=e.indexOf("-")>0,i=this._palettes.find(".swatches-palette .swatches-wrapper."+(n?e.substring(0,e.indexOf("-")):e)).empty(),r=gDesigner.getSwatches(e);if(!r)return void $("<div/>").addClass("info").text(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.error-on-loading"))).appendTo(i);var a=[],s=[];for(let e=0;e<r.length;++e)r[e].isCMYK()?s.push(r[e]):a.push(r[e]);a=a.concat(s);let l=null;var c=1;if(!t.isTouchEnabled&&a.length)for(let e=0;e<a.length;++e)l||(l=$("<div/>").addClass("swatches").appendTo(i)),this._createPaletteSwatch(a[e],l,!0,!1),14==++c&&(c=1,l=null);if(l||(l=$("<div/>").addClass("swatches").appendTo(i)),$("<button />").addClass(t.isTouchEnabled?"add-button swatch-button":"swatch-button").addClass("g-flat").attr("data-title",o.GLocale.get(new o.GLocaleKey("GPatternChooser","action.add-swatch"))).append($('<span class="gravit-icon-plus"/>')).on("click",function(){gDesigner.stats("patternchooser_add_swatch",e);var t=new o.GSwatch(this._pattern,this._opacity),n=gDesigner.getSwatches(e);if(n){for(var i=0;i<n.length;++i)if(o.GUtil.equals(t,n[i],!0))return void d.alert(o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.equal-swatch-alert")));n.push(t),gDesigner.setSwatches(e,n)}}.bind(this)).appendTo(l),t.isTouchEnabled&&(l=null,a.length))for(var u=0;u<a.length;++u)this._createPaletteSwatch(a[u],i,!0,7===u);this._updateActiveSwatch(n?e.substring(0,e.indexOf("-")):e)},u.prototype._updateActiveSwatch=function(e){if("swatches"===this._activePalette){var t=this._palettes.find(".swatches-palette."+e),n=!1;t.find(".swatches-wrapper .swatches .swatch").each(function(e,t){var i=$(t),r=o.GUtil.equals(i.data("swatch"),new o.GSwatch(this._pattern,this._opacity),!0);r&&(n=!0),i.data("isActive",r).toggleClass("g-active",r)}.bind(this)),t.find(".toolbar button[data-active-swatch]").each((function(e,t){$(t).prop("disabled",!n)}))}},u.prototype._swatchesChanged=function(e){this._updateSwatchesPalette(e.scope)},u.prototype._activatePalette=function(e){if(e!==this._activePalette){switch(this._activatePalette){case"swatches":gDesigner.removeEventListener(l,this._swatchesChanged,this)}switch(this._palettes.find(".chooser [data-palette]").each((function(t,n){var i=$(n);i.toggleClass("g-active",i.attr("data-palette")===e)})),this._palettes.find(".palette").each((function(t,n){var i=$(n);i.css("display",i.attr("data-palette")===e?"":"none")})),e){case"mixer":this._updateMixerPalette();break;case"used":this._updateUsedPalette();break;case"swatches":this._updateSwatchesPalette(this._getSwatchScope("global",this._pattern)),this._updateSwatchesPalette(this._getSwatchScope("document",this._pattern)),gDesigner.addEventListener(l,this._swatchesChanged,this)}this._activePalette=e,this._relayout()}},u.prototype._setActiveGradientStop=function(e,t,n){(e!==this._activeGradientStop||n)&&(this._activeGradientStop=e,this._activeGradientStop&&(this._updateColor(t||this._activeGradientStop.color,n?"":"gradient-stop"),this._updateOpacity(this._activeGradientStop.opacity,"gradient-stop"),Array.prototype.forEach.call(this._activeGradient.getStops(),function(e){this._updateGradientStop(e)}.bind(this))))},u.prototype._updateOnlineEditorStops=function(){if(gDesigner.getWorkspace().getStyleEdManager()&&gDesigner.getWorkspace().getStyleEdManager().isActivated()){var e=null;this._activeGradientStop&&this._activeGradient&&Array.prototype.forEach.call(this._activeGradient.getStops(),function(t,n){t===this._activeGradientStop&&(e=n)}.bind(this));var t=gDesigner.getWorkspace().getStyleEdManager().getActiveEditor(),n=null;null!==e&&t&&(n={type:i.GGradientStyleEditor.STOP_HANDLE_PART_ID,idx:e}),t&&t.updatePartSelection(!1,n?[n]:null,!0)}},u.prototype._insertGradientStop=function(e){var t=this._gradientEditor.find(".stops"),n=t.width(),i=t.height(),r=t.offset(),a=null,s=function(t,o){var s=Math.max(0,Math.min(n,Math.round(t.pageX-r.left)));t.pageY<r.top-u.EXTEND_DRAG_RANGE||t.pageY>r.top+i+u.EXTEND_DRAG_RANGE?this._activeGradient.getStops().length>=3&&(a.css("display","none"),e.remove=!0):(a.css("display",""),e.remove=!1),e.position=s/n,this._updateGradientStop(e),this._updatePatternFromActiveGradient(!o)}.bind(this),l=function(t){if(s(t,!0),t.stopPropagation(),document.removeEventListener("mouseup",l,!0),document.removeEventListener("mousemove",s,!0),e.remove){var n=this._activeGradient.getStops(),i=n.indexOf(e);n.splice(i,1)}}.bind(this);return a=$("<div/>").addClass("stop").data("stop",e).on("mousedown",function(t){t.stopPropagation(),this._setActiveGradientStop(e),this._updateOnlineEditorStops(),document.addEventListener("mouseup",l,!0),document.addEventListener("mousemove",s,!0);var n=this._activeGradient.getStops()[0].color;n instanceof o.GCMYKColor?this.setColorMode(u.ColorMode.CMYK):n instanceof o.GHSVColor?this.setColorMode(u.ColorMode.HSV):n instanceof o.GRGBColor&&this.setColorMode(u.ColorMode.RGB)}.bind(this)).appendTo(t),this._updateGradientStop(e),a},u.prototype.__getUpdateGradientStopParams=function(){return{isTouchEnabled:!1}},u.prototype._updateGradientStop=function(e){var t=this.__getUpdateGradientStopParams(),n=this._gradientEditor.find(".stops"),i=n.width();n.find(".stop").each(function(n,o){var r=$(o);if(r.data("stop")===e){r.toggleClass("g-active",e===this._activeGradientStop),t.isTouchEnabled&&(e===this._activeGradientStop?(r.css("background",e.color.toScreenCSS(e.opacity)),r.css("border","2px solid #FFFFFF")):(r.css("background","transparent"),r.css("border","2px solid transparent")));var a=Math.round(e.position*i),s=r.outerWidth()/2+1;a<s?t.isTouchEnabled||(a=s):a>i-s&&(t.isTouchEnabled||(a=i-s)),r.css("left",a+"px")}}.bind(this))},u.prototype._updatePatternFromActiveGradient=function(e){if(this._activeGradient){this._activeGradient.sortStops();var t=this._activeGradient.clone(),n=t.getStops();Array.prototype.forEach.call(this._activeGradient.getStops(),(function(e,t){e.remove&&n.splice(t,1)})),this._updatePattern(t,"gradient",null,e)}},u.prototype._rotateActiveGradient=function(e){var t=o.GMath.toRadians(e),n=new o.GPoint(this._activeGradient._fx,this._activeGradient._fy);n=n.rotatedAt(t,new o.GPoint(.5,.5)),this._activeGradient._fx=n.getX(),this._activeGradient._fy=n.getY(),this._activeGradient._angle=this._activeGradient._angle+t,this._updatePatternFromActiveGradient()},u.prototype._updateTexture=function(e){o.GUtil.equals(e,this._texture)||(this._texture=e)},u.prototype.__getUpdateColorParams=function(){return{isTouchEnabled:!1}},u.prototype._updateColor=function(e,t,n,i){var r=this.__getUpdateColorParams();o.GUtil.equals(e,this._color)&&"set_pattern"!==t&&!i||(this._color=e,this._updateSwatchesPalette(this._getSwatchScope("global",this._pattern)),this._updateSwatchesPalette(this._getSwatchScope("document",this._pattern)),this._pattern&&this._pattern instanceof o.GColor&&"set_pattern"!==t&&"update_pattern"!==t&&this._updatePattern(this._color,"set_color",null,n),this._activeGradientStop&&"gradient-stop"!==t&&(this._activeGradientStop.color=this._color,this._updatePatternFromActiveGradient(n)),"mode"!==t&&(this._color instanceof o.GCMYKColor?this.setColorMode(u.ColorMode.CMYK):this._color instanceof o.GHSVColor?this.setColorMode(u.ColorMode.HSV):this._color instanceof o.GRGBColor&&this.setColorMode(u.ColorMode.RGB)),this._updateColorComponentsFromColor(),"slider"!==t&&"map"!==t&&this._updateColorSliderFromColor(),this._systemColorInput.val(this._color.toScreenCSS()),"map"!==t&&this._updateMapMarker(),"set_pattern"!==t&&"gradient-stop"!==t||(this._oldColor=this._color,this._colorPreviewOld.css("background",this._oldColor.toScreenCSS(this._oldColorOpacity))),"swatch"!==t&&"mixer"===this._activePalette&&this._updateMixerPalette(),o.GUtil.equals(this._oldColor,this._color)||0===this._oldColorOpacity&&this._updateOpacity(1),r.isTouchEnabled&&(this._sliderColorThumb.css("background",this._color.toScreenCSS(1)),this._sliderOpacityThumb.css("background",this._color.toScreenCSS(this._colorOpacity))),this._colorPreviewNew.css("background",this._color.toScreenCSS(this._colorOpacity)))},u.prototype.__getUpdateOpacityParams=function(){return{isTouchEnabled:!1}},u.prototype._updateOpacity=function(e,t,n,i){var r=this.__getUpdateColorParams();if(e!==this._colorOpacity||"set_opacity"===t||i){if(this._activeGradientStop&&"set_opacity"===t)return;this._activeGradientStop||(this._opacity=e,"set_opacity"!==t&&this._settings&&this._settings.onOpacity&&this._settings.onOpacity(this._opacity,!!n)),this._colorOpacity=e,"set_opacity"!==t&&"gradient-stop"!==t||(this._oldColorOpacity=this._colorOpacity,this._colorPreviewOld.css("background",this._oldColor.toScreenCSS(this._oldColorOpacity))),this._colorPreviewNew.css("background",this._color.toScreenCSS(this._colorOpacity)),"slider"!==t&&this._opacitySlider.gInputSlider("value",Math.round(100*this._colorOpacity)),this._colorComponents.find("[data-opacity]").find("input").prop("disabled",this._settings&&this._settings.hasOwnProperty("hasOpacity")&&!this._settings.hasOpacity).gInputBox("value",o.GUtil.formatOpacity(100*this._colorOpacity)),this._activeGradientStop&&"gradient-stop"!==t&&(this._activeGradientStop.opacity=this._colorOpacity,this._updatePatternFromActiveGradient(n)),r.isTouchEnabled&&(this._sliderColorThumb.css("background",this._color.toScreenCSS(1)),this._sliderOpacityThumb.css("background",this._color.toScreenCSS(this._colorOpacity)))}},u.prototype._updatePattern=function(e,t,n,i){if(!this._patternUpdateBlocker){"set_pattern"!==t&&"gradient"!==t||(this._patternUpdateBlocker=!0),(!n||e instanceof o.GGradient)&&(this._pattern=e,this._toolbar.find(".pattern-type").each((function(t,n){var i=$(n),o=i.data("type");o&&i.prop("selected",!!o.isInstance(e))})));var r=this._pattern&&this._pattern instanceof o.GGradient,a=this._pattern&&this._pattern instanceof o.GColor,s=this._pattern&&this._pattern instanceof o.GTexturePattern&&!(e instanceof o.GNoisePattern),l=this._pattern&&this._pattern instanceof o.GNoisePattern,c=this._pattern&&this._pattern instanceof o.GBackground;this._gradientEditor.css("display",r?"":"none"),this._gradientActions.css("display",r?"":" none"),this._colorEditor.css("display",a||r?"":"none"),this._palettes.css("display",a||r||s||l?"":"none"),s||l?(this._palettes.find(".chooser").find("button[data-palette!='swatches']").css("display","none"),this._activatePalette("swatches")):this._palettes.find(".chooser").find("button").css("display",""),this._patternEditor.css("display",s&&!l?"":"none"),this._noiseEditor.css("display",l?"":"none"),("set_pattern"===t||"set_type"===t&&!r)&&(this._activeGradient=null,this._activeGradientStop=null);var d=null;if(r){if(this._gradientEditor.css("background",o.GPattern.asCSSBackground(new o.GLinearGradient(this._pattern.getStops()),this._opacity)),"set_pattern"===t||"set_type"===t){this._gradientEditor.find(".stops").empty(),this._activeGradient=this._pattern.clone();var u=null,p=null;Array.prototype.forEach.call(this._activeGradient.getStops(),function(e,t){this._insertGradientStop(e),0===t&&(u=e),this._activeGradientStop&&this._activeGradientStop.position===e.position&&(p=e)}.bind(this));var g=gDesigner.getWorkspace().getStyleEdManager()?gDesigner.getWorkspace().getStyleEdManager().getActiveEditor():null;if(!p&&g&&g.getPartsSelectionLength()){var h=this._activeGradient.getStops(),f=g.getPartSelection(),m=f&&null!==f[0].idx?f[0].idx:null;h&&null!==m&&h.length>m&&(p=h[m],d=m)}p||(p=u),this._setActiveGradientStop(p,e&&e instanceof o.GColor?e:null,n),this._gradientActions.find("[data-action]").each((function(t,n){var i=$(n),r=!0;switch(i.attr("data-action")){case"rotate-left":case"rotate-right":r=e instanceof o.GLinearGradient}i.css("display",r?"":"none")}))}null===d&&Array.prototype.forEach.call(this._activeGradient.getStops(),function(e,t){e===this._activeGradientStop&&(d=t)}.bind(this))}else if(a)this._updateColor(e,t||"update_pattern",!!i);else if(l){var y=100*e.getAmount();this._noiseEditor.find('.g-input-slider[data-property="noise_amount"]').gInputSlider("value",y),this._noiseEditor.find('[type="text"][data-property="noise_amount"]').gInputBox("value",o.GUtil.formatNumber(y,0));var v=this._patternEditor.find('[data-property="noise_type"]');v.children("option").attr("selected",!1),v.children('option[value="'+e.getType()+'"]').attr("selected",!0)}else if(s){this._updateTexture(e,t||"update_pattern");var _=!!e.getTexture(),b=-1!==o.GTexturePattern.SizeMode.Length.concat(o.GTexturePattern.SizeMode.Percent).indexOf(e.getSizeMode()),w=function(e,t){var n=this._patternEditor.find('[data-property="'+e+'"]').prop("disabled",!_);n.children("option").attr("selected",!1),n.children('option[value="'+t+'"]').attr("selected",!0),n.val(t)}.bind(this),C=function(e,t){this._patternEditor.find('[data-property="'+e+'"]').prop("disabled",!(_&&b)).val(o.GUtil.formatNumber(t))}.bind(this);w("texture_repeat",e.getRepeatMode()),w("texture_position",e.getPosition()),w("texture_size",e.getSizeMode()),w("texture_scale",e.getScaleMode()),C("texture_size_w",e.getWidth()),C("texture_size_h",e.getHeight());var E=100*e.getTileSize();this._patternEditor.find('.g-input-slider[data-property="texture_tile"]').gInputSlider("value",E),this._patternEditor.find('[type="text"][data-property="texture_tile"]').gInputBox("value",o.GUtil.formatNumber(E,0)),this._patternEditor.find('[data-property="texture_tile"]').gInputSlider("disabled",e.getScaleMode()!==o.GTexturePattern.ScaleMode.Tile),this._patternEditor.find('[data-property="texture_size_u"]').text(e.getSizeMode()===o.GTexturePattern.SizeMode.Length?"px":"%"),this._patternEditor.find('[data-property="texture_mask"]').prop("checked",e.isMask()),this._patternEditor.find(".pattern-preview").css("background-image",e.asCSSBackground()).css("background-repeat","no-repeat").css("background-position","center").css("background-size","contain")}this._relayout(!c),"set_pattern"!==t&&this._settings&&this._settings.onPattern&&this._settings.onPattern(n?this._pattern:e,!!i,null!==d?d:null),r&&this._updateOnlineEditorStops(),"swatches"===this._activePalette&&(this._updateSwatchesPalette(this._getSwatchScope("global",this._pattern)),this._updateSwatchesPalette(this._getSwatchScope("document",this._pattern))),this._patternUpdateBlocker=!1}},u.prototype._styleEditorHandler=function(e){if(e.type===i.GStyleEdManager.EditorEventType.ActivePointChange){var t=this._activeGradient?this._activeGradient.getStops():null,n=e.data?e.data.idx:null;t&&null!==n&&t.length>n?this._setActiveGradientStop(t[n]):t&&this._setActiveGradientStop(t.null),this._updatePatternFromActiveGradient()}},u.prototype._closeIfNeeded=function(e){!this.isOpenned()||e.data&&e.data.chooserOn||this.close()},u.prototype._updateColorFromColorSlider=function(e){var t=parseInt(this._colorSlider.gColorSlider("value")),n=null,i=null;if(this._colorMode===u.ColorMode.RGB||this._colorMode===u.ColorMode.HSV){switch(this._colorMode){case u.ColorMode.RGB:i=o.GColor.rgbToHSV(this._color.toScreen());break;case u.ColorMode.HSV:i=[],this._colorComponents.find("[data-component-index]").each((function(e,t){var n=$(t),o=parseInt(n.attr("data-component-index"));0!==o&&(i[o]=parseInt(n.find("input").gInputBox("value"))/100)}))}i&&(i=[t,i[1],i[2]],n=this._colorMode===u.ColorMode.RGB?new o.GRGBColor(o.GColor.hsvToRGB(i)):new o.GHSVColor(i),this._extendedGamutInitiated=u.ExtendedGamut.COLOR_SLIDER,this._updateColor(n,"slider",e,!0),this._updateColorMap(),this._extendedGamutInitiated=null)}},u.prototype._updateColorSliderFromColor=function(){var e;switch(this._colorMode){case u.ColorMode.RGB:case u.ColorMode.HSV:if(this._extendedGamutInitiated===u.ExtendedGamut.COLOR_SLIDER||this._extendedGamutInitiated===u.ExtendedGamut.MAP)return;e=this._extendedGamutInitiated===u.ExtendedGamut.COMPONENTS&&this._extValue&&this._colorMode===u.ColorMode.HSV?this._extValue[0]:o.GColor.rgbToHSV(this._color.toScreen())[0],parseInt(this._colorSlider.gColorSlider("value"))!==e&&(this._colorSlider.gColorSlider("value",e),this._updateColorMap());break;case u.ColorMode.CMYK:}},u.prototype._updateColorFromColorComponents=function(){var e=[];this._colorComponents.find("[data-component-index]").each((function(t,n){var i=$(n),o=parseInt(i.attr("data-component-index"));e[o]=parseInt(i.find("input").gInputBox("value"))}));var t=null;switch(this._colorMode){case u.ColorMode.RGB:t=new o.GRGBColor(e);break;case u.ColorMode.HSV:{const n=e.map((function(e,t){return 0===t?e:e/100}));t=new o.GHSVColor(n);break}case u.ColorMode.CMYK:t=new o.GCMYKColor(e.map((function(e){return e/100})))}this._extendedGamutInitiated=u.ExtendedGamut.COMPONENTS,t&&this._updateColor(t,"components",!1,!0),this._extendedGamutInitiated=null},u.prototype._updateColorComponentsFromColor=function(){if(this._colorComponents.find("[data-css]").find("input").gInputBox("value",this._color.toScreenCSS()),this._extendedGamutInitiated!==u.ExtendedGamut.COMPONENTS||this._colorMode!==u.ColorMode.HSV){var e=null,t=function(e,t){return t};switch(this._colorMode){case u.ColorMode.RGB:e=this._color.toScreen();break;case u.ColorMode.HSV:e=this._extendedGamutInitiated!==u.ExtendedGamut.COLOR_SLIDER&&this._extendedGamutInitiated!==u.ExtendedGamut.MAP||!this._extValue?this._color instanceof o.GHSVColor?this._color.getValue():o.GColor.rgbToHSV(this._color.toScreen()):this._extValue,t=function(e,t){return 0===e?t:o.GUtil.formatNumber(100*t,0)};break;case u.ColorMode.CMYK:e=this._color instanceof o.GCMYKColor?this._color.getValue():o.GColor.rgbToCMYK(this._color.toScreen()),t=function(e,t){return o.GUtil.formatNumber(100*t,0)}}this._colorComponents.find("[data-component-index]").each((function(n,i){var o=$(i),r=parseInt(o.attr("data-component-index"));o.find("input").gInputBox("value",t(r,e[r]))}))}},u.prototype._updateMapMarker=function(){if(this._extendedGamutInitiated!==u.ExtendedGamut.MAP){var e,t=this._colorMap.find("canvas")[0],n=t.width,i=t.height;e=this._extendedGamutInitiated!==u.ExtendedGamut.COLOR_SLIDER&&this._extendedGamutInitiated!==u.ExtendedGamut.COMPONENTS||!this._extValue||this._colorMode!==u.ColorMode.HSV?o.GColor.rgbToHSV(this._color.toScreen()):this._extValue;var r=Math.round(e[1]*n),a=Math.round((1-e[2])*i);this._setMarkerPosition(r,a)}},u.prototype._setMarkerPosition=function(e,t){var n=this._colorMap.find(".marker"),i=this._colorMap.find("canvas"),o=i[0].width,r=i[0].height,a=n.width()/2,s=n.height()/2;e<a&&(e=a),t<s&&(t=s),e>o-a&&(e=o-a),t>r-s&&(t=r-s),n.css({left:e+"px",top:t+"px"})},u.prototype._updateColorMap=function(){var e=this._colorMap.find("canvas")[0];this._colorMap.width()&&this._colorMap.height()&&(e.width=this._colorMap.width(),e.height=this._colorMap.height());var t=e.width,n=e.height,i=e.getContext("2d"),r=this._colorSlider.gColorSlider("value"),a=i.getImageData(0,0,t,n);if(a){for(var s=0;s<t;++s)for(var l=0;l<n;++l){var c=o.GColor.hsvToRGB([parseInt(r),s/t,1-l/n]),d=4*(l*t+s);a.data[d]=c[0],a.data[d+1]=c[1],a.data[d+2]=c[2],a.data[d+3]=255}i.putImageData(a,0,0)}},u.prototype._colorMapMouseDown=function(e){if(e.originalEvent.isTrusted){var t=function(e,t){if(!e.isTrusted)return;e.cancelable&&e.preventDefault();let n=e.pageX,i=e.pageY;if("touchstart"===e.type||"touchmove"===e.type){const t=e.changedTouches[0];n=t&&t.pageX,i=t&&t.pageY}var r=this._colorMap.find("canvas")[0],a=r.width,s=r.height,l=this._colorMap.offset(),c=Math.max(0,Math.min(a,Math.round(n-l.left))),d=Math.max(0,Math.min(s,Math.round(i-l.top)));const p=[parseInt(this._colorSlider.gColorSlider("value")),c/a,1-d/s];var g;g=this._colorMode===u.ColorMode.HSV?new o.GHSVColor(p):new o.GRGBColor(o.GColor.hsvToRGB(p)),this._setMarkerPosition(c,d),this._extendedGamutInitiated=u.ExtendedGamut.MAP,this._updateColor(g,"map",!t,t),this._extendedGamutInitiated=null}.bind(this);t(e.originalEvent),document.addEventListener("mouseup",(function e(n){t(n,!0),n.stopPropagation(),document.removeEventListener("mouseup",e,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("touchmove",t,!0)}),!0),document.addEventListener("mousemove",t,!0),document.addEventListener("touchmove",t,!0)}},u.prototype._defineStopInitColor=function(e){var t=this._gradientEditor.find(".stop:visible"),n=function(e){return Number($(e).css("left").replace("px",""))},i=function(e){var t=$(e).data("stop");return t&&t.color instanceof o.GColor?t.color.toScreen():[0,0,0]},r=[],a=[],s=null,l=null,c=null,d=null;for(let i=0;i<t.length;++i)n(t[i])<e?a.push(t[i]):r.push(t[i]);for(let e=0;e<a.length;++e)s?n(a[e])>c&&(s=a[e],c=n(a[e])):(s=a[e],c=n(a[e]));for(let e=0;e<r.length;++e)l?n(r[e])<d&&(l=r[e],d=n(r[e])):(l=r[e],d=n(r[e]));var p=100*(e-=c)/(d-=c)/100;const g=function(e,t,n){var i=((2*n-1)/1+1)/2,o=1-i;return[Math.round(t[0]*i+e[0]*o),Math.round(t[1]*i+e[1]*o),Math.round(t[2]*i+e[2]*o)]}(i(s),i(l),p);switch(this._colorMode){case u.ColorMode.CMYK:return new o.GCMYKColor(o.GColor.rgbToCMYK(g));case u.ColorMode.HSV:return new o.GHSVColor(o.GColor.rgbToHSV(g));default:return new o.GRGBColor(g)}},u._createPatternOption=function(e){return $("<option></option>").addClass("pattern-type").data("type",e).attr("data-title",e.name).attr("value",e.name).text(e.name)},u.prototype._relayout=function(){this._container.gOverlay("relayout",{preserveTop:!1})},u.getGradientStopsFromCurrentPattern=function(e){var t;return e instanceof o.GGradient?t=e.getClonedStops():(t=[{color:o.GRGBColor.WHITE,position:0,opacity:1},{color:o.GRGBColor.BLACK,position:1,opacity:1}],e instanceof o.GColor&&!o.GUtil.equals(e.toScreen(),t[1].color.toScreen())&&(t[0].color=e)),t},u.PATTERN_TYPES=null,u.initPatternType=function(){return[{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.color")),cssBackgroundImage:new o.GLinearGradient([{color:o.GRGBColor.WHITE,position:0,opacity:.5},{color:o.GRGBColor.WHITE,position:1,opacity:.5}],1,o.GMath.toRadians(90)).asCSSBackground(),isCompatible:function(e){return e===o.GColor},isInstance:function(e){return e&&e instanceof o.GColor},createDefault:function(e){if(e instanceof o.GGradient)for(var t=e.getStops(),n=0;n<t.length;++n)if(t[n].hasOwnProperty("color"))return t[n].color;return new o.GRGBColor}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.lineargradient")),cssBackgroundImage:new o.GLinearGradient([{color:o.GRGBColor.WHITE,position:0,opacity:1},{color:o.GRGBColor.BLACK,position:1,opacity:0}],1,o.GMath.toRadians(90)).asCSSBackground(),isCompatible:function(e){return e===o.GLinearGradient||e===o.GGradient},isInstance:function(e){return e&&e instanceof o.GLinearGradient},createDefault:function(e){return new o.GLinearGradient(u.getGradientStopsFromCurrentPattern(e))}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.radialgradient")),cssBackgroundImage:new o.GRadialGradient([{color:o.GRGBColor.WHITE,position:0,opacity:1},{color:o.GRGBColor.BLACK,position:1,opacity:0}]).asCSSBackground(),isCompatible:function(e){return e===o.GRadialGradient||e===o.GGradient},isInstance:function(e){return e&&e instanceof o.GRadialGradient},createDefault:function(e){return new o.GRadialGradient(u.getGradientStopsFromCurrentPattern(e))}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.angulargradient")),cssBackgroundImage:new o.GAngularGradient([{color:o.GRGBColor.WHITE,position:0,opacity:1},{color:o.GRGBColor.BLACK,position:1,opacity:0}]).asCSSBackground(),isCompatible:function(e){return e===o.GAngularGradient||e===o.GGradient},isInstance:function(e){return e&&e instanceof o.GAngularGradient},createDefault:function(e){return new o.GAngularGradient(u.getGradientStopsFromCurrentPattern(e))}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.texture")),cssBackgroundImage:'url("data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20">\n                        <circle r="9.2" stroke-width="2" stroke="white" fill="none"/>\n                        <circle cy="18.4" r="9.2" stroke-width="2px" stroke="white" fill="none"/>\n                        <circle cx="18.4" cy="18.4" r="9.2" stroke-width="2" stroke="white" fill="none"/>\n                    </svg>')+'")',isCompatible:function(e){return e===o.GTexturePattern},isInstance:function(e){return e&&e instanceof o.GTexturePattern&&!(e instanceof o.GNoisePattern)},createDefault:function(){var e=o.GNode.deserialize('[{"@":"group","$":[{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,370.93546258325506,25.987797270522503],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,410.7307331490452,25.987797270522503],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,390.7793771686299,44.58515959609013],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,430.57464773441995,44.58515959609013],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,370.9623229320152,63.96998301267038],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,410.75759349780526,63.96998301267038],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,390.80623751739,82.56734533823798],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}},{"@":"rectangle","uf":true,"ct":"R","sl":0,"reftxt":null,"trf":[9.948817641447532,0,0,9.692411708290129,430.60150808318014,82.56734533823798],"_sdf":84,"_layers":{"@":"paintLayers","$":[{"@":"fillPaintLayer","_pt":"C#[0,0,0]"}]}}]}]').pop(),t=new o.GTexturePattern(e,o.GTexturePattern.RepeatMode.Both);return t.setScene(gDesigner.getActiveDocument().getScene()),t}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.noise")),cssBackgroundImage:'url("data:image/svg+xml;base64,'+btoa('<svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421;"><rect x="-0.994" y="-1.097" width="24.763" height="23.271" style="fill:transparent;"/><path d="M7.689,17.9l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.848,0l0,-0.565l0.848,0l0,-0.848l0.565,0l0,0.848Zm5.769,0l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.565,0l0,0.848Zm5.094,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.566,0l0,0.848Zm-16.58,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.566,0l0,0.848Zm3.015,-2.33l1.321,0l0,0.881l-1.321,0l0,1.321l-0.88,0l0,-1.321l-1.321,0l0,-0.881l1.321,0l0,-1.32l0.88,0l0,1.32Zm5.752,0l1.32,0l0,0.881l-1.32,0l0,1.321l-0.881,0l0,-1.321l-1.32,0l0,-0.881l1.32,0l0,-1.32l0.881,0l0,1.32Zm5.764,0l1.32,0l0,0.881l-1.32,0l0,1.321l-0.881,0l0,-1.321l-1.321,0l0,-0.881l1.321,0l0,-1.32l0.881,0l0,1.32Zm-8.814,-2.896l0.848,0l0,0.566l-0.848,0l0,0.847l-0.565,0l0,-0.847l-0.848,0l0,-0.566l0.848,0l0,-0.847l0.565,0l0,0.847Zm5.769,0l0.848,0l0,0.566l-0.848,0l0,0.847l-0.565,0l0,-0.847l-0.847,0l0,-0.566l0.847,0l0,-0.847l0.565,0l0,0.847Zm5.094,0l0.847,0l0,0.566l-0.847,0l0,0.847l-0.566,0l0,-0.847l-0.847,0l0,-0.566l0.847,0l0,-0.847l0.566,0l0,0.847Zm-16.58,0l0.847,0l0,0.566l-0.847,0l0,0.847l-0.566,0l0,-0.847l-0.847,0l0,-0.566l0.847,0l0,-0.847l0.566,0l0,0.847Zm3.015,-2.91l1.321,0l0,0.88l-1.321,0l0,1.321l-0.88,0l0,-1.321l-1.321,0l0,-0.88l1.321,0l0,-1.321l0.88,0l0,1.321Zm5.752,0l1.32,0l0,0.88l-1.32,0l0,1.321l-0.881,0l0,-1.321l-1.32,0l0,-0.88l1.32,0l0,-1.321l0.881,0l0,1.321Zm5.764,0l1.32,0l0,0.88l-1.32,0l0,1.321l-0.881,0l0,-1.321l-1.321,0l0,-0.88l1.321,0l0,-1.321l0.881,0l0,1.321Zm-8.814,-2.932l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.848,0l0,-0.565l0.848,0l0,-0.848l0.565,0l0,0.848Zm5.769,0l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.565,0l0,0.848Zm5.094,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.566,0l0,0.848Zm-16.58,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.848l0.566,0l0,0.848Zm3.015,-2.833l1.321,0l0,0.881l-1.321,0l0,1.32l-0.88,0l0,-1.32l-1.321,0l0,-0.881l1.321,0l0,-1.321l0.88,0l0,1.321Zm5.752,2.201l-0.881,0l0,-1.32l-1.32,0l0,-0.881l1.32,0l0,-1.321l0.881,0l0,1.321l1.32,0l0,0.881l-1.32,0l0,1.32Zm5.764,0l-0.881,0l0,-1.32l-1.321,0l0,-0.881l1.321,0l0,-1.321l0.881,0l0,1.321l1.32,0l0,0.881l-1.32,0l0,1.32Zm-8.814,-4.515l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.848,0l0,-0.565l0.848,0l0,-0.847l0.565,0l0,0.847Zm5.769,0l0.848,0l0,0.565l-0.848,0l0,0.848l-0.565,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.847l0.565,0l0,0.847Zm5.094,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.847l0.566,0l0,0.847Zm-16.58,0l0.847,0l0,0.565l-0.847,0l0,0.848l-0.566,0l0,-0.848l-0.847,0l0,-0.565l0.847,0l0,-0.847l0.566,0l0,0.847Z" style="fill:#fff;"/></svg>')+'")',isCompatible:function(e){return e===o.GNoisePattern},isInstance:function(e){return e&&e instanceof o.GNoisePattern},createDefault:function(){return new o.GNoisePattern}},{name:o.GLocale.get(new o.GLocaleKey("GPatternChooser","pattern-type.backgroundfill")),cssBackgroundImage:'url("data:image/svg+xml;base64,'+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="10" height="20" viewBox="0 0 5 10"><line x1="-2" y1="1" x2="7" y2="10" stroke="white" stroke-width="2"/><line x1="-2" y1="6" x2="7" y2="15" stroke="white" stroke-width="2"/><line x1="-2" y1="-4" x2="7" y2="5" stroke="white" stroke-width="2"/></svg>')+'")',isCompatible:function(e){return e===o.GBackground},isInstance:function(e){return e&&e instanceof o.GBackground},createDefault:function(){return new o.GBackground}}]},function(e){var t={init:function(n){return n=e.extend({asButton:!0,label:"",singleOption:!1},n),window.gPatternChooser._updateSettings(n,!0),this.each((function(){var i=this,r=e(this),a=null;n.label&&(a=e("<span />").addClass("label").css("margin-left","5px").text(n.label));var l=n.simplified,c=e("<span />").addClass("preview").data("gpatternchooser",{options:n,opacity:1}).on("click",function(o,a){if(gDesigner.isTouchEnabled()?window.gPatternChooser=window.gPatternChooserTouch:window.gPatternChooser=window.gPatternChooserNormal,n.onOpen?n.onOpen.call(this):gDesigner.stats("patternchooser_click_open"),o.stopPropagation(),o.preventDefault(),!r.hasClass("g-disabled")){var s=r.data("gpatternchooser");s.options.asButton&&r.addClass("g-active");var l=e.extend({},s.options),c=e.extend(l,{onPattern:function(e,n,o){t.value.call(i,e),r.trigger("patternchange",[e,null,n,!0,null!==o?o:null])},onOpacity:function(e,n){t.opacity.call(i,e),r.trigger("patternchange",[void 0,e,n,!0])},onClose:function(e,t,n,i){var o=!1;return r.trigger("chooserclose",[function(){o=!0,n&&n()},i]),!o&&(s.options.asButton&&r.removeClass("g-active"),!0)}});window.gPatternChooser.open(r,c),window.gPatternChooser.setOpacity(t.opacity.call(i)),window.gPatternChooser.setPattern(t.value.call(i)),r.trigger("chooseropen"),null!==a&&window.gPatternChooser.setActiveGradientStopByIdx(a)}}.bind(this)).gPatternTarget().gRichTooltip(s.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.color-picker-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.color-picker-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/color-picker-fill-types/"}));if(n.asButton&&c.addClass("g-button"),r.addClass(l?"g-pattern-chooser-simplified":"g-pattern-chooser").data("gpatternchooser",{options:n,opacity:1}),!l&&!n.noEyedropper){var d=e("<div/>").addClass("eyedropper").addClass("eye-drop").gEyeDropper({onClick:n.onClickEyedropper}).on("colorchange",(function(e,t){r.trigger("patternchange",[new o.GRGBColor(t),t[3]/255,!1])})).removeClass("g-button").gRichTooltip(s.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.eyedropper-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPatternChooser","text.eyedropper-tooltip-description"))}));c.append(d)}n.noEyedropper&&r.addClass("only-picker"),r.append(c).append(a)}))},opacity:function(n){var i=e(this),o=i.data("gpatternchooser");return arguments.length?(o&&(o.opacity=n,t._updateBackground.call(this)),this):o?o.opacity:1},value:function(n){var i=e(this);return arguments.length?(i.find(".preview").gPatternTarget("value",n),i.find(".eye-drop").gEyeDropper("setValue",n),t._updateBackground.call(this),this):i.find(".preview").gPatternTarget("value")},setPattern:function(t){var n=e(this);return gPatternChooser.isOpenned(n)&&gPatternChooser.setPattern(t),this},nullValue:function(n){var i=e(this),o=i.data("gpatternchooser");return arguments.length?(o&&(o.nullValue=n),t._updateBackground.call(this),this):o?o.nullValue:null},close:function(){gPatternChooser.isOpenned(e(this))&&gPatternChooser.close()},openEyeDropper:function(t,n){e(this).find(".eye-drop").gEyeDropper("setActive",!0,t,n)},_updateBackground:function(){var t=e(this),n=t.data("gpatternchooser"),i=t.find(".preview").gPatternTarget("value"),r=t.find(".preview");let a;!i&&n&&n.nullValue&&(i=n.nullValue),i instanceof o.GTexturePattern?(a=o.GPattern.asCSSBackground(i,n&&"number"==typeof n.opacity?n.opacity:1),r.css("background-image",a).css("background-repeat",i.getRepeatMode()).css("background-size","contain"),t.find(".eye-drop").gEyeDropper("setValue",i)):i&&"function"==typeof i.asCSSBackground&&(a=o.GPattern.asCSSBackground(i,n&&"number"==typeof n.opacity?n.opacity:1),r.css("background",a),t.find(".eye-drop").gEyeDropper("setValue",a))},updateSettings:function(t){var n=e(this).data("gpatternchooser");return n&&n.options&&e.extend(n.options,t),this}};e.fn.gPatternChooser=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.gPatternChooser"):t.init.apply(this,arguments)}}(jQuery),e.exports=u},function(e,t,n){"use strict";n(3);var i=n(1);function o(e){this.scope=e}i.GObject.inherit(o,i.GEvent),o.prototype.scope=null,o.prototype.toString=function(){return"[Object GSwatchesChangedEvent]"},e.exports=o},function(e,t,n){"use strict";var i=n(17);n(9),n(25),n(163),n(3);var o=n(1),r=n(755),a=i(n(1124)),s=i(n(348)),l=i(n(1359)),c=n(12),d=i(n(535));const u=n(77),p=n(305),g=n(389),h=n(78),f=n(151),m=10,y=50,v=80,_=100;function b(){}o.GObject.inherit(b,s.default),b.Item=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;s.default.Item.call(this,e,t),this._ext=null,this._token=n,this._setExtension(),g.call(this,c.FILE_ID_PREFIX.SHAREPOINT)},o.GObject.inheritAndMix(b.Item,s.default.Item,[g]),b.Item.prototype._app=c.FILE_ID_PREFIX.SHAREPOINT,b.Item.prototype.getId=function(){const e=this._getSharepointId();return e?"".concat(this._app,"_").concat(e):null},b.Item.prototype.setFile=function(e){e&&(e.storage=f.Storage.SharePoint,!e.relativeUrl&&e instanceof f&&(e.relativeUrl=e.parent&&e.parent.relativeUrl+"/"+e.getNameWithExtension())),s.default.Item.prototype.setFile.call(this,e)},b.Item.prototype._getSharepointId=function(){return this._id?this._id:null},b.Item.prototype.getCollaborativeFile=async function(){return this._collaborativeFile=await gDesigner.getCloudCommunicationManager().getExternalFile(this.getId()).catch(()=>null),this._collaborativeFile},b.Item.prototype.setCollaborativeFileStatus=async function(e){const t=this._collaborativeFile;if(t&&t.status!==e){var n=t.status;t.status=e,gDesigner.hasEventListeners(p.FileStatusUpdate)&&gDesigner.trigger(new p.FileStatusUpdate(this,n,e))}},b.Item.prototype.getOrCreateCollaborativeFile=async function(){var e=await this.getCollaborativeFile();return e||(await this.createShadowFile(),e=await this.getCollaborativeFile()),e},b.Item.prototype.read=function(e,t){const n=this.getFile();if(this._rawData){var i=this._rawData;return this._rawData=null,e(i)}return function i(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._getClient().getFile(n).then(async t=>{const i=a.default.convertFileToCloudItem(await this._getClient().getFileDetails(this.getFile()));i.status=n.status,i.checkOutStatus=n.checkOutStatus,this.setFile(i),this._setExtension(),await this.syncShadowFile(),e(t)}).catch(e=>{const{id:r}=n;return!o&&e&&e.status&&404===e.status&&r?this._getClient().findFileById(r).then(e=>{let{relativeUrl:t,name:o,type:r}=e;const a=Object.assign(n,{name:o,relativeUrl:t,type:r});return this.setFile(a),this._setExtension(),this.updateShadowFile(),i.call(this,!0)}).catch(a):a();function a(){if(!t)throw e;t(e)}})}.call(this)},b.Item.prototype.isVersionNewerThan=function(e){if(e instanceof b.Item&&this.getFile().id===e.getFile().id&&new Date(this.getFile().updated)>new Date(e.getFile().updated))return!0;const t=this.getFile(),n=e.getFile();return new Date(t.getModificationTime()).getTime()>new Date(n.getModificationTime()).getTime()},b.Item.prototype.hasVersionControl=function(){return!0},b.Item.prototype.hasUpdates=async function(){const e=this.getFile();if(!this.getId()||!e||!e.updated&&!e.getModificationTime())return!1;const t=await this.getLatestFileInfo();return new b.Item(this.getStorage(),t).isVersionNewerThan(this)},b.Item.prototype.getLatestFileVersion=async function(){let e=this._getClient();const t=this.getFile(),n=await this.getLatestFileInfo(),i=new b.Item(this.getStorage(),Object.assign(n,{settings:t.settings,relativeUrl:t.relativeUrl}));return i._rawData=await e.getFile(t),i.setCloudClient(e),i},b.Item.prototype.getLatestFileInfo=async function(){const e=this.getFile(),t={relativeUrl:e.relativeUrl};if(!t.relativeUrl){const n=e.getParent();n instanceof f&&(t.relativeUrl="".concat(n.relativeUrl,"/").concat(e.getNameWithExtension()))}const n=await this._getClient().getFileDetails(t);return a.default.convertFileToCloudItem(n)},b.Item.prototype.exists=async function(){const e=this.getFile();return this._getClient().fileExists(e.getNameWithExtension(),e.getParent())},b.Item.prototype._setFileSizeAfterSaved=async function(e){return this._getClient().getFileDetails(e).then(e=>{this._fileSizeAfterSaved=e.size})},b.Item.prototype.write=async function(e,t,n,i,r){if(this._writing)return;this._writing=!0;let a=null;try{gContainer.verifyEnoughMemoryToSave(e),a=e.getEditor().markSavePoint();const n={};e.updateStatus(u.Saving,n);const s=i||n.progress,l=e=>{s&&s(e)},c=e.isNew();l(m),o.GUtil.prepareForSaving(e.getScene(),this.getExtension());const d=await this._getDocumentBlob(e,i,r);l(y),this._verifyFileNotTooSmall(d.size,e),this._setFileSizeBeforeSaved(d.size),await this._createOrUpdateFile(d),l(v),c&&await this.createShadowFile();try{await this._setFileSizeAfterSaved(this.getFile()).catch(e=>{console.error(e)}),this._verifyFileSizeAfterSaved()}catch(e){console.error(e)}e.updateStatus(u.Saved),gDesigner.hasEventListeners(h)&&gDesigner.trigger(new h(h.Type.StorageItemUpdated,e)),await this._updateModificationTime(),l(_),t&&t(this.getFile())}catch(t){e.updateStatus(u.SaveFailed),a&&a.rollback(),n&&n(t)}finally{this._writing=!1}},b.Item.prototype._getDocumentBlob=async function(e,t,n){let i=null;if("CDR"===this.getExtension()||"DES"===this.getExtension()){var r={progress:t,ext:this.getExtension().toLowerCase()};i=await this._exportDocumentToCDR(e,r,n)}else{var a=e.getScene(),s=o.GNode.serialize(a,o.GUtil.extend({save:!0},n));i=new Blob([s])}return i},b.Item.prototype._checkHttpResponseAndThrowIfNecessary=function(e){if(e.status>=c.HTTP_STATUS_CODES.BAD_REQUEST){if(e.status===c.HTTP_STATUS_CODES.BAD_REQUEST)throw Error("Invalid this.response, probably corrupted upload: "+e.status);throw Error("Invalid response status: "+e.status)}},b.Item.prototype._updateFileWithCreatedResponse=function(e){const t=a.default.convertFileToCloudItem(e);t.settings=f.GCloudSettings.from(this._getClient().getSettings()),this.setFile(Object.assign(this.getFile(),t))},b.Item.prototype._updateModificationTime=async function(){const e=this._getClient();if(this.getFile().relativeUrl){const t=a.default.convertFileToCloudItem(await e.getFileDetails(this.getFile()));this.getFile().setModificationTime(t.updated),this.setFile(Object.assign(this.getFile(),{updated:t.updated}))}},b.Item.prototype.createOrUpdateFileWithMetadata=async function(e){if(!this._writing){this._writing=!0;try{await this._createOrUpdateFile(e)}finally{this._writing=!1}}},b.Item.prototype._createOrUpdateFile=async function(e){let t;const n=this._getClient(),i=e instanceof Blob?e:new Blob([e]);this._getSharepointId()?(t=await n.updateFileContentById(this._getSharepointId(),i),this._checkHttpResponseAndThrowIfNecessary(t)):(t=await n.createFile(this.getFile(),i),this._checkHttpResponseAndThrowIfNecessary(t),this._updateFileWithCreatedResponse(await t.json())),await async function(){const e=this.getFile(),t=this._getClient();let n=Object.assign(e,{settings:f.GCloudSettings.from(t.getSettings())});e.relativeUrl||(e.relativeUrl=e.parent&&e.parent.relativeUrl+"/"+e.getNameWithExtension());if(e.relativeUrl){const i=await t.getFileDetails(e),o=a.default.convertFileToCloudItem(i);Object.assign(n,o)}this.setFile(n)}.call(this)},b.Item.prototype.getToken=function(){return this._token},b.Item.prototype.checkOut=async function(){try{const e=this.getFile(),t=await this._getAndUpdateCheckOutFileStatus();if(this.isCheckedOutByMe())return;if(t===a.default.FILE_STATUS.LOCKED)throw new d.default(o.GLocale.get(new o.GLocaleKey("GSharePointStorage","text.error-failed-check-out-file")));await this._getClient().checkOutFile(e),this._setCheckOutStatus(a.default.FILE_STATUS.LOCKED_BY_ME)}catch(e){throw e instanceof d.default?e:new d.default(o.GLocale.get(new o.GLocaleKey("GSharePointStorage","text.error-failed-check-out-file")))}},b.Item.prototype.checkIn=async function(e,t){try{const n=this.getFile();await this._getClient().checkInFile(n,e,t),await this._updateModificationTime(),this._setCheckOutStatus(a.default.FILE_STATUS.AVAILABLE),this._triggerStorageItemEvent(p.Type.FileCheckIn)}catch(e){throw console.error("Error checking in",e),e instanceof d.default?e:new d.default(o.GLocale.get(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewSharepoint","text.error-could-not-check-in"))))}},b.Item.prototype._setCheckOutStatus=function(e){const t=this.getFile();e===a.default.FILE_STATUS.AVAILABLE?t.checkedOut=!1:e!==a.default.FILE_STATUS.LOCKED_BY_ME&&e!==a.default.FILE_STATUS.LOCKED||(t.checkedOut=!0),t.checkOutStatus=e,this._triggerStorageItemEvent(p.Type.FileUpdated)},b.Item.prototype.refreshCheckOutStatus=async function(){return this._refreshCheckOutPromise||(this.getFile().checkOutStatus=a.default.FILE_STATUS.LOADING,this._refreshCheckOutPromise=this._getAndUpdateCheckOutFileStatus().finally(()=>{delete this._refreshCheckOutPromise})),this._refreshCheckOutPromise},b.Item.prototype.isCheckedOutByMe=function(){return this.getFile().checkOutStatus===a.default.FILE_STATUS.LOCKED_BY_ME},b.Item.prototype.isCheckedOutLoading=function(){return this.getFile().checkOutStatus===a.default.FILE_STATUS.LOADING},b.Item.prototype.isEditingEnabled=function(){return!c.msTeamsMode||this.isCheckedOutByMe()},b.Item.prototype._getAndUpdateCheckOutFileStatus=async function(){const e=await this._getCheckOutFileStatus();return this._setCheckOutStatus(e),this.getFile().checkOutStatus},b.Item.prototype._triggerStorageItemEvent=async function(e){gDesigner.hasEventListeners(p)&&gDesigner.trigger(new p(e,this))},b.Item.prototype._getCheckOutFileStatus=async function(){const e=this.getFile();return e.checkOutStatus&&e.checkOutStatus!==a.default.FILE_STATUS.LOADING?e.checkOutStatus:this._getClient().getCheckOutFileStatus(e)},b.Item.prototype.getMimeType=function(){return this.getFile().type},b.Item.prototype.isEmailFromCorporateDomain=async function(e){const t=this._getClient();return!!await t.getAccountByEmail(e).catch(()=>null)},b.Item.prototype._exportDocumentToCDR=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(async(i,o)=>{(0,r.prepareCDRforSaving)(e,(function(e){return o(e)}),t,n,(function(e){return i(new Blob([e]))}))})},b.Item.prototype._getClient=function(){let e=this.getCloudClient();const t=this.getFile();return!e&&t&&t.settings&&(e=a.default.getInstance(t.settings),this.setCloudClient(e)),e},b.Item.prototype._setExtension=function(e){const t=e||this.getFile();t&&t.type&&(["application/vnd.corel-draw","application/cdr"].includes(t.type)?this._ext="CDR":"application/des"===t.type&&(this._ext="DES"))},b.Item.prototype.getMyPermissionsList=async function(){const e=this._getClient(),t=this.getFile(),{High:n,Low:i}=await e.getFileEffectiveBasePermissions(t).catch(()=>({High:0,Low:0}));if(new l.default(n,i).hasPermission(l.default.Permissions.EditListItems)){const n=await e._getUser(),i=await e.getFileCreator(t);return[{email:n.getEmail(),role:c.ShareRoles.ContentEditor.id},{email:i.getEmail(),role:c.ShareRoles.Owner.id}]}return[]},b.Item.prototype.toString=function(){return"[Object GSharePointStorage.Item]"},e.exports=b},function(e,t,n){"use strict";var i=n(1);n(143);function o(){}i.GObject.inheritAndMix(o,i.GObject);var r=null;o.TYPE={PRINT:"preset-print",WEB:"preset-web",SOCIAL:"preset-social",SCREEN:"preset-screen",MERCH:"preset-merch"},o.getPresets=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r&&!e||(r=[{id:o.TYPE.PRINT,name:i.GLocale.get(new i.GLocaleKey("GPresets","preset-title.print")),subTitle:i.GLocale.get(new i.GLocaleKey("GPresets","preset-sub-title.print")),localeClass:new i.GLocaleKey("GPresets","preset-title.print"),icon:"preset-print",default:6,layouts:[{id:"4a0",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.4a0")),localeClass:new i.GLocaleKey("GPresets","presets.4a0"),unit:"mm",width:1682,height:2378,dpi:300},{id:"2a0",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.2a0")),localeClass:new i.GLocaleKey("GPresets","preset.2a0"),unit:"mm",width:1189,height:1682,dpi:300},{id:"a0",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a0")),localeClass:new i.GLocaleKey("GPresets","preset.a0"),unit:"mm",width:841,height:1189,dpi:300},{id:"a1",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a1")),localeClass:new i.GLocaleKey("GPresets","preset.a1"),unit:"mm",width:594,height:841,dpi:300},{id:"a2",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a2")),localeClass:new i.GLocaleKey("GPresets","preset.a2"),unit:"mm",width:420,height:594,dpi:300},{id:"a3",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a3")),localeClass:new i.GLocaleKey("GPresets","preset.a3"),unit:"mm",width:297,height:420,dpi:300},{id:"a4",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a4")),localeClass:new i.GLocaleKey("GPresets","preset.a4"),unit:"mm",width:210,height:297,dpi:300},{id:"a5",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a5")),localeClass:new i.GLocaleKey("GPresets","preset.a5"),unit:"mm",width:148,height:210,dpi:300},{id:"a6",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a6")),localeClass:new i.GLocaleKey("GPresets","preset.a6"),unit:"mm",width:105,height:148,dpi:300},{id:"a7",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a7")),localeClass:new i.GLocaleKey("GPresets","preset.a7"),unit:"mm",width:74,height:105,dpi:300},{id:"a8",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a8")),localeClass:new i.GLocaleKey("GPresets","preset.a8"),unit:"mm",width:52,height:74,dpi:300},{id:"a9",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a9")),localeClass:new i.GLocaleKey("GPresets","preset.a9"),unit:"mm",width:37,height:52,dpi:300},{id:"a10",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.a10")),localeClass:new i.GLocaleKey("GPresets","preset.a10"),unit:"mm",width:26,height:37,dpi:300},{id:"us-letter-portrait",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.us-letter-portrait")),localeClass:new i.GLocaleKey("GPresets","preset.us-letter-portrait"),unit:"in",width:8.5,height:11,dpi:300},{id:"us-letter-landscape",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.us-letter-landscape")),localeClass:new i.GLocaleKey("GPresets","preset.us-letter-landscape"),unit:"in",width:11,height:8.5,dpi:300},{id:"business-card",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.business-card")),localeClass:new i.GLocaleKey("GPresets","preset.business-card"),unit:"mm",width:85,height:55,dpi:300},{id:"flyer",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.flyer")),localeClass:new i.GLocaleKey("GPresets","preset.flyer"),unit:"in",width:5,height:7,dpi:300},{id:"postcard",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.postcard")),localeClass:new i.GLocaleKey("GPresets","preset.postcard"),unit:"mm",width:148,height:105,dpi:300}]},{id:o.TYPE.WEB,name:i.GLocale.get(new i.GLocaleKey("GPresets","preset-title.web")),subTitle:i.GLocale.get(new i.GLocaleKey("GPresets","preset-sub-title.web")),localeClass:new i.GLocaleKey("GPresets","preset-title.web"),icon:"preset-web",layouts:[{id:"blog-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.blog-cover")),localeClass:new i.GLocaleKey("GPresets","preset.blog-cover"),unit:"px",width:560,height:315},{id:"blog-graphic",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.blog-graphic")),localeClass:new i.GLocaleKey("GPresets","preset.blog-graphic"),unit:"px",width:800,height:1200},{id:"website-small",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.website-small")),localeClass:new i.GLocaleKey("GPresets","preset.website-small"),unit:"px",width:1024,height:768},{id:"website-normal",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.website-normal")),localeClass:new i.GLocaleKey("GPresets","preset.website-normal"),unit:"px",width:1280,height:800},{id:"website-medium",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.website-medium")),localeClass:new i.GLocaleKey("GPresets","preset.website-medium"),unit:"px",width:1366,height:768},{id:"website-large",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.website-large")),localeClass:new i.GLocaleKey("GPresets","preset.website-large"),unit:"px",width:1440,height:900},{id:"website-huge",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.website-huge")),localeClass:new i.GLocaleKey("GPresets","preset.website-huge"),unit:"px",width:1920,height:1280},{id:"full-website",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.full-website")),localeClass:new i.GLocaleKey("GPresets","preset.full-website"),unit:"px",width:1440,height:3072}]},{id:o.TYPE.SOCIAL,name:i.GLocale.get(new i.GLocaleKey("GPresets","preset-title.social")),subTitle:i.GLocale.get(new i.GLocaleKey("GPresets","preset-sub-title.social")),localeClass:new i.GLocaleKey("GPresets","preset-title.social"),icon:"preset-social",layouts:[{id:"facebook-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.facebook-cover")),localeClass:new i.GLocaleKey("GPresets","preset.facebook-cover"),unit:"px",width:851,height:315},{id:"twitter-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.twitter-cover")),localeClass:new i.GLocaleKey("GPresets","preset.twitter-cover"),unit:"px",width:1500,height:500},{id:"youtube-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.youtube-cover")),localeClass:new i.GLocaleKey("GPresets","preset.youtube-cover"),unit:"px",width:2560,height:1440},{id:"google-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.google-cover")),localeClass:new i.GLocaleKey("GPresets","preset.google-cover"),unit:"px",width:1080,height:608},{id:"google-business-profile",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.google-business-profile")),localeClass:new i.GLocaleKey("GPresets","preset.google-business-profile"),unit:"px",width:250,height:250},{id:"google-business-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.google-business-cover")),localeClass:new i.GLocaleKey("GPresets","preset.google-business-cover"),unit:"px",width:1080,height:608},{id:"google-business-post",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.google-business-post")),localeClass:new i.GLocaleKey("GPresets","preset.google-business-post"),unit:"px",width:497,height:373},{id:"linkedin-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.linkedin-cover")),localeClass:new i.GLocaleKey("GPresets","preset.linkedin-cover"),unit:"px",width:1440,height:425},{id:"twitch-cover",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.twitch-cover")),localeClass:new i.GLocaleKey("GPresets","preset.twitch-cover"),unit:"px",width:900,height:480},{id:"twitter-post",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.twitter-post")),localeClass:new i.GLocaleKey("GPresets","preset.twitter-post"),unit:"px",width:1024,height:512},{id:"facebook-post",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.facebook-post")),localeClass:new i.GLocaleKey("GPresets","preset.facebook-post"),unit:"px",width:940,height:788},{id:"facebook-app",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.facebook-app")),localeClass:new i.GLocaleKey("GPresets","preset.facebook-app"),unit:"px",width:810,height:450},{id:"facebook-ad",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.facebook-ad")),localeClass:new i.GLocaleKey("GPresets","preset.facebook-ad"),unit:"px",width:1200,height:627},{id:"instagram-post",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.instagram-post")),localeClass:new i.GLocaleKey("GPresets","preset.instagram-post"),unit:"px",width:1080,height:1080},{id:"instagram-stories",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.instagram-stories")),localeClass:new i.GLocaleKey("GPresets","preset.instagram-stories"),unit:"px",width:1080,height:1920},{id:"tumblr-graphic",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.tumblr-graphic")),localeClass:new i.GLocaleKey("GPresets","preset.tumblr-graphic"),unit:"px",width:540,height:810},{id:"pinterest-pin",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.pinterest-pin")),localeClass:new i.GLocaleKey("GPresets","preset.pinterest-pin"),unit:"px",width:735,height:600},{id:"twitch-video",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.twitch-video")),localeClass:new i.GLocaleKey("GPresets","preset.twitch-video"),unit:"px",width:1206,height:708},{id:"linkedin-banner",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.linkedin-banner")),localeClass:new i.GLocaleKey("GPresets","preset.linkedin-banner"),unit:"px",width:646,height:220},{id:"dribble-shot-small",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.dribble-shot")),localeClass:new i.GLocaleKey("GPresets","preset.dribble-shot"),unit:"px",width:400,height:300,displaySize:!0},{id:"dribble-shot-large",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.dribble-shot")),localeClass:new i.GLocaleKey("GPresets","preset.dribble-shot"),unit:"px",width:800,height:600,displaySize:!0}]},{id:o.TYPE.SCREEN,name:i.GLocale.get(new i.GLocaleKey("GPresets","preset-title.screen")),subTitle:i.GLocale.get(new i.GLocaleKey("GPresets","preset-sub-title.screen")),localeClass:new i.GLocaleKey("GPresets","preset-title.screen"),icon:"preset-screen",layouts:[{id:"iphone-x",name:"iPhone X",localeClass:null,unit:"px",width:375,height:812},{id:"iphone-xr",name:"iPhone XR",localeClass:null,unit:"px",width:828,height:1792},{id:"iphone-xs-max",name:"iPhone XS Max",localeClass:null,unit:"px",width:1242,height:2688},{id:"iphone-plus",name:"iPhone 6/7/8 Plus",localeClass:null,unit:"px",width:414,height:736},{id:"iphone",name:"iPhone 6/7/8",localeClass:null,unit:"px",width:375,height:667},{id:"iphone-se",name:"iPhone 5/SE",localeClass:null,unit:"px",width:320,height:568},{id:"google-pixel-xl",name:"Google Pixel 2/XL",localeClass:null,unit:"px",width:411,height:731},{id:"android-mobile",name:i.GLocale.get(new i.GLocaleKey("GPresets","text.android-mobile")),localeClass:new i.GLocaleKey("GPresets","text.android-mobile"),unit:"px",width:360,height:640},{id:"apple-watch-38",name:"Apple Watch 38 mm",localeClass:null,unit:"px",width:272,height:340},{section:"55f6e10de679477c7bca92c4",id:"apple-watch-42mm",name:"Apple Watch 42 mm",localeClass:null,unit:"px",width:312,height:390},{id:"apple-watch-4-40mm",name:"Apple Watch 4 40 mm",localeClass:null,unit:"px",width:324,height:394},{id:"apple-watch-4-44mm",name:"Apple Watch 4 44 mm",localeClass:null,unit:"px",width:368,height:448},{id:"ipad-mini",name:"iPad 3/4/Air/Mini",localeClass:null,unit:"px",width:768,height:1024},{id:"ipad-pro",name:"iPad Pro 12.9in",localeClass:null,unit:"px",width:1024,height:1366},{id:"nexus-7",name:"Nexus 7",localeClass:null,unit:"px",width:600,height:960},{id:"nexus-9",name:"Nexus 9",localeClass:null,unit:"px",width:1024,height:768},{id:"nexus-10",name:"Nexus 10",localeClass:null,unit:"px",width:1280,height:800},{id:"surface-pro-3",name:"Surface Pro 3",localeClass:null,unit:"px",width:1440,height:960},{id:"surface-pro-4",name:"Surface Pro 4",localeClass:null,unit:"px",width:1368,height:912}]},{id:o.TYPE.MERCH,name:i.GLocale.get(new i.GLocaleKey("GPresets","preset-title.merch")),subTitle:i.GLocale.get(new i.GLocaleKey("GPresets","preset-sub-title.merch")),localeClass:new i.GLocaleKey("GPresets","preset-title.merch"),icon:"preset-merch",hidden:!0,layouts:[{id:"amazon-shirt",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.amazon-shirt-pullover")),localeClass:new i.GLocaleKey("GPresets","preset.amazon-shirt-pullover"),unit:"in",dpi:300,template:"amazon_shirts",includes:[{name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.amazon-shirt")),localeClass:new i.GLocaleKey("GPresets","preset.amazon-shirt"),width:15,height:18,displaySize:!0},{name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.amazon-pullover")),localeClass:new i.GLocaleKey("GPresets","preset.amazon-pullover"),width:15,height:13.5,displaySize:!0}]},{id:"amazon-popsocket",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.amazon-popsocket")),localeClass:new i.GLocaleKey("GPresets","preset.amazon-popsocket"),unit:"px",dpi:72,width:485,height:485,template:"amazon_popsockets"},{id:"teepublic-shirt",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.teepublic-shirt")),localeClass:new i.GLocaleKey("GPresets","preset.teepublic-shirt"),unit:"px",dpi:72,width:1500,height:1995,template:"teepublic_shirts"},{id:"cafepress-shirt",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.cafepress-shirt")),localeClass:new i.GLocaleKey("GPresets","preset.cafepress-shirt"),unit:"in",dpi:200,width:10,height:10,template:"cafepress_shirts"},{id:"redbubble-shirt",name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.redbubble-shirt")),localeClass:new i.GLocaleKey("GPresets","preset.redbubble-shirt"),unit:"px",dpi:72,template:"redbubble_shirts",includes:[{name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.redbubble-shirt-standard")),localeClass:new i.GLocaleKey("GPresets","preset.redbubble-shirt-standard"),width:2400,height:3200,displaySize:!0},{name:i.GLocale.get(new i.GLocaleKey("GPresets","preset.redbubble-shirt-long")),localeClass:new i.GLocaleKey("GPresets","preset.redbubble-shirt-long"),width:2875,height:3900,displaySize:!0}]}]}]),r},e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class i{constructor(){this._condition=()=>!0,this._finished=!1}_do(e,t){if(!this._abort&&!this._finished&&(this._condition(t)||e)&&(this._eventClass&&gDesigner.removeEventListener(this._eventClass,this._do,this),this._runnable))try{this._runnable instanceof i?this._runnable._do(e,t):this._runnable()}finally{this._finished=!0}}listen(e){return this._eventClass=e,gDesigner.addEventListener(e,this._listenEvent,this),this}_listenEvent(e){this._do(!1,e)}when(e){return this._condition=e||this._condition,this}do(e,t){return this._runnable=e,this._do(t),this}abort(){return this._abort=!0,this._eventClass&&gDesigner.removeEventListener(this._eventClass,this._listenEvent,this),this._runnable instanceof i&&this._runnable.abort(),this}}t.default=i},function(e,t,n){"use strict";n(3);var i=n(1);function o(){}i.GObject.inherit(o,i.GEvent),o.prototype.toString=function(){return"[Object GMenuCloseEvent]"},o.EVENT=new o,e.exports=o},function(e,t,n){"use strict";n(14),n(63);var i=n(16),o=n(1),r=function(e){e.changed.escapeKey&&(e.isImmediatePropagationStopped=!0)},a={_activeMenu:null,_activeActivationCallback:null,_activeMenuMouseLocations:null,getActiveMenu:function(){return a._activeMenu},triggerGlobalActivation:function(e){a._activeMenu&&a._activeActivationCallback&&a._activeActivationCallback(e)},setActiveMenu:function(e,t,n){a._activeMenu&&(i.GPlatform.removeEventListener(i.GModifiersChangedEvent,r,a._activeMenu&&a._activeMenu.getHtmlElement()),t||a._activeMenu.close(),a._activeMenu=null,a._activeActivationCallback=null,document.removeEventListener("mousemove",a._activeMenuMouseMoveListener),document.removeEventListener("mousedown",a._activeMenuMouseUpDownListener),document.removeEventListener("mouseup",a._activeMenuMouseUpDownListener),document.removeEventListener("keydown",a._activeMenuKeyDownListener)),a._activeMenu=e,a._activeActivationCallback=n,a._activeMenu&&(i.GPlatform.addEventListener(i.GModifiersChangedEvent,r,e.getHtmlElement(),null,!0),document.addEventListener("mousemove",a._activeMenuMouseMoveListener),document.addEventListener("mousedown",a._activeMenuMouseUpDownListener),setTimeout((function(){document.addEventListener("mouseup",a._activeMenuMouseUpDownListener)}),250),document.addEventListener("keydown",a._activeMenuKeyDownListener))},_activeMenuMouseMoveListener:function(e){a._activeMenuMouseLocations||(a._activeMenuMouseLocations=[]),a._activeMenuMouseLocations.push({x:e.pageX,y:e.pageY}),a._activeMenuMouseLocations.length>3&&a._activeMenuMouseLocations.shift()},_activeMenuMouseUpDownListener:function(e){e.cancelable&&a.setActiveMenu(null)},_activeMenuKeyDownListener:function(e){27==e.keyCode&&a.setActiveMenu(null)},createActionMenu:function(e,t){for(var n=[],i=function(e,i,o){e.getItemCount()>0&&(function(e){for(var t=0;t<n.length;++t)if(n[t].item===e)return n[t].group}(e.getItem(e.getItemCount()-1))!==o&&e.addItem(t.createDivider()));n.push({item:i,group:o})},r=0;r<e.length;++r){var a=e[r];if(a.isAvailable()){var s=o.GLocale.get(a.getCategory()),l=a.getGroup(),c=s?s.split("/"):null,d=l?[""].concat(l.split("/")):null;if(d&&c&&c.length!==d.length-1)throw new Error("Number of categories different thant number of groups.");var u=t;if(c)for(var p=0;p<c.length;++p){s=c[p],l=d?d[p]:null;var g=u.findItem(s);g||((g=t.createMenuItem(!0)).setCaption(s),i(u,g,l),u.addItem(g)),u=g.getMenu()}var h=t.createMenuItem();h.setAction(a),i(u,h,d?d[d.length-1]:null),u.addItem(h)}}}};e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(26),r=n(18);function a(){}i.GObject.inherit(a,o),a.ID="help.purchase",a.TITLE=new i.GLocaleKey("GPurchaseProAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return r.CATEGORY_HELP},a.prototype.getGroup=function(){return"help"},a.prototype.isVisible=function(){if(!gDesigner.isInAppPurchaseAllowed())return!1;var e=gDesigner.getLicense();return!(gDesigner.isAnonymous()||e.isPro()&&!e.isExpired())},a.prototype.isEnabled=function(){var e=gDesigner.getLicense();return!(e.isPro()&&!e.isExpired())},a.prototype.execute=function(){gDesigner.openPaymentDialog()},a.prototype.getStyleClass=function(){return"purchase-pro-menu-item"},a.prototype.noHover=function(){return!0},a.prototype.toString=function(){return"[GObject GPurchaseProAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(1);function o(e,t){this.type=e,this.fileId=t}i.GObject.inherit(o,i.GEvent),o.Type={Enable:1,Disable:0,Close:2},o.prototype.fileId=null,o.prototype.type=null,e.exports=o},function(e,t,n){"use strict";var i=n(17);n(25),n(45),n(168),n(19),n(24),n(3);var o=n(43),r=n(1),a=n(56),s=i(n(309)),l=n(108),c=n(765);n(143);const d=n(118);function u(){this._elements=[]}r.GObject.inherit(u,l),u.prototype._panel=null,u.prototype._document=null,u.prototype._elements=null,u.prototype._getBlendingProperties=function(){var e=this;return $("<select></select>").attr("data-property","_sbl").gBlendMode().append($('<optgroup label="'+r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.masking"))+'"></optgroup>').append($("<option></option>").attr("value","m").text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","blending.mask")))).append($("<option></option>").attr("value","!m").text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","blending.inverse-mask"))))).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.blend-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.blend-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/colors-gradients-textures/blending-modes/"})).on("change",(function(t){gDesigner.stats("appearance_change_blending",$(t.target).val()),e._assignProperty("_sbl",$(t.target).val(),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.change-blending-mode")))}))},u.prototype.init=function(e,t){this._panel=e,this.setTouchTools([s.default.APPEARANCE_TOUCH_TOOL]);var n=function(e){var t=this;if("evenodd"===e)return $("<select></select>").attr("data-property","evenodd").append($("<option></option>").attr("value","0").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","evenodd.non-zero")))).append($("<option></option>").attr("value","1").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","evenodd.non-odd")))).on("change",(function(){gDesigner.stats("appearance_toggle_evenodd","1"===$(this).val()?"activate":"deactivate"),t._assignProperty("evenodd","1"===$(this).val(),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.change-fill-rule")))}));if("_sbl"===e)return t._getBlendingProperties();if("opacity-slider"===e)return $("<div/>").attr("data-property","_stop").addClass("gravit-icon-touch-transparency").gInputSlider(Object.assign({},c.prototype.OPACITY_DEFAULT,{richTooltipConfig:a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.opacity-slider-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.opacity-slider-tooltip-description"))})})).on("mousedown",(function(){t._document.getEditor().hideSelection(),$(document).one("mouseup",(function(){t._document.getEditor().resetHideSelection()}))})).on("input",(function(e){for(var n=$(e.target),i=n.attr("data-property"),o=parseInt(n.gInputSlider("value"))/100,a=0;a<t._elements.length;++a)t._elements[a].setProperty(i,o,!1,!1,!0);t._panel.find('[type="text"][data-property="'+i+'"]').gInputBox("value",r.GUtil.formatOpacity(100*o))})).on("change",(function(e){gDesigner.stats("appearance_change_opacity"),t._assignProperty($(this).attr("data-property"),parseFloat($(this).gInputSlider("value"))/100,"Change opacity")}));if("opacity-input"===e)return $("<input>").attr("type","text").attr("data-property","_stop").on("change",(function(e){gDesigner.stats("appearance_change_opacity"),t._assignProperty($(this).attr("data-property"),r.GLength.parseEquationValue($(this).gInputBox("value"))/100,"Change opacity")})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"});throw new Error("Unknown input property: "+e)}.bind(this);$("<div></div>").addClass("appearance-opacity-property").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),columns:[{width:"auto",clazz:"opacity-slider-col",content:n("opacity-slider")},{width:"5px"},{clazz:"opacity-input-col",content:n("opacity-input")}]}).appendTo(this._panel),$("<div></div>").addClass("appearance-blending-property").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.blending")),columns:[{width:"100%",content:n("_sbl")}]}).appendTo(this._panel);var i=this,o=gDesigner.getLicense();$("<div/>").addClass("g-property-row appearance-style-property").append($("<label/>").addClass("property-label").append($("<span />").addClass("vertical-align").text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.style"))))).append($("<div/>").addClass("style-selector-container").css("display","flex").append($("<div/>").addClass("style-selector-inner-wrapper").css({display:"flex",width:"100%",overflow:"hidden"}).append($("<div/>").addClass("g-styles-preview").css("margin-right","5px").css("align-self","center").css("display","none")).append($("<div/>").addClass("g-select").addClass("g-styles-field-container").css("overflow","hidden").css("margin-right","5px").append($("<span/>").css({width:"95%",alignSelf:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}).attr("type","text").addClass("g-styles-field").attr("data-property","_styles")).gDesignerStyleEditor().gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.shared-styles-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.shared-styles-tooltip-description")),middle:!1,isPro:!gDesigner.isEnabledProFeatures()||!(o.isPro()&&!o.isExpired()),learnMore:"https://documentation.designer.io/organizing-your-designs/shared-styles/"})))).append($("<button></button>").addClass("g-style-sync").addClass("g-disabled").on("click",(function(){if(gDesigner.stats("appearance_click_stylebutton"),!$(this).hasClass("g-disabled")&&i._elements&&i._elements.length>0){var e=i._elements[0].getReferencedStyle();e.assignStyleFrom(i._elements[0]);var t=gDesigner.createNewStylePreview(e,!0,i._elements[0]instanceof r.GText);t&&i._addPreview(t),$(this).addClass("g-disabled")}})))).appendTo(this._panel)},u.prototype.update=function(e,t){if(this._updateUI(),this._document&&(gDesigner.removeEventListener(d,this._settingChanged,this),this._document.getScene().removeEventListener(r.GNode.AfterInsertEvent,this._styleChanged),this._document.getScene().removeEventListener(r.GNode.AfterRemoveEvent,this._styleChanged),this._document.getScene().removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.getScene().removeEventListener(r.GElement.AfterFlagChangeEvent,this._afterFlagChange),this._document=null),this._elements=[],e){gDesigner.addEventListener(d,this._settingChanged,this);for(var n=0;n<t.length;++n){var i=t[n];i.hasMixin(r.GStylable)&&i.getStylePropertySets().indexOf(r.GStylable.PropertySet.Style)>=0&&this._elements.push(i)}if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(r.GNode.AfterInsertEvent,this._styleChanged,this),this._document.getScene().addEventListener(r.GNode.AfterRemoveEvent,this._styleChanged,this),this._document.getScene().addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(r.GElement.AfterFlagChangeEvent,this._afterFlagChange,this),this._updateProperties(),!0}return!1},u.prototype._updateUI=function(){let e=this._panel.find(".g-style-sync");gDesigner.isTouchEnabled()?(e.text(""),e.append($("<span></span>").addClass("g-style-sync-refresh-item"))):e.text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","action.sync")))},u.prototype._settingChanged=function(e){"touch"===e.key&&this._updateUI()},u.prototype._afterFlagChange=function(e){if(e.flag===r.GNode.Flag.Selected&&(e.node instanceof r.GPGEdge||e.node instanceof r.GPGFacet)){var t=e.node.getParent()?e.node.getParent().getParent():null;t&&this._elements.indexOf(t)>=0&&this._updateProperties()}},u.prototype._afterPropertiesChange=function(e){e.temporary||e.node!==this._elements[0]||this._updateProperties(),this._styleChanged()},u.prototype._styleChanged=function(){1===this._elements.length&&this._checkSyncState()},u.prototype._updateProperties=function(){if(this._elements&&this._elements.length){var e=this._elements[0],t=o.GElementEditor.getEditor(e),n=function(n,i,o){var r=t?t.getPartsProperty(n):null;if(r){if(r.values.length){if(1==r.values.length||i)return r.values[0];for(var a=r.values,s=a[0],l=1;l<a.length;++l)if(a[l]!==s)return o;return s}return o}return e.getProperty(n)},i=100*n("_stop",!1,null);this._panel.find('.g-input-slider[data-property="_stop"]').gInputSlider("value",null!==i?i:100),this._panel.find('[type="text"][data-property="_stop"]').gInputBox("value",r.GUtil.formatOpacity(i)),this._panel.find('[data-property="_sbl"]').val(n("_sbl",!0));var a=null,s=null;if(1===this._elements.length&&this._elements[0].hasProperty("sref")&&this._elements[0].getReferencedStyle()){var l=this._elements[0].getReferencedStyle();a=gDesigner.getStylePreview(l,this._elements[0]instanceof r.GText),s=l.getProperty("name")}if(this._checkSyncState(),a)this._addPreview(a),this._panel.find(".g-styles-field").text(s),this._panel.find(".g-styles-field").removeClass("g-disabled");else{for(var c=!1,d=0;d<this._elements.length;++d)this._elements[0].hasProperty("sref")&&this._elements[d].getReferencedStyle()&&(c=!0);c&&this._elements.length>1?(this._panel.find(".g-styles-preview").empty(),this._panel.find(".g-styles-preview").css("display","none"),this._panel.find(".g-styles-field").text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.multiple-selection"))),this._panel.find(".g-styles-field").addClass("g-disabled")):(this._panel.find(".g-styles-preview").empty(),this._panel.find(".g-styles-preview").css("display","none"),this._panel.find(".g-styles-field").text(r.GLocale.get(new r.GLocaleKey("GAppearanceProperties","text.no-style"))),this._panel.find(".g-styles-field").removeClass("g-disabled"))}}else console.warn("GAppearanceProperties: empty _elements array")},u.prototype._addPreview=function(e){this._panel.find(".g-styles-preview").empty(),this._panel.find(".g-styles-preview").css("display","").append($("<img/>").css({height:"20px",width:"20px",borderRadius:"3px"}).attr("src",e))},u.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},u.prototype._assignProperties=function(e,t,n){if(this._document){var i=this._document.getEditor();i.beginTransaction();try{for(var r=0;r<this._elements.length;++r){this._elements[r];var a=o.GElementEditor.getEditor(this._elements[r]);a&&a.applyPropertiesToParts(e,t)||this._elements[r].setProperties(e,t)}}finally{i.commitTransaction(n)}}else console.warn("GAppearanceProperties: empty _document property")},u.prototype._checkSyncState=function(){this._elements&&this._elements.length>0&&this._elements[0].hasProperty("sref")&&!this._elements[0].equalsStyle()?this._panel.find(".g-style-sync").removeClass("g-disabled"):this._panel.find(".g-style-sync").addClass("g-disabled")},u.prototype.toString=function(){return"[Object GAppearanceProperties]"},e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleDragForDeleteIcon=function(e,t,n,i,o,r){if(!n)return!1;var a=!1;if(e.clientX<n.left||e.clientY<n.top||e.clientY>n.top+i){var s=gDesigner.isTouchEnabled()?30:10,l=e.clientX-o-t.outerWidth()-s,c=e.clientY-r;"none"===t.css("display")&&t.css("display","block"),t.css({top:c,left:l}),a=!0}else t.css("display","none"),a=!1;return a}},function(e,t,n){"use strict";var i=n(17);n(19),n(24),n(45);var o=n(16),r=n(43),a=n(1),s=n(56),l=i(n(309)),c=i(n(720)),d=i(n(193)),u=n(1049),p=i(n(509)),g=n(12),h=n(108),f=n(403);const m=n(549),y=n(36);function v(){}a.GObject.inherit(v,h),v.prototype._panel=null,v.prototype._toolbar=null,v.prototype._elements=null,v.prototype._document=null,v.prototype._advancedStrokePanel=null,v.prototype._styleEditorChange=!1,v.prototype._styleEdOn=!1,v.prototype._ownChange=!1,v.prototype._chooserElem=null,v.prototype.init=function(e,t){this._panel=e.addClass("border-properties-panel"),this._toolbar=t,this.setTouchTools([new l.default({id:"border",icon:"gravit-icon-touch-border",panel:this._panel,toolbar:this._toolbar,panelWidth:"368px"})]),$("<label></label>").text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","title"))).appendTo(t);var n=this;this._advancedStrokePanel=$("<div></div>").css("width","280px").gOverlay({releaseOnClose:!1}),this._advancedStrokePanel.parent().addClass("border-settings");var i=function(e,t,n){var i=this._getSelectedPaintLayer();i||(i=$(this._panel).find(".border-block:last").data("paintLayer")),i&&this._assign(i,e,t,n)}.bind(this),o=function(e,t,n){this._getSelectedPaintLayer()?this._assign(this._getSelectedPaintLayer(),e,t,n):this._panel.find(".border-block").each(function(i,o){var r=$(o).data("paintLayer");r&&this._assign(r,e,t,n)}.bind(this))}.bind(this),u=function(e){var t=this;if("_bw"===e||"_bml"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){var n=t._getSelectedPaintLayer();if(n||(n=$(t._panel).find(".border-block:last").data("paintLayer")),t._getProperty(n,"_blj")===a.GPaintCanvas.LineJoin.Miter){var o=a.GLength.parseEquationValue($(this).val());gDesigner.stats("border_change_miterlimit",o),null!==o&&o>0?i(["_vs",e],[!0,o]):t._updateProperties()}})).gInputBox();if("_bds"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){var t=[];gDesigner.stats("border_change_dash"),$(this).closest(".columns").find('[data-property="_bds"]').each((function(e,n){var i=a.GLength.parseEquationValue($(this).val());null!==i&&i>=0&&t.push(i)})),o(["_vs",e],[!0,t])})).gInputBox();if(0===e.indexOf("_ba-")){var n="",r="",s=e.substr("_ba-".length);switch(s){case a.GStylable.BorderAlignment.Inside:n="gravit-icon-line-stroke-inside",r=a.GLocale.get(new a.GLocaleKey("GStylable","border-alignment.inside"));break;case a.GStylable.BorderAlignment.Center:n="gravit-icon-line-stroke-center",r=a.GLocale.get(new a.GLocaleKey("GStylable","border-alignment.center"));break;case a.GStylable.BorderAlignment.Outside:n="gravit-icon-line-stroke-outside",r=a.GLocale.get(new a.GLocaleKey("GStylable","border-alignment.outside"))}return $("<button></button>").addClass("g-icon g-flat").css("width","33.3%").attr("data-property",e).attr("data-title",r).on("click",(function(){var e=s,t=Object.keys(a.GStylable.BorderAlignment);for(var n of t)if(s===a.GStylable.BorderAlignment[n]){e=n;break}gDesigner.stats("border_change_align",e),o(["_vs","_ba"],[!0,s])})).append($("<span></span>").addClass(n))}if(0===e.indexOf("_blc-")){n="",r="";var l=e.substr("_blc-".length);switch(l){case a.GPaintCanvas.LineCap.Butt:n="gravit-icon-line-cap-butt",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linecap.butt"));break;case a.GPaintCanvas.LineCap.Round:n="gravit-icon-line-cap-round",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linecap.round"));break;case a.GPaintCanvas.LineCap.Square:n="gravit-icon-line-cap-square",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linecap.square"))}return $("<button></button>").addClass("g-icon g-flat").css("width","33.3%").attr("data-title",r).attr("data-property",e).on("click",(function(){gDesigner.stats("border_change_cap",l),o(["_vs","_blc"],[!0,l])})).append($("<span></span>").addClass(n))}if(0===e.indexOf("_blj-")){n="",r="";var c=e.substr("_blj-".length);switch(c){case a.GPaintCanvas.LineJoin.Bevel:n="gravit-icon-line-join-bevel",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linejoin.bevel"));break;case a.GPaintCanvas.LineJoin.Round:n="gravit-icon-line-join-round",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linejoin.round"));break;case a.GPaintCanvas.LineJoin.Miter:n="gravit-icon-line-join-miter",r=a.GLocale.get(new a.GLocaleKey("GPaintCanvas","linejoin.miter"))}return $("<button></button>").addClass("g-icon g-flat").css("width","33.3%").attr("data-title",r).attr("data-property",e).on("click",(function(){gDesigner.stats("border_change_join",c),o(["_vs","_blj"],[!0,c])})).append($("<span></span>").addClass(n))}if("_bhmo"===e||"_btmo"===e)return $("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-property",e).on("change",(function(t){gDesigner.stats("border_toggle_markersoutline",$(this).prop("checked")?"enable":"disable"),o([e],[$(this).prop("checked")])}))).append($("<div></div>"));if("_bhmi"===e||"_btmi"===e)return $("<div/>").attr("data-property",e).gInputSlider({type:"range",min:0,max:100,step:1}).on("mousedown",(function(){var e=t._document.getEditor();e.hideSelection(),$(document).one("mouseup",(function(){e.resetHideSelection()}))})).on("input",(function(t){var n=$(t.target),i=parseInt(n.gInputSlider("value"))/100;o([e],[i])})).on("change",(function(t){gDesigner.stats("border_change_markersposition"),o([e],[parseInt($(this).gInputSlider("value"))/100])}));if("_bhms"===e||"_btms"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("border_change_tailmarkerscalation"),o([e],[a.GLength.parseEquationValue($(this).gInputBox("value"))/100])})).gInputBox({minValue:1,incrementValue:1,postfix:"%"});if("_bhm"===e||"_btm"===e)return $("<select></select>").attr("data-property",e).append($("<option></option>").attr("value","").text(a.GLocale.get(new a.GLocaleKey("GCommonNames","text.none")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.Circle).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.circle")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.Bullet).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.bullet")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.Diamond).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.diamond")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.Line).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.line")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.LineDouble).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.linedouble")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.Arrow).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrow")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.ArrowFat).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrowfat")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.ArrowLine).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrowline")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.ArrowDoubleLine).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrowdoubleline")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.ArrowLineBar).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrowlinebar")))).append($("<option></option>").attr("value",a.GStylable.BorderMarker.ArrowPointer).text(a.GLocale.get(new a.GLocaleKey("GStylable","border-marker.arrowpointer")))).append($("<option></option>").attr("value","#").prop("disabled",!0).text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","option.custom")))).on("change",(function(t){var n=$(this).val(),i=Object.keys(a.GStylable.BorderMarker);for(var r of i)if(n===a.GStylable.BorderMarker[r]){n=r;break}gDesigner.stats("border_change_headmarker",n),o([e],[$(this).val()||null])}));if(0===e.indexOf("arrow-paste-")){var d=e.substr("arrow-paste-".length);return $("<button></button>").addClass("g-flat g-icon").attr("data-title",a.GLocale.get(new a.GLocaleKey("GPasteAction","title"))).append($("<span></span>").addClass("gravit-icon-paste")).on("click",function(){gDesigner.stats("border_click_paste");var e=!1,t=a.GNode.deserialize(gDesigner.getClipboardContent(a.GNode.MIME_TYPE));if(t&&t.length)for(var n=0;n<t.length;++n)if(t[n].hasMixin(a.GVertexSource)){var i=t[n],r=a.GVertexInfo.calculateBounds(i,!0);if(r){var s=r.getSide(a.GRect.Side.BOTTOM_CENTER);o([d],[new a.GVertexContainer(new a.GVertexTransformer(i,new a.GTransform(1,0,0,-1,-s.getX(),-s.getY())))]),e=!0;break}}e||alert(a.GLocale.get(new a.GLocaleKey("GCommonNames","arrow-paste.alert")))}.bind(this))}throw new Error("Unknown input property: "+e)}.bind(this);$("<div></div>").gPropertyRow({justified:!0,columns:[{width:"50%",content:$("<div></div>").addClass("border-property-wrapper").append($("<div />").addClass("border-property-label").text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.ends")))).append($("<div />").addClass("border-property-content").append(u("_blc-"+a.GPaintCanvas.LineCap.Butt).addClass("g-group-start")).append(u("_blc-"+a.GPaintCanvas.LineCap.Round).addClass("g-group-element")).append(u("_blc-"+a.GPaintCanvas.LineCap.Square).addClass("g-group-end")))},{width:"50%",content:$("<div></div>").addClass("border-property-wrapper").append($("<div />").addClass("border-property-label").text(a.GLocale.get(new a.GLocaleKey("GCommonNames","text.position")))).append($("<div />").addClass("border-property-content").append(u("_ba-"+a.GStylable.BorderAlignment.Inside).addClass("g-group-start")).append(u("_ba-"+a.GStylable.BorderAlignment.Center).addClass("g-group-element")).append(u("_ba-"+a.GStylable.BorderAlignment.Outside).addClass("g-group-end")))}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({justified:!0,columns:[{width:"50%",content:$("<div></div>").addClass("border-property-wrapper").append($("<div />").addClass("border-property-label").text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.joins")))).append($("<div />").addClass("border-property-content").append(u("_blj-"+a.GPaintCanvas.LineJoin.Bevel).addClass("g-group-start")).append(u("_blj-"+a.GPaintCanvas.LineJoin.Miter).addClass("g-group-element ")).append(u("_blj-"+a.GPaintCanvas.LineJoin.Round).addClass("g-group-end")))},{width:"50%",content:$("<div />").addClass("border-property-wrapper").append($("<div />").addClass("border-property-label").text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.miter-limit")))).append($("<div />").addClass("border-property-content top-2px").append(u("_bml"))).gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.miter-limit")),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Miter_Limit.mp4",description:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.miter-limit-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/borders/#miter-limit"}))}]}).appendTo(this._advancedStrokePanel),$("<hr />").css("margin-bottom","10px").appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"25%",content:u("_bds"),label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.dash"))},{width:"25%",content:u("_bds"),label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.gap"))},{width:"25%",content:u("_bds"),label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.dash"))},{width:"25%",content:u("_bds"),label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.gap"))}]}).appendTo(this._advancedStrokePanel),$("<hr/>").appendTo(this._advancedStrokePanel),$("<p/>").appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"45%",padding:!1,content:$("<div></div>").html(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.start-arrow")))},{width:"10%"},{width:"45%",padding:!1,content:$("<div></div>").html(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.end-arrow")))}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"37%",content:u("_bhm")},{width:"8%",content:u("arrow-paste-_bhm")},{width:"10%"},{width:"37%",content:u("_btm")},{width:"8%",content:u("arrow-paste-_btm")}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"45%",padding:!1,content:u("_bhms")},{width:"10%"},{width:"45%",padding:!1,content:u("_btms")}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"45%",prefix:{label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.outline")),width:"50px"},padding:!1,content:u("_bhmo")},{width:"10%"},{width:"45%",prefix:{label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.outline")),width:"50px"},padding:!1,content:u("_btmo")}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"45%",label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.marker-position")),padding:!1,content:u("_bhmi")},{width:"10%"},{width:"45%",label:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.marker-position")),padding:!1,content:u("_btmi")}]}).appendTo(this._advancedStrokePanel),$("<div></div>").gPropertyRow({columns:[{width:"auto",content:$("<label></label>").append($("<input />").addClass("gravit-icon-touch-check-small").attr("type","checkbox").attr("data-property","_bs").on("change",(function(){gDesigner.stats("border_change_autoscale",$(this).prop("checked")?"enabled":"disabled"),o(["_bs"],[$(this).prop("checked")])}))).append($("<span></span>").text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.autoscale-borders"))))}]}).appendTo(this._advancedStrokePanel),this._toolbar.addClass("list-toolbar border-toolbar"),$("<button></button>").attr("data-action","stroke-settings").attr("data-title",a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.advanced-stroke-settings"))).append($("<span></span>").addClass("gravit-icon-settings")).append($("<span></span>").addClass("gravit-icon-touch-settings")).on("click",function(e){gDesigner.stats("border_open_advancedstrokepanel"),this._updateAdvancedSettings(),this._advancedStrokePanel.gOverlay("open",$(e.target).closest("button"))}.bind(this)).gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.advanced-stroke-settings-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.advanced-stroke-settings-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/borders/#advanced-stroke-settings"})).appendTo(this._toolbar),$("<button></button>").attr("data-action","remove").attr("data-title",a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.remove-selected-border"))).append($("<span></span>").addClass("gravit-icon-trash")).append($("<span></span>").addClass("gravit-icon-touch-trash")).on("click",(function(e){gDesigner.stats("border_remove_border"),e.stopPropagation();var t=n._getSelectedPaintLayer();t&&r.GEditor.tryRunTransaction(n._elements[0],(function(){var e=[];n._iterateEqualPaintLayer(t,(function(t){e.push(t)})),a.GUtil.each(e,(function(e,t){t.getParent().removeChild(t)}))}),a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.remove-border")));const i=gDesigner.getRightSidebars().getSidebar(d.default.SidebarsIds.GInspectorSidebar);i.trigger(new c.default(c.default.Type.ChildRemoved,i))})).gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.remove-border-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.remove-border-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/borders/"})).appendTo(this._toolbar),$("<button></button>").attr("data-action","add").attr("data-title",a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.add-border"))).append($("<span></span>").addClass("gravit-icon-plus")).append($("<span></span>").addClass("gravit-icon-touch-plus")).on("click",function(e){gDesigner.stats("border_add_border"),r.GEditor.tryRunTransaction(n._elements[0],(function(){const e=n._document&&n._document.getScene(),t=e&&e.getProperty("cm"),i=a.GColorHelper.convertColor(a.GRGBColor.BLACK,t||a.GColor.ColorModes.RGB);for(var o=0;o<n._elements.length;++o){var r=n._elements[o],s=new a.GStylable.BorderPaintLayer;r instanceof a.GText?s.setProperty("_ba",a.GStylable.BorderAlignment.Outside):r instanceof a.GShape?r instanceof a.GEllipse&&r.$etp===a.GEllipse.Type.Arc?s.setProperty("_ba",a.GStylable.BorderAlignment.Center):s.setProperty("_ba",a.GStylable.BorderAlignment.Inside):r instanceof a.GPath&&!r.$closed&&s.setProperty("_ba",a.GStylable.BorderAlignment.Center),s.setProperty("_pt",i),r.getPaintLayers().appendChild(s);const e=gDesigner.getRightSidebars().getSidebar(d.default.SidebarsIds.GInspectorSidebar);e.trigger(new c.default(c.default.Type.ChildAdded,e))}}),a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.add-border"))),$(this._toolbar).gAccordion("toggleOpen",!0),$(this._toolbar).gAccordion("init",$(this._panel))}.bind(this)).gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.add-border-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.add-border-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/borders/"})).appendTo(this._toolbar),gDesigner.getWorkspace().getStyleEdManager().addEventListener(r.GStyleEdManager.EditorEvent,this._styleEditorEventHandler,this),this._panel.data("contextmenu",!0),this._panel.on("mouseenter",e=>{gDesigner.setMouseOverContext(m.BorderPropertiesPanel,e,function(e){var t=this._panel.find(".copy-info-overlay").eq(0),n=this._panel.find(".border-block.g-selected")||null,i=n&&n.position().top||0,o=$("<span/>").addClass("copy-info-overlay").css({top:i}).text(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.copy-border")));t&&t.remove(),this._panel.append(o),setTimeout(()=>{o.animate({opacity:0,top:"+=20"},500,o.remove)},1e3)}.bind(this)),this._panel.on("mousemove.check-context",e=>{var t=this._panel.outerHeight(),n=this._panel.offset();e.clientY>n.top+t-2&&(gDesigner.setMouseOverContext(null,null,null),this._panel.off("mousemove.check-context"))})}),this._panel.on("mouseleave",()=>{this._panel.off("mousemove.check-context"),gDesigner.setMouseOverContext(null,null,null)})},v.prototype.update=function(e,t,n){if(this._styleEditorChange)return this._styleEditorChange=!1,!0;if(this._ownChange)return!0;if(this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._document&&(this._document.getScene().removeEventListener(a.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().removeEventListener(a.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().removeEventListener(a.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null),this._elements=[],e){for(var i=0;i<t.length;++i){var o=t[i],s=function(e,t){t.hasMixin(a.GStylable)&&t.getStylePropertySets().indexOf(a.GStylable.PropertySet.FillPaintLayers)>=0&&this._elements.push(t)}.bind(this),l=r.GElementEditor.getEditor(o);l&&l.getStylableParts()?a.GUtil.each(l.getStylableParts(),s):s(null,o)}if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(a.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().addEventListener(a.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().addEventListener(a.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(n),!0}return!1},v.prototype.openPatternChooser=function(){this._panel.find(".border-block:first-child").find('[data-property="_pt"]').find(".g-button").click()},v.prototype.openEyeDropper=function(e,t){this._panel.find(".border-block:first-child").find('[data-property="_pt"]').gPatternChooser("openEyeDropper",e,t)},v.prototype._styleEditorEventHandler=function(e){this._styleEdOn&&e.type==r.GStyleEdManager.EditorEventType.PrepareModifiedEvent&&(this._styleEditorChange=!0)},v.prototype._updateProperties=function(e){if(this._elements&&this._elements.length){this._panel.find(".border-block").remove();var t=this._elements[0].getPaintLayers().getBorderLayers();a.GUtil.each(t,function(t,n){n&&this._insertPaintLayer(n,e)}.bind(this)),this._updateToolbar()}else console.warn("GBorderPaintLayerProperties: empty _elements array")},v.prototype._updateToolbar=function(){var e=this._panel.find(".border-block").length>0;this._toolbar.toggleClass("empty-list",!e),this._toolbar.find("[data-action=stroke-settings]").css("display",e?"":"none"),this._toolbar.find("[data-action=arrow-settings]").css("display",e?"":"none"),this._toolbar.find("[data-action=remove]").css("display",e?"":"none")},v.prototype._insertPaintLayer=function(e,t){var n=this,i=!1,l=null,c=null,d=null,h=null,m=null,v=0,_=0,b=function(e){if(l){var t=$(e).data("paintLayer");if(t&&(t!==l||o.GPlatform.modifiers.shiftKey))return l.getParent()===t.getParent()}return!1},w=function(t,n,i,o){this._assign(e,t,n,i,o)}.bind(this),C=function(t){if("_pt"===t)return $("<div></div>").attr("data-property","_pt").gPatternChooser({types:[a.GColor,a.GLinearGradient,a.GRadialGradient,a.GAngularGradient,a.GBackground,a.GTexturePattern]}).on("chooseropen",(function(){n._document.getEditor().hideSelection(),gDesigner.getWorkspace().getStyleEdManager().updateEditor(e,"_pt",!1),n._setSelectedPaintLayer(e),n._styleEdOn=!0,n._chooserElem=$(this)})).on("chooserclose",(function(e,t,i){if(gDesigner.getWorkspace().getStyleEdManager().getOverlayLock(i))t();else if(n._styleEdOn=!1,gDesigner.getWorkspace().getStyleEdManager().deactivateEditor(),n._document&&(n._document.getEditor().resetHideSelection(),n._document.hasCDR())){var o=gPatternChooser.getPattern();!o||o instanceof a.GRGBColor||y.showCDRUnsupportedObjectWarning()}n._chooserElem=null})).on("patternchange",(function(e,t,n,i,o,r){var a=["_vs"],s=[!0];void 0!==t&&(a.push("_pt"),s.push(t)),"number"==typeof n&&(a.push("_op"),s.push(n));var l=null;o&&(l={chooserOn:!0},null!=r&&(l.activeStopIdx=r)),w(a,s,i,l)}));if("_bl"==t)return $("<select></select>").gBlendMode().gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.getValue("GAppearanceProperties","text.blend-tooltip-title"),description:a.GLocale.getValue("GAppearanceProperties","text.blend-tooltip-description"),middle:!1,forceShow:!0,learnMore:g.LINKS.BLENDING_MODES_DOCUMENTATION_URL})).attr("data-property","_bl").on("change",(function(e){gDesigner.stats("border_change_blendmode",$(e.target).val()),w(["_bl"],[$(e.target).val()])}));if("_op"===t)return $("<input>").addClass("border-op").attr("data-property","_op").attr("type","text").on("change",(function(e,t){gDesigner.stats("border_change_opacity"),w(["_vs","_op"],[!0,(t||a.GLength.parseEquationValue($(this).gInputBox("value")))/100]),$(e.target).parents(".touch").find($(".transparency")).gInputSlider("value",a.GLength.parseEquationValue($(this).gInputBox("value")))})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"});if("_bw"===t)return $("<input>").attr("data-property",t).on("change",(function(){gDesigner.stats("border_change_width");var e=$(this).gUnitBox("value"),i=e?e.toUnit(a.GLength.Unit.PX):null;null!==i&&i>=0?w(["_vs",t],[!0,i]):n._updateProperties()})).gUnitBox({minValue:0,source:"border"}).gRichTooltip(s.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.border-width-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.border-width-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/borders/"}));if("_vs"===t)return $("<span></span>").attr("data-property","_vs").addClass("border-action border-visibility gravit-icon-touch-show").attr("data-title",a.GLocale.get(new a.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){gDesigner.stats("border_hide_border"),e.stopPropagation();var t=$(this).hasClass("gravit-icon-touch-hide");$(this).removeClass("gravit-icon-touch-"+(t?"hide":"show")),$(this).addClass("gravit-icon-touch-"+(t?"show":"hide")),w(["_vs"],[t])}));if("_ra"===t)return $("<div/>").addClass("transparency gravit-icon-touch-rectangle").gInputSlider({type:"range",min:0,max:100,step:1}).on("input",(function(e){var t=$(e.target),n=parseInt(t.gInputSlider("value"));t.parents(".touch").find($(".border-op")).trigger("change",[n])}));throw new Error("Unknown input property: "+t)},E=$("<div/>").addClass("g-drop-indicator"),S=$("<div></div>").addClass("border-block").addClass("g-cursor-hand-open").attr("data-drag-mode",p.default.PRESS_AND_HOLD).data("paintLayer",e).attr("draggable","true").on("mousedown",(function(e){i=gDesigner.isTouchEnabled()&&e.originalEvent&&e.originalEvent.target?!!$(e.originalEvent.target).closest(".drag-indicator").length:$(e.target).hasClass("border-block")||$(e.target).hasClass("gravit-icon-drag-indicator")||$(e.target).hasClass("columns")||$(e.target).hasClass("column"),$(e.target).closest(".border-block").toggleClass("g-draggable-disabled",!i)})).on("dragstart",(function(e){if(!i)return e.preventDefault(),void e.stopPropagation();var t=$(e.target).closest(".border-block"),s=t.offset(),d=e.originalEvent;(c=window.gDragImage()).addClass("drag-delete gravit-icon-trash"),h=n._panel.offset(),m=n._panel.outerHeight(),v=e.clientX-s.left,_=e.clientY-s.top,d.stopPropagation(),l=t.data("paintLayer"),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain","dummy_data"),n._panel.find(".border-block").each((function(e,t){$(t).append($("<div></div>").addClass("grid-drag-overlay").on("dragenter",(function(){var e=$(this.parentNode).data("paintLayer");if(b(this.parentNode)){if(l&&e&&l.getParent()===e.getParent()){var t=l.getParent(),n=t.getIndexOfChild(l),i=t.getIndexOfChild(e);n!==i&&(n<i?E.insertBefore(this.parentNode):E.insertAfter(this.parentNode))}}else E.remove()})).on("dragleave",(function(){b(this.parentNode)&&$(this).parent().find(".g-drop-indicator").remove()})).on("dragover",(function(e){var t=e.originalEvent;b(this.parentNode)&&(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move")})).on("drop",(function(e){var t=$(this.parentNode).data("paintLayer");if(n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),l&&t&&l.getParent()===t.getParent()){var i=l.getParent(),s=i.getIndexOfChild(l),c=i.getIndexOfChild(t);r.GEditor.tryRunTransaction(i,(function(){if(o.GPlatform.modifiers.shiftKey){var e=l.clone();i.insertChild(e,s<c?t.getNext():t)}else s!==c&&(i.removeChild(l),i.insertChild(l,s<c?t.getNext():t))}),o.GPlatform.modifiers.shiftKey?a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.duplicate-border")):a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.move-border"))),n._updateProperties(),n._setSelectedPaintLayer(l)}l=null})))}))})).on("drag",(function(e){d=(0,u.handleDragForDeleteIcon)(e,c,h,m,v,_)})).on("dragend",(function(e){var t=e.originalEvent,i=$(e.target).closest(".border-block").closest(".border-block").data("paintLayer");if(n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),l&&i&&l.getParent()===i.getParent()){var s=l.getParent(),u=s.getIndexOfChild(l),p=s.getIndexOfChild(i);r.GEditor.tryRunTransaction(s,(function(){if(o.GPlatform.modifiers.shiftKey){var e=l.clone();s.insertChild(e,u<p?i.getNext():i)}else u!==p&&(s.removeChild(l),s.insertChild(l,u<p?i.getNext():i.getPrevious()))}),o.GPlatform.modifiers.shiftKey?a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.duplicate")):a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.move"))),n._updateProperties(),n._setSelectedPaintLayer(l)}l&&d&&r.GEditor.tryRunTransaction(n._elements[0],(function(){var e=[];n._iterateEqualPaintLayer(l,(function(t){e.push(t)})),a.GUtil.each(e,(function(e,t){t.getParent().removeChild(t)}))}),a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.remove-border"))),c&&c.css("display","none"),c=null,t.stopPropagation(),l=null})).on("click",(function(){gDesigner.stats("border_set_border"),n._setSelectedPaintLayer(e)})).gPropertyRow({columns:[{clazz:"drag-indicator",content:$("<div></div>").addClass("gravit-icon-drag-indicator g-cursor-hand-open gravit-icon-touch-drag-indicator")},{width:"40px",clazz:"color-preview",content:C("_pt")},{width:"40px",content:C("_bw").addClass("normal")},{width:"auto",content:C("_bl").addClass("normal")},{width:"45px",content:C("_op").addClass("normal")},{width:"20px",content:$("<span></span>").attr("data-property","_vs").addClass("border-action border-visibility gravit-icon-display normal").attr("data-title",a.GLocale.get(new a.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){gDesigner.stats("border_hide_border"),e.stopPropagation();var t=$(this).hasClass("gravit-icon-hide");$(this).removeClass("gravit-icon-"+(t?"hide":"display")),$(this).addClass("gravit-icon-"+(t?"display":"hide")),w(["_vs"],[t])}))},{width:"auto",content:$("<div/>").addClass("touch").gPropertyRow({columns:[{width:"40px",content:C("_bw")},{width:"auto",content:C("_bl")},{width:"60px",content:C("_vs")}]}).gPropertyRow({columns:[{width:"auto",content:C("_ra")},{width:"60px",content:C("_op")}]})}]}).prependTo(this._panel);S.find(".columns").addClass("g-cursor-hand-open"),S.find(".column").addClass("g-cursor-hand-open"),S.find(".touch").parents(".column").addClass("g-touch"),S.find(".normal").parents(".column").addClass("g-normal"),S.find('[data-property="_pt"]').parents(".column").addClass("g-color"),S.find(".transparency").parents(".touch div:last-child>div").addClass("g-transparency"),S.find(".touch").find("select").addClass("g-select").parent().append($("<span/>").addClass("gravit-icon-touch-arrowDown")),S.contextmenu({context:f.BorderPropertyPanel},(function(e){e.preventDefault();var t=$(this).data("paintLayer");n._setSelectedPaintLayer(t),$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",{previousEvent:e,data:{openAdvancedSettings:function(){n._updateAdvancedSettings(),n._advancedStrokePanel.gOverlay("open",n._toolbar.find("[data-action=stroke-settings]"))},paintLayer:t}})})),this._setSelectedPaintLayer(e),this._updatePaintLayer(e,t),S.find(".transparency").each((function(e,t){$(t).gInputSlider("value",parseInt($(this).parents(".touch").find(".border-op").val()))}))},v.prototype._removePaintLayer=function(e){this._panel.find(".border-block").each((function(t,n){var i=$(n);if(i.data("paintLayer")===e)return i.remove(),!1}))},v.prototype._updatePaintLayer=function(e,t){var n=this;e&&(this._panel.find(".border-block").each((function(t,i){var o=$(i);if(o.data("paintLayer")===e){o.find('[data-property="_pt"]').gPatternChooser("setPattern",e.getProperty("_pt",!1,!1,!0)).gPatternChooser("value",e.getProperty("_pt",!1,!1,!0)).gPatternChooser("opacity",e.getProperty("_op",!1,!1,!0));var r=n._getProperty(e,"_bw",!1,null);o.find('[data-property="_bw"]').each((function(e,t){$(t).gUnitBox({unit:n._document.getScene().getProperty("ut")===a.GLength.Unit.PX?a.GLength.Unit.PX:a.GLength.Unit.PT,minValue:0}).gUnitBox("value",null!==r?new a.GLength(r,a.GLength.Unit.PX):null)})),o.find('[data-property="_op"]').each((function(t,n){$(n).gInputBox("value",a.GUtil.formatOpacity(100*e.getProperty("_op",!1,!1,!0)))})),o.find('[data-property="_bl"]').val(e.getProperty("_bl"));var s=e.getProperty("_vs");o.find('[data-property="_vs"]').removeClass("gravit-icon-"+(s?"hide":"display")).addClass("gravit-icon-"+(s?"display":"hide"))}})),this._updateAdvancedSettings(),t&&(t.evtType==r.GEditor.ModifiedEvent.Type.Undo||t.evtType==r.GEditor.ModifiedEvent.Type.Redo)&&t.chooserOn&&null!=t.borderLayerIndex&&e.getParent().getIndexOfChild(e)==t.borderLayerIndex&&$element.find(".preview").trigger("click",null!=t.activeStopIdx?t.activeStopIdx:null))},v.prototype._assign=function(e,t,n,i,o){if(i)this._iterateEqualPaintLayer(e,(function(e){e.setProperties(t,n,!1,!1,!0)}));else if(this._document){var s=null;if(o){var l=e.getParent().getIndexOfChild(e);s=$.extend({borderLayerIndex:l},o)}this._ownChange=!0;var c=this._document.getEditor();c.beginTransaction();try{this._iterateEqualPaintLayer(e,(function(e,i){var o=r.GElementEditor.getEditor(i);o&&o.applyPropertiesToParts(t,n)||e.setProperties(t,n)}))}finally{c.commitTransaction(a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","action.change-border-properties")),s),this._ownChange=!1}}},v.prototype._getProperty=function(e,t,n,i){return e?e.getProperty(t):null},v.prototype._afterInsert=function(e){e.node instanceof a.GStylable.BorderPaintLayer&&e.node.getOwnerStylable()===this._elements[0]&&(this._insertPaintLayer(e.node),this._updateToolbar())},v.prototype._beforeRemove=function(e){if(e.node instanceof a.GStylable.BorderPaintLayer&&e.node.getOwnerStylable()===this._elements[0]){this._removePaintLayer(e.node);for(var t=e.node.getPrevious();t&&!(t instanceof a.GStylable.BorderPaintLayer);)t=t.getPrevious();if(!(t instanceof a.GStylable.BorderPaintLayer))for(t=e.node.getNext();t&&!(t instanceof a.GStylable.BorderPaintLayer);)t=t.getNext();this._setSelectedPaintLayer(t),this._updateToolbar()}},v.prototype._afterPropertiesChange=function(e){e.node instanceof a.GStylable.BorderPaintLayer&&e.node.getOwnerStylable()===this._elements[0]&&this._updatePaintLayer(e.node)},v.prototype._updateAdvancedSettings=function(){var e=this,t=function(t){var n=this._getProperty(t,"_bds",!1,null),i=this._advancedStrokePanel;i.find('[data-property="_bds"]').each((function(e,t){$(t).val(n&&n.length>e?n[e]:"")})),i.find('[data-property^="_ba"]').each((function(n,i){var o=$(i),r=o.attr("data-property").substr("_ba-".length);if(r===a.GStylable.BorderAlignment.Inside||r===a.GStylable.BorderAlignment.Outside){for(var s,l,c=!1,d=!1,u=0,p=e._elements.length;u<p;u++){var g=e._elements[u];g instanceof a.GPath&&!g.$closed||g instanceof a.GEllipse&&g.$etp===a.GEllipse.Type.Arc?c=!0:d=!0}switch(r){case a.GStylable.BorderAlignment.Inside:l=a.GLocale.get(new a.GLocaleKey("GStylable","border-alignment.inside"));break;case a.GStylable.BorderAlignment.Outside:l=a.GLocale.get(new a.GLocaleKey("GStylable","border-alignment.outside"))}c?o.attr("disabled",!0):o.attr("disabled",!1),s=c&&d?a.GLocale.get(new a.GLocaleKey("GBorderPaintLayerProperties","text.border-alignment.disabled"))+": "+l:l,o.attr("data-title",s)}o.toggleClass("g-active",e._getProperty(t,"_ba",!0)===r)})),i.find('[data-property^="_blc"]').each((function(n,i){var o=$(i),r=o.attr("data-property").substr("_blc-".length);o.toggleClass("g-active",e._getProperty(t,"_blc",!0)===r)})),i.find('[data-property^="_blj"]').each((function(n,i){var o=$(i),r=o.attr("data-property").substr("_blj-".length);o.toggleClass("g-active",e._getProperty(t,"_blj",!0)===r)}));var o=i.find('[data-property="_bml"]');o.gInputBox("value",a.GUtil.formatNumber(this._getProperty(t,"_bml",!0))),this._getProperty(t,"_blj")!==a.GPaintCanvas.LineJoin.Miter?o.attr("disabled",!0):o.removeAttr("disabled");var r=this._getProperty(t,"_bhm",!1,null);i.find('[data-property="_bhm"]').val(r instanceof a.GVertexContainer?"#":r||"");var s=this._getProperty(t,"_btm",!1,null);i.find('[data-property="_btm"]').val(s instanceof a.GVertexContainer?"#":s||""),i.find('[data-property="_bhms"]').gInputBox("value",a.GUtil.formatNumber(100*this._getProperty(t,"_bhms",!1,1),0)),i.find('[data-property="_btms"]').gInputBox("value",a.GUtil.formatNumber(100*this._getProperty(t,"_btms",!1,1),0)),i.find('[data-property="_bhmo"]').prop("checked",this._getProperty(t,"_bhmo",!1,!1)),i.find('[data-property="_bhmi"]').gInputSlider("value",100*this._getProperty(t,"_bhmi")),i.find('[data-property="_btmo"]').prop("checked",this._getProperty(t,"_btmo",!1,!1)),i.find('[data-property="_btmi"]').gInputSlider("value",100*this._getProperty(t,"_btmi")),i.find('[data-property="_bs"]').prop("checked",this._getProperty(t,"_bs",!1,!1))}.bind(this);if(this._getSelectedPaintLayer())t(this._getSelectedPaintLayer());else{var n=$(this._panel).find(".border-block:last").data("paintLayer");n&&t(n)}},v.prototype._setSelectedPaintLayer=function(e){this._panel.find(".border-block").each((function(t,n){var i=$(n);i.toggleClass("g-selected",i.data("paintLayer")===e)})),this._document&&this._document.updateActiveStylesList("Border",e)},v.prototype._getSelectedPaintLayer=function(){return this._panel.find(".border-block.g-selected").data("paintLayer")},v.prototype._iterateEqualPaintLayer=function(e,t){if(e)for(var n=e.getParent().getBorderLayers().indexOf(e),i=0;i<this._elements.length;++i){var o=this._elements[i].getPaintLayers().getBorderLayers();a.GUtil.each(o,function(o,r){(r&&r===e||r.constructor===e.constructor&&o===n)&&t(r,this._elements[i])}.bind(this))}},e.exports=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.dateToVersionFormat=t.dateToFilePreviewFormat=void 0;const{GLocale:i}=n(1),o=e=>i.toLocaleDate(e,{month:"short",day:"numeric",hour:"numeric",minute:"numeric"});t.dateToVersionFormat=o;const r=e=>i.toLocaleDate(new Date(e),{month:"numeric",day:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"});t.dateToFilePreviewFormat=r;var a={dateToVersionFormat:o,dateToFilePreviewFormat:r};t.default=a},function(e,t,n){"use strict";n(9);const i=n(10);e.exports=class{constructor(e){this._worker=e}async updateFileSceneAndMetadata(e,t,n){throw"Not implemented"}_request(e,t){const n=i.uuid(64);return this._worker.postMessage({cmd:e,data:t,id:n}),n}}},function(e,t,n){"use strict";n(9),n(58);var i=n(1);const o=n(78),r=n(352),a=n(386),s=n(305),l=n(777),{GFileReviewFlow:c,gApi:d,FileStatus:u,FILE_REVIEW_ENABLED:p,Notification:g,NotificationConstants:{FILE_REVIEW_FLOW:h=[]}}=n(12);function f(){if(!p)return this;gDesigner.addEventListener(o,this._documentEvent,this),gDesigner.addEventListener(s.FileStatusUpdate,this._storageItemFileStatusEvent,this),gDesigner.addEventListener(l,this._handleShareEvent,this),gDesigner.getActiveDocument()&&(this._addDocumentEvents(gDesigner.getActiveDocument()),this._updateFromDocument(gDesigner.getActiveDocument()))}i.GObject.inherit(f,i.GEventTarget),f.UpdateEvent=function(){},i.GObject.inherit(f.UpdateEvent,i.GEvent),f.prototype._addDocumentEvents=function(e){e.addEventListener(r,this._collaborationEvent,this)},f.prototype._removeDocumentEvents=function(e){e.removeEventListener(r,this._collaborationEvent,this)},f.prototype._storageItemFileStatusEvent=async function(e){let{storageItem:t,newStatus:n}=e;this._fileId===t.getId()&&this._doc.isCollaborative()&&this._setStatus(n)&&this.trigger(new f.UpdateEvent)},f.prototype._handleShareEvent=async function(e){switch(e.type){case l.Type.Updated:await this._updateCollaboratorRoleListIfInitialized(),this.hasEventListeners(f.UpdateEvent)&&this.trigger(new f.UpdateEvent)}},f.prototype._documentEvent=async function(e){const t=e.document;switch(e.type){case o.Type.Activated:this._addDocumentEvents(t),this._updateFromDocument(t);break;case o.Type.Deactivated:this._removeDocumentEvents(t),this._updateFromDocument(t),this._doc=null;break;case o.Type.StorageItemUpdated:this._updateFromDocument(t)}},f.prototype._collaborationEvent=async function(e){const{type:t,sender:n}=e;if(n===gDesigner.getActiveDocument())switch(t){case r.Type.ShareUpdate:case r.Type.UserUpdate:await this._updateCollaboratorRoleListIfInitialized(),this.hasEventListeners(f.UpdateEvent)&&this.trigger(new f.UpdateEvent)}},f.prototype._updateFromDocument=async function(e){if(e!==this._doc&&(this._flow=null,this._fileId=null,this._status=null,this._doc=e,this._collaboratorRoleList=null,this._collaboratorList=null),this._doc&&this._doc.getId()&&this._doc.getStorageItem()&&this._doc.isCollaborative()){this._fileId=this._doc.getId();const e=await this._doc.getStorageItem().getOrCreateCollaborativeFile();e&&this._setStatus(e.status)&&this.trigger(new f.UpdateEvent)}else this._setStatus(null)&&this.trigger(new f.UpdateEvent)},f.prototype._setStatus=function(e){return this._status!==e&&(this._status=e,void 0!==this._status&&null!==this._status||(this._status=u.IN_REVIEW),void 0!==c&&c.constructor&&(this._flow=new c(this._status)),!0)},f.prototype._isCurrentUserApprover=function(){const e=gDesigner.getSyncUser();if(!e)return!1;if(!this._collaboratorList)return!1;const t=this._collaboratorList.find(t=>t.getUID()===e.getUID());return t&&t.getRole().is(a.ROLES.APPROVER_ROLE)},f.prototype._shouldStatusDisabledForApproverWithCurrentStatus=function(e){if(this._isCurrentUserApprover())switch(this._status){case u.IN_REVIEW:case u.REOPENED:return!0;case u.APPROVED:return e===u.IN_REVIEW||e===u.AWAITING_APPROVAL;case u.AWAITING_APPROVAL:return e===u.IN_REVIEW}return!1},f.prototype.getStatus=function(){return this._status},f.prototype.updateReviewStatus=function(e){return this.canUpdateToStatus(e)&&this._fileId?d.updateStatus(this._fileId,e):Promise.reject(i.GLocale.get(new i.GLocaleKey("GFileReviewManager","text.cant-update-file-to-status")))},f.prototype.canUpdateToStatus=function(e){return!!this._flow&&(this._isCurrentUserApprover()?!this._shouldStatusDisabledForApproverWithCurrentStatus(e):this._flow.canMoveTo(e))},f.prototype._updateCollaboratorRoleListIfInitialized=async function(){this._canUpdateCollaboratorList()&&this._collaboratorRoleList&&await this._updateCollaboratorRoleList()},f.prototype._canUpdateCollaboratorList=function(){return this._doc&&this._fileId},f.prototype._updateCollaboratorRoleList=async function(){if(!this._canUpdateCollaboratorList())return;const e=await gDesigner.getShareManager().getCollaboratorsCached(this._doc);e&&(this._collaboratorList=e,this._collaboratorRoleList=e.map(e=>e.getRole()))},f.prototype.hasApprovers=async function(){return!(!this._doc||!this._fileId)&&(this._collaboratorRoleList||await this._updateCollaboratorRoleList(),this._collaboratorRoleList.some(e=>e.is(a.ROLES.APPROVER_ROLE)))},f.prototype.getDocumentReviewHistory=async function(e){const t=await d.annotations.getDesignHistory(e).catch(()=>[]),n=[];for(let e=0;e<t.length;e++){const i=t[e],o=g.from(i);h.includes(o.getAction())&&n.push(o)}return n},e.exports=f},function(e,t,n){"use strict";n(9),n(58);const i=n(175),o=n(718),{gApi:r}=n(12),a={};let s=!1;const l=e=>{delete a[e.user.getUID()]};function c(e){e instanceof i||(e=new i(e)),this._user=e,s||(gDesigner.addEventListener(o,l),s=!0)}c.getUserDataFromAnnotAndUser=function(e,t){const n=e.getProperty("uid");let i=e.getProperty("name"),o="";return n===t.getUID()&&(i=t.getFirstName()||i,o=t.getLastName()||""),{id:n,name:i,last_name:o}},c.prototype.build=function(e){var t=null;const n=$("<span></span>").addClass("g-user-preview").append($("<div />").append(this._user.getUserNameInitials()).addClass("color-preview").css({"background-color":this._user.getUserColor()}));return(async e=>{if(!a.hasOwnProperty(e)){const t=await r.getUser(e,!0).catch(()=>Promise.resolve(null));a[e]=new i(t)}return a[e]})(this._user.getUID()).then(i=>{i&&(t=this._user.avatar||i.avatar)&&(t.includes("graph.microsoft.com")||"http"!==t.substr(0,4)&&"assets"!==t.substr(0,6)?"<svg"===t.substr(0,4)&&n.empty().append($(t).addClass("g-user-preview").toggleClass("grayed",!1).addClass("svg")):(this._user.hasOwnPictureAvatar()||!this._user.avatar&&i.hasOwnPictureAvatar())&&n.empty().append($("<img>").attr("src",t).addClass("g-user-preview").toggleClass("grayed",!1))),e&&e()}),n},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(e){this._zoomLevel=e}i.GObject.inherit(s,a),s.ID="view.magnification",s.ZOOM_LEVELS=[6,12,25,50,66,100,150,200,300,400,800,1600,3200,6400,12800,25600],s.prototype._zoomLevel=null,s.prototype.getId=function(){return s.ID+"."+this._zoomLevel.toString()},s.prototype.getTitle=function(){let e=this._zoomLevel.toString()+"%";return gDesigner.isTouchEnabled()&&100===this._zoomLevel&&(e+=" (".concat(i.GLocale.get(new i.GLocaleKey("GMagnificationAction","text.actual-size")),")")),e},s.prototype.getCategory=function(){return r.CATEGORY_VIEW_MAGNIFICATION},s.prototype.getGroup=function(){return"zoom/magnification-level"},s.prototype.getShortcut=function(){switch(this._zoomLevel){case 50:return[o.GKey.Constant.META,"5"];case 100:return[o.GKey.Constant.META,"1"];case 400:return[o.GKey.Constant.META,"4"];case 800:return[o.GKey.Constant.META,"8"];default:return null}},s.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},s.prototype.execute=function(){var e=this._zoomLevel/100,t=gDesigner.getWindows().getActiveWindow().getView(),n=t.getScene(),o=n?n.getPaintBBox():null,r=o&&!o.isEmpty()?o.getSide(i.GRect.Side.CENTER):new i.GPoint(0,0);if(t.getViewConfiguration().multiPageView){var a=n.getActivePage();a&&(r=r.add(a.getPosition(!0)))}t.zoomAtCenter(r,e)},s.prototype.toString=function(){return"[Object GMagnificationAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="view.canvas.show-guide-lines",s.TITLE=new i.GLocaleKey("GShowGuideLinesAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW_CANVAS},s.prototype.getGroup=function(){return"show/canvas"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,","]},s.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},s.prototype.isCheckable=function(){return!0},s.prototype.isChecked=function(){var e=gDesigner.getWindows().getActiveWindow();if(e){var t=e.getView().getViewConfiguration();return!!t&&!0===t.guideLinesVisible}return!1},s.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView();e.getViewConfiguration().guideLinesVisible=!e.getViewConfiguration().guideLinesVisible,e.invalidate(),gDesigner.setSetting("guide_lines_visible",e.getViewConfiguration().guideLinesVisible)},s.prototype.toString=function(){return"[Object GShowGuideLinesAction]"},e.exports=s},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1),o=n(16),r=n(193),a=n(511),s=n(18),l=n(26),c=n(354);function d(e){this._sidebar=e}i.GObject.inherit(d,l),d.ID="view.toggle-sidebar",d.TITLE=new i.GLocaleKey("GToggleSidebarAction","title"),d.prototype._sidebar=null,d.prototype.getId=function(){return d.ID+"."+this._sidebar.getId()},d.prototype.getTitle=function(){return i.GLocale.get(d.TITLE).replace("%s",i.GLocale.get(this._sidebar.getTitle()))},d.prototype.getCategory=function(){return s.CATEGORY_VIEW},d.prototype.getGroup=function(){return"view-sidebars"},d.prototype.isCheckable=function(){return!0},d.prototype.isChecked=function(){return this._sidebar.getId()===this._getSidebars().getActiveSidebar()},d.prototype.getShortcut=function(){switch(this._sidebar.getId()){case r.SidebarsIds.GOutlineSidebar:return[o.GKey.Constant.OPTION,"1"];case r.SidebarsIds.GInspectorSidebar:return[o.GKey.Constant.OPTION,"2"];default:return null}},d.prototype.execute=function(){this.isChecked()?(this._getSidebars().setActiveSidebar(null),gDesigner.setPartVisible(this._getSidebars().getSidebarsPart(),!1)):(this._getSidebars().setActiveSidebar(this._sidebar.getId()),gDesigner.setPartVisible(this._getSidebars().getSidebarsPart(),!0)),c.setOrientationStateInSetting(this._sidebar.getOrientation(),this.isChecked()),this._sidebar.getId()===a.ID&&gDesigner.getToolbar().updateCommentToggleStatus()},d.prototype._getSidebars=function(){switch(this._sidebar.getOrientation()){case c.Orientation.Left:return gDesigner.getLeftSidebars();case c.Orientation.Right:return gDesigner.getRightSidebars()}},d.prototype.isVisible=function(){return this._sidebar.isVisible()},d.prototype.toString=function(){return"[Object GToggleSidebarAction]"},e.exports=d},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(26);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GUndoAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GUndoAction","tooltip-description")),shortcut:l.SHORTCUT})}}i.GObject.inherit(l,s),l.ID="edit.undo",l.TITLE=new i.GLocaleKey("GUndoAction","title"),l.SHORTCUT=[o.GKey.Constant.META,"z"],l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){var e=gDesigner.getActiveDocument();return e&&e.getEditor()&&e.getEditor().hasUndoState()?i.GLocale.get(new i.GLocaleKey("GUndoAction","undo-action")).replace("%action",e.getEditor().getUndoStateName()):i.GLocale.get(l.TITLE)},l.prototype.getIcon=function(){return"gravit-icon-undo"},l.prototype.getCategory=function(){return a.CATEGORY_EDIT},l.prototype.getGroup=function(){return"undo_redo"},l.prototype.getShortcut=function(){return l.SHORTCUT},l.prototype.isEnabled=function(){return!(gDesigner.getActiveDocument()&&!gDesigner.getActiveDocument().isEditingEnabled())&&(!(!document.activeElement||!$(document.activeElement).is(":editable")||$(document.activeElement).is(":button")||$(document.activeElement).is("select")||gDesigner.isGravitIME(document.activeElement))||!!(gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getEditor()&&gDesigner.getActiveDocument().getEditor().hasUndoState()))},l.prototype.execute=function(){!document.activeElement||!$(document.activeElement).is(":editable")||$(document.activeElement).is(":button")||$(document.activeElement).is("select")||gDesigner.isGravitIME(document.activeElement)?gDesigner.getActiveDocument().getEditor().undoState():document.execCommand("undo")},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GUndoAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=(n(16),i(n(26))),a=(i(n(76)),i(n(18))),s=i(n(1060));function l(){}o.GObject.inherit(l,r.default),l.ID="file.install-to-desktop",l.TITLE=new o.GLocaleKey("GInstallToDesktopAction","title"),l.closedInstallPWADialogDatePropName="pwa.closed-install-pwa-dialog-date",l.installPWA3timesAWeekPropName="pwa.show-install-dialog-3-times-a-week",l.install=function(){var e=gDesigner.getPwaEvent();e&&e.prompt&&e.prompt().then((function(e){let{outcome:t}=e;"dismissed"===t||"accepted"===t&&(gContainer.removeProperty(l.installPWA3timesAWeekPropName),gContainer.removeProperty(l.closedInstallPWADialogDatePropName),gDesigner.closeInstallPwaDialog())}))},l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.default.CATEGORY_FILE},l.prototype.getGroup=function(){return"install"},l.prototype.isAvailable=function(){return s.default.isSupported()&&!window.matchMedia("(display-mode: standalone)").matches},l.prototype.isVisible=function(){return!window.matchMedia("(display-mode: standalone)").matches},l.prototype.isEnabled=function(){return gDesigner.hasPwaEvent()},l.prototype.execute=function(){return l.install()},l.prototype.toString=function(){return"[Object GInstallToDesktopAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(17),o=n(16),r=i(n(76));class a{static isSupported(){return a.isRuntimeSupported()&&a.isWebBrowserSupported()&&a.isPWAEventSupported()}static isRuntimeSupported(){return gContainer.getRuntime()===r.default.Runtime.Browser}static isWebBrowserSupported(){return o.GPlatform.webBrowser===o.GPlatform.constructor.WebBrowser.Chrome||o.GPlatform.webBrowser===o.GPlatform.constructor.WebBrowser.Edge}static isPWAEventSupported(){return void 0!==window.BeforeInstallPromptEvent}}e.exports=a},function(e,t,n){"use strict";var i=n(1);function o(e,t){this.type=e,this.data=t}i.GObject.inherit(o,i.GEvent),o.Type={DoubleClickFile:1,Reload:2},o.prototype.type=null,o.prototype.data=null,e.exports=o},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(18),a=n(783),s=n(94);function l(){}o.GObject.inherit(l,s),l.ID="modify.attachToPath",l.TITLE=new o.GLocaleKey("GAttachToPathAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_MODIFY_PATH},l.prototype.getGroup=function(){return"structure/modify"},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-attach-to-path":null},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null,t=[],n=null;if(e)for(var r=0;r<e.length;++r)if(e[r]instanceof o.GText&&!e[r].hasPathAttached()){var a=i.GElementEditor.getEditor(e[r]);a&&!a.isInlineEdit()&&t.push(e[r])}else!e[r].hasMixin(o.GVertexSource)||e[r]instanceof o.GPathsGraph||(n=e[r]);return!(!t.length||!n)},l.prototype.execute=function(){var e,t=gDesigner.getActiveDocument(),n=t?t.getScene():null,r=(u=t?t.getEditor():null)?u.getIndividualSelection():null,s=null,l=[];if(r)for(var c=0;c<r.length;++c)if(!s&&r[c]instanceof o.GPathBase)s=r[c];else if(r[c]instanceof o.GText&&!r[c].hasPathAttached()){var d=i.GElementEditor.getEditor(r[c]);d&&!d.isInlineEdit()&&l.push(r[c])}else e||!r[c].hasMixin(o.GVertexSource)||r[c]instanceof o.GPathsGraph||(e=r[c]);try{if(u.beginTransaction(),!s){var u=gDesigner.getActiveDocument().getEditor();e instanceof o.GCompoundPath?gDesigner.executeAction(a.ID,void 0,void 0,!0):(u.updateSelection(!1,[e]),u.convertSelectionToPaths()),s=u.getSelection()[0],(r=r.concat()).splice(r.indexOf(e),1),u.updateSelection(!0,r)}n&&l.map((function(e){n.link(e,s)}))}finally{u.commitTransaction(o.GLocale.get(this.getTitle()))}},l.prototype.toString=function(){return"[Object GAttachToPathAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=(n(16),n(18)),r=n(94);function a(){}i.GObject.inherit(a,r),a.ID="modify.resetinstance",a.TITLE=new i.GLocaleKey("GResetInstanceAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_MODIFY_SYMBOL},a.prototype.getGroup=function(){return"structure/modify"},a.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-reset-instance":null},a.prototype.isEnabled=function(){if(!r.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t&&t.length)for(var n=t.length-1;n>=0;--n){var o=t[n];if(!o.isLocked()){if(o instanceof i.GSymbol&&!o.isLocked()&&!o.inSync())return!0;var a=null;if((a=o.findParent((function(e){return e instanceof i.GSymbol})))&&!a.inSync(o,!0))return!0}}}return!1},a.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=i.GNode.order(e.getIndividualSelection().slice());e.beginTransaction();try{for(var n=0;n<t.length;++n){var o=t[n];if(o instanceof i.GSymbol&&!o.isLocked()&&!o.inSync()&&o.synchronize(),!(o instanceof i.GSymbol)){var r=null;(r=o.findParent((function(e){return e instanceof i.GSymbol})))&&(r.inSync(o,!0)||r.synchronize(o))}}}finally{e.commitTransaction(i.GLocale.get(a.TITLE))}},a.prototype.toString=function(){return"[Object GResetInstanceAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(94);function a(){}i.GObject.inherit(a,r),a.ID="modify.detachFromPath",a.TITLE=new i.GLocaleKey("GDetachFromPathAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_MODIFY_PATH},a.prototype.getGroup=function(){return"structure/modify"},a.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-detach-from-path":null},a.prototype.isEnabled=function(){if(!r.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null;if(e)for(var t=0;t<e.length;++t)if(e[t]instanceof i.GText&&e[t].hasPathAttached())return!0;return!1},a.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getIndividualSelection():null,o=[];if(n)for(var r=0;r<n.length;++r)n[r]instanceof i.GText&&n[r].hasPathAttached()&&o.push(n[r]);t.beginTransaction();try{var a=e.getScene();o.forEach((function(e){a.visitLinks(e,(function(t){t instanceof i.GPathBase&&a.unlink(e,t)}))}))}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}},a.prototype.toString=function(){return"[Object GDetachFromPathAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.join-paths",s.TITLE=new i.GLocaleKey("GJoinPathsAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY_PATH},s.prototype.getGroup=function(){return"structure/path"},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-join-paths":null},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"J"]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t&&t.length>1)for(var n=0,o=0;o<t.length;++o)if(!(t[o]instanceof i.GImage)&&((t[o]instanceof i.GPathBase||t[o].hasMixin(i.GVertexSource))&&n++,2===n))return!0}return!1},s.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=e.getSelection();if(t&&t.length){e.beginTransaction();try{var n=new i.GRectangle;i.GElement.prototype.assignFrom.call(n,t[0]),e.convertSelectionToPaths(!0);var o=e.joinPaths();o&&(i.GElement.prototype.assignFrom.call(o,n),e.updateSelection(!1,[o]))}finally{e.commitTransaction(i.GLocale.get(this.getTitle()))}}},s.prototype.toString=function(){return"[Object GJoinPathsAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(18),a=n(94);function s(){}o.GObject.inherit(s,a),s.ID="edit.selectbyfonttype",s.TITLE=new o.GLocaleKey("GSelectByFontTypeAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getGroup=function(){return"edit/select-by-font"},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_SELECT_SAME},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e&&e.getEditor()&&e.getEditor().getSelection()){var t=this._getFontFamily();return!(!t||!t.length)}return!1},s.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=this._getFontFamily(),n=gDesigner.getWorkspace().getFontManager().getDefaultFont(),i=[];e.getScene().acceptChildren((function(e){(e.removeFlag(o.GNode.Flag.Selected),e instanceof o.GText)&&((e.getProperty("_tff")||n&&n.getFamily())===t&&i.push(e))})),e.getEditor().updateSelection(!0,i)},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-select-by-font":""},s.prototype.toString=function(){return"[Object GSelectByFontTypeAction]"},s.prototype._getFontFamily=function(){for(var e,t=gDesigner.getActiveDocument().getEditor().getSelection(),n=gDesigner.getWorkspace().getFontManager().getDefaultFont(),r=0;r<t.length;r++){var a=t[r];if(a instanceof o.GText){var s=(i.GElementEditor.getEditor(a)||a).getProperty("_tff");if(s||(s=n&&n.getFamily()),e){if(e!==s){e="";break}}else e=s}}return e},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(94),s=n(722);function l(){}i.GObject.inherit(l,a),l.ID="modify.mask-with-shape",l.TITLE=new i.GLocaleKey("GMaskWithShapeAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_MODIFY},l.prototype.getGroup=function(){return"structure-group"},l.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.SHIFT,"M"]},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-mask-with-shape":""},l.prototype.isEnabled=function(){return s.prototype.isEnabled.call(this)},l.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor();e.beginTransaction();try{if(s.prototype.execute.call(this,!0,!0),e.getSelection().length>0){var t=e.getSelection()[0];t.setProperty("name",i.GLocale.get(new i.GLocaleKey("GMaskWithShapeAction","text.mask")));var n=t.getPaintLayers();if(n){for(var o=function(e){e:for(var t=e.getFirstChild();null!==t;t=t.getNext())if(t instanceof i.GStylable.FillPaintLayer&&t.getProperty("_pt")instanceof i.GLinearGradient){var n=t.getProperty("_pt");n;t:for(var o=0;o<n.getStops().length;++o){var r=n.getStops()[o].color.toScreenCSS();if("#FFFFFF"!==r&&"#000000"!==r){n=null;break t}}if(n)break e}return n}(n),r=[],a=n.getFirstChild();null!==a;a=a.getNext())a instanceof i.GStylable.FillPaintLayer&&r.push(a);for(var l=0;l<r.length;++l)n.removeChild(r[l]);if(n.insertChild(new i.GStylable.FillPaintLayer(i.GRGBColor.WHITE)),o){o=o.clone();for(l=0;l<o.getStops().length;++l){var c=o.getStops()[l];"#FFFFFF"===c.color.toScreenCSS()&&(c.opacity=0)}var d=new i.GOverlayEffect;t.getEffects().appendChild(d),d.setProperties(["alm","opc","pat"],[!0,1,o])}}}}finally{e.commitTransaction(i.GLocale.get(this.getTitle()))}},l.prototype.toString=function(){return"[Object GMaskWithShapeAction]"},e.exports=l},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=(n(16),n(18),n(26));n(1196);function r(){this._targetPosition=null}i.GObject.inherit(r,o),r.ID="edit.paste.here",r.TITLE=new i.GLocaleKey("GPasteHereAction","title"),r.prototype._targetPosition=null,r.prototype.getId=function(){return r.ID},r.prototype.getTitle=function(){return r.TITLE},r.prototype.getIcon=function(){return null},r.prototype.getCategory=function(){return null},r.prototype.getGroup=function(){return null},r.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-paste-here":null},r.prototype.getShortcut=function(){return null},r.prototype.isAvailable=function(e){return!!e&&"context.menu"==e},r.prototype.isEnabled=function(){if(document.queryCommandSupported("paste"))return!0;var e=gDesigner.getClipboardMimeTypes();return!!(e&&e.indexOf(i.GNode.MIME_TYPE)>=0)&&!!gDesigner.getActiveDocument()},r.prototype.execute=function(){gDesigner.getPaste().assignCallback(this._paste.bind(this)),document.execCommand("paste")||(gDesigner.getPaste().assignCallback(null),this._paste(i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE))))},r.prototype.setPosition=function(e){this._targetPosition=gDesigner.getWindows().getActiveWindow().getView().getViewTransform(gDesigner.getActiveDocument().getScene().getActivePage()).mapPoint(e)},r.prototype._paste=function(e,t){if(e&&e.length>0){for(var n=[],o=0;o<e.length;++o)e[o]instanceof i.GElement&&n.push(e[o]);if((n=gDesigner.getActiveDocument().filterUnrestrictedCommercialFileElements(n)).length>0){var r=gDesigner.getActiveDocument().getEditor();n.forEach(e=>{e instanceof i.GText&&!e.getProperty("content")&&(r.insertElements([e],!1,!0,!0),e.getParent().removeChild(e))}),r.beginTransaction();try{var a;r.insertElements(n,!t,!0,!0,!0),n.forEach(e=>{var t=e.getGeometryBBox();t&&(a=a?a.united(t):t)});var s=a?a.getX():null,l=a?a.getY():null,c=null;if(!this._targetPosition||null===s||i.GMath.isEqualEps(this._targetPosition.getX(),s)&&i.GMath.isEqualEps(this._targetPosition.getY(),l)||(c=new i.GTransform(1,0,0,1,this._targetPosition.getX()-s,this._targetPosition.getY()-l)),c)for(o=0;o<n.length;++o){var d=n[o];d.hasMixin(i.GElement.Transform)&&d.transform(c,!0)}}finally{r.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPaste","action.paste")))}}}},r.prototype.toString=function(){return"[Object GPasteHereAction]"},e.exports=r},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=n(16),r=n(18),a=n(26),s=n(94);function l(){}i.GObject.inherit(l,a),l.ID="edit.paste.in-place",l.TITLE=new i.GLocaleKey("GPasteInPlaceAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_EDIT_PASTE},l.prototype.getGroup=function(){return"ccp/paste"},l.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"V"]},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e&&e.getEditor().getSelection()){if(document.queryCommandSupported("paste"))return!0;var t=gDesigner.getClipboardMimeTypes();if(t&&t.indexOf(i.GNode.MIME_TYPE)>=0)return!!gDesigner.getActiveDocument()}return!1},l.prototype.execute=function(){gDesigner.getPaste().assignCallback(this._paste.bind(this)),!gDesigner.isTouchDevice()&&document.execCommand("paste")||(gDesigner.getPaste().assignCallback(null),this._paste(i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE))))},l.prototype._paste=function(e,t){if(e&&e.length>0){for(var n=[],o=0;o<e.length;++o)e[o]instanceof i.GElement&&n.push(e[o]);if((n=gDesigner.getActiveDocument().filterUnrestrictedCommercialFileElements(n)).length>0){var r=gDesigner.getActiveDocument().getEditor();n.forEach(e=>{e instanceof i.GText&&!e.getProperty("content")&&(r.insertElements([e],!1,!0,!0),e.getParent().removeChild(e))});var a=null,s=null,l=r.getSelectionBBox(!0);l&&(a=l.getX(),s=l.getY()),r.beginTransaction();try{r.insertElements(n,!t,!0,!0,!0);var c=null;n.forEach(e=>{var t=e.getGeometryBBox();t&&(c=c?c.united(t):t)});var d=c?c.getX():null,u=c?c.getY():null,p=null;if(null===a||null===d||i.GMath.isEqualEps(a,d)&&i.GMath.isEqualEps(s,u)||(p=new i.GTransform(1,0,0,1,a-d,s-u)),p)for(o=0;o<n.length;++o){var g=n[o];g.hasMixin(i.GElement.Transform)&&g.transform(p,!0)}}finally{r.commitTransaction(i.GLocale.get(this.getTitle()))}}}},l.prototype.toString=function(){return"[Object GPasteInPlaceAction]"},e.exports=l},function(e,t,n){"use strict";n(19),n(24),n(28),n(3);var i=n(1),o=n(16),r=(n(43),n(18)),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="edit.paste.inside",s.TITLE=new i.GLocaleKey("GPasteInsideAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT_PASTE},s.prototype.getGroup=function(){return"ccp/paste"},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-paste-inside":null},s.prototype.getShortcut=function(){return[o.GKey.Constant.OPTION,o.GKey.Constant.SHIFT,o.GKey.Constant.META,"V"]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t){if(document.queryCommandSupported("paste"))return!0;var n=gDesigner.getClipboardMimeTypes();if(n&&n.indexOf(i.GNode.MIME_TYPE)>=0)for(var o=0;o<t.length;++o)if(t[o].hasMixin(i.GNode.Container))return!0}}return!1},s.prototype.execute=function(){gDesigner.getPaste().assignCallback(this._paste.bind(this)),!gDesigner.isTouchDevice()&&document.execCommand("paste")||(gDesigner.getPaste().assignCallback(null),this._paste(i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE))))},s.prototype._paste=function(e,t){if(e&&e.length>0){for(var n=[],o=0;o<e.length;++o)e[o]instanceof i.GElement&&n.push(e[o]);if((n=gDesigner.getActiveDocument().filterUnrestrictedCommercialFileElements(n)).length>0){var r=gDesigner.getActiveDocument().getEditor(),a=[...r.getSelection()];n.forEach(e=>{e instanceof i.GText&&!e.getProperty("content")&&(r.insertElements([e],!1,!0,!0),e.getParent().removeChild(e))}),r.beginTransaction();try{for(o=0;o<a.length;++o){var s=a[o];if(s.hasMixin(i.GNode.Container)&&!s.isLocked()){for(var l=[],c=0;c<n.length;++c)n[c].validateInsertion(s)&&l.push(n[c].clone());r.insertElements(l,!t,!0,!1,!0,s);var d=s instanceof i.GElement?s.getGeometryBBox():null;if(d){var u=d.getX(),p=d.getY(),g=null;l.forEach(e=>{var t=e.getGeometryBBox();t&&(g=g?g.united(t):t)});var h=g?g.getX():null,f=g?g.getY():null,m=null;if(null===u||null===h||i.GMath.isEqualEps(u,h)&&i.GMath.isEqualEps(p,f)||(m=new i.GTransform(1,0,0,1,u-h,p-f)),m)for(c=0;c<l.length;++c){var y=l[c];y.hasMixin(i.GElement.Transform)&&y.transform(m,!0)}}}}}finally{r.commitTransaction(i.GLocale.get(this.getTitle()))}}}},s.prototype.toString=function(){return"[Object GPasteInsideAction]"},e.exports=s},function(e,t,n){"use strict";n(168),n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(18),s=n(94),l=n(36);function c(){}i.GObject.inherit(c,s),c.ID="modify.ouline",c.TITLE=new i.GLocaleKey("GOutlineAction","title"),c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},c.prototype.getGroup=function(){return"structure/modify"},c.prototype.getShortcut=function(){return[o.GKey.Constant.F5]},c.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null,t=!1;if(e)for(var n=0;!t&&n<e.length;++n)e[n]instanceof i.GImage||!e[n].hasMixin(i.GVertexSource)||(t=!0);return t},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-convert-to-outline":null},c.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getIndividualSelection():null,o=[];if(n)for(var a=0;a<n.length;++a){var s=n[a];s.hasMixin(i.GVertexSource)&&o.push(s)}o.length&&l.prompt(this._dialogPromptMessage(),e=>{if(e){var n,a,s=parseFloat(e);if(isNaN(s)||!isFinite(s)||i.GMath.isEqualEps(s,0))l.alert(i.GLocale.get(new i.GLocaleKey("GOutlineAction","text.invalid-value")));else{t.beginTransaction();try{try{a=new Set;for(var c=0;c<o.length;++c){var d=o[c].getParent();d&&a.add(d)}(0,r.blockChanges)(t,a),n=[];for(c=0;c<o.length;++c){var u=o[c],p=u.getParent();if(p){var g=u.getNext(),h=this._makeOffsetter(s,u),f=i.GPathUtil.createPathFromVertexSource(h);f&&(i.GElement.prototype.assignFrom.call(f,u),p.insertChild(f,g),n.push(f)),p.removeChild(u)}}}finally{(0,r.releaseChanges)(t,a),n.length&&t.updateSelection(!1,n)}}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}}},"1")},c.prototype._dialogPromptMessage=function(){return i.GLocale.get(new i.GLocaleKey("GOutlineAction","text.dialog-prompt-message"))},c.prototype._makeOffsetter=function(e,t){var n;if(t.hasMixin(i.GStylable)){var o=t.getPaintLayers();if(o){var r=o.getBorderLayers(!0).pop();r&&(n=r.$_blc)}}var a=e>0?e:-e;return t instanceof i.GPathBase&&!t.isClockWise()&&t.reverseOrder(),new i.GVertexOffsetter(t,a,!0,!0,0,n)},c.prototype.toString=function(){return"[Object GOutlineAction]"},e.exports=c},function(e,t,n){"use strict";n(9);e.exports=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._factory=e,this._timeout=t,this._lastCheckTime=0}get(){if(this._timeout){const e=Date.now();this._lastCheckTime||(this._lastCheckTime=e);e-this._lastCheckTime>=this._timeout&&(this.reset(),this._lastCheckTime=e)}return this._promise||(this._promise=this._factory.apply(this._factory,arguments)),this._promise}reset(){this._promise=null}setCacheValue(e){this.reset(),this._lastCheckTime=Date.now(),this._promise=Promise.resolve(e)}}},function(e,t,n){"use strict";e.exports=class{setId(e){return this}setTime(e){return this}setType(e){return this}setLanguage(){return this}setCampaign(e){return this}setShareFile(e){return this}setDashboard(e){return this}setProduct(e){return this}setInAppPurchasesAvailable(e){return this}setLayout(e){return this}build(){throw"Not implemented"}}},function(e,t,n){"use strict";n(9);e.exports=class{static get DEFAULT_LAYOUT(){return 0}async open(){throw"Not implemented"}}},function(e,t,n){"use strict";var i=n(1);function o(){}o.CheckingForUpdate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isSilent=e.isSilent},i.GObject.inherit(o.CheckingForUpdate,i.GEvent),o.InstallUpdate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isSilent=e.isSilent},i.GObject.inherit(o.InstallUpdate,i.GEvent),o.UpdateAvailable=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.newVersion=e.newVersion,this.currentVersion=e.currentVersion,this.forceUpdate=e.forceUpdate,this.isSilent=e.isSilent},i.GObject.inherit(o.UpdateAvailable,i.GEvent),o.UpdateError=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.error=e.error,this.isSilent=e.isSilent},i.GObject.inherit(o.UpdateError,i.GEvent),o.Downloading=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.percent=e.percent,this.size=e.size,this.newVersion=e.newVersion,this.isSilent=e.isSilent},i.GObject.inherit(o.Downloading,i.GEvent),o.DownloadComplete=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.newVersion=e.newVersion,this.forceUpdate=e.forceUpdate,this.isSilent=e.isSilent},i.GObject.inherit(o.DownloadComplete,i.GEvent),o.AfterUpdate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.currentVersion=e.currentVersion,this.isSilent=e.isSilent},i.GObject.inherit(o.AfterUpdate,i.GEvent),o.UpdateNotAvailable=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.currentVersion=e.currentVersion,this.isSilent=e.isSilent},i.GObject.inherit(o.UpdateNotAvailable,i.GEvent),o.BeforeInstallUpdate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isSilent=e.isSilent},i.GObject.inherit(o.BeforeInstallUpdate,i.GEvent),e.exports=o},function(e,t,n){"use strict";e.exports=class{constructor(){this._swiping=!1}update(e){this._touches=e.touches?Array.from(e.touches):[]}setSwiping(e){this._swiping=e}isSwiping(){return this._swiping}hasActiveIdentifier(e){return!!this._touches&&this._touches.some(t=>t.identifier===e.identifier)}hasActiveIdentifiers(){return!!this._touches&&this._touches.length>0}}},function(e,t,n){"use strict";n(9);const{gApi:i}=n(12);e.exports=class{canMakePayments(){return!0}getOptions(){return null}async purchase(e,t){throw"Not implemented"}async getProduct(){return null}async syncLicense(){return Promise.resolve()}}},function(e,t,n){"use strict";n(28);const{GObject:i}=n(1),{GPlatform:o}=n(16);function r(){this._children=[]}i.inherit(r,i),r.prototype._children=null,r.prototype.clear=function(){this._clearChildren(),this._clearOwnData()},r.prototype._clearOwnData=function(){},r.prototype._clearChildren=function(){this._children&&this._children.length&&this._children.forEach(e=>e.clear()),this._children=[]},r.prototype.clearChildren=function(){this._clearChildren()},r.prototype.getChildren=function(){return this._children},r.prototype.addChild=function(e){this._children.push(e)},r.prototype.scrollIntoView=function(){},r.prototype.setVisiblity=function(e){throw Error("Not implemented!")},r.prototype._scrollToElement=function(e){if(!e||!e[0])return;const t=o.webBrowser===o.constructor.WebBrowser.Firefox,n=t?"start":"nearest",i=t?"auto":"smooth";"function"==typeof e[0].scrollIntoView&&e[0].scrollIntoView({behavior:i,block:n})},e.exports=r},,function(e,t,n){"use strict";n(9),n(19),n(158),n(201),n(166),n(167),n(14),n(115),n(28),n(1081),n(1082),n(129);var i=n(160),o=n(0),r=n(216);const{GRegex:a}=n(238);var s=n(1006).saveAs,l=!1,c=null,d=null;function u(){this._fileInput=null,this._fileInputCallback=null}function p(e){return e.queryPermission({writable:!0}).then(t=>"granted"!==t?e.requestPermission({writable:!0}):t).then(e=>{if("granted"!==e)throw new Error("Cannot get write access")})}o.inherit(u,r),u.Directory=function(e,t){r.Directory.call(this,e),this._dirHandle=t,this._id=null},o.inherit(u.Directory,r.Directory),u.Directory.prototype._dirHandle=null,u.Directory.prototype._id=null,u.Directory.prototype.getUniqueId=function(){return null},u.Directory.prototype.addDirectory=async function(e,t){let n=null;try{return n=await this._dirHandle.getDirectory(e,{create:!0}),await p(n),new u.Directory(this._storage,n)}catch(t){throw new Error("Cannot create a directory: "+e)}},u.Directory.prototype.addFile=async function(e,t){let n=null;try{return n=await this._dirHandle.getFile(e,{create:!0}),await p(n),new u.Item(this._storage,null,n.name,n)}catch(e){throw new Error("Cannot create a file")}},u.Item=function(e,t,n,i){r.Item.call(this,e),this._data=t,this._filename=n,this._fileHandle=i},o.inherit(u.Item,r.Item),u.Item.prototype._data=null,u.Item.prototype._filename=null,u.Item.prototype._fileHandle=null,u.Item.prototype.getFullName=function(){return this._filename},u.Item.prototype.setFileName=function(e){this._filename=e},u.Item.prototype.read=function(e,t,n){if(this._data||!this._fileHandle)return e(this._data);this._fileHandle.getFile().then(e=>e.arrayBuffer()).then(t=>{this._data=new Uint8Array(t),e(this._data)})},u.Item.prototype.write=function(e,t,n,i,o){if(this._verifyFileNotTooSmall(e.length,o),this._fileHandle){let i=null;this._fileHandle.createWritable().then(e=>(i=e,i.truncate(0))).then(()=>i.write(e)).then(()=>i.close()).then(()=>{t&&t()}).catch(i=>{if(i instanceof DOMException&&i.code===DOMException.QUOTA_EXCEEDED_ERR)return this.notEnoughDiskSpace(),void(n?n():t&&t());s(new Blob([e]),this._filename),t&&t()})}else s(new Blob([e]),this._filename),t&&t()},u.prototype._hasFileAPI=function(){return"function"==typeof window.showSaveFilePicker&&!this._isChromeOS()},u.prototype._isChromeOS=function(){return a.NavigatorUserAgent.IS_CHROME_OS.test(navigator.userAgent||"")},u.prototype._hasDirectoryWriteAPI=function(){return"function"==typeof window.chooseFileSystemEntries},u.prototype.canChooseDirectory=function(){return this._hasDirectoryWriteAPI()&&!l},u.prototype.canPromptOpen=function(){return!0},u.prototype.canPromptSave=function(e){return this._hasFileAPI()},u.prototype.canSave=function(){return this._hasFileAPI()},u.prototype.canDownload=function(){return!0},u.prototype.chooseDirectory=function(e,t,n){if(!this._hasFileAPI()||!this.canChooseDirectory())return;var i={type:d||"open-directory"};let o=null;var r=!1;window.chooseFileSystemEntries(i).then(e=>(o=e,p(e))).then(()=>{let t=e(new u.Directory(this,o));return r=!0,t}).catch(e=>{if(e instanceof DOMException&&"SecurityError"===e.name){if(l=!0,n)return void n()}else!r&&!d&&e instanceof TypeError&&(d="openDirectory");t&&t()})},u.prototype.openPrompt=function(e,t,n){let{disableFileSystemAccessAPI:o=!1,silent:r=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!o&&this._hasFileAPI()){var a={multiple:!!n};return e.length>0&&(a.excludeAcceptAllOptions=!0,a.types=[this._prepareDialogTypes(e)]),window.showOpenFilePicker(a).then(e=>{Array.isArray(e)||(e=[e]),e.forEach(n=>{n.getFile().then(e=>e.arrayBuffer()).then(i=>t(new u.Item(this,new Uint8Array(i),n.name,n),e.length)).catch(e=>{console.log("ERROR reading file")})})}).catch(e=>{e instanceof DOMException||console.warn("showOpenFilePicker warning",e)}),void(this._fileInputCallback=t)}const s=e.map(e=>e.ext).flat();e.map(e=>e.mime);if(!this._fileInput){this._fileInput=document.createElement("input"),this._fileInput.setAttribute("type","file"),this._fileInput.setAttribute("id","file-input"),this._fileInput.multiple=n,this._fileInput.style.opacity=0,this._fileInput.style.position="absolute",this._fileInput.style.zIndex=-1,this._fileInput.style.left="-9999px",this._fileInput.style.top="-9999px";var l=function(e){var t=this._fileInput.files.length;if(e>=t)this._fileInput.value="";else{var n=this._fileInput.files[e],i=n.name;if(n instanceof File||n instanceof Blob){var o=new FileReader;o.onload=function(){this._fileInputCallback(new u.Item(this,new Uint8Array(o.result),i),t),l(e+1)}.bind(this),o.readAsArrayBuffer(n)}else l(e+1)}}.bind(this);this._fileInput.addEventListener("change",()=>{l(0)}),document.body.appendChild(this._fileInput)}i.hardware===i.Hardware.Tablet&&i.operatingSystem===i.OperatingSystem.OSX_IOS?this._fileInput.removeAttribute("accept"):s&&s.length?this._fileInput.setAttribute("accept",s.map(e=>"."+e).join(",")):this._fileInput.removeAttribute("accept"),this._fileInputCallback=t,this._fileInput.focus(),r||this._fileInput.click()},u.prototype.savePrompt=function(e,t,n,i){if(this._hasFileAPI()){var o={};t.length>0&&(o.excludeAcceptAllOptions=!0,o.types=[this._prepareDialogTypes(t,!0)]);var r=!1;window.showSaveFilePicker(o).then(e=>(r=!0,n(new u.Item(this,null,e.name,e)))).catch(t=>{if(!r&&!c&&t instanceof TypeError&&(c="saveFile"),!r&&t.code!==DOMException.ABORT_ERR)return this.download(e,n);i&&i()})}},u.prototype._prepareDialogTypes=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={};for(let i=0,o=e.length;i<o;i++){let{mime:o,ext:r}=e[i];o&&r?(t&&"jpg"===r&&(o="x-really-an-image/jpeg"),void 0!==n[o]?(Array.isArray(n[o])||(n[o]=[n[o]]),n[o].push(r.startsWith(".")?r:".".concat(r))):n[o]=r.startsWith(".")?r:".".concat(r)):console.warn('openPrompt warning: no mime or ext. given mime: "'.concat(o,'", given ext: "').concat(r,'"'))}return{accept:n}},u.prototype.download=function(e,t){return t(new u.Item(this,null,e))},e.exports=u},function(e,t,n){"use strict";var i=n(47),o=n(1254),r=n(97),a=n(109),s=n(114),l=n(512);i({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=r(this),n=a(t),i=l(t,0);return i.length=o(i,t,t,n,0,void 0===e?1:s(e)),i}})},function(e,t,n){n(513)("flat")},function(e,t,n){"use strict";function i(){try{this._createDB()}catch(e){this._failedStarting=!0,console.log("Cannot createIndexedDB"),i._removeCallbacks()}}i.getInstance=function(e){if(!i._instance||!i._instance._dataBase||i._instance._failedStarting)try{if(e&&i._cb.push(e),i._instance&&!i._instance._failedStarting||(i._instance=new i),e)return null}catch(e){return i._instance=null,void i._removeCallbacks()}return e&&e(i._instance),i._instance},i._removeCallbacks=function(e){if(i._cb.length){for(var t=0;t<i._cb.length;t++)i._cb[t](e||null);i._cb=[]}},i._instance=null,i._cb=[],i.FONT_LIST="_gravit_font_list_",i.NATIVE_FONT_LIST="_gravit_native_font_list_",i.NATIVE_FONT_LIST_DATE="_gravit_native_font_list_date_",i.NATIVE_FONT_LIST_V="_gravit_native_font_list_v_";var o="gravitFonts";i.prototype._cb=null,i.prototype._dataBase=null,i.prototype._cachingService=null,i.prototype._cachingBroken=!1,i.prototype._failedStarting=!1,i.prototype._createDB=function(){try{window.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.OIDBTransaction||window.msIDBTransaction}catch(e){}if(window.indexedDB){var e=indexedDB.open("gravitFontsDB",1);if(e.addEventListener("error",()=>{this._failedStarting=!0,i._removeCallbacks()}),"done"===e.readyState){if(e.error)throw this._failedStarting=!0,new Error("Failed starting GFontDBClient");this._requestSuccess({target:e})}else e.onsuccess=this._requestSuccess.bind(this),e.onerror=function(e){0};e.onupgradeneeded=this._createStore.bind(this)}else i._removeCallbacks()},i.prototype._requestSuccess=function(e){if(this._dataBase)i._removeCallbacks(this);else if(this._dataBase=e.target.result,this._dataBase){if(this._dataBase.onerror=function(e){0},this._dataBase.setVersion)if(1!=this._dataBase.version)return void(this._dataBase.setVersion(1).onsuccess=function(){this._createStore(),i._removeCallbacks(this)}.bind(this));i._removeCallbacks(this)}},i.prototype._createStore=function(e){this._dataBase||(this._dataBase=e.target.result),this._dataBase&&this._dataBase.createObjectStore(o)},i.prototype.ready=function(){return!!this._dataBase},i.prototype.clear=function(){return $.Deferred(function(e){this._dataBase||e.resolveWith(this,[!0]);try{var t=this._dataBase.transaction([o],"readwrite");try{var n=t.objectStore(o).clear();n.onsuccess=function(t){e.resolveWith(this,[!0])}.bind(this),n.onerror=function(t){e.resolveWith(this,[!1])}.bind(this)}catch(t){return void e.resolveWith(this,[!1])}}catch(t){0,e.resolveWith(this,[!1])}}.bind(this))},i.prototype.deleteItem=function(e){return $.Deferred(function(t){this._dataBase||t.resolveWith(this,[!0]);try{var n=this._dataBase.transaction([o],"readwrite");try{var i=n.objectStore(o).delete(e);i.onsuccess=function(e){t.resolveWith(this,[!0])}.bind(this),i.onerror=function(e){t.resolveWith(this,[!1])}.bind(this)}catch(e){return void t.resolveWith(this,[!1])}}catch(e){0,t.resolveWith(this,[!1])}}.bind(this))},i.prototype.setItem=function(e,t){return $.Deferred(function(n){this._dataBase||n.resolveWith(this,[!1]);try{var i=this._dataBase.transaction([o],"readwrite");try{var r=i.objectStore(o).put(t,e);r.onsuccess=function(e){n.resolveWith(this,[!0])}.bind(this),r.onerror=function(e){n.resolveWith(this,[!1])}.bind(this)}catch(e){return void n.resolveWith(this,[!1])}}catch(e){0,n.resolveWith(this,[!1])}}.bind(this))},i.prototype.updateItem=function(e,t){return $.Deferred(function(n){this._dataBase||n.resolveWith(this,[!1]),this.getItem(e).done((i,o)=>{try{var r=o.put(t,e);r.onsuccess=function(e){n.resolveWith(this,[!0])}.bind(this),r.onerror=function(e){n.resolveWith(this,[!1])}.bind(this)}catch(e){return void n.resolveWith(this,[!1])}})}.bind(this))},i.prototype.pushArray=function(e,t){return $.Deferred(function(n){this._dataBase||n.resolveWith(this,[!1]);try{var i=this._dataBase.transaction([o],"readwrite");i.objectStore(o).count(e).onsuccess=function(r){if(console.log("number of fonts:"+e+" "+r.target.result),0===r.target.result){try{i.objectStore(o).put(t,e)}catch(e){return void n.resolveWith(this,[!1])}n.resolveWith(this,[!0])}else 1===r.target.result&&this.getItem(e).done(function(e,i){if(e){var o;e=e.concat(t);try{o=i.put(e)}catch(e){return void n.resolveWith(this,[!1])}o.onsuccess=function(e){n.resolveWith(this,[!0])},o.error=function(e){n.resolveWith(this,[!1])}}}.bind(this))}}catch(e){0,n.resolveWith(this,[!1])}}.bind(this))},i.prototype.getItem=function(e){var t=this;return $.Deferred((function(n){try{var i=this;t._dataBase||n.resolveWith(i,[null]);var r=t._dataBase.transaction([o],"readwrite").objectStore(o),a=r.get(e);a.onsuccess=function(e){var t=e.target.result;n.resolveWith(i,[t,r])},a.onerror=function(e){e.target.result;n.resolveWith(i,[null,r])}}catch(e){e.name="exception",n.resolveWith(this,[null,r])}}))},e.exports=i},function(e,t,n){"use strict";n(45),n(9),n(297),n(129),n(14),n(29);var i=n(1),o=n(341);const{parseNativeFonts:r,getLocalFontsData:a}=n(1085);function s(e){o.call(this,e)}i.GObject.inherit(s,o);var l=i.GUtil.uuid();s.VERSION=1,s.prototype._totalFonts=0,s.prototype._fontList=[],s.prototype._cachedParsedFonts={},s.prototype.addPreviews=function(e){if(e.length)for(var t=0;t<e.length;t++)e[t].cachedPreview||(e[t].addPreviewCallback=function(e){var t=document.createElement("div");t.innerHTML=this.displayname||this.family,t.style.fontFamily=this.family,t.style.fontStyle=this.style===i.GFont.Style.Italic?"italic":"normal",t.style.fontWeight=this.weight,t.style.fontSize="13px",t.style.height="20px",t.style.textOverflow="ellipsis",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.display="flex",t.style.alignItems="center",e(t)})},s.prototype.load=function(e,t,n,i){return this._createLocalFontList(e,t,n,i)},s.prototype.getTotalFonts=function(e){return e?this._fontList.filter(this._searchFilter(e)).length:this._totalFonts},s.prototype.resetProvider=function(){this._fontList=[]},s.prototype.resolveFont=function(e,t,n,o){n=parseInt(n)||400,t=t||i.GFont.Style.Normal;const r="".concat(e,"_").concat(t,"_").concat(n);return this._cachedParsedFonts[r]?o.done(this._cachedParsedFonts["".concat(e,"_").concat(t,"_").concat(n)].blob):this._fontList.length?this._processResolveFont(e,t,n,o):this._createLocalFontList("%",0,9999,{done:()=>{this._processResolveFont(e,t,n,o)},fail:o.fail})},s.prototype._processResolveFont=async function(e,t,n,i){const o=this._fontList.find((function(t){let{family:n}=t;return e===n}));if(!o)return i.fail();const a=o.isLocalFont?await r(o.fonts):o.fonts;if(!a||!Array.isArray(a)||!a.length)return i.fail();const s=a.find((function(e){return e.style===t&&e.weight===n}));if(s){const o="".concat(e,"_").concat(t,"_").concat(n);return this._cachedParsedFonts[o]=s,void setTimeout(()=>{i.done(s.blob)},10)}i.fail()},s.prototype._createLocalFontList=function(e,t,n,i){if(this._fontList&&this._fontList.length>0)return i.done(this._getFilteredFontsList.call(this,e,t,n),!0,null);this._createLocalFontListPromise?this._createLocalFontListCallbacks.push(i):(this._createLocalFontListCallbacks=[i],this._createLocalFontListPromise=new Promise(async e=>{let t=await a(),n=[];for(var i=0;i<t.length;i++){const e=t[i],o=n.findIndex(t=>{let{family:n}=t;return n===e.family});-1===o?n.push({family:e.family,fonts:[e],isLocalFont:!0}):n[o].fonts.push(e)}this._fontList=n.sort((e,t)=>{let{family:n}=e,{family:i}=t;return n-i}),e()}),this._createLocalFontListPromise.then(()=>{this._createLocalFontListCallbacks.map(i=>{let{done:o}=i;o(this._getFilteredFontsList.call(this,e,t,n),!0,null),this._createLocalFontListPromise=null,this._createLocalFontListCallbacks=null}),this._createLocalFontListCallbacks=[]}))},s.prototype._getFilteredFontsList=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9999;return this._fontList.filter(t=>e.indexOf("%")>=0?t.family.toLowerCase().startsWith(e.replace(/%/g,"")):t.family.toLowerCase()===e.toLowerCase()).slice(t,t+n)},s.prototype.getProviderId=function(){return l},e.exports=s},function(e,t,n){"use strict";n(262),n(1259),n(19),n(24),n(9),n(45),n(14),n(29);var i=n(1);function o(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return(o=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new o(e)}e.exports={generateFormattedList:function(e){if(!e)return null;const t=[];var n=e.slice();for(let e=0;e<n.length;e++){var i=n[e],o=i.displayname||i.family,r=[{weight:parseInt(i.weight),style:i.style,family:i.family,subfamily:i.subfamily||null,displayname:i.displayname||null}],a=[i.family];t.push({family:null,displayname:o,fonts:r,families:a});for(let t=n.length-1;t>e;t--)o===(n[t].displayname||n[t].family)&&(a.indexOf(n[t].family)<0&&a.push(n[t].family),r.push({weight:parseInt(n[t].weight),style:n[t].style,family:n[t].family,subfamily:n[t].subfamily||null,displayname:n[t].displayname||null}),n.splice(t,1));var s=0,l=a[0].length;if(l>0)for(let e=1;e<a.length;e++){if(a[e].toLowerCase().indexOf("regular")>=0){l=0,s=e;break}l>a[e].length&&(l=a[e].length,s=e)}t[t.length-1].family=a[s]}return t},parseNativeFonts:async function(e){if(!e||!Array.isArray(e)||!e.length)return[];const t=[];for(var n=0;n<e.length;n++){const l=e[n],c=await l.blob(),d=await c.arrayBuffer();if(d){var o=i.GOpenTypeUtil.getFont(null,null,null,d,!0,!0);if(o&&o.length)for(var r=0;r<o.length;r++){for(var a=o[r],s=2;t.find(e=>e.family===a.family&&e.weight===a.weight&&e.style===a.style);)a.subfamily&&a.family.indexOf(a.subfamily)<0?a.family=a.family+" "+a.subfamily:a.family=a.family.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]variant[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF][0-9]+$/,"")+" variant "+s++;t.push({weight:a.weight,style:a.style,family:a.family,blob:d,displayname:a.displayname,subfamily:a.subfamily})}}}return t},getLocalFontsData:async()=>{const e=[];try{var t,n=!1,i=!1;try{for(var r,a=function(e){var t,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new o(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(await navigator.fonts.query());n=!(r=await a.next()).done;n=!1){const t=r.value;e.push(t)}}catch(e){i=!0,t=e}finally{try{n&&null!=a.return&&await a.return()}finally{if(i)throw t}}}catch(e){console.error(">>>error getting local fonts data:",e)}return e}}},,,,,,,,,,function(e,t,n){(function(t){!function(n){e.exports=function(e){"use strict";function n(e,t){return"object"==typeof e&&null!==e&&(e.constructor===t||Object.prototype.toString.call(e)==="[object "+t.name+"]")}function i(e,t){return!t&&n(e,Array)?e:Array.prototype.slice.call(e)}function o(e,t){return void 0!==e?e:t}function r(e,i,a,s){if(r.is(e)){var l=e.slice(i,i+a);return l._littleEndian=o(s,l._littleEndian),l}if(!r.is(this))return new r(e,i,a,s);if(this.buffer=e=r.wrapBuffer(e),this._isArrayBuffer=d.ArrayBuffer&&n(e,ArrayBuffer),this._isPixelData=!1,this._isDataView=d.DataView&&this._isArrayBuffer,this._isNodeBuffer=d.NodeBuffer&&n(e,t),!this._isNodeBuffer&&!this._isArrayBuffer&&!n(e,Array))throw new TypeError("jDataView buffer has an incompatible type");this._littleEndian=!!s;var c="byteLength"in e?e.byteLength:e.length;this.byteOffset=i=o(i,0),this.byteLength=a=o(a,c-i),this._offset=this._bitOffset=0,this._isDataView?this._view=new DataView(e,i,a):this._checkBounds(i,a,c),this._engineAction=this._isDataView?this._dataViewAction:this._isNodeBuffer?this._nodeBufferAction:this._isArrayBuffer?this._arrayBufferAction:this._arrayAction}function a(e){if(d.NodeBuffer)return new t(e,"binary");for(var n=new(d.ArrayBuffer?Uint8Array:Array)(e.length),i=0,o=e.length;o>i;i++)n[i]=255&e.charCodeAt(i);return n}function s(e){return e>=0&&31>e?1<<e:s[e]||(s[e]=Math.pow(2,e))}function l(e,t){this.lo=e,this.hi=t}function c(){l.apply(this,arguments)}var d={NodeBuffer:"Buffer"in e,DataView:"DataView"in e,ArrayBuffer:"ArrayBuffer"in e,PixelData:!1},u=e.TextEncoder,p=e.TextDecoder;d.NodeBuffer&&function(e){try{e.writeFloatLE(1/0,0)}catch(e){d.NodeBuffer=!1}}(new t(4));var g={Int8:1,Int16:2,Int32:4,Uint8:1,Uint16:2,Uint32:4,Float32:4,Float64:8};r.wrapBuffer=function(e){switch(typeof e){case"number":if(d.NodeBuffer)(e=new t(e)).fill(0);else if(d.ArrayBuffer)e=new Uint8Array(e).buffer;else{e=new Array(e);for(var o=0;o<e.length;o++)e[o]=0}return e;case"string":e=a(e);default:return"length"in e&&!(d.NodeBuffer&&n(e,t)||d.ArrayBuffer&&n(e,ArrayBuffer))&&(d.NodeBuffer?e=new t(e):d.ArrayBuffer?n(e,ArrayBuffer)||(n(e=new Uint8Array(e).buffer,ArrayBuffer)||(e=new Uint8Array(i(e,!0)).buffer)):e=i(e)),e}},r.is=function(e){return e&&e.jDataView},r.from=function(){return new r(arguments)},r.Uint64=l,l.prototype={valueOf:function(){return this.lo+s(32)*this.hi},toString:function(){return Number.prototype.toString.apply(this.valueOf(),arguments)}},l.fromNumber=function(e){var t=Math.floor(e/s(32));return new l(e-t*s(32),t)},r.Int64=c,c.prototype="create"in Object?Object.create(l.prototype):new l,c.prototype.valueOf=function(){return this.hi<s(31)?l.prototype.valueOf.apply(this,arguments):-(s(32)-this.lo+s(32)*(s(32)-1-this.hi))},c.fromNumber=function(e){var t,n;if(e>=0){var i=l.fromNumber(e);t=i.lo,n=i.hi}else t=e-(n=Math.floor(e/s(32)))*s(32),n+=s(32);return new c(t,n)};var h=r.prototype={compatibility:d,jDataView:!0,_checkBounds:function(e,t,n){if("number"!=typeof e)throw new TypeError("Offset is not a number.");if("number"!=typeof t)throw new TypeError("Size is not a number.");if(0>t)throw new RangeError("Length is negative.");if(0>e||e+t>o(n,this.byteLength))throw new RangeError("Offsets are out of bounds.")},_action:function(e,t,n,i,r){return this._engineAction(e,t,o(n,this._offset),o(i,this._littleEndian),r)},_dataViewAction:function(e,t,n,i,o){return this._offset=n+g[e],t?this._view["get"+e](n,i):this._view["set"+e](n,o,i)},_arrayBufferAction:function(t,n,i,r,a){var s,l=g[t],c=e[t+"Array"];if(r=o(r,this._littleEndian),1===l||(this.byteOffset+i)%l==0&&r)return s=new c(this.buffer,this.byteOffset+i,1),this._offset=i+l,n?s[0]:s[0]=a;var d=new Uint8Array(n?this.getBytes(l,i,r,!0):l);return s=new c(d.buffer,0,1),n?s[0]:(s[0]=a,void this._setBytes(i,d,r))},_arrayAction:function(e,t,n,i,o){return t?this["_get"+e](n,i):this["_set"+e](n,o,i)},_getBytes:function(e,t,n){n=o(n,this._littleEndian),t=o(t,this._offset),e=o(e,this.byteLength-t),this._checkBounds(t,e),t+=this.byteOffset,this._offset=t-this.byteOffset+e;var r=this._isArrayBuffer?new Uint8Array(this.buffer,t,e):(this.buffer.slice||Array.prototype.slice).call(this.buffer,t,t+e);return n||1>=e?r:i(r).reverse()},getBytes:function(e,t,n,r){var a=this._getBytes(e,t,o(n,!0));return r?i(a):a},_setBytes:function(e,n,r){var a=n.length;if(0!==a){if(r=o(r,this._littleEndian),e=o(e,this._offset),this._checkBounds(e,a),!r&&a>1&&(n=i(n,!0).reverse()),e+=this.byteOffset,this._isArrayBuffer)new Uint8Array(this.buffer,e,a).set(n);else if(this._isNodeBuffer)new t(n).copy(this.buffer,e);else for(var s=0;a>s;s++)this.buffer[e+s]=n[s];this._offset=e-this.byteOffset+a}},setBytes:function(e,t,n){this._setBytes(e,t,o(n,!0))},getString:function(e,t,n){if(this._isNodeBuffer)return t=o(t,this._offset),e=o(e,this.byteLength-t),this._checkBounds(t,e),this._offset=t+e,this.buffer.toString(n||"binary",this.byteOffset+t,this.byteOffset+this._offset);var i=this._getBytes(e,t,!0);if(n="utf8"===n?"utf-8":n||"binary",p&&"binary"!==n)return new p(n).decode(this._isArrayBuffer?i:new Uint8Array(i));var r="";e=i.length;for(var a=0;e>a;a++)r+=String.fromCharCode(i[a]);return"utf-8"===n&&(r=decodeURIComponent(escape(r))),r},setString:function(e,t,n){if(this._isNodeBuffer)return e=o(e,this._offset),this._checkBounds(e,t.length),void(this._offset=e+this.buffer.write(t,this.byteOffset+e,n||"binary"));var i;n="utf8"===n?"utf-8":n||"binary",u&&"binary"!==n?i=new u(n).encode(t):("utf-8"===n&&(t=unescape(encodeURIComponent(t))),i=a(t)),this._setBytes(e,i,!0)},getChar:function(e){return this.getString(1,e)},setChar:function(e,t){this.setString(e,t)},tell:function(){return this._offset},seek:function(e){return this._checkBounds(e,0),this._offset=e},skip:function(e){return this.seek(this._offset+e)},slice:function(e,t,n){function i(e,t){return 0>e?e+t:e}return e=i(e,this.byteLength),t=i(o(t,this.byteLength),this.byteLength),n?new r(this.getBytes(t-e,e,!0,!0),void 0,void 0,this._littleEndian):new r(this.buffer,this.byteOffset+e,t-e,this._littleEndian)},alignBy:function(e){return this._bitOffset=0,1!==o(e,1)?this.skip(e-(this._offset%e||e)):this._offset},_getFloat64:function(e,t){var n=this._getBytes(8,e,t),i=1-2*(n[7]>>7),o=((n[7]<<1&255)<<3|n[6]>>4)-1023,r=(15&n[6])*s(48)+n[5]*s(40)+n[4]*s(32)+n[3]*s(24)+n[2]*s(16)+n[1]*s(8)+n[0];return 1024===o?0!==r?NaN:1/0*i:-1023===o?i*r*s(-1074):i*(1+r*s(-52))*s(o)},_getFloat32:function(e,t){var n=this._getBytes(4,e,t),i=1-2*(n[3]>>7),o=(n[3]<<1&255|n[2]>>7)-127,r=(127&n[2])<<16|n[1]<<8|n[0];return 128===o?0!==r?NaN:1/0*i:-127===o?i*r*s(-149):i*(1+r*s(-23))*s(o)},_get64:function(e,t,n){n=o(n,this._littleEndian),t=o(t,this._offset);for(var i=n?[0,4]:[4,0],r=0;2>r;r++)i[r]=this.getUint32(t+i[r],n);return this._offset=t+8,new e(i[0],i[1])},getInt64:function(e,t){return this._get64(c,e,t)},getUint64:function(e,t){return this._get64(l,e,t)},_getInt32:function(e,t){var n=this._getBytes(4,e,t);return n[3]<<24|n[2]<<16|n[1]<<8|n[0]},_getUint32:function(e,t){return this._getInt32(e,t)>>>0},_getInt16:function(e,t){return this._getUint16(e,t)<<16>>16},_getUint16:function(e,t){var n=this._getBytes(2,e,t);return n[1]<<8|n[0]},_getInt8:function(e){return this._getUint8(e)<<24>>24},_getUint8:function(e){return this._getBytes(1,e)[0]},_getBitRangeData:function(e,t){var n=(o(t,this._offset)<<3)+this._bitOffset,i=n+e,r=n>>>3,a=i+7>>>3,s=this._getBytes(a-r,r,!0),l=0;(this._bitOffset=7&i)&&(this._bitOffset-=8);for(var c=0,d=s.length;d>c;c++)l=l<<8|s[c];return{start:r,bytes:s,wideValue:l}},getSigned:function(e,t){var n=32-e;return this.getUnsigned(e,t)<<n>>n},getUnsigned:function(e,t){var n=this._getBitRangeData(e,t).wideValue>>>-this._bitOffset;return 32>e?n&~(-1<<e):n},_setBinaryFloat:function(e,t,n,i,o){var r,a,l=0>t?1:0,c=~(-1<<i-1),d=1-c;0>t&&(t=-t),0===t?(r=0,a=0):isNaN(t)?(r=2*c+1,a=1):1/0===t?(r=2*c+1,a=0):(r=Math.floor(Math.log(t)/Math.LN2))>=d&&c>=r?(a=Math.floor((t*s(-r)-1)*s(n)),r+=c):(a=Math.floor(t/s(d-n)),r=0);for(var u=[];n>=8;)u.push(a%256),a=Math.floor(a/256),n-=8;for(r=r<<n|a,i+=n;i>=8;)u.push(255&r),r>>>=8,i-=8;u.push(l<<i|r),this._setBytes(e,u,o)},_setFloat32:function(e,t,n){this._setBinaryFloat(e,t,23,8,n)},_setFloat64:function(e,t,n){this._setBinaryFloat(e,t,52,11,n)},_set64:function(e,t,n,i){"object"!=typeof n&&(n=e.fromNumber(n)),i=o(i,this._littleEndian),t=o(t,this._offset);var r=i?{lo:0,hi:4}:{lo:4,hi:0};for(var a in r)this.setUint32(t+r[a],n[a],i);this._offset=t+8},setInt64:function(e,t,n){this._set64(c,e,t,n)},setUint64:function(e,t,n){this._set64(l,e,t,n)},_setUint32:function(e,t,n){this._setBytes(e,[255&t,t>>>8&255,t>>>16&255,t>>>24],n)},_setUint16:function(e,t,n){this._setBytes(e,[255&t,t>>>8&255],n)},_setUint8:function(e,t){this._setBytes(e,[255&t])},setUnsigned:function(e,t,n){var i=this._getBitRangeData(n,e),o=i.wideValue,r=i.bytes;o&=~(~(-1<<n)<<-this._bitOffset),o|=(32>n?t&~(-1<<n):t)<<-this._bitOffset;for(var a=r.length-1;a>=0;a--)r[a]=255&o,o>>>=8;this._setBytes(i.start,r,!0)}},f={Int8:"Int8",Int16:"Int16",Int32:"Int32",Uint8:"UInt8",Uint16:"UInt16",Uint32:"UInt32",Float32:"Float",Float64:"Double"};for(var m in h._nodeBufferAction=function(e,t,n,i,o){this._offset=n+g[e];var r=f[e]+("Int8"===e||"Uint8"===e?"":i?"LE":"BE");return n+=this.byteOffset,t?this.buffer["read"+r](n):this.buffer["write"+r](o,n)},g)!function(e){h["get"+e]=function(t,n){return this._action(e,!0,t,n)},h["set"+e]=function(t,n,i){this._action(e,!1,t,i,n)}}(m);for(var y in h._setInt32=h._setUint32,h._setInt16=h._setUint16,h._setInt8=h._setUint8,h.setSigned=h.setUnsigned,h)"set"===y.slice(0,3)&&function(e){h["write"+e]=function(){Array.prototype.unshift.call(arguments,void 0),this["set"+e].apply(this,arguments)}}(y.slice(3));return r}(this)}()}).call(this,n(203).Buffer)},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(19),n(24);var i=n(1);n(1039);function o(e){let t=[...new Set(e.map(e=>e.features.map(t=>"• ".concat((e=>e instanceof i.GNode?e.getNodeNameTranslated():e instanceof i.GNoisePattern?i.GLocale.get(new i.GLocaleKey("GPatternChooser","pattern-type.noise")):e instanceof i.GTexturePattern?i.GLocale.get(new i.GLocaleKey("GPatternChooser","pattern-type.texture")):e instanceof i.GBackground?i.GLocale.get(new i.GLocaleKey("GPatternChooser","pattern-type.backgroundfill")):e instanceof i.GAngularGradient?i.GLocale.get(new i.GLocaleKey("GPatternChooser","pattern-type.angulargradient")):"")(t)," [").concat(e.name,"]")).join("<br>")))].join("<br>");this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,buttons:[$("<button>"+i.GLocale.get(new i.GLocaleKey("GLocale","ok"))+"</button>").on("click",()=>this.close())]}),$("<div/>").addClass("message").css({lineHeight:"1.5em",maxHeight:"60%",overflow:"auto"}).append($("<span/>").html(i.GLocale.get(new i.GLocaleKey("GUnsupportedFeaturesDialog","text.title-unsupported"))+"<br>"+t)).appendTo(this._dialog),$("<div></div>").css("margin-top","10px").append($("<label></label>").append($("<input>").attr("type","checkbox").css("margin-right","5px").on("change",e=>{let t=$(e.target).is(":checked");gDesigner.setSetting("disable_warning_unsupported_features",t)})).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GUnsupportedFeaturesDialog","text.checked-unsupported"))))).appendTo(this._dialog)}i.GObject.inherit(o,i.GObject),o.prototype.open=function(){this._dialog.gDialog("open")},o.prototype.close=function(){this._dialog.gDialog("close")},e.exports=o},function(e,t,n){"use strict";n(750);var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GSharePointClient=void 0,n(14),n(29),n(321),n(3),n(45),n(58),n(115),n(84),n(129),n(261),n(9),n(19),n(24),n(111),n(90),n(25),n(83);var o=n(1),r=i(n(1354)),a=n(715),s=i(n(106)),l=n(12),c=n(534),d=i(n(535)),u=i(n(1355)),p=i(n(1127)),g=n(32);const h=n(151);let f=null,m={};const y=function e(t){let{tenant:n,domain:i,clientID:o,id:r,authTenant:a,corporate:s,token:l,relativePath:c}=t;this.TOKEN=f||l,this.BASE_URL=n,this.AUTH_TENANT=a||n,this.DOMAIN=i,this.CLIENT_ID=o,this.SETTINGS_ID=r,this.CORPORATE=s||!1,this.RELATIVE_PATH=c,this.HEADERS=e.requestHeaders};t.GSharePointClient=y,y.prototype.setTenantURL=function(e){this.BASE_URL=e.replace("https://","")},y.prototype.setRelativePath=function(e){this.RELATIVE_PATH=e},y.prototype.relativeUrlContainsSubsiteRelativePath=function(e){return 0===e.indexOf(this.RELATIVE_PATH)},y.prototype.getSanitizedFolderRelativePath=function(e){let t=e;return this.RELATIVE_PATH&&(t=(0,g.trimStart)(t,this.RELATIVE_PATH)),(0,g.trimStart)(t,"/")},y.prototype.getSanitizedFileRelativePath=function(e){return this.RELATIVE_PATH?"".concat(this.RELATIVE_PATH,"/").concat(e):e},y.prototype.setToken=function(e){this.TOKEN=e},y.CheckOutStatuses={CheckedOut:0,Available:2},y.FILE_STATUS={LOCKED:3,LOCKED_BY_ME:2,AVAILABLE:1,LOADING:-1},y.requestHeaders={Accept:"application/json;odata=nometadata","Accept-Encoding":"gzip, deflate","Accept-Language":"en-US,en;q=0.8"},y.CheckinType={MinorCheckIn:0,MajorCheckIn:1,OverwriteCheckIn:2},y.SpecialCharList=["~",'"',"'","#","%","&","*",":","<",">","?","/","\\","{","|","}"],y.InvalidNames=[".lock","CON","PRN","AUX","COM0","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT0","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9","desktop.ini"],y.InvalidNameBeginnings=["~$"],y.InvalidNameEndings=["."],y.InvalidContainings=["_vti_"],y.InvalidOnlyCharacters=["."],y.convertFileToCloudItem=function(e){const t=e=>{var t=h.from({id:e.UniqueId,version:e.UIVersionLabel,updated:e.TimeLastModified,created:e.TimeCreated,checkedOut:e.CheckOutType===y.CheckOutStatuses.CheckedOut,relativeUrl:e.ServerRelativeUrl});t.storage=h.Storage.SharePoint,t.setItemType(h.Type.File),t.type=y.getFileType({name:e.Name});const n=l.FILE_FORMATS.find(e=>{let{type:n}=e;return n===t.type});return t.extension=n&&n.ext,t.name=e.Name.replace(new RegExp(".(".concat(t.extension,")$"),"i"),""),t.setModificationTime(t.updated),e.Length&&t.setSize(parseInt(e.Length)),t.checkedOut?t.checkOutStatus=y.FILE_STATUS.LOADING:(t.checkOutStatus=y.FILE_STATUS.AVAILABLE,t=y.updateFilePermissions(t)),t};return e instanceof Array?e.map(t):t(e)},y.updateFilePermissions=function(e){return e instanceof h&&e.getType()===h.Type.File?([y.FILE_STATUS.AVAILABLE,y.FILE_STATUS.LOCKED_BY_ME].includes(e.checkOutStatus)?e.setPermissions([h.Permission.Open,h.Permission.Delete,h.Permission.Download,h.Permission.Copy,h.Permission.CutPaste]):e.revokePermissions(),e):e},y.hasSpecialChar=function(e){return new RegExp("[".concat(y.SpecialCharList.join("|"),"]")).test(e)},y.isNameValid=function(e){if(!e||!e.trim())return!1;if(y.hasSpecialChar(e))return!1;if(y.InvalidNames.indexOf(e)>=0)return!1;for(let t=0,n=y.InvalidNameBeginnings.length;t<n;t++){let n=y.InvalidNameBeginnings[t];if(e.startsWith(n))return!1}for(let t=0,n=y.InvalidNameEndings.length;t<n;t++){let n=y.InvalidNameEndings[t];if(e.endsWith(n))return!1}for(let t=0,n=y.InvalidContainings.length;t<n;t++){let n=y.InvalidContainings[t];if(e.indexOf(n)>=0)return!1}for(let t=0,n=y.InvalidOnlyCharacters.length;t<n;t++){const n=y.InvalidOnlyCharacters[t];if(RegExp("^[".concat(n,"]+$")).test(e))return!1}return!0},y.convertFolderToCloudItem=function(e){const t=e=>{var t=h.from({id:e.UniqueId?e.UniqueId:e.id,name:e.Name?e.Name:e.name,relativeUrl:e.ServerRelativeUrl?e.ServerRelativeUrl:e.relativeUrl,type:"folder"});return t.setItemType(h.Type.Folder),t.setPermission(h.Permission.Open),t.setPermission(h.Permission.Delete),t.setPermission(h.Permission.CutPaste),t};return e instanceof Array?e.map(t):t(e)},y.getFileType=function(e){return e.name.toLowerCase().endsWith(".cdrapp")?l.FILE_FORMATS.find(e=>{let{ext:t}=e;return"cdrapp"===t}).type:e.name.toLowerCase().endsWith(".cdr")?l.FILE_FORMATS.find(e=>{let{ext:t}=e;return"cdr"===t}).type:e.name.toLowerCase().endsWith(".des")?l.FILE_FORMATS.find(e=>{let{ext:t}=e;return"des"===t}).type:void 0},y.ACCESS_TOKEN_PROP_NAME="designer.filespanel.cloud-account.sharepoint.token",y.getInstance=function(e){return e.id||(e.id="".concat(e.accountId,".").concat(e.tenant)),m[e.id]&&m[e.id].TOKEN||(m[e.id]=new y(e)),y.clearOldAccessTokens(),m[e.id]},y.deleteToken=function(e){gContainer.removeProperty("".concat(y.ACCESS_TOKEN_PROP_NAME,".").concat(e))},y.getUserId=function(){return gDesigner.getSyncUser().id},y.getUserEmail=function(){return gDesigner.getSyncUser().email},y.clearOldAccessTokens=function(){const e=[],t=gContainer.getStorageLength();for(let n=0;n<t;n++){let t=gContainer.getPropertyKeyByIndex(n);0===t.indexOf("".concat(y.ACCESS_TOKEN_PROP_NAME,"."))&&e.push(t)}const n=y.getUserId();for(let t=0;t<e.length;t++){i(e[t])}function i(e){gContainer.getProperty(e).then(t=>{y.isTokenValid(t,n)||gContainer.removeProperty(e)})}},y.isTokenValid=function(e,t){const n=gContainer.getSharepointAuthenticator();return n?n.isTokenValid(e):!(!e||!e.expires||e.expires<=Date.now()/1e3)&&!(!e.id||e.id!==t)},y.getCachedToken=function(e){return gContainer.getProperty("".concat(y.ACCESS_TOKEN_PROP_NAME,".").concat(e))},y.getValidCachedTokenOrNull=async function(e){const t=await y.getCachedToken(e);return y.isTokenValid(t,y.getUserId())?t:null},y.saveTokenToCache=async function(e,t){gContainer.setProperty("".concat(y.ACCESS_TOKEN_PROP_NAME,".").concat(e),t)},y.ExceptionCode={LoginAborted:1,FileAlreadyCheckedOut:423};class v extends d.default{constructor(e,t){super(e),this.code=t,this.__proto__=v.prototype,this.name="SharepointException"}toString(){return"[Object SharepointException]"}}y.SharepointException=v,y._logoutAndClearAdalCache=function(e){var t=new r.default(e);t.clearCache(),t.getCachedUser()&&t.logOut(),t._user=null;var n=[];for(let e=0;e<localStorage.length;e++)"adal."===localStorage.key(e).substring(0,5)&&n.push(localStorage.key(e));for(let e=0;e<n.length;e++)localStorage.removeItem(n[e])},y.prototype.getSettings=function(){return{tenant:this.BASE_URL,domain:this.DOMAIN,clientID:this.CLIENT_ID,accountId:this.SETTINGS_ID,authTenant:this.AUTH_TENANT,corporate:this.CORPORATE,token:this.TOKEN,relativePath:this.RELATIVE_PATH,type:l.EXTERNAL_APP.SHAREPOINT}},y.prototype.getId=function(){return this.SETTINGS_ID},y.prototype.getFile=function(e){return this.getRawFile(e).then((function(e){return s.default.createUint8ArrayFromBlob(e)}))},y.prototype.queryFiles=function(e){return this.get(this._createQueryFilesURL(e))},y.prototype.fetchFolders=function(e,t,n){const i=this.getSanitizedFolderRelativePath(e.relativeUrl);var o="/_api/web/GetFolderByServerRelativeUrl('".concat(encodeURI(i),"')/Folders?$orderby=").concat(encodeURI(t));return n>0&&(o+="&$top=".concat(n)),this.get(o).then(t=>{let{value:n}=t;const i=[];if(!n||!n.length)return i;for(let t=0,o=n.length;t<o;t++){let o=n[t];if(!o.Exists)continue;const r=y.convertFolderToCloudItem(o);r.parent=e,i.push(r)}return i})},y.prototype.queryFilesByOwner=function(e,t){const n=function(e){return e.searchParams.append("$select","*"),e.searchParams.append("$expand","Author"),e.searchParams.append("$filter","Author/Id eq ".concat(t)),e}(this._createQueryFilesURL(e));return this.get(n)},y.prototype._createQueryFilesURL=function(e){const{folderRelativeUrl:t,orderBy:n,limit:i,skip:o}=e,r=this.getSanitizedFolderRelativePath(t),a=this.getAPIEndpointURL("/_api/web/GetFolderByServerRelativeUrl('".concat(r,"')/Files"));return a.searchParams.append("$orderby",n),a.searchParams.append("$top",i),a.searchParams.append("$skip",o),a},y.prototype.findFileById=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.get("/_api/search/query?querytext='"+e+"'&selectproperties='Title,Filename,ParentLink,DefaultEncodingURL'",{headers:t}).then(e=>{if(e){const{PrimaryQueryResult:{RelevantResults:{Table:{Rows:[t]}}}}=e,n=t.Cells.find(e=>{let{Key:t}=e;return"Filename"===t}).Value;return{name:t.Cells.find(e=>{let{Key:t}=e;return"Title"===t}).Value,type:y.getFileType({name:n}),relativeUrl:t.Cells.find(e=>{let{Key:t}=e;return"DefaultEncodingURL"===t}).Value.replace("https://".concat(this.BASE_URL),"")}}return null})},y.prototype.getAdditionalItemData=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n="/_api/web/GetFileByServerRelativeUrl('".concat(encodeURI("".concat(e.relativeUrl)),"')/ListItemAllFields?expand=Properties");return this.get(n,{headers:t})},y.prototype.checkOutFile=async function(e){const t="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/CheckOut()");return this.post(t).catch(e=>{if(e.status===y.ExceptionCode.FileAlreadyCheckedOut)throw new y.SharepointException(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewSharepoint","text.error-file-is-already-checked-out-by-someone-else")),y.ExceptionCode.FileAlreadyCheckedOut);throw e})},y.prototype.discardCheckOut=function(e){var t="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/UndoCheckOut()");return this.post(t)},y.prototype.checkInFile=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"New Comment",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.CheckinType.MinorCheckIn;const i="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/CheckIn(comment='").concat(t,"', checkintype=").concat(n,")");return this.post(i)},y.prototype.getCheckOutFileInfo=function(e){const t="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/checkedOutByUser");return this.get(t)},y.prototype.getCheckOutFileStatus=async function(e){if(e.hasOwnProperty("checkedOut")&&!e.checkedOut)return y.FILE_STATUS.AVAILABLE;const t=await this.getCheckOutFileInfo(e).catch(e=>(console.error(">>>error retrieving checkout info: ",e.message),null));if(!t||!0===t["odata.null"])return y.FILE_STATUS.AVAILABLE;const n=await this._getUser();return t.UserId.NameId===n.getNameId()?y.FILE_STATUS.LOCKED_BY_ME:y.FILE_STATUS.LOCKED},y.prototype._getUser=async function(){return this._user||(this._user=new u.default(await this.getUser())),this._user},y.prototype.getFileCreator=async function(e){return new u.default(await this._getFileCreator(e))},y.prototype.getLibrarySettings=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.get("/_api/web/lists/getByTitle('Documents')",{headers:e}).then(e=>({enableVersioning:e.EnableVersioning,enableMinorVersions:e.EnableMinorVersions,enableFolderCreation:e.EnableFolderCreation,forceCheckout:e.ForceCheckout}))},y.prototype.getFileDetails=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return await this._getFileDetailsByRelativeURL(e,t)}catch(n){if(e.id){const n=await this.findFileById(e.id);return this._getFileDetailsByRelativeURL(n,t)}throw n}},y.prototype._getFileDetailsByRelativeURL=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n="/_api/web/GetFileByServerRelativeUrl('".concat(encodeURI("".concat(e.relativeUrl)),"')");return this.get(n,{headers:t})},y.prototype.getFolderDetails=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getSanitizedFolderRelativePath(e.relativeUrl),i="/_api/web/GetFolderByServerRelativeUrl('".concat(encodeURI(n),"')");return this.get(i,{headers:t})},y.prototype.getParentFolder=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getSanitizedFolderRelativePath(e.relativeUrl),i="/_api/Web/GetFolderByServerRelativePath(decodedurl='".concat(encodeURI(n),"')/ParentFolder");return this.get(i,{headers:t})},y.prototype.copyFileTo=function(e,t){var n="/_api/web/GetFileByServerRelativeUrl('".concat(encodeURI(e.relativeUrl),"')/copyto(strnewurl='").concat(encodeURI(t.relativeUrl),"/").concat(e.name,".").concat(e.extension,"',boverwrite=false)");return this.post(n,null,{rawResponse:!0})},y.prototype.moveFileTo=function(e,t){var n="/_api/web/GetFileByServerRelativeUrl('".concat(encodeURI(e.relativeUrl),"')/moveto(newurl='").concat(encodeURI(t.relativeUrl),"/").concat(e.name,".").concat(e.extension,"',flags=0)");return this.post(n,null,{rawResponse:!0})},y.prototype.moveFolderTo=function(e,t){var n="/_api/web/GetFolderByServerRelativeUrl('".concat(encodeURI(e.relativeUrl),"')/moveto(newurl='").concat(encodeURI(t.relativeUrl),"/").concat(e.name,"')");return this.post(n,null,{rawResponse:!0})},y.prototype.folderExists=function(e,t){const n=this.getSanitizedFolderRelativePath(t.relativeUrl);return this.get("/_api/Web/GetFolderByServerRelativePath(decodedurl='".concat(encodeURI("".concat(n)+"".concat(e?"/".concat(e):"")),"')/Exists/$value")).catch(e=>(!e.status||404!==e.status)&&Promise.reject(e))},y.prototype.fileExists=function(e,t){return this.get("/_api/web/GetFileByServerRelativeUrl('".concat(encodeURI("".concat(t.relativeUrl,"/").concat(e)),"')/Exists/$value")).catch(e=>(!e.status||404!==e.status)&&Promise.reject(e))},y.prototype.getRawFile=function(e,t){var n="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/$value");return this.get(n,{rawResponse:!0,progress:t}).then(e=>e.blob())},y.prototype.getUser=function(){return this.get("/_api/Web/CurrentUser")},y.prototype._getFileCreator=function(e){var t="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/Author");return this.get(t)},y.prototype.get=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._query("GET",e,null,t)},y.prototype.post=function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n=i&&i.blobRequest?new Blob([t]):t,this._query("POST",e,n,i)},y.prototype._query=function(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return n=o&&o.fullLink||t instanceof URL?t instanceof URL?t.toString():t:this.getAPIEndpointURL(t).toString(),this.query(e,n,i,o)},y.prototype.getAPIEndpointURL=function(e){return new URL("https://".concat(this.BASE_URL).concat(e))},y.prototype.hasPermissionToAccessFolder=async function(e){try{return!!await this.getFolderDetails(e)}catch(e){return(!e||e.status!==l.HTTP_STATUS_CODES.FORBIDDEN&&e.status!==l.HTTP_STATUS_CODES.NOT_FOUND)&&(console.error("GSharePointClient - failed to check folder permissions",e),!1)}},y.prototype.getEffectiveBasePermissions=function(e){return this.query("GET","".concat(e,"/_api/Web/effectiveBasePermissions"))},y.prototype.getFileEffectiveBasePermissions=function(e){var t="/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/ListItemAllFields/effectiveBasePermissions");return this.get(t)},y.prototype.query=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this;return new Promise((e,t)=>o.TOKEN&&y.isTokenValid(o.TOKEN,y.getUserId())?r(e,t):o.connect().then(()=>{r(e,t)}).catch(e=>{t(e)}));async function r(a,s){const l={method:e,cache:"no-cache",headers:o._prepareRequestHeaders(e,n,i),body:o._prepareRequestBody(e,n,i)};let d;try{d=await fetch(t,l)}catch(e){return void s(e)}if(401===d.status)o.clearUserData(),o.connect(!0).then(()=>{r(a,s)}).catch(e=>{s(e)});else if(200===d.status||201===d.status||202===d.status||204===d.status){if(i&&i.progress&&"function"==typeof i.progress)return(0,c.readResponseWithProgress)(d,i.progress,!1).then(e=>a(e));if(i&&i.rawResponse)return a(d);let e={};if(204!==d.status)try{e=await d.json()}catch(e){console.error("Incorrect response format: ",e.message),s(e)}a(e)}else s({status:d.status,statusText:d.statusText})}},y.prototype._prepareRequestHeaders=function(e,t,n){if(n&&n.noHeaders)return;const i=Object.assign({},this.HEADERS,{Authorization:"Bearer ".concat(this.TOKEN.token)});this._isBodyRequestRequired(e,t)&&(i["Content-Type"]=n&&n.headers&&n.headers["Content-Type"]||"application/json;odata=verbose",i["Content-Length"]=JSON.stringify(t).length);return Object.assign(i,n&&n.headers||{})},y.prototype._prepareRequestBody=function(e,t,n){let i;return this._isBodyRequestRequired(e,t)&&(i=n&&n.blobRequest?t:JSON.stringify(t)),i},y.prototype._isBodyRequestRequired=function(e,t){return!(!t||!["POST","PUT","PATCH"].includes(e))},y.prototype._getSharePointSettings=function(){return{tenant:this.AUTH_TENANT,clientId:this.CLIENT_ID,domain:this.DOMAIN,loginHint:y.getUserEmail()}},y.prototype.clearUserData=function(){this.TOKEN=null,this._toClear=!0,y._logoutAndClearAdalCache(this._getSharePointSettings())},y.prototype._connectWithMsTeams=function(){const e=p.default.getInstance(),t=this;let n;return"[Object GOneDriveBusinessClient]"===t.toString()?n=e.getOrFetchOneDriveBusinessToken().then(e=>{let{accessToken:n,expires:i}=e;return t.TOKEN={token:n,expires:Number(i)},t.TOKEN}):t instanceof y&&(n=e.getOrFetchSharePointToken().then(e=>{let{accessToken:n,expires:i}=e;return t.TOKEN={token:n,expires:Number(i)},t.TOKEN})),n},y.prototype._getCachedToken=function(e){return e||(e=e=>y.isTokenValid(e,y.getUserId())),gContainer.getProperty(this._getTokenPropertyName()).then(t=>{if(t&&e(t))return t})},y.prototype._setCachedToken=function(e){this.setToken(e),gContainer.setProperty(this._getTokenPropertyName(),e)},y.prototype._getTokenPropertyName=function(){return"".concat(y.ACCESS_TOKEN_PROP_NAME,".").concat(this.SETTINGS_ID)},y.prototype.connect=async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this,i=this._getSharePointSettings(),r=6e4,s=3e3;let c,d=!1;const u=await y.getValidCachedTokenOrNull(n.SETTINGS_ID);if(n._connect)return n._connect;const p=gContainer.getSharepointAuthenticator();return p?!e&&u?void(n.TOKEN=u):(n._connect=p.authenticate(i,{clearCache:e}).then(e=>(n.TOKEN=f={id:y.getUserId()},e.expires&&e.token?(n.TOKEN.expires=f.expires=e.expires,n.TOKEN.token=f.token=e.token):"string"==typeof e&&(n.TOKEN.expires=f.expires=Math.floor(Date.now()/1e3)+3600,n.TOKEN.token=f.token=e),y.saveTokenToCache(n.SETTINGS_ID,n.TOKEN),delete n._connect,n.TOKEN)),n._connect):(l.msTeamsMode&&(n._connect=n._connectWithMsTeams(),n._connect)||(n._connect=new Promise((s,l)=>{!function t(u){gContainer.getProperty("".concat(y.ACCESS_TOKEN_PROP_NAME,".").concat(n.SETTINGS_ID)).then(p=>{if(p&&!e&&y.isTokenValid(p,y.getUserId()))return n.TOKEN=p,s(),void(n._connect=null);$(window).on("message",b);var m=new URL("".concat(window.location.origin,"/sp.html"));const v=n._popupToCenter(m.href,"SharePointToken",680,460);if(!v||v.closed||void 0===v.closed)return $(window).off("message",b),void l({status:a.WINDOW_STATUS_BLOCKED,message:o.GLocale.get(new o.GLocaleKey("GExternalStorage","text.error-window-blocked-alternative"))});v.onload=function(){n._toClear&&(v.postMessage({cmd:"clearCachedUser",sharepointSettings:i},"".concat(window.location.protocol,"//").concat(window.location.host,"/sp.html")),delete n._toClear),v.postMessage({cmd:"sharepointSettings",sharepointSettings:i},"".concat(window.location.protocol,"//").concat(window.location.host,"/sp.html"))},v.onclose=function(){_&&(clearInterval(_),_=null)};var _=setInterval((function(){v.closed&&!d&&(clearInterval(_),_=null,gContainer.removeProperty("sp_getToken_data"),y._logoutAndClearAdalCache(i),c&&clearTimeout(c),l(new y.SharepointException(null,y.ExceptionCode.LoginAborted)))}),1e3);async function b(e){let o=e.originalEvent.data;const{cmd:a}=o;if(a&&"saveToken"===a)n.TOKEN=f={expires:Math.floor(Date.now()/1e3)+3600,token:o.token,id:y.getUserId()},y.saveTokenToCache(n.SETTINGS_ID,n.TOKEN),d=!0,g(v),c&&clearTimeout(c),$(window).off("message",b),n._connect=null,s();else if(a&&"saveTokenError"===a){const{error:e}=o;if("User login is required"===e)return;if(console.error(">>saveTokenError data",o),c&&clearTimeout(c),u)return void(c=setTimeout((function(){h(v),y._logoutAndClearAdalCache(i),t(!1)}),r));y._logoutAndClearAdalCache(i),h(v),n._connect=null,l(e)}}u&&(c=setTimeout((function(){g(v),y._logoutAndClearAdalCache(i),t(!1)}),r))})}(t)})),n._connect);function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;setTimeout(()=>{e.close()},t)}function h(e){g(e,s)}},y.prototype.updateFileContent=function(e,t){return this._putBlob("/_api/web/GetFileByServerRelativeUrl('".concat(e.relativeUrl,"')/$value"),t)},y.prototype.updateItem=function(e,t){const n=this.getSanitizedFolderRelativePath(e.relativeUrl);return this.post("/_api/web/GetFolderByServerRelativeUrl('".concat(n,"')/ListItemAllFields"),t,{headers:{"X-HTTP-Method":"MERGE"}})},y.prototype.deleteItem=function(e){const t=this.getSanitizedFolderRelativePath(e.relativeUrl);return this.post("/_api/web/GetFolderByServerRelativeUrl('".concat(t,"')"),null,{headers:{"X-HTTP-Method":"DELETE"},rawResponse:!0}).then(e=>{if(200!==e.status&&204!==e.status)throw new Error(e.statusText)})},y.prototype._popupToCenter=function(e,t,n,i){const o=this._getPopupWindowReference(),r=o.outerHeight/2+o.screenY-n/2,a=o.outerWidth/2+o.screenX-i/2;return window.open(e,t,"left=".concat(a,",top=").concat(r,",width=").concat(i,",height=").concat(n,",menubar=no,toolbar=no,location=no,resizable=no,scrollbars=no"))},y.prototype._getPopupWindowReference=function(){try{window.top.outerHeight;return window.top}catch(e){return window}},y.prototype.updateFileContentById=function(e,t){return this._putBlob("/_api/web/GetFileById('".concat(e,"')/$value"),t)},y.prototype._putBlob=function(e,t){return this.post(e,t,{headers:{"X-HTTP-Method":"PUT"},blobRequest:!0,rawResponse:!0})},y.prototype.createFile=function(e,t){const n=e.parentUrl||e.parent.relativeUrl,i=this.getSanitizedFolderRelativePath(n);var o="/_api/web/GetFolderByServerRelativeUrl('".concat(i,"')/Files/add(url='").concat(e.getNameWithExtension(),"',overwrite=true)");return this.post(o,t,{blobRequest:!0,rawResponse:!0})},y.prototype.getAccountByEmail=function(e){if(!e||e.indexOf("@")<=0)return Promise.reject(o.GLocale.get(new o.GLocaleKey("GShareDialog","text.invalid-email")).replace("%email",e));var t="/_api/web/EnsureUser('".concat(e,"')");return this.post(t)},y.prototype.isCorporate=function(){return this.CORPORATE},y.prototype.getCorporateProviderName=function(){return"microsoft"},y.prototype.toString=function(){return"[Object GSharePointClient]"};var _=y;t.default=_},function(e,t,n){"use strict";n(25);const{FILE_FORMATS:i}=n(12);class o{constructor(){this.onlyListFilesOwnedByUser=!1,this.supportedFileFormats=i}static from(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(new o,e)}}o.prototype.onlyListFilesOwnedByUser=null,o.prototype.supportedFileFormats=null,o.prototype.supportedFileFilters=null,e.exports=o},function(e,t,n){"use strict";function i(e){if(!i.Type[e])throw new Error("Incorrect Clour Role type");this._type=e}Object.defineProperty(t,"__esModule",{value:!0}),t.GCloudRole=i,t.default=void 0,n(3),i.Type={Viewer:"Viewer",Coauthor:"Coauthor",Creator:"Creator",Reviewer:"Reviewer",Approver:"Approver",ContentEditor:"ContentEditor"},i.prototype._type=null,i.prototype.setRole=function(e){if(!i.Type[e])throw new Error("Incorrect Clour Role type");return this._type=e,this},i.prototype.getRole=function(){return this._type},i.prototype.toString=function(){return"[Object GCloudRole]"};var o=i;t.default=o},function(e,t,n){"use strict";var i=n(17);n(9),n(25),n(83);var o=n(1),r=n(1357),a=i(n(36)),s=i(n(396)),l=i(n(175)),c=n(1128),d=n(32);const{getAuthenticator:u,getTeamsContext:p}=s.default;function g(){}g.Error={NOT_REGISTERED:1,ONEDRIVE_BUSINESS_ERROR:2,SHAREPOINT_ERROR:3,SHAREPOINT_ONEDRIVE_BUSINESS_ERROR:4,OFFLINE:5,FAILED_TO_OPEN_WINDOW:6,CANCELLED_BY_USER:7},g.FAIL_REASONS={POPUP_WINDOW_BLOCKED:"FailedToOpenWindow",CANCELLED_BY_USER:"CancelledByUser"},g._instance=null,g.CACHED_TOKENS_PROPERTY_NAME="msteams.authentication.tokens",g.getInstance=()=>(g._instance||(g._instance=new g),g._instance),g.isTokenValid=function(e){return!(!e||!e.expires||e.expires<=Date.now()/1e3)},g.prototype._loaded=!1,g.prototype._loading=!1,g.prototype._authenticated=!1,g.prototype._tokens=null,g.prototype.authenticate=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[c.MS_TEAMS_COMMAND];if(this._authenticated)return!0;const t=this;return new Promise(async(n,i)=>(await t._authenticateCommand(e),t._authWithCorelCloud(await t.getOrFetchMSTeamsAccessToken()).then(e=>{e?(t._authenticated=!0,n(!0)):i()}).catch(()=>{i()})))},g.prototype.isAuthenticated=function(){const e=this._tokens&&this._tokens[c.MS_TEAMS_COMMAND]||null;return!(!e||!g.isTokenValid(e))||(this._authenticated=!1,!1)},g.prototype._authenticateCommand=async function(e){const t=this,n=await this._getValidCachedTokens(),i={};let o=[];if(!n||!Object.values(n).length)return this._processAuthenticationCommands(e);for(let t=0,r=e.length;t<r;t++)n[e[t]]?i[e[t]]=n[e[t]]:o.push(e[t]);return 0===o.length?(await t.setTokens(i,!1),i):this._processAuthenticationCommands(e,i)},g.prototype._processAuthenticationCommands=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this;return new Promise((i,r)=>{u().then(a=>a.authenticate({url:"".concat(window.location.origin,"/msteams-sp.html#").concat(c.COMMAND_QUERY_PARAM,"=").concat(e.join(",")),width:600,height:535,successCallback:async function(e){const o={};for(let t in e){const{expires:n,accessToken:i}=e[t];o[t]={accessToken:i,expires:Number(n)}}await n.setTokens(Object.assign(t,o)),i(o)},failureCallback:function(t){t===g.FAIL_REASONS.POPUP_WINDOW_BLOCKED?n._handleError(g.Error.FAILED_TO_OPEN_WINDOW,o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.authenticate")),t=>{console.log("target",t.target),n._processAuthenticationCommands(e).then(e=>{i(e)}).catch(e=>{console.error(">>>reautherror",e),r(e)})}):t===g.FAIL_REASONS.CANCELLED_BY_USER?(n._handleError(g.Error.CANCELLED_BY_USER,o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.try-again")),()=>window.location.reload()),r()):(n._handleError({message:t}),r())}})).catch(e=>{r(e)})})},g.prototype._getValidCachedTokens=async function(){const e=this._getCachedTokens();if(!e)return null;const t=await p(),n={};if(e.userId!==t.loginHint)return n;const i=Object.keys(e);for(let t=0,o=i.length;t<o;t++){const o=e[i[t]];g.isTokenValid(o)&&(n[i[t]]=o)}return n},g.prototype._getCachedTokens=function(){const e=window.localStorage.getItem(g.CACHED_TOKENS_PROPERTY_NAME);if(!e)return null;let t=null;try{t=JSON.parse((0,d.base64StringToString)(e))}catch(e){console.error("Cant decode cache tokens")}return t},g.prototype.setTokens=async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=(await p()).loginHint,i=await this._getValidCachedTokens();this._tokens=Object.assign({userId:n},i,e),t&&localStorage.setItem(g.CACHED_TOKENS_PROPERTY_NAME,(0,d.stringToBase64String)(JSON.stringify(this._tokens)))},g.prototype.getOrFetchMSTeamsAccessToken=async function(){const e=this._tokens&&this._tokens[c.MS_TEAMS_COMMAND]||null;return e&&g.isTokenValid(e)||(this._authenticated=!1,await this.authenticate()),this._tokens&&this._tokens[c.MS_TEAMS_COMMAND]&&this._tokens[c.MS_TEAMS_COMMAND].accessToken||null},g.prototype.getOrFetchOneDriveBusinessToken=async function(){const e=this._tokens&&this._tokens[c.ONE_DRIVE_BUSINESS_COMMAND]||null;return e&&g.isTokenValid(e)||await this._authenticateCommand([c.ONE_DRIVE_BUSINESS_COMMAND]),this._tokens&&this._tokens[c.ONE_DRIVE_BUSINESS_COMMAND]||null},g.prototype.getOrFetchSharePointToken=async function(){const e=this._tokens&&this._tokens[c.SHAREPOINT_COMMAND]||null;return e&&g.isTokenValid(e)||await this._authenticateCommand([c.SHAREPOINT_COMMAND]),this._tokens&&this._tokens[c.SHAREPOINT_COMMAND]||null},g.prototype._handleError=function(e,t,n){let i=null;switch(e){case g.Error.OFFLINE:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.offline"));break;case g.Error.ONEDRIVE_BUSINESS_ERROR:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.onedrive-business-error"));break;case g.Error.SHAREPOINT_ERROR:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.sharepoint-error"));break;case g.Error.SHAREPOINT_ONEDRIVE_BUSINESS_ERROR:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.sharepoint-onedrive-business-error"));break;case g.Error.NOT_REGISTERED:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.not_registered"));break;case g.Error.FAILED_TO_OPEN_WINDOW:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.failed-to-open-window"));break;case g.Error.CANCELLED_BY_USER:i=o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.cancelled-by-user"));break;default:i=e&&e.message?e.message:o.GLocale.get(new o.GLocaleKey("GMSTeamsAuthenticator","text.unknown"))}a.default.splashScreenError(i,t,n)},g.prototype._validateAuthenticatedUser=async function(){const e=await this.getUser();return!e||e.reload||e.deactivated?(this._handleError(g.Error.NOT_REGISTERED),!1):e&&e.microsoft_corporate_config?e.microsoft_corporate_config.client_id?!!e.microsoft_corporate_config.odb_client_id||(this._handleError(g.Error.ONEDRIVE_BUSINESS_ERROR),!1):(this._handleError(g.Error.SHAREPOINT_ERROR),!1):(this._handleError(g.Error.SHAREPOINT_ONEDRIVE_BUSINESS_ERROR),!1)},g.prototype._authWithCorelCloud=async function(e){if(this._loaded||this._loading)return!1;this._loading=!0;if(await r.gApi.isOffline({includeCredentials:!1}))return this._loading=!1,this._handleError(g.Error.OFFLINE),null;const t=await r.gApi.authenticateMsTeamsUser(e).catch(e=>(console.error(">>>authenticateMsTeamsUser error",e),this._handleError(g.Error.NOT_REGISTERED),null));if(!t||!t.ok)return this._handleError(g.Error.NOT_REGISTERED),this._loading=!1,!1;return await t.json().catch(()=>null)?(this._loaded=!0,this._loading=!1,this._validateAuthenticatedUser()):(this._handleError(g.Error.NOT_REGISTERED),this._loading=!1,!1)},g.prototype.getUser=async function(){if(this._user)return this._user;const e=await r.gApi.getUser().catch(()=>null);return e?(this._user=new l.default(e),this._user):null},e.exports=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHAREPOINT_COMMAND=t.ONE_DRIVE_BUSINESS_COMMAND=t.MS_TEAMS_COMMAND=t.COMMAND_QUERY_PARAM=void 0;t.ONE_DRIVE_BUSINESS_COMMAND="onedrivebusiness";t.SHAREPOINT_COMMAND="sharepoint";t.MS_TEAMS_COMMAND="msteams";t.COMMAND_QUERY_PARAM="sp_command"},function(e,t,n){"use strict";e.exports={Apple:"apple",Windows:"windows",GooglePlay:"googleplay",ChromeWeb:"chromeweb"}},function(e,t,n){"use strict";n(9),n(45);var i=n(1),o=n(1083),r=n(230),a=n(1007);function s(){try{this._fontDB=o.getInstance()}catch(e){this._fontDB=null}}s.prototype.fontDB=null,s.prototype._numFiles=0,s.prototype._tmpFontList=null,s.prototype._importTrialCount=0,s.prototype.import=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{silent:n}=t;return!n&&this.busy()?this._importTrialCount++>100?void e():(setTimeout(function(){this.import(e)}.bind(this),100),void this._importTrialCount++):(this._importTrialCount=0,this._prompt(e,t),!0)},s.prototype._prompt=function(e,t){var n=this,r=gDesigner.getDefaultStorage();this._numLoaded=0;var a=new Promise(e=>{this._fontDB.getItem(o.FONT_LIST).done(t=>{this._tmpFontList=t||[],e(this._tmpFontList)})});r.openPrompt([{ext:"ttf",mime:"font/ttf"},{ext:"otf",mime:"font/otf"},{ext:"ttc",mime:"font/collection"},{ext:"dfont",mime:"font/collection"}],(function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;n._numFiles=o,a.then(()=>{t.read(t=>{var o=i.GOpenTypeUtil.getFont(null,null,null,t,!0);n._numFiles+=o.length-1;var r=function(t,n){return n<t.length?function(){this.checkAndAdd(t[n],r(t,n+1))}.bind(this):e}.bind(n),a=r(o,0);a&&a.call(n)})})}),!0,t)},s.prototype.busy=function(){return!this._fontDB||!this._fontDB.ready()||this._numFiles>0},s.prototype.getProgress=function(){return 0===this._numFiles?1:this._numLoaded/this._numFiles},s.prototype.ready=function(){return this._tmpFontList?Promise.resolve(void 0):new Promise(e=>{this._fontDB.getItem(o.FONT_LIST).done(t=>{this._tmpFontList=t||[],e()})})},s.prototype.checkAndAdd=function(e,t){var n=e.family,i=e.weight,o=e.style,r=e.buffer,a={style:o,weight:String(i),family:n,subfamily:e.subfamily,displayname:e.displayname};if(this._tmpFontList)for(var s=0;s<this._tmpFontList.length;s++){var l=this._tmpFontList[s];if(l.family===a.family&&l.weight===a.weight&&l.style===a.style){if(e.subfamily&&!l.subfamily)l.subfamily=e.subfamily;else if(l.subfamily&&l.subfamily!==a.subfamily){a.family=a.family+(a.subfamily||"");continue}return e.displayname&&!l.displayname&&(l.displayname=e.displayname),void this._postAddAction(t)}}else this._tmpFontList=[];this._tmpFontList.push(a),this._fontDB.updateItem(n+"_"+i+"_"+o,r).done(()=>{this._postAddAction(t,!0)})},s.prototype._postAddAction=function(e,t){this._numLoaded++,this._numLoaded===this._numFiles?(this._numLoaded=0,this._numFiles=0,this._fontDB.updateItem(o.FONT_LIST,this._tmpFontList).done(n=>{if(t?r.getInstance().reset(a,!0):r.getInstance().reset(),gDesigner.getWorkspace())for(var i=0;i<this._tmpFontList.length;i++){var o=this._tmpFontList[i];gDesigner.getWorkspace().getFontManager().getFont(o.family,o.style,parseInt(o.weight))}e&&e()})):e&&e()},e.exports=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GPersona=void 0;t.GPersona={GraphicDesign:{name:"Graphic Designer",icon:"assets/img/brand/logo.svg"}}},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.shouldShowExternalFileError=function(e){return e instanceof s.Item&&!e.hasFileSettings()},t.updateSaveOptions=function(e,t,n){if(n.getFullName()){const i=(0,o.getExtensionFromString)(n.getFullName(),r.FILE_FORMATS.map(e=>e.ext.toUpperCase()));if(i&&"CDR"===i.toUpperCase())return e=new a.default(gDesigner.getSetting("default_cdr_unsupported_effects",a.default.Unsupported.KeepEditable),t.getDefaultCdrVersionForSave()),(e=t.updateSaveOptionsLastModifiedDate(e)).singleton=!t.isCloudFile(),e}return e};var o=n(32),r=n(12),a=i(n(1133));const s=n(348)},function(e,t,n){"use strict";function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Unsupported.KeepEditable,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.unsupportedChoice=e,this.formatVersion=t,this.lastModifiedDate=n}i.Unsupported={KeepAppearance:0,KeepEditable:1,NotCDR:2,OmitIncompatible:3},i.prototype.unsupportedChoice=i.Unsupported.KeepEditable,i.prototype.formatVersion=0,i.prototype.lastModifiedDate=void 0,e.exports=i},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(1370));class r extends o.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._options=e}getOptions(){return this._options}}t.default=r},function(e,t,n){"use strict";var i=n(1);function o(e,t){this.oldPersona=e,this.newPersona=t}i.GObject.inherit(o,i.GEvent),o.prototype.oldPersona=null,o.prototype.newPersona=null,e.exports=o},function(e,t,n){"use strict";n(19),n(24),n(111),n(90),n(28),n(3),n(9),n(25);const i=n(546);e.exports=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._settings=e}getFrame(){return this._iframe}open(e){const t=gDesigner.getUTM();if(t&&t.size){const n=new URL(e),i=n.searchParams;t.forEach((e,t)=>i.set(t,e)),e=n.toString()}if(this._iframe=$("<iframe></iframe>").addClass("cross-frame").attr("src",e).appendTo($("body")),this._settings){const{id:e,className:t,css:n}=this._settings;e&&this._iframe.attr("id",e),t&&this._iframe.addClass(t),n&&this._iframe.css(n)}let n=this.close.bind(this);return this._settings.close&&(n=this._settings.close),this._messageHandler=async e=>{if(e.originalEvent.source!==this._iframe[0].contentWindow)return;let t=e.originalEvent.data;const{cmd:o}=t;if(o){if(this._settings[o])return void this._settings[o](t);switch(o){case"close":n(t);break;case"settings":let e=await gDesigner.getUser();new i(e,"purchase").open();break;case"purchase_flow":const{options:o={}}=t,{immediatePurchase:r=!1}=o;r&&Object.assign(o,{autoClose:!0,paymentCallback:()=>{n()}});let a=t.options;gInAppPurchase.getOptions()&&(a=Object.assign({},gInAppPurchase.getOptions(),a)),gDesigner.openPaymentDialog(null,a).then((function(){let{reinstate:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r&&!e||n()})).catch(()=>{n()});break;case"link":gContainer.openExternalLink(null,t.link)}}},$(window).on("message",this._messageHandler),this}close(){let{licenseHasBeenUpgraded:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._messageHandler&&($(window).unbind("message",this._messageHandler),this._iframe.remove()),e&&gDesigner.requestLicenseUpdate()}on(e,t){this._iframe.on(e,t)}postMessage(){this._iframe[0].contentWindow.postMessage.apply(this._iframe[0].contentWindow,arguments)}}},function(e,t,n){"use strict";n(9),n(14),n(63),n(84),n(19),n(158),n(201),n(166),n(167);var i=n(1),o=n(710),r=n(32),a=n(12),s=n(216),l=n(144),c=n(395);const d=n(390);function u(){}window.pako=n(147),n(1386),n(1387),n(1388),zip.useWebWorkers=!1,u.generateExportables=function(e,t,n){var o=e instanceof Array?e:[e];e instanceof i.GScene&&(o=e.getChildren().filter(e=>e instanceof i.GPage&&e.isVisible()));var r=[],a={};function s(e){var t=e.getProperty("name");if(!t){var n=i.GObject.getTypeId(e);a.hasOwnProperty(n)||(a[n]=0),t=e.getNodeNameTranslated();var o=++a[n];o>1&&(t+="_"+o)}return t}function l(e){if(t)r.push(i.GUtil.extend({},t,{element:e,name:1===o.length&&t.name?t.name:s(e)}));else if(e.hasMixin(i.GNode.Properties)){var a=e.getProperty(c.EXPORT_PROPERTY_NAME,!0);if(a&&a instanceof Array&&a.length)for(var d=s(e),u=0;u<a.length;++u){var p=a[u];p.fm&&r.push(i.GUtil.extend({},{size:p.sz,suffix:p.sf,format:p.fm,element:e,name:d}))}}if(n&&e.hasMixin(i.GNode.Container))for(var g=e.getFirstChild();null!==g;g=g.getNext())g instanceof i.GElement&&l(g)}for(var d=0;d<o.length;++d){l(o[d])}return r},u._validateCommercialDocument=function(){const e=gDesigner.getActiveDocument();return!e||!e.isCommercialProductFile()||(e.openPaywall(),!1)},u.exportExportable=function(e,t,n,s){if(this._validateCommercialDocument()){var l=e.element,c=e.format;if("png"===c||"jpg"===c){var u=null,p=null;switch(c){case"png":u=i.GBitmap.ImageType.PNG;break;case"jpg":u=i.GBitmap.ImageType.JPEG,p=(e.jpegQuality||100)/100}var g=i.GLength.DPI,h=o.GBitmapExport.export(e.element,e.size,e.backgroundColor,e.configuration,g,e.backgroundOpacity,!0);h&&h.toImageBlob(u,t,p)}else if("svg"===c)o.GSVGExport.export(l,{convertTextToPath:e.convertTextToPath,decimalPlacesPrecision:r.watchDog.check(e.decimalPlacesPrecision,3),preserveEditingCapabilities:r.watchDog.check(e.preserveEditingCapabilities,!1),backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,sceneBackground:!e.configuration||(e.configuration.sceneBackground||!!e.backgroundColor),layerNamesAsId:r.watchDog.check(e.layerNamesAsId,!1)},(function(e,n){!e&&n&&t(new Blob([n],{type:"image/svg+xml"}))}));else{if(c!==d.PDF.ext)throw new Error("Unknown format.");gDesigner.getUser().then((function(c){var u;u=c&&c.getFullUserName()?c.getFullUserName():i.GLocale.get(new i.GLocaleKey("GDocument","text.default-export-author"));var p={dpi:r.watchDog.check(i.GUtil.parseNumber(e.size),i.GUtil.parseNumber("72dpi")),colorSpace:e.colorSpace,jpegQuality:e.jpegQuality||a.JPEG_EXPORT_QUALITY_DEFAULT,configuration:e.configuration,backgroundColor:e.backgroundColor,backgroundOpacity:e.backgroundOpacity,convertTextToPath:e.convertTextToPath,progress:n,user:u,title:gDesigner.getWindows().getActiveWindow().getTitle(),downsampleImages:e.downsampleImages},g=o.GPDFExport.export(l,p,(function(e,n){!e&&n&&t(new Blob([n],{type:d.PDF.mime})),s&&(g.isAbort()?s.close&&s.close():e&&s.error&&s.error(e))}),null,s);s&&(s.abort=()=>g&&g.abort())}))}}},u.generateExportName=function(e,t,n){var o=i.GUtil.sanitizeFilename(t||e.name)+(e.suffix||"");if(n){var r=n.filter((function(t){return t.name===o&&t.format===e.format}));n.push({name:o,format:e.format}),r.length&&(o+="("+(r.length+1)+")")}return o+="."+e.format},u.exportToDirectory=async function(e,t,n,o){if(this._validateCommercialDocument())for(var r={},a=0,s=[],l=0;l<e.length;++l){var c=null,d=t;if(c=e[l].name){if(c.indexOf("/")>=0){var p=c.split("/"),g=[];for(let e=0;e<p.length;++e){var h=i.GUtil.sanitizeFilename(p[e].trim());h&&g.push(h)}if(g.length>1){c=g.pop();var f="";for(let e=0;e<g.length;++e){var m=g[e];f&&(f+="/");var y=r[f+=m.toLowerCase()];if(y)d=y;else try{d=await d.addDirectory(m),r[f]=d}catch(e){}}}else g.length&&(c=g[0])}else c=i.GUtil.sanitizeFilename(c.trim());c&&d&&u.exportExportable(e[l],function(t,i){return function(o){var r=new FileReader;if(r.onload=()=>{t.addFile(i).then(t=>{t.write(new Uint8Array(r.result),()=>{++a===e.length&&n&&n()})}).catch(()=>{++a===e.length&&n&&n()})},o instanceof Blob||o instanceof File)try{r.readAsArrayBuffer(o)}catch(t){++a===e.length&&n&&n()}else++a===e.length&&n&&n()}}(d,u.generateExportName(e[l],c,s)),o)}}},u.export=function(e,t,n,o,r,a,c,p,g,h){if(this._validateCommercialDocument()){var f=(e,t,n)=>{var i=new FileReader;i.onload=()=>{t.write(new Uint8Array(i.result),()=>n?n():void 0,g)},i.readAsArrayBuffer(e)},m=(e,n,i,o,a,l)=>{t instanceof s.Item?f(e,t,i):t instanceof s&&(!a&&t.canPromptSave()?t.savePrompt(n,[o],t=>{f(e,t,i)},r,l):t.canDownload()&&t.download(n,t=>{f(e,t,i)},l))},y=e[0],v=e.length>1,_=l.FileTypes.find(e=>e.ext===y.format);if(v&&(y.format!==d.PDF.ext||a||(v=!1,(y=i.GUtil.extend({},y)).name=n,y.element=e.map(e=>e.element))),v)if(t instanceof s&&t.canChooseDirectory())t.chooseDirectory(t=>{u.exportToDirectory(e,t,o,c)},r,()=>{var t=new u.ZipDirectory;u.exportToDirectory(e,t,()=>{t.exportBlob(e=>{m(e,n+".zip",o,_,!0,h)})},c)});else{var b=new u.ZipDirectory;u.exportToDirectory(e,b,()=>{b.exportBlob(e=>{m(e,n+".zip",o,{ext:"zip",mime:"application/zip"},!1,h)})},c)}else u.exportExportable(y,(function(e){const n=t instanceof s&&t.canDownload()&&_&&_.ext===d.PDF.ext;m(e,u.generateExportName(y),o,_,n,h)}),c,p)}},u.ZipDirectory=function(e,t){s.Directory.call(this,e),this._zipRoot=t?null:new zip.fs.FS,this._zipDirectory=t||this._zipRoot.root},i.GObject.inherit(u.ZipDirectory,s.Directory),u.ZipDirectory.prototype.addDirectory=async function(e){return new u.ZipDirectory(this._storage,this._zipDirectory.addDirectory(e))},u.ZipDirectory.prototype.addFile=async function(e){return{_zipDirectory:this._zipDirectory,_name:e,write:function(e,t){if(this._zipDirectory.addBlob(this._name,new Blob([e])),t)return t()}}},u.ZipDirectory.prototype.exportBlob=function(e){this._zipDirectory.exportBlob(e)},e.exports=u},function(e,t,n){"use strict";n(19),n(24),n(111),n(90),n(3);var i=n(1);const o=n(18),r=n(26),a=n(36),s=n(144),l=n(76),c=n(1139);function d(){}i.GObject.inherit(d,r),d.ID="file.share.opensharedfile",d.TITLE=new i.GLocaleKey("GOpenSharedFileAction","title"),d.prototype.getId=function(){return d.ID},d.prototype.getTitle=function(){return d.TITLE},d.prototype.getCategory=function(){return o.CATEGORY_FILE_SHARE},d.prototype.getGroup=function(){return"file-share/opensharedfile"},d.prototype.isVisible=function(){return!0},d.prototype.execute=function(){a.prompt(i.GLocale.get(new i.GLocaleKey("GOpenSharedFileAction","text.prompt-text")),e=>{if(void 0!==e)try{var t=new URL(e).searchParams.get(l.OpenFileRequest.Type.Token);if(t){let e=new l.OpenFileRequest(l.OpenFileRequest.Type.Token,t);gApi.setToken({token:t});let n=new s;n.setTitle(e.getContent()),gDesigner.addDocument(n),c.handleOpenFileRequest(n,e)}else a.alert(i.GLocale.get(new i.GLocaleKey("GOpenSharedFileAction","invalid-link")))}catch(e){console.error(e),a.alert(i.GLocale.get(new i.GLocaleKey("GOpenSharedFileAction","invalid-link")))}},null,i.GLocale.get(new i.GLocaleKey("GOpenSharedFileAction","text.cancel")),i.GLocale.get(new i.GLocaleKey("GOpenSharedFileAction","text.open")),"open-shared-file-dialog")},d.prototype.toString=function(){return"[Object GOpenSharedFileAction]"},e.exports=d},function(e,t,n){"use strict";var i=n(17);n(14),n(63),n(29);var o=i(n(78)),r=i(n(77)),a=i(n(402)),s=i(n(76)),l=i(n(216)),c=n(1);e.exports=class{static handleOpenFileRequest(e,t){gContainer.openStorageFile(e,t,(function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const d=t.getType();function u(t){const n=t=>{if(t.type===o.default.Type.Activated&&t.document===e){let e=t.document.getStatus();e===r.default.LoadFailed||e===r.default.LoadCancelled||gDesigner.executeAction(a.default.ID,void 0,void 0,!0),gDesigner.removeEventListener(o.default,n)}};if(d!==s.default.OpenFileRequest.Type.Preset&&gDesigner.addEventListener(o.default,n),t instanceof l.default.Item){if(e.setStorageItem(t),e.setIsShared(!0),e.load(null,i&&i.loadingData),gDesigner.trigger(new o.default(o.default.Type.Modified,e)),d===s.default.OpenFileRequest.Type.Template){e.setDocumentFromTemplate(!0);let t=i.category,n=t&&t.split(".");n.length>1&&(t=n.splice(1).join("."));let o=t.toLowerCase().replace(/\./g,"-");gDesigner.stats("directlink_template_".concat(o),"".concat(i.file.name," [").concat(i.content.id,"]"))}else if(d===s.default.OpenFileRequest.Type.Preset){e.setDocumentFromTemplate(!0);let t=i.preset.presetCategory.toLowerCase().replace(/[\t-\r \/\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/g,"-");gDesigner.stats("directlink_preset_".concat(t),i.preset.presetLayout.name)}}else if(t&&t.presetLayout){let n=gDesigner.createScene(),{unit:i,dpi:o,width:r,height:a}=t.presetLayout,s=t.presetCategory.toLowerCase().replace(/[\t-\r \/\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]/g,"-");n.setProperties(["ut","dpi"],[i,o||c.GLength.DPI]),n.getActivePage().setProperties(["bck","w","h"],[c.GRGBColor.WHITE,new c.GLength(r,i).toPoint(),new c.GLength(a,i).toPoint()]),e.setTitle(t.presetLayout.id),e.setScene(n),e.setDocumentFromTemplate(!0),e.setIsShared(!0),gDesigner.stats("directlink_preset_".concat(s),t.presetLayout.name)}}return u(n),e}))}}},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(26)),a=i(n(18)),s=i(n(106)),l=i(n(1047)),c=i(n(192)),d=i(n(231)),u=n(56);function p(){this._title=new o.GLocaleKey("GVersionsHistoryAction","title"),p.TOOLTIP_CONFIG={[u.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON]:u.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GVersionsHistoryAction","text.try-this-feature-pro-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GVersionsHistoryAction","text.try-this-feature-pro-tooltip-description")),learnMore:"https://documentation.designer.io/basics/working-with-files/working-with-gravit-cloud/#version-history",upgradeToProStatsValue:"gravit-versions-history",middle:!1,side:!0})}}o.GObject.inherit(p,r.default),p.ID="gravit-versions-history",p.GroupID="file",p.TOOLTIP_CONFIG=null,p.prototype._title=null,p.prototype.getId=function(){return p.ID},p.prototype.getTitle=function(){return this._title},p.prototype.isPro=function(){return!0},p.prototype.getTooltipArea=function(){return u.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON},p.prototype.getTooltipConfig=function(e){return e&&p.TOOLTIP_CONFIG[e]||null},p.prototype.getIcon=function(){return"gravit-icon-versions"},p.prototype.getCategory=function(){return a.default.CATEGORY_FILE},p.prototype.getGroup=function(){return p.GroupID},p.prototype.isEnabled=function(){if(!gDesigner.getApplicationManager().isShareEnabled())return!1;var e=gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getStorageItem()||null,t=!!gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getScene().isCloudSynchronization();return s.default.isOnline()&&e&&t},p.prototype.execute=function(){if(gDesigner.getWindows().getActiveWindow().getDocument().isModified())return new c.default(o.GLocale.get(new o.GLocaleKey("GVersionsHistoryAction","unsaved-modifications"))).open(),!1;const e=()=>{gDesigner&&gDesigner.hasEventListeners(l.default)&&(gDesigner.trigger(new l.default(l.default.Type.Enable,gDesigner.getActiveDocument().getScene().getProperty("cid"))),gDesigner.intercomStats("Entered version history"))};gDesigner.isOffline()?d.default.openUnavailableFeature(e):e()},p.prototype.toString=function(){return"[Object GVersionsHistoryAction]"},e.exports=p},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(547)],void 0===(r="function"==typeof(i=function(e){return e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(547)],void 0===(r="function"==typeof(i=function(e){var t=0,n=Array.prototype.hasOwnProperty,i=Array.prototype.slice;return e.cleanData=function(t){return function(n){var i,o,r;for(r=0;null!=(o=n[r]);r++)(i=e._data(o,"events"))&&i.remove&&e(o).triggerHandler("remove");t(n)}}(e.cleanData),e.widget=function(t,n,i){var o,r,a,s={},l=t.split(".")[0],c=l+"-"+(t=t.split(".")[1]);return i||(i=n,n=e.Widget),Array.isArray(i)&&(i=e.extend.apply(null,[{}].concat(i))),e.expr.pseudos[c.toLowerCase()]=function(t){return!!e.data(t,c)},e[l]=e[l]||{},o=e[l][t],r=e[l][t]=function(e,t){if(!this._createWidget)return new r(e,t);arguments.length&&this._createWidget(e,t)},e.extend(r,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),(a=new n).options=e.widget.extend({},a.options),e.each(i,(function(e,t){s[e]="function"==typeof t?function(){function i(){return n.prototype[e].apply(this,arguments)}function o(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,r=this._superApply;return this._super=i,this._superApply=o,e=t.apply(this,arguments),this._super=n,this._superApply=r,e}}():t})),r.prototype=e.widget.extend(a,{widgetEventPrefix:o&&a.widgetEventPrefix||t},s,{constructor:r,namespace:l,widgetName:t,widgetFullName:c}),o?(e.each(o._childConstructors,(function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,r,n._proto)})),delete o._childConstructors):n._childConstructors.push(r),e.widget.bridge(t,r),r},e.widget.extend=function(t){for(var o,r,a=i.call(arguments,1),s=0,l=a.length;s<l;s++)for(o in a[s])r=a[s][o],n.call(a[s],o)&&void 0!==r&&(e.isPlainObject(r)?t[o]=e.isPlainObject(t[o])?e.widget.extend({},t[o],r):e.widget.extend({},r):t[o]=r);return t},e.widget.bridge=function(t,n){var o=n.prototype.widgetFullName||t;e.fn[t]=function(r){var a="string"==typeof r,s=i.call(arguments,1),l=this;return a?this.length||"instance"!==r?this.each((function(){var n,i=e.data(this,o);return"instance"===r?(l=i,!1):i?"function"!=typeof i[r]||"_"===r.charAt(0)?e.error("no such method '"+r+"' for "+t+" widget instance"):(n=i[r].apply(i,s))!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0:e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+r+"'")})):l=void 0:(s.length&&(r=e.widget.extend.apply(null,[r].concat(s))),this.each((function(){var t=e.data(this,o);t?(t.option(r||{}),t._init&&t._init()):e.data(this,o,new n(r,this))}))),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(n,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var t=this;this._destroy(),e.each(this.classesElementLookup,(function(e,n){t._removeClass(n,e)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,o,r,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(o=a[t]=e.widget.extend({},this.options[t]),r=0;r<i.length-1;r++)o[i[r]]=o[i[r]]||{},o=o[i[r]];if(t=i.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var n,i,o;for(n in t)o=this.classesElementLookup[n],t[n]!==this.options.classes[n]&&o&&o.length&&(i=e(o.get()),this._removeClass(o,n),i.addClass(this._classes({element:i,keys:n,classes:t,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){var n=[],i=this;function o(o,r){var a,s;for(s=0;s<o.length;s++)a=i.classesElementLookup[o[s]]||e(),t.add?(t.element.each((function(t,n){e.map(i.classesElementLookup,(function(e){return e})).some((function(e){return e.is(n)}))||i._on(e(n),{remove:"_untrackClassesElement"})})),a=e(e.uniqueSort(a.get().concat(t.element.get())))):a=e(a.not(t.element).get()),i.classesElementLookup[o[s]]=a,n.push(o[s]),r&&t.classes[o[s]]&&n.push(t.classes[o[s]])}return(t=e.extend({element:this.element,classes:this.options.classes||{}},t)).keys&&o(t.keys.match(/\S+/g)||[],!0),t.extra&&o(t.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(t){var n=this;e.each(n.classesElementLookup,(function(i,o){-1!==e.inArray(t.target,o)&&(n.classesElementLookup[i]=e(o.not(t.target).get()))})),this._off(e(t.target))},_removeClass:function(e,t,n){return this._toggleClass(e,t,n,!1)},_addClass:function(e,t,n){return this._toggleClass(e,t,n,!0)},_toggleClass:function(e,t,n,i){i="boolean"==typeof i?i:n;var o="string"==typeof e||null===e,r={extra:o?t:n,keys:o?e:t,element:o?this.element:e,add:i};return r.element.toggleClass(this._classes(r),i),this},_on:function(t,n,i){var o,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=o=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),e.each(i,(function(i,a){function s(){if(t||!0!==r.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?r[a]:a).apply(r,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,d=l[2];d?o.on(c,d,s):n.on(c,s)}))},_off:function(t,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(n),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,n,i){var o,r,a=this.options[t];if(i=i||{},(n=e.Event(n)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!("function"==typeof a&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},(function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){var a;"string"==typeof o&&(o={effect:o});var s=o?!0===o||"number"==typeof o?n:o.effect||n:t;"number"==typeof(o=o||{})?o={duration:o}:!0===o&&(o={}),a=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),a&&e.effects&&e.effects.effect[s]?i[t](o):s!==t&&i[s]?i[s](o.duration,o.easing,r):i.queue((function(n){e(this)[t](),r&&r.call(i[0]),n()}))}})),e.widget})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(547)],void 0===(r="function"==typeof(i=function(e){return e.fn.scrollParent=function(t){var n=this.css("position"),i="absolute"===n,o=t?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter((function(){var t=e(this);return(!i||"static"!==t.css("position"))&&o.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))})).eq(0);return"fixed"!==n&&r.length?r:e(this[0].ownerDocument||document)}})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){"use strict";var i=n(17);n(45),n(28),n(25),n(9),n(3),n(537);var o=n(43),r=n(1),a=n(16),s=i(n(309)),l=n(56),c=i(n(395)),d=n(78),u=n(200),p=n(77),g=n(545),h=n(402),f=n(510),m=n(719),y=n(354),v=n(1395),_=n(36),b=n(403);const w=n(721),C=n(118);function E(){m.call(this)}r.GObject.inherit(E,m),E.ID="outline",E.TITLE=new r.GLocaleKey("GOutlineSidebar","title"),E.MULTIPAGE_MODE_ENABLED_OPTION_NAME="OutlineSidebar/Multipage_Mode",E.prototype._document=null,E.prototype._pageToolbar=null,E.prototype._layerToolbar=null,E.prototype._exportToolbar=null,E.prototype._outlineSidebarElement=null,E.prototype._pageContainerMaxHeight=500,E.prototype._pageContainerMinHeight=50,E.prototype._pagePanel=null,E.prototype._pageModeSwitch=null,E.prototype._layerPanel=null,E.prototype._exportPanel=null,E.prototype._exportInstance=null,E.prototype._pageMenuOptionButton=null,E.prototype._transformMode=!1,E.prototype._htmlElement=null,E.prototype.getId=function(){return E.ID},E.prototype.getTitle=function(){return E.TITLE},E.prototype.isEnabled=function(){return null!==this._document},E.prototype.isVisible=function(){return!!gDesigner.getApplicationManager().isInspectEnabled()},E.prototype.getOrientation=function(){return y.Orientation.Left},E.prototype.getMinimumWidth=function(){return 250},E.prototype.getDefaultWidth=function(){return 250},E.prototype.isResizeable=function(){return!0},E.prototype.getLayerPanel=function(){return this._layerPanel},E.prototype.relayout=function(){this._pagePanel.gPagePanel("relayout"),this._layerPanel.gLayerPanel("relayout"),this._pageContainerMaxHeight=parseInt(this._outlineSidebarElement.css("height"),10)-150},E.prototype._copyDataTransfer=function(e,t){var n=t.originalEvent;e.hasOwnProperty("dataTransfer")?n&&n.dataTransfer&&n.dataTransfer.types&&n.dataTransfer.types.forEach((function(t){e.dataTransfer.setData(n.dataTransfer.getData(t))})):e.dataTransfer=n.dataTransfer},E.prototype.getTouchTools=function(){return[new s.default({def:!0,id:"pages",sidebar:this.getId(),icon:"gravit-icon-touch-pages-panel",panel:".pages-container",toolbar:".page-toolbar",panelWidth:"320px"}),new s.default({id:"layers",sidebar:this.getId(),icon:"gravit-icon-touch-layers-panel",panel:[".layers-container",".export-panel"],toolbar:".layer-toolbar",panelWidth:"350px"})]},E.prototype.init=function(e){this._htmlElement=e,m.prototype.init.call(this,e),this._pageToolbar=$("<div></div>").addClass("toolbar page-toolbar").append($("<label></label>").text(r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.pages")))).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation();var t=this._pagePanel.gPagePanel("getLastVisitedDroppable");if(t){var n=document.createEvent("mouseEvent");n.initEvent("drop",!0,!0,null),this._copyDataTransfer(n,e),t.dispatchEvent(n)}}.bind(this)).appendTo(e),this._pageModeSwitch=$("<label></label>").addClass("g-switch").attr("data-title",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.toggle-page-mode"))).css("margin-right","5px").append($("<input>").attr("id","toogle-page-mode-checkbox").attr("type","checkbox").attr("data-property","multipage-switch").on("change",this._multiPageModeChangeEventHandler.bind(this))).append($("<div></div>")).appendTo(this._pageToolbar).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.multipage-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.multipage-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#page-panel"})),this._pageMenuOptionButton=$("<button></button>").addClass("setting-menu-options").on("click",function(e){Object.assign(e,{data:{context:b.PagePanel}}),$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",e)}.bind(this)).append($("<span/>").addClass("gravit-icon-settings")).appendTo(this._pageToolbar),$("<button></button>").attr("data-title",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-active-page"))).on("click",()=>this._deletePage()).append($("<span></span>").addClass("gravit-icon-trash")).appendTo(this._pageToolbar).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.delete-page-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.delete-page-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#page-panel"})),$("<button></button>").attr("data-title",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.create-new-page"))).on("click",function(){this._insertPage(),$(this._pageToolbar).gAccordion("toggleOpen",!0),$(this._pageToolbar).gAccordion("init",$(this._pagePanel))}.bind(this)).append($("<span></span>").addClass("gravit-icon-addpage")).appendTo(this._pageToolbar).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.create-new-page-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.create-new-page-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#page-panel"}));var t,n,i=$("<div></div>").addClass("pages-container").appendTo(e);this._pagePanel=$("<div></div>").addClass("pages").gToolbarShadow("init",".page-toolbar").on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation();var t=this._pagePanel.gPagePanel("getLastVisitedDroppable");if(t){var n=document.createEvent("mouseEvent");n.initEvent("drop",!0,!0,null),this._copyDataTransfer(n,e),t.dispatchEvent(n)}}.bind(this)).on("mouseenter",function(){this._pagePanel.gPagePanel("setBlockHighlight",!0)}.bind(this)).on("mouseleave",function(){this._pagePanel.gPagePanel("setBlockHighlight",!1)}.bind(this)).appendTo(i),this._pagePanel.gPagePanel({moveCallback:this._movePageTreeNodeCallback.bind(this),clickCallback:this._clickPageTreeNodeCallback.bind(this),startDraggingCallback:this._startPageDraggingCallback.bind(this)});var a=!1,s=$("<div/>").attr("id","page-layer-divider"),c=function(e){var o;a&&((o=n-t+e.clientY)<this._pageContainerMinHeight&&(o=this._pageContainerMinHeight),o>this._pageContainerMaxHeight&&(o=this._pageContainerMaxHeight),i.css("height",o+"px"))}.bind(this),u=function i(){$(document).off("mousemove",c),$(document).off("mouseup",i),a=!1,t=null,n=null,e.removeClass("page-container-resizing")},p=function(o){t=o.clientY,a=!0,n=parseInt(i.css("height"),10),e.addClass("page-container-resizing"),$(document).on("mousemove",c),$(document).on("mouseup",u)}.bind(this);$(s).on("mousedown",p),s.appendTo(e),$("<hr />").appendTo(s),s.append($("<div />")),this._addLayerPanel(e),$("<hr/>").appendTo(e),this._exportToolbar=$("<div></div>").addClass("toolbar toolbar-export").appendTo(e),this._exportPanel=$("<div></div>").addClass("properties-panel").addClass("export-panel").appendTo(e),this._exportInstance=new v,this._exportInstance.init(this._exportPanel,this._exportToolbar),gDesigner.addEventListener(d,this._documentEvent,this),gDesigner.getToolManager().addEventListener(o.GToolManager.ToolChangedEvent,this._toolChangedEvent,this),gDesigner.addEventListener(w,this._applicationStatusEvent,this),gDesigner.addEventListener(C,this._settingChanged,this),this._pageToolbar.gAccordion("init",".pages-container","label"),this._exportToolbar.gAccordion("init",".properties-panel","label"),this._outlineSidebarElement=e},E.prototype.toggleMultiPageMode=function(){const e=this._getMultiPageSwitcher();if(e){const t=e.is(":checked");e.prop("checked",!t),e.trigger("change")}},E.prototype._changePageMode=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._document.getScene().setProperty(c.default.MULTIPAGE_VIEW_ENABLED,e),gContainer.setProperty(E.MULTIPAGE_MODE_ENABLED_OPTION_NAME,e),t&&this._pageModeSwitch.find("input[data-property=multipage-switch]").prop("checked",e)},E.prototype._getMultiPageSwitcher=function(){return this._pageModeSwitch?this._pageModeSwitch.find('input[data-property="multipage-switch"]'):null},E.prototype._multiPageModeChangeEventHandler=function(e){gDesigner.stats("pages_change_multipage-mode");const t=$(e.target);this._refreshPageModeSwitch(t,{showAlert:!0});const n=t.is(":checked");this._changePageMode(n,!1);const i=r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.toggle-page-mode"));this._document.getEditor().pushState(i,()=>{this._changePageMode(n)},()=>{this._changePageMode(!n)},{actions:[{isPropertyChangeAction:!0,node:{hasMixin:()=>!1}}]})},E.prototype._settingChanged=function(e){"touch"===e.key&&this._touchInterfaceUpdate()},E.prototype._applicationStatusEvent=function(e){e.status===w.Status.Ready&&this._touchInterfaceUpdate()},E.prototype._touchInterfaceUpdate=function(){gDesigner.isTouchEnabled()?(this._pageModeSwitch.toggleClass("toogle-page-mode",!0),this._pageModeSwitch.toggleClass("g-switch",!1),this._pageModeSwitch.find("#toogle-page-mode-checkbox").gCheckboxSlider(),this._pageMenuOptionButton.show(),this._pagePanel.gPagePanel("resetVTreeRowHeight","48"),this._layerPanel.gLayerPanel("resetVTreeRowHeight","48")):(this._pageModeSwitch.toggleClass("toogle-page-mode",!1),this._pageModeSwitch.toggleClass("g-switch",!0),this._pageModeSwitch.find("#toogle-page-mode-checkbox").gCheckboxSlider("unmount"),this._pageMenuOptionButton.hide(),this._pagePanel.gPagePanel("resetVTreeRowHeight","34"),this._layerPanel.gLayerPanel("resetVTreeRowHeight","34"))},E.prototype._addLayerPanel=function(e){this._layerToolbar||(this._layerToolbar=$("<div></div>").addClass("toolbar").addClass("layer-toolbar").append($("<label></label>").css("flex-grow","1").text(r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.layers")))).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation();var t=this._layerPanel.gLayerPanel("getLastVisitedDroppable");if(t){var n=new CustomEvent("drop",{bubbles:!0,cancelable:!0});this._copyDataTransfer(n,e),n.altKey=e.originalEvent.altKey,n.layerY=0,t.dispatchEvent(n)}}.bind(this)),$("<button></button>").attr("data-title",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-layer-item"))).on("click",()=>this._deleteLayerOrItem()).append($("<span></span>").addClass("gravit-icon-trash")).appendTo(this._layerToolbar).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.delete-layer-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.delete-layer-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/objects/#deleting-objects"})),$("<button></button>").attr("data-title",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.new-layer"))).on("click",()=>this.insertLayer()).append($("<span></span>").addClass("gravit-icon-addlayer")).appendTo(this._layerToolbar).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.new-layer-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.new-layer-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/layer-groups/#adding-a-layer-group"}))),this._layerToolbar.appendTo(e);var t=$("<div></div>").addClass("layers-container").appendTo(e);this._layerPanel||(this._layerPanel=$("<div></div>").gToolbarShadow("init",".layer-toolbar").addClass("layers").on("mouseenter",function(e){var t=this._document.getScene();t&&t.acceptChildren((function(e){return e.hasFlag(r.GNode.Flag.Highlighted)&&e.removeFlag(r.GNode.Flag.Highlighted),!0})),this._layerPanel.gLayerPanel("setBlockHighlight",!0)}.bind(this)).on("mouseleave",function(e){this._layerPanel.gLayerPanel("setBlockHighlight",!1)}.bind(this)).on("click",function(){gDesigner.stats("layers_deselect_all-layers"),this._document.getEditor().clearSelection();var e=this._document.getScene();e&&e.setActiveLayer(null),a.GPlatform.modifiers.optionKey&&gDesigner.executeAction(h.ID,void 0,"outlinesidebar")}.bind(this)).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation();var t=this._layerPanel.gLayerPanel("getLastVisitedDroppable");if(t){var n=document.createEvent("mouseEvent");n.initEvent("drop",!0,!0,null),this._copyDataTransfer(n,e),t.dispatchEvent(n)}}.bind(this)).appendTo(t),this._layerPanel.gLayerPanel({moveCallback:this._moveLayerTreeNodeCallback.bind(this),isDuplicateEffectCallback:this._isDuplicateEffectCallback.bind(this),duplicateCallback:this._duplicateLayerTreeNodeCallback.bind(this),clickCallback:this._clickLayerTreeNodeCallback.bind(this),startDraggingCallback:this._startLayerDraggingCallback.bind(this),patternChooserStatusChangeCallBack:this._patternChooserStatusChange.bind(this)}))},E.prototype._documentEvent=function(e){var t,n;e.type===d.Type.Activated?(this._document=e.document,t=this._document.getScene(),this._pagePanel.gPagePanel("scene",t),this._layerPanel.gLayerPanel("scene",t),this.trigger(m.UPDATE_EVENT),this._document.getStatus()===p.Ready||this._document.getStatus()===p.Loaded?this._document.getActiveWindow()?this._updateMultiPageMode():gDesigner.getWindows().addEventListener(g.WindowEvent,this._windowsEvent,this):this._document.addEventListener(u,this._documentStatusEvent,this),n=this._document.getEditor(),gDesigner.getToolManager().addEventListener(o.GToolManager.ToolChangedEvent,this._updateExport,this),n.addEventListener(o.GEditor.SelectionChangedEvent,this._updateExport,this),t.addEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),t.addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChanged,this),t.addEventListener(r.GNode.AfterInsertEvent,this._afterInsert,this),this._updateExport()):e.type===d.Type.Deactivated&&(this._pagePanel.gPagePanel("scene",null),this._layerPanel.gLayerPanel("scene",null),t=this._document.getScene(),n=this._document.getEditor(),gDesigner.getToolManager().removeEventListener(o.GToolManager.ToolChangedEvent,this._updateExport,this),gDesigner.getWindows().removeEventListener(g.WindowEvent,this._windowsEvent,this),n.removeEventListener(o.GEditor.SelectionChangedEvent,this._updateExport,this),t.removeEventListener(r.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this),t.removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChanged,this),t.removeEventListener(r.GNode.AfterInsertEvent,this._afterInsert,this),this._document.removeEventListener(u,this._documentStatusEvent,this),this._document=null,this._elements=null,this._updateExport(),this.trigger(m.UPDATE_EVENT))},E.prototype._documentStatusEvent=function(e){e.status!==p.Ready&&e.status!==p.Loaded||(this._updateMultiPageMode(),this._document.removeEventListener(u,this._documentStatusEvent,this))},E.prototype._windowsEvent=function(e){e.type===g.WindowEvent.Type.Activated&&(this._updateMultiPageMode(),gDesigner.getWindows().removeEventListener(g.WindowEvent,this._windowsEvent,this))},E.prototype._isMultiPageModeEnabled=function(){const e=this._document.getScene().getProperty(c.default.MULTIPAGE_VIEW_ENABLED);return"boolean"==typeof e?e:gContainer.getProperty(E.MULTIPAGE_MODE_ENABLED_OPTION_NAME)},E.prototype._updateMultiPageMode=async function(){const e=this._getMultiPageSwitcher(),t=await this._isMultiPageModeEnabled();e.prop("checked",t),this._refreshPageModeSwitch(e,{skipInvalidation:!0})},E.prototype._toolChangedEvent=function(e){var t=e.previousTool,n=e.newTool;t&&t instanceof o.GSelectTool&&(e.light||this._updateTransformMode(!1),t.removeEventListener(o.GSelectTool.Event,this._selectToolEvent,this)),this._activeTool(n)},E.prototype._activeTool=function(e){e&&e instanceof o.GSelectTool&&e.addEventListener(o.GSelectTool.Event,this._selectToolEvent,this)},E.prototype._selectToolEvent=function(e){e.type===o.GSelectTool.Event.Type.EditModeChanged&&this._updateTransformMode(e.args.mode===o.GSelectTool.EditMode.Transform)},E.prototype._insertPage=function(){if(gDesigner.getApplicationManager().isEditingEnabled()){gDesigner.stats("pages_insert_page");var e=this._document.getScene();o.GEditor.tryRunTransaction(e,(function(){var t=e.insertPage();e.setActivePage(t)}),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.insert-page"))),this._navigateDrawingCenter(e.getActivePage()),this._refreshSelection()}},E.prototype.sceneHasInfiniteCanvas=function(){var e=!1;return this._document.getScene().iteratePages(t=>(t.isFixedSized()||(e=!0),!e),!0),e},E.prototype._refreshPageModeSwitch=function(e){let{showAlert:t=!1,skipInvalidation:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=!this.sceneHasInfiniteCanvas();if(!this.isEnabled())return e.attr("data-title",""),void e.prop("disabled",!0);e.prop("disabled",!1);var o=this._document.getActiveWindow(),a=o.getView();(i||(e.is(":checked")&&e.prop("checked",!1),t&&_.alert(r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.multipage-alert"))),a.getViewConfiguration().multiPageView||a.getViewConfiguration().pageLabelsVisible))&&(a.getViewConfiguration().multiPageView=e.is(":checked"),a.getViewConfiguration().pageLabelsVisible=e.is(":checked"),n||(a.invalidate(null,!0),t&&(o.centerAndZoom(),this._refreshSelection())))},E.prototype._deletePage=function(){gDesigner.stats("pages_delete_page");this._document.getEditor();var e=this._document.getScene(),t=e.getActivePage();t.getProperty("plkt")&r.GBlock.ProgramLck.NoDelete||(t.getSlavePages().length>0?_.confirm(r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.confirm-delete-masterpage")),(function(t){t&&o.GEditor.tryRunTransaction(e,(function(){e.deleteActivePage()}),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-page")))}),null,null,!0,!0):o.GEditor.tryRunTransaction(e,(function(){e.deleteActivePage()}),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-page"))),this._navigateDrawingCenter(e.getActivePage()),this._refreshSelection())},E.prototype._refreshSelection=function(){var e=this._document.getEditor(),t=this._document.getScene(),n=this._document.getActiveWindow().getView().getViewConfiguration().multiPageView,i=t.getActivePage(),r=null;if(e.hasSelection()){var a=e.getSelection();n?e.updateSelection(!1,[i]):(r=a.filter((function(e){return o.GEditor.getElementPage(e)===i}))).length!==a.length&&e.updateSelection(!1,r)}else n&&e.updateSelection(!1,[i])},E.prototype._movePageTreeNodeCallback=function(e,t,n){if(n&&e&&n.length){this._pagePanel.gPagePanel("blockHandlers",!0);var i=this._document.getScene();o.GEditor.tryRunTransaction(this._document.getScene(),function(){this._document.getEditor().clearSelection(),i.startBlockReferenceChanges(),n.length>1&&e.beginUpdate();for(var o=n.length;o>0;--o){var r=n[o-1];r.getParent().removeChild(r),e.insertChild(r,t)}n.length>1&&e.endUpdate(),i.endBlockReferenceChanges(),i.isEvenOddMaster()&&i.reassignMasterPages()}.bind(this),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.move-page"))),this._pagePanel.gPagePanel("blockHandlers",!1)}},E.prototype._startPageDraggingCallback=function(e){gDesigner.stats("pages_start_drag");var t=null;if(e){t=[];var n=this._document.getEditor();if(e.hasFlag(r.GNode.Flag.Selected)){var i=n.getSelection();t=this._filterPageDraggable(i);t=r.GNode.order(t,!0)}else n.clearSelection(),t.push(e)}return t},E.prototype._filterPageDraggable=function(e){var t=[];if(e)for(var n=0;n<e.length;++n){var i=e[n];i instanceof r.GPage&&!i.hasFlag(r.GElement.Flag.PartialLocked)&&t.push(i)}return t},E.prototype.changeActivePage=function(e){gDesigner.stats("pages_select_page");const t=this._document,n=t&&t.getScene();n&&e&&o.GEditor.tryRunTransaction(n,()=>{n.setActivePage(e),this._navigateDrawingCenter(e),this._refreshSelection()},r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.change-active-page")))},E.prototype._clickPageTreeNodeCallback=function(e){this.changeActivePage(e)},E.prototype._navigateDrawingCenter=function(e){var t=this._document.getActiveWindow().getView();if(t.getViewConfiguration().multiPageView){var n=e.getTransform(),i=e.getGeometryBBox();a=n.mapRect(i).getSide(r.GRect.Side.CENTER);t.zoomAtCenter(a)}else if(this._document.hasCDR()){var o=e.getContentBBox();if(o&&!o.isEmpty()){var a=o.getSide(r.GRect.Side.CENTER);t.zoomAtCenter(a)}}},E.prototype.createLayer=function(){const e=this._document.getScene(),t=new r.GLayer;return t.setProperty("name",r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","text.layer"))+" "+e.queryCount("layer").toString()),t},E.prototype.insertLayer=function(){if(!gDesigner.getApplicationManager().isEditingEnabled())return;gDesigner.stats("layers_insert_layer");const e=this._document.getScene();o.GEditor.tryRunTransaction(e,()=>{const t=gDesigner.getActiveDocument(),n=t&&t.getEditor(),i=n&&n.getSelection()||[];let o=e.getActivePage();o||(o=e.insertPage(),o.setFlag(r.GNode.Flag.Active));const a=this.createLayer(),s=i.filter(e=>!this._hasSelectedParentLayer(e)),l=r.GNode.order(s,!0),c=l&&l[0];(c&&c.getParent()||o).insertChild(a,c),e.setActiveLayer(a),this._moveLayers(a,null,s,!1)},r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.insert-layer")))},E.prototype._hasSelectedParentLayer=function(e){let t=!1;for(let n=e.getParent();n instanceof r.GLayer&&!t;n=n.getParent())n.hasFlag(r.GNode.Flag.Selected)&&(t=!0);return t},E.prototype._moveLayerTreeNodeCallback=function(e,t,n,i){const a=this._document.getScene();o.GEditor.tryRunTransaction(a,()=>{this._moveLayers(e,t,n,i)},r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.move-layer")))},E.prototype._moveLayers=function(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!(e&&e.hasMixin(r.GNode.Container)&&n&&n.length))return;if(!(n=n.slice().filter(e=>o.GEditor.validateBlockInsertion(e.getParent(),e,t))).length)return;i&&this._layerPanel.gLayerPanel("blockHandlers",!0);const s=this._document.getScene();this._document.getEditor().clearSelection(),s.startBlockReferenceChanges(),n.length>1&&e.beginUpdate(),n.forEach(n=>{a.GPlatform.modifiers.optionKey?n.hasMixin(r.GNode.Store)&&(n=n.clone()):n.getParent().removeChild(n),n&&(e.insertChild(n,t),e instanceof r.GCompoundShape&&n.assignStyleFrom(e))}),n.length>1&&e.endUpdate(),s.endBlockReferenceChanges(),this._document.getEditor().updateSelection(!1,n),i&&this._layerPanel.gLayerPanel("blockHandlers",!1)},E.prototype._isDuplicateEffectCallback=function(e){return e.altKey},E.prototype._duplicateLayerTreeNodeCallback=function(e,t,n){if(n&&e&&e.hasMixin(r.GNode.Container)&&n.length){this._layerPanel.gLayerPanel("blockHandlers",!1);var i=this._document.getScene();o.GEditor.tryRunTransaction(i,function(){this._document.getEditor().clearSelection(),n.length>1&&e.beginUpdate();for(var i=[],a=0;a<n.length;++a){var s=n[a];s.validateInsertion(e)&&s.hasMixin(r.GNode.Store)&&o.GEditor.validateBlockInsertion(e,s)&&(s=s.clone())&&i.push(s)}if(this._document.getEditor().insertElements(i,!0,!0,!1,!0,e,t),e instanceof r.GCompoundShape)for(var l=0;l<i.length;++l)i[l].assignStyleFrom(e);else if(e instanceof r.GShape){var c=e.getPaintBBox();if(c){var d=c.getX(),u=c.getY();for(a=0;a<i.length;++a){var p=i[a],g=p instanceof r.GElement?p.getPaintBBox():null;if(g&&!c.intersectsRect(g,!0)){var h=g.getX(),f=g.getY();null===d||null===h||r.GMath.isEqualEps(d,h)&&r.GMath.isEqualEps(u,f)||p.transform(new r.GTransform(1,0,0,1,d-h,u-f),!0)}}}}n.length>1&&e.endUpdate(),this._document.getEditor().updateSelection(!1,i)}.bind(this),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.move-layer")))}},E.prototype._startLayerDraggingCallback=function(e){var t=null;if(e){gDesigner.stats("layers_start_drag"),t=[];var n=this._document.getEditor();if(e.hasFlag(r.GNode.Flag.Selected)){var i=n.getSelection();t=this._filterLayerDraggable(i),t=r.GNode.order(t,!0)}else n.clearSelection(),t.push(e)}return t},E.prototype._patternChooserStatusChange=function(e){this._layerToolbar.toggleClass("pattern-choose-actived",e)},E.prototype._filterLayerDraggable=function(e){var t=[];if(e)for(var n=0;n<e.length;++n){var i=e[n];if(!i.hasFlag(r.GElement.Flag.PartialLocked)){for(var o=!1,a=i.getParent();null!=a&&!o;a=a.getParent())o=a.hasFlag(r.GNode.Flag.Selected);o||t.push(i)}}return t},E.prototype._clickLayerTreeNodeCallback=function(e){if(e){e instanceof r.GCollabText?gDesigner.stats("layers_select_collab-text"):gDesigner.stats("layers_select_layer"),this._document.getScene().updateActivePageForElem(e),this._document.getScene().updateActiveLayerForElem(e);var t=this._document.getEditor(),n=null,i=!1;if(e instanceof r.GItem?n=r.GItem:e instanceof r.GLayer&&(n=r.GLayer),n){if(jQuery(gDesigner.getWindows().getActiveWindow().getView().getHtmlElement()).find("> div[tabindex=0]").focus(),a.GPlatform.modifiers.metaKey||!e.hasFlag(r.GNode.Flag.Selected)&&!e.hasFlag(r.GElement.Flag.FullLocked)&&!a.GPlatform.modifiers.shiftKey)this._layerPanel.gLayerPanel("onlyUpdateStyle",!0),t.updateSelection(a.GPlatform.modifiers.metaKey,[e]),this._layerPanel.gLayerPanel("onlyUpdateStyle",!1),i=!0;else if(a.GPlatform.modifiers.shiftKey){var o=t.getSelection(),s=null;if(o&&o.length){for(var l=o.length-1;l>=0&&!s;--l)o[l]instanceof n&&(s=o[l]);if(s&&s!==e){var c=[];if(this._document.getScene().accept((function(e){return e instanceof n&&c.push(e),!0}),!1,!0),c){c=r.GNode.order(c);var d=[],u=!1,p=null,g=null;for(l=0;l<c.length&&(null===p||null===g);++l)c[l]===s||c[l]===e?(u=!u,d.push(c[l]),c[l]===s?p=l:g=l):u&&d.push(c[l]);var m=s.getParent(),y=e.getParent();d=d.filter(function(t){var n=this._layerPanel.gLayerPanel("getTreeNode",t);if(e===t||s===t)return!0;var i=this._layerPanel.gLayerPanel("getItem",n.parent);return i?m===i:t!==m&&t!==y}.bind(this));var v=gDesigner.getSetting("auto_expand_layers");gDesigner.setSetting("auto_expand_layers",!1),d.length&&(p>g&&d.reverse(),t.updateSelection(!1,d),i=!0),setTimeout((function(){gDesigner.setSetting("auto_expand_layers",v)}),50)}}else t.updateSelection(!1,[e]),i=!0}}else e.hasFlag(r.GNode.Flag.Selected)&&(this._layerPanel.gLayerPanel("onlyUpdateStyle",!0),t.clearSelection(),this._layerPanel.gLayerPanel("onlyUpdateStyle",!1),i=!0);if(i)if(a.GPlatform.modifiers.optionKey)t.hasSelection()?gDesigner.executeAction(f.ID,void 0,"outlinesidebar"):gDesigner.executeAction(h.ID,void 0,"outlinesidebar");else if(e.hasMixin(r.GNode.Properties)&&e.getProperty("collab")){const t=this._document&&this._document.getActiveWindow();t&&t.scrollIntoView(e.getGeometryBBox())}}}},E.prototype._deleteLayerOrItem=function(){gDesigner.stats("layers_delete_layer-or-item");var e=this._document.getEditor(),t=this._document.getScene(),n=t.getActiveLayer();e.hasSelection()?o.GEditor.tryRunTransaction(t,(function(){e.deleteSelection(!0);var i=t.getActiveLayer();n&&n===i&&(n.acceptChildren((function(e){return e instanceof r.GItem}),!1,!0)||t.deleteActiveLayer(n))}),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-layer-item"))):n&&o.GEditor.tryRunTransaction(t,(function(){t.deleteActiveLayer(n)}),r.GLocale.get(new r.GLocaleKey("GOutlineSidebar","action.delete-layer-item")))},E.prototype._updateExport=function(){this._exportInstance.update(this._document,this._elements)},E.prototype._updateTransformMode=function(e){e!==this._transformMode&&(this._transformMode=e,this._updateExport())},E.prototype._afterFlagChangeEvent=function(e){e.node instanceof r.GPage&&e.flag===r.GNode.Flag.Active&&(this._document.getEditor().hasSelection()||this._updateExport())},E.prototype._afterPropertiesChanged=function(e){!e.temporary&&(e.node instanceof r.GScene||e.node instanceof r.GPage)&&r.GUtil.containsOneOf(e.properties,["w","h"])&&this._refreshPageModeSwitch(this._getMultiPageSwitcher())},E.prototype._afterInsert=function(e){var t=e.node;t instanceof r.GPage&&0===t.getProperty("w")&&this._refreshPageModeSwitch(this._getMultiPageSwitcher())},E.prototype.toString=function(){return"[Object GOutlineSidebar]"},e.exports=E},function(e,t,n){"use strict";var i=n(17);n(45);var o=n(16),r=n(43),a=n(1),s=n(12),l=n(56),c=i(n(309)),d=i(n(720)),u=i(n(193)),p=n(1049),g=i(n(509)),h=n(108),f=n(403);const m=n(549),y=n(36);function v(){}a.GObject.inherit(v,h),v.prototype._panel=null,v.prototype._advancedFillPanel=null,v.prototype._toolbar=null,v.prototype._elements=null,v.prototype._document=null,v.prototype._styleEditorChange=!1,v.prototype._styleEdOn=!1,v.prototype._ownChange=!1,v.prototype._chooserElem=null,v.prototype.init=function(e,t){this._panel=e.addClass("fill-properties-panel"),this._toolbar=t,this.setTouchTools([new c.default({id:"fill",icon:"gravit-icon-touch-fill",panel:this._panel,toolbar:this._toolbar,panelWidth:"368px"})]);var n=this;this._advancedFillPanel=$("<div></div>").gOverlay({releaseOnClose:!1});var i=function(e){if("evenodd"===e)return $("<select></select>").attr("data-property","evenodd").append($("<option></option>").attr("value","0").text(a.GLocale.get(new a.GLocaleKey("GCommonNames","evenodd.non-zero")))).append($("<option></option>").attr("value","1").text(a.GLocale.get(new a.GLocaleKey("GCommonNames","evenodd.even-odd")))).on("change",(function(){gDesigner.stats("fill_toggle_fill-rule","1"===$(this).val()?"enable":"disable"),n._assignProperty("evenodd","1"===$(this).val(),a.GLocale.get(new a.GLocaleKey("GCommonNames","action.change-fill-rule")))}));throw new Error("Unknown input property: "+e)}.bind(this);this._toolbar.addClass("list-toolbar fill-toolbar"),$("<label></label>").text(a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","title"))).appendTo(this._toolbar),$("<button></button>").attr("data-title",a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.advanced-settings"))).addClass("fill completely-fill g-active").append($("<span></span>").addClass("gravit-icon-touch-completely-fill")).on("click",function(e){$(".completely-fill").addClass("g-active"),$(".winding-fill").removeClass("g-active"),n._assignProperty("evenodd",!1,a.GLocale.get(new a.GLocaleKey("GCommonNames","action.change-fill-rule")))}.bind(this)).appendTo(this._toolbar),$("<button></button>").attr("data-title",a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.advanced-settings"))).addClass("fill winding-fill").append($("<span></span>").addClass("gravit-icon-touch-winding-fill")).on("click",function(e){$(".winding-fill").addClass("g-active"),$(".completely-fill").removeClass("g-active"),n._assignProperty("evenodd",!0,a.GLocale.get(new a.GLocaleKey("GCommonNames","action.change-fill-rule")))}.bind(this)).appendTo(this._toolbar),$("<button></button>").attr("data-title",a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.advanced-settings"))).attr("data-action","settings").addClass("fill-settings").append($("<span></span>").addClass("gravit-icon-settings")).on("click",function(e){gDesigner.stats("fill_open_advancedfillpanel"),this._advancedFillPanel.gOverlay("open",$(e.target).closest("button"))}.bind(this)).gRichTooltip(l.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.fill-rule-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.fill-rule-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/fills/#advanced-fill-settings"})).appendTo(this._toolbar),$("<button></button>").attr("data-action","remove").attr("data-title",a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.remove-selected"))).append($("<span></span>").addClass("gravit-icon-trash")).append($("<span></span>").addClass("gravit-icon-touch-trash")).on("click",(function(e){gDesigner.stats("fill_remove_fill"),e.stopPropagation();var t=n._getSelectedPaintLayer();t&&r.GEditor.tryRunTransaction(n._elements[0],(function(){var e=[];n._iterateEqualPaintLayer(t,(function(t){e.push(t)})),a.GUtil.each(e,(function(e,t){t.getParent().removeChild(t)}))}),a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.remove")));const i=gDesigner.getRightSidebars().getSidebar(u.default.SidebarsIds.GInspectorSidebar);i.trigger(new d.default(d.default.Type.ChildRemoved,i))})).gRichTooltip(l.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.remove-layer-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.remove-layer-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/fills/"})).appendTo(this._toolbar),$("<button></button>").attr("data-action","add").attr("data-title",a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.add"))).append($("<span></span>").addClass("gravit-icon-plus")).append($("<span></span>").addClass("gravit-icon-touch-plus")).on("click",function(e){gDesigner.stats("fill_add_fill"),r.GEditor.tryRunTransaction(n._elements[0],(function(){const e=n._document&&n._document.getScene(),t=e&&e.getProperty("cm"),i=a.GColorHelper.convertColor(a.GRGBColor.BLACK,t||a.GColor.ColorModes.RGB);for(var o=0;o<n._elements.length;++o){var r=new a.GStylable.FillPaintLayer;r.setProperty("_pt",i),n._elements[o].getPaintLayers().appendChild(r)}}),a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.add"))),$(this._toolbar).gAccordion("toggleOpen",!0),$(this._toolbar).gAccordion("init",$(this._panel));const t=gDesigner.getRightSidebars().getSidebar(u.default.SidebarsIds.GInspectorSidebar);t.trigger(new d.default(d.default.Type.ChildAdded,t))}.bind(this)).gRichTooltip(l.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.add-layer-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.add-layer-tooltip-description")),learnMore:"https://documentation.designer.io/colors-gradients-textures/fills/"})).appendTo(this._toolbar),$("<div></div>").gPropertyRow({label:a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.fill-rule")),columns:[{width:"100%",content:i("evenodd")}]}).appendTo(this._advancedFillPanel),gDesigner.getWorkspace().getStyleEdManager().addEventListener(r.GStyleEdManager.EditorEvent,this._styleEditorEventHandler,this),this._panel.data("contextmenu",!0),this._panel.on("mouseenter",e=>{gDesigner.setMouseOverContext(m.FillPropertiesPanel,e,function(e){var t=this._panel.find(".copy-info-overlay").eq(0),n=this._panel.find(".fill-block.g-selected")||null,i=n&&n.position().top||0,o=$("<span/>").addClass("copy-info-overlay").css({top:i}).text(a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","text.copy-fill")));t&&t.remove(),this._panel.append(o),setTimeout(()=>{o.animate({opacity:0,top:"+=20"},500,o.remove)},1e3)}.bind(this)),this._panel.on("mousemove.check-context",e=>{var t=this._panel.outerHeight(),n=this._panel.offset();e.clientY>n.top+t-2&&(gDesigner.setMouseOverContext(null,null,null),this._panel.off("mousemove.check-context"))})}),this._panel.on("mouseleave",()=>{this._panel.off("mousemove.check-context"),gDesigner.setMouseOverContext(null,null,null)})},v.prototype.update=function(e,t,n){if(this._styleEditorChange)return this._styleEditorChange=!1,!0;if(this._ownChange)return!0;if(this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._document&&(this._document.getScene().removeEventListener(a.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().removeEventListener(a.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().removeEventListener(a.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null),this._elements=[],e){e.getEditor();for(var i=0;i<t.length;++i){var o=t[i],s=function(e,t){t.hasMixin(a.GStylable)&&t.getStylePropertySets().indexOf(a.GStylable.PropertySet.FillPaintLayers)>=0&&this._elements.push(t)}.bind(this),l=r.GElementEditor.getEditor(o);l&&l.getStylableParts()?a.GUtil.each(l.getStylableParts(),s):s(null,o)}if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(a.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().addEventListener(a.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().addEventListener(a.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(n),!0}return!1},v.prototype._styleEditorEventHandler=function(e){this._styleEdOn&&e.type==r.GStyleEdManager.EditorEventType.PrepareModifiedEvent&&(this._styleEditorChange=!0)},v.prototype._updateProperties=function(e){if(this._elements&&this._elements.length){var t=this._elements[0];this._panel.find(".fill-block").remove();var n=t.getPaintLayers().getFillLayers();a.GUtil.each(n,function(t,n){n&&this._insertPaintLayer(n,e)}.bind(this)),this._advancedFillPanel.find('[data-property="evenodd"]').prop("disabled",!t.hasProperty("evenodd")).val(t.getProperty("evenodd")?"1":"0"),this._updateToolbar()}else console.warn("GFillPaintLayerProperties: empty _elements array")},v.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},v.prototype._assignProperties=function(e,t,n){if(this._document){this._ownChange=!0;var i=this._document.getEditor();i.beginTransaction();try{for(var o=0;o<this._elements.length;++o)this._elements[o].setProperties(e,t)}finally{i.commitTransaction(n||a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.modify"))),this._ownChange=!1}}else console.warn("GFillPaintLayerProperties: empty _document property")},v.prototype._updateToolbar=function(){var e=this._panel.find(".fill-block").length>0;this._toolbar.toggleClass("empty-list",!e),this._toolbar.find("[data-action=settings]").css("display",e?"":"none"),this._toolbar.find("[data-action=remove]").css("display",e?"":"none")},v.prototype._insertPaintLayer=function(e,t){var n=this,i=!1,c=null,d=null,u=null,h=null,m=null,v=0,_=0,b=function(t,n,i,o){if(i)this._iterateEqualPaintLayer(e,(function(e){e.setProperties(t,n,!1,!1,!0)}));else{if(!this._document)return;var s=null;if(o){var l=e.getParent().getIndexOfChild(e);s=$.extend({fillLayerIndex:l},o)}this._ownChange=!0;var c=this._document.getEditor();c.beginTransaction();try{this._iterateEqualPaintLayer(e,(function(e,i){var o=r.GElementEditor.getEditor(i);o&&o.applyPropertiesToParts(t,n)||e.setProperties(t,n)}))}finally{c.commitTransaction(a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.change-properties")),s),this._ownChange=!1}}}.bind(this),w=function(e){if(c){var t=$(e).data("paintLayer");if(t&&(t!==c||o.GPlatform.modifiers.shiftKey))return c.getParent()===t.getParent()}return!1},C=$("<div/>").addClass("g-drop-indicator"),E=function(e){return"_bl"===e?$("<select></select>").gBlendMode().gRichTooltip(l.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GAppearanceProperties","text.blend-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GAppearanceProperties","text.blend-tooltip-description")),middle:!1,forceShow:!0,learnMore:s.LINKS.BLENDING_MODES_DOCUMENTATION_URL})).attr("data-property","_bl").on("change",(function(e){gDesigner.stats("fill_change_blend-mode",$(e.target).val()),b(["_bl"],[$(e.target).val()])})):"_op"===e?$("<input>").addClass("fill-op").attr("data-property","_op").attr("type","text").on("change",(function(e,t){gDesigner.stats("fill_change_opacity"),b(["_vs","_op"],[!0,(t||a.GLength.parseEquationValue($(this).gInputBox("value")))/100]),$(e.target).parents(".touch").find(".transparency").gInputSlider("value",a.GLength.parseEquationValue($(this).gInputBox("value")))})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"}):"_vs"===e?$("<span></span>").attr("data-property","_vs").addClass("fill-action fill-visibility gravit-icon-touch-show").attr("data-title",a.GLocale.get(new a.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){gDesigner.stats("fill_hide_show"),e.stopPropagation();var t=$(this).hasClass("gravit-icon-touch-hide");$(this).removeClass("gravit-icon-touch-"+(t?"hide":"show")),$(this).addClass("gravit-icon-touch-"+(t?"show":"hide")),b(["_vs"],[t])})):"_ra"===e?$("<div/>").addClass("transparency gravit-icon-touch-rectangle").gInputSlider({type:"range",min:0,max:100,step:1}).on("input",(function(e){var t=$(e.target),n=parseInt(t.gInputSlider("value"));t.parents(".touch").find(".fill-op").trigger("change",[n])})):void 0},S=$("<div></div>").addClass("fill-block").addClass("g-cursor-hand-open").attr("data-drag-mode",g.default.PRESS_AND_HOLD).data("paintLayer",e).attr("draggable","true").on("mousedown",(function(e){i=gDesigner.isTouchEnabled()&&e.originalEvent&&e.originalEvent.target?!!$(e.originalEvent.target).closest(".drag-indicator").length:$(e.target).hasClass("fill-block")||$(e.target).hasClass("gravit-icon-drag-indicator")||$(e.target).hasClass("columns")||$(e.target).hasClass("column"),$(e.target).closest(".fill-block").toggleClass("g-draggable-disabled",!i)})).on("dragstart",(function(e){if(!i)return e.preventDefault(),void e.stopPropagation();var t=$(e.target).closest(".fill-block"),s=t.offset(),l=e.originalEvent;(d=window.gDragImage()).addClass("drag-delete gravit-icon-trash"),h=n._panel.offset(),m=n._panel.outerHeight(),v=e.clientX-s.left,_=e.clientY-s.top,l.stopPropagation(),c=t.data("paintLayer"),l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain","dummy_data"),n._panel.find(".fill-block").each((function(e,t){$(t).append($("<div></div>").addClass("grid-drag-overlay").on("dragenter",(function(){var e=$(this.parentNode).data("paintLayer");if(w(this.parentNode)){if(c&&e&&c.getParent()===e.getParent()){var t=c.getParent(),n=t.getIndexOfChild(c),i=t.getIndexOfChild(e);n!==i&&(n<i?C.insertBefore(this.parentNode):C.insertAfter(this.parentNode))}}else C.remove()})).on("dragleave",(function(){w(this.parentNode)&&$(this).parent().find(".g-drop-indicator").remove()})).on("dragover",(function(e){var t=e.originalEvent;w(this.parentNode)&&(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move")})).on("drop",(function(e){var t=$(this.parentNode).closest(".fill-block").data("paintLayer");if(n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),c&&t&&c.getParent()===t.getParent()){var i=c.getParent(),s=i.getIndexOfChild(c),l=i.getIndexOfChild(t);r.GEditor.tryRunTransaction(i,(function(){if(o.GPlatform.modifiers.shiftKey){var e=c.clone();i.insertChild(e,s<l?t.getNext():t)}else s!==l&&(i.removeChild(c),i.insertChild(c,s<l?t.getNext():t))}),o.GPlatform.modifiers.shiftKey?a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.duplicate")):a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.move"))),n._updateProperties(),n._setSelectedPaintLayer(c)}c=null})))}))})).on("drag",(function(e){u=(0,p.handleDragForDeleteIcon)(e,d,h,m,v,_)})).on("dragend",(function(e){var t=e.originalEvent,i=$(e.target).closest(".fill-block").closest(".fill-block").data("paintLayer");if(n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),c&&i&&c.getParent()===i.getParent()){var s=c.getParent(),l=s.getIndexOfChild(c),p=s.getIndexOfChild(i);r.GEditor.tryRunTransaction(s,(function(){if(o.GPlatform.modifiers.shiftKey){var e=c.clone();s.insertChild(e,l<p?i.getNext():i)}else l!==p&&(s.removeChild(c),s.insertChild(c,l<p?i.getNext():i.getPrevious()))}),o.GPlatform.modifiers.shiftKey?a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.duplicate")):a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.move"))),n._updateProperties(),n._setSelectedPaintLayer(c)}c&&u&&r.GEditor.tryRunTransaction(n._elements[0],(function(){var e=[];n._iterateEqualPaintLayer(c,(function(t){e.push(t)})),a.GUtil.each(e,(function(e,t){t.getParent().removeChild(t)}))}),a.GLocale.get(new a.GLocaleKey("GFillPaintLayerProperties","action.remove"))),d&&d.css("display","none"),d=null,t.stopPropagation(),c=null})).on("click",(function(){n._setSelectedPaintLayer(e)})).gPropertyRow({columns:[{clazz:"drag-indicator",content:$("<div></div>").addClass("gravit-icon-drag-indicator g-cursor-hand-open gravit-icon-touch-drag-indicator")},{width:"40px",clazz:"color-preview",content:$("<div></div>").attr("data-property","_pt").gPatternChooser({types:[a.GColor,a.GLinearGradient,a.GRadialGradient,a.GAngularGradient,a.GBackground,a.GTexturePattern,a.GNoisePattern],hasMask:!0}).on("chooseropen",(function(){n._document.getEditor().hideSelection(),gDesigner.getWorkspace().getStyleEdManager().updateEditor(e,"_pt",!1),n._setSelectedPaintLayer(e),n._styleEdOn=!0,n._chooserElem=$(this)})).on("chooserclose",(function(e,t,i){if(gDesigner.getWorkspace().getStyleEdManager().getOverlayLock(i))t();else if(n._styleEdOn=!1,gDesigner.getWorkspace().getStyleEdManager().deactivateEditor(),n._document&&(n._document.getEditor().resetHideSelection(),n._document.hasCDR())){var o=gPatternChooser.getPattern();!o||o instanceof a.GRGBColor||y.showCDRUnsupportedObjectWarning()}n._chooserElem=null})).on("patternchange",(function(e,t,n,i,o,r){var a=["_vs"],s=[!0];void 0!==t&&(a.push("_pt"),s.push(t)),"number"==typeof n&&(a.push("_op"),s.push(n));var l=null;o&&(l={chooserOn:!0},null!=r&&(l.activeStopIdx=r)),b(a,s,i,l)}))},{width:"auto",content:$("<select></select>").addClass("normal").gBlendMode().gRichTooltip(l.GRichTooltipConfig.from({title:a.GLocale.get(new a.GLocaleKey("GAppearanceProperties","text.blend-tooltip-title")),description:a.GLocale.get(new a.GLocaleKey("GAppearanceProperties","text.blend-tooltip-description")),middle:!1,forceShow:!0,learnMore:s.LINKS.BLENDING_MODES_DOCUMENTATION_URL})).attr("data-property","_bl").on("change",(function(e){gDesigner.stats("fill_change_blend-mode",$(e.target).val()),b(["_bl"],[$(e.target).val()])}))},{width:"45px",content:$("<input>").addClass("normal").attr("data-property","_op").attr("type","text").on("change",(function(e){gDesigner.stats("fill_change_opacity"),b(["_vs","_op"],[!0,a.GLength.parseEquationValue($(this).gInputBox("value"))/100])})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"})},{width:"20px",content:$("<span></span>").attr("data-property","_vs").addClass("fill-action fill-visibility gravit-icon-display normal").attr("data-title",a.GLocale.get(new a.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){gDesigner.stats("fill_hide_show"),e.stopPropagation();var t=$(this).hasClass("gravit-icon-hide");$(this).removeClass("gravit-icon-"+(t?"hide":"display")),$(this).addClass("gravit-icon-"+(t?"display":"hide")),b(["_vs"],[t])}))},{width:"auto",content:$("<div/>").addClass("touch").gPropertyRow({columns:[{width:"auto",content:E("_bl")},{width:"60px",content:E("_vs")}]}).gPropertyRow({columns:[{width:"auto",content:E("_ra")},{width:"60px",content:E("_op")}]})}]}).prependTo(this._panel);S.find(".columns").addClass("g-cursor-hand-open"),S.find(".column").addClass("g-cursor-hand-open"),S.find(".touch").parents(".column").addClass("g-touch"),S.find(".normal").parents(".column").addClass("g-normal"),S.find('[data-property="_pt"]').parents(".column").addClass("g-color"),S.find(".transparency").parents(".touch div:last-child>div").addClass("g-transparency"),S.find(".touch").find("select").addClass("g-select").parent().append($("<span/>").addClass("gravit-icon-touch-arrowDown")),S.contextmenu({context:f.FillPropertyPanel},(function(e){e.preventDefault();var t=$(this).data("paintLayer");n._setSelectedPaintLayer(t),$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",{previousEvent:e,data:{paintLayer:t}})})),this._setSelectedPaintLayer(e),this._updatePaintLayer(e,t),S.find(".transparency").each((function(e,t){$(t).gInputSlider("value",parseInt($(this).parents(".touch").find(".fill-op").val()))}))},v.prototype.openPatternChooser=function(){this._panel.find(".fill-block:first-child").find('[data-property="_pt"]').find(".g-button").click()},v.prototype.openEyeDropper=function(e,t){this._panel.find(".fill-block:first-child").find('[data-property="_pt"]').gPatternChooser("openEyeDropper",e,t)},v.prototype._setSelectedPaintLayer=function(e){this._panel.find(".fill-block").each((function(t,n){var i=$(n);i.toggleClass("g-selected",i.data("paintLayer")===e)})),this._document&&this._document.updateActiveStylesList("Fill",e)},v.prototype._getSelectedPaintLayer=function(){return this._panel.find(".fill-block.g-selected").data("paintLayer")},v.prototype._removePaintLayer=function(e){this._panel.find(".fill-block").each((function(t,n){var i=$(n);if(i.data("paintLayer")===e)return i.remove(),!1}))},v.prototype._updatePaintLayer=function(e,t){e&&this._panel.find(".fill-block").each((function(n,i){var o=$(i);if(o.data("paintLayer")===e){o.find('[data-property="_pt"]').gPatternChooser("setPattern",e.getProperty("_pt",!1,!1,!0)).gPatternChooser("value",e.getProperty("_pt",!1,!1,!0)).gPatternChooser("opacity",e.getProperty("_op",!1,!1,!0)),o.find('[data-property="_op"]').each((function(t,n){$(n).gInputBox("value",a.GUtil.formatOpacity(100*e.getProperty("_op",!1,!1,!0)))})),o.find('[data-property="_bl"]').val(e.getProperty("_bl"));var s=e.getProperty("_vs");if(o.find('[data-property="_vs"]').removeClass("gravit-icon-"+(s?"hide":"display")).addClass("gravit-icon-"+(s?"display":"hide")),t&&(t.evtType==r.GEditor.ModifiedEvent.Type.Undo||t.evtType==r.GEditor.ModifiedEvent.Type.Redo)&&t.chooserOn&&null!=t.fillLayerIndex)e.getParent().getIndexOfChild(e)==t.fillLayerIndex&&o.find(".preview").trigger("click",null!=t.activeStopIdx?t.activeStopIdx:null)}}))},v.prototype._afterInsert=function(e){e.node instanceof a.GStylable.FillPaintLayer&&e.node.getOwnerStylable()===this._elements[0]&&(this._insertPaintLayer(e.node),this._updateToolbar())},v.prototype._beforeRemove=function(e){if(e.node instanceof a.GStylable.FillPaintLayer&&e.node.getOwnerStylable()===this._elements[0]){this._removePaintLayer(e.node);for(var t=e.node.getPrevious();t&&!(t instanceof a.GStylable.FillPaintLayer);)t=t.getPrevious();if(!(t instanceof a.GStylable.FillPaintLayer))for(t=e.node.getNext();t&&!(t instanceof a.GStylable.FillPaintLayer);)t=t.getNext();this._setSelectedPaintLayer(t),this._updateToolbar()}},v.prototype._afterPropertiesChange=function(e){e.node instanceof a.GStylable.FillPaintLayer&&e.node.getOwnerStylable()===this._elements[0]&&this._updatePaintLayer(e.node)},v.prototype._iterateEqualPaintLayer=function(e,t){if(e)for(var n=e.getParent().getIndexOfChild(e),i=0;i<this._elements.length;++i){var o=this._elements[i].getPaintLayers();a.GUtil.each(o.getFillLayers(),function(r,a){(a&&a===e||a.constructor===e.constructor&&o.getIndexOfChild(a)===n)&&t(a,this._elements[i])}.bind(this))}},e.exports=v},function(e,t,n){"use strict";var i=n(17);n(297),n(3),n(83),n(774),n(168),n(45);var o=n(43),r=n(1),a=n(16),s=n(56),l=i(n(309)),c=i(n(720)),d=n(1049),u=i(n(509)),p=n(108),g=n(1147),h=n(1398),f=n(403);const m=n(549),{SidebarsIds:y}=n(193);var v=null,_=null,b=null,w=null,C=null,E=null,S=null;function G(){this._elements=[],v=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.most-used")),_=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.blur")),b=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.artistic")),w=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.adjust")),C=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.distortion")),E=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.other")),S=r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.shadow")),H||(H=V())}r.GObject.inherit(G,p),G.EngCat=e=>e===v?"MostUsed":e===_?"Blur":e===b?"Artistic":e===w?"Adjust":e===C?"Distortion":e===E?"Other":"Shadow",G.prototype._panel=null,G.prototype._toolbar=null,G.prototype._document=null,G.prototype._elements=null,G.prototype._addEffectMenu=null,G.prototype._effectsPanel=null,G.prototype._disableFx=null,G.prototype._defaultEffects=[r.GDropShadowEffect,r.GInnerShadowEffect,r.GBlurEffect,r.GGLColorAdjustEffect],G.prototype._styleEditorChange=!1,G.prototype._styleEdOn=!1,G.prototype._ownChange=!1,G.prototype._chooserElem=null,G.prototype.init=function(e,t){this._toolbar=t.addClass("list-toolbar effects-toolbar"),this._createAddEffectMenu(),this._panel=e.addClass("effects-properties-panel"),this.setTouchTools([new l.default({id:"effect",icon:"gravit-icon-touch-effect-panel",panel:this._panel,toolbar:this._toolbar,panelWidth:"368px"})]);var n=this;$("<label></label>").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","title"))).appendTo(this._toolbar),this._toolbar.append($("<button></button>").append($("<span></span>").addClass("gravit-icon-plus")).append($("<span></span>").addClass("gravit-icon-touch-plus")).on("click",(function(){gDesigner.stats("effects_open_effectsmenu","main"),n._openEffectsMenu(this)})).gRichTooltip(s.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.add-effect-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.add-effect-tooltip-description")),learnMore:"https://documentation.designer.io/effects/"}))),this._effectsPanel=$("<div></div>").addClass("effects-panel").append($("<div></div>").addClass("effects")).appendTo(this._panel);for(var i=function(e,t){var i=e;(function(){gDesigner.stats("effects_add_effectsmenu",e&&r.GLocale.getValue(t&&t.i18n||e,"name","unknown",0)||"unkn"),o.GEditor.tryRunTransaction(this._elements[0],function(){for(var e=0;e<this._elements.length;++e){var t=new i;this._validateInsertation(this._elements[e].getEffects(),t)&&this._elements[e].getEffects().appendChild(t),n._addEffectMenu.close();const o=gDesigner.getRightSidebars().getSidebar(y.GInspectorSidebar);o.trigger(new c.default(c.default.Type.ChildAdded,o))}}.bind(this),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.add")))}).bind(this)()}.bind(this),a=0;a<H.length;++a){var d=H[a];$.inArray(d.clazz,this._defaultEffects)>-1&&this._createDefaultEffect(!1,d,i)}this._createDefaultEffect(!0),gDesigner.getWorkspace().getStyleEdManager().addEventListener(o.GStyleEdManager.EditorEvent,this._styleEditorEventHandler,this),this._panel.data("contextmenu",!0)},G.prototype._openEffectsMenu=function(e){this._addEffectMenu.open(e)},G.prototype.update=function(e,t,n){if(this._styleEditorChange)return this._styleEditorChange=!1,!0;if(this._ownChange)return!0;if(this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._document&&(this._document.getScene().removeEventListener(r.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().removeEventListener(r.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null,this._elements=null,this._invalidateEffects()),this._elements=[],e&&t&&t.length){for(var i=0;i<t.length;++i)t[i].hasMixin(r.GStylable)&&t[i].getStylePropertySets().indexOf(r.GStylable.PropertySet.Effects)>=0&&this._elements.push(t[i]);if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(r.GNode.AfterInsertEvent,this._afterInsert,this),this._document.getScene().addEventListener(r.GNode.BeforeRemoveEvent,this._beforeRemove,this),this._document.getScene().addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._invalidateEffects(n),!0}return!1},G.prototype._styleEditorEventHandler=function(e){this._styleEdOn&&e.type==o.GStyleEdManager.EditorEventType.PrepareModifiedEvent&&(this._styleEditorChange=!0)},G.prototype._afterInsert=function(e){e.node instanceof r.GStylable.Effect&&e.node.getOwnerStylable()===this._elements[0]&&(this._insertEffect(e.node),this._updateToolbar())},G.prototype._beforeRemove=function(e){e.node instanceof r.GStylable.Effect&&e.node.getOwnerStylable()===this._elements[0]&&(this._removeEffect(e.node),this._updateToolbar())},G.prototype._afterPropertiesChange=function(e){(!e.temporary||e.node instanceof r.GOverlayEffect)&&e.node instanceof r.GStylable.Effect&&e.node.getOwnerStylable()===this._elements[0]&&this._updateEffect(e.node)},G.prototype._iterateEqualEffects=function(e,t,n){for(var i=e.getOwnerStylable(),o=e.getParent().getIndexOfChild(e),a=0;a<this._elements.length;++a)if(!i||this._elements[a]!==i||n)for(var s=this._elements[a].getEffects(),l=s.getFirstChild();null!==l;l=l.getNext())(l!==e||n)&&(r.GUtil.equals(l,e)&&!n||l.constructor===e.constructor&&s.getIndexOfChild(l)===o)&&t(l)},G.prototype._insertEffect=function(e,t){var n=this,i=null,s=null,l=null,p=0,g=0,h=null,v=function(){o.GEditor.tryRunTransaction(e,function(){this._iterateEqualEffects(e,(function(t){t.setProperty("cl",!e.getProperty("cl"))})),e.setProperty("cl",!e.getProperty("cl"))}.bind(this),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.toggle-collapse")))}.bind(this),_=function(t){t.stopPropagation(),o.GEditor.tryRunTransaction(e,function(){this._iterateEqualEffects(e,(function(t){t.setProperty("vs",!e.getProperty("vs"))})),e.setProperty("vs",!e.getProperty("vs"))}.bind(this),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.toggle-visibility")))}.bind(this),b=function(t){var n=H.find(t=>e instanceof t.clazz);gDesigner.stats("effects_delete_effect",r.GLocale.getValue(n&&n.i18n||e,"name",e.getNodeName(),666)),t.stopPropagation(),o.GEditor.tryRunTransaction(e,function(){this._iterateEqualEffects(e,(function(e){e.getParent().removeChild(e)})),e.getParent().removeChild(e),gDesigner.setMouseOverContext(null)}.bind(this),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.remove")));const i=gDesigner.getRightSidebars().getSidebar(y.GInspectorSidebar);i.trigger(new c.default(c.default.Type.ChildRemoved,i))}.bind(this),w=null,C=e.getPrevious();C&&this._effectsPanel.find(".effect-block").each((function(e,t){var n=$(t);if(n.data("effect")===C)return w=n,!1}));var E=U(e),S=$("<div/>").addClass("g-drop-indicator"),G=$("<div></div>").addClass("effect-header").addClass("g-cursor-hand-open"),L=$("<div></div>").addClass("effect-block").attr("data-drag-mode",u.default.PRESS_AND_HOLD).data("effect",e).attr("draggable","true").on("mousedown",(function(e){A=$(e.target).hasClass("effect-title")||$(e.target).hasClass("gravit-icon-drag-indicator")||$(e.target).hasClass("effect-header"),$(e.target).closest(".effect-block").toggleClass("g-draggable-disabled",!A)})).on("click",(function(e){var t=$(e.target).parents(".effect-block");t.children().addClass("selected"),t.siblings().children().removeClass("selected")})).on("mousedown",e=>{h=e.originalEvent.target}).on("dragstart",(function(e){var t=h||e.target;if(!A||gDesigner.isTouchEnabled()&&!$(t).closest(".effect-header").length)return e.preventDefault(),void e.stopPropagation();var c=$(e.target).closest(".effect-block"),d=c.offset(),u=e.originalEvent;(i=gDragImage()).addClass("drag-delete gravit-icon-trash"),s=n._panel.offset(),l=n._effectsPanel.outerHeight(),p=e.clientX-d.left,g=e.clientY-d.top,u.stopPropagation(),T=c.data("effect"),u.dataTransfer.effectAllowed="move",u.dataTransfer.setData("text/plain","dummy_data"),n._effectsPanel.find(".effect-block").each((function(e,t){$(t).append($("<div></div>").addClass("grid-drag-overlay").on("dragenter",(function(){var e=$(this.parentNode).data("effect");if(P(this.parentNode)){if(u.preventDefault(),u.stopPropagation(),u.dataTransfer.dropEffect="move",T&&e&&T.getParent()===e.getParent()){var t=T.getParent(),n=t.getIndexOfChild(T),i=t.getIndexOfChild(e);n!==i&&(n<i?S.insertBefore(this.parentNode):S.insertAfter(this.parentNode))}}else S.remove()})).on("dragleave",(function(){P(this.parentNode)&&$(this).parent().find(".g-drop-indicator").remove()})).on("dragover",(function(e){var t=e.originalEvent;P(this.parentNode)&&(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move")})).on("drop",(function(e){var t=$(this.parentNode).closest(".effect-block").data("effect");if(n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),T&&t&&T.getParent()===t.getParent()){var i=T.getParent(),s=i.getIndexOfChild(T),l=i.getIndexOfChild(t);o.GEditor.tryRunTransaction(i,(function(){if(a.GPlatform.modifiers.shiftKey){var e=T.clone();i.insertChild(e,s<l?t.getNext():t)}else s!==l&&(i.removeChild(T),i.insertChild(T,s<l?t.getNext():t))}),a.GPlatform.modifiers.shiftKey?r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.duplicate")):r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.move")))}T=null})))}))})).on("drag",(function(e){(0,d.handleDragForDeleteIcon)(e,i,s,l,p,g)})).on("dragend",(function(e){var t=e.originalEvent;$(e.target).closest(".effect-block");n._panel.find(".g-drop-indicator").remove(),n._panel.find(".grid-drag-overlay").remove(),i&&i.css("display","none"),i=null,t.stopPropagation(),T&&o.GEditor.tryRunTransaction(n._elements[0],(function(){var e=[];n._iterateEqualEffects(T,(function(t){e.push(t)}),!0),r.GUtil.each(e,(function(e,t){t.getParent().removeChild(t)}))}),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.remove")))})).append(G.append($("<div></div>").addClass("gravit-icon-drag-indicator g-cursor-hand-open gravit-icon-touch-drag-indicator")).append($("<div></div>").addClass("effect-title g-cursor-hand-open").append($("<label></label>").append($("<span></span>").text(e.getNodeNameTranslated())))).append($("<div></div>").addClass("effect-icon effect-visibility normal").on("click",(function(e){e.stopPropagation();var t=$(this).find("span").hasClass("gravit-icon-hide");gDesigner.stats("effects_toggle_visibility",t?"hidden":"visible"),$(this).find("span").removeClass("gravit-icon-"+(t?"hide":"display")),$(this).find("span").addClass("gravit-icon-"+(t?"display":"hide")),_(e)})).append($("<span></span>").addClass("gravit-icon-"+(e.getProperty("vs")?"display":"hide")))).append($("<div></div>").addClass("effect-icon effect-delete normal").attr("data-title",r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.remove"))).on("click",b).append($("<span></span>").addClass("gravit-icon-trash"))).append($("<div></div>").addClass("effect-icon effect-setting touch").attr("data-action","stroke-settings").append($("<span></span>").addClass("gravit-icon-touch-settings")).on("click",function(e){e.data={context:f.EffectPropertyPanel},L.trigger("contextmenu",[e])}.bind(this))).append($("<div></div>").addClass("effect-icon effect-delete touch").attr("data-title",r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.remove"))).on("click",b).append($("<span></span>").addClass("gravit-icon-touch-trash"))).append($("<div></div>").addClass("effect-icon effect-visibility touch").on("click",(function(e){e.stopPropagation();var t=$(this).find("span").hasClass("gravit-icon-touch-hide");gDesigner.stats("effects_toggle_visibility",t?"hidden":"visible"),$(this).find("span").removeClass("gravit-icon-touch-"+(t?"hide":"show")),$(this).find("span").addClass("gravit-icon-touch-"+(t?"show":"hide")),_(e)})).append($("<span></span>").addClass("gravit-icon-touch-"+(e.getProperty("vs")?"show":"hide")))));if(E.createSettings){var D=function(t,n,i,o){if(i)this._iterateEqualEffects(e,(function(e){e.setProperties(t,n,!1,!1,!0)})),e.setProperties(t,n,!1,!1,!0);else{if(!this._document)return;gDesigner.stats("effects_assign_effectproperty",r.GLocale.getValue(E.i18n,"name",e.getNodeName(),666));var a=null;if(o){var s=e.getParent().getIndexOfChild(e);a=$.extend({effectIndex:s},o)}this._ownChange=!0;var l=this._document.getEditor();l.beginTransaction();try{this._iterateEqualEffects(e,(function(e){e.setProperties(t,n)})),e.setProperties(t,n)}finally{l.commitTransaction(r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.change-properties")),a),this._ownChange=!1}}}.bind(this),x=E.createSettings.call(this,e,D);if(x){var I=$("<div></div>").addClass("effect-settings");x.addClass("content"),L.append(I.append(x))}}w&&w.length>0?L.insertBefore(w):L.appendTo(this._effectsPanel.find(".effects")),G.gAccordion("init",".effect-settings:last","label").on("change",(function(){gDesigner.stats("effects_toggle_collapse"),v()})),L.contextmenu({context:f.EffectPropertyPanel},(function(e,t){(e=t||e).preventDefault();var n=$(this).data("effect");$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",{previousEvent:e,data:{effect:n}})})),L.on("mouseenter",t=>{this._document&&this._document.updateActiveStylesList("Effect",e),gDesigner.setMouseOverContext(m.EffectPropertiesPanel,t,function(e){var t=this._panel.find(".copy-info-overlay").eq(0),n=e&&$(e.target).closest(".effect-block"),i=n&&n.height()||0,o=n&&n.position().top||0,a=i?o+i/2:o,s=$("<span/>").addClass("copy-info-overlay").css({top:a}).text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.copy-effect")));t&&t.remove(),this._panel.append(s),setTimeout(()=>{s.animate({opacity:0,top:"+=20"},500,s.remove)},1e3)}.bind(this)),this._panel.on("mousemove.check-context",e=>{var t=this._panel.outerHeight(),n=this._panel.offset();e.clientY>n.top+t-2&&(gDesigner.setMouseOverContext(null,null,null),this._panel.off("mousemove.check-context"))})}),L.on("mouseleave",()=>{this._panel.off("mousemove.check-context"),this._document&&this._document.updateActiveStylesList("Effect",null),gDesigner.setMouseOverContext(null,null,null)}),this._updateEffect(e,t)},G.prototype._updateEffect=function(e,t){this._effectsPanel.find(".effect-block").each((function(n,i){var a=$(i);if(a.data("effect")===e){U(e);if(e instanceof r.GOverlayEffect||e instanceof r.GDropShadowEffect||e instanceof r.GInnerShadowEffect||e instanceof r.GCurvedShadowEffect||e instanceof r.GContactShadowEffect||e instanceof r.GLongShadowEffect)if(a.find('[data-property="pat"]').gPatternChooser("setPattern",e.getProperty("pat",!1,!1,!0)).gPatternChooser("value",e.getProperty("pat",!1,!1,!0)).gPatternChooser("opacity",e.getProperty("opc",!1,!1,!0)),a.find('[data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*e.getProperty("opc",!1,!1,!0))),t&&(t.evtType==o.GEditor.ModifiedEvent.Type.Undo||t.evtType==o.GEditor.ModifiedEvent.Type.Redo)&&t.chooserOn&&null!=t.effectIndex)e.getParent().getIndexOfChild(e)==t.effectIndex&&a.find('[data-property="pat"]').find(".preview").trigger("click",null!=t.activeStopIdx?t.activeStopIdx:null);var s=e.getProperty("vs"),l=e.getProperty("ly"),c=e.getProperty("cl");a.toggleClass("g-selected",e.hasFlag(r.GNode.Flag.Selected)),a.find(".effect-title input[type=checkbox]").prop("checked",s),a.find(".effect-header").gAccordion("toggleOpen",!c);var d=a.find(".effect-settings");if(d.css("display",c?"none":""),e instanceof r.GBlurEffect&&d.find('[data-property="r"]:not(.g-input-slider)').gUnitBox("value",new r.GLength(e.getProperty("r"))),e instanceof r.GWebGLEffect){var u=e.getProperty("shp");for(var p in u){var g=u[p];if("number"==typeof g){var h=d.find("[data-property="+p+"]:not(.g-input-slider)");h.gUnitBox("options").hasOwnProperty("unit")&&h.gUnitBox("value",new r.GLength(g,r.GLength.Unit.PT))}}}return e instanceof r.GDropShadowEffect&&(d.find('[data-property="r"]').gUnitBox("value",new r.GLength(e.getProperty("r"))),d.find('[data-property="x"]').gUnitBox("value",new r.GLength(e.getProperty("x"))),d.find('[data-property="y"]').gUnitBox("value",new r.GLength(e.getProperty("y")))),a.find(".effect-layer").attr("data-title",r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.applies-to"))+" "+r.GLocale.get(r.GStylable.StyleLayerName[l||""])).find("> span").toggleClass("gravit-icon-circle",!l).toggleClass("gravit-icon-fill",l===r.GStylable.StyleLayer.Fill).toggleClass("gravit-icon-stroke",l===r.GStylable.StyleLayer.Border),!1}}))},G.prototype._removeEffect=function(e){this._effectsPanel.find(".effect-block").each((function(t,n){var i=$(n);if(i.data("effect")===e)return i.remove(),!1}))},G.prototype._invalidateEffects=function(e){if(this._effectsPanel.find(".effects").empty(),this._elements&&this._elements.length)for(var t=this._elements[0].getEffects().getFirstChild();null!==t;t=t.getNext())t instanceof r.GStylable.Effect&&this._insertEffect(t,e);this._updateToolbar()},G.prototype._createAddEffectMenu=function(){this._addEffectMenu=new h(G.EngCat);var e=this._addEffectMenu,t=e.createSelector(),n=this,i=function(e,t){var i=e;this._elements[0].getScene();(function(){gDesigner.stats("effects_add_panelbutton",e&&r.GLocale.getValue(t&&t.i18n||e,"name","unknown",0)||"unkn"),o.GEditor.tryRunTransaction(this._elements[0],function(){for(var e=0;e<this._elements.length;++e){var t=new i;this._validateInsertation(this._elements[e].getEffects(),t)&&this._elements[e].getEffects().appendChild(t),n._addEffectMenu.close()}}.bind(this),r.GLocale.get(new r.GLocaleKey("GEffectProperties","action.add"))),$(this._toolbar).gAccordion("toggleOpen",!0),$(this._toolbar).gAccordion("init",$(this._panel));const a=gDesigner.getRightSidebars().getSidebar(y.GInspectorSidebar);a.trigger(new c.default(c.default.Type.ChildAdded,a))}).bind(this)()}.bind(this),a={};a[v]=new Array;var s=$("<option></option>").attr({value:v}).append(v);t.append(s);for(var l=[],d=0;d<H.length;++d){var u=H[d];if(!u.hidden){u.cb=i;var p=u.mostUsed,g=u.category;if(g){if(!a[g]){a[g]=new Array;s=$("<option></option>").attr({value:g}).append(g);l.push(s)}a[g].push(u)}p&&a[v].push(u)}}l.sort((function(e,t){return $(e).attr("value")===r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.other"))||$(e).attr("value")>$(t).attr("value")?1:$(t).attr("value")===r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.other"))||$(t).attr("value")>$(e).attr("value")?-1:0}));for(d=0;d<l.length;++d)t.append(l[d]);t.on("change",(function(t){gDesigner.stats("effects_choose_type",G.EngCat(this.value)),e.addItems(a[this.value])})),e.addItems(a[v])},G.prototype._validateInsertation=function(e,t){if(t.isSingleton())for(var n=r.GObject.getTypeId(t),i=e.getFirstChild();null!==i;i=i.getNext())if(r.GObject.getTypeId(i)===n)return!1;return!0},G.prototype._createDefaultEffect=function(e,t,n){var i=function(i){e?(gDesigner.stats("effects_open_effectsmenu","more"),this._openEffectsMenu(i)):n(t.clazz,t)}.bind(this),o=$("<span></span>").text(e?r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.more")):r.GLocale.getValue(t.i18n,"name")).addClass("effects-default-label"),a=$("<span>+</span>");$("<div></div>").addClass("effects-default").append(o).append(a).on("click",(function(){i(this)})).appendTo(this._panel)},G.prototype._updateToolbar=function(){var e=this._panel.find(".effect-block").length>0||this._panel.find(".effects-default").length>0;this._toolbar.toggleClass("empty-list",!e)},G.prototype.toString=function(){return"[Object GEffectProperties]"};var A=!1,T=null;function P(e){if(T){var t=$(e).data("effect");if(t&&(t!==T||a.GPlatform.modifiers.shiftKey))return T.getParent()===t.getParent()}return!1}function L(e,t,n){var i=n||e,o=i.getProperty.bind(i),a=(this._document.getScene(),this._document.getEditor()),s=o("shp"),l=r.GNode.getClassFromId(r.GObject.getTypeId(i)).RANGES||fxRanges,c=this,d=$("<div></div>");for(var u in s){var p=s[u];if(-1!==["contrast","brightness","hue","saturation"].indexOf(u)){var h=l[u],f=100*p;isNaN(f)||(f=r.GUtil.formatNumber(f,0));var m=100*h[0],y=100*h[1],v=g.DefaultStops.Hue;if("hue"===u)i instanceof r.GGLRecolourEffect?(m=0,y=360):(m=-180,y=180),v=g.DefaultStops.Hue,f=r.GMath.normalizeValue(p,h[0],h[1],m,y);else if(-1!==["contrast","brightness"].indexOf(u))v=g.DefaultStops.Luminosity;else if("saturation"===u&&(v=g.DefaultStops.Saturation(0),i instanceof r.GGLRecolourEffect)){var _=r.GMath.normalizeValue(s.hue,h[0],h[1],0,360);v=g.DefaultStops.Saturation(_)}var b=function(e,t,n){if("hue"===t&&i instanceof r.GGLRecolourEffect){var o=$(n).closest(".effect-settings").find('.g-input-slider[data-property="saturation"]'),a=o.gColorSlider("value");o.empty().gColorSlider({min:100*h[0],max:100*h[1],stops:g.DefaultStops.Saturation(e)}).gColorSlider("value",a).trigger("input")}};$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect",u)),columns:[{width:"75%",content:$("<div>").attr("data-property",u).gColorSlider({min:m,max:y,stops:v,maxDecimal:0}).gColorSlider("value",f).on("input",(function(e){var n=$(e.target).data().property,i=$(e.target).gColorSlider("value"),a=i,s=$(e.target).gColorSlider("minValue"),l=$(e.target).gColorSlider("maxValue");i=r.GMath.normalizeValue(i,s,l,h[0],h[1]),b(a,n,e.target);var c=o("shp");if(c[n]!==i){var d=JSON.parse(JSON.stringify(c));d[n]=i,t(["shp"],[d])}$(e.target).closest(".effect-settings").find("[data-property="+n+"]:not(.g-input-slider)").val(a).trigger("change")}))},{width:"40px",content:$("<input>").attr("type","text").attr("data-property",u).val(f).on("change",(function(e){var n=$(e.target).data().property,a=Number(i.propertyInverseTransform(n,parseFloat($(e.target).gInputBox("value"))).toFixed(3)),s=o("shp"),l=$(this).parents(".effect-settings").find(".g-input-slider[data-property="+n+"]");l.gColorSlider("value")!=a&&l.gColorSlider("value",a),b(a,n,e.target);var c=l.gColorSlider("minValue"),d=l.gColorSlider("maxValue");if(a=r.GMath.normalizeValue(a,c,d,h[0],h[1]),s&&s[n]!==a){var u=JSON.parse(JSON.stringify(s));u[n]=a,t(["shp"],[u])}})).gInputBox({minValue:m,maxValue:y,postfix:"hue"===u?"°":"%",incrementValue:1})}]}).appendTo(d)}else if("number"==typeof p){f=new r.GLength(p,r.GLength.Unit.PT);h=l[u];$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect",u)),columns:[{width:"75%",content:$("<div/>").gInputSlider({min:h[0],max:h[1],step:.002*Math.abs(h[1]-h[0])}).attr("data-property",u).on("mousedown",(function(){a.hideSelection(),$(document).one("mouseup",(function(){a.resetHideSelection()}))})).gInputSlider("value",Number(i.propertyInverseTransform(u,p).toFixed(3))).on("input",(function(e){var n=$(e.target),a=n.data().property,s=r.GLength.parseEquation($(this).gInputSlider("value")),l=0;s&&(l=s.toPoint()),l=Number(i.propertyTransform(a,l).toFixed(3));var c=o("shp");if(null!==l&&"number"==typeof l&&c[a]!==l){var d=JSON.parse(JSON.stringify(c));d[a]=l,t(["shp"],[d],!0)}n.closest(".effect-settings").find("[data-property="+a+"]:not(.g-input-slider)").val(l).trigger("change")})).on("change",(function(e){var t=$(e.target),n=t.data().property,o=r.GLength.parseEquation($(this).gInputSlider("value")),a=0;o&&(a=o.toPoint()),a=Number(i.propertyTransform(n,a).toFixed(3)),t.closest(".effect-settings").find("[data-property="+n+"]:not(.g-input-slider)").val(a).trigger("change")}))},{width:"40px",content:$("<input>").attr("data-property",u).on("change",(function(e){var n=$(e.target).data().property,r=$(this).gUnitBox("value"),a=0;r&&(a=r.toPoint());var s=Number(i.propertyInverseTransform(n,a).toFixed(3)),l=o("shp"),c=$(this).parents(".effect-settings").find("[data-property="+n+"].g-input-slider");if(c.gInputSlider("value")!=s&&c.gInputSlider("value",s),null!==a&&"number"==typeof a&&l[n]!==a){var d=JSON.parse(JSON.stringify(l));d[n]=a,t(["shp"],[d])}})).gUnitBox({minValue:h[0],maxValue:h[1],incrementValue:.002*Math.abs(h[1]-h[0]),source:"effects"}).gUnitBox("value",f)}]}).appendTo(d)}else if(p instanceof Array&&3===p.length){var w=void 0,C=[r.GColor];s.opacity&&"object"==typeof s.opacity&&"opacity"===s.opacity.type&&(w=s.opacity.value,C.push()),$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect",u)),columns:[{width:"50px",content:$("<div></div>").gPatternChooser({types:C}).gPatternChooser("value",new r.GRGBColor(p)).gPatternChooser("opacity",w).on("chooseropen",(function(){c._document.getEditor().hideSelection(),c._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){c._document&&c._document.getEditor().resetHideSelection(),c._chooserElem=null})).on("patternchange",(function(e,n,i,r,a){var s=o("shp"),l=JSON.parse(JSON.stringify(s));void 0!==n&&(l.color=n.getValue()),"number"==typeof i&&s.opacity&&"object"==typeof s.opacity&&"opacity"===s.opacity.type&&(l.opacity.value=i);var c=null;a&&(c={chooserOn:!0}),t(["shp"],[l],r,c)}))}]}).appendTo(d)}else if("object"==typeof p&&"dropdown"===p.type){h=l[u];for(var E=$("<select></select>").attr("data-property",u).on("change",(function(e){var n=$(e.target).data().property,i=$(e.target).val(),r=o("shp");if(r&&(!r[n]||r[n].value!==i)){var a=JSON.parse(JSON.stringify(r));a[n].value=i,t(["shp"],[a])}})),S=0;S<h.length;S++)$("<option></option>").attr("value",S).text(h[S]instanceof r.GLocaleKey?r.GLocale.get(h[S]):h[S]).appendTo(E);E.val(p.value),$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect",u)),columns:[{width:"100%",content:E}]}).appendTo(d)}else"boolean"==typeof p&&$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect",u)),columns:[{width:"20px",content:$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-property",u).prop("checked",p).on("change",(function(e){var n=$(e.target).data().property,i=$(this).is(":checked"),r=o("shp");if(r[n]!==i){var a=JSON.parse(JSON.stringify(r));a[n]=i,t(["shp"],[a])}}))).append($("<div></div>"))}]}).appendTo(d)}return d}function D(e,t,n){this._document.getScene();var i=n?n.getProperty.bind(n):e.getProperty.bind(e),o=i("x"),a=i("y"),s=new r.GLength(i("r"),r.GLength.Unit.PT),l=i("pat"),c=i("opc"),d=this,u=[0,200],p=e.RANGES;return p&&p.r&&(u=p.r),$("<div></div>").append($("<div></div>").addClass("touch-effects-shadow").gPropertyRow({columns:[{width:"20%",label:"X",content:$("<input>").attr("type","text").attr("data-property","x").gUnitBox({source:"effects"}).gUnitBox("value",new r.GLength(o,r.GLength.Unit.PT)).on("change",(function(){var e=$(this).gUnitBox("value"),n=e?e.toUnit(r.GLength.Unit.PT):null;null!==n&&"number"==typeof n&&t(["x"],[n])}))},{width:"20%",label:"Y",content:$("<input>").attr("type","text").attr("data-property","y").gUnitBox({source:"effects"}).gUnitBox("value",new r.GLength(a,r.GLength.Unit.PT)).on("change",(function(){var e=$(this).gUnitBox("value"),n=e?e.toUnit(r.GLength.Unit.PT):null;null!==n&&"number"==typeof n&&t(["y"],[n])}))},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.blur")),content:$("<input>").attr("type","text").attr("data-property","r").gUnitBox({minValue:u[0],maxValue:u[1],source:"effects"}).gUnitBox("value",s).on("change",(function(e){var n=$(this).gUnitBox("value"),i=n?n.toUnit(r.GLength.Unit.PT):null;null!==i&&t(["r"],[i])}))},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=r.GLength.parseEquationValue($(e.target).gInputBox("value"))/100;t(["opc"],[n]),$(e.target).parents(".effect-settings").find('[data-property="pat"]').gPatternChooser("opacity",n)})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*c))},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.color")),content:$("<div></div>").attr("data-property","pat").gPatternChooser({types:[r.GColor,r.GGradient]}).gPatternChooser("value",l).gPatternChooser("opacity",c).on("chooseropen",(function(){d._document.getEditor().hideSelection(),d._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){d._document&&d._document.getEditor().resetHideSelection(),d._chooserElem=null})).on("patternchange",(function(e,n,i,o,a,s){var l=[],c=[];void 0!==n&&(l.push("pat"),c.push(n)),"number"==typeof i&&(l.push("opc"),c.push(i),$(e.target).parents(".effect-settings").find('[data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*i)));var d=null;a&&(d={chooserOn:!0},null!=s&&(d.activeStopIdx=s)),t(l,c,o,d)}))}]}))}function x(e,t,n){this._document.getScene();var i=n?n.getProperty.bind(n):e.getProperty.bind(e),o=i("a"),a=i("s"),s=i("l"),l=i("b"),c=i("c"),d=i("pat"),u=i("opc"),p=this._document.getEditor(),g=$("<div></div>"),h=this;function f(e,n,i,o,a,s,l,c,d){var u,g=$("<input>").attr("type","text").attr("data-property",n).val(i).on("change",(function(e){var i=r.GLength.parseEquationValue($(e.target).gInputBox("value"));o&&(i=$(this).gUnitBox("value").toUnit(r.GLength.Unit.PT));var l=$(this).parents(".effect-settings").find('[data-property="'+n+'"].g-input-slider');l.gInputSlider("value")!=i&&l.gInputSlider("value",i),null!==i&&"number"==typeof i&&i>=a&&i<=s&&t([n],[i])}));return o?(u=new r.GLength(i,r.GLength.Unit.PT),g.gUnitBox({minValue:a,maxValue:s,source:"effects"}).gUnitBox("value",u)):g.gInputBox({minValue:a,maxValue:s,postfix:c||"",incrementValue:(s-a)/100}).gInputBox("value",i),$("<div></div>").gPropertyRow({columns:[{label:e,width:"75%",content:$("<div>").gInputSlider({type:"range",maxDecimal:d,min:a,max:s,step:l||(s-a)/100}).gInputSlider("value",i).attr("data-property",n).on("mousedown",(function(){p.hideSelection(),$(document).one("mouseup",(function(){p.resetHideSelection()}))})).on("input",(function(e){var i=$(this),o=parseFloat(i.gInputSlider("value"));t([n],[o],!0),i.parents(".effect-settings").find('[data-property="'+n+'"]:not(.g-input-slider)').val(i.gInputSlider("value"))})).on("change",(function(e){var t=$(this),i=t.gInputSlider("value");t.parents(".effect-settings").find('[data-property="'+n+'"]:not(.g-input-slider)').val(i).trigger("change")}))},{width:"25%",content:g}]})}return g.append(f(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.bend")),"b",l,!0,-60,60,null,"",1)),g.append(f(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.softness")),"s",a,!1,0,1,null,"",2)),g.append(f(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.radius")),"l",s,!1,0,50,null,"",1)),g.append(f(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.coverage")),"c",c,!1,0,1,null,"",2)),g.append(f(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.angle")),"a",o,!1,0,360,1,"°")),$("<div></div>").addClass("touch-effects-shadow").gPropertyRow({columns:[{width:"50%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=r.GLength.parseEquationValue($(e.target).gInputBox("value"))/100;t(["opc"],[n]),$(e.target).parents(".effect-settings").find('[data-property="pat"]').gPatternChooser("opacity",n)})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*u))},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.color")),content:$("<div></div>").attr("data-property","pat").gPatternChooser({types:[r.GColor,r.GGradient]}).gPatternChooser("value",d).gPatternChooser("opacity",u).on("chooseropen",(function(){h._document.getEditor().hideSelection(),h._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){h._document&&h._document.getEditor().resetHideSelection(),h._chooserElem=null})).on("patternchange",(function(e,n,i,o,a,s){var l=[],c=[];void 0!==n&&(l.push("pat"),c.push(n)),"number"==typeof i&&(l.push("opc"),c.push(i),$(e.target).parents(".effect-settings").find('[data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*i)));var d=null;a&&(d={chooserOn:!0},null!=s&&(d.activeStopIdx=s)),t(l,c,o,d)}))}]}).appendTo(g),g}function I(e,t,n){this._document.getScene();var i=n?n.getProperty.bind(n):e.getProperty.bind(e),o=i("a"),a=new r.GLength(i("r"),r.GLength.Unit.PT),s=new r.GLength(i("o"),r.GLength.Unit.PT),l=i("pat"),c=i("opc"),d=this,u=[5,200],p=e.RANGES;p&&p.r&&(u=p.r);var g=function(e){return"r"===e?$("<input>").attr("type","text").gUnitBox({minValue:u[0],maxValue:u[1],source:"effects"}).gUnitBox("value",a).on("change",(function(e){t(["r"],[$(this).gUnitBox("value").toUnit(r.GLength.Unit.PT)])})):"a"===e?$("<input>").attr("type","text").gInputBox({minValue:5,maxValue:35,postfix:"°"}).gInputBox("value",o).on("change",(function(e){t(["a"],[r.GLength.parseEquationValue($(e.target).gInputBox("value"))])})):"o"===e?$("<input>").attr("type","text").gUnitBox({source:"effects"}).gUnitBox("value",s).on("change",(function(e){t(["o"],[$(this).gUnitBox("value").toUnit(r.GLength.Unit.PT)])})):"opc"===e?$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=r.GLength.parseEquationValue($(e.target).gInputBox("value"))/100;t(["opc"],[n]),$(e.target).parents(".effect-settings").find('[data-property="pat"]').gPatternChooser("opacity",n)})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*c)):"pat"===e?$("<div></div>").attr("data-property","pat").gPatternChooser({types:[r.GColor]}).gPatternChooser("value",l).gPatternChooser("opacity",c).on("chooseropen",(function(){d._document.getEditor().hideSelection(),d._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){d._document&&d._document.getEditor().resetHideSelection(),d._chooserElem=null})).on("patternchange",(function(e,n,i,o,a){var s=[],l=[];void 0!==n&&(s.push("pat"),l.push(n)),"number"==typeof i&&(s.push("opc"),l.push(i),$(e.target).parents(".effect-settings").find('[data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*i)));var c=null;a&&(c={chooserOn:!0}),t(s,l,o,c)})):void 0};return $("<div></div>").append($("<div></div>").gPropertyRow({columns:[{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.offset")),content:g("o")},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.angle")),content:g("a")},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.blur")),content:g("r")},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:g("opc")},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.color")),content:g("pat")}]}))}function O(e,t,n){this._document.getScene();var i=n?n.getProperty.bind(n):e.getProperty.bind(e),o=i("a"),a=new r.GLength(i("l"),r.GLength.Unit.PT),s=i("pat"),l=i("opc"),c=i("den"),d=i("fdm"),u=this,p=function(e){return"l"===e?$("<input>").attr("type","text").gUnitBox({minValue:0,source:"effects"}).gUnitBox("value",a).on("change",(function(e){t(["l"],[$(this).gUnitBox("value").toUnit(r.GLength.Unit.PT)])})):"a"===e?$("<input>").attr("type","text").gInputBox({minValue:-180,maxValue:180,postfix:"°"}).gInputBox("value",r.GUtil.formatNumber(Math.round(r.GMath.toDegrees(o)),1)).on("change",(function(e){t(["a"],[r.GMath.toRadians(r.GLength.parseEquationValue($(e.target).gInputBox("value")))])})):"opc"===e?$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=r.GLength.parseEquationValue($(e.target).gInputBox("value"))/100;t(["opc"],[n]),$(e.target).parents(".effect-settings").find('[data-property="pat"]').gPatternChooser("opacity",n)})).gInputBox({minValue:0,maxValue:100,postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*l)):"den"===e?$("<input>").attr("type","text").on("change",(function(e){var n=$(e.target).gInputBox("value")/100;t(["den"],[n])})).gInputBox({minValue:5,maxValue:100,incrementValue:1,postfix:"%"}).gInputBox("value",r.GUtil.formatNumber(100*c)):"fdm"===e?$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").prop("checked",d).on("change",(function(e){t(["fdm"],[$(this).is(":checked")])}))).append($("<div></div>")):"pat"===e?$("<div></div>").attr("data-property","pat").gPatternChooser({types:[r.GColor,r.GGradient]}).gPatternChooser("value",s).gPatternChooser("opacity",l).on("chooseropen",(function(){u._document.getEditor().hideSelection(),u._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){u._document&&u._document.getEditor().resetHideSelection(),u._chooserElem=null})).on("patternchange",(function(e,n,i,o,a,s){var l=[],c=[];void 0!==n&&(l.push("pat"),c.push(n)),"number"==typeof i&&(l.push("opc"),c.push(i),$(e.target).parents(".effect-settings").find('[data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*i)));var d=null;a&&(d={chooserOn:!0},null!=s&&(d.activeStopIdx=s)),t(l,c,o,d)})):void 0};return $("<div></div>").append($("<div></div>").gPropertyRow({columns:[{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.angle")),content:p("a")},{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.length")),content:p("l")},{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.density")),content:p("den")}]})).append($("<div></div>").gPropertyRow({columns:[{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.color")),content:p("pat")},{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:p("opc")},{width:"33%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.fade")),content:p("fdm")}]}))}function k(e,t,n){this._document.getScene();var i=n?n.getProperty.bind(n):e.getProperty.bind(e),o=this._document.getEditor(),a=new r.GLength(i("r"),r.GLength.Unit.PT),s=i("b"),l=$("<div></div>");return $("<div></div>").gPropertyRow({columns:[{label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.radius")),width:"75%",content:$("<div>").gInputSlider({maxDecimal:1,min:"0",max:new r.GLength(j?50:10,r.GLength.Unit.PT).toUnit(r.GLength.Unit.PX),step:"0.1"}).gInputSlider("value",i("r")).attr("data-property","r").on("mousedown",(function(){o.hideSelection(),$(document).one("mouseup",(function(){o.resetHideSelection()}))})).on("input",(function(e){var n=$(this),i=parseFloat(n.gInputSlider("value"));t(["r"],[i],!0),n.parents(".effect-settings").find('[data-property="r"]:not(.g-input-slider)').val(n.gInputSlider("value"))})).on("change",(function(e){var t=$(this),n=parseFloat(t.gInputSlider("value"));t.parents(".effect-settings").find('[data-property="r"]:not(.g-input-slider)').val(n).trigger("change")}))},{width:"25%",content:$("<input>").attr("data-property","r").gUnitBox({source:"effects"}).gUnitBox("value",a).on("change",(function(e){var n=$(this).gUnitBox("value"),i=n?n.toUnit(r.GLength.Unit.PT):null,o=$(this).parents(".effect-settings").find('[data-property="r"].g-input-slider');parseFloat(o.gInputSlider("value"))!=i&&o.gInputSlider("value",i),null!==i&&"number"==typeof i&&i>=0&&i<=254&&t(["r"],[i])}))}]}).appendTo(l),$("<div></div>").gPropertyRow({columns:[{label:r.GLocale.get(new r.GLocaleKey("GWebGLEffect","clip")),width:"25%",content:$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").prop("checked",s).on("change",(function(e){t(["b"],[$(this).is(":checked")])}))).append($("<div></div>"))}]}).appendTo(l),l}function F(e,t,n){var i=this._document.getEditor(),o=n?n.getProperty.bind(n):e.getProperty.bind(e),a=o("pat"),s=o("opc"),l=o("alm"),c=this;return $("<div></div>").append($("<div></div>").addClass("touch-effects-overlay").gPropertyRow({columns:[{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.color")),content:$("<div></div>").attr("data-property","pat").gPatternChooser({types:[r.GColor,r.GGradient]}).gPatternChooser("value",a).gPatternChooser("opacity",s).on("chooseropen",(function(){i.hideSelection(),gDesigner.getWorkspace().getStyleEdManager().updateEditor(e,"pat",!1),c._styleEdOn=!0,c._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){gDesigner.getWorkspace().getStyleEdManager().getOverlayLock(n)?t():(c._styleEdOn=!1,gDesigner.getWorkspace().getStyleEdManager().deactivateEditor(),i.resetHideSelection()),c._chooserElem=null})).on("patternchange",(function(e,n,i,o,r,a){var s=[],l=[];void 0!==n&&(s.push("pat"),l.push(n)),"number"==typeof i&&(s.push("opc"),l.push(i));var c=null;r&&(c={chooserOn:!0},null!=a&&(c.activeStopIdx=a)),t(s,l,o,c)}))},{width:"20%"},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=$(e.target).gInputBox("value")/100;t(["opc"],[n])})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*s))},{width:"20%"},{width:"20%",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.blend")),content:$("<div/>").css({display:"flex",justifyContent:"center"}).append($("<label></label>").addClass("g-switch").css({width:"20px",alignSelf:"center"}).append($("<input>").attr("type","checkbox").prop("checked",l).on("change",(function(e){if($(this).is(":checked")){var n=new r.GLinearGradient([{color:r.GRGBColor.BLACK,position:0,opacity:1},{color:r.GRGBColor.WHITE,position:1,opacity:0}]);t(["alm","opc","pat"],[!0,1,n])}else t(["alm"],[!1])}))).append($("<div></div>")))}]}))}function R(e,t){return $("<div></div>").append($("<input>").attr("type","file").attr("accept",".acv").css({position:"absolute",left:"-10000px"}).on("change",(function(e){gDesigner.stats("effects_change_colorgrading");var n=$(e.target)[0].files;if(n&&n.length&&(n[0]instanceof File||n[0]instanceof Blob)){var i=new FileReader;i.onload=function(){var e=r.GUtil.readACVFile(i.result);e&&t(["cp"],[e])},i.readAsArrayBuffer(n[0])}}))).append($("<select></select>").append($("<option></option>").attr("value","").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.none")))).append($('<optgroup label="'.concat(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.grp.instagram")),'"></optgroup>')).append($("<option></option>").attr("value","1977").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.1977")))).append($("<option></option>").attr("value",r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.brannan"))).text("Brannan")).append($("<option></option>").attr("value","Gotham").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.gotham")))).append($("<option></option>").attr("value","Hefe").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.hefe")))).append($("<option></option>").attr("value","Lord Kelvin").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.lord-kelvin")))).append($("<option></option>").attr("value","Nashville").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.nashville")))).append($("<option></option>").attr("value","X-PRO II").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.color.gradient.opt.x-pro-ii"))))).on("change",(function(e){var n=$(e.target).val();if(gDesigner.stats("effects_change_grading",n||"none"),n){var i=new XMLHttpRequest;i.addEventListener("load",(function(){if(200==i.status&&i.response){var e=r.GUtil.readACVFile(i.response);e&&t(["cp"],[e])}})),i.open("GET","assets/data/acv/"+n+".acv"),i.responseType="arraybuffer",i.send(null)}else t(["cp"],[null])}))).append($("<button></button>").text(r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.load-acv"))+"...").on("click",(function(e){gDesigner.stats("effects_choose_acv"),$(e.target).parents(".effect-settings").find('input[type="file"]').focus().trigger("click")})))}function M(e,t){for(var n=r.GObject.getTypeId(e),i=(r.GNode.getClassFromId(n),e.getFXArray()),o=$("<div></div>"),a=0;a<i.length;a++)for(var s=i[a],l=r.GNode.getClassFromId(r.GObject.getTypeId(i[a])),c=r.GNode.getName(l),d=0;d<H.length;d++)if(H[d].clazz===l){o.append(H[d].createSettings.call(this,e,B(c,t),s).css("margin-top","7px"));break}return o}function N(e,t,n){var i=this._document.getEditor(),o=n?n.getProperty.bind(n):e.getProperty.bind(e),a=o("opc"),s=new r.GLength(o("pad")),l=o("rfh"),c=function(e){return"rfh"===e?$("<input>").attr("data-property",e).attr("type","text").on("change",(function(n){var i=r.GLength.parseEquationValue($(n.target).gInputBox("value"))/100;t([e],[i])})).gInputBox({minValue:0,maxValue:100,incrementValue:10,slowIncrementValue:1,postfix:"%"}).gInputBox("value",100*l):"pad"===e?$("<input>").attr("data-property",e).attr("type","text").on("change",(function(n){var i=$(n.target).gUnitBox("value").getValue();t([e],[i])})).gUnitBox({minValue:0,incrementValue:1,source:"effects"}).gUnitBox("value",s):"opacity-slider"===e?$("<div/>").attr("data-property","opc").gInputSlider({type:"range",min:0,max:100}).on("mousedown",(function(){i.hideSelection(),$(document).one("mouseup",(function(){i.resetHideSelection()}))})).on("input",(function(e){var n=$(e.target),i=parseInt(n.gInputSlider("value"))/100;t(["opc"],[i]),$(e.target).parents(".effect-settings").find('[type="text"][data-property="opc"]').gInputBox("value",r.GUtil.formatOpacity(100*i))})).on("change",(function(e){t(["opc"],[parseFloat($(this).gInputSlider("value"))/100])})).gInputSlider("value",100*a):"opacity-input"===e?$("<input>").attr("type","text").attr("data-property","opc").on("change",(function(e){var n=$(this).gInputBox("value");$(this).parents(".effect-settings").find('[data-property="opc"].g-input-slider').gInputSlider("value",n),t(["opc"],[r.GLength.parseEquationValue($(this).gInputBox("value"))/100])})).gInputBox({minValue:0,maxValue:100,incrementValue:5,postfix:"%"}).gInputBox("value",r.GUtil.formatOpacity(100*a)):void 0};return $("<div></div>").gPropertyRow({columns:[{width:"auto",label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.opacity")),content:$("<div></div>").gPropertyRow({columns:[{width:"auto",content:c("opacity-slider")},{width:$("body").hasClass("g-touch")?"60px":"40px",content:c("opacity-input")}]})},{width:$("body").hasClass("g-touch")?"60px":"40px",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.padding")),content:c("pad")},{width:$("body").hasClass("g-touch")?"60px":"40px",label:r.GLocale.get(new r.GLocaleKey("GEffectProperties","text.height")),content:c("rfh")}]})}function B(e,t){return function(n,i,o){for(var r=n.slice(),a=i.slice(),s=0;s<r.length;s++)r[s]=e+"&"+r[s],a[s]=i[s];t(r,a,o)}}function U(e){var t=null;t=e instanceof r.GStylable.Effect?e.constructor:e;for(var n=0;n<H.length;++n)if(H[n].clazz===t)return H[n];throw new Error("Invalid effect/class")}var K=document.createElement("canvas"),j=null;try{j=K.getContext("webgl",{premultipliedAlpha:!1})||K.getContext("experimental-webgl")}catch(e){j=null}var H=null,V=function(){return[{clazz:r.GGLBlurEffect,i18n:"GGLBlurEffect",group:"raster",createSettings:L,icon:"gravit-icon-blur-effect"},{clazz:r.GBlurEffect,i18n:"GBlurEffect",group:"raster",category:_,createSettings:k,icon:"gravit-icon-blur-effect",mostUsed:!0},{clazz:r.GGLVignetteEffect,i18n:"GGLVignetteEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-vignette-effect",mostUsed:!0},{clazz:r.GGLColorAdjustEffect,i18n:"GGLColorAdjustEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-adjust-effect",mostUsed:!0},{clazz:r.GGLRecolourEffect,i18n:"GGLRecolourEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-recolour-effect",mostUsed:!0},{clazz:r.GOverlayEffect,i18n:"GOverlayEffect",group:"filter",category:w,createSettings:F,icon:"gravit-icon-overlay-effect",mostUsed:!0},{clazz:r.GMirrorEffect,i18n:"GMirrorEffect",group:"mirror",category:E,createSettings:N,icon:"gravit-icon-mirror-effect",mostUsed:!0},{clazz:r.GCurvedShadowEffect,i18n:"GCurvedShadowEffect",group:"raster",category:S,createSettings:x,icon:"gravit-icon-curved-shadow-effect",mostUsed:!0},{clazz:r.GDropShadowEffect,i18n:"GDropShadowEffect",group:"raster",category:S,createSettings:D,icon:"gravit-icon-drop-shadow-effect",mostUsed:!0},{clazz:r.GInnerShadowEffect,i18n:"GInnerShadowEffect",group:"raster",category:S,createSettings:D,icon:"gravit-icon-inner-shadow-effect",mostUsed:!0},{clazz:r.GGLBulgePinchEffect,i18n:"GGLBulgePinchEffect",group:"webgl",category:C,createSettings:L,icon:"gravit-icon-bulge-effect"},{clazz:r.GGLColorHalfToneEffect,i18n:"GGLColorHalfToneEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-half-tone-effect"},{clazz:r.GGLDotScreenEffect,i18n:"GGLDotScreenEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-dotscreen-effect"},{clazz:r.GGLBrightnessContrastEffect,i18n:"GGLBrightnessContrastEffect",group:"webgl",category:w,hidden:!0,createSettings:L},{clazz:r.GGLFisheyeEffect,i18n:"GGLFisheyeEffect",group:"webgl",category:C,createSettings:L,icon:"gravit-icon-fisheye-effect"},{clazz:r.GGLBendEffect,i18n:"GGLBendEffect",group:"webgl",category:C,createSettings:L,icon:"gravit-icon-bend-effect"},{clazz:r.GGLDenoiseEffect,i18n:"GGLDenoiseEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-denoise-effect"},{clazz:r.GGLEdgeWorkEffect,i18n:"GGLEdgeWorkEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-edge-work-effect"},{clazz:r.GGLHexagonalEffect,i18n:"GGLHexagonalEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-hexagonal-effect"},{clazz:r.GGLHueSaturationEffect,i18n:"GGLHueSaturationEffect",group:"webgl",category:w,hidden:!0,createSettings:L},{clazz:r.GColorAdjustMultiEffect,i18n:"GColorAdjustMultiEffect",group:"webgl",category:w,createSettings:M,hidden:!0},{clazz:r.GGLInkEffect,i18n:"GGLInkEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-ink-effect"},{clazz:r.GGLLensBlurEffect,i18n:"GGLLensBlurEffect",group:"webgl",category:_,createSettings:L,icon:"gravit-icon-lens-blur-effect"},{clazz:r.GGLNoiseEffect,i18n:"GGLNoiseEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-noise-effect"},{clazz:r.GGLSepiaEffect,i18n:"GGLSepiaEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-sepia-effect"},{clazz:r.GGLSwirlEffect,i18n:"GGLSwirlEffect",group:"webgl",category:C,createSettings:L,icon:"gravit-icon-swirl-effect"},{clazz:r.GGLTiltShiftEffect,i18n:"GGLTiltShiftEffect",group:"webgl",category:_,createSettings:L,icon:"gravit-icon-tilt-shift-effect"},{clazz:r.GGLDrunkEffect,i18n:"GGLDrunkEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-alcohol-effect"},{clazz:r.GGLUnsharpMaskEffect,i18n:"GGLUnsharpMaskEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-unsharp-mask-effect"},{clazz:r.GGLVibranceEffect,i18n:"GGLVibranceEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-vibrance-effect"},{clazz:r.GGLBloomEffect,i18n:"GGLBloomEffect",group:"webgl",category:w,createSettings:L,icon:"gravit-icon-bloom-effect"},{clazz:r.GGLSketchEffect,i18n:"GGLSketchEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-sketch-effect"},{clazz:r.GGLToonEffect,i18n:"GGLToonEffect",group:"webgl",category:b,createSettings:L,icon:"gravit-icon-toon-effect"},{clazz:r.GGLZoomBlurEffect,i18n:"GGLZoomBlurEffect",group:"webgl",category:_,createSettings:L,icon:"gravit-icon-zoom-blur-effect"},{clazz:r.GGLStrokeLayerEffect,i18n:"GGLStrokeLayerEffect",group:"raster",category:E,createSettings:L,icon:"gravit-icon-stroke-effect"},{clazz:r.GGLInnerGlowEffect,i18n:"GGLInnerGlowEffect",group:"raster",category:E,createSettings:L,icon:"gravit-icon-inner-glow-effect"},{clazz:r.GGLOuterGlowEffect,i18n:"GGLOuterGlowEffect",group:"raster",category:E,createSettings:L,icon:"gravit-icon-outer-glow-effect"},{clazz:r.GContactShadowEffect,i18n:"GContactShadowEffect",group:"raster",category:S,createSettings:I,icon:"gravit-icon-contact-shadow-effect"},{clazz:r.GLongShadowEffect,i18n:"GLongShadowEffect",group:"raster",category:S,createSettings:O,icon:"gravit-icon-long-shadow-effect"},{clazz:r.GColorGradingEffect,i18n:"GColorGradingEffect",group:"filter",category:w,createSettings:R,icon:"gravit-icon-color-grading-effect"}]};e.exports=G},function(e,t,n){"use strict";var i=n(1);function o(){}o.DefaultStops={Hue:function(e){return i.GColor.hsvToRGB([e,1,1])},Saturation:function(e){return function(t){return i.GColor.hsvToRGB([e,t/100,1])}},Luminosity:function(e){return i.GColor.hsvToRGB([0,0,e/100])}},e.exports=o;var r={init:function(e){return e=$.extend({min:0,max:360,stops:o.DefaultStops.Hue},e),this.each((function(){for(var t="",n=0,o=Math.abs(e.min)+Math.abs(e.max),r=e.min;r<=e.max;r+=20){var a=e.stops.call(null,n);n+=20,t&&(t+=","),t+=i.GColor.rgbToHtmlHex(a)+" "+n/o*100+"%"}e.background="linear-gradient(90deg,"+t+")",$(this).gInputSlider(e)}))},value:function(e){return $(this).gInputSlider("value",e)},minValue:function(){return $(this).gInputSlider("minValue")},maxValue:function(){return $(this).gInputSlider("maxValue")}};$.fn.gColorSlider=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):r.init.apply(this,arguments)}},function(e,t,n){"use strict";n(45),n(3);var i=n(1),o=n(108),r=n(1048);function a(){}i.GObject.inherit(a,o),a.prototype._panel=null,a.prototype._document=null,a.prototype._elements=null,a.prototype.isGroup=function(e){return e instanceof r},a.prototype.init=function(e,t){this._panel=e;var n=function(e){var t=parseInt($(e.target).closest("[data-op]").attr("data-op"));gDesigner.stats("booleanops_click_"+(t===i.GVertexPolyBoolean.OR?"merge":t===i.GVertexPolyBoolean.AND?"intersect":t===i.GVertexPolyBoolean.XOR?"difference":t===i.GVertexPolyBoolean.SUB?"subtract":"unkn"));var n=this._document.getEditor();n.beginTransaction();try{for(var o=0;o<this._elements.length;++o)this._elements[o].setProperty("bool",t)}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","action.modify-merge-mode")))}}.bind(this);$("<div></div>").addClass("compound-row").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","text.boolean")),columns:[{width:"25%",content:$("<button></button>").addClass("compound-chooser-btn").attr("data-op",i.GVertexPolyBoolean.OR).attr("data-title",i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","text.union"))).append($("<span></span>").addClass("gravit-icon-merge-union")).on("click",n)},{width:"25%",content:$("<button></button>").addClass("compound-chooser-btn").attr("data-op",i.GVertexPolyBoolean.SUB).attr("data-title",i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","text.subtract"))).append($("<span></span>").addClass("gravit-icon-merge-subtract")).on("click",n)},{width:"25%",content:$("<button></button>").addClass("compound-chooser-btn").attr("data-op",i.GVertexPolyBoolean.AND).attr("data-title",i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","text.intersect"))).append($("<span></span>").addClass("gravit-icon-merge-intersect")).on("click",n)},{width:"25%",content:$("<button></button>").addClass("compound-chooser-btn").attr("data-op",i.GVertexPolyBoolean.XOR).attr("data-title",i.GLocale.get(new i.GLocaleKey("GBoolOpProperties","text.difference"))).append($("<span></span>").addClass("gravit-icon-merge-difference")).on("click",n)}]}).appendTo(this._panel),$("<hr/>").appendTo(this._panel)},a.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._elements=[],e&&t){for(var n=0;n<t.length;++n){var o=t[n];if(o.getParent()&&o.getParent()instanceof i.GCompoundShape&&o.getPrevious())this._elements.push(o);else if(o instanceof i.GCompoundShape&&o.getFirstChild())for(var r=o.getFirstChild().getNext();null!==r;r=r.getNext())this._elements.push(r)}if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0}return!1},a.prototype._afterPropertiesChange=function(e){!e.temporary&&this._elements.length>0&&this._elements[0]===e.node&&this._updateProperties()},a.prototype._updateProperties=function(){var e=this._elements[0];this._panel.find("button[data-op]").each((function(t,n){var i=$(n);i.toggleClass("g-active",e.getProperty("bool")===parseInt(i.attr("data-op")))}))},a.prototype.toString=function(){return"[Object GBoolOpProperties]"},e.exports=a},function(e,t,n){"use strict";n(45),n(3);var i=n(1),o=n(108);n(143);function r(){this._ellipses=[]}i.GObject.inherit(r,o),r.prototype._panel=null,r.prototype._document=null,r.prototype._ellipses=null,r.prototype.init=function(e){this._panel=e;var t=function(e){var t=this;if(0===e.indexOf("etp-")){var n="",o=parseInt(e.substr("etp-".length));switch(o){case i.GEllipse.Type.Pie:n="gravit-icon-circle-pie";break;case i.GEllipse.Type.Chord:n="gravit-icon-ellipse-chord";break;case i.GEllipse.Type.Arc:n="gravit-icon-ellipse-arc";break;default:throw new Error("")}return $("<div></div>").attr("data-property",e).addClass("g-button g-icon").on("click",(function(){gDesigner.stats("ellipse_change_type",o),t._assignProperty("etp",o,i.GLocale.get(new i.GLocaleKey("GEllipseProperties","action.change-shape"))),o===i.GEllipse.Type.Arc&&t._setBorderAlignmentCenter()})).append($("<span></span>").addClass(n))}if("sa"===e||"ea"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("ellipse_change_angle");var n=i.GLength.parseEquationValue($(this).gInputBox("value"));null!==n?(n=i.GMath.normalizeAngleRadians(i.GMath.toRadians(n)),t._assignProperty(e,i.GMath.PI2-n,i.GLocale.get(new i.GLocaleKey("GEllipseProperties","action.change-angle")))):t._updateProperties()})).gInputBox();throw new Error("Unknown input property: "+e)}.bind(this);$("<div></div>").addClass("ellipse-angles-property").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.angles")),columns:[{width:"50%",content:t("sa")},{width:"50%",content:t("ea")}]}).appendTo(e),$("<div></div>").addClass("ellipse-shape-property").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GEllipseProperties","text.shape")),columns:[{width:"33.3%",clazz:"shape-type-chooser shape-arc",label:i.GLocale.get(new i.GLocaleKey("GEllipse","type.arc")),content:t("etp-"+i.GEllipse.Type.Arc)},{width:"33.3%",clazz:"shape-type-chooser shape-chord",label:i.GLocale.get(new i.GLocaleKey("GEllipse","type.chord")),content:t("etp-"+i.GEllipse.Type.Chord)},{width:"33.3%",clazz:"shape-type-chooser shape-pie",label:i.GLocale.get(new i.GLocaleKey("GEllipse","type.pie")),content:t("etp-"+i.GEllipse.Type.Pie)}]}).appendTo(e)},r.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._ellipses=[],e){for(var n=0;n<t.length;++n)t[n]instanceof i.GEllipse&&this._ellipses.push(t[n]);if(this._ellipses.length&&this._ellipses.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0}return!1},r.prototype._afterPropertiesChange=function(e){!e.temporary&&this._ellipses.length>0&&this._ellipses[0]===e.node&&this._updateProperties()},r.prototype._setBorderAlignmentCenter=function(){var e,t,n=["_ba"],o=[i.GStylable.BorderAlignment.Center],r=this._document.getEditor();r.beginTransaction();try{for(var a=0,s=this._ellipses.length;a<s;++a){e=this._ellipses[a].getPaintLayers().getBorderLayers();for(var l=0,c=e.length;l<c;l++)(t=e[l])instanceof i.GStylable.BorderPaintLayer&&t.setProperties(n,o)}}finally{r.commitTransaction(i.GLocale.get(new i.GLocaleKey("GEllipseProperties","text.ellipse-to-center")))}},r.prototype._updateProperties=function(){var e=this._ellipses[0];this._panel.find('[data-property^="etp"]').each((function(t,n){var i=$(n),o=i.attr("data-property").substr("etp-".length);i.toggleClass("g-active",e.getProperty("etp").toString()===o)})),this._panel.find('input[data-property="sa"]').val(i.GUtil.formatNumber(i.GMath.toDegrees(i.GMath.PI2-e.getProperty("sa")),2)),this._panel.find('input[data-property="ea"]').val(i.GUtil.formatNumber(i.GMath.toDegrees(i.GMath.PI2-e.getProperty("ea")),2))},r.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},r.prototype._assignProperties=function(e,t,n){var i=this._document.getEditor();i.beginTransaction();try{for(var o=0;o<this._ellipses.length;++o)this._ellipses[o].setProperties(e,t)}finally{i.commitTransaction(n)}},r.prototype.toString=function(){return"[Object GEllipseProperties]"},e.exports=r},function(e,t,n){"use strict";n(3);n(43);var i=n(1),o=(n(16),n(1151)),r=n(108),{replaceImage:a,setOriginSize:s,cropImage:l}=(n(143),n(192),n(1152));function c(){}i.GObject.inherit(c,r),c.prototype._panel=null,c.prototype._document=null,c.prototype._image=null,c.prototype._controls=null,c.prototype.init=function(e,t){this._panel=e,this._controls=t,$("<div></div>").addClass("g-image-convert-status").css({display:"none","font-size":"8px"}).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GImageProperties","text.checking-profile"))+"...")).appendTo(this._controls),$("<div></div>").addClass("image-button-row").gPropertyRow({columns:[{label:i.GLocale.get(new i.GLocaleKey("GImageProperties","action.replace")),width:"25%",content:$("<button></button>").addClass("g-flat").css("padding","0").append($("<span></span>").addClass("gravit-icon-replaceimg")).on("click",()=>{a(this._image,this._document),gDesigner.stats("image_replace_image")})},{label:i.GLocale.get(new i.GLocaleKey("GImageProperties","action.original-size")),width:"25%",content:$("<button></button>").addClass("g-flat").css("padding","0").attr("data-action","reset-size").append($("<span></span>").addClass("gravit-icon-expand")).on("click",()=>{s(this._image),gDesigner.stats("image_reset_size")})},{label:i.GLocale.get(new i.GLocaleKey("GImageProperties","action.no-crop")),labelClass:"crop-label",width:"25%",content:$("<button></button>").attr("data-action","handle-crop").addClass("g-flat").css("padding","0").append($("<span></span>").addClass("gravit-icon-crop")).on("click",()=>{var t=e.find('button[data-action="handle-crop"]');l(this._image,t.data("no-crop")),gDesigner.stats("image_change_croptype")})},{label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.colors")),width:"25%",content:$("<button></button>").attr("data-image-palette","button").addClass("g-flat").css("padding","0").append($("<span></span>").addClass("gravit-icon-extract-colors")).on("click",this._updateImagePalette.bind(this))}]}).appendTo(e),$("<div></div>").attr("data-image-palette","palette").css({height:"27px",margin:"5px 10px 0 10px"}).appendTo(e)},c.prototype._updateImagePalette=function(){gDesigner.stats("image_update_palette");var e=this._image.getImage()||this._image.getImageCanvas(),t=this._panel.find('[data-image-palette="palette"]');t.empty();var n=function(e){$("<div></div>").gPatternTarget({allowDrop:!1}).gPatternTarget("types",[i.GColor]).gPatternTarget("value",e).css({display:"inline-block",height:"100%",width:"12.5%",background:i.GPattern.asCSSBackground(e)}).appendTo(t)}.bind(this);if(e){t.css("display",""),this._panel.find('[data-image-palette="button"]').prop("disabled",!0);var r=new o,a=null;try{a=r.getColor(e)}catch(e){console.warn("Cannot extract image palette")}var s=a?new i.GRGBColor(a):i.GRGBColor.BLACK;n(s);var l=null;try{l=r.getPalette(e,16)}catch(e){console.warn("Cannot extract image palette")}var c=1;if(l)for(var d=0;d<l.length;++d){var u=new i.GRGBColor(l[d]);if(!i.GUtil.equals(u,s)&&(n(u),++c>=8))break}}},c.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().removeEventListener(i.GImage.StatusEvent,this._imageStatus,this),this._document.getScene().removeEventListener(i.GImage.ConvertStatusEvent,this._imageConvertStatus,this),this._document=null),this._image=null,e){for(var n=0;n<t.length;++n)if(t[n]instanceof i.GImage){if(this._image){this._image=null;break}this._image=t[n]}if(this._image)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(i.GImage.StatusEvent,this._imageStatus,this),this._document.getScene().addEventListener(i.GImage.ConvertStatusEvent,this._imageConvertStatus,this),this._updateProperties(),!0}return this._controls.find(".g-image-convert-status").css("display","none"),!1},c.prototype._afterPropertiesChange=function(e){!e.temporary&&this._image&&this._image===e.node&&this._updateProperties()},c.prototype._imageStatus=function(e){e.image!==this._image||e.status!==i.GImage.ImageStatus.Error&&e.status!==i.GImage.ImageStatus.Loaded||this._updateProperties()},c.prototype._imageConvertStatus=function(e){this._updateConvertStatus(e.status)},c.prototype._updateConvertStatus=function(e){var t;switch(e){case i.GImage.ConvertStatus.Checking:t=i.GLocale.get(new i.GLocaleKey("GImageProperties","text.check-profile"))+"...";break;case i.GImage.ConvertStatus.Converting:t=i.GLocale.get(new i.GLocaleKey("GImageProperties","text.loading-profile"))+"..."}t&&this._controls.find(".g-image-convert-status > span").text(t),this._controls.find(".g-image-convert-status").css("display",t?"":"none")},c.prototype._updateProperties=function(){this._image.getProperty("url"),this._image.getStatus();var e=this._image.isReady(),t=this._image.getGeometryBBox(),n=t?t.getWidth():0,o=t?t.getHeight():0,r=this._image.getWidth(),a=this._image.getHeight();if(gDesigner.getActiveDocument()){var s=gDesigner.getActiveDocument().getEditor().hasSelectionDetail();this._panel.find('button[data-action="reset-size"]').prop("disabled",!e||i.GMath.isEqualEps(r,n)&&i.GMath.isEqualEps(a,o)),this._panel.find('button[data-action="handle-crop"]').data("no-crop",s),this._panel.find(".crop-label").text(i.GLocale.get(new i.GLocaleKey("GImageProperties",s?"action.no-crop":"action.crop"))),this._panel.find('[data-image-palette="button"]').prop("disabled",!e).css("display",""),this._panel.find('[data-image-palette="palette"]').css("display","none"),this._updateConvertStatus(this._image.getConvertStatus())}},c.prototype.toString=function(){return"[Object GImageProperties]"},e.exports=c},function(e,t){e.exports=function(){var e=function(){},t=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=e.width,this.height=this.canvas.height=e.height,this.context.drawImage(e,0,0,this.width,this.height)};t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.update=function(e){this.context.putImageData(e,0,0)},t.prototype.getPixelCount=function(){return this.width*this.height},t.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},t.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var n={map:function(e,t){var n={};return t?e.map((function(e,i){return n.index=i,t.call(n,e)})):e.slice()},naturalOrder:function(e,t){return e<t?-1:e>t?1:0},sum:function(e,t){var n={};return e.reduce(t?function(e,i,o){return n.index=o,e+t.call(n,i)}:function(e,t){return e+t},0)},max:function(e,t){return Math.max.apply(null,t?n.map(e,t):e)}},i=function(){function e(e,t,n){return(e<<2*l)+(t<<l)+n}function t(e){function t(){n.sort(e),i=!0}var n=[],i=!1;return{push:function(e){n.push(e),i=!1},peek:function(e){return i||t(),void 0===e&&(e=n.length-1),n[e]},pop:function(){return i||t(),n.pop()},size:function(){return n.length},map:function(e){return n.map(e)},debug:function(){return i||t(),n}}}function i(e,t,n,i,o,r,a){var s=this;s.r1=e,s.r2=t,s.g1=n,s.g2=i,s.b1=o,s.b2=r,s.histo=a}function o(){this.vboxes=new t((function(e,t){return n.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())}))}function r(t){var n,i,o,r,a=new Array(1<<3*l);return t.forEach((function(t){i=t[0]>>c,o=t[1]>>c,r=t[2]>>c,n=e(i,o,r),a[n]=(a[n]||0)+1})),a}function a(e,t){var n,o,r,a=1e6,s=0,l=1e6,d=0,u=1e6,p=0;return e.forEach((function(e){n=e[0]>>c,o=e[1]>>c,r=e[2]>>c,n<a?a=n:n>s&&(s=n),o<l?l=o:o>d&&(d=o),r<u?u=r:r>p&&(p=r)})),new i(a,s,l,d,u,p,t)}function s(t,i){if(i.count()){var o=i.r2-i.r1+1,r=i.g2-i.g1+1,a=i.b2-i.b1+1,s=n.max([o,r,a]);if(1==i.count())return[i.copy()];var l,c,d,u,p=0,g=[],h=[];if(s==o)for(l=i.r1;l<=i.r2;l++){for(u=0,c=i.g1;c<=i.g2;c++)for(d=i.b1;d<=i.b2;d++)u+=t[e(l,c,d)]||0;p+=u,g[l]=p}else if(s==r)for(l=i.g1;l<=i.g2;l++){for(u=0,c=i.r1;c<=i.r2;c++)for(d=i.b1;d<=i.b2;d++)u+=t[e(c,l,d)]||0;p+=u,g[l]=p}else for(l=i.b1;l<=i.b2;l++){for(u=0,c=i.r1;c<=i.r2;c++)for(d=i.g1;d<=i.g2;d++)u+=t[e(c,d,l)]||0;p+=u,g[l]=p}return g.forEach((function(e,t){h[t]=p-e})),function(e){var t,n,o,r,a,s=e+"1",c=e+"2",d=0;for(l=i[s];l<=i[c];l++)if(g[l]>p/2){for(o=i.copy(),r=i.copy(),a=(t=l-i[s])<=(n=i[c]-l)?Math.min(i[c]-1,~~(l+n/2)):Math.max(i[s],~~(l-1-t/2));!g[a];)a++;for(d=h[a];!d&&g[a-1];)d=h[--a];return o[c]=a,r[s]=o[c]+1,[o,r]}}(s==o?"r":s==r?"g":"b")}}var l=5,c=8-l,d=1e3,u=.75;return i.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(t){var n=this,i=n.histo;if(!n._count_set||t){var o,r,a,s=0;for(o=n.r1;o<=n.r2;o++)for(r=n.g1;r<=n.g2;r++)for(a=n.b1;a<=n.b2;a++)s+=i[e(o,r,a)]||0;n._count=s,n._count_set=!0}return n._count},copy:function(){var e=this;return new i(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(t){var n=this,i=n.histo;if(!n._avg||t){var o,r,a,s,c=0,d=1<<8-l,u=0,p=0,g=0;for(r=n.r1;r<=n.r2;r++)for(a=n.g1;a<=n.g2;a++)for(s=n.b1;s<=n.b2;s++)c+=o=i[e(r,a,s)]||0,u+=o*(r+.5)*d,p+=o*(a+.5)*d,g+=o*(s+.5)*d;n._avg=c?[~~(u/c),~~(p/c),~~(g/c)]:[~~(d*(n.r1+n.r2+1)/2),~~(d*(n.g1+n.g2+1)/2),~~(d*(n.b1+n.b2+1)/2)]}return n._avg},contains:function(e){var t=this,n=e[0]>>c,i=e[1]>>c,o=e[2]>>c;return n>=t.r1&&n<=t.r2&&i>=t.g1&&i<=t.g2&&o>=t.b1&&o<=t.b2}},o.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map((function(e){return e.color}))},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,n=0;n<t.size();n++)if(t.peek(n).vbox.contains(e))return t.peek(n).color;return this.nearest(e)},nearest:function(e){for(var t,n,i,o=this.vboxes,r=0;r<o.size();r++)((n=Math.sqrt(Math.pow(e[0]-o.peek(r).color[0],2)+Math.pow(e[1]-o.peek(r).color[1],2)+Math.pow(e[2]-o.peek(r).color[2],2)))<t||void 0===t)&&(t=n,i=o.peek(r).color);return i},forcebw:function(){var e=this.vboxes;e.sort((function(e,t){return n.naturalOrder(n.sum(e.color),n.sum(t.color))}));var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var i=e.length-1,o=e[i].color;o[0]>251&&o[1]>251&&o[2]>251&&(e[i].color=[255,255,255])}},{quantize:function(e,i){function l(e,t){for(var n,i=1,o=0;o<d;)if((n=e.pop()).count()){var r=s(c,n),a=r[0],l=r[1];if(!a)return;if(e.push(a),l&&(e.push(l),i++),i>=t)return;if(o++>d)return}else e.push(n),o++}if(!e.length||i<2||i>256)return!1;var c=r(e);c.forEach((function(){0}));var p=a(e,c),g=new t((function(e,t){return n.naturalOrder(e.count(),t.count())}));g.push(p),l(g,u*i);for(var h=new t((function(e,t){return n.naturalOrder(e.count()*e.volume(),t.count()*t.volume())}));g.size();)h.push(g.pop());l(h,i-h.size());for(var f=new o;h.size();)f.push(h.pop());return f}}}();return e.prototype.getColor=function(e,t){return this.getPalette(e,5,t)[0]},e.prototype.getPalette=function(e,n,o){(void 0===n||n<2||n>256)&&(n=10),(void 0===o||o<1)&&(o=10);for(var r,a,s,l,c=new t(e),d=c.getImageData().data,u=c.getPixelCount(),p=[],g=0;g<u;g+=o)a=d[(r=4*g)+0],s=d[r+1],l=d[r+2],d[r+3]>=125&&(a>250&&s>250&&l>250||p.push([a,s,l]));var h=i.quantize(p,n),f=h?h.palette():null;return c.removeCanvas(),f},e.prototype.getColorFromUrl=function(e,t,n){sourceImage=document.createElement("img");var i=this;sourceImage.addEventListener("load",(function(){t(i.getPalette(sourceImage,5,n)[0],e)})),sourceImage.src=e},e.prototype.getImageData=function(e,t){xhr=new XMLHttpRequest,xhr.open("GET",e,!0),xhr.responseType="arraybuffer",xhr.onload=function(e){if(200==this.status){uInt8Array=new Uint8Array(this.response),n=uInt8Array.length,binaryString=new Array(n);for(var n=0;n<uInt8Array.length;n++)binaryString[n]=String.fromCharCode(uInt8Array[n]);data=binaryString.join(""),base64=window.btoa(data),t("data:image/png;base64,"+base64)}},xhr.send()},e.prototype.getColorAsync=function(e,t,n){var i=this;this.getImageData(e,(function(e){sourceImage=document.createElement("img"),sourceImage.addEventListener("load",(function(){t(i.getPalette(sourceImage,5,n)[0],this)})),sourceImage.src=e}))},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cropImage=function(e,t){if(!(e instanceof i.GImage))return;t&&r.GEditor.tryRunTransaction(e,(function(){var t=e.getImageTransform();e.setProperties(["trf","ut","tl_sx"],[t,!0,0])}),i.GLocale.get(new i.GLocaleKey("GImageProperties","action.reset-cropping")));var n=gDesigner.getToolManager();n.getActiveTool()instanceof r.GSubSelectTool?(n.activateTool(r.GPointerTool,null,!0),n.getActiveTool().setEditMode(r.GSelectTool.EditMode.Select)):n.activateTool(r.GSubSelectTool,null,!0)},t.replaceImage=function(e,t){if(!(e instanceof i.GImage))return;var n=n||t.getStorage()||gDesigner.getDefaultStorage();if(n&&n.canPromptOpen()){const t=[{ext:"png",mime:"image/png"},{ext:"jpg",mime:"image/jpeg"},{ext:"jpeg",mime:"image/jpeg"},{ext:"gif",mime:"image/gif"}];n.openPrompt(t,t=>{t.read(t=>{var n=new Blob([t]);if(n.size>o.GPlatform.maxPngDataSize)new a(i.GLocale.get(new i.GLocaleKey("GDocument","text.image-too-big"))).open();else{var s=new FileReader;s.onload=()=>{var t=s.result;if(t.length>o.GPlatform.maxImgDataUrlLength)new a(i.GLocale.get(new i.GLocaleKey("GDocument","text.image-too-big"))).open();else{var n=new Image;n.onload=()=>{if(n.naturalHeight>o.GPlatform.maxImgLinearDimension||n.naturalWidth>o.GPlatform.maxImgLinearDimension||n.naturalWidth*n.naturalHeight>o.GPlatform.maxImgAreaDots)new a(i.GLocale.get(new i.GLocaleKey("GDocument","text.image-too-big"))).open();else{var s=gDesigner.getToolManager();s.activateTool(r.GPointerTool),s.getActiveTool()instanceof r.GSelectTool&&s.getActiveTool().setEditMode(r.GSelectTool.EditMode.Select);var l=e.getGeometryBBox(),c=(new i.GTransform).translated(l.getX(),l.getY());r.GEditor.tryRunTransaction(e,()=>{e.setProperties(["url","iw","ih","itrf"],[t,n.naturalWidth,n.naturalHeight,c])},i.GLocale.get(new i.GLocaleKey("GImageProperties","action.replace-image"))),s.getActiveTool()instanceof r.GSelectTool&&s.getActiveTool().setEditMode(r.GSelectTool.EditMode.Edit)}},n.src=t}},s.onerror=function(){new a(i.GLocale.get(new i.GLocaleKey("GDocument","text.image-too-big"))).open()},s.readAsDataURL(n)}})},!1)}},t.setOriginSize=function(e){if(!(e instanceof i.GImage))return;r.GEditor.tryRunTransaction(e,(function(){var t=e.getGeometryBBox(),n=t?t.getX():0,o=t?t.getY():0,r=(new i.GTransform).translated(n,o);e.setProperties(["trf","itrf","pw","ph"],[r,r,e.getWidth(),e.getHeight()])}),i.GLocale.get(new i.GLocaleKey("GImageProperties","action.reset-size")))};var i=n(1),o=n(16),r=n(43),a=(n(1151),n(108),n(143),n(192))},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=n(43),r=n(322),a=n(56),s=n(108),l=(n(143),n(118));function c(){this._pathes=[]}i.GObject.inherit(c,s),c.prototype._panel=null,c.prototype._document=null,c.prototype._pathes=null,c.prototype._points=null,c.prototype.init=function(e,t){this._panel=e;const n=e=>{const t=this._getTargetNodeType($(e.target));this.assignNodeType(t)};var o=function(e){var t=this;if("x"===e||"y"===e)return $("<div/>").append($("<input>").attr("type","text").attr("data-point-property",e).on("change",(function(n){var i=t._document.getScene().stringToPoint($(this).val());"x"===e?gDesigner.stats("pathproperties_modify_x"):gDesigner.stats("pathproperties_modify_y"),null!==i&&"number"==typeof i?t._assignPointProperty(e,i):t._updatePointProperties()})).gInputBox()).gInputLabel({label:e});if("tp"===e)return $("<select></select>").attr("data-point-property",e).append($("<option></option>").attr("value","-").text(i.GLocale.get(new i.GLocaleKey("GPathProperties","text.straight")))).append($("<option></option>").attr("value",i.GPathBase.AnchorPoint.Type.Mirror).text(i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.mirror")))).append($("<option></option>").attr("value",i.GPathBase.AnchorPoint.Type.Asymmetric).text(i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.asymmetric")))).append($("<option></option>").attr("value",i.GPathBase.AnchorPoint.Type.Symmetric).text(i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.symmetric")))).append($("<option></option>").attr("value",i.GPathBase.AnchorPoint.Type.Connector).text(i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.connector")))).on("change",(function(e){n(e)}));if("ctp"===e)return $("<span></span>").addClass("clickable").addClass("g-button").addClass("corner-type").attr("data-point-property",e).gCornerTypePicker().on("cornertypechange",(function(e,n){t._assignPointProperty("tp",n)}));if("cu"===e)return $("<button></button>").addClass("g-flat").attr("data-point-property",e).on("click",(function(){gDesigner.stats("pathproperties_modify_uniform"),t._assignPointProperty(e,!$(this).hasClass("g-active")),t._updatePointProperties()})).append($("<span></span>").addClass("gravit-icon-lock").css("font-size","10px"));if("cl-slider"===e)return $("<div/>").attr("data-point-property","cl").gInputSlider({min:0,max:100,richTooltipConfig:a.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-description"))})}).on("mousedown",(function(){t._document.getEditor().hideSelection(),$(document).one("mouseup",(function(){t._document.getEditor().resetHideSelection()}))})).on("input",(function(){for(var e=t._document.getScene().stringToPoint($(this).gInputSlider("value")),n=0;n<t._points.length;++n)t._points[n].setProperty("cl",e,!1,!1,!0);t._panel.find('[type="text"][data-point-property="cl"]').gInputBox("value",t._document.getScene().pointToString(e,t._document.getScene().getOptimalDecimalsCount()))})).on("change",(function(){var e=t._document.getScene().stringToPoint($(this).gInputSlider("value"));gDesigner.stats("pathproperties_modify_corner"),t._assignPointProperty("cl",e)}));if("cl-input"===e)return $("<input>").attr("type","text").attr("data-point-property","cl").addClass("corner-radius").on("change",(function(){var e=t._document.getScene().stringToPoint($(this).val());null!==e&&"number"==typeof e&&e>=0?(gDesigner.stats("pathproperties_modify_corner"),t._assignPointProperty("cl",e)):t._updatePointProperties()})).gInputBox({minValue:0});throw new Error("Unknown input property: "+e)}.bind(this);$("<div></div>").attr("path-only",!0).gPropertyRow({columns:[{width:"40%",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("closed-checkbox").attr("type","checkbox").attr("data-path-property","closed").on("change",function(e){$(e.target).is(":checked")||this._setBorderAlignmentCenter(),gDesigner.stats("pathproperties_modify_closed"),this._assignPathProperty("closed",$(e.target).is(":checked"))}.bind(this))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GPathProperties","text.closed"))))},{width:"60%",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("csc-checkbox").attr("type","checkbox").attr("data-path-property","csc").on("change",function(e){gDesigner.stats("pathproperties_modify_autoscale"),this._assignPathProperty("csc",$(e.target).is(":checked"))}.bind(this))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.autoscale-corners"))))}]}).appendTo(this._panel),$("<div></div>").addClass("position-row").attr("point-only",!0).gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.position")),columns:[{width:"32%",content:o("x")},{width:"32%",content:o("y")},{width:"auto",content:o("tp")}]}).appendTo(e),$("<div></div>").addClass(r.PATHPROPERTIES.PATH_JOIN_CLASS).addClass("joint-row").attr("point-only",!0).gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GPathProperties","text.joint")),columns:[{width:"25%",padding:!1,content:$("<button></button>").addClass("g-button").css({borderRadius:"0px",borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px"}).attr("data-node-type","-").attr("data-title",i.GLocale.get(new i.GLocaleKey("GPathProperties","text.straight"))).append($("<span></span>").addClass("gravit-icon-node-straight")).on("click",n)},{width:"25%",padding:!1,content:$("<button></button>").addClass("g-button").css({borderRadius:"0px"}).attr("data-node-type",i.GPathBase.AnchorPoint.Type.Mirror).attr("data-title",i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.mirror"))).append($("<span></span>").addClass("gravit-icon-node-mirrored")).on("click",n)},{width:"25%",padding:!1,content:$("<button></button>").addClass("g-button").css({borderRadius:"0px"}).attr("data-node-type",i.GPathBase.AnchorPoint.Type.Asymmetric).attr("data-title",i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.asymmetric"))).append($("<span></span>").addClass("gravit-icon-node-disconnected")).on("click",n)},{width:"25%",padding:!1,content:$("<button></button>").addClass("g-button").css({borderRadius:"0px",borderTopRightRadius:"3px",borderBottomRightRadius:"3px"}).attr("data-node-type",i.GPathBase.AnchorPoint.Type.Symmetric).attr("data-title",i.GLocale.get(new i.GLocaleKey("GPathBase","anchor-point.symmetric"))).append($("<span></span>").addClass("gravit-icon-node-assymetric")).on("click",n)}]}).addClass("joint").appendTo(this._panel),$("<hr/>").attr("point-only",!0).attr("corner-only",!0).appendTo(e),$("<div></div>").attr("point-only",!0).attr("corner-only",!0).addClass("path-corner-chooser").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner")),columns:[{width:"auto",content:o("cl-slider")},{clazz:"corners-radius-no-padding"},{width:"35px",content:o("cl-input")},{width:"3x"},{width:"40px",content:o("ctp")}]}).addClass("corner-radius").appendTo(this._panel)},c.prototype.update=function(e,t){if(gDesigner.isTouchEnabled()?(this._panel.find(".closed-checkbox").gCheckboxSlider(),this._panel.find(".csc-checkbox").gCheckboxSlider()):(this._panel.find(".closed-checkbox").gCheckboxSlider("unmount"),this._panel.find(".csc-checkbox").gCheckboxSlider("unmount")),this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.getScene().removeEventListener(i.GElement.AfterFlagChangeEvent,this._afterFlagChange),this._document.getEditor().removeEventListener(o.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),gDesigner.removeEventListener(l,this._settingChanged),this._document=null),this._pathes=[],this._points=[],e){for(var n=0;n<t.length;++n)if(t[n]instanceof i.GPath||t[n]instanceof i.GCompoundPath){var r=t[n];this._pathes.push(r);var a=function(e){for(var t=e.getAnchorPoints().getFirstChild();null!==t;t=t.getNext())t.hasFlag(i.GNode.Flag.Selected)&&(this._points.push(t),1==this._points.legth&&(this._mainPath=e))}.bind(this);if(r instanceof i.GPath)a(r);else for(var s=r.getPaths().getFirstChild();null!==s;s=s.getNext())a(s)}if(this._pathes.length&&this._pathes.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(i.GElement.AfterFlagChangeEvent,this._afterFlagChange,this),this._document.getEditor().addEventListener(o.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),gDesigner.addEventListener(l,this._settingChanged,this),this._updatePathProperties(),this._updatePointProperties(),!0}return!1},c.prototype._getTargetNodeType=function(e){return e.is("select")?e.val():e.closest("[data-node-type]").attr("data-node-type")},c.prototype._getStatsNodeType=function(e){switch(e){case i.GPathBase.AnchorPoint.Type.Mirror:return"Mirror";case i.GPathBase.AnchorPoint.Type.Asymmetric:return"Asymmetric";case i.GPathBase.AnchorPoint.Type.Symmetric:return"Symmetric";case i.GPathBase.AnchorPoint.Type.Connector:return"Connector";default:return"Straight"}},c.prototype.assignNodeType=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-";gDesigner.stats("pathproperties_assign_nodetype",this._getStatsNodeType(e));const t=this._document,n=t&&t.getEditor();if(n){n.beginTransaction();try{let t=null,o=null;"-"===e&&(t=["tp","hlx","hly","hrx","hry","ah"],o=[i.GPathBase.CornerType.Rounded,null,null,null,null,!1]),this._points.forEach(n=>{if("-"!==e&&(t=["ah","tp"],o=[!1,e],null===n.getProperty("hlx")&&null===n.getProperty("hrx"))){const r=n.getParent().getPreviousPoint(n),a=r?r.getProperty("hrx"):null,s=n.getParent().getNextPoint(n),l=s?s.getProperty("hlx"):null;if(e!=i.GPathBase.AnchorPoint.Type.Asymmetric||null!==a||null!==l)o[0]=!0;else{const e=n.getProperty("x"),a=n.getProperty("y");if(r&&r.getProperty("tp")!=i.GPathBase.AnchorPoint.Type.Connector){const n=r.getProperty("x"),s=r.getProperty("y");if(!i.GMath.isEqualEps(e,n)||!i.GMath.isEqualEps(a,s)){const r=e+(n-e)*i.GPathBase.AnchorPoint.HANDLE_COEFF,l=a+(s-a)*i.GPathBase.AnchorPoint.HANDLE_COEFF;t.push("hlx"),t.push("hly"),o.push(r),o.push(l)}}if(s&&s.getProperty("tp")!=i.GPathBase.AnchorPoint.Type.Connector){const n=s.getProperty("x"),r=s.getProperty("y");if(!i.GMath.isEqualEps(e,n)||!i.GMath.isEqualEps(a,r)){const s=e+(n-e)*i.GPathBase.AnchorPoint.HANDLE_COEFF,l=a+(r-a)*i.GPathBase.AnchorPoint.HANDLE_COEFF;t.push("hrx"),t.push("hry"),o.push(s),o.push(l)}}}}n.setProperties(t,o);let r=n.getProperty("tp");const a=n.getProperty("ah");r==i.GPathBase.AnchorPoint.Type.Mirror&&a&&n.setProperty("ah",!1)})}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPathProperties","action.modify-path-node-type")))}}},c.prototype._afterPropertiesChange=function(e){e.temporary||(this._pathes.length>0&&this._pathes[0]===e.node&&this._updatePathProperties(),this._points.length>0&&this._points[0]===e.node&&this._updatePointProperties())},c.prototype._afterFlagChange=function(e){if(e.flag===i.GNode.Flag.Selected&&e.node instanceof i.GPathBase.AnchorPoint){var t=e.node.getParent()?e.node.getParent().getParent():null,n=t&&t.getParent()&&t.getParent().getParent()?t.getParent().getParent():null;(t&&this._pathes.indexOf(t)>=0||n&&this._pathes.indexOf(n)>=0)&&(e.set?this._points.push(e.node):this._points.splice(this._points.indexOf(e.node),1),this._updatePathProperties(),this._updatePointProperties())}},c.prototype._edGeometryChange=function(e){this._updatePointProperties()},c.prototype._updatePathProperties=function(){if(this._points.length)this._panel.find("[path-only]").css("display","none");else{this._panel.find("[path-only]").css("display","");var e=this._pathes[0];e instanceof i.GPath?(this._panel.find('input[data-path-property="closed"]').prop("disabled",!1).prop("checked",e.getProperty("closed")),this._panel.find('input[data-path-property="csc"]').prop("disabled",!1).prop("checked",!!e.getProperty("csc"))):(this._panel.find('input[data-path-property="closed"]').prop("disabled",!0).prop("checked",!1),this._panel.find('input[data-path-property="csc"]').prop("disabled",!1).prop("checked",!!e.getProperty("csc")))}},c.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updatePointProperties()},c.prototype._updatePointProperties=function(){var e=this._points.length>0?this._points[0]:null;if(e){this._panel.find("[point-only]").css("display","");var t=this._getPointCoord(e);this._panel.find('input[data-point-property="x"]').val(this._document.getScene().pointToString(t.getX(),this._document.getScene().getOptimalDecimalsCount())),this._panel.find('input[data-point-property="y"]').val(this._document.getScene().pointToString(t.getY(),this._document.getScene().getOptimalDecimalsCount()));var n=!0,o=e.getProperty("tp");for(var r in i.GPathBase.AnchorPoint.Type)if(i.GPathBase.AnchorPoint.Type[r]===o){n=!1;break}var a=n?"-":o;this._panel.find('select[data-point-property="tp"]').val(a),this._panel.find("[data-node-type]").each((function(e,t){var n=$(t);n.toggleClass("g-active",n.attr("data-node-type")===a)})),this._panel.find("[corner-only]").css("display",n?"":"none"),this._panel.find('[data-point-property="ctp"]').css("display",n?"":"none").gCornerTypePicker("value",n?o:i.GPathBase.CornerType.Rounded),this._panel.find('div[data-point-property="cl"]').prop("disabled",!n).gInputSlider("value",this._document.getScene().pointToString(e.getProperty("cl"),this._document.getScene().getOptimalDecimalsCount())),this._panel.find('input[data-point-property="cl"]').prop("disabled",!n).val(this._document.getScene().pointToString(e.getProperty("cl"),this._document.getScene().getOptimalDecimalsCount())),this._panel.find('input[data-point-property="cr"]').prop("disabled",!n||e.getProperty("cu")).val(this._document.getScene().pointToString(e.getProperty("cr"),this._document.getScene().getOptimalDecimalsCount())),this._panel.find('button[data-point-property="cu"]').prop("disabled",!n).toggleClass("g-active",!!e.getProperty("cu"))}else this._panel.find("[point-only]").css("display","none")},c.prototype._getPointCoord=function(e){var t,n,r=e.getPath();r&&(t=o.GElementEditor.getEditor(r))?(t.getPaintElement()!=r&&(e=t.getPathPointPreview(e)),n=t.getPointCoord(e)):n=new i.GPoint(e.getProperty("x"),e.getProperty("y"));return n},c.prototype._transformPoint=function(e,t,n){t&&(n=t.mapPoint(n));var i=e.getPath(),r=o.GElementEditor.getEditor(i);r?r.movePoint(e,n):e.setProperties(["x","y"],[n.getX(),n.getY()])},c.prototype._assignPathProperty=function(e,t){this._assignPathProperties([e],[t])},c.prototype._assignPathProperties=function(e,t){var n=this._document.getEditor();n.beginTransaction();try{for(var o=0;o<this._pathes.length;++o)this._pathes[o].setProperties(e,t)}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPathProperties","action.modify-path-properties")))}},c.prototype._setBorderAlignmentCenter=function(){var e,t,n=["_ba"],o=[i.GStylable.BorderAlignment.Center],r=this._document.getEditor();r.beginTransaction();try{for(var a=0,s=this._pathes.length;a<s;++a){e=this._pathes[a].getPaintLayers().getBorderLayers();for(var l=0,c=e.length;l<c;l++)(t=e[l])instanceof i.GStylable.BorderPaintLayer&&t.setProperties(n,o)}}finally{r.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPathProperties","action.modify-path-properties")))}},c.prototype._assignPointProperty=function(e,t){var n=this._document.getEditor();n.beginTransaction();try{for(var o=0;o<this._points.length;++o){var r=this._points[o];if("x"===e){var a=this._getPointCoord(r),s=new i.GTransform(1,0,0,1,t-a.getX(),0);this._transformPoint(r,s,a)}else if("y"===e){a=this._getPointCoord(r),s=new i.GTransform(1,0,0,1,0,t-a.getY());this._transformPoint(r,s,a)}else r.setProperties([e],[t])}}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPathProperties","action.modify-point-properties")))}},c.prototype._assignPointProperties=function(e,t){gDesigner.stats("pathproperties_modify_point-properties");var n=this._document.getEditor();n.beginTransaction();try{for(var o=0;o<this._points.length;++o)this._points[o].setProperties(e,t)}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GPathProperties","action.modify-point-properties")))}},c.prototype.toString=function(){return"[Object GPathProperties]"},e.exports=c},function(e,t,n){"use strict";n(45),n(3);var i=n(1),o=n(56),r=n(108),a=(n(143),n(118));function s(){this._polygons=[]}i.GObject.inherit(s,r),s.prototype._panel=null,s.prototype._advancedPanel=null,s.prototype._document=null,s.prototype._polygons=null,s.prototype.init=function(e,t){this._panel=e;var n=this,r=function(e){if("ir"===e||"or"===e)return $("<input>").addClass("radius-input-"+e).attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("polygonproperties_change_radius");var t=n._document.getScene().stringToPoint($(this).val());null!==t&&"number"==typeof t&&t>=0?n._assignProperty(e,t,i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-radius"))):n._updateProperties()})).gInputBox();if("ia"===e||"oa"===e)return $("<input>").addClass("angle-input-"+e).attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("polygonproperties_change_angle");var t=i.GLength.parseEquationValue($(this).val());null!==t?(t=i.GMath.normalizeAngleRadians(i.GMath.toRadians(t)),n._assignProperty(e,i.GMath.PI2-t,i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-angle")))):n._updateProperties()})).gInputBox({fixedIncrement:!0});if("ict"===e||"oct"===e)return $("<button></button>").addClass("g-flat").attr("data-property",e).gCornerTypePicker().on("cornertypechange",(function(t,o){n._assignProperty(e,o,i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-corner-type")))}));if("icr"===e||"ocr"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(t){gDesigner.stats("polygonproperties_change_corner-radius");var o=n._document.getScene().stringToPoint($(this).val());null!==o&&"number"==typeof o&&o>=0?n._assignProperty(e,o<0?0:o,i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-corner-radius"))):n._updateProperties()})).gInputBox();if("corners-type"!==e){if("corners-radius-slider"===e)return $("<div/>").attr("data-property","corners-radius-slider").gInputSlider({min:0,max:100,richTooltipConfig:o.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-description"))})}).on("mousedown",(function(){n._document.getEditor().hideSelection(),$(document).one("mouseup",(function(){n._document.getEditor().resetHideSelection()}))})).on("input",(function(){var e=n._assignCornersRadius(parseInt($(this).gInputSlider("value"))/100,!0);n._panel.find('[data-property="corners-radius"]').val(n._document.getScene().pointToString(e,n._document.getScene().getOptimalDecimalsCount()))})).on("change",(function(){gDesigner.stats("polygonproperties_change_radius"),n._assignCornersRadius(parseInt($(this).gInputSlider("value"))/100,!1)}));if("corners-radius-input"===e)return $("<input>").attr("type","text").attr("data-property","corners-radius").addClass("corner-radius").on("change",(function(){gDesigner.stats("polygonproperties_change_corners-radius");var e=n._document.getScene().stringToPoint($(this).gInputBox("value"));null!==e&&"number"==typeof e&&e>=0?n._assignCornersRadius(e,!1,!0):n._updateProperties()})).gInputBox({minValue:0,incrementValue:1});throw new Error("Unknown input property: "+e)}};$("<div></div>").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GPolygonProperties","text.points")),columns:[{width:"auto",clazz:"point-slider-wrapper",content:$("<div/>").attr("data-property","pts").gInputSlider({min:3,max:25}).on("input",(function(){var e=$(this).gInputSlider("value");n._assignPoints(parseInt(e),!0),n._panel.find('input[type="text"][data-property="pts"]').val(e)})).on("change",(function(e){gDesigner.stats("polygonproperties_change_number-of-points"),n._assignPoints(parseInt($(this).gInputSlider("value")),!1)}))},{width:"40px",content:$("<input>").attr("type","text").attr("data-property","pts").on("change",(function(e){gDesigner.stats("polygonproperties_change_number-of-points"),n._assignPoints(i.GLength.parseEquationValue($(this).gInputBox("value")),!1)})).gInputBox({minValue:3})}]}).appendTo(this._panel),$("<div></div>").attr("data-plain-edges","false").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.size")),columns:[{width:"auto",clazz:"size-slider-wrapper",content:$("<div/>").attr("data-property","size").gInputSlider({min:0,max:100}).on("input",(function(){var e=parseInt($(this).gInputSlider("value"));n._assignSize(e/100,!0),n._panel.find('[type="text"][data-property="size"]').gInputBox("value",i.GUtil.formatNumber(e,0))})).on("change",(function(){gDesigner.stats("polygonproperties_change_plain-edges"),n._assignSize(parseInt($(this).gInputSlider("value"))/100,!1)}))},{width:"40px",content:$("<input>").attr("type","text").attr("data-property","size").on("change",(function(){gDesigner.stats("polygonproperties_change_plain-edges"),n._assignSize(i.GLength.parseEquationValue($(this).gInputBox("value"))/100,!1)})).gInputBox({minValue:0,maxValue:100,postfix:"%"})}]}).appendTo(this._panel),$("<hr/>").appendTo(this._panel),$("<div></div>").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner")),columns:[{width:"auto",clazz:"corners-radius-slider-wrapper",content:r("corners-radius-slider")},{clazz:"corners-radius-no-padding"},{clazz:"corners-radius-input-wrapper",content:r("corners-radius-input")},{width:"3px"},{clazz:"advanced-settings-col",content:$("<div></div>").attr("data-title",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.advanced-settings"))).addClass("g-button g-icon g-advanced-setting").css({display:"flex",justifyContent:"center"}).append($("<span></span>").addClass("gravit-icon-settings").css({alignSelf:"center",lineHeight:"19px"})).on("click",function(e){gDesigner.stats("polygonproperties_click_advanced-corners"),this._advancedPanel.gOverlay("open",$(e.target).closest(".g-button")),gDesigner.isTouchEnabled()?(this._advancedPanel.find(".edges-checkbox").gCheckboxSlider(),this._advancedPanel.find(".csc-checkbox").gCheckboxSlider()):(this._advancedPanel.find(".edges-checkbox").gCheckboxSlider("unmount"),this._advancedPanel.find(".csc-checkbox").gCheckboxSlider("unmount"));var t=$('div[data-property="corners-type"]');t.gCornerTypePicker("update",t.gCornerTypePicker("value"))}.bind(this))}]}).addClass("corner-radius").appendTo(this._panel),this._advancedPanel=$("<div></div>").addClass("advanced-panel-wrapper").gOverlay({releaseOnClose:!1,clazz:"advanced-overlay"}),$("<div></div>").gPropertyRow({columns:[{width:"100%",content:$("<div/>").css("margin-bottom","10px").attr("data-property","corners-type").addClass("corner-type").gCornerTypePicker({notOverlay:!0}).on("cornertypechange",(function(e,t){n._assignProperties(["ict","oct"],[t,t],i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-corner-type")))}))}]}).appendTo(this._advancedPanel),$("<div></div>").addClass("g-checkbox-label-wrapper").gPropertyRow({columns:[{width:"100%",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("edges-checkbox").attr("type","checkbox").attr("data-property","edges").on("change",(function(){gDesigner.stats("polygonproperties_toggle_plain-edges",$(this).is(":checked")?"enabled":"disabled"),n._assignEdges($(this).is(":checked")),n._updateProperties()}))).append($("<span>"+i.GLocale.get(new i.GLocaleKey("GPolygonProperties","text.plain-edges"))+"</span>"))}]}).appendTo(this._advancedPanel),$("<div></div>").addClass("g-checkbox-label-wrapper").gPropertyRow({columns:[{width:"100%",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("csc-checkbox").attr("type","checkbox").attr("data-property","csc").on("change",function(e){gDesigner.stats("polygonproperties_toggle_autoscale-corners",$(e.target).is(":checked")?"enabled":"disabled"),this._assignProperty("csc",$(e.target).is(":checked"))}.bind(this))).append($("<span>"+i.GLocale.get(new i.GLocaleKey("GCommonNames","text.autoscale-corners"))+"</span>"))}]}).appendTo(this._advancedPanel),$("<div></div>").addClass("corner-row-wrapper").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GPolygonProperties","text.corners")),columns:[{width:"50%",content:$("<div></div>").addClass("corner-wrapper").append(r("ocr")).append(r("oct")),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.outside"))},{width:"50%",content:$("<div></div>").addClass("corner-wrapper").append(r("icr")).append(r("ict")),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.inside"))}]}).appendTo(this._advancedPanel),$("<div></div>").addClass("radius-row-wrapper").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.radius")),columns:[{width:"50%",content:r("or"),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.outside"))},{width:"50%",content:r("ir"),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.inside"))}]}).appendTo(this._advancedPanel),$("<div></div>").addClass("angles-row-wrapper").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.angles")),columns:[{width:"50%",content:r("oa"),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.outside"))},{width:"50%",content:r("ia"),label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.inside"))}]}).appendTo(this._advancedPanel)},s.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),gDesigner.removeEventListener(a,this._settingChanged),this._document=null),this._polygons=[],e){for(var n=0;n<t.length;++n)t[n]instanceof i.GPolygon&&this._polygons.push(t[n]);if(this._polygons.length&&this._polygons.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.addEventListener(a,this._settingChanged,this),this._updateProperties(!0),!0}return!1},s.prototype._afterPropertiesChange=function(e){!e.temporary&&this._polygons.length>0&&this._polygons[0]===e.node&&this._updateProperties()},s.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateProperties()},s.prototype._updateProperties=function(e){var t=this._polygons[0],n=t.getProperty("or"),o=t.getProperty("ir"),r=t.getProperty("pts"),a=o/n*100,s=t.isPlainEdges(),l=t.getProperty("ocr");this._panel.find('.g-input-slider[data-property="pts"]').gInputSlider("value",r),this._panel.find('[type="text"][data-property="pts"]').gInputBox("value",r),this._panel.find('.g-input-slider[data-property="size"]').gInputSlider("value",Math.round(a)),this._panel.find('[type="text"][data-property="size"]').gInputBox("value",i.GUtil.formatNumber(a,0)),this._advancedPanel.find('[data-property="corners-type"]').gCornerTypePicker("value",t.getProperty("oct"));var c=t.getPointsMinDistance();s||(c/=2),l=Math.min(l,c);var d=c>0?l/c*100:0;this._panel.find('[data-property="corners-radius-slider"]').gInputSlider("value",Math.round(d)),this._panel.find('[data-property="corners-radius"]').val(this._document.getScene().pointToString(t.getProperty("ocr"),this._document.getScene().getOptimalDecimalsCount())),e&&s?this._advancedPanel.find('input[data-property="edges"]').prop("checked",!0):s||this._advancedPanel.find('input[data-property="edges"]').prop("checked",!1),this._advancedPanel.find('input[data-property="csc"]').prop("checked",!!t.getProperty("csc")),this._advancedPanel.find('button[data-property="oct"]').gCornerTypePicker("value",t.getProperty("oct")),this._advancedPanel.find('button[data-property="ict"]').gCornerTypePicker("value",t.getProperty("ict")),this._advancedPanel.find('input[data-property="ocr"]').val(this._document.getScene().pointToString(t.getProperty("ocr"),this._document.getScene().getOptimalDecimalsCount())),this._advancedPanel.find('input[data-property="icr"]').val(this._document.getScene().pointToString(t.getProperty("icr"),this._document.getScene().getOptimalDecimalsCount())),this._advancedPanel.find('input[data-property="or"]').val(this._document.getScene().pointToString(t.getProperty("or"),this._document.getScene().getOptimalDecimalsCount())),this._advancedPanel.find('input[data-property="ir"]').val(this._document.getScene().pointToString(t.getProperty("ir"),this._document.getScene().getOptimalDecimalsCount())),this._advancedPanel.find('input[data-property="oa"]').val(i.GUtil.formatNumber(i.GMath.toDegrees(i.GMath.PI2-t.getProperty("oa")),2)),this._advancedPanel.find('input[data-property="ia"]').val(i.GUtil.formatNumber(i.GMath.toDegrees(i.GMath.PI2-t.getProperty("ia")),2)),this._panel.find('[data-plain-edges="false"]').css("display",this._advancedPanel.find('input[data-property="edges"]').prop("checked")?"none":"")},s.prototype._assignCornersRadius=function(e,t,n){t||this._document.getEditor().beginTransaction();var o=0;try{for(var r=0;r<this._polygons.length;++r){var a=this._polygons[r];if(a.isVisible()){var s=e;if(!n)s=e*a.getPointsMinDistance();a.isPlainEdges()?a.setProperties(["ocr"],[s],!1,!1,t):(n||(s/=2),a.setProperties(["ocr","icr"],[s,s],!1,!1,t)),0===r&&(o=s)}}}finally{t||this._document.getEditor().commitTransaction(i.GLocale.get(new i.GLocaleKey("GCommonNames","action.change-corners")))}return o},s.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},s.prototype._assignProperties=function(e,t,n){var i=this._document.getEditor();i.beginTransaction();try{for(var o=0;o<this._polygons.length;++o)this._polygons[o].setProperties(e,t)}finally{i.commitTransaction(n)}},s.prototype._assignSize=function(e,t){t||this._document.getEditor().beginTransaction();try{for(var n=0;n<this._polygons.length;++n){var o=this._polygons[n],r=o.getProperty("or")*e;o.setProperty("ir",r,!1,!1,t)}}finally{t||this._document.getEditor().commitTransaction(i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-polygon-size")))}},s.prototype._assignPoints=function(e,t){t||this._document.getEditor().beginTransaction();try{for(var n=0;n<this._polygons.length;++n){var o=this._polygons[n],r=o.isPlainEdges(),a=Math.PI/e,s=i.GMath.normalizeAngleRadians(o.getProperty("oa")+a);if(r){var l=o.getProperty("or")*Math.cos(a);o.setProperties(["pts","ia","ir"],[e,s,l],!1,!1,t)}else o.setProperties(["pts","ia"],[e,s],!1,!1,t)}}finally{t||this._document.getEditor().commitTransaction(i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-polygon-points")))}},s.prototype._assignEdges=function(e,t){if(e){t||this._document.getEditor().beginTransaction();try{for(var n=0;n<this._polygons.length;++n){var o=this._polygons[n],r=o.getProperty("or"),a=o.getProperty("pts"),s=o.getProperty("oa"),l=Math.PI/a,c=s+l,d=r*Math.cos(l);o.setProperties(["ir","ia"],[d,c],!1,!1,t)}}finally{t||this._document.getEditor().commitTransaction(i.GLocale.get(new i.GLocaleKey("GPolygonProperties","action.change-polygon-size")))}}},s.prototype.toString=function(){return"[Object GPolygonProperties]"},e.exports=s},function(e,t,n){"use strict";n(45),n(3);var i=n(1),o=n(43),r=n(56),a=n(108),s=(n(143),n(118));function l(){this._rectangles=[]}i.GObject.inherit(l,a),l.prototype._panel=null,l.prototype._advancedPanel=null,l.prototype._document=null,l.prototype._rectangles=null,l.prototype.isGroup=function(e){return!0},l.prototype.init=function(e,t){this._panel=e;var n=this,a=function(e){if("uf"===e)return $("<input>").addClass("uf-checkbox").attr("type","checkbox").attr("data-property",e).on("change",(function(){gDesigner.stats("rectangleproperties_toggle_uniform",$(this).is(":checked")?"enabled":"disabled"),n._assignProperty(e,$(this).is(":checked")),n._updateProperties()}));if("csc"===e)return $("<input>").addClass("csc-checkbox").attr("type","checkbox").attr("data-property",e).on("change",(function(){gDesigner.stats("rectangleproperties_toggle_scale-corners",$(this).is(":checked")?"enabled":"disabled"),n._assignProperty(e,$(this).is(":checked"))}));if("tl_sx"===e||"tl_sy"===e||"tr_sx"===e||"tr_sy"===e||"bl_sx"===e||"bl_sy"===e||"br_sx"===e||"br_sy"===e){var t="";return"tl_sy"!==e&&"tr_sy"!==e&&"bl_sy"!==e&&"br_sy"!==e||(t="sy-input"),$("<input>").addClass("corner-input").addClass(t).attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("rectangleproperties_scale_individual-corners");var t=n._document.getScene().stringToPoint($(this).val());null!==t&&"number"==typeof t&&t>=0?n._assignProperty(e,t):n._updateProperties()})).gInputBox()}if("tl_ct"===e||"tr_ct"===e||"bl_ct"===e||"br_ct"===e){var a=0,s="right";return"tl_ct"===e?(a=270,s="left"):"bl_ct"===e?(a=180,s="left"):"br_ct"===e&&(a=90),$("<button></button>").addClass("g-flat").addClass(s).attr("data-property",e).css("width","32px").gCornerTypePicker({rotate:a}).on("cornertypechange",(function(t,i){n._assignProperty(e,i)}))}if("tl_uf"===e||"tr_uf"===e||"bl_uf"===e||"br_uf"===e){var l="uf-right";return"tl_uf"!==e&&"bl_uf"!==e||(l="uf-left"),$("<button></button>").addClass("g-flat").addClass("uf-btn").addClass(l).attr("data-property",e).on("click",(function(){gDesigner.stats("rectangleproperties_toggle_individual-uniform-corners"),n._assignProperty(e,!$(this).hasClass("g-active")),n._updateProperties()})).append($("<span></span>").addClass("gravit-icon-lock"))}if("corners-type"!==e){if("corners-radius-slider"===e)return $("<div/>").attr("data-property","corners-radius").gInputSlider({min:0,max:100,richTooltipConfig:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner-radius-slider-tooltip-description")),learnMore:"https://documentation.designer.io/basics/shapes-paths/#advanced-corner-settings"})}).on("mousedown",(function(){n._document.getEditor().hideSelection(),$(document).one("mouseup",(function(){n._document.getEditor().resetHideSelection()}))})).on("input",(function(){var e=n._assignCorners(parseInt($(this).gInputSlider("value"))/100,void 0,!0),t=n._document.getScene().getProperty("ut"),r=(t==i.GLength.Unit.PX||t==i.GLength.Unit.PT)&&o.GGuides.options.guides&&o.GGuides.options.guides.indexOf(o.GFullPixelsGuide.ID)>=0?0:n._document.getScene().getOptimalDecimalsCount();n._panel.find('[type="text"][data-property="corners-radius"]').val(n._document.getScene().pointToString(e,r))})).on("change",(function(){gDesigner.stats("rectangleproperties_input_corners-radius"),n._assignCorners(parseInt($(this).gInputSlider("value"))/100,void 0,!1)}));if("corners-radius-input"===e)return $("<input>").attr("type","text").attr("data-property","corners-radius").addClass("corner-radius").on("change",(function(){gDesigner.stats("rectangleproperties_slide_corners-radius");var e=n._document.getScene().stringToPoint($(this).gInputBox("value"));null!==e&&"number"==typeof e&&e>=0?n._assignProperties(["uf","tl_sx"],[!0,e]):n._updateProperties()})).gInputBox({minValue:0});throw new Error("Unknown input property: "+e)}}.bind(this),s=i.GLocale.get(new i.GLocaleKey("GRectangleProperties","text.uniform-corner-smoothness")),l=i.GLocale.get(new i.GLocaleKey("GRectangleProperties","text.horizontal-corner-smoothness")),c=i.GLocale.get(new i.GLocaleKey("GRectangleProperties","text.vertical-corner-smoothness")),d=i.GLocale.get(new i.GLocaleKey("GRectangleProperties","text.corner-type"));this._advancedPanel=$("<div></div>").addClass("advanced-panel-wrapper").addClass("rectangle-properties").gOverlay({releaseOnClose:!1,clazz:"advanced-overlay"}).append($("<div/>").css("margin-bottom","10px").attr("data-property","corners-type").addClass("corner-type").gCornerTypePicker({notOverlay:!0}).on("cornertypechange",(function(e,t){n._assignCorners(void 0,t)}))).append($("<label></label>").addClass("g-checkbox-label").append(a("csc")).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.autoscale-corners"))))).append($("<label></label>").addClass("g-checkbox-label").append(a("uf")).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GRectangleProperties","text.uniform-corners"))))).append($("<div></div>").addClass("corners-panel").append($("<div></div>").addClass("corners-item-row with-padding").append(a("tl_ct").attr("data-title",s)).append(a("tl_sx").attr("data-title",l)).append(a("tr_sx").attr("data-title",l)).append(a("tr_ct").attr("data-title",s))).append($("<div></div>").addClass("corners-item-row with-padding").append(a("tl_sy").attr("data-title",c)).append(a("tl_uf").attr("data-title",d)).append(a("tr_uf").attr("data-title",d)).append(a("tr_sy").attr("data-title",c))).append($("<div></div>").addClass("corners-item-row with-padding").append(a("bl_sy").attr("data-title",c)).append(a("bl_uf").attr("data-title",d)).append(a("br_uf").attr("data-title",d)).append(a("br_sy").attr("data-title",c))).append($("<div></div>").addClass("corners-item-row with-padding").append(a("bl_ct").attr("data-title",s)).append(a("bl_sx").attr("data-title",l)).append(a("br_sx").attr("data-title",l)).append(a("br_ct").attr("data-title",s)))),$("<div></div>").gPropertyRow({label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.corner")),columns:[{width:"auto",clazz:"corners-radius-slider-wrapper",content:a("corners-radius-slider")},{clazz:"corners-radius-no-padding"},{clazz:"corners-radius-input-wrapper",content:a("corners-radius-input")},{width:"3px"},{clazz:"advanced-settings-col",content:$("<div></div>").attr("data-title",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.advanced-settings"))).addClass("g-button g-icon g-advanced-setting").css({display:"flex",justifyContent:"center"}).append($("<span></span>").addClass("gravit-icon-settings").css({alignSelf:"center",lineHeight:"19px"})).on("click",function(e){gDesigner.stats("rectangleproperties_open_advanced"),this._advancedPanel.gOverlay("open",$(e.target).closest(".g-button")),gDesigner.isTouchEnabled()?(this._advancedPanel.find(".uf-checkbox").gCheckboxSlider(),this._advancedPanel.find(".csc-checkbox").gCheckboxSlider()):(this._advancedPanel.find(".uf-checkbox").gCheckboxSlider("unmount"),this._advancedPanel.find(".csc-checkbox").gCheckboxSlider("unmount"));var t=$('div[data-property="corners-type"]');t.gCornerTypePicker("update",t.gCornerTypePicker("value"))}.bind(this))}]}).addClass("corner-radius").appendTo(this._panel)},l.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),gDesigner.removeEventListener(s,this._settingChanged),this._document=null),this._rectangles=[],e){for(var n=0;n<t.length;++n)t[n]instanceof i.GRectangle&&this._rectangles.push(t[n]);if(this._rectangles.length&&this._rectangles.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.addEventListener(s,this._settingChanged,this),this._updateProperties(),!0}return!1},l.prototype._afterPropertiesChange=function(e){!e.temporary&&this._rectangles.length>0&&this._rectangles[0]===e.node&&this._updateProperties()},l.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateProperties()},l.prototype._updateProperties=function(){var e=this._rectangles[0],t=e.getProperty("tl_sx"),n=e.getGeometryBBox(),r=this._panel.find('.g-input-slider[data-property="corners-radius"]'),a=this._panel.find('input[type="text"][data-property="corners-radius"]'),s=this._advancedPanel.find('[data-property="corners-type"]'),l=null===n;if(r.prop("disabled",l),a.prop("disabled",l),this._panel.find("button").prop("disabled",l),l)s.addClass("g-disabled");else{s.removeClass("g-disabled");var c=t/(e.getPointsMinDistance()/2)*100,d=this._document.getScene().getProperty("ut"),u=(d==i.GLength.Unit.PX||d==i.GLength.Unit.PT)&&o.GGuides.options.guides&&o.GGuides.options.guides.indexOf(o.GFullPixelsGuide.ID)>=0?0:this._document.getScene().getOptimalDecimalsCount();r.gInputSlider("value",Math.round(c)),a.gInputBox("value",this._document.getScene().pointToString(t,u)),s.gCornerTypePicker("value",e.getProperty("tl_ct")),this._advancedPanel.find('input[data-property="csc"]').prop("disabled",l||e instanceof i.GImage).prop("checked",!!e.getProperty("csc"));var p=e.getProperty("uf");if(this._advancedPanel.find('input[data-property="uf"]').prop("checked",p),p)this._advancedPanel.find(".corners-panel").css("display","none");else this._advancedPanel.find(".corners-panel").css("display",""),function(t){for(var n=0;n<t.length;++n){var i=t[n],o=this._advancedPanel.find('button[data-property="'+i+'_uf"]'),r=this._advancedPanel.find('input[data-property="'+i+'_sx"]'),a=this._advancedPanel.find('input[data-property="'+i+'_sy"]'),s=this._advancedPanel.find('button[data-property="'+i+'_ct"]');r.val(this._document.getScene().pointToString(e.getProperty(i+"_sx"),u)),a.val(this._document.getScene().pointToString(e.getProperty(i+"_sy"),u)),e.getProperty(i+"_uf")?(o.addClass("g-active"),a.prop("disabled",!0)):(o.removeClass("g-active"),a.prop("disabled",!1)),o.prop("disabled",p),s.gCornerTypePicker("value",e.getProperty(i+"_ct"))}}.bind(this)(["tl","tr","bl","br"])}},l.prototype._assignCorners=function(e,t,n){n||this._document.getEditor().beginTransaction();var o=0;try{for(var r=0;r<this._rectangles.length;++r)if(this._rectangles[r].isVisible()){var a=this._rectangles[r].getProperty("tl_sx"),s=this._rectangles[r].getProperty("tl_ct");if(0===a&&"string"==typeof t&&"number"!=typeof e&&(e=.25),"number"==typeof e){this._rectangles[r].getGeometryBBox();a=e*(this._rectangles[r].getPointsMinDistance()/2)}"string"==typeof t&&(s=t),0===r&&(o=a),this._rectangles[r].setProperties(["uf","tl_sx","tl_ct"],[!0,a,s],!1,!1,n)}}finally{n||this._document.getEditor().commitTransaction(i.GLocale.get(new i.GLocaleKey("GCommonNames","action.change-corners")))}return o},l.prototype._assignProperty=function(e,t){this._assignProperties([e],[t])},l.prototype._assignProperties=function(e,t){var n=this._document.getEditor();n.beginTransaction();try{for(var o=0;o<this._rectangles.length;++o)this._rectangles[o].setProperties(e,t)}finally{n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GRectangleProperties","action.modify-rectangle-properties")))}},l.prototype.toString=function(){return"[Object GRectangleProperties]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(43),a=i(n(309)),s=n(108),l=(n(143),n(118));function c(){this._slices=[]}o.GObject.inherit(c,s),c.prototype._panel=null,c.prototype._document=null,c.prototype._slices=null,c.prototype._ownChange=!1,c.prototype._chooserElem=null,c.prototype.init=function(e,t){this._panel=e,this._panel.addClass("slice-property-panel"),this.setTouchTools([a.default.APPEARANCE_TOUCH_TOOL]);var n=function(e){var t=this;if("x"===e||"y"===e||"w"===e||"h"===e)return $("<input>").addClass(e+"-input").attr("type","text").attr("data-property",e).on("change",function(n){gDesigner.stats("sliceproperties_change_size"),t._assignProperty(e,t._document.getScene().stringToPoint($(n.target).gInputBox("value")))}.bind(t)).gInputBox({minValue:"w"===e||"h"===e?1e-10:null});if("cls"===e)return $("<button></button>").attr("data-property",e).gPatternChooser({types:[o.GColor],hasOpacity:!1}).on("chooseropen",(function(){t._document.getEditor().hideSelection(),t._chooserElem=$(this)})).on("chooserclose",(function(e,n,i){t._document&&t._document.getEditor().resetHideSelection(),t._chooserElem=null})).on("patternchange",function(n,i,o,r,a){var s=null;a&&(s={chooserOn:!0,slicePattern:!0}),t._assignProperty(e,i,r,s)}.bind(t));if("cls-check"===e)return $("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("cls-check-checkbox").attr("type","checkbox").attr("data-property",e).on("change",function(e){gDesigner.stats("sliceproperties_change_background"),t._assignProperty("cls",$(e.target).is(":checked")?o.GRGBColor.WHITE:null)}.bind(t))).append($("<span>"+o.GLocale.get(new o.GLocaleKey("GCommonNames","text.background-color"))+"</span>"));if("trm"===e)return $("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("trm-checkbox").attr("type","checkbox").attr("data-property",e).on("change",function(n){gDesigner.stats("sliceproperties_trim_transparent"),t._assignProperty(e,$(n.target).is(":checked"))}.bind(t))).append($("<span>"+o.GLocale.get(new o.GLocaleKey("GSliceProperties","text.trim-transparent-pixels"))+"</span>"));throw new Error("Unknown input property: "+e)}.bind(this);$("<div></div>").addClass("slice-position-left-row").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.left")),columns:[{width:"44%",content:n("x")}]}).appendTo(e),$("<div></div>").addClass("slice-position-top-row").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.top")),columns:[{width:"44%",content:n("y")}]}).appendTo(e),$("<div></div>").addClass("slice-size-width-row").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width")),columns:[{width:"44%",content:n("w")}]}).appendTo(e),$("<div></div>").addClass("slice-size-height-row").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.height")),columns:[{width:"44%",content:n("h")}]}).appendTo(e),$("<div></div>").addClass("slice-trm-row").gPropertyRow({columns:[{width:"100%",content:n("trm")}]}).appendTo(e),$("<div></div>").addClass("slice-bg-row").gPropertyRow({columns:[{width:"80%",content:n("cls-check")},{width:"20%",content:n("cls")}]}).appendTo(e)},c.prototype.update=function(e,t,n){if(this._updateUI(),this._ownChange)return!0;if(this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._document&&(this._document.getScene().removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.removeEventListener(l,this._settingChanged),this._document=null),this._slices=[],e){for(var i=0;i<t.length;++i)t[i]instanceof o.GSlice&&this._slices.push(t[i]);if(this._slices.length&&this._slices.length===t.length)return this._document=e,this._document.getScene().addEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.addEventListener(l,this._settingChanged,this),this._updateProperties(n),!0}return!1},c.prototype._updateUI=function(){let e=e=>{e.prev().remove()},t=(e,t)=>{e.prev().length||$("<span/>").addClass("g-input-label").text(t).insertBefore(e)},n=this._panel.find(".slice-position-left-row .property-label span"),i=this._panel.find(".slice-size-width-row .property-label span"),r=this._panel.find(".x-input"),a=this._panel.find(".y-input"),s=this._panel.find(".w-input"),l=this._panel.find(".h-input");gDesigner.isTouchEnabled()?(this._panel.find(".trm-checkbox").gCheckboxSlider(),this._panel.find(".cls-check-checkbox").gCheckboxSlider(),n.text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.position"))),i.text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.size"))),t(r,"x"),t(a,"y"),t(s,"w"),t(l,"h")):(this._panel.find(".trm-checkbox").gCheckboxSlider("unmount"),this._panel.find(".cls-check-checkbox").gCheckboxSlider("unmount"),n.text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.left"))),i.text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width"))),e(r),e(a),e(s),e(l))},c.prototype._afterPropertiesChange=function(e){!e.temporary&&this._slices.length>0&&this._slices[0]===e.node&&this._updateProperties()},c.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateProperties(),"touch"===e.key&&this._updateUI()},c.prototype._updateProperties=function(e){var t=this._document.getScene(),n=this._slices[0],i=function(e){var i=this._panel.find('input[data-property="'+e+'"]');this._slices.length>1?i.gInputBox("value",null).prop("disabled",!0):i.gInputBox("value",t.pointToString(n.getProperty(e),t.getOptimalDecimalsCount())).prop("disabled",!1)}.bind(this);i("x"),i("y"),i("w"),i("h");var o=n.getProperty("cls");this._panel.find('[data-property="cls-check"]').prop("checked",!!o),this._panel.find('[data-property="cls"]').prop("disabled",!o).gPatternChooser("value",n.getProperty("cls")),this._panel.find('input[data-property="trm"]').prop("checked",n.getProperty("trm")),e&&(e.evtType==r.GEditor.ModifiedEvent.Type.Undo||e.evtType==r.GEditor.ModifiedEvent.Type.Redo)&&e.chooserOn&&e.slicePattern&&this._panel.find('[data-property="cls"]').find(".preview").trigger("click")},c.prototype._assignProperty=function(e,t,n,i){this._assignProperties([e],[t],n,i)},c.prototype._assignProperties=function(e,t,n,i){if(n)for(var r=0;r<this._slices.length;++r)this._slices[r].setProperties(e,t,!0);else{this._ownChange=!0;var a=this._document.getEditor();a.beginTransaction();try{for(r=0;r<this._slices.length;++r)this._slices[r].setProperties(e,t)}finally{a.commitTransaction(o.GLocale.get(new o.GLocaleKey("GSliceProperties","action.modify-slice-properties")),i||null),this._ownChange=!1}}},c.prototype.toString=function(){return"[Object GSliceProperties]"},e.exports=c},function(e,t,n){"use strict";n(14),n(63),n(45),n(3),n(168),n(19),n(24),n(9),n(129),n(83),n(171),n(297),n(28),n(58);var i=n(43),o=n(1),r=n(16),a=n(32),s=n(56),l=n(108),c=n(230),d=n(531),u=n(118),p=n(36);const g=n(128),{toCapitalize:h}=n(32),{LISTS_FEATURE:f}=n(12);var m="#2635#";const y={None:{get label(){return o.GLocale.get(new o.GLocaleKey("GTextProperties","text.marker-none"))},value:"none"},Bullet:{get label(){return o.GLocale.get(new o.GLocaleKey("GTextProperties","text.marker-bulleted"))},value:"bulleted",types:[{icon:"gravit-icon-bullets-1",value:o.GText.Markers.Bullet},{icon:"gravit-icon-bullets-2",value:o.GText.Markers.Check},{icon:"gravit-icon-bullets-3",value:o.GText.Markers.Square}]},Number:{get label(){return o.GLocale.get(new o.GLocaleKey("GTextProperties","text.marker-numbered"))},value:"numbered",types:[{icon:"gravit-icon-numbers-1",value:o.GText.Markers.RomanDot},{icon:"gravit-icon-numbers-2",value:o.GText.Markers.RomanBracket},{icon:"gravit-icon-numbers-3",value:o.GText.Markers.Number}]}};function v(){this._text=[],this._weightsAvailable=[]}o.GObject.inherit(v,l),v.prototype._panel=null,v.prototype._document=null,v.prototype._text=null,v.prototype._ownChange=!1,v.prototype._chooserElem=null,v.prototype._openingInlineEditor=!1,v.prototype._weightsAvailable=null,v.prototype._advancedSettings=null,v.prototype._listTypeSettings=null,v.prototype._advancedSettingsButton=null,v.prototype._scriptBlock=null,v.prototype._sizingBlock=null,v.prototype._autoScrollBlock=null,v.prototype.init=function(e,t){this._panel=e.addClass("text-properties-panel"),this._advancedSettings=this._getAdvancedSettingsOverlayDiv(),this._listTypeSettings=$("<div></div>").addClass("list-type-settings").append($("<div></div>").addClass("list-type-options").append(Object.values(y).map(e=>{let{label:t,value:n,types:i}=e;return $("<div></div>").addClass("list-type-group").attr("value",n).append($("<div/>").addClass("list-type-group-header").append($("<span/>").addClass("gravit-icon-check")).append($("<span/>").text(t))).on("click",i?null:()=>this._assignMarker(null)).append($("<div/>").addClass("list-type-group-container").append(i?i.map(e=>{let{value:t,icon:n}=e;return $("<div></div>").addClass("list-type-option").attr("value",t).append($("<div/>").addClass(n)).on("click",e=>{const t=$(e.target).closest(".list-type-option").attr("value");gDesigner.stats("textproperties_change_list-type",t),this._assignMarker(t)})}):""))}))).gOverlay({releaseOnClose:!1,clazz:"list-type-settings-overlay"});var n=function(e){var t=this;if("_pm"===e)return $("<div></div>").attr("data-property",e).addClass("g-select").append($("<span/>")).on("click",a.watchDog.trap(e=>{this._listTypeSettings.gOverlay("open",$(e.target))},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e)));if(0===e.indexOf("typography")){const n=e.substr("typography-".length);return $("<button></button>").addClass("g-button").addClass("typography-button").attr("data-property",e).on("click",a.watchDog.trap(e=>{gDesigner.stats("textproperties_change_typography",n),t._toggleFormatting(n)},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))).append($("<span></span>").addClass("gravit-icon-text-typography-".concat(n)))}if(0===e.indexOf("_ttsc")){const n=e.substr("_ttsc-".length);return $("<button></button>").addClass("g-button").addClass("script-button").attr("data-property",e).on("click",a.watchDog.trap(e=>{gDesigner.stats("textproperties_change_typography",n),t._assignProperty("_ttsc",$(e.target).closest("button").hasClass("g-active")?null:n)},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))).append($("<span></span>").addClass("gravit-icon-text-typography-".concat(n,"script")))}if("_tlsc"===e){var n=$("<select></select>").attr("data-property","_tlsc");return n.append($("<option></option>").attr("value","auto").text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.auto")))),n.on("change",(function(e){gDesigner.stats("textproperties_change_language-script",$(e.target).val()),t._assignProperty("_tlsc",$(e.target).val())})),n}if("_tv"===e)return $("<select />").attr("data-property","_tv").on("change",a.watchDog.trap(e=>{var n=$(e.target).text();gDesigner.stats("textproperties_change_variation",n),t._assignProperty("_tv",$(e.target).val())},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e)));if(0===e.indexOf("_ttrf-")){var r="",s=e.substr("_ttrf-".length);switch(s){case o.GStylable.TextTransformation.Uppercase:r="gravit-icon-text-transform-uppercase";break;case o.GStylable.TextTransformation.Lowercase:r="gravit-icon-text-transform-lowercase";break;case o.GStylable.TextTransformation.Capitalize:r="gravit-icon-text-transform-capitalize";break;case o.GStylable.TextTransformation.SmallCaps:r="gravit-icon-text-transform-smallcaps"}var l=Object.keys(o.GStylable.TextTransformation).find(e=>o.GStylable.TextTransformation[e]===s);return $("<button></button>").addClass("g-button").addClass("transformation-button").attr("data-property",e).on("click",a.watchDog.trap(e=>{gDesigner.stats("textproperties_change_transformation",l?l.toLowerCase():""),t._assignProperty("_ttrf",$(e.target).closest("button").hasClass("g-active")?null:s)},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))).append($("<span></span>").addClass(r))}if(0===e.indexOf("va-")){r="";switch(d=e.substr("va-".length)){case o.GText.VerticalAlign.Top:r="gravit-icon-text-align-top";break;case o.GText.VerticalAlign.Middle:r="gravit-icon-text-align-middle";break;case o.GText.VerticalAlign.Bottom:r="gravit-icon-text-align-bottom"}return $("<button></button>").addClass("g-button").addClass("vertical-align").attr("data-property",e).on("click",(function(){gDesigner.stats("textproperties_change_vertical-align",d===o.GText.VerticalAlign.Top?"top":o.GText.VerticalAlign.Middle?"middle":"bottom"),t._assignProperty("va",$(this).hasClass("g-active")?null:d)})).append($("<span></span>").addClass(r))}if(0===e.indexOf("_pal-")){var d;r="";switch(d=e.substr("_pal-".length)){case o.GStylable.ParagraphAlignment.Left:r="gravit-icon-text-align-left";break;case o.GStylable.ParagraphAlignment.Center:r="gravit-icon-text-align-center";break;case o.GStylable.ParagraphAlignment.Right:r="gravit-icon-text-align-right";break;case o.GStylable.ParagraphAlignment.Justify:r="gravit-icon-text-justify"}return $("<button></button>").addClass("g-button").addClass("alignment-button").attr("data-property",e).on("click",(function(){gDesigner.stats("textproperties_change_paragraph-align",d===o.GStylable.ParagraphAlignment.Left?"left":d===o.GStylable.ParagraphAlignment.Right?"right":d===o.GStylable.ParagraphAlignment.Justify?"justify":d===o.GStylable.ParagraphAlignment.Center?"center":"unkn"),t._assignProperty("_pal",$(this).hasClass("g-active")?null:d)})).append($("<span></span>").addClass(r))}if("aw"===e||"ah"===e)return $("<div></div>").attr("data-property",e).append($("<button></button>").addClass("sizing-button-auto").addClass("g-group-start g-button").on("click",()=>{gDesigner.stats("textproperties_change_auto-widthheight","auto"),t._assignProperty(e,!0)}).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.auto")))).append($("<button></button>").addClass("sizing-button-fixed").addClass("g-group-end g-button").on("click",()=>{gDesigner.stats("textproperties_change_auto-widthheight","fixed"),t._assignProperty(e,!1)}).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.fix"))));if("_fc"===e)return $("<div></div>").prop("disabled",!0).attr("data-property","_fc").attr("id","text-color").gPatternChooser({types:[o.GColor],hasOpacity:!1}).on("chooseropen",(function(){t._document.getEditor().hideSelection(),t._chooserElem=$(this)})).on("chooserclose",(function(e,n,i){t._document&&t._document.getEditor().resetHideSelection(),t._chooserElem=null})).on("patternchange",function(e,n,o,r,a){for(var s=[],l=0;l<this._text.length;l++){var c=i.GElementEditor.getEditor(this._text[l]);s.push(c||this._text[l])}var d=null;a&&(d={chooserOn:!0,textPattern:!0});var u=this._getProperty("_fc",s);u||(u=this._getFontColor(s)),t._assignProperty("_fc",n,r,d)}.bind(this));if("_tff"===e)return $("<input/>").addClass("g-select").attr("data-property",e).attr("type","button").gFontsButton({closeCallback:function(){t._document&&t._document.getActiveWindow().getView().focus()},assignFontCallback:function(e){t._assignFont(e)}});if("_tfi"===e)return $("<div></div>").append($("<input>").attr("type","text").attr("data-property",e).addClass("g-select").addClass("text-size").on("change",(function(){gDesigner.stats("textproperties_change_size");var n=$(this).gUnitBox("value"),i=n?n.toUnit(o.GLength.Unit.PT):null;null===i||"number"==typeof i&&i>=0?t._assignProperty(e,i):t._updateProperties()})).gUnitBox({source:"text"}));if("_tws"===e||"_tcs"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){"_tws"===e?gDesigner.stats("textproperties_change_wordspacing"):gDesigner.stats("textproperties_change_charspacing");var n=t._document;if(n){var i=n.getScene().stringToPoint($(this).val());null===i||"number"==typeof i?t._assignProperty(e,i):t._updateProperties()}})).gInputBox();if("style"===e)return $("<select></select>").attr("data-property",e).on("change",(function(){gDesigner.stats("textproperties_choose_fontstyle");var e=$(this).val()||null;if(e){var n=gDesigner.getWorkspace().getFontManager().getDefaultFont(),i=e.split(m);i[0]=parseInt(i[0])||400;var o=[i[0],i[1]],r=["_tfw","_tfs"];i[2]&&i[2].length&&i[2]!==n.getFamily()&&(r.push("_tff"),o.push(i[2])),t._assignProperties(r,o)}t._document.getActiveWindow().getView().focus()}));if(0!==e.indexOf("tpth")){if("_plh"===e)return $("<div>").addClass("text-line-height").append($("<input>").attr("type","text").attr("data-property",e).addClass("value").on("change",(function(){gDesigner.stats("textproperties_change_line-height");var n=$(this).val(),i=t._document.getScene(),r=t._panel.find('button[data-property="_plh_unit"]').text();if("%"!==r){let e=o.GLength.parseEquation(n,i.getProperty("ut"));e&&(n=e.toUnit(o.GLength.Unit.PX))}else n=o.GUtil.parseNumber(n);null===n||n>0||"%"!==r&&0===n?("number"==typeof n&&("%"===r?n/=100:n=String(n)),t._assignProperty(e,n)):t._updateProperties()})).gInputBox()).append($("<button>").addClass("g-flat").attr("data-property","_plh_unit").addClass("text-unit").text("%").on("click",(function(){gDesigner.stats("textproperties_change_size");var n=$(this).text(),r=t._document.getScene(),a=t._panel.find('input[data-property="_plh"]').val(),s=t._document.getEditor();if("%"!==n){let e=o.GLength.parseEquation(a,r.getProperty("ut"));e&&(a=e.toUnit(o.GLength.Unit.PX))}else a=o.GUtil.parseNumber(a);if(null!==a&&"%"===n){var l=r.getProperty("ut")||"px";if($(this).text(l),"number"==typeof a)try{s.beginTransaction();for(var c=0;c<t._text.length;c++){var d=i.GElementEditor.getEditor(t._text[c])||t._text[c],u=(a/100*(p=t._getProperty("_tfi",[d])||20)*4/3).toString();d.setProperties([e],[u])}}finally{s.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties")))}}else if(null!==a&&($(this).text("%"),"number"==typeof a))try{s.beginTransaction();for(c=0;c<t._text.length;c++){d=i.GElementEditor.getEditor(t._text[c])||t._text[c];var p=t._getProperty("_tfi",[d])||20;u=Math.round(100*Math.max(a/(4*p/3),.01))/100;d.setProperties([e],[u])}}finally{s.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties")))}})));if("fontSet"===e)return $("<input/>").attr("type","checkbox").attr("data-property",e).on("change",(function(e){gDesigner.stats("textproperties_change_set-of-fonts");var t=$(this).prop("checked");gDesigner.setSetting("font-set",t);var n=gContainer.getSystemFontsProvider();t?c.enableProviders([n]):c.disableProviders([n])}));if("sc"===e)return $("<label></label>").append($("<input>").addClass("auto-scale-checkbox").attr("type","checkbox").attr("data-property",e).on("change",function(e){gDesigner.stats("textproperties_scale_content"),t._assignProperty("sc",$(e.target).is(":checked"))}.bind(this))).append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.scale-content"))));if(0===e.indexOf("decoration-")){var u=e.substr("decoration-".length);return $("<button></button>").addClass("g-button").addClass("decoration-buttons").attr("data-property",e).attr("data-title",h(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.decoration-".concat(u))))).on("click",(function(){gDesigner.stats("textproperties_change_decoration",u),t._toggleFormatting(u)})).append($("<span></span>").addClass("gravit-icon-text-decoration-".concat(u)))}if("_pas"===e)return $("<div></div>").addClass("text-paragraph-spacing").append($("<input>").attr("type","text").addClass("value").attr("data-property",e).on("click",a.watchDog.trap(null,null,t=>{t.stopPropagation(),t.preventDefault(),gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e)})).on("change",a.watchDog.trap(n=>{const i=t._document;if(!i)return;gDesigner.stats("textproperties_change_paragraph-spacing");const r=t._advancedSettings.find('button[data-property="_pas_unit"]').text();let a=null;if("%"!==r){let e=o.GLength.parseEquation($(n.target).closest("input").val(),i.getScene().getProperty("ut"));e&&(a=e.toUnit(o.GLength.Unit.PX))}else a=o.GUtil.parseNumber($(n.target).closest("input").val());null===a||"number"==typeof a&&a>=0?("number"==typeof a&&("%"===r?a/=100:a=String(a)),t._assignProperty(e,a)):t._updateProperties()},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))).gInputBox({minValue:0,allowEmptyValue:!1})).append($("<button>").addClass("g-flat").addClass("unit").attr("data-property","_pas_unit").text("px").on("click",a.watchDog.trap(e=>{const n=t._document;if(!n)return;const r=n.getScene(),a=$(e.target).text(),s="%"===a?r.getProperty("ut")||"px":"%";gDesigner.stats("textproperties_change_paragraph-spacing-unit",s),$(e.target).text(s);let l=null;if("%"!==a){let e=o.GLength.parseEquation(t._advancedSettings.find('input[data-property="_pas"]').val(),r.getProperty("ut"));e&&(l=e.toUnit(o.GLength.Unit.PX))}else l=o.GUtil.parseNumber(t._advancedSettings.find('input[data-property="_pas"]').val());if(!isNaN(l)){const e=t._text.map(e=>i.GElementEditor.getEditor(e)||e),n=t._getProperty("_tfi",e)||20;let o;o="%"===s?Math.round(100*parseFloat(l/(4*n/3)))/100:String(l/100*n*4/3),t._assignProperties(["_pas"],[o])}},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))));if("_pai"===e)return $("<input>").attr("type","text").attr("data-property",e).on("click",a.watchDog.trap(null,null,t=>{t.stopPropagation(),t.preventDefault(),gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e)})).on("change",a.watchDog.trap(n=>{const i=t._document;if(!i)return;gDesigner.stats("textproperties_change_paragraph-indent");const o=i.getScene().stringToPoint($(n.target).closest("input").val());null===o||"number"==typeof o&&o>=0?t._assignProperty(e,o):t._updateProperties()},null,t=>gDesigner.stats("textproperties_nonprotriespro_advanced-settings",e))).gInputBox({minValue:0,allowEmptyValue:!1});if("dir"===e)return $("<select></select>").attr("data-property","dir").append($("<option></option>").attr("value",o.GTLDirectionTextTransformer.LTR).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.orientation-ltr")))).append($("<option></option>").attr("value",o.GTLDirectionTextTransformer.RTL).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.orientation-rtl")))).append($("<option></option>").attr("value",o.GTLDirectionTextTransformer.TTB).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.orientation-ttb")))).on("change",(function(e){var n="";switch(parseInt($(e.target).val())){case o.GTLDirectionTextTransformer.LTR:n="ltr";break;case o.GTLDirectionTextTransformer.RTL:n="rtl";break;case o.GTLDirectionTextTransformer.TTB:n="ttb";break;case o.GTLDirectionTextTransformer.BTT:n="btt"}gDesigner.stats("textproperties_change_orientation",n),t._assignProperty("dir",parseInt($(e.target).val()))}));if("_tlocl"===e)return this._createLanguageSelector();if("_tstyls"===e)return this._createStylisticSetSelector();throw new Error("Unknown input property: "+e)}return"tpthd"===e?$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-property",e).on("change",(function(){gDesigner.stats("textproperties_change_path-attachment","direction"),t._assignProperty(e,$(this).is(":checked")?o.GTLPathTextTransformer.DIRECTION_OUTWARDS:o.GTLPathTextTransformer.DIRECTION_INWARDS)}))).append($("<div></div>")):"tpths"===e?$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-property",e).on("change",(function(){gDesigner.stats("textproperties_change_path-attachment","insideoutside"),t._assignProperty(e,$(this).is(":checked")?o.GTLPathTextTransformer.OUTSIDE:o.GTLPathTextTransformer.INSIDE)}))).append($("<div></div>")):"tptho"===e?$("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("textproperties_change_path-attachment","offset");var n=t._document.getScene().stringToPoint($(this).val());null===n||"number"==typeof n?t._assignProperty(e,n):t._updateProperties()})).gInputBox():void 0}.bind(this);$("<div></div>").addClass("typography-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography")),columns:[{width:"100%",label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography")),content:$("<div></div>").addClass("typography").append(n("_ttsc-"+o.GStylable.TypographyScript.Subscript).addClass("g-group-start").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography-subscript")))).append(n("_ttsc-"+o.GStylable.TypographyScript.Superscript).addClass("g-group-end").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography-superscript")))).append(n("typography-ligatures").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography-ligatures")))).append(n("typography-fractions").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.typography-fractions"))))}]}).appendTo(this._advancedSettings),$("<div></div>").addClass("transform-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform")),columns:[{width:"100%",label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform")),content:$("<div></div>").append(n("_ttrf-"+o.GStylable.TextTransformation.Uppercase).addClass("g-group-start").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform-uppercase")))).append(n("_ttrf-"+o.GStylable.TextTransformation.Capitalize).addClass("g-group-element").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform-capitalize")))).append(n("_ttrf-"+o.GStylable.TextTransformation.Lowercase).addClass("g-group-element").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform-lowercase")))).append(n("_ttrf-"+o.GStylable.TextTransformation.SmallCaps).addClass("g-group-end").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.transform-smallcaps"))))}]}).appendTo(this._advancedSettings),f&&($("<div></div>").addClass("list-type-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.list-type")),columns:[{width:"100%",label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.list-type")),content:n("_pm")}]}).appendTo(this._advancedSettings),$("<hr/>").appendTo(this._advancedSettings)),$("<div></div>").addClass("paragraph-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.paragraph")),columns:[{width:"50%",label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.paragraph-indent")),content:n("_pai")},{width:"50%",label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.paragraph-spacing")),content:n("_pas")}]}).appendTo(this._advancedSettings),$("<hr/>").appendTo(this._advancedSettings),$("<div></div>").addClass("language-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.language")),columns:[{width:"100%",content:n("_tlocl")}]}).appendTo(this._advancedSettings),$("<hr/>").appendTo(this._advancedSettings),$("<div></div>").addClass("stylistic-set-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.stylisticset")),columns:[{width:"100%",content:n("_tstyls")}]}).appendTo(this._advancedSettings),this._advancedSettingsButton=this._getAdvancedSettingsButton().appendTo(t);var r=$("<div/>").addClass("color-font").appendTo(e);$("<div></div>").addClass("font-color-properties").gPropertyRow({columns:[{clazz:"color-picker-button",padding:!1,content:n("_fc")},{width:"auto",content:n("_tff")}]}).appendTo(r),$("<div></div>").addClass("font-style-properties").gPropertyRow({columns:[{clazz:"color-title-label",content:$("<span>".concat(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.color")),"</span>")).addClass("color-title")},{width:"auto",content:n("style"),label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.weight"))},{width:"25%",content:n("_tfi"),label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.size"))}]}).appendTo(r),$("<hr/>").appendTo(e),$("<div></div>").addClass("decoration-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.decoration")),columns:[{width:"25%",content:n("decoration-bold")},{width:"25%",content:n("decoration-italic")},{width:"25%",content:n("decoration-underline")},{width:"25%",content:n("decoration-strikeout")}]}).appendTo(e),$("<hr/>").appendTo(e),$("<div></div>").addClass("alignment-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.alignment")),columns:[{width:"100%",content:$("<div></div>").append(n("_pal-"+o.GStylable.ParagraphAlignment.Left).addClass("g-group-start").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-left")))).append(n("_pal-"+o.GStylable.ParagraphAlignment.Center).addClass("g-group-element").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-center")))).append(n("_pal-"+o.GStylable.ParagraphAlignment.Right).addClass("g-group-element").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-right")))).append(n("_pal-"+o.GStylable.ParagraphAlignment.Justify).addClass("g-group-end").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","action.justify"))))}]}).appendTo(e),$("<div></div>").addClass("vertical-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.vertical")),columns:[{width:"auto",content:$("<div></div>").append(n("va-"+o.GText.VerticalAlign.Top).addClass("g-group-start").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-top")))).append(n("va-"+o.GText.VerticalAlign.Middle).addClass("g-group-element").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-middle")))).append(n("va-"+o.GText.VerticalAlign.Bottom).addClass("g-group-end").attr("data-title",o.GLocale.get(new o.GLocaleKey("GAlignAction","title.align-bottom"))))}]}).appendTo(e),$("<div></div>").addClass("spacing-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.spacing")),columns:[{label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.char")),width:"30%",content:n("_tcs")},{label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.word")),width:"30%",content:n("_tws")},{label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.line")),width:"40%",content:n("_plh")}]}).appendTo(e),$("<hr/>").appendTo(e),this._sizingBlock=$("<div></div>").addClass("sizing-properties").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.sizing")),columns:[{width:"50%",content:n("aw"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width"))},{width:"50%",content:n("ah"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.height"))}]}).appendTo(e),this._scriptBlock=$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.script")),columns:[{width:"50%",content:n("dir")},{width:"50%",content:n("_tlsc")}]}).appendTo(this._panel),this._autoScrollBlock=$("<div></div>").addClass("auto-scale-font").attr("major-item-only",!0).gPropertyRow({columns:[{width:"auto",content:n("sc")}]}).appendTo(this._panel),$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.on-path")),columns:[{width:"30%",content:n("tpths"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.outside"))},{width:"30%",content:n("tpthd"),label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.reverse"))},{width:"40%",content:n("tptho"),label:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.distance"))}]}).appendTo(e),e.find("button").each((function(e,t){$(t).attr("tabindex",-1)})),this._reInitLayout(),gDesigner.addEventListener(u,this._touchChanged,this)},v.prototype._createLanguageSelector=function(){return $("<select/>").attr("data-property","_tlocl").gPro().on("mousedown",a.watchDog.trap()).on("change",a.watchDog.trap(e=>{const t=$(e.target).closest("select").val();this._assignProperties(["_tlocl"],[t||null]),gDesigner.stats("textproperties_change_language")}))},v.prototype._createStylisticSetSelector=function(){return $("<select/>").attr("data-property","_tstyls").gPro().on("mousedown",a.watchDog.trap()).on("change",a.watchDog.trap(e=>{const t=$(e.target).closest("select").val();this._assignProperties(["_tstyls"],[t||null]),gDesigner.stats("textproperties_change_stylistic-set")}))},v.prototype.openEyeDropper=function(e,t){this._panel.find('[data-property="_fc"]').gPatternChooser("openEyeDropper",e,t)},v.prototype._getAdvancedSettingsOverlayDiv=function(){return $("<div></div>").gOverlay({releaseOnClose:!1,clazz:gDesigner.isEnabledProFeatures()?"g-overlay-advanced-setting":"dialog-expired-pro g-overlay-advanced-setting"})},v.prototype._getAdvancedSettingsButton=function(){var e=gDesigner.getLicense();return $("<button></button>").attr("data-action","text-settings").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTextProperties","text.advanced-text-settings"))).append($("<span></span>").addClass("gravit-icon-settings")).on("click",e=>{gDesigner.stats("textproperties_open_advanced-settings"),this._advancedSettings.gOverlay("open",$(e.target).closest("button"))}).gPro().gRichTooltip(s.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.advanced-properties-icon-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTextProperties","text.advanced-properties-icon-tooltip-description")),isPro:!gDesigner.isEnabledProFeatures()||!(e.isPro()&&!e.isExpired()),learnMore:"https://documentation.designer.io/working-with-text/advanced-text-properties/"}))},v.prototype.update=function(e,t,n){if(this._ownChange)return!0;if(this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._document&&(this._document.getScene().removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.getEditor().removeEventListener(i.GEditor.InlineEditorEvent,this._inlineEditorEvent),this._document.getEditor().removeEventListener(i.GEditor.HotkeyEvent,this._hotKeyEvent,this),gDesigner.removeEventListener(u,this._settingChanged),this._document=null),this._text=[],e){for(var r=!1,a=0;a<t.length;++a)t[a]instanceof o.GText?this._text.push(t[a]):t[a]instanceof o.GStyle&&t[a].getProperty("_sdf")===o.GObject.getTypeId(o.GText)&&(this._text.push(t[a]),r=!0);if(this._text.length&&this._text.length===t.length||r)return this._document=e,this._document.getScene().addEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getEditor().addEventListener(i.GEditor.InlineEditorEvent,this._inlineEditorEvent,this),this._document.getEditor().addEventListener(i.GEditor.HotkeyEvent,this._hotKeyEvent,this),gDesigner.addEventListener(u,this._settingChanged,this),this._updateProperties(n),this._advancedSettingsButton.css("display",""),!0}return this._advancedSettingsButton.css("display","none"),!1},v.prototype._settingChanged=function(e){if("font-set"===e.key){var t=this._panel.find('input[data-property="fontSet"]');t.length&&t.prop("checked")!==!!e.newValue&&t.prop("checked",!!e.newValue)}else"decimals_num"===e.key&&this._updateProperties()},v.prototype._touchChanged=function(e){"touch"===e.key&&this._reInitLayout()},v.prototype._reInitLayout=function(){gDesigner.isTouchEnabled()?(this._autoScrollBlock.insertAfter(this._sizingBlock),this._autoScrollBlock.find(".auto-scale-checkbox").gCheckboxSlider()):(this._autoScrollBlock.insertAfter(this._scriptBlock),this._autoScrollBlock.find(".auto-scale-checkbox").gCheckboxSlider("unmount"))},v.prototype._afterPropertiesChange=function(e){const t=this._text.length>0&&this._text[this._text.length-1];!e.temporary&&t&&(t===e.node||t instanceof o.GStyle||t instanceof o.GText&&t.getContent()===e.node)&&(this._updateProperties(),t instanceof o.GText&&t.hasEmbeddedFonts()&&this._document.getEditor().closeInlineEditor())},v.prototype._hotKeyEvent=function(e){const t={B:"bold",I:"italic",U:"underline",S:"strikeout"},[n,i,...o]=e.keys;!n||n!==r.GKey.Constant.CONTROL||!(i in t)||o&&o.length||gDesigner.stats("textproperties_hotkey_change-decoration",t[i])},v.prototype._inlineEditorEvent=function(e){switch(e.type){case i.GEditor.InlineEditorEvent.Type.AfterOpen:case i.GEditor.InlineEditorEvent.Type.AfterClose:case i.GEditor.InlineEditorEvent.Type.SelectionChanged:this._updateProperties();break;case i.GEditor.InlineEditorEvent.Type.TryOpen:this._tryOpenInlineEditor();break;case i.GEditor.InlineEditorEvent.Type.BeforeClose:case i.GEditor.InlineEditorEvent.Type.TextEdited:this._tryModifyingInitialFont(e.type,e.data&&e.data.wasModifiedBefore)}},v.prototype._tryModifyingInitialFont=function(e,t){if(this._document&&this._text&&1===this._text.length){var n=this._text[0];if(!n.getProperty("_we")){var r=n instanceof o.GText&&n.getTLCore();if(r&&(e===i.GEditor.InlineEditorEvent.Type.BeforeClose&&r.getWasEdited()||e===i.GEditor.InlineEditorEvent.Type.TextEdited&&!t)){var a=r.getDocumentRange().plainText(),s=c.getProviderInstance(d).getDefaultFamilyForString(a),l=gDesigner.getWorkspace()&&gDesigner.getWorkspace().getFontManager()&&gDesigner.getWorkspace().getFontManager().getDefaultFont()&&gDesigner.getWorkspace().getFontManager().getDefaultFont().getFamily();if(s&&l&&l!==s){var u=o.GOpenTypeFont.getDirectionForString(a);u!==o.GTLDirectionTextTransformer.LTR?n.setProperties(["_tff","dir"],[s,u]):n.setProperty("_tff",s)}}}}},v.prototype._tryOpenInlineEditor=function(){if(this._document&&this._text&&1===this._text.length&&!this._openingInlineEditor){var e=this._text[0];e.isFakeText()&&p.confirm(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.edit")),t=>{if(t){i.GEditor.tryRunTransaction(e,()=>{e.replaceFonts(gDesigner.getWorkspace().getFontManager().getDefaultFont(),e.hasEmbeddedFonts())},"Replace fonts"),this._openingInlineEditor=!0;try{this._document.getEditor().openInlineEditor(e,this._document.getActiveWindow().getView())}finally{this._openingInlineEditor=!1}}},o.GLocale.get(new o.GLocaleKey("GLocale","no")),o.GLocale.get(new o.GLocaleKey("GLocale","yes")))}},v.prototype._intersectArrays=function(e,t){return null===e?t:null===t?e:e.filter((function(e){return-1!==t.indexOf(e)}))},v.prototype._getFormatting=function(e,t){const n=t.length;if(0===n)return null;const r=function(t){let n;if(t instanceof i.GTextEditor?n=t.getElement():t instanceof o.GText&&(n=t),n){const t=n.getTLCore();if(t){let o;const r=i.GElementEditor.getEditor(n);if(o=r&&r.isInlineEdit()?t.selectedRange():t.getDocumentRange(),o)return o.getFormatting()[e]}}return null};let a=r(t[0]);for(let e=1;e<n;e++)if(r(t[e])!==a)return null;return a},v.prototype._getProperty=function(e,t,n){var i=t.length;if(0==i)return null;for(var o=t[0].getProperty(e),r=1;r<i;r++)if(t[r].getProperty(e)!==o)return null;return o||!isNaN(o)?o:3===arguments.length?n:o},v.prototype._getFontColor=function(e){var t=e[0]instanceof i.GElementEditor?e[0].getElement():e[0];if(!(t&&t instanceof o.GText))return null;var n=t.getTLCore().getRichContent();return n&&n.length?t._getGravitValue("fontColor",n[0].fontColor):null},v.prototype._updateProperties=async function(e){var t,n=(ye=gDesigner.getWorkspace().getFontManager()).getDefaultFont(),r=null,a=null;if(!n)return;t=[];for(var s=0;s<this._text.length;s++){var l=i.GElementEditor.getEditor(this._text[s]);t.push(l||this._text[s])}var c=this._panel.find('input[data-property="fontSet"]');c.length&&c.prop("checked",gDesigner.getSetting("font-set"),!1);var d=this._getFormatting("underline",t)||null,u=this._getFormatting("strikeout",t)||null,p=this._getFormatting("fractions",t)||!1,h=this._getFormatting("listMarker",t)||null,f=this._getProperty("_pai",t,o.GStylable.PropertySetInfo.P.geometryProperties._pai),v=this._getProperty("_pas",t,o.GStylable.PropertySetInfo.P.geometryProperties._pas),_=(this._getProperty("_tv",t),this._getProperty("_tlsc",t)),b=this._getProperty("_ttsc",t),w=this._getProperty("_ttrf",t)||null,C=this._getProperty("_tfw",t)||"",E=this._getProperty("_tfs",t)||"",S=this._getProperty("aw",t)||!1,G=this._getProperty("ah",t)||!1,A=this._getProperty("sc",t)||!1,T=this._getProperty("va",t)||"",P=this._getProperty("_tfi",t),L=this._getProperty("_fc",t),D=this._getProperty("_tws",t),x=this._getProperty("_tcs",t),I=(this._getProperty("_fop",t),this._getProperty("_pal",t)),O=this._getProperty("_plh",t),k=this._getProperty("tpthd",t),F=this._getProperty("tpths",t),R=this._getProperty("tptho",t),M=this._getProperty("dir",t),N=this._getProperty("_tlocl",t),B=this._getProperty("_tstyls",t),U=this._getFormatting("ligatures",t);U="auto"===U?!x:!!U,L||(L=this._getFontColor(t));var K=this._document&&this._document.getEditor(),j=K&&K.isInlineEditing()&&K.getCurrentInlineEditorNode()instanceof o.GText,H=t.every((function(e){return e.hasPathAttached&&e.hasPathAttached()}));this._advancedSettings.find('[data-property^="_ttsc"]').each((function(e,t){var n=$(t),i=n.attr("data-property").substr("_ttsc-".length);n.toggleClass("g-active",b===i)})),this._advancedSettings.find('[data-property^="_ttrf"]').each((function(e,t){var n=$(t),i=n.attr("data-property").substr("_ttrf-".length);n.toggleClass("g-active",w===i)})),this._advancedSettings.find('[data-property="_pai"]').gInputBox("value",null!==f?this._document.getScene().pointToString(f,this._document.getScene().getOptimalDecimalsCount()):"");const V=this._advancedSettings.find('button[data-property="_pas_unit"]');if("number"==typeof v)V.text("%"),this._advancedSettings.find('[data-property="_pas"]').val(o.GUtil.formatNumber(100*v,this._document.getScene().getOptimalDecimalsCount()));else if("string"==typeof v){const e=this._document.getScene();V.text(e.getProperty("ut")||"px"),this._advancedSettings.find('[data-property="_pas"]').val(e.pointToString(v,e.getOptimalDecimalsCount()))}else this._advancedSettings.find('[data-property="_pas"]').val("");var z=T||o.GText.VerticalAlign.Top,W=this._panel.find('button[data-property^="va"]');W.each((function(e,t){var n=$(t);n.prop("disabled",j||H).toggleClass("g-active",n.attr("data-property")==="va-"+z)})),W.closest(".g-property-row").css("display",H||G||j?"none":""),this._panel.find('[data-property="ah"] button').each((e,t)=>{var n=$(t);n.prop("disabled",j).toggleClass("g-active",n.is(":first-child")===G)});var q=this._panel.find('[data-property="aw"] button');q.each((e,t)=>{var n=$(t);n.prop("disabled",j).toggleClass("g-active",n.is(":first-child")===S)});var Y=this._panel.find('select[data-property="dir"]');Y.prop("disabled",j),j||Y.val(M),this._panel.find('[data-property="sc"]').prop("checked",A),q.closest(".g-property-row").css("display",H?"none":""),this._panel.find('input[data-property="tpthd"]').prop("checked",k===o.GTLPathTextTransformer.DIRECTION_OUTWARDS),this._panel.find('input[data-property="tpths"]').prop("checked",F===o.GTLPathTextTransformer.OUTSIDE),this._panel.find('input[data-property="tptho"]').val(R).closest(".g-property-row").css("display",H?"":"none");var X=function(){setTimeout(this._updateProperties.bind(this),1)}.bind(this),Q=this._panel.find('input[data-property="_tff"]'),Z=Q.gFontsButton("getFontList"),J=null,ee=!0,te=!0;let ne,ie;for(s=0;s<t.length;s++){const e=t[s];let r;if(r=e instanceof i.GTextEditor?e.getFonts():[e.getProperty("_tff")],1==t.length){var oe=e instanceof i.GTextEditor?e.getElement():e;if(oe instanceof o.GText){var re=oe.hasFontsToResolve();if(re&&re.length&&oe.isFakeText()){var ae=re[0].getFamily();ae&&(J=ae)}}}for(var se=0;se<r.length;se++){let e,t=r[se];if(t?t===n.getFamily()?e=t:(e=Z.gFontsPanel("fontDisplayName",t,X),void 0===e&&(X=null,e=t)):(t="",e=t),void 0===ne)ne=e;else if(ne!==e){ne="",ee=!1,te=!1;break}void 0===ie?ie=t:ie!==t&&(te=!1,ie="")}}for(s=0;s<t.length;s++){var le=null,ce=null;let e;e=t[s]instanceof i.GTextEditor?t[s].getFonts():[t[s].getProperty("_tff")||n.getFamily()];for(se=0;se<e.length;se++){var de=e[se];let t;de===n.getFamily()?(le=ye.getDefaultFontWeights(),le=o.GUtil.unique(le),ce=le.map((function(e){return{weight:e,styles:ye.getDefaultFontStyles().map(e=>e+m+(ee?n.getFamily():"")+m)}}))):Z&&(void 0===(le=await Z.gFontsPanel("weightsForFont",de,X))&&(X=null),le=le||[],le=o.GUtil.unique(le),ce=le.map((function(e){for(var t=Z.gFontsPanel("stylesForWeight",e,de),n=Z.gFontsPanel("subfamiliesForWeight",e,de),i=0;i<n.length;i++)t[i]=t[i]+m+(ee?n[i].realName:"")+m+(n[i].subFamily||"");return{weight:e,styles:t}}))),r=o.GUtil.unique(this._intersectArrays(r,le)),a?(t=a,t=t.filter(e=>{if(r.indexOf(e.weight)>=0){var t=ce.find(t=>t.weight===e.weight);if(!t)return!1;var n=[];if(e.styles=e.styles.filter(e=>{var i=e.split(m)[0];if(i&&i.length){var o=t.styles.find(e=>{if(e.startsWith(i))return!0});if(o)return o!==e?(n.push(i+m+m),!0):(n.push(e),!0)}}),e.styles=n,e.styles.length)return!0}return!1})):t=ce.filter(e=>r.indexOf(e.weight)>=0),a=t}}J?Q.val(J):Q.val(ne),Q[0]===document.activeElement&&Q[0].select(),this._panel.find('input[data-property="_tfi"]').gUnitBox({unit:this._document&&this._document.getScene().$ut===o.GLength.Unit.PX?o.GLength.Unit.PX:o.GLength.Unit.PT,list:[6,7,8,9,10,11,12,14,18,21,24,36,48,60,72],source:"text"}).gUnitBox("value",null!==P?new o.GLength(P,o.GLength.Unit.PT):null),this._panel.find('[data-property="_fc"]').gPatternChooser("value",L);var ue=this._panel.find('select[data-property="style"]');ue.empty(),a&&a.length||(a=[{weight:400,styles:[o.GFont.Style.Normal]}]),r&&r.length||(r=[400]);for(s=100;s<=900;s+=100)if(r.indexOf(s)>=0){for(var pe=null,ge=0;ge<a.length;ge++)if(a[ge].weight===s){pe=a[ge].styles;break}for(ge=0;pe&&ge<pe.length;ge++){let e;var he=pe[ge].split(m);e=he[0]===o.GFont.Style.Italic?o.GLocale.get(o.GFont.WeightNameItalic[s]):o.GLocale.get(o.GFont.WeightName[s]),he[2]&&he[2].length&&0!=e.indexOf(he[2])&&(e=he[2]+" "+e);var fe=s.toString()+m+he[0]+m+(he[1]||"");$("<option></option>").attr("value",fe).text(e).appendTo(ue)}}this._advancedSettings.find('[data-property="_ttrf-'.concat(o.GStylable.TextTransformation.SmallCaps,'"]')).prop("disabled",!1),this._advancedSettings.find('[data-property="typography-fractions"]').prop("disabled",!1),this._advancedSettings.find('[data-property="typography-ligatures"]').toggleClass("g-active",!0===U),this._advancedSettings.find('[data-property="typography-fractions"]').toggleClass("g-active",!0===p);var me=this._panel.find('select[data-property="_tlsc"]');me.empty(),me.append($("<option></option>").attr("value","auto").text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.auto"))));var ye,ve=(ye=gDesigner.getWorkspace().getFontManager()).getFont(te&&t[0]&&t[0].getProperty("_tff")||n.getFamily(),E,C);if(ve.isResolved()){ve.hasFeature(o.GFont.Features.SmallCaps)||this._advancedSettings.find('[data-property="_ttrf-'.concat(o.GStylable.TextTransformation.SmallCaps,'"]')).prop("disabled",!0);var _e=ve.getAvailableScripts();for(s=0;s<_e.length;s++){var be=_e[s];if(be){var we=be.toLowerCase().split("");we[0]=we[0].toUpperCase(),be=we.join(""),me.append($("<option></option>").attr("value",_e[s]).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.".concat(be.toLowerCase())),be)))}}}([...new Set(t.map(e=>{let t=[],n=e.getProperty("_tff"),r=e.getProperty("_tfs"),a=e.getProperty("_tfw");if(e instanceof i.GTextEditor&&!n){const i=e.getElement().getContent();if(i){const s=o.GText.PropertyMapping._tff,l=o.GText.PropertyMapping._tfs,c=o.GText.PropertyMapping._tfw;t=i.map(t=>(n=e.getElement()._getGravitValue(s,t[s]),r=e.getElement()._getGravitValue(l,t[l]),a=e.getElement()._getGravitValue(c,t[c]),n&&r&&a?ye.getFont(n,r,a,!1):null)).filter(e=>!!e)}}else n&&r&&a&&(t=[ye.getFont(n,r,a,!1)]);return t}).reduce((e,t)=>e.concat(t),[]))].every(e=>e&&e.isResolved()&&e.hasFeature(o.GFont.Features.Fractions))||this._advancedSettings.find('[data-property="typography-fractions"]').prop("disabled",!0),me.val(_),ue.val(C+m+E+m+(te?(t[0]||n).getProperty("_tff")||n.getFamily():"")),ue.val())||this._text.some(e=>e instanceof o.GText&&(g.multipleValues===e.getTLCore().getDocumentRange().getFormatting()[o.GText.PropertyMapping._tfw]||g.multipleValues===e.getTLCore().getDocumentRange().getFormatting()[o.GText.PropertyMapping._tfs]))&&($("<option></option>").attr("value","mixed").text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.mixed"))).appendTo(ue),ue.val("mixed"));let Ce=r.indexOf(o.GFont.Weight.Bold)>=0;C&&parseInt(C)===o.GFont.Weight.Bold||E&&E===o.GFont.Style.Italic&&(Ce=a.some(e=>{let{weight:t,styles:n}=e;return t===o.GFont.Weight.Bold&&n.some(e=>0===e.indexOf(o.GFont.Style.Italic))})),this._panel.find('[data-property="decoration-bold"]').toggleClass("g-active",Ce&&!!C&&parseInt(C)===o.GFont.Weight.Bold).prop("disabled",!Ce);const Ee=a.some(e=>{let{weight:t,styles:n}=e;return t===parseInt(C||o.GFont.Weight.Regular)&&n.some(e=>0===e.indexOf(o.GFont.Style.Italic))});this._panel.find('[data-property="decoration-italic"]').toggleClass("g-active",Ee&&!!E&&E===o.GFont.Style.Italic).prop("disabled",!Ee),this._panel.find('[data-property="decoration-underline"]').toggleClass("g-active",1==d),this._panel.find('[data-property="decoration-strikeout"]').toggleClass("g-active",1==u),this._panel.find('input[data-property="_tws"]').val(null!==D?this._document.getScene().pointToString(D,this._document.getScene().getOptimalDecimalsCount()):"0"),this._panel.find('input[data-property="_tcs"]').val(null!==x?this._document.getScene().pointToString(x,this._document.getScene().getOptimalDecimalsCount()):"0");var Se=I||o.GStylable.ParagraphAlignment.Left,Ge=this._panel.find('button[data-property^="_pal"]');Ge.each((function(e,t){var n=$(t);n.toggleClass("g-active",n.attr("data-property")==="_pal-"+Se)})),Ge.closest(".g-property-row").css("display",H?"none":"");var Ae=O,Te=this._panel.find('button[data-property="_plh_unit"]');if("number"==typeof Ae)Te.text("%"),this._panel.find('input[data-property="_plh"]').val(o.GUtil.formatNumber(100*Ae));else if("string"==typeof Ae||Ae instanceof String){const e=this._document.getScene();var Pe=e.getProperty("ut");Te.text(Pe||"px"),this._panel.find('input[data-property="_plh"]').val(e.pointToString(O,e.getOptimalDecimalsCount()))}else this._panel.find('input[data-property="_plh"]').val("");if(e&&(e.evtType==i.GEditor.ModifiedEvent.Type.Undo||e.evtType==i.GEditor.ModifiedEvent.Type.Redo)&&e.chooserOn&&e.textPattern&&this._panel.find('[data-property="_fc"]').find(".preview").trigger("click"),this._weightsAvailable=r,this._listTypeSettings.find(".list-type-group.g-selected").removeClass("g-selected"),this._listTypeSettings.find(".list-type-option.g-selected").removeClass("g-selected"),this._advancedSettings.find('[data-property="_pm"] > span').text(""),"string"==typeof h){const e=Object.values(y).find(e=>{let{types:t=[]}=e;return t.find(e=>{let{value:t}=e;return t===h})});e&&this._advancedSettings.find('[data-property="_pm"] > span').text(e.label),this._listTypeSettings.find('.list-type-option[value="'.concat(h,'"]')).addClass("g-selected").closest(".list-type-group").addClass("g-selected")}else null==h&&(this._advancedSettings.find('[data-property="_pm"] > span').text(y.None.label),this._listTypeSettings.find('.list-type-group[value="'.concat(y.None.value,'"]')).addClass("g-selected"));this._updateLanguageSelector(ve,_,N),this._updateStylisticSetSelector(ve,_,B)},v.prototype._updateLanguageSelector=function(e,t,n){const i=this._advancedSettings.find('select[data-property="_tlocl"]').empty().attr("disabled",!0).addClass("g-disabled");if(!e.isResolved()||!e.hasFeature(o.GFont.Features.LocalizedForm))return;let r=null;t&&"auto"!==t&&(r=o.GOpenTypeFont.scriptNameToOpenTypeScriptTagString(t));const a=e.getAvailableLanguageSystemTags(r);if(a&&0!==a.length)if(i.attr("disabled",!1).removeClass("g-disabled"),i.append($("<option/>").attr("value","").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.default")))),i.append(a.map(e=>{const t=o.GOpenTypeFont.openTypeLanguageSystemTagStringToBCP47(e);return{name:o.GLocale.get(new o.GLocaleKey("GBCP47LanguageTags","text.lang.".concat(t))),tag:e}}).sort((e,t)=>e.name.localeCompare(t.name)).map(e=>{let{name:t,tag:n}=e;return $("<option/>").attr("value",n).text(t)})),n)i.val(n);else{this._hasMultipleLanguages()&&(i.append($("<option/>").attr("value","mixed").attr("hidden",!0).attr("disabled",!0).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.mixed")))),i.val("mixed"))}},v.prototype._updateStylisticSetSelector=function(e,t,n){const i=this._advancedSettings.find('select[data-property="_tstyls"]').empty().attr("disabled",!0).addClass("g-disabled");if(!e.isResolved()||!e.hasFeature(o.GFont.Features.StylisticSet))return;let r=null;t&&"auto"!==t&&(r=o.GOpenTypeFont.scriptNameToOpenTypeScriptTagString(t));const a=e.getAvailableStylisticSets(r);if(a&&0!==a.length)if(i.attr("disabled",!1).removeClass("g-disabled"),i.append($("<option/>").attr("value","").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.none")))),i.append(a.map(e=>$("<option/>").attr("value",e).text(e.toUpperCase()))),n)i.val(n);else{this._hasMultipleStylisticSets()&&(i.append($("<option/>").attr("value","mixed").attr("hidden",!0).attr("disabled",!0).text(o.GLocale.get(new o.GLocaleKey("GTextProperties","text.mixed")))),i.val("mixed"))}},v.prototype._hasMultipleLanguages=function(){return this._hasMultipleValues(o.GText.PropertyMapping._tlocl)},v.prototype._hasMultipleStylisticSets=function(){return this._hasMultipleValues(o.GText.PropertyMapping._tstyls)},v.prototype._hasMultipleValues=function(e){return this._text.some(t=>{if(t instanceof o.GText){const n=t.getTLCore().getDocumentRange().getFormatting()[e];return g.multipleValues===n}})},v.prototype._correctStyleAndWeight=async function(e,t,n){var i=null,r=null,a=gDesigner.getWorkspace().getFontManager(),s=a.getDefaultFont(),l=this._panel.find('input[data-property="_tff"]').gFontsButton("getFontList"),c=!1;if(e===s.getFamily()?r=(i=a.getDefaultFontWeights())&&i.map((function(e){return{weight:e,styles:a.getDefaultFontStyles()}})):l&&(r=(i=await l.gFontsPanel("weightsForFont",e,(function(){console.warn("textproperties: Unexpected callback")}),!0))&&i.map((function(t){return{weight:t,styles:l.gFontsPanel("stylesForWeight",t,e,(function(){console.warn("textproperties: Unexpected callback")}),!0)}}))),i&&i.indexOf(n[0])<0){for(var d=0,u=0;u<i.length;u++)Math.abs(n[0]-i[u])<Math.abs(n[0]-i[d])&&(d=u);n[0]=i[d],c=!0}var p=(r||[]).filter((function(e){if(e.weight===n[0])return!0}))||[];return p.length&&p[0].styles.indexOf(t[0])<0&&(t[0]===o.GFont.Style.Normal&&p[0].styles.length?t[0]=o.GFont.Style.Italic:t[0]=o.GFont.Style.Normal,c=!0),c},v.prototype._toggleFormatting=function(e){if(this._text&&this._text.length){const n=this._text.map(e=>i.GElementEditor.getEditor(e)||e),r=this._getFormatting("underline",n)||null,a=this._getFormatting("strikeout",n)||null;var t=this._getFormatting("ligatures",n);const s={underline:r,strikeout:a,ligatures:t="auto"===t?!this._getProperty("_tcs",n):!!t,fractions:this._getFormatting("fractions",n)},l=this._getProperty("_tfw",n)||"",c=this._getProperty("_tfs",n)||"";if("bold"===e){let e;parseInt(l)===o.GFont.Weight.Bold?(e=this._weightsAvailable.indexOf(o.GFont.Weight.Regular)>=0?o.GFont.Weight.Regular:Math.min.apply(null,this._weightsAvailable),e=e||o.GFont.Style.Regular):e=o.GFont.Weight.Bold,this._assignProperties(["_tfw"],[e])}else if("italic"===e)this._assignProperties(["_tfs"],[c===o.GFont.Style.Italic?o.GFont.Style.Normal:o.GFont.Style.Italic]);else{const t=this._document.getEditor();try{t.beginTransaction(),this._text.forEach(t=>{if(t instanceof i.GTextEditor&&(t=t.getElement()),t instanceof o.GText){const n=t.getTLCore();if(n){let o;const r=i.GElementEditor.getEditor(t);o=r&&r.isInlineEdit()?n.selectedRange():n.getDocumentRange(),o&&o.setFormatting(e,1!=s[e])}}})}finally{t.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties")))}}this._updateProperties()}},v.prototype._assignFont=async function(e){if(gDesigner.getWorkspace().getFontManager().getDefaultFont().getFamily()!==e){var t=this._panel.find('input[data-property="_tff"]').gFontsButton("getFontList");if(void 0===await t.gFontsPanel("weightsForFont",e,()=>{this._assignFontMain(e)}))return}this._assignFontMain(e)},v.prototype._assignMarker=function(e){if(!this._document)return;const t=this._document.getEditor();this._ownChange=!0,t.beginTransaction();try{this._text.forEach(t=>{if(t instanceof i.GTextEditor&&(t=t.getElement()),t instanceof o.GText){const n=t.getTLCore();if(n){let o;const r=i.GElementEditor.getEditor(t);o=r&&r.isInlineEdit()?n.selectedRange():n.getDocumentRange(),o&&o.toggleList(e)}}})}finally{t.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties"))),this._ownChange=!1}},v.prototype._assignFontMain=async function(e){var t,n,r=gDesigner.getWorkspace().getFontManager();r.getDefaultFont();if(this._document){var a=this._document.getEditor();if(this._text.length){a.beginTransaction();try{for(var s=0;s<this._text.length;++s){var l=i.GElementEditor.getEditor(this._text[s]);if(this._text[s]instanceof o.GText&&this._text[s].isFakeText()){var c=this._text[s].getContent(),d={};c&&c.forEach(t=>{d[t.fontFamily]=e});var u=this._text[s].getProperty("_tff");d[u]=e,this._text[s].replaceFonts(d,!0)}else{var p=l||this._text[s],g=["_tff"],h=[e],f=this._text[s]instanceof o.GText&&this._text[s].getTLCore();if(f){let i;i=l&&l.isInlineEdit()?f.selectedRange():f.getDocumentRange();for(var m=i.save(),y=o.GText.PropertyMapping._tfs,v=o.GText.PropertyMapping._tfw,_=(o.GText.PropertyMapping._tff,!1),b=!1,w=0;w<m.length;w++){var C="italic"===m[w][y]?o.GFont.Style.Italic:o.GFont.Style.Normal,E=~~m[w][v];if(t=[C],n=[E],await this._correctStyleAndWeight(e,t,n)){var S=g.indexOf("_tfs"),G=g.indexOf("_tfw");if(C!==t[0]){if(S<0&&(S=g.length,g.push("_tfs"),h.push("")),b){h[G]=n[0],h[S]=t[0];break}h[S]=t[0],_=!0}if(E!==n[0]){if(G<0&&(G=g.length,g.push("_tfw"),h.push("")),_){h[S]=t[0],h[G]=n[0];break}h[G]=n[0],b=!0}}}}else{if(t=[p.getProperty("_tfs")||o.GFont.Style.Normal],n=[p.getProperty("_tfw")||o.GFont.Weight.Regular],await this._correctStyleAndWeight(e,t,n),!r.getFont(e,t[0],n[0]))continue;Array.prototype.push.apply(g,["_tfs","_tfw"]),Array.prototype.push.apply(h,[t[0],n[0]])}p.setProperties(g,h)}if(l){var A=l.getDefaultStyle();A&&A.assignStyleFrom(this._text[s])}this._text[s]instanceof o.GStyle&&this._updateProperties()}}finally{a.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties")))}}}},v.prototype._assignProperty=function(e,t,n,i){this._assignProperties([e],[t],n,i)},v.prototype._assignProperties=function(e,t,n,r){if(this._document){var a=this._document.getEditor();n||(this._ownChange=!0,a.beginTransaction());try{for(var s=0;s<this._text.length;++s){(l=i.GElementEditor.getEditor(this._text[s]))?l.setProperties(e,t,n):this._text[s].setProperties(e,t,!1,!1,n)}}finally{n||(a.commitTransaction(o.GLocale.get(new o.GLocaleKey("GTextProperties","action.modify-text-properties")),r||null),this._ownChange=!1)}if(e.includes("sc"))for(s=0;s<this._text.length;++s){var l;(l=i.GElementEditor.getEditor(this._text[s]))&&l.requestInvalidation()}}},v.prototype.toString=function(){return"[Object GTextProperties]"},e.exports=v},function(e,t,n){"use strict";n(168),n(3);var i=n(43),o=n(1),r=n(775),a=n(776),s=n(108),l=n(118);function c(){this._elements=[]}o.GObject.inherit(c,s),c.prototype._panel=null,c.prototype._document=null,c.prototype._elements=null,c.prototype.isGroup=function(e){return!1},c.prototype.init=function(e,t){this._panel=e;var n=e=>{var t=r.ID+"."+e,n=gDesigner.getAction(t);return $("<button></button>").attr("data-action",t).on("click",this._executeAction.bind(this)).text(o.GLocale.get(n.getTitle()))};$("<hr/>").appendTo(this._panel),$("<div></div>").gPropertyRow({columns:[{width:"45%",content:n(i.GEditor.ArrangeAlignType.AlignJustifyHorizontal)},{width:"10%"},{width:"45%",content:n(i.GEditor.ArrangeAlignType.AlignJustifyVertical)}]}).appendTo(this._panel),$("<div></div>").gPropertyRow({columns:[{width:"45%",prefix:{label:o.GLocale.get(new o.GLocaleKey("GAlignProperties","text.space-x")),width:"50px"},content:$("<input>").on("keydown",this._spaceEvent.bind(this)).attr({type:"text","data-dist":a.Type.Horizontal}).val("1").gInputBox({minValue:1})},{width:"10%"},{width:"45%",prefix:{label:o.GLocale.get(new o.GLocaleKey("GAlignProperties","text.space-y")),width:"50px"},content:$("<input>").on("keydown",this._spaceEvent.bind(this)).attr({type:"text","data-dist":a.Type.Vertical}).val("1").gInputBox({minValue:1})}]}).appendTo(this._panel)},c.prototype._executeAction=function(e){var t=$(e.target).closest("[data-action]").attr("data-action");t&&gDesigner.executeAction(t,void 0,"alignproperties")},c.prototype._spaceEvent=function(e){if(13===e.keyCode){var t=$(e.target).closest("input"),n=t.attr("data-dist"),i=this._document.getScene().stringToPoint(t.gInputBox("value"));!isNaN(i)&&i>0&&gDesigner.executeAction(a.ID+"."+n,[this._elements,null,i],"shortcut"),this._updateDisplayValues()}},c.prototype.isAvailable=function(e){return!0===e},c.prototype.update=function(e,t){if(this._document&&(this._document=null,gDesigner.removeEventListener(l,this._settingChanged)),this._elements=[],e){for(var n=0;n<t.length;++n)!t[n].hasMixin(o.GElement.Transform)||t[n]instanceof o.GPage||this._elements.push(t[n]);if(this._elements.length>=2&&this._elements.length===t.length)return this._document=e,gDesigner.addEventListener(l,this._settingChanged,this),!0}return!1},c.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateDisplayValues()},c.prototype._updateDisplayValues=function(){this._panel.find("[data-dist]").each(function(e,t){var n=$(t),i=parseFloat(n.gInputBox("value"));i=isNaN(i)||i<=0||!i?1:i,n.gInputBox("value",o.GUtil.formatNumber(i,this._document.getScene().getOptimalDecimalsCount()))}.bind(this))},c.prototype.toString=function(){return"[Object GAlignProperties]"},e.exports=c},function(e,t,n){"use strict";var i=n(17);n(9),n(45),n(28);var o=n(1),r=n(43),a=n(12),s=n(1160),l=i(n(1162)),c=n(76),d=null;function u(){return d||(d=[{name:o.GLocale.get(new o.GLocaleKey("GSettingsDialog","text.light-theme"))+" ("+o.GLocale.get(new o.GLocaleKey("GCommonNames","text.default")).toLowerCase()+")",localeClass:new o.GLocaleKey("GSettingsDialog","text.light-theme"),key:"light"},{name:o.GLocale.get(new o.GLocaleKey("GSettingsDialog","text.dark-theme")),localeClass:new o.GLocaleKey("GSettingsDialog","text.dark-theme"),key:"dark"}]),new Promise((e,t)=>{this._buildDialog().then(()=>e(this)).catch(()=>t(!1))})}o.GObject.inherit(u,o.GObject),u.prototype._buildDialog=async function(){let e=(await a.gApi.getUserSettings().catch(()=>({notifications_disabled:!1}))).notifications_disabled;this._dialog=$("<div></div>").append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.highlight-on-hover")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.highlight-on-hover-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","highlight_on_hover").on("change",()=>{gDesigner.stats("settings_toggle_highlight-on-hover")}).prop("checked",gDesigner.getSetting("highlight_on_hover"))).append($("<div/>")))).append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-expand-layers")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-expand-layers-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","auto_expand_layers").on("change",()=>{gDesigner.stats("settings_toggle_auto-expand-layers")}).prop("checked",gDesigner.getSetting("auto_expand_layers"))).append($("<div/>")))),a.AUTO_SAVE_ENABLED&&(this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-save")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-save-description")),this._createAutoSaveSetting())),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-save-warning")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.auto-save-warning-description")),$("<label/>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting",s.DISABLE_WARNING_SETTING_NAME).on("change",(function(){const e=!!this.checked;gDesigner.stats("settings_toggle_auto-save-warning-enabled",e)})).prop("checked",!gDesigner.getSetting(s.DISABLE_WARNING_SETTING_NAME,!1))).append($("<div/>"))))),"production"===gDesigner.getEnv()||gDesigner.isBeta()||"lts"===gDesigner.getEnv()||"rc"===gDesigner.getEnv()||(this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.enable_steps_debug")),null,$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","enable_steps_debug").on("change",()=>{gDesigner.stats("settings_toggle_steps-debug")}).prop("checked",gDesigner.getSetting("enable_steps_debug",r.GEditorOptions.debugTransactions))).append($("<div></div>")))),this._dialog.append(this._createSetting("Enable cached rendering",null,$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","enable_cache").on("change",()=>{gDesigner.stats("settings_toggle_cache")}).prop("checked",gDesigner.getSetting("enable_cache",o.GRendererConfig.ENABLE_CACHE))).append($("<div></div>"))))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.change-theme")),null,this._createThemeSelector()).append(this._createSetting(null,o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.ui-toolbar-alignment")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","ui_toolbar_alignment").on("change",()=>{gDesigner.stats("settings_toggle_ui-toolbar-alignment")}).prop("checked",gDesigner.getSetting("ui_toolbar_alignment",!1))).append($("<div></div>"))).addClass("sub-setting"))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.store-textpath")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.store-textpath-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","dont_store_textpath").on("change",()=>{gDesigner.stats("settings_toggle_store-textpath")}).prop("checked",!gDesigner.getSetting("dont_store_textpath",o.GText.dontStorePaths))).append($("<div></div>")))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.decimals-num")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.decimals-num-description")),this._createDecimalsNum())),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.disable-warning-unsupported-features")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.disable-warning-unsupported-features-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","disable_warning_unsupported_features").on("change",()=>{gDesigner.stats("settings_toggle_warning-unsupported-features")}).prop("checked",gDesigner.getSetting("disable_warning_unsupported_features",!1))).append($("<div></div>")))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.eps-outline-fonts")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.eps-outline-fonts-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","eps_outline_fonts").on("change",()=>{gDesigner.stats("settings_toggle_eps-outline-fonts")}).prop("checked",gDesigner.getSetting("eps_outline_fonts",!0))).append($("<div></div>")))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.disable-notifications")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.disable-notifications-description")),$("<label></label>").addClass("g-switch test").append($("<input>").attr("type","checkbox").attr("data-setting","notifications_disabled").on("change",()=>{gDesigner.stats("settings_toggle_disable-notifications")}).prop("checked",e)).append($("<div></div>")))),this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.disable-scrubbing")),null,$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting",l.default.getSetting()).on("change",e=>{const t=$(e.target).closest("input").is(":checked");gDesigner.stats("settings_toggle_disable-scrubbing",t)}).prop("checked",!l.default.isEnabled())).append($("<div></div>")))),gContainer.getRuntime()===c.Runtime.Electron&&this._dialog.append(this._createSetting(o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.create-backup-copy-of-file")),o.GLocale.get(new o.GLocaleKey("GSettingsDialog","setting.create-backup-copy-of-file-description")),$("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","create_backup_copy").on("change",()=>{gDesigner.stats("settings_toggle_create-backup-copy")}).prop("checked",gDesigner.getSetting("create_backup_copy",!1))).append($("<div></div>")))),this._dialog.gDialog({releaseOnClose:!0,className:"g-settings-dialog",buttons:[$('<button class="settings-button">'+o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))+"</button>").on("click",()=>{gDesigner.stats("settings_cancel_settings"),this.close()}),$('<button class="settings-button">'+o.GLocale.get(new o.GLocaleKey("GSettingsDialog","action.save-changes"))+"</button>").on("click",()=>{gDesigner.stats("settings_save_settings"),this.save(this.close.bind(this))})]})},u.prototype.open=function(){this._dialog.gDialog("open",!1)},u.prototype.close=function(){this._dialog.gDialog("close")},u.prototype.save=async function(e){this._saveBasicSettings(),await this._saveNotificationSetting(),e(),$(".symbols-container").triggerHandler("scroll")},u.prototype._saveNotificationSetting=async function(){var e=this._dialog.find('[data-setting="notifications_disabled"]').prop("checked"),t=await a.gApi.getUserSettings();t&&t.notifications_disabled!==e&&await a.gApi.updateUserSettings({notifications_disabled:e},!0)},u.prototype._saveBasicSettings=function(){var e=a.AUTOSAVE_INTERVALS[parseInt(this._dialog.find('[data-setting="'.concat(s.AUTO_SAVE_INTERVAL_SETTING,'"]')).val())],t=null;if(this._dialog.find('[data-setting="decimals-num-onoff"]').prop("checked")){var n=this._dialog.find('[data-setting="decimals-num-val"]').gInputBox("value"),i=o.GUtil.parseNumber(n);"number"!=typeof i||isNaN(i)||(t=i)}gDesigner.setSetting(["highlight_on_hover","auto_expand_layers",s.AUTO_SAVE_SETTING,s.DISABLE_WARNING_SETTING_NAME,"system_fonts_enabled","theme","dont_store_textpath","enable_steps_debug","enable_cache","disable_warning_unsupported_features","eps_outline_fonts","ui_toolbar_alignment","decimals_num",s.AUTO_SAVE_INTERVAL_SETTING,"create_backup_copy",l.default.getSetting()],[this._dialog.find('[data-setting="highlight_on_hover"]').prop("checked"),this._dialog.find('[data-setting="auto_expand_layers"]').prop("checked"),this._dialog.find('[data-setting="'.concat(s.AUTO_SAVE_SETTING,'"]')).prop("checked"),!this._dialog.find('[data-setting="'.concat(s.DISABLE_WARNING_SETTING_NAME,'"]')).prop("checked"),this._dialog.find('[data-setting="system_fonts_enabled"]').prop("checked"),this._dialog.find('[data-setting="theme"]').data("theme"),!this._dialog.find('[data-setting="dont_store_textpath"]').prop("checked"),this._dialog.find('[data-setting="enable_steps_debug"]').prop("checked"),this._dialog.find('[data-setting="enable_cache"]').prop("checked"),this._dialog.find('[data-setting="disable_warning_unsupported_features"]').prop("checked"),this._dialog.find('[data-setting="eps_outline_fonts"]').prop("checked"),this._dialog.find('[data-setting="ui_toolbar_alignment"]').prop("checked"),t,e,this._dialog.find('[data-setting="create_backup_copy"]').prop("checked"),!this._dialog.find('[data-setting="'.concat(l.default.getSetting(),'"]')).prop("checked")])},u.prototype._createSetting=function(e,t,n){var i=$("<div></div>").addClass("text-description").append($("<div></div>").text(e).addClass("label"));return t?(i=i.append($("<div></div>").addClass("description").html(t))).find("a").attr("target","_blank"):i.css({verticalAlign:"middle"}),$("<div></div>").addClass("setting").append($("<div></div>").addClass("form").append(i).append($("<div></div>").addClass("editor").append(n)))},u.prototype._createThemeSelector=function(){for(var e,t=function(e,t){return $("<div/>").html(e.name).addClass("g-theme-row").on("click",(function(){gDesigner.stats("settings_change_theme",o.GLocale.get(e.localeClass,null,o.GLocaleLanguage.English)),$(".g-theme-selector").data("theme",e.key).text(e.name),t&&t()}))},n=0;n<d.length;++n)if(d[n].key===gDesigner.getSetting("theme","light")){e=d[n];break}e=e||d[0];var i=function(){$(".g-overlay.theme-selector").find(".g-theme-row:hover").trigger("click")};return $("<div/>").attr("type","button").addClass("g-select").css("min-width","170px").css("width","max-content").text(e.name).attr("data-setting","theme").data("theme",e.key).addClass("g-theme-selector").on("click",(function(e){for(var n=$("<div/>"),o=0;o<d.length;++o)n.append(t(d[o],(function(){n.gOverlay("close")})));n.gOverlay({padding:!1,releaseOnClose:!0,clazz:"theme-selector",enterCallback:i}).gOverlay("open",e.target)}))},u.prototype._createDecimalsNum=function(){var e=gDesigner.getSetting("decimals_num",o.GScene.decimalsNum),t=$("<div/>").append($("<input>").attr("type","text").css("width","60px").css("display",null!==gDesigner.getSetting("decimals_num",o.GScene.decimalsNum)?"":"none").attr("data-setting","decimals-num-val").gInputBox({minValue:0,maxVal:6}).on("change",function(e){gDesigner.stats("settings_change_decimals-num");var t=$(e.target).gInputBox("value");(t=o.GUtil.parseNumber(t))<0&&(t=0),t>6&&(t=6),$(e.target).gInputBox("value",null!==t?o.GUtil.formatNumber(t,0):"2")}.bind(this)).gInputBox("value",null!==e?o.GUtil.formatNumber(e,0):"2"));return $("<div/>").append($("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","decimals-num-onoff").prop("checked",null!==gDesigner.getSetting("decimals_num",o.GScene.decimalsNum))).on("change",function(e){gDesigner.stats("settings_change_decimals-num");var t=gDesigner.getSetting("decimals_num",o.GScene.decimalsNum),n="2";null!==t&&(n=o.GUtil.formatNumber(t,0)),this._dialog.find('[data-setting="decimals-num-val"]').css("display",$(e.target).prop("checked")?"":"none").gInputBox("value",n)}.bind(this)).append($("<div></div>"))).append(t)},u.prototype._createAutoSaveSetting=function(){var e=$("<label/>").addClass("g-switch").append($("<input>").attr("type","checkbox").attr("data-setting","auto_save").on("change",(function(){const e=!!this.checked;gDesigner.stats("settings_toggle_auto-save",e)})).prop("checked",gDesigner.getSetting("auto_save",!0))).append($("<div/>")),t=$("<select/>").attr("data-setting",s.AUTO_SAVE_INTERVAL_SETTING).on("change",(function(){const e=a.AUTOSAVE_INTERVALS[$(this).val()];gDesigner.stats("settings_change_auto-save-interval",e)}));return a.AUTOSAVE_INTERVALS.forEach((e,n)=>{var i=$("<option/>").text(e).val(n);t.append(i)}),t.val(a.AUTOSAVE_INTERVALS.indexOf(gDesigner.getSetting(s.AUTO_SAVE_INTERVAL_SETTING,a.AUTOSAVE_INTERVAL_DEFAULT))),[e,t]},e.exports=u},function(e,t,n){"use strict";n(19),n(24),n(9),n(168),n(58),n(163),n(14),n(29);var i=n(1);const{gApi:o,AUTO_SAVE_ENABLED:r,AUTOSAVE_INTERVAL_DEFAULT:a,CloudIntegration:s,DESIGNER:l,EXTERNAL_APP:c}=n(12),{buildDialogDocumentHasUpdates:d}=n(32),u=n(76),p=n(36),g=n(502),h=n(401),f=n(78),m=n(118),y=n(263),v=n(1402),_=n(1406),b=n(77),w=n(200),{SETUP:C,CODES:E}=n(532),S=n(1161);function G(){if(this._pendingSyncDialog=new Set,this._pendingFormatNotSupportDialog=new Set,this._pendingEntriesNotCreatedWarning=new Set,this._documentsMap=new Map,this._savingQueue=new _,this._savingQueue.onNext(this._processDocumentSave.bind(this)),G._instance&&console.warn("[GAutoSaveManager] Already initiated"),this._autoSaveWorker=new Worker("./autosave.worker.js"),!this._autoSaveWorker)return console.warn("[GAutoSaveManager] Worker initiation failed"),Promise.reject();this._autoSaveWorker.postMessage({cmd:C.ENDPOINT,data:{url:o.url}}),this._autoSaveModel=new v(this._autoSaveWorker),this._updateStatus(gDesigner.getSetting(G.AUTO_SAVE_SETTING)?G.Status.Stopped:G.Status.Disabled),this._setInterval(gDesigner.getSetting(G.AUTO_SAVE_INTERVAL_SETTING)),gContainer.getProperty(G.AUTO_SAVE_WARN_DIALOG_SHOWN).then(e=>{this._warnDialogShown=!!e}),gDesigner.addEventListener(f,this._documentEvent,this),gDesigner.addEventListener(m,this._settingsChangedEvent,this),gDesigner.addEventListener(y,this._networkAvailabilityChangedEvent,this)}G.ALTERNATE_STRINGS=[new i.GLocaleKey("GAutoSave","text.notification-message-1"),new i.GLocaleKey("GAutoSave","text.notification-message-2"),new i.GLocaleKey("GAutoSave","text.notification-message-3")],G.DISABLE_EXTERNAL_FILE_NO_ENTRIES_CREATED_WARING="disable-external-file-no-entries-created-waring",G.DISABLE_WARNING_SETTING_NAME="autosave-prompt-for-local-files-disabled",G.REMINDER_FOR_CDR_DES_FILE="autosave-prompt-for-reminding-not-support-cdr-des",G.AUTO_SAVE_SETTING="auto_save",G.AUTO_SAVE_INTERVAL_SETTING="auto_save_interval",G.AUTO_SAVE_WARN_DIALOG_SHOWN="designer.settings.auto-save-warn-dialog-shown",G.AUTO_SAVE_HIDE_NOTIFICATION_PROP_NAME="designer.settings.auto-save-hide-notification",G.Status={Stopped:-1,Enabled:0,Disabled:1},G._instance=null,G.prototype._timerId=null,G.prototype._warnDialogShown=!1,G.prototype._fileUpdatedWarningShowing=!1,G.prototype._warnDialogTimer=null,G.prototype._status=G.Status.Stopped,G.prototype._documentsMap=null,G.prototype._pendingSyncDialog=null,G.prototype._pendingFormatNotSupportDialog=null,G.prototype._pendingEntriesNotCreatedWarning=null,G.prototype._savingQueue=null,G.prototype._syncDialogShown={},G.prototype._formatNotSupportDialogShown={},G.prototype._noEntriesCreatedWaringShown={},G.prototype._offlineAlert=null,G.prototype._interval=null,G.prototype._autoSaveWorker=null,G.getInstance=function(){return G._instance||(G._instance=new G),G._instance},G.prototype._updateStatus=function(e){this._status=e},G.prototype.getStatus=function(){return this._status},G.prototype._setInterval=function(e){const t=parseFloat(e)||a;this._interval=60*t*1e3},G.prototype._shouldHandle=async function(e){return!e.isCloudFile()||await e.canSaveToCloud()||e.isExternalFile()},G.prototype._processDocumentSave=async function(e){if(!await this._shouldHandle(e))return;if(!this._warnDialogShown){this._warnDialogTimer&&clearTimeout(this._warnDialogTimer);if(!await this._showWarnDialog())return}if(this._resetDocumentTimeout(e,this.getStatus()===G.Status.Enabled),gDesigner.isOffline())return this._toggleOfflineAlert(!0),Promise.reject(E.AUTOSAVE_OFFLINE_NOT_AVAILABLE);this._offlineAlert&&this._toggleOfflineAlert(!1);const t=[b.Saving,b.Syncing,b.Loading].includes(e.getStatus());return this._autoSaveModel.has(e)||t?E.AUTOSAVE_ALREADY_SAVING:e.isCloudFile()||e.isExternalFile()?this._isCDRFile(e)?(this._executeDocumentFormatNotSupportedDialog(e),E.AUTOSAVE_CLOUD_SYNCHRONIZM_NOT_AVAILABLE):e.isWebFile()||e.isCloudSyncOn()||e.isExternalFile()?e.isExternalFile()&&!await this._executeExternalFileWarningDialog(e)?E.AUTOSAVE_CLOUD_SYNCHRONIZM_NOT_AVAILABLE:e.isModified()?await e.isUpdateAvailable()?(this._executeDocumentConflictResolutionDialog(e),E.AUTOSAVE_FILE_CONFLICT):this._runAndScheduleAutoSave(e):E.AUTOSAVE_NOT_MODIFIED:E.AUTOSAVE_LOCAL_FILES_WITHOUT_CID_NOT_AVAILABLE:(this._executeDocumentSyncDialog(e),E.AUTOSAVE_CLOUD_SYNCHRONIZM_NOT_AVAILABLE)},G.prototype._executeDocumentSyncDialog=function(e){this._syncDialogShown[e.sessionId]||(gDesigner.isActiveDocument(e)?this._showSyncDialog(e):this._pendingSyncDialog.add(e))},G.prototype._executeDocumentFormatNotSupportedDialog=function(e){this._formatNotSupportDialogShown[e.sessionId]||(gDesigner.isActiveDocument(e)?this._showFormatNotSupportedDialog(e):this._pendingFormatNotSupportDialog.add(e))},G.prototype._executeDocumentConflictResolutionDialog=function(e){gDesigner.isActiveDocument(e)&&(this._dialogResolveDocumentConflicts&&this._dialogResolveDocumentConflicts.gDialog("isOpen")&&this._dialogResolveDocumentConflicts.gDialog("close"),this._dialogResolveDocumentConflicts=d.call(this,e,function(e){e.reload()}.bind(this),function(e){this._runAndScheduleAutoSave(e)}.bind(this)))},G.prototype._executeExternalFileWarningDialog=async function(e){return e.getStorageItem()&&await e.getStorageItem().hasUpdates()&&!this._fileUpdatedWarningShowing?this._showExternalFileUpdatedOutAppWarningDialog(e):!!this._noEntriesCreatedWaringShown[e.sessionId]||(gDesigner.isActiveDocument(e)?this._showNoEntriesCreatedInVersionHistoryForExternalFileWarningDialog(e):(this._pendingEntriesNotCreatedWarning.add(e),!1))},G.prototype._runAndScheduleAutoSave=function(e){return this._handleAutoSave(e).finally(()=>{this._resetDocumentTimeout(e,this.getStatus()===G.Status.Enabled)})},G.prototype._handleAutoSave=function(e){return gDesigner.isActiveDocument(e)&&this._showNotification(),this._autoSaveModel.save(e).catch(t=>{console.warn("[GAutoSaveManager][Failed to auto save]",t),gDesigner.isActiveDocument(e)&&this._showNotification(!0)})},G.prototype._resetDocumentTimeout=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this._documentsMap.get(e);n.timeoutId&&(clearTimeout(n.timeoutId),n.timeoutId=null),t&&(n.timeoutId=setTimeout(()=>{this._savingQueue.has(e)||(this._savingQueue.add(e),this._savingQueue.process())},this._interval)),this._documentsMap.set(e,n)},G.prototype._resetAllDocumentsTimeout=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(let t of this._documentsMap.values())this._resetDocumentTimeout(t.doc,e)},G.prototype.disable=function(){this.getStatus()!==G.Status.Disabled&&(this._resetAllDocumentsTimeout(!1),this._updateStatus(G.Status.Disabled))},G.prototype.enable=function(){r&&this.getStatus()!==G.Status.Enabled&&!gDesigner.isOffline()&&gDesigner.getSetting(G.AUTO_SAVE_SETTING)&&(this._resetAllDocumentsTimeout(),this._updateStatus(G.Status.Enabled))},G.prototype._removeDocument=function(e){this._documentsMap.has(e)&&(this._resetDocumentTimeout(e,!1),this._savingQueue.delete(e),this._documentsMap.delete(e),this._syncDialogShown[e.sessionId]&&delete this._syncDialogShown[e.sessionId],this._formatNotSupportDialogShown[e.sessionId]&&delete this._formatNotSupportDialogShown[e.sessionId],this._noEntriesCreatedWaringShown[e.sessionId]&&delete this._noEntriesCreatedWaringShown[e.sessionId])},G.prototype._addDocument=function(e){this._documentsMap.has(e)||(this._documentsMap.set(e,{doc:e}),this._resetDocumentTimeout(e,this.getStatus()===G.Status.Enabled),this._syncDialogShown[e.sessionId]=!1,this._formatNotSupportDialogShown[e.sessionId]=!1,this._noEntriesCreatedWaringShown[e.sessionId]=!1)},G.prototype._documentEvent=function(e){if(!e.document.isLockedByVersionHistory())switch(e.type){case f.Type.Added:this._addDocument(e.document),e.document.addEventListener(w,this._handleDocumentStatusEvent,this,void 0,void 0,!0),this.enable();break;case f.Type.Removed:this._removeDocument(e.document),e.document.removeEventListener(w,this._handleDocumentStatusEvent,this);break;case f.Type.SynchronismUpdated:{let t=!0;e.document.isWebFile()||(e.document.isCloudSyncOn()?this.enable():(t=!1,this._removeDocument(e.document))),t&&this._addDocument(e.document);break}case f.Type.Activated:this._documentsMap.has(e.document)||(this._addDocument(e.document),e.document.addEventListener(w,this._handleDocumentStatusEvent,this,void 0,void 0,!0),this.enable()),e.document.isCloudSynchronismAvailable()||this._syncDialogShown[e.document.sessionId]||!this._pendingSyncDialog.has(e.document)||(this._showSyncDialog(e.document),this._pendingSyncDialog.delete(e.document)),!this._noEntriesCreatedWaringShown[e.document.sessionId]&&this._pendingEntriesNotCreatedWarning.has(e.document)&&(this._processDocumentSave(e.document),this._pendingEntriesNotCreatedWarning.delete(e.document)),this._shouldFormatNotSupportedDialogAppearForUser(e.document)&&(this._showFormatNotSupportedDialog(e.document),this._pendingFormatNotSupportDialog.delete(e.document)),this._warnDialogTimer&&clearTimeout(this._warnDialogTimer),this._shouldWarningDialogAppearForUser()&&(this._warnDialogTimer=setTimeout(()=>{this._showWarnDialog(!0).then(e=>{e&&this._savingQueue.process()})},this._interval));break;case f.Type.BeforeReload:this._removeDocument(e.document)}},G.prototype._shouldWarningDialogAppearForUser=function(){return!this._warnDialogShown&&!gDesigner.getLicense().isGuest()&&!gDesigner.isAnonymous()},G.prototype._shouldFormatNotSupportedDialogAppearForUser=function(e){return!gDesigner.getLicense().isGuest()&&!gDesigner.isAnonymous()&&this._pendingFormatNotSupportDialog.has(e)&&e.isCloudFile()&&this._isCDRFile(e)&&!this._formatNotSupportDialogShown[e.sessionId]},G.prototype._handleDocumentStatusEvent=function(e){e.status===b.Loaded&&this._addDocument(e.sender)},G.prototype._settingsChangedEvent=function(e){e.previousValue!==e.newValue&&(e.key===G.AUTO_SAVE_SETTING?e.newValue?this.enable():this.disable():e.key===G.AUTO_SAVE_INTERVAL_SETTING&&(this._setInterval(e.newValue),this._resetAllDocumentsTimeout(this.getStatus()===G.Status.Enabled)))},G.prototype._networkAvailabilityChangedEvent=function(e){e.connected?(this._toggleOfflineAlert(!1),this.enable()):(this._toggleOfflineAlert(!0),this.disable())},G.prototype._toggleOfflineAlert=function(e){if(e){let e=i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-offline"));gContainer.getRuntime()===u.Runtime.Electron&&i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-offline-desktop")),this._offlineAlert||(this._offlineAlert=p.alert(e,()=>{this._offlineAlert=null}))}else this._offlineAlert&&0!==this._offlineAlert.length&&this._offlineAlert.gDialog("close"),this._offlineAlert=null},G.prototype._showWarnDialog=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._warnDialogShown||e&&this.getStatus()===G.Status.Enabled?Promise.resolve():this.getStatus()===G.Status.Enabled?Promise.resolve(!0):new Promise(e=>{p.custom({title:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-inform-warn-feature.title")),subtitle:$("<span />").text("".concat(i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-inform-warn-feature.text"))," ")).append($("<a />").attr("href","https://documentation.designer.io/basics/working-with-files/save-and-open-files/#auto-save").attr("target","_blank").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.learn-more")))),className:"g-auto-save-warn-dialog",icon:"autosave",closeable:!1,buttons:[{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-inform-warn-feature.cancel-button")),closeOnClick:!0,shortcut:p.Shortcut.Esc,onclick:()=>{gDesigner.setSetting(G.AUTO_SAVE_SETTING,!1),this._warnDialogShown=!0,gContainer.setProperty(G.AUTO_SAVE_WARN_DIALOG_SHOWN,!0),gDesigner.stats("settings_toggle_auto-save-disabled"),e(!1)}},{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-inform-warn-feature.enable-button")),className:"primary",closeOnClick:!0,shortcut:p.Shortcut.Enter,onclick:()=>{gDesigner.setSetting(G.AUTO_SAVE_SETTING,!0),this._warnDialogShown=!0,gContainer.setProperty(G.AUTO_SAVE_WARN_DIALOG_SHOWN,!0),gDesigner.stats("settings_toggle_auto-save-enabled"),e(!0)}}]})})},G.prototype._showFormatNotSupportedDialog=function(e){gDesigner.getSetting(G.REMINDER_FOR_CDR_DES_FILE,!0)&&(p.custom({title:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-auto-save-is-not-available-for-cdr-and-des.text")),className:"g-auto-save-format-not-support-warn-dialog",icon:"info",closeable:!1,buttons:[{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-auto-save-is-not-available-for-cdr-and-des.save-as-button")),closeOnClick:!0,onclick:()=>{gDesigner.executeAction(h.getIdForAction(h.Actions.SaveAs),e)}},{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-auto-save-is-not-available-for-cdr-and-des.keep-cdr-button")),closeOnClick:!0,className:"primary",shortcut:p.Shortcut.Enter}],dontShowAgainCb:e=>{gDesigner.setSetting(G.REMINDER_FOR_CDR_DES_FILE,!e),gDesigner.stats("settings_toggle_auto-save-not-support-for-cdr-des-reminder-enabled",!e)}}),this._formatNotSupportDialogShown[e.sessionId]=!0)},G.prototype._showSyncDialog=function(e){if(gDesigner.getSetting(G.DISABLE_WARNING_SETTING_NAME))return;let t,n,o;e.hasCloudReference()?(t=i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-cloud-reference-sync")),n=i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-cloud-reference-sync-sub-text")),o=[{label:i.GLocale.get(new i.GLocaleKey("GLocale","ok")),closeOnClick:!0,shortcut:p.Shortcut.Enter}]):(t=i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-sync")),n=i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-sync-sub-text")),o=[{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-button.cancel")),closeOnClick:!0,shortcut:p.Shortcut.Esc},{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.alert-button.save-to-cloud")),className:"primary",closeOnClick:!0,shortcut:p.Shortcut.Enter,onclick:()=>{gDesigner.executeAction(h.getIdForAction(h.Actions.SaveAs),e)}}]),this._syncDialogShown[e.sessionId]=!0,p.custom({title:t.replace("%title",e.getTitle()),subtitle:n.replace("%title",e.getTitle()),className:"g-auto-save-sync-dialog",icon:"info",closeable:!1,buttons:o,dontShowAgainCb:e=>{gDesigner.setSetting(G.DISABLE_WARNING_SETTING_NAME,!!e),gDesigner.stats("settings_toggle_auto-save-warning-enabled",!e)}})},G.prototype._showNoEntriesCreatedInVersionHistoryForExternalFileWarningDialog=function(e){return new Promise(t=>{gDesigner.getSetting(G.DISABLE_EXTERNAL_FILE_NO_ENTRIES_CREATED_WARING,!1)?t(!0):(this._noEntriesCreatedWaringShown[e.sessionId]=!0,p.custom({title:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-no-entries-created-waring.title")).replace("%storage",this._getExternalStorageName(e)),subtitle:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-no-entries-created-waring.subtitle")),className:"g-auto-save-no-entries-created-in-version-history-warn-dialog",icon:"info",closeable:!1,buttons:[{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-no-entries-created-waring.go-settings")),closeOnClick:!0,onclick:()=>{gDesigner.executeAction(S.ID),t(!1)}},{label:i.GLocale.get(new i.GLocaleKey("GLocale","ok")),closeOnClick:!0,className:"primary",shortcut:p.Shortcut.Enter,onclick:()=>{t(!0)}}],dontShowAgainCb:e=>{gDesigner.setSetting(G.DISABLE_EXTERNAL_FILE_NO_ENTRIES_CREATED_WARING,!!e),gDesigner.stats("settings_toggle_auto-save-no-entries-created-warning-enabled",!e)}}))})},G.prototype._showExternalFileUpdatedOutAppWarningDialog=function(e){return p.custom({title:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-file-updated-out-app-waring.title")).replace("%file-name",e.getTitle()+"."+e.getExtension().toLowerCase()).replace("%app-name",l.TITLE),className:"g-auto-save-file-updated-out-app-warn-dialog",icon:"info",closeable:!1,buttons:[{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-file-updated-out-app-waring.do-not-reload")),closeOnClick:!0,onclick:()=>{this._fileUpdatedWarningShowing=!1}},{label:i.GLocale.get(new i.GLocaleKey("GAutoSave","text.dialog-file-updated-out-app-waring.reload")),closeOnClick:!0,className:"primary",shortcut:p.Shortcut.Enter,onclick:()=>{this._fileUpdatedWarningShowing=!1,e.reload()}}]}),this._fileUpdatedWarningShowing=!0,!1},G.prototype._getExternalStorageName=function(e){if(!e)return"";const t=e.getStorageItem();return t&&t instanceof g.Item?s.cloudOptions.find(e=>e.type===c.GOOGLEDRIVE).name:""},G.prototype._shouldHideNotifications=function(){return gContainer.getProperty(G.AUTO_SAVE_HIDE_NOTIFICATION_PROP_NAME)},G.prototype._showNotification=async function(e){if(this._autoSaveModel.isSaving()||await this._shouldHideNotifications())return;let t="";t=e?i.GLocale.get(new i.GLocaleKey("GAutoSave","text.failed-auto-saving")):i.GLocale.get(G.ALTERNATE_STRINGS[Math.floor(Math.random()*G.ALTERNATE_STRINGS.length)]);let n={custom:!0,class:"g-auto-save-notification",enter:"enter",exit:"exit",timeout:5e3,content:[e?null:$("<div/>").addClass("spinner").append([$("<div/>"),$("<div/>"),$("<div/>"),$("<div/>"),$("<div/>"),$("<div/>"),$("<div/>"),$("<div/>")]),$("<div/>").addClass("message").text(t)],closeCallback:function(){gContainer.setProperty(G.AUTO_SAVE_HIDE_NOTIFICATION_PROP_NAME,!0)}};gDesigner.addNotification(n)},G.prototype._isCDRFile=function(e){return!1},e.exports=G},function(e,t,n){"use strict";function i(){}i.ID="edit.settings",e.exports=i},function(e,t,n){"use strict";class i{static getSetting(){return"scrubbing_flag"}static isEnabled(){return!!gDesigner.getSetting(i.getSetting(),!0)}}e.exports=i},function(e,t,n){"use strict";e.exports={SKIPPED:0,UPDATED:1,DELAYED:2}},function(e,t,n){"use strict";n(3);var i=n(1),o=n(56),r=n(18),a=n(144),s=n(26),l=n(76);function c(){c.TOOLTIP_CONFIG={[o.TOOLTIP_AREA.TOOLBAR]:o.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GLinkImageAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GLinkImageAction","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/working-with-images/insert-images/#link-image"})}}i.GObject.inherit(c,s),c.ID="file.link-import",c.TITLE=new i.GLocaleKey("GLinkImageAction","title"),c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return r.CATEGORY_FILE_IMPORT},c.prototype.getGroup=function(){return"import/place-import"},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-link-image":null},c.prototype.isEnabled=function(e){if(gContainer.getRuntime()!==l.Runtime.Electron)return!1;var t=gDesigner.getActiveDocument();return!!t&&((e=e||t.getStorage()||gDesigner.getDefaultStorage())&&e.canPromptOpen())},c.prototype.execute=function(e,t){var n=gDesigner.getActiveDocument();if(!n)return!1;(e=e||n.getStorage()||gDesigner.getDefaultStorage()).openPrompt(a.FileTypes.filter(e=>0===e.mime.indexOf("image")),e=>{var o="file://"+e.getUniqueId(),r=o,a=n.getScene().getDictionary().putValueIfAbsent(r);a&&(r=a.getUrl());var s=new Image;s.onload=()=>{var e=new i.GImage;e.setProperties(["iw","ih","url"],[s.naturalWidth,s.naturalHeight,r]),n.insertElement(e,!0,!0),t&&t()},s.src=o},!1)},c.prototype.isAvailable=function(){return gContainer.getRuntime()!==l.Runtime.IPad},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GLinkImageAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="view.zoom.original",s.TITLE=new i.GLocaleKey("GOriginalViewAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW},s.prototype.getGroup=function(){return"zoom"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"0"]},s.prototype.isEnabled=function(){return!!gDesigner.getActiveDocument()},s.prototype.execute=function(){var e,t=gDesigner.getActiveDocument(),n=t.getActiveWindow().getView().getViewConfiguration().multiPageView,o=t.getScene();if(o.isFixedSized()){var r=o.getActivePage();if(e=new i.GRect(0,0,r.getProperty("w"),r.getProperty("h")),n){var a=r.getPosition(!0);a&&(e=e.translated(a.getX(),a.getY()))}}else e=o.getPaintBBox(n);e&&!e.isEmpty()&&t.getActiveWindow().getView().zoomAtCenter(e.getSide(i.GRect.Side.CENTER),1)},s.prototype.toString=function(){return"[Object GOriginalViewAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(16),a=n(56),s=i(n(76)),l=n(18),c=n(144),d=n(26);function u(){u.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPlaceImportAction","tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPlaceImportAction","tooltip-description")),middle:!1,video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Place_Image.mp4",learnMore:"https://documentation.designer.io/working-with-images/insert-images/#place-image"})}}o.GObject.inherit(u,d),u.ID="file.place-import",u.TITLE=new o.GLocaleKey("GPlaceImportAction","title"),u.TOOLTIP_CONFIG=null,u.prototype.getId=function(){return u.ID},u.prototype.getTitle=function(){return u.TITLE},u.prototype.getCategory=function(){return l.CATEGORY_FILE_IMPORT},u.prototype.getGroup=function(){return"import/place-import"},u.prototype.isVisible=function(){return gContainer.getRuntime()!==s.default.Runtime.IPad},u.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-place-image":null},u.prototype.isEnabled=function(e){var t=gDesigner.getActiveDocument();return!!t&&((e=e||t.getStorage()||gDesigner.getDefaultStorage())&&e.canPromptOpen()&&gDesigner.getApplicationManager().isImportResourcesEnabled())},u.prototype.getShortcut=function(){return[r.GKey.Constant.OPTION,"P"]},u.prototype.execute=function(e,t){var n=gDesigner.getActiveDocument();if(!n)return!1;(e=e||n.getStorage()||gDesigner.getDefaultStorage()).openPrompt(c.FileTypes.filter(e=>e.import_image),e=>{gDesigner.stats("import-placeimport_open_localfile",e.getExtension()),n.placeOrImport(e),t&&t()},!1)},u.prototype.getTooltipConfig=function(e){return e&&u.TOOLTIP_CONFIG[e]||null},u.prototype.toString=function(){return"[Object GPlaceImportAction]"},e.exports=u},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(26);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GRedoAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GRedoAction","tooltip-description")),shortcut:l.SHORTCUT})}}i.GObject.inherit(l,s),l.ID="edit.redo",l.TITLE=new i.GLocaleKey("GRedoAction","title"),l.SHORTCUT=[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"z"],l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){var e=gDesigner.getActiveDocument();return e&&e.getEditor().hasRedoState()?i.GLocale.get(new i.GLocaleKey("GRedoAction","redo-action")).replace("%action",e.getEditor().getRedoStateName()):i.GLocale.get(l.TITLE)},l.prototype.getIcon=function(){return"gravit-icon-redo"},l.prototype.getCategory=function(){return a.CATEGORY_EDIT},l.prototype.getGroup=function(){return"undo_redo"},l.prototype.getShortcut=function(){return l.SHORTCUT},l.prototype.isEnabled=function(){return!(gDesigner.getActiveDocument()&&!gDesigner.getActiveDocument().isEditingEnabled())&&(!(!document.activeElement||!$(document.activeElement).is(":editable")||$(document.activeElement).is(":button")||$(document.activeElement).is("select")||gDesigner.isGravitIME(document.activeElement))||!(!gDesigner.getActiveDocument()||!gDesigner.getActiveDocument().getEditor().hasRedoState()))},l.prototype.execute=function(){!document.activeElement||!$(document.activeElement).is(":editable")||$(document.activeElement).is(":button")||$(document.activeElement).is("select")||gDesigner.isGravitIME(document.activeElement)?gDesigner.getActiveDocument().getEditor().redoState():document.execCommand("redo")},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GRedoAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="view.canvas.show-grid",s.TITLE=new i.GLocaleKey("GShowGridAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW_CANVAS},s.prototype.getGroup=function(){return"show/canvas"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.OPTION,"G"]},s.prototype.isEnabled=function(){return!!gDesigner.getActiveDocument()},s.prototype.isCheckable=function(){return!0},s.prototype.isChecked=function(){var e=gDesigner.getActiveDocument();return!!e&&!!e.getScene().getProperty("gm")},s.prototype.execute=function(){var e=gDesigner.getActiveDocument().getScene();e.getProperty("gm")?e.setProperty("gm",null):e.setProperty("gm",e.getProperty("lgm")||i.GScene.GridMode.Boxed)},s.prototype.toString=function(){return"[Object GShowGridAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=(n(16),n(18)),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="view.canvas.show-symbol-labels",a.TITLE=new i.GLocaleKey("GShowSymbolLabelsAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_VIEW_CANVAS},a.prototype.getGroup=function(){return"show/canvas"},a.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},a.prototype.isCheckable=function(){return!0},a.prototype.isChecked=function(){var e=gDesigner.getWindows().getActiveWindow();if(e){var t=e.getView().getViewConfiguration();return!!t&&!!t.symbolLabelsVisible}return!1},a.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView();e.getViewConfiguration().symbolLabelsVisible=!e.getViewConfiguration().symbolLabelsVisible,e.invalidate(),gDesigner.setSetting("symbol_labels_visible",e.getViewConfiguration().symbolLabelsVisible)},a.prototype.toString=function(){return"[Object GShowSymbolLabelsAction]"},e.exports=a},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1),o=n(18),r=n(26);n(143);function a(e,t){this._guideId=e,this._guideName=t}i.GObject.inherit(a,r),a.ID="view.toggle-guide",a.prototype._guideId=null,a.prototype._guideName=!1,a.prototype.getId=function(){return a.ID+"."+this._guideId},a.prototype.getTitle=function(){return i.GLocale.get(new i.GLocaleKey("GCommonNames","text.snap-to-action")).replace("%action",this._guideName)},a.prototype.getCategory=function(){return o.CATEGORY_VIEW_SNAP},a.prototype.getGroup=function(){return"snap/guide"},a.prototype.isCheckable=function(){return!0},a.prototype.isEnabled=function(){return!gDesigner.getSetting("snap_disabled")},a.prototype.isChecked=function(){return gDesigner.getSetting("snap_guides").indexOf(this._guideId)>=0},a.prototype.execute=function(){var e=gDesigner.getSetting("snap_guides").slice(),t=e.indexOf(this._guideId);t>=0?e.splice(t,1):e.push(this._guideId),gDesigner.setSetting("snap_guides",e)},a.prototype.toString=function(){return"[Object GToggleGuideAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(56),a=n(18),s=n(26);function l(){l.TOOLTIP_CONFIG={[r.TOOLTIP_AREA.TOOLBAR]:r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GToggleSnapAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GToggleSnapAction","tooltip-description")),shortcut:l.SHORTCUT,middle:!1,learnMore:"https://documentation.designer.io/design-aids/snaping/"})}}i.GObject.inherit(l,s),l.ID="view.toggle-snap",l.TITLE=new i.GLocaleKey("GToggleSnapAction","title"),l.SHORTCUT=[o.GKey.Constant.SHIFT,o.GKey.Constant.F10],l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_VIEW_SNAP},l.prototype.getGroup=function(){return"snap/enable"},l.prototype.getShortcut=function(){return l.SHORTCUT},l.prototype.isCheckable=function(){return!0},l.prototype.isChecked=function(){return!gDesigner.getSetting("snap_disabled")},l.prototype.execute=function(){gDesigner.setSetting("snap_disabled",!gDesigner.getSetting("snap_disabled"))},l.prototype.getTooltipConfig=function(e){if(!e)return null;const t=l.TOOLTIP_CONFIG[e];return t.setConfig({title:i.GLocale.get(new i.GLocaleKey("GToggleSnapAction","tootlip-title-action"))}),t},l.prototype.toString=function(){return"[Object GToggleSnapAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(56),r=n(18),a=n(26);function s(){s.TOOLTIP_CONFIG={[o.TOOLTIP_AREA.TOOLBAR]:o.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GToggleSnapZonesAction","tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GToggleSnapZonesAction","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/design-aids/snaping/#h.357kb75pbg9h"})}}i.GObject.inherit(s,a),s.ID="view.toggle-snapzones",s.TITLE=new i.GLocaleKey("GToggleSnapZonesAction","title"),s.TOOLTIP_CONFIG=null,s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW_SNAP},s.prototype.getGroup=function(){return"snap/enable"},s.prototype.isCheckable=function(){return!0},s.prototype.isChecked=function(){return gDesigner.getSetting("snap_zones")},s.prototype.execute=function(){gDesigner.setSetting("snap_zones",!gDesigner.getSetting("snap_zones"))},s.prototype.getTooltipConfig=function(e){return e&&s.TOOLTIP_CONFIG[e]||null},s.prototype.toString=function(){return"[Object GToggleSnapZonesAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16),a=n(56),s=n(18),l=n(26);function c(){c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GZoomInAction","tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GZoomInAction","tooltip-description")),shortcut:c.SHORTCUT})}}o.GObject.inherit(c,l),c.ID="view.zoom.in",c.TITLE=new o.GLocaleKey("GZoomInAction","title"),c.ZOOM_STEP=2,c.SHORTCUT=[r.GKey.Constant.META,"+"],c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return s.CATEGORY_VIEW_MAGNIFICATION},c.prototype.getGroup=function(){return"zoom/magnification"},c.prototype.getShortcut=function(){return c.SHORTCUT},c.prototype.isShortcutGlobal=function(){return!0},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-zoom-in":null},c.prototype.isEnabled=function(){var e=gDesigner.getWindows().getActiveWindow(),t=e?e.getView():null;return t&&t.getZoom()<r.GSceneWidget.options.maxZoomFactor},c.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView(),t=null;if(i.GZoomTool.options.zoomLevels){for(var n=i.GZoomTool.options.zoomLevels,o=e.getZoom(),a=n.length-1,s=0;s<n.length;s++)if(o<n[a-s]&&(t=n[a-s]),o===n[s]){t=a>0?n[s+1]:r.GSceneWidget.options.maxZoomFactor;break}}else t=e.getZoom()*c.ZOOM_STEP;gDesigner.zoomAtViewCenter(e,t)},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GZoomInAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16),a=n(56),s=n(18),l=n(26);function c(){c.TOOLTIP_CONFIG={[a.TOOLTIP_AREA.TOOLBAR]:a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GZoomOutAction","tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GZoomOutAction","tooltip-description")),shortcut:c.SHORTCUT})}}o.GObject.inherit(c,l),c.ID="zoom.out",c.TITLE=new o.GLocaleKey("GZoomOutAction","title"),c.ZOOM_STEP=2,c.SHORTCUT=[r.GKey.Constant.META,"-"],c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return s.CATEGORY_VIEW_MAGNIFICATION},c.prototype.getGroup=function(){return"zoom/magnification"},c.prototype.getShortcut=function(){return c.SHORTCUT},c.prototype.isShortcutGlobal=function(){return!0},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-zoom-out":null},c.prototype.isEnabled=function(){var e=gDesigner.getWindows().getActiveWindow(),t=e?e.getView():null;return t&&t.getZoom()>r.GSceneWidget.options.minZoomFactor},c.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView(),t=null;if(i.GZoomTool.options.zoomLevels){for(var n=i.GZoomTool.options.zoomLevels,o=e.getZoom(),a=(n.length,0);a<n.length;a++)if(o>n[a]&&(t=n[a]),o===n[a]){t=a>0?n[a-1]:r.GSceneWidget.options.minZoomFactor;break}}else t=e.getZoom()/c.ZOOM_STEP;gDesigner.zoomAtViewCenter(e,t)},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.toString=function(){return"[Object GZoomOutAction]"},e.exports=c},function(e,t,n){"use strict";const{GLocale:i,GLocaleKey:o}=n(1);function r(){throw"No instantiate"}r.Mode={Online:"online",Offline:"offline"};const a={init:function(){return this.each((function(){$(this).data("mode",r.Mode.Online).addClass("g-collaborators").append($("<div/>").addClass("g-collaborators-container"))}))},mode:function(e){const t=a[e];return t&&($(this).data("mode",e),t.call(this)),this},online:function(){const e=$(this).data("collaborators")||[];return a.collaborators.call(this,e),this},offline:function(){return $(this).find(".g-collaborators-container").attr("data-title",i.get(new o("GCollaborators","text.you-are-offline-tooltip"))).empty().append($("<div/>").addClass("g-collaborator").addClass("offline").append($("<span/>").addClass("gravit-icon-offline"))).append($("<span/>").text(i.get(new o("GCollaborators","text.you-are-offline")))),this},collaborators:function(e){if(arguments.length>0){if(!(e&&e.length||$(this).data("mode")!==r.Mode.Offline))return;const t=e=>{const t=e.getUserColor(),n=e.getTooltip()||"",i=e.getIcon(),o=$("<div/>").addClass("g-collaborator").attr("data-title",n).css("border-color",t).css("background-color",t).append($("<span/>").addClass("icon").addClass(i||"").css("display",i?"flex":"none"));if(e.hasOwnPictureAvatar()){const t=e.avatar;"<svg>"===t.substr(0,"<svg>".length)?$(t).appendTo(o):o.css({backgroundImage:'url("'.concat(t,'")')})}else $("<span/>").text(e.getUserNameInitials()).appendTo(o);return o},n=$(this).data("collaborators",e).find(".g-collaborators-container").removeAttr("data-title").empty().append(e.slice(0,4).map(e=>t(e)));if(e.length>4){const i=$("<div/>").gOverlay({clazz:"g-collaborators-overlay"}).append($("<div/>").addClass("g-collaborators-container").append(e.slice(4,e.length).map(e=>$("<div/>").addClass("g-collaborator-row").append(t(e)).append($("<span/>").text(e.name)))));$("<div/>").addClass("g-collaborator").addClass("plus").append($("<span/>").text("+ ".concat(e.length-4))).on("click",e=>{i.gOverlay("open",$(e.target).closest(".g-collaborator"))}).appendTo(n)}return this}return $(this).data("collaborators")}};$.fn.gCollaborators=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gCollaborators"):a.init.apply(this,arguments)},e.exports=r},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1);const{FILE_FORMATS:o,CLOUD_SYNC_FEATURE:{NEW_LAYOUT:r}={}}=n(12),a=n(18),s=n(26),l=n(106),c=n(401),d=n(77),u=n(144),p=n(398),g=n(36),h=o.find(e=>e.default).ext;function f(){}i.GObject.inherit(f,s),f.ID="cloud.sync",f.prototype.getId=function(){return f.ID},f.prototype._getSyncInformation=function(e){if(e.getScene()){const t=e.getScene().lastModifiedDate();return t?i.GLocale.get(new i.GLocaleKey("GCloudSynchronizationAction","text.last-synced-at")).replace("%date",i.GLocale.toLocaleDate(t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})):i.GLocale.get(new i.GLocaleKey("GDocumentChooser","text.cloud.unavailable"))}},f.prototype.isAvailable=function(){return!!r},f.prototype.getTitle=function(){const e=gDesigner.getActiveDocument();if(e){if(e.isSynchronizing())return new i.GLocaleKey("GCloudSynchronizationAction","text.syncing");if(e.isCloudFile())return this._getSyncInformation(e);if(e.isCloudSyncOn())return new i.GLocaleKey("GCloudSynchronizationAction","text.unsync-from-cloud")}return new i.GLocaleKey("GCloudSynchronizationAction","text.sync-to-cloud")},f.prototype.getIcon=function(){const e=gDesigner.getActiveDocument();if(e){if(e.isSynchronizing())return"gravit-icon-cloud-syncing";if(e.isCloudSyncOn()||e.isCloudFile())return"gravit-icon-cloud-synced"}return"gravit-icon-cloud-unsynced"},f.prototype.getInfo=function(){const e=gDesigner.getActiveDocument();return e&&e.isCloudSyncOn()&&!e.isSynchronizing()?this._getSyncInformation(e):null},f.prototype.getCategory=function(){return a.CATEGORY_FILE},f.prototype.getGroup=function(){return"file"},f.prototype.isVisible=function(){const e=gDesigner.getActiveDocument();return!!e&&(!e.isWebFile()&&!e.isExternalFile()&&!e.isNew()&&(!e.isCloudSyncOn()||e.isCloudSynchronismAvailable()))},f.prototype.isEnabled=function(){const e=gDesigner.getActiveDocument();return!!e&&(!e.isCloudFile()&&(!e.getScene().getProperty("cfs")&&!e.getScene().getProperty("cid")||e.getScene().isCloudSynchronization()))},f.prototype._performCloudSync=function(e){gDesigner.getDefaultStorage().canSave()?e.isNew()?l.createFile(e,t=>{e.getScene().setCloudSynchronization(t.id),gDesigner.executeAction(p.ID+"."+h,[null,e,()=>{l.renameFile(t,e.getTitle(),()=>{e.storeToCloud(e.getScene())})}],void 0,!0)}):e.isCloudFile()?gDesigner.executeAction(p.ID+"."+h,void 0,void 0,!0):l.createFile(e,t=>{e.getScene().setCloudSynchronization(t.id),e.storeToCloud(e.getScene(),()=>{e.store(null,null,null,{lastModifiedDate:e.getScene().getLastSavedTime()})})}):e.isCloudFile()?gDesigner.executeAction(p.ID+"."+h,void 0,void 0,!0):gDesigner.executeAction(c.ID+".save-as",[e,t=>{t===d.Loaded&&gDesigner.removeDocument(e,null,!0)},!0],void 0,!0)},f.prototype._toggleCloudSync=function(e){const t=!e.isCloudSyncOn(),n=e.getScene();n.setProperty("cfs",t),n.getProperty("cfs")?e.chooseLatestDocument(n,(function(t,i){if(t!==n||i){const n=new u(e.getStorageItem());n.setScene(t),gDesigner.replaceDocument(e,n)}else e.storeToCloud(t,()=>{gDesigner.getDefaultStorage().canSave()&&e.store(null,null,null,{lastModifiedDate:n.getLastSavedTime()})})}),(function(){g.alert(i.GLocale.get(new i.GLocaleKey("GDocument","text.sync-to-cloud-error")))}),(function(e,t){return t.lastModifiedDate().getTime()>e.lastModifiedDate().getTime()})):e.isCloudFile()||(gDesigner.getDefaultStorage().canSave()?e.store():gDesigner.executeAction(p.ID+"."+h,void 0,void 0,!0))},f.prototype.statsValue=function(){return gDesigner.getActiveDocument().isCloudSyncOn()?f.ID+".unsync-from-cloud":f.ID+".sync-to-cloud"},f.prototype.execute=function(e){(e=e||gDesigner.getActiveDocument())&&(e.hasCloudReference()?this._toggleCloudSync(e):this._performCloudSync(e))},f.prototype.toString=function(){return"[Object GCloudSynchronizationAction]"},e.exports=f},function(e,t,n){"use strict";var i=n(17);n(45),n(14),n(115),n(3);var o=n(43),r=n(1),a=n(56),s=i(n(309)),l=n(775),c=n(776),d=n(108),u=(n(143),n(118)),p=n(232),g=n(1178);function h(){this._elements=[]}r.GObject.inherit(h,d),h._keepRatioName="designer.settings.dimension.preserveratio",h.prototype._panel=null,h.prototype._toolbar=null,h.prototype._transformButton=null,h.prototype._document=null,h.prototype._elements=null,h.prototype._elementsBBox=null,h.prototype._anchorsPanel=null,h.prototype._firstElementsBBox=null,h.prototype.init=function(e,t){this._panel=e,this._toolbar=t,this._panel.addClass("dimension-panel"),this.setTouchTools([new s.default({id:"dimension.align",icon:"gravit-icon-align",panelWidth:"370px",panel:this._toolbar}),new s.default({id:"dimension.dimension",icon:"gravit-icon-touch-transform",toolbar:".advanced-transform-toolbar",panelWidth:"395px",panel:[this._panel,".advanced-transform-properties"]})]);var n=function(e,t){var n=this;if("keep-ratio"==e)return $("<span></span>").addClass(o.GEditorOptions.preserveAspectRatio?"gravit-icon-linked":"gravit-icon-unlinked").css("text-align","center").css("cursor","pointer").on("click",(function(e){var t=$(this);"yes"===t.attr("data-ratio")?(t.attr("data-ratio","no").attr("class","gravit-icon-unlinked"),n._setAspectRatioBehavior(!1),gDesigner.stats("dimension_toggle_preserveratio","disabled")):(t.attr("data-ratio","yes").attr("class","gravit-icon-linked"),n._setAspectRatioBehavior(!0),gDesigner.stats("dimension_toggle_preserveratio","enabled"))})).attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.keep-ratio"))).attr("data-ratio",o.GEditorOptions.preserveAspectRatio?"yes":"no").gRichTooltip(t);if("x"===e||"y"===e||"w"===e||"h"===e){var i=r.GLocale.get(new r.GLocaleKey("GCommonNames","property-".concat(e.toLowerCase())),e);return $("<div/>").append($("<input>").attr("type","text").attr("data-dimension",e).on("change",function(t){gDesigner.stats("dimension_set_positionOrSize"),this._assignDimension(e,$(t.target).gInputBox("value"))}.bind(this)).gInputBox({minValue:"w"===e||"h"===e?0:null})).gInputLabel({label:i,autoPadding:i.length>1}).gRichTooltip(t)}return"rotate"===e?$("<div/>").append($("<input>").attr("type","text").attr("data-dimension",e).on("change",function(t){gDesigner.stats("dimension_set_rotation"),this._assignDimension(e,$(t.target).gInputBox("value"))}.bind(this)).gInputBox({postfix:"°"})).gInputLabel({label:"R"}).gRichTooltip(t):void 0}.bind(this);function i(e){var t=l.ID+"."+e,n=gDesigner.getAction(t);const i=n.getTooltipConfig(a.TOOLTIP_AREA.SIDEBAR),o=$("<span></span>");return p.icon?(o.addClass("icon"),o.addClass(n.getIcon())):o.append(n.getIcon()),o.css("stroke","transparent"),i&&o.gRichTooltip(i),$("<button></button>").attr("data-title",r.GLocale.get(n.getTitle())).attr("data-action",t).addClass("svg-button").append(o.addClass("normal")).append($("<span/>").addClass("gravit-icon-touch-".concat(e," touch"))).on("click",(function(){gDesigner.executeAction(t,void 0,"dimensionproperties")}))}function d(e){var t=c.ID+"."+e,n=gDesigner.getAction(t);const i=n.getTooltipConfig(a.TOOLTIP_AREA.SIDEBAR),o=$("<span></span>").append(n.getIcon());return i&&o.gRichTooltip(i),$("<button></button>").attr("data-title",r.GLocale.get(n.getTitle())).attr("data-action",t).addClass("svg-button").append(o.addClass("normal")).append($("<span/>").addClass("gravit-icon-touch-".concat(e," touch"))).on("click",(function(){var n=$(".".concat(e,"Input")).find("input").val();n="Auto"==n?void 0:parseInt(n),gDesigner.executeAction(t,[void 0,void 0,n],"dimensionproperties")}))}function u(e){var t=$("<div></div>").addClass(e+"Input").gInputSelect({list:["Auto","0",1,10,20,30,50,100]}),n=/^-?[0-9]+.?[0-9]*$/;return t.find("input").val("Auto").off("change").on("change",(function(){n.test($(this).val())||$(this).val("Auto")})),t}t.addClass("main-toolbar").append(d(c.Type.Horizontal).addClass("primary normalDistribute")).append(d(c.Type.Vertical).addClass("primary normalDistribute")).append($("<span></span>").addClass("divider")).append(i(o.GEditor.ArrangeAlignType.AlignLeft).addClass("secondary")).append(i(o.GEditor.ArrangeAlignType.AlignCenter).addClass("secondary")).append(i(o.GEditor.ArrangeAlignType.AlignRight).addClass("secondary")).append($("<span></span>").addClass("divider")).append($("<p/>").addClass("interval")).append(i(o.GEditor.ArrangeAlignType.AlignTop).addClass("secondary")).append(i(o.GEditor.ArrangeAlignType.AlignMiddle).addClass("secondary")).append(i(o.GEditor.ArrangeAlignType.AlignBottom).addClass("secondary")).append($("<p/>").addClass("lineBreak")).append(d(c.Type.Horizontal).addClass("primary touchDistribute")).append(u(c.Type.Horizontal).addClass("touchDistribute")).append($("<p/>").addClass("interval")).append(d(c.Type.Vertical).addClass("primary touchDistribute")).append(u(c.Type.Vertical).addClass("touchDistribute")),this._advancedFillPanel=$("<div></div>").gOverlay({releaseOnClose:!1}),this._advancedFillPanel.parent().addClass("settingBox"),$("<div></div>").addClass("alignSettings").gPropertyRow({columns:[{width:"100%",content:$("<div></div>").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.sameHeight"))).prepend($("<span></span>").addClass("gravit-icon-sameHeight")).on("click",()=>{new l(o.GEditor.ArrangeAlignType.AlignJustifyVertical).execute(),this._advancedFillPanel.gOverlay("close")})}]}).gPropertyRow({columns:[{width:"100%",content:$("<div></div>").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.sameWidth"))).prepend($("<span></span>").addClass("gravit-icon-sameWidth")).on("click",()=>{new l(o.GEditor.ArrangeAlignType.AlignJustifyHorizontal).execute(),this._advancedFillPanel.gOverlay("close")})}]}).gPropertyRow({columns:[{width:"100%",content:$("<div></div>").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.fullUnit"))).prepend($("<span></span>").addClass("gravit-icon-fullUnit")).on("click",()=>{new g(g.Type.FullUnit).execute(),this._advancedFillPanel.gOverlay("close")})}]}).gPropertyRow({columns:[{width:"100%",content:$("<div></div>").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.halfUnit"))).prepend($("<span></span>").addClass("gravit-icon-HalfUnit")).on("click",()=>{new g(g.Type.HalfUnit).execute(),this._advancedFillPanel.gOverlay("close")})}]}).appendTo(this._advancedFillPanel),$("<p/>").addClass("lineBreak").prependTo(t),$("<button></button>").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.setting"))).addClass("align-settings").append($("<span></span>").addClass("gravit-icon-touch-settings")).on("click",function(e){this._advancedFillPanel.gOverlay("open",$(e.target).closest("button"))}.bind(this)).prependTo(t),$("<label></label>").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.alignTitle"))).prependTo(t);const h=a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.property-x-y-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.property-x-y-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/property-panel/#objects-position"}),f=a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.property-w-h-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.property-w-h-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/property-panel/#objects-size"}),m=a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.keep-ratio-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.keep-ratio-tooltip-description"))}),y=a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform-button-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform-button-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/"}),v=a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.rotate-angle-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.rotate-angle-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/property-panel/#objects-angle"});$("<div/>").addClass("transform-titile").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform-title"))).appendTo(this._panel),$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.position")),columns:[{width:"44%",content:n("x",h)},{width:"12%"},{width:"44%",content:n("y",h)}]}).appendTo(e),$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.size")),columns:[{width:"44%",content:n("w",f)},{width:"12%",content:n("keep-ratio",m)},{width:"44%",content:n("h",f)}]}).appendTo(e),this._transformButton=$("<button>"+r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform"))+"</button>").addClass("transform-button").on("click",this._toggleTransformMode.bind(this)).gRichTooltip(y),$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.angle")),columns:[{width:"44%",content:n("rotate",v)},{width:"12%"},{width:"44%",content:this._transformButton}]}).appendTo(e),this._anchorsPanel=$("<div></div>").gPropertyRow({label:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchors")),columns:[{width:"44%",content:$("<div/>").addClass("anchor-buttons").append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-left")).addClass("g-button").addClass("g-group-start").addClass("hacr-start").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-left"))).on("click",function(){gDesigner.stats("dimension_set_anchors-horizontalstart");var e=this._getHorizontalAnchorValue(),t=this._defineAnchorProperty("hacr",r.GElement.Anchor.AnchorType.Start,e);this._defineAnchorButtonState(null,t)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-left-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-left-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"}))).append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-center")).addClass("g-button").addClass("g-group-element").addClass("hacr-middle").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-center"))).on("click",function(){gDesigner.stats("dimension_set_anchors-horizontalmiddle");var e=this._getHorizontalAnchorValue(),t=this._defineAnchorProperty("hacr",r.GElement.Anchor.AnchorType.Middle,e);this._defineAnchorButtonState(null,t)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-center-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-center-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"}))).append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-right")).addClass("g-button").addClass("g-group-end").addClass("hacr-end").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-right"))).on("click",function(){gDesigner.stats("dimension_set_anchors-horizontalend");var e=this._getHorizontalAnchorValue(),t=this._defineAnchorProperty("hacr",r.GElement.Anchor.AnchorType.End,e);this._defineAnchorButtonState(null,t)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-right-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-right-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"})))},{width:"12%"},{width:"44%",content:$("<div>").addClass("anchor-buttons").append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-top")).addClass("g-button").addClass("g-group-start").addClass("vacr-start").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-top"))).on("click",function(){gDesigner.stats("dimension_set_anchors-verticalstart");var e=this._getVerticalAnchorValue(),t=this._defineAnchorProperty("vacr",r.GElement.Anchor.AnchorType.Start,e);this._defineAnchorButtonState(t,null)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-top-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-top-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"}))).append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-middle")).addClass("g-button").addClass("g-group-element").addClass("vacr-middle").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-middle"))).on("click",function(){gDesigner.stats("dimension_set_anchors-verticalmiddle");var e=this._getVerticalAnchorValue(),t=this._defineAnchorProperty("vacr",r.GElement.Anchor.AnchorType.Middle,e);this._defineAnchorButtonState(t,null)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-middle-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-middle-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"}))).append($("<div/>").append($("<span/>").addClass("gravit-icon-anchor-bottom")).addClass("g-button").addClass("g-group-end").addClass("vacr-end").attr("data-title",r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.anchor-bottom"))).on("click",function(){gDesigner.stats("dimension_set_anchors-verticalend");var e=this._getVerticalAnchorValue(),t=this._defineAnchorProperty("vacr",r.GElement.Anchor.AnchorType.End,e);this._defineAnchorButtonState(t,null)}.bind(this)).gRichTooltip(a.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-bottom-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.anchor-bottom-tooltip-description")),learnMore:"https://documentation.designer.io/design-aids/anchoring/"})))}]}).addClass("anchor-panel").appendTo(e)},h.prototype._setAspectRatioBehavior=function(e){o.GEditorOptions.preserveAspectRatio=e,o.GEditorOptions.allowTextRatioPreservation=e,gContainer.setProperty(h._keepRatioName,e)},h.prototype.isAvailable=function(e){return this._transformButton.toggleClass("g-active",e),gDesigner.isTouchEnabled()&&(e?(this._transformButton.text(r.GLocale.get(new r.GLocaleKey("GLocale","close"))),$(".advanced-transform-toolbar > label").text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform-advanced"))),this._anchorsPanel.toggleClass("down",!0),this._panel.toggleClass("have-anchor",!1),$(".advanced-transform-properties").toggleClass("have-anchor",!0)):(this._transformButton.text(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","text.transform"))),this._anchorsPanel.toggleClass("down",!1),this._panel.toggleClass("have-anchor",!0),$(".advanced-transform-properties").toggleClass("have-anchor",!1),this._panel.addClass("have-anchor")),this._changeSideBarContinerZIndex(e)),!0},h.prototype._changeSideBarContinerZIndex=function(e){gDesigner.isTouchEnabled()&&(e?gDesigner.getRightSidebars().addClassName("more-z-index"):gDesigner.getRightSidebars().removeClassName("more-z-index"))},h.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(r.GElement.GeometryChangeEvent,this._geometryChange,this),this._document.getScene().removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getEditor().removeEventListener(o.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),gDesigner.removeEventListener(u,this._settingChanged),this._document=null),this._elements=[],$(this._panel).find(".anchor-panel").css("display","none"),e){for(var n=0;n<t.length;++n)!t[n].hasMixin(r.GElement.Transform)||t[n]instanceof r.GPage||this._elements.push(t[n]);if(this._elements.length&&this._elements.length===t.length)return this._document=e,this._document.getScene().addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(r.GElement.GeometryChangeEvent,this._geometryChange,this),this._document.getEditor().addEventListener(o.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),gDesigner.addEventListener(u,this._settingChanged,this),this._updateDimensions(),this._updateToolbar(),this._showAnchor()&&($(this._panel).find(".anchor-panel").css("display",""),this._defineAnchorButtonState(this._getVerticalAnchorValue(),this._getHorizontalAnchorValue())),!0}return!1},h.prototype._toggleTransformMode=function(){gDesigner.stats("dimension_change_transform-mode");var e=gDesigner.getToolManager();e.getActiveTool()&&e.getActiveTool()instanceof o.GSelectTool||e.activateTool(o.GPointerTool),e.getActiveTool()instanceof o.GSelectTool&&e.getActiveTool().setEditMode(e.getActiveTool().getEditMode()===o.GSelectTool.EditMode.Transform?o.GSelectTool.EditMode.Select:o.GSelectTool.EditMode.Transform)},h.prototype._geometryChange=function(e){e.type!==r.GElement.GeometryChangeEvent.Type.After&&e.type!==r.GElement.GeometryChangeEvent.Type.Child||this._elements.indexOf(e.element)>=0&&this._updateDimensions()},h.prototype._edGeometryChange=function(e){this._updateDimensions(!1,!0)},h.prototype._afterPropertiesChange=function(e){!e.temporary&&this._elements&&this._elements.indexOf(e.node)>=0&&this._showAnchor()&&this._defineAnchorButtonState(this._getVerticalAnchorValue(),this._getHorizontalAnchorValue())},h.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateDimensions()},h.prototype._getCurrentDimensions=function(e,t){var n=null,i=0;if(!e){this._elementsBBox=null,this._firstElementsBBox=null;for(var a=0;a<this._elements.length;++a){var s=this._elements[a];if(s.hasMixin(r.GElement.Transform)){var l=null;if(t){var c=o.GElementEditor.getEditor(s);c&&c.getElement()&&(l=c.getPEGeometryBBox())}else l=s.getGeometryBBox();l&&(this._elementsBBox=this._elementsBBox?this._elementsBBox.united(l):l,this._firstElementsBBox||(this._firstElementsBBox=l,i=t&&c?c.getRotationAngle():s.getAngle()))}}this._elementsBBox||(this._elementsBBox=null,this._firstElementsBBox=this._elementsBBox)}if(this._firstElementsBBox){var d=this._elements.length>1,u=this._getDelta();if(d){var p=0;if(t){var g=this._document.getEditor().getSelectionEditor();g&&(p=g.getRotationAngle())}n={x:this._elementsBBox.getX()-u.getX(),y:this._elementsBBox.getY()-u.getY(),w:this._elementsBBox.getWidth(),h:this._elementsBBox.getHeight(),angle:p}}else n={x:this._firstElementsBBox.getX()-u.getX(),y:this._firstElementsBBox.getY()-u.getY(),w:this._firstElementsBBox.getWidth(),h:this._firstElementsBBox.getHeight(),angle:i}}return n},h.prototype._updateDimensions=function(e,t){var n=(e,t)=>{var n="";if(null!==t)switch(e){case"x":case"y":case"w":case"h":n=this._document.getScene().pointToString(t,this._document.getScene().getOptimalDecimalsCount());break;case"rotate":n=r.GUtil.formatNumber(r.GMath.toDegrees(t),1)}this._panel.find('input[data-dimension="'+e+'"]').gInputBox("value",n).prop("disabled",null===t)},i=this._getCurrentDimensions(e,t);i?(this._panel.find("[data-ratio]").css("display",""),n("x",i.x),n("y",i.y),n("w",i.w),n("h",i.h),n("rotate",i.angle)):(this._panel.find("[data-ratio]").css("display","none"),n("x",null),n("y",null),n("w",null),n("h",null),n("rotate",0))},h.prototype._updateToolbar=function(){this._toolbar.find("[data-action]").each(function(e,t){var n=$(t);n.prop("disabled",!gDesigner.canExecuteAction(n.attr("data-action")))}.bind(this)),this._toolbar.find(".touchDistribute>input").each(function(e,t){$(t).prop("disabled",!gDesigner.canExecuteAction("arrange.distribute.horizontal"))}.bind(this)),this._toolbar.find(".touchDistribute>button").each(function(e,t){$(t).prop("disabled",!gDesigner.canExecuteAction("arrange.distribute.horizontal"))}.bind(this))},h.prototype._assignDimension=function(e,t){if(this._document){var n=null,i=null,a="",s=this._getCurrentDimensions(!1,!1);switch(e){case"x":case"y":a="Move",n=this._document.getScene().stringToPoint(t),i=s?"x"==e?s.x:s.y:null;break;case"w":case"h":a=r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.change-size")),n=this._document.getScene().stringToPoint(t),i=s?"w"==e?s.w:s.h:null;break;case"rotate":a=r.GLocale.get(new r.GLocaleKey("GCommonNames","action.rotate")),n=r.GLength.parseEquationValue(t),i=s?s.angle:null}if(null===n||"number"!=typeof n||("w"==e||"h"==e)&&n<=0||n===i)this._updateDimensions();else{if("x"===e||"y"===e){var l=this._getDelta();switch(e){case"x":n+=l.getX();break;case"y":n+=l.getY()}}var c=function(t,i,o){if("w"===e||"h"===e){if("w"===e&&t.getWidth()<=0||"h"===e&&t.getHeight()<=0)return new r.GTransform;var a=1,s=1;switch(e){case"w":a=n/t.getWidth(),i&&(s=a);break;case"h":s=n/t.getHeight(),i&&(a=s)}return(new r.GTransform).translated(-t.getX(),-t.getY()).scaled(a,s).translated(t.getX(),t.getY())}if("x"===e)return(new r.GTransform).translated(n-t.getX(),0);if("y"===e)return(new r.GTransform).translated(0,n-t.getY());if("rotate"===e){var l=t.getSide(r.GRect.Side.CENTER);o=o||0;return(new r.GTransform).translated(-l.getX(),-l.getY()).rotated(o-r.GMath.toRadians(n)).translated(l.getX(),l.getY())}},d=this._elements.length>1,u="yes"===this._panel.find("[data-ratio]").attr("data-ratio"),p=this._document.getEditor();p.beginTransaction();try{for(var g=function(t,n,i,a){if(t=i.length&&i.indexOf(t)>=0?null:t){var s=t instanceof r.GSymbol&&("x"===e||"y"===e)||"rotate"===e||a&&a.fullContentTransform,l=o.GElementEditor.openEditor(t);l?(l._setTransform(n),l.applyTransform(t,s,i)):t.transform(n,s,i)}},h=[],f=0;f<this._elements.length;++f){var m=this._elements[f];h=h.concat(p.getLinkedElementsInSelection(m,this._elements))}if(d){if(this._elementsBBox){var y=c(this._elementsBBox,u);for(f=0;f<this._elements.length;++f)g(this._elements[f],y,h,p.getEdTransformSettings())}}else for(f=0;f<this._elements.length;++f){var v=this._elements[f].getGeometryBBox();if(v)(y=c(v,u,"rotate"===e?this._elements[f].getAngle():null))&&!y.isIdentity()&&g(this._elements[f],y,h,p.getEdTransformSettings())}}finally{p.commitTransaction(a)}}}},h.prototype._showAnchor=function(){for(var e=this._elements,t=!0,n=0;n<e.length;++n)if(!e[n].getParent()||!e[n].getParent().hasMixin(r.GElement.Layout)){t=!1;break}return t},h.prototype._getHorizontalAnchorValue=function(){for(var e=this._elements,t=e[0].getProperty("hacr")?e[0].getProperty("hacr"):0,n=0;n<e.length;++n)if(e[n].getProperty("hacr")!==t){t=0;break}return t},h.prototype._getVerticalAnchorValue=function(){for(var e=this._elements,t=e[0].getProperty("vacr")?e[0].getProperty("vacr"):0,n=0;n<e.length;++n)if(e[n].getProperty("vacr")!==t){t=0;break}return t},h.prototype._defineAnchorButtonState=function(e,t){null!==e&&($(this._panel).find(".vacr-middle").addClass(e===r.GElement.Anchor.AnchorType.Middle?"g-active":""),$(this._panel).find(".vacr-start").addClass(e===r.GElement.Anchor.AnchorType.Stretch||e===r.GElement.Anchor.AnchorType.Start?"g-active":""),$(this._panel).find(".vacr-end").addClass(e===r.GElement.Anchor.AnchorType.Stretch||e===r.GElement.Anchor.AnchorType.End?"g-active":""),$(this._panel).find(".vacr-middle").removeClass(e!==r.GElement.Anchor.AnchorType.Middle?"g-active":""),$(this._panel).find(".vacr-start").removeClass(e!==r.GElement.Anchor.AnchorType.Start&&e!==r.GElement.Anchor.AnchorType.Stretch?"g-active":""),$(this._panel).find(".vacr-end").removeClass(e!==r.GElement.Anchor.AnchorType.End&&e!==r.GElement.Anchor.AnchorType.Stretch?"g-active":"")),null!==t&&($(this._panel).find(".hacr-middle").addClass(t===r.GElement.Anchor.AnchorType.Middle?"g-active":""),$(this._panel).find(".hacr-start").addClass(t===r.GElement.Anchor.AnchorType.Stretch||t===r.GElement.Anchor.AnchorType.Start?"g-active":""),$(this._panel).find(".hacr-end").addClass(t===r.GElement.Anchor.AnchorType.Stretch||t===r.GElement.Anchor.AnchorType.End?"g-active":""),$(this._panel).find(".hacr-middle").removeClass(t!==r.GElement.Anchor.AnchorType.Middle?"g-active":""),$(this._panel).find(".hacr-start").removeClass(t!==r.GElement.Anchor.AnchorType.Start&&t!==r.GElement.Anchor.AnchorType.Stretch?"g-active":""),$(this._panel).find(".hacr-end").removeClass(t!==r.GElement.Anchor.AnchorType.End&&t!==r.GElement.Anchor.AnchorType.Stretch?"g-active":""))},h.prototype._defineAnchorProperty=function(e,t,n){var i=t;return t===n?i=0:t!==r.GElement.Anchor.AnchorType.Middle&&(n===r.GElement.Anchor.AnchorType.Stretch?i=t===r.GElement.Anchor.AnchorType.End?r.GElement.Anchor.AnchorType.Start:r.GElement.Anchor.AnchorType.End:n===r.GElement.Anchor.AnchorType.Start?i=t===r.GElement.Anchor.AnchorType.End?r.GElement.Anchor.AnchorType.Stretch:0:n===r.GElement.Anchor.AnchorType.End&&(i=t===r.GElement.Anchor.AnchorType.Start?r.GElement.Anchor.AnchorType.Stretch:0)),this._assignAnchorProperty([e],[i]),i},h.prototype._assignAnchorProperty=function(e,t){if(this._document){var n=this._document.getEditor();n.beginTransaction();try{for(var i=0;i<this._elements.length;++i){var a=this._elements[i];if(a.getParent().hasMixin(r.GElement.Layout)){var s=o.GElementEditor.getEditor(this._elements[i]);s&&s.applyPropertiesToParts(e,t)||this._elements[i].setProperties(e,t)}}}finally{n.commitTransaction(r.GLocale.get(new r.GLocaleKey("GDimensionProperties","action.change-anchor")))}}else console.warn("GDimensionProperties: empty _document property")},h.prototype._getDelta=function(){return new r.GPoint(0,0)},h.prototype.toString=function(){return"[Object GDimensionProperties]"},e.exports=h},function(e,t,n){"use strict";n(3);var i=n(43),o=n(16),r=n(1),a=n(18),s=n(26);function l(e){this._category=e,this._title=new r.GLocaleKey("GSnapUnitAction","title."+e)}r.GObject.inherit(l,s),l.Type={FullUnit:"full",HalfUnit:"half"},l.ID="arrange.snap-unit",l.prototype._category=null,l.prototype._title=null,l.prototype.getId=function(){return l.ID+"."+this._category},l.prototype.getTitle=function(){return this._title},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_ALIGN},l.prototype.getGroup=function(){return"arrange/snap-unit"},l.prototype.getShortcut=function(){switch(this._category){case l.Type.FullUnit:return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"U"];default:return null}},l.prototype.isEnabled=function(e){return(e=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null))&&e.length>0},l.prototype.execute=function(e){var t=gDesigner.getActiveDocument(),n=t.getScene();e||(e=t.getEditor().getIndividualSelection()),i.GEditor.tryRunTransaction(n,function(){for(var t=0;t<e.length;++t){var n=e[t];if(n.hasMixin(r.GElement.Transform)){var i=n.getGeometryBBox();if(i&&i.getWidth()+i.getHeight()!==0){var o=r.GMath.round(i.getX(),!0),a=r.GMath.round(i.getY(),!0),s=r.GMath.round(i.getWidth(),!0),c=r.GMath.round(i.getHeight(),!0);this._category===l.Type.HalfUnit&&(o+=.5,a+=.5,s+=.5,c+=.5);var d=(new r.GTransform).translated(-i.getX(),-i.getY()).scaled(s/(i.getWidth()||1),c/(i.getHeight()||1)).translated(i.getX(),i.getY()).translated(o-i.getX(),a-i.getY());n.transform(d)}}}}.bind(this),r.GLocale.get(this.getTitle()))},l.prototype.toString=function(){return"[Object GSnapUnitAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="view.clone",s.TITLE=new i.GLocaleKey("GNewWindowAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW},s.prototype.getGroup=function(){return"view"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.OPTION,"N"]},s.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},s.prototype.execute=function(){gDesigner.getWindows().addWindow(gDesigner.getWindows().getActiveWindow())},s.prototype.toString=function(){return"[Object GNewWindowAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(16),a=i(n(18)),s=i(n(26)),l=i(n(395));function c(){}o.GObject.inherit(c,s.default),c.ID="view.outline-view",c.TITLE=new o.GLocaleKey("GOutlineViewAction","title"),c.GroupID="view",c.StoragePropertyName="designer.settings.outline-view.enabled",c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return o.GLocale.get(c.TITLE)},c.prototype.getCategory=function(){return a.default.CATEGORY_VIEW},c.prototype.getGroup=function(){return c.GroupID},c.prototype.isCheckable=function(){return!0},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-out-line":null},c.prototype.isChecked=function(){const e=gDesigner.getWindows().getActiveWindow();if(e){const t=e.getView().getViewConfiguration();return!!t&&t.paintMode===o.GScenePaintConfiguration.PaintMode.Outline}return!1},c.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},c.prototype.getShortcut=function(){return[r.GKey.Constant.OPTION,"Y"]},c.prototype.execute=function(){let e;if(gDesigner.getWindows().getActiveWindow().getView().getViewConfiguration().paintMode===o.GScenePaintConfiguration.PaintMode.Outline){var t=gDesigner.getActiveDocument();if(t){var n=t.getScene().getActivePage();if(n&&!n.isFixedSized())e=o.GScenePaintConfiguration.PaintMode.Full;else e=(n.getProperty(l.default.PAGE_CLIP_PROPERTY_NAME,!0)||l.default.PAGE_CLIP_CONTENT_ENABLED)===l.default.PAGE_CLIP_CONTENT_ENABLED?o.GScenePaintConfiguration.PaintMode.Output:o.GScenePaintConfiguration.PaintMode.Full}else e=o.GScenePaintConfiguration.PaintMode.Output}else e=o.GScenePaintConfiguration.PaintMode.Outline;gDesigner.setPaintMode(e),gDesigner.updateGEditorSceneConfigurationPaintMode(e)},c.prototype.toString=function(){return"[Object GOutlineViewAction]"},e.exports=c},function(e,t,n){"use strict";n(9),n(3);var i=n(1),o=n(26),r=n(18);const a=n(36),s=n(106);function l(){}i.GObject.inherit(l,o),l.ID="use-coupon-action",l.TITLE=new i.GLocaleKey("GUseCouponAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_HELP},l.prototype.getGroup=function(){return"help"},l.prototype.isVisible=function(){if(!gDesigner.isInAppPurchaseAllowed())return!1;const e=gDesigner.getLicense(),t=!(e.isPro()&&!e.isExpired()),n=!gDesigner.isAnonymous(),i=!e.isGuest();return t&&n&&i},l.prototype.execute=function(){a.prompt(i.GLocale.get(new i.GLocaleKey("GUseCouponAction","text.hava-coupon")),async e=>{if(e)return s.activateCoupon(e);a.alert(i.GLocale.get(new i.GLocaleKey("GUseCouponAction","text.invalid-coupon")))})},l.prototype.toString=function(){return"[Object GUseCouponAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(19),n(24),n(14),n(759),n(9),n(25),n(29),n(84),n(261),n(321),n(3),n(158),n(201),n(166),n(167),n(171),n(28),n(297),n(83);var o=n(1),r=n(1417),a=n(32),s=n(768),l=n(1423),c=n(771),d=n(766),u=i(n(1427)),p=i(n(77)),g=i(n(106)),h=i(n(715)),f=i(n(1125)),m=i(n(398)),y=i(n(36)),v=i(n(385)),_=n(12),b=n(472),w=i(n(1428));const C=n(151),E=n(78);var S=_.CloudIntegration.cloudOptions,G=_.CloudIntegration.nativeOption,A=[..._.CloudIntegration.cloudOptions,_.CloudIntegration.nativeOption];function T(e){this._initializeDefaultValues(e),this._initializingPromise=this._init(e)}T.prototype._initializingPromise=null,T.prototype._GUISettings=null,T.prototype._cloudSettings=null,T.prototype.view=null,T.prototype.drive=null,T.prototype.MODE=null,T.IMAGES_WAIT_TIMEOUT=2e4,T.DriveAccountsSettingName="designer.filespanel.cloud-accounts",T.DriveAccountsActiveSettingsName="designer.filespanel.cloud-accounts.active",o.GObject.inherit(T,o.GObject),T.prototype._showEmptyPanel=!1,T.prototype._hasFolders=!1,T.prototype._showRecentFiles=!1,T.prototype._isSaveMode=!1,T.prototype._documentToSave=null,T.prototype._initializeDefaultValues=function(e){var t=this;let{closeCallback:n=a.fakeFunction,documentToSave:i,cancelSave:o=a.fakeFunction,defaultFilename:r,readyStateChange:s,showExampleFiles:l,GUISettings:c,saveMode:u,driveSettings:p=null,isDashboard:g,isCorporateStoragesEnabled:h=!0}=e;this._GUISettings=c||new T.GUISettings,this._driveSettings=p||new f.default,this.SELECTION=[],this.TEMP_SELECTION=[],this.CURRENT_FILE_LOAD=0,this.CURRENT_UPDATE_OPERATION_ID=-1,this.MODE=d.GFilesPanelClipboardModes.DEFAULT,this.BUILD_IN_PROGRESS=!1,this.DEFAULT_FILENAME=r,this._newClipBoard=!1,this._showExampleFiles=l,this._isDashboard=g,this._isCorporateStoragesEnabled=h,this.readyStateChange=s,this.search=(0,a.debounce)(this.search,200);var m=e=>function(){t._removeEventListeners(),e(...arguments)};this._onCancelSaveCallback=o&&m(o),this._onCloseCallback=n&&m(n),this._documentToSave=i,this._isSaveMode=u||this._documentToSave},T.prototype._init=async function(e){let{parentComponent:t,nativeCloud:n,initCallback:i}=e;return this.USER=await gDesigner.getUser(),this.panel=$("<div/>").addClass("g-files-panel").appendTo(t),this.initLayout(n).then(()=>{i&&i()}).catch(e=>{i&&i(e)})},T.GUISettings=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({dialogControls:!0,downloadSourceFile:!1},e)},T.prototype.unmount=function(){function e(){this.panel&&$(this.panel).remove()}this._initializingPromise?this._initializingPromise.then(()=>e.call(this)):e.call(this)},T.isMaximized=()=>gContainer.getProperty("GFilesPanel.maximized"),T.isFilesGridListStyle=()=>gContainer.getProperty("GFilesPanel.isFilesListStyle"),T.prototype.getContextSource=function(){return{toggleLoading:e=>this.view.toggleLoading(e),update:()=>this.updateFilesList(),close:()=>{this.view.toggleLoading(!0),this._onCloseCallback()}}},T.prototype.initLayout=async function(e){this.drive=l.GCloudDrive.getInstance(),this.drive.setQueryLimit(20),this.view=new r.GFilesPanelViewNative(this.panel,this),this.accountSettingsKey="".concat(T.DriveAccountsSettingName,".").concat(this.USER.id);var t=this;let n=await gContainer.getProperty(T.DriveAccountsActiveSettingsName);return async function(n){let i,o=!0;await t.updateCloudSettings(),e?(o=!1,i=G):(n&&(i=t.getCloudSettingsById(n)),i||(i=G));try{await t.setCloudDrive(i,o)}catch(e){await t.setCloudDrive(G)}await T.isFilesGridListStyle()&&t.toListView(),await T.isMaximized()&&t._maximizeWindow(!0),window.addEventListener("resize",t._minimizeWindow.bind(t))}(n&&n.activeSettingsId)},T.prototype.updateCloudAccountName=function(e,t){var n=this;return gContainer.getProperty(n.accountSettingsKey).then((async function(i){let o,r=i?n._stringToSettings(i):[];r instanceof Array||(r=[]);for(let t=0,n=r.length;t<n;t++)if(r[t].id===e){o=t;break}o>-1&&(r[o].name=t),gContainer.setProperty(n.accountSettingsKey,n._settingsToString(r)),await n.updateCloudSettings(),e===n.getCurrentDriveId()&&n.view.updateTopBar()})).catch(e=>Promise.reject(e))},T.prototype.saveNewCloudAccount=function(e){var t=this;return gContainer.getProperty(t.accountSettingsKey).then((function(n){let i=n?t._stringToSettings(n):[];return i instanceof Array||(i=[]),e.id=(new Date).getTime(),e.deletable=!0,i.push(e),gContainer.setProperty(t.accountSettingsKey,t._settingsToString(i)),t.updateCloudSettings()})).catch(e=>Promise.reject(e))},T.prototype.deleteCloudDrive=function(e){var t=this;return gContainer.getProperty(t.accountSettingsKey).then((async function(n){let i,o=n?t._stringToSettings(n):[];o instanceof Array||(o=[]);for(let t=0,n=o.length;t<n;t++)if(o[t].id===e.id){i=t;break}i>-1&&o.splice(i,1),o.length>0?gContainer.setProperty(t.accountSettingsKey,t._settingsToString(o)):gContainer.removeProperty(t.accountSettingsKey);try{if("googledrive"===e.type){var r=new l.GGoogleDrive;await r.install(),await r.uninstall()}gDesigner.removeExternalRecentFiles(e.type,e.id)}catch(e){console.log(e)}return t.updateCloudSettings()})).catch(e=>Promise.reject(e))},T.prototype.handleNewFolder=function(e){var t=this;let n=!1;gDesigner.stats("filespanel_create_cloudfolder"),this.view.toggleLoading(!0);let i=0;const r=a=>{if(i++,i>b.MAX_FOLDER_DEPTH_FOR_CLOUD)return n=!1,t.view.toggleLoading(!1),void y.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-creating-folder")));let s={};t.drive.hasTitleValidation()&&(s=t.drive.getTitleValidator()),new u.default((async function(i){if(i=i.trim(),t.view.toggleLoading(!0),t.drive.supportsSaveCollisionFlow()){if(await t.drive.folderExists(i,t.drive.getCurrentFolder())&&!await(l=i,new Promise(e=>{y.default.confirm(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.folder-already-exists-on-current-location")).replace("%foldername",'"'.concat(l,'"')),t=>e(!!t),null,null,!0,!0,!0)})))return r(i);if(t.drive.requiresOverwriteCollisionHandling()){for(var a=0,s=i;await t.drive.folderExists(s,t.drive.getCurrentFolder());)s="".concat(i," (").concat(++a,")");i=s}}var l;n=!0,t.drive.createFolder(i).then(()=>{t.view.toggleLoading(!1),e?e():t.updateFilesList()}).catch(e=>{if(t.view.toggleLoading(!1),e&&e.badName)return y.default.alert(e.message),setTimeout(()=>{r(i)});n=!1,console.error(e),y.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-creating-folder")))})}),(function(){n||t.view.toggleLoading(!1)}),"primary",a,s).open()};return r(),this},T.prototype.handleMaximizePanel=function(){return this._maximizeWindow(),gDesigner.stats("filespanel_maximize_cloudfile"),this},T.prototype.handleMinimizePanel=function(){return this._minimizeWindow(),gDesigner.stats("filespanel_minimize_cloudfile"),this},T.prototype.handleClosePanel=function(){return this.panel.closest(".g-dialog-container").mousedown(),this._removeEventListeners(),gDesigner.stats("filespanel_close_cloudfile"),this},T.prototype.handleDelete=function(){this.logStatsForCurrentFilesSelection("filespanel_delete_cloud","filespanel_delete_cloud-multiple");var e=this;return y.default.confirm(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.delete-confirm")),function(t){t&&e.deleteSelection()}.bind(this),null,o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.delete-button")),!1,!0,!0),this},T.prototype.handleCancelSave=function(){return gDesigner.stats("filespanel_cancelsave_cloud"),this._onCancelSaveCallback(),this},T.prototype.handleSave=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t||(t=this.getDefaultExtensionForSave());const i=e=>new Promise(t=>{y.default.confirm(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.file-already-exists-on-current-location")).replace("%filename",'"'.concat(e,'"')),e=>t(!!e),null,null,!1,!0,!0)});if(this.view.toggleLoading(!0),gDesigner.stats("filespanel_save_cloudfile",t),(e=(0,a.removeAllSuffixWhichLikeExtension)(e,t)).trim()){try{if(this.drive.supportsSaveCollisionFlow()){if(await this.drive.fileExists(e,t,this.drive.getCurrentFolder())&&!await i(e))return this.view.toggleLoading(!1),void this.view.focusFileNameInput({name:e});if(this.drive.requiresOverwriteCollisionHandling()){for(var r=0,s=e;await this.drive.fileExists(s,t,this.drive.getCurrentFolder());)s="".concat(e," (").concat(++r,")");e=s}}await this._triggerNewFileSave(e,t,n)}catch(e){if(e&&e.badName)return this.view.toggleLoading(!1),void y.default.alert(e.message);this.getDocumentToSave()&&gDesigner.trigger(new E(E.Type.SynchronismUpdateFailed,this.getDocumentToSave()));let t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-saving-file"));e&&e.message&&e.dontExtend?t=e.message:e&&e.message?t="".concat(t,"<br />").concat(e.message):e&&(t="".concat(t,"<br />").concat(e)),y.default.alert(t),console.error(e)}this._onCloseCallback(!0)}else y.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.please-inform-valid-file-name")),()=>{this.view.toggleLoading(!1),this.view.focusFileNameInput({name:o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.untitled"))})});return this},T.prototype._setFileNameInputValue=function(e){this.view.setFileNameInputValue(e)},T.prototype._triggerNewFileSave=async function(e,t,n){await this.drive.saveNewFile(this.getDocumentToSave(),e,t,n,this.readyStateChange)},T.prototype._triggerFileOpen=async function(e){await this.drive.openFile(e)},T.prototype._triggerFileDeleted=async function(e){},T.prototype._triggerFileRenamed=async function(e){},T.prototype.setKeyListener=function(e){return this._handleKeyPress&&document.removeEventListener("keypress",this._handleKeyPress),this._handleKeyPress=t=>{var n=t.which||t.keyCode;e(n,t)},document.addEventListener("keypress",this._handleKeyPress),this},T.prototype.getDefaultSaveFormat=function(){return this.drive.getDefaultFileFormat()},T.prototype.handleBack=function(){if(gDesigner.stats("filespanel_go-to-parent_cloudfolder"),this.drive.getCurrentFolder()){this.view.toggleLoading(!0),this.drive.navigateToParentFolder();var e=this.drive.getCurrentFolder();this.view.manageOpenFolder(null,e),this.view.resetSelection()}return this.updateFilesList(!0,!1),this},T.prototype.navigateToRoot=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return gDesigner.stats("filespanel_go-to-root_cloudfolder"),this.drive.isRootFolder()||(this.view.toggleLoading(!0),this.drive.setCurrentFolder(this.drive.getRootFolder()),this.navigateToFolder(this.drive.getRootFolder(),e),this.view.manageOpenFolder(null,this.drive.getRootFolder()),this.view.resetSelection()),this},T.prototype.handleSaveAs=function(e,t,n){gDesigner.stats("filespanel_download_file",e),this._onCancelSaveCallback(),gDesigner.executeAction("".concat(m.default.ID,".").concat(e.toLowerCase()),[null,null,null,t,n],void 0,!0)},T.prototype.handleDownload=function(){return gDesigner.stats("filespanel_download_multiple-files"),this.downloadSelectedFiles(c.DEFAULT_TYPE),this},T.prototype.handleFileDblClick=function(e){return e.hasPermission(C.Permission.Open)&&!this.isSaveMode()?(gDesigner.stats("filespanel_open_cloudfile"),this.openFile(e)):e.hasPermission(C.Permission.Rename)&&(gDesigner.stats("filespanel_focus_filename-input"),this.view.focusFileNameInput(e)),this},T.prototype.handleFileClick=function(e,t){return gDesigner.stats("filespanel_select_cloudfile"),this.view.manageSelection(t,e),this},T.prototype.handleParentClose=function(){return this._removeEventListeners(),this.view&&this.view.handleParentClose(),this},T.prototype.openFile=async function(e){e.example&&gDesigner.stats("filespanel_open_examplefile",e.name);if(await this.drive.canAccessFile(e).catch(t=>(console.log("Failed to check user permission",e,t),!1)))try{this._triggerFileOpen(e),this._onCloseCallback()}catch(e){console.log(e.stack),y.default.alert(e.message),this.updateFilesList()}else y.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.file-can-not-be-accessed-missing-permissions")))},T.prototype.handleFolderClick=function(e,t){return gDesigner.stats("filespanel_open_cloudfolder"),this.view.resetSelection(),this.navigateToFolder(e),this.view.manageOpenFolder(t,e),this},T.prototype.manageSelection=function(e,t){return gDesigner.stats("filespanel_select_cloudfolder"),this.view.manageSelection(t,e),this},T.prototype.renameItem=async function(e,t){return this.drive.renameItem(e,t)},T.prototype._removeEventListeners=function(){document.removeEventListener("keypress",this._handleKeyPress),window.removeEventListener("resize",this._minimizeWindow.bind(this))},T.prototype._getFullPathNames=function(e){var t=this.drive.getFolders(),n=[e.name];let i,o;if(!t)return n;for(;e.parent&&(o=t[e.parent],o)&&(i=o.folder,i.name);)n.unshift(i.name),e=i;return n},T.prototype.addFile=function(e,t,n,i){this.view.addFile(this.updateCloudItemForUserPermission(e),t,n,i)},T.prototype._convertBlob=function(e,t,n){return Promise.resolve(e)},T.prototype.downloadFile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(i){if(!(t=this.drive.getFileFormat(e)))return u(Promise.reject(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.file-not-supported"))))}else t||(t=this.drive.getFileFormat(e)||c.DEFAULT_TYPE);var{ext:r,type:a,mime:s,version:l}=t;a=a||s;const d=this._triggerFileDownload(e,n,r,a,l);function u(t){return{promise:t,file:e,cancel:()=>n.cancel&&n.cancel()}}return u(d)},T.prototype._triggerFileDownload=function(e,t,n,i,o){const r=new AbortController,l=r.signal;return t.progress=t.progress||(()=>{}),this.drive.getRawFile(e,l,t).then(async l=>{let d,u=l;if(t.cancel=(0,a.chaining)(t.cancel,()=>r.abort()),e.type!==i?(u=await this._convertBlob(u,{ext:n,type:i,version:o},t).catch(e=>d=e||!0),u||(d=new Error("Unsupported mime type: #".concat(e.type)))):i===c.DEFAULT_TYPE.type&&(u=await this._repackNativeBlob(u,t).catch(e=>d=e||!0),u||d||(d=new Error("Error fetching file contents for download"))),d){if(d instanceof Error)throw d;throw new Error("Error fetching file contents for download")}{t.done&&t.done();let o=e.name||l.name;o.endsWith(".".concat(n))&&(o=o.replace(new RegExp(".".concat(n,"$")),"")),(0,s.downloadDataURI)(u,o,n,{type:i})}}).catch(e=>{if(t.failed&&t.failed(),e){if(console.error(e),e instanceof Error)throw e;throw new Error("Error fetching file contents for download")}})},T.prototype._repackNativeBlob=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(async(n,i)=>{const r=new FileReader;r.onload=async function(){const e=new Uint8Array(this.result),r=o.GNode.deserialize(g.default.unzipData(e),gDesigner.getWorkspace());var s={cancelled:!1};t.cancel=(0,a.chaining)(t.cancel,()=>s.cancelled=!0),await(0,a.resolveDocumentImages)(r,T.IMAGES_WAIT_TIMEOUT,s).catch(()=>{s.cancelled?i():i(new Error(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.file-no-images-cannot-be-processed"))))});var l=o.GNode.serialize(r,{save:!0});(null===l||""===l||l.length<1||s.cancelled)&&i();var c=new Uint8Array(pako.gzip(l,{level:9}).buffer);c.byteLength>20?n(c):i()},r.onerror=i,r.readAsArrayBuffer(e)})},T.prototype.downloadSelectedFiles=async function(){let{ext:e,type:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.DEFAULT_TYPE,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this.SELECTION.length<1)return;const o=await Promise.all(this.SELECTION.map(async e=>this.drive.isFileSupported(e)&&await this.drive.canAccessFile(e).catch(e=>(console.error("drive.canAccessFile error",e),!1)))),r=this.SELECTION.filter((e,t)=>!!o[t]);await this._triggerSelectedFilesDownload(r,e,t,n,i)},T.prototype._triggerSelectedFilesDownload=async function(e,t,n,i,r){const a=e.map(()=>0),s=e.length,l=100/s,c={};let d=gDesigner.getActiveDocument();d||(d=gDesigner.newInfiniteDocument()),d.updateStatus(p.default.Downloading,c),c.text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.downloading-files")),!0),c.progressInfo("0/".concat(s));let u=0,g=!1;const h=()=>c.progressInfo("".concat(++u,"/").concat(s)),f=()=>c.progressInfo("".concat(++u,"/").concat(s)),m=()=>g=!0,v=e.map((e,o)=>{var s=i;!s&&this.fileRequiresSourceDownload(e)&&(s=!0);var d={ext:(s&&(e.extension||e.ext)||t).toLowerCase(),type:s&&(e instanceof C&&e.getMimeType()||e.type)||n,version:r};return this.downloadFile(e,d,{progress(e){a[o]=e;const t=a.reduce((e,t)=>e+Math.min(t/100,1)*l,0);c.progress(t)},done:h,failed:f,cancel:m},i)});v.length&&(this._onCancelSaveCallback(),gDesigner.closeNewDocumentDialog()),d.initCancelHandler(()=>{try{v.forEach(e=>e.cancel())}finally{d.updateStatus(p.default.DownloadCancelled)}});const _=await Promise.all(v.map(e=>{let{file:t,promise:n}=e;return n.catch(e=>Object.create({file:t,status:"rejected",error:e}))}));if(g)return void d.updateStatus(p.default.DownloadCancelled);const b=_.filter(e=>e&&"rejected"===e.status);b.length?(d.updateStatus(p.default.DownloadFailed),y.default.alert($("<div/>").addClass("error-download-multiple-files").append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-download-multiple-files")))).append($("<ul/>").append(b.map(e=>{let{file:t,error:{message:n=""}={}}=e;return $("<li/>").html("".concat(t.name).concat(n?": "+n:""))}))))):d.updateStatus(p.default.Downloaded)},T.prototype.navigateToFolder=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.getAvailableFileTypesFilter();this._navigateDriveToUserFolderOrRoot(e);const i=this.getAvailableFileTypesFilter();this._clearFileFiltersInCaseAvailableFiltersDoesNotMatch(n,i),t&&this.updateFilesList(!0,!1);var o=this.SELECTION.indexOf(e);o>-1&&this.SELECTION.splice(o,1);var r=this.TEMP_SELECTION.indexOf(e);r>-1&&this.TEMP_SELECTION.splice(r,1),this.SELECTION.length<1&&this.view.resetSelection()},T.prototype._clearFileFiltersInCaseAvailableFiltersDoesNotMatch=function(e,t){o.GUtil.equals(e,t,!0)||this.clearAllFileTypesFromSelectedFilter()},T.prototype._navigateDriveToUserFolderOrRoot=function(e){this._isUserAllowedToOpenTheFolder(e)||(e=this.drive.getRootFolder()),this.drive.setCurrentFolder(e)},T.prototype._isUserAllowedToOpenTheFolder=function(e){return!0},T.prototype.addFolder=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.view.addFolder(this.updateCloudItemForUserPermission(e),t)},T.prototype.addCustomFolder=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.view.addCustomFolder(this.updateCloudItemForUserPermission(e),t)},T.prototype.getSort=function(){let e=this.getCurrentAscend()?"":"-";return e+=this.getCurrentSortType(),e},T.prototype.hasMoreItemsToLoad=function(){return-1!==this.CURRENT_FILE_LOAD||this.drive.hasMoreItemsToLoad()},T.prototype._sortFilesByMimeType=function(e){if(0===this.drive.getSelectedFilterForFileTypes().length)return e;return function(e){let t={};e.forEach(e=>{let n=e.getMimeType();t[n]=t[n]||[],t[n].push(e)});let n=[];return Object.values(t).forEach(e=>{n=n.concat(e)}),n}(e)},T.prototype._displayRecentFiles=async function(){let e;if(this.isRootFolder()&&!this._showExampleFiles)try{e=await this.drive.fetchRecentFiles(),e=this._sortFilesByMimeType(e),e&&(this.view.toggleRecentFiles(!!e&&e.length>0),e.forEach(e=>{this.drive.isItemAllowedToBeRendered(e,!0)&&this.addFile(e,!0),this.drive.itemRequiresLazyUpdate(e).then(t=>{t&&this.drive.getItemLazyUpdate(e).then(e=>{this.addFile(e,!0,!1,!0)})})}))}catch(e){throw new Error(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-fetching-files")))}finally{this._showRecentFiles=!!e&&e.length>0}else this._showRecentFiles=!1},T.prototype.buildDepth=async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!gDesigner.getApplicationManager().isOpenFromCloudEnabled())return this.view.toggleLoading(!1),Promise.reject();var n=this;if(this.BUILD_IN_PROGRESS)return Promise.reject(new w.default);async function i(e){let r=!0;try{var a,s=[];let i=n.getSort();var l=n.view.getSearchValue();if(l){if(n.hasMoreItemsToLoad()){try{s=await n.drive.fetchFiles(l,n.CURRENT_FILE_LOAD,i)}catch(e){throw new Error(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-fetching-files")))}a=(s=n._sortFilesByMimeType(s)).length,n._updateCurrentFileLoad(a)}s.forEach(e=>{e._rootPath="/ ".concat(n._getFullPathNames(e).join(" / ")),n.addFile(e),n.drive.itemRequiresLazyUpdate(e).then(t=>{t&&n.drive.getItemLazyUpdate(e).then(e=>{n.addFile(e,!1,!1,!0)})})}),e&&n._buildFolder(t)}else{if(n.hasMoreItemsToLoad()&&!n._showExampleFiles){try{await n.drive.getPreviousSelectedFolder()||(r=!1),a=(s=await n.drive.fetchFiles(null,n.CURRENT_FILE_LOAD,i)).length,n.isSaveMode()||n._isDashboard||(s=s.concat(await n.drive.loadExampleFiles())),s=n._sortFilesByMimeType(s)}catch(e){if(console.error(e),!(e instanceof h.default.CloudException&&e.code===h.default.ExceptionCode.InvalidCredentials)){const t=e&&e.message?e.message:o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-fetching-files"));throw new v.default(t)}await n.setCloudDrive(G),a=(s=await n.drive.fetchFiles(null,n.CURRENT_FILE_LOAD,i)).length,n.isSaveMode()||n._isDashboard||(s=s.concat(await n.drive.loadExampleFiles())),s=n._sortFilesByMimeType(s)}n._updateCurrentFileLoad(a)}if(await n._displayRecentFiles(),e&&(n._showEmptyPanel=!n._showExampleFiles&&!!n.drive.getDefaultEmptyMessage()&&n.isRootFolder()&&!n._showRecentFiles&&0===a&&!(await n.drive.hasFolders()&&!n.isRootFolder()),n._showExampleFiles&&(s=await n.drive.loadExampleFiles()),0===s.length&&(n._showEmptyPanel=!1),n._buildFolder(t)),n.view.removeExampleFiles(),s.forEach(e=>{(n.drive.isItemAllowedToBeRendered(e)||n._showExampleFiles)&&n.addFile(e,!1,n._showExampleFiles||n._showEmptyPanel),n.drive.itemRequiresLazyUpdate(e).then(t=>{t&&n.drive.getItemLazyUpdate(e).then(e=>{n.addFile(e,!1,n._showExampleFiles,!0)})})}),n.view.toggleRecentFiles(n._showRecentFiles),n.view.toggleExampleFiles(n._showExampleFiles),1===n.SELECTION.length&&e)n.view.scrollToSelectedElement(n.SELECTION[0])||n.view.resetSelection()}n.view.updateControls(e)}catch(e){return console.error(e),y.default.alert("".concat(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")),":<br />").concat(e&&e.message||e||"")),n.view.toggleLoading(!1),Promise.reject()}return n.view.toggleLoading(!1),n.view.shouldFilesBeRequested()&&n.hasMoreItemsToLoad()&&await i(!1),Promise.resolve(r)}if(this.view.toggleLoading(!0),this.hasMoreItemsToLoad()){this.BUILD_IN_PROGRESS=!0;try{const o=await i(e);if(n.view.toggleFolders(n._hasFolders&&!n._showExampleFiles),t&&o){var r=await n.drive.getPreviousSelectedFolder();r&&!n.drive.isRootFolder(r)&&await n.view.navigateToFolder(r).catch(()=>n.view.navigateToFolder(n.drive.getRootFolder()))}}finally{this.BUILD_IN_PROGRESS=!1}}this.view.toggleLoading(!1)},T.prototype._buildFolder=function(e){if(!e)return;if(this._showExampleFiles)return;this.addFolder(this.drive.getRootFolder(),null);const t=[this.drive.getRootFolder()];if(!this.isSaveMode()){const e=this._getSharedWithMeFolder();e&&this.addCustomFolder(e,null)}this._hasFolders=!!t&&t.length>0},T.prototype._getSharedWithMeFolder=function(){return null},T.prototype._updateCurrentFileLoad=function(e){let t;t=e>0?e<this.getQueryLimit()?-1:this.CURRENT_FILE_LOAD+e:-1,this.CURRENT_FILE_LOAD=t},T.prototype.getCloudSettingsById=function(e){return this.CLOUD_SETTINGS.find(t=>{let{id:n}=t;return n===e})},T.prototype.updateCloudItemForUserPermission=function(e){return gDesigner.getApplicationManager().isOnlyFileOpenFromCloudEnabled()&&e&&e instanceof C?(e.setPermissions(Object.values(C.Permission),!1),e.setPermission(C.Permission.Open),e):e},T.prototype.getDefaultCloudSettings=function(){return this.CLOUD_SETTINGS.find(e=>!!e.default)},T.prototype.getCloudSettings=function(){return this.CLOUD_SETTINGS},T.prototype.getCurrentDriveId=function(){return this._currentDriveId},T.prototype.getCurrentDriveSettings=function(){return this.getCloudSettingsById(this.getCurrentDriveId())},T.prototype.setCloudDrive=async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)throw new Error(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-incorrect-cloud-drive-settings")));this.view&&this.view.toggleLoading(!0);const n=A.find(t=>t.type===e.type);if(n.pro&&!gDesigner.isEnabledProFeatures())return void gDesigner.handlePROFeatureInterruption();const i=this.drive,a=this.view;try{switch(e.type){case"googledrive":this.drive=new l.GGoogleDrive(void 0,e.id),await this.drive.install(),await this.drive.signIn(),this.view=new r.GFilesPanelViewNative(this.panel,this),this.view.setPermission(r.GFilesPanelViewBase.Permission.CreateFolder,!1);break;default:this.drive=l.GCloudDrive.getInstance(),this.view=new r.GFilesPanelViewNative(this.panel,this)}this._currentDriveId=e.id;const n={activeSettingsId:e.id};if(t&&gContainer.setProperty(T.DriveAccountsActiveSettingsName,n),this.drive.setQueryLimit(this.getQueryLimit()),this.drive.setDriveSettings(this._driveSettings),this.view.relayout(),this.updateFilesList(),this.drive.hasUserProfile()){var s=await this.drive.getUser();s&&this.view.updateUserDetails(s)}i&&i.removeEventListener(h.default.DriveEvent,this._handleDriveEvent,this),this.drive.addEventListener(h.default.DriveEvent,this._handleDriveEvent,this)}catch(e){var c;throw e&&e instanceof v.default&&(c=e),i&&(this.drive.removeEventListener(h.default.DriveEvent,this._handleDriveEvent,this),this.drive=i,this.drive.removeEventListener(h.default.DriveEvent,this._handleDriveEvent,this),this.drive.addEventListener(h.default.DriveEvent,this._handleDriveEvent,this)),this.view=a,this.view&&this.view.toggleLoading(!1),c||Error(e.message||o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))}},T.prototype._handleDriveEvent=async function(e){if(e.type===h.default.DriveEvent.Type.UserUpdated){if(this.drive.hasUserProfile()){var t=await this.drive.getUser();t&&this.view.updateUserDetails(t)}}else if(e.type===h.default.DriveEvent.Type.FolderSwitchRequired){const{folder:t}=e.data;this.drive.isRootFolder(t)?(this.isRootFolder()||this.navigateToRoot(!1),this.updateFilesList(!0,!0)):(this.drive.setCurrentFolder(t),this.updateFilesList(!0,!0),this.view.navigateToFolder(t))}},T.prototype.getCreateCloudAccountOptions=async function(){await this.updateCloudSettings();return this.getCloudSettings().some(e=>"googledrive"===e.type)?S.filter(e=>"googledrive"!==e.type):S},T.prototype.updateCloudSettings=function(){var e=this;return gContainer.getProperty(e.accountSettingsKey).then((function(t){let n=t?e._stringToSettings(t):[];return n instanceof Array||(n=[]),n=n.filter(e=>{var t=A.find(t=>e.type===t.type);return t.pro&&gDesigner.isEnabledProFeatures()||!t.pro}),e.CLOUD_SETTINGS=n.concat([G]),!0}))},T.prototype.getDefaultExtensionForSave=function(){return this.drive.getDefaultFileFormat().ext.toUpperCase()},T.prototype.updateFilesList=async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Math.random();this.CURRENT_UPDATE_OPERATION_ID=n;const i=this.view.getSearchValue();if(await this._waitForBuildToFinish(),n===this.CURRENT_UPDATE_OPERATION_ID&&i===this.view.getSearchValue()){e&&t?this.view.clearFilesAndFolders():this.view.clearFiles(),this.CURRENT_FILE_LOAD=0,this.view.toggleEmptyPanel(!1);try{await this.buildDepth(e,t)}catch(e){return void console.warn(e)}this.view.toggleEmptyPanel(this._showEmptyPanel),this.view.toggleExampleFiles(this._showExampleFiles||this._showEmptyPanel),this.view.toggleRecentFiles(this._showRecentFiles),e&&this.view.updateLayout()}else e&&this.view.updateLayout()},T.prototype._waitForBuildToFinish=async function(){for(;this.BUILD_IN_PROGRESS;)await(0,a.sleep)(200)},T.prototype.search=function(){this.updateFilesList(!1,!1)},T.prototype.addToSelection=function(e){0===this.SELECTION.length&&this.TEMP_SELECTION.length>0&&(this._newClipBoard=!0),this.SELECTION.indexOf(e)<0&&this.SELECTION.push(e)},T.prototype.selectionHasFiles=function(){for(var e=0,t=this.SELECTION.length;e<t;e++)if(this.drive.isFileSupported(this.SELECTION[e]))return!0;return!1},T.prototype.removeFromSelection=function(e){var t=this.SELECTION.indexOf(e);t>-1&&this.SELECTION.splice(t,1),0===this.SELECTION.length&&this._newClipBoard&&(this._newClipBoard=!1)},T.prototype.resetSelection=function(){this.SELECTION=[],this._newClipBoard=!1},T.prototype._resetViewSelection=function(){this.view.resetSelection()},T.prototype.isMultiSelectionEnabled=function(){return!0},T.prototype._addToClipboard=function(){this._newClipBoard&&(this.resetClipboard(d.GFilesPanelClipboardModes.COPY),this.resetClipboard(d.GFilesPanelClipboardModes.CUT),this._newClipBoard=!1),this.TEMP_SELECTION=this.TEMP_SELECTION.concat(this.SELECTION),this.view.addToClipboard(this.MODE)},T.prototype.resetClipboard=function(e){this.TEMP_SELECTION=[],this._newClipBoard=!1,this.view.resetClipboard(e||this.MODE)},T.prototype.performCopyPaste=function(e){var t=this;this.isClipboardModeCopy(e)?(gDesigner.stats("filespanel_paste-from-copy_cloud"),this.view.toggleLoading(!0),this.SELECTION[0]&&this.drive.setCurrentFolder(this.SELECTION[0]),this.drive.copyPaste(this.TEMP_SELECTION).then(()=>{const e=this.MODE;this.MODE=d.GFilesPanelClipboardModes.DEFAULT,t.view.resetSelection(),t.resetClipboard(e),t.updateFilesList()}).catch(e=>{let t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-moving"));e&&e.cloud&&e.message&&e.message.trim()&&(t=e.message),y.default.alert(t),this.view.toggleLoading(!1),console.error(e)})):(this.logStatsForCurrentFilesSelection("filespanel_copy_cloud","filespanel_copy_cloud-multiple"),this.MODE=d.GFilesPanelClipboardModes.COPY,this._addToClipboard())},T.prototype.performCutPaste=function(e){var t=this;this.isClipboardModeCut(e)?(gDesigner.stats("filespanel_paste-from-cut_cloud"),this.view.toggleLoading(!0),this.SELECTION[0]&&this.drive.setCurrentFolder(this.SELECTION[0]),this.drive.cutPaste(this.TEMP_SELECTION).then(()=>{const e=this.MODE;this.MODE=d.GFilesPanelClipboardModes.DEFAULT,t.view.resetSelection(),t.resetClipboard(e),t.updateFilesList()}).catch(e=>{let t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-moving"));e&&e.cloud&&e.message&&e.message.trim()&&(t=e.message),y.default.alert(t),this.view.toggleLoading(!1),console.error(e)})):(this.logStatsForCurrentFilesSelection("filespanel_cut_cloud","filespanel_cut_cloud-multiple"),this.MODE=d.GFilesPanelClipboardModes.CUT,this._addToClipboard())},T.prototype.performFileMove=function(e,t){this.view.toggleLoading(!0),gDesigner.stats("filespanel_move"),this.drive.fileMove(e,t).then(()=>{this.view.toggleLoading(!1),this.view.resetSelection(),this.updateFilesList()}).catch(e=>{let t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-moving"));e&&e.cloud&&e.message&&e.message.trim()&&(t=e.message),y.default.alert(t),this.view.toggleLoading(!1),console.error(e)})},T.prototype.deleteSelection=function(){var e=this;return this.view.toggleLoading(!0),async function(){try{for(var t=0;t<e.SELECTION.length;++t){var n=e.SELECTION[t];await e.drive.deleteItem(n),gDesigner.hasEventListeners(h.default.DriveEvent)&&gDesigner.trigger(new h.default.DriveEvent(null,h.default.DriveEvent.Type.FileDeleted,n))}}catch(t){return y.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-deleting"))),e.view.toggleLoading(!1),void console.error(t)}if(e.SELECTION[0].getType&&e.SELECTION[0].getType()===C.Type.Folder){let t=null;if(e.SELECTION[0].getParentId()&&e.panel.find(".g-gravit-folder").each((n,i)=>{const o=$(i).data("node");o.id===e.SELECTION[0].getParentId()&&(t=o)}),!t){let n=$(e.panel.find(".g-gravit-folder")[0]);t=n&&n.data("node")}t&&e.drive.setCurrentFolder(t)}e._triggerFileDeleted(e.SELECTION),e.view.toggleLoading(!1),e.view.resetSelection(),e.updateFilesList()}()},T.prototype.sort=function(){this.updateFilesList()},T.prototype._minimizeWindow=function(){this.view.minimizeWindow(),gContainer&&gContainer.setProperty("GFilesPanel.maximized",!1),this.view.updateLayout()},T.prototype._maximizeWindow=function(e){this.view.maximizeWindow(),gContainer&&gContainer.setProperty("GFilesPanel.maximized",!0),this.hasMoreItemsToLoad()&&this.view.shouldFilesBeRequested()?this.buildDepth(e,!1).catch(e=>{}):this.view.updateLayout()},T.prototype.toCardView=function(){this.view.toCardView(),gContainer&&gContainer.setProperty("GFilesPanel.isFilesListStyle",!1)},T.prototype.toListView=function(){this.view.toListView(),gContainer&&gContainer.setProperty("GFilesPanel.isFilesListStyle",!0)},T.prototype.getCurrentFolder=function(){return this.drive.getCurrentFolder()},T.prototype.isRootFolder=function(){return this.drive.isRootFolder()},T.prototype.getFolders=function(){return this.drive.getFolders()},T.prototype.isItemSelected=function(e){if(this.SELECTION.length<1)return!1;for(let t=0,n=this.SELECTION.length;t<n;++t){if(this.SELECTION[t].id===e.id)return!0}return!1},T.prototype.isItemInClipboard=function(e){if(this.TEMP_SELECTION.length<1)return!1;for(let t=0,n=this.TEMP_SELECTION.length;t<n;++t){if(this.TEMP_SELECTION[t].id===e.id)return!0}return!1},T.prototype.isSaveMode=function(){return this._isSaveMode},T.prototype.getSelection=function(){return this.SELECTION},T.prototype.getTempSelection=function(){return this.TEMP_SELECTION},T.prototype.getDocumentToSave=function(){return this._documentToSave},T.prototype.getSortType=function(){return this.drive.getSortType()},T.prototype.setSortType=function(e){return this.drive.setSortType(e),this},T.prototype.getSelectedFilterForFileTypes=function(){return this.drive.getSelectedFilterForFileTypes()},T.prototype.addFileTypeToSelectedFilter=function(e){const t=this.drive.getAvailableFileTypesFilter().find(t=>t.type===e);gDesigner.stats("filespanel_format-filter_on",t.id),this.drive.addFileTypeToSelectedFilter(e)},T.prototype.clearAllFileTypesFromSelectedFilter=function(){gDesigner.stats("filespanel_format-filter_clear"),this.view.clearFileTypeFilterState(),this.drive.clearAllFileTypesFromSelectedFilter()},T.prototype.deleteFileTypeFromSelectedFilter=function(e){const t=this.drive.getAvailableFileTypesFilter().find(t=>t.type===e);gDesigner.stats("filespanel_format-filter_off",t.id),this.drive.deleteFileTypeFromSelectedFilter(e)},T.prototype.getAvailableFileTypesFilter=function(){return this.drive.getAvailableFileTypesFilter()},T.prototype.getSortDirection=function(){return this.drive.getSortDirection()},T.prototype.setSortDirection=function(e){return this.drive.setSortDirection(e),this},T.prototype.getClipboardMode=function(){return this.MODE},T.prototype.isClipboardModeCopy=function(e){return e?e===d.GFilesPanelClipboardModes.COPY:this.MODE===d.GFilesPanelClipboardModes.COPY},T.prototype.isClipboardModeCut=function(e){return e?e===d.GFilesPanelClipboardModes.CUT:this.MODE===d.GFilesPanelClipboardModes.CUT},T.prototype.setDefaultClipboardMode=function(){return this.MODE=d.GFilesPanelClipboardModes.DEFAULT,this},T.prototype.getUser=function(){return this.USER},T.prototype.getDefaultFilename=function(){return this.DEFAULT_FILENAME},T.prototype.getPossibleExtensions=function(){return this.drive.getSupportedExtensions().map(e=>e.toUpperCase())},T.prototype.getAvailableExtensions=function(){for(var e=!1,t=null,n=0;n<this.SELECTION.length&&!e;++n){var i=this.SELECTION[n],o=this.drive.getSupportedFileFormats().find(e=>i.type===e.type);o&&o.secondary&&(t?e=t.type!==o.type:t=o)}return t?e?[c.DEFAULT_TYPE.ext.toUpperCase()]:[c.DEFAULT_TYPE.ext.toUpperCase(),t.ext.toUpperCase()]:this.SELECTION.length?c.FILE_EXTENSIONS:[]},T.prototype.fileRequiresSourceDownload=function(e){return!this.drive.getSupportedFileFormats().some(t=>{var n=e instanceof C?e.getMimeType():e.type;const i=e.extension||e.ext||null;return t.type===n||i&&t.ext.toLowerCase()===i.toLowerCase()})},T.prototype.getUISettings=function(){return this._GUISettings},T.prototype._canDownload=function(){return!0},T.prototype._isContextMenuAvailableForFile=function(e){return!0},T.prototype.logStatsForCurrentFilesSelection=function(e,t,n){gDesigner.stats(1===this.getSelection().length?e:t,n)},T.prototype.getCurrentAscend=function(){return this.drive.getSortDirection()},T.prototype.getCurrentSortType=function(){return this.drive.getSortType()},T.prototype.getQueryLimit=()=>20,T.prototype.getSupportedVersions=function(){return[]},T.prototype.getFooterSaveDescriptionForFileExtension=function(e){return o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.info-".concat(e.toLowerCase())))},T.prototype.toString=function(){return"[Object GFilesPanel]"},T.prototype._stringToSettings=function(e){return JSON.parse((0,a.base64StringToString)(e))},T.prototype._settingsToString=function(e){return(0,a.stringToBase64String)(JSON.stringify(e))},T.prototype.manageOpenFolder=function(e,t,n){this.view.manageOpenFolder(e,t,n)},e.exports=T},function(e,t,n){"use strict";var i=n(17);n(9),n(19),n(24),n(28),n(537),n(58),n(14),n(29),n(297);var o=n(1),r=n(16),a=i(n(76)),s=n(766),l=i(n(715)),c=i(n(36)),d=n(32),u=i(n(175)),p=n(12),g=i(n(385)),h=n(472);const f=n(1419),m=n(1054),y=n(1420),v=n(1061);let _=null;const b=function e(t,n){this.panel=t,this.filesPanel=n,this._cloudFolders=[],this._permissions=[e.Permission.CreateFolder,e.Permission.RecentFilesShowMore],this._bindedHandleShortcut=this.handleShortcut.bind(this),gDesigner.getUser().then(e=>{this._user=e}),this._isLoadingFolders=!1,(gContainer.getRuntime()===a.default.Runtime.Electron&&o.GSystem.operatingSystem===o.GSystem.OperatingSystem.Windows||o.GSystem.operatingSystem===o.GSystem.OperatingSystem.Unix)&&this.panel.closest(".g-dialog-container").addClass("cross-controls")};b.prototype.filesPanel=null,b.prototype._cloudFolders=null,b.prototype._isLoadingFolders=!1,b.prototype._fileInfoPanel=null,b.prototype._rightSide=null,b.prototype._user=null,b.prototype._contextMenu=null,b.prototype._downloadContextMenu=null,b.prototype._fileInfoPanelIsOpen=!1,b.prototype._fileTypeFilterButton=null,b.prototype._sortButton=null,b.prototype._loadFoldersOnDemand=async function(){if(!this._isLoadingFolders){this._isLoadingFolders=!0;try{const e=this._cloudFolders.filter(e=>e.isStateOpen()&&!e.isDone()).map(e=>e.loadChildrenOnDemand((t,n,i)=>this.filesPanel.drive.fetchFolders(this.filesPanel.getSort(),t,n,i).then(t=>t.map(t=>this._factoryFolder(t,e)))));e.length&&await Promise.all(e)}finally{this._isLoadingFolders=!1}}},b.prototype._factoryFolder=function(e,t){var n=this;e=this.filesPanel.updateCloudItemForUserPermission(e);var i=this.filesPanel.isItemSelected(e),o=this.filesPanel.isItemInClipboard(e),a=!1,s=new f(e,t,this.filesPanel.drive.isRootFolder(e)).onClick((e,t)=>{r.GPlatform.modifiers.metaKey?this.filesPanel.manageSelection(e,t):this.filesPanel.drive.getCurrentFolder()!==e&&(this.filesPanel.handleFolderClick(e,t),"shared_files_with_me"===e.id?this.hideFileTypeFilterButton():this.displayFileTypeFilterButton()),n._closeFileInfoPanel()}).onDoubleClick(()=>{s.getChildren()&&s.getChildren().length?s.toggleState():u().then(()=>s.toggleState())}).onContext((function(e,t,i){gDesigner.stats("filespanel-view_context_cloudfolder"),n.resetSelection(),n._addToSelection(t),n._openContextMenuForEventPosition(i)})).onFileDrop((e,t)=>{this.filesPanel.performFileMove(e,t)}).setRefreshHandler(u).onFolderStateClick(()=>{u().then(()=>{if(s.toggleState(),!s.isRootFolder()&&!a&&s.isStateOpen()){var e=s.getChildren();e&&e.length&&(a=!0,e.forEach(e=>e.refresh()))}})});this._cloudFolders.push(s);const l=this.filesPanel.drive.isRootFolder(e),c=t&&this.filesPanel.drive.isRootFolder(t.getFolder());var d;function u(){return s.isLoading()||s.getChildren()&&s.getChildren().length?d||Promise.resolve():(s.setLoading(!0),d=n.filesPanel.drive.fetchFolders(n.filesPanel.getSort(),e).then(t=>{s.setLoading(!1),s.setChildren(t.map(e=>n._factoryFolder(e,s))),s.update();const i=n.filesPanel.drive.getCurrentFolder();if(i&&"id"in i&&i.id===e.id||i===e){n.manageOpenFolder(null,e,s);let t=s;do{t.isStateOpen()||t.toggleState()}while(t=t.getParent())}}).catch(e=>(console.log(e&&e.stack,e),n.toggleLoading(!1),s.setLoading(!1),Promise.reject(e))))}return(l||c||this.filesPanel.drive.containsInPreviousPath(e))&&(l&&this.filesPanel.drive.resetPreviousSelectedFolderPath(),this.filesPanel.drive.removeLoadedFolderFromPreviousPath(e),u()),l&&s.toggleState(),s.getHTMLElement().addClass(i?"selected":"").addClass(o?"cut":""),s},b.prototype.navigateToFolder=async function(e){try{const f=this.filesPanel.drive;this.toggleLoading(!0),e="string"==typeof e?await f.getFolder(e):e;var t=async(e,t)=>{this.filesPanel.navigateToFolder(e);for(var n=this._cloudFolders.find(t=>t.getFolder().id===e.id),i=0;!(n||(await(0,d.sleep)(100),n=this._cloudFolders.find(t=>t.getFolder().id===e.id),++i>30)););if(this.manageOpenFolder(null,e,n),n){var o=n.getHTMLContainer();0===o[0].offsetTop&&t&&(o=t.getHTMLContainer()),setTimeout(()=>{this.panel.find(".g-left-side").animate({scrollTop:$(o).position().top},150)})}};if(e.family===p.EXTERNAL_APP.ONEDRIVEBUSINESS&&(f.isRootFolder(e)||f.isRootFolder(e.parent))||f.isRootFolder(e.relativeUrl?e.relativeUrl:e.parent))t(e);else{for(var n,i=[e],o=e,r=!1;!n;)if(o=await f.getFolder(o.parent).catch(t=>(t.status===p.gApi.HTTP_STATUS_CODES.NOT_FOUND&&o.id===e.id&&(r=!0),null))){if(i.push(o),i.length>h.MAX_FOLDER_DEPTH_FOR_CLOUD)return Promise.reject(p.gApi.HTTP_STATUS_CODES.NOT_FOUND);f.isRootFolder(o.parent)&&(n=!0)}else{if(r)return Promise.reject(p.gApi.HTTP_STATUS_CODES.NOT_FOUND);n=!0}var a=i.reverse(),s=this._cloudFolders,l=null,c=null,u=null;for(l=c=a.shift();l;){u=s.find(e=>e.getFolder().id===l.id);for(var g=0;!(u||(await(0,d.sleep)(100),u=s.find(e=>e.getFolder().id===l.id),++g>300)););u?(await u.refresh(),s=u.getChildren(),u.toggleState(),(l=a.shift())?c=l:t(c,u)):l=null}}this.toggleLoading(!1)}catch(e){return this.toggleLoading(!1),e}},b.prototype.relayout=function(){this.initLayout(!0)},b.prototype.hasPermission=function(e){return this._permissions.includes(e)},b.prototype._handleDriveEvent=function(e){e.type===l.default.DriveEvent.Type.FileDeleted&&this._getFileInfoPanelFileId()===e.data.id&&this._closeFileInfoPanel()},b.prototype._getFileInfoPanelFileId=function(){return $(".g-file-detail-container").data("fileId")},b.prototype._registerDriveEvent=function(){gDesigner.addEventListener(l.default.DriveEvent,this._handleDriveEvent,this)},b.prototype.initLayout=function(e){window.addEventListener("keydown",this._bindedHandleShortcut,!0),this._registerDriveEvent();var t=this;"native"===this.filesPanel.getCloudSettingsById(this.filesPanel.getCurrentDriveId()).type&&this.panel.addClass("native-cloud"),e&&(this.panel.off("click",_),this.panel.empty()),this.createTopBar(this.filesPanel.getUser()),this.panel.find(".g-files-top-buttons").toggleClass("g-cdgs",!this.filesPanel.getUISettings().dialogControls),this.panel.find(".g-files-top-account").toggleClass("g-cdgs",!this.filesPanel.getUISettings().dialogControls);var n=$("<div />").addClass("g-items-container");this.addSearchBar(n);var i=$("<div />").addClass("g-main").appendTo(n);const r=(0,d.throttle)(this._loadFoldersOnDemand.bind(this),100);let a=0;var s=$("<div />").addClass("g-left-side").scroll(e=>{if(t.filesPanel.drive.isLoadFoldersOnDemandSupported()){const t=$(e.target).scrollTop();t>a&&r(),a=t}}).appendTo(i);this._rightSide=$("<div />").addClass("g-right-side").on("contextmenu",e=>{t.resetSelection(),t._openContextMenuForEventPosition(e)}).appendTo(i),this._fileInfoPanel=b._createFileInfoPanel(),this._fileInfoPanel.appendTo(i);var l=$("<div />").addClass("g-folders-list").addClass("main"),c=$("<div />").addClass("g-folders-list").addClass("fixed-bottom").addClass("custom-folders"),u=$("<div/>").addClass("g-files-list"),p=$("<div/>").addClass("g-empty-panel").hide();const g=$("<div/>").addClass("g-example-files-list").hide(),h=$("<div/>").addClass("g-recent-files-list");_=function(e){e.stopPropagation(),t.filesPanel.getSelection().length&&(t.resetSelection(),t._updateFileInfoPanel(null),gDesigner.stats("filespanel-view_clear_selection"))},this.panel.on("click",_);const f=(0,d.debounce)(()=>this.filesPanel.buildDepth(!1,!1),100);$(this._rightSide).scroll(function(e){var t=$(e.currentTarget);Math.floor(t[0].scrollHeight-t.scrollTop())===Math.floor(t.outerHeight())&&$(u).children().length>0&&f()}.bind(this)),this.createHeader(this.panel),n.appendTo(this.panel),l.appendTo(s),c.appendTo(s),$("<div />").addClass("g-files-top-line g-recent-files").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.title-recent-files"))).appendTo(this._rightSide),p.appendTo(this._rightSide),g.appendTo(this._rightSide),h.appendTo(this._rightSide);const m=$("<div />").addClass("g-files-top-line g-all-files").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.title-all-files"))).hide().appendTo(this._rightSide);this.hasPermission(b.Permission.RecentFilesShowMore)&&m.append($("<div />").addClass("g-recent-files-show-more").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.show-more"))).on("click",(function(){h.addClass("extended-list"),$(this).hide(),t.updateLayout()})).on("mouseover",(function(e){e.stopPropagation(),e.preventDefault()}))),u.appendTo(this._rightSide),this.createFooter(this.filesPanel.getDefaultFilename()),this._permissionChanged()},b.prototype.updateLayout=function(){const e=this.panel.find(".g-files-list");if(e.hasClass("list-view")){const t=(e,t)=>{let n,i,o;({columnsAmount:i,total:n,totalRows:o}=this._getGridData(e)),t&&e.css("max-height","");const r=e.hasClass("extended-list");if(!n)return void e.addClass("single-row");if(!i||isNaN(i))return;const a=r?6:2;t&&!r&&o>2?this.panel.find(".g-recent-files-show-more").show():this.panel.find(".g-recent-files-show-more").hide(),t&&o>a&&(o=a),1===o?e.addClass("single-row"):e.removeClass("single-row"),e.find(".g-gravit-file").each((function(e){1!==o&&$(this).toggleClass("last-row-file",function(e){return e>=(o-1)*i}(e))}))};t(e),t(this.panel.find(".g-recent-files-list"),!0)}else{const e=this.panel.find(".g-recent-files-list"),t=e.hasClass("extended-list"),{totalRows:n,firstHeight:i}=this._getGridData(e);if(n>1&&!t){this.panel.find(".g-recent-files-show-more").show();const t=i+10;e.css("max-height",t+"px")}else this.panel.find(".g-recent-files-show-more").hide(),e.css("max-height","1000px")}this._updateContextMenu()},b.prototype._updateContextMenu=function(){this._setContextMenuActiveRangeSize()},b.prototype._getGridData=function(e){const t=e.find(".g-gravit-file"),n=t.length,i=t.eq(0).width(),o=t.eq(0).height();let r=1;i&&!isNaN(i)&&(r=Math.floor(e.width()/i));return{total:n,totalRows:n%r>0?Math.floor(n/r)+1:Math.floor(n/r),columnsAmount:r,firstHeight:o}},b.prototype.toggleLoading=function(e){e?this.panel.closest(".g-dialog-content").find(".cloud-frame").addClass("loading"):this.panel.closest(".g-dialog-content").find(".cloud-frame").removeClass("loading")},b.prototype.toggleRecentFiles=function(e){const t=this.panel.find(".g-right-side");t.toggleClass("g-show-recent-files",!!e),t.find(".g-all-files").toggle(!t.find(".g-files-list").is(":empty")&&!!e),t.find(".g-recent-files").toggle(!t.find(".g-recent-files-list").is(":empty")&&!!e)},b.prototype.toggleFolders=function(e){this.panel.toggleClass("full-width",!!e);this.panel.find(".g-left-side").toggleClass("g-no-display",!e),this.panel.closest(".cloud-dialog").toggleClass("no-folders",!e)},b.prototype.createTopBar=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=new u.default(e);var i=this.filesPanel.getCloudSettings(),r=this.filesPanel.getCloudSettingsById(this.filesPanel.getCurrentDriveId()),a=this,s=$("<div />").addClass("g-files-top-bar").addClass(n?"default":"").append($("<div />").addClass("g-files-top-buttons").append($("<div />").addClass("g-button").addClass("cloud-button").addClass("maximize-button").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.maximize-window"))).on("click",e=>{e.stopPropagation(),this.filesPanel.handleMaximizePanel()}).append($("<span/>").addClass("icon").addClass("gravit-icon-maximize-dialog"))).append($("<div />").addClass("g-button").addClass("cloud-button").addClass("minimize-button").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.minimize-window"))).css("display","none").on("click",e=>{e.stopPropagation(),this.filesPanel.handleMinimizePanel()}).append($("<span/>").addClass("icon").addClass("gravit-icon-minimize-dialog"))).append($("<div/>").addClass("g-button").addClass("cloud-button").addClass("close-button").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.close-window"))).on("click",e=>{e.stopPropagation(),this.filesPanel.handleClosePanel()}).append($("<span/>").addClass("icon").addClass("gravit-icon-close")))).append($("<div />").addClass("g-files-top-account").append($("<div />").addClass("g-files-top-account-name").html(e.getUserReference())).append(new m(e).build().addClass("g-files-top-avatar")));if(t?this.panel.find(".g-files-top-bar").replaceWith(s):s.appendTo(this.panel),n)return void this._createRefreshButton(s,n);var l=$("<div />").addClass("g-files-top-cloud-menu").append($("<div />").addClass("g-files-top-cloud-menu-icon")).on("click",(function(){a._cloudPane(this),gDesigner.stats("filespanel-view_open_cloud-pane")})).appendTo(s);switch(r.type){case"sharepoint":case"sharepoint-native":l.addClass("sharepoint").append($("<div />").addClass("g-files-top-cloud-menu-name").text(r.name));break;case"onedrivebusiness":case"onedrivebusiness-native":l.addClass("onedrivebusiness").append($("<div />").addClass("g-files-top-cloud-menu-name").text(r.name));break;case"googledrive-native":case"googledrive":l.addClass(r.className).append($("<div />").addClass("g-files-top-cloud-menu-name").text(r.name));break;default:l.addClass("gravit-cloud")}i&&0!==i.length||s.append($("<div />").addClass("g-files-top-add-cloud-account-button").append($("<div />").addClass("icon-container").append($("<span />").addClass("icon").addClass("gravit-icon-plus-add"))).append($("<div />").addClass("text").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.connect-cloud-drive")))).on("click",function(){this._newCloudAccountDialog()}.bind(this)));const d=this.filesPanel.drive.getActions();d&&d.length&&d.forEach(e=>{let{title:t,icon:n,execute:i}=e;return $("<div/>").addClass("g-files-top-cloud-refresh-content").append($("<div/>").addClass("container").append(n?$("<div/>").addClass("icon").addClass(n):"").append($("<div/>").addClass("text").text(t))).appendTo(s).click(()=>{gDesigner.stats("filespanel-view_execute_action",t),i(this.filesPanel.getContextSource()).catch(e=>{"string"==typeof e?c.default.alert(e):console.error(e)})})}),this._createRefreshButton(s,n)},b.prototype.updateTopBar=function(){this.createTopBar(this.filesPanel.getUser(),!0)},b.prototype._createRefreshButton=function(e,t){$("<div/>").addClass("g-files-top-cloud-refresh-content").addClass(t?"default":"").append($("<div/>").addClass("container").append($("<div/>").addClass("icon").addClass("gravit-icon-refresh")).append($("<div/>").addClass("text").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.refresh-drive-content"))))).appendTo(e).click(()=>{gDesigner.stats("filespanel-view_refresh_file-list"),this.filesPanel.updateFilesList()})},b.prototype._cloudPane=async function(e){try{var t=this.filesPanel.getCloudSettings(),n=$("<div/>").addClass("cloud-pane").on("click",()=>{gDesigner.stats("filespanel-view_close_cloud-pane"),n.gOverlay("close")}),i=this.filesPanel.getCloudSettingsById(this.filesPanel.getCurrentDriveId()),r=$("<div />").addClass("head").append($("<div />").addClass("cloud-pane-head-icon")).on("click",()=>{gDesigner.stats("filespanel-view_close_cloud-pane"),n.gOverlay("close")}).appendTo(n);switch(i.type){case"sharepoint":case"sharepoint-native":r.addClass("sharepoint").append($("<div />").addClass("cloud-pane-head-name").text(i.name));break;case"googledrive":case"googledrive-native":r.addClass("google-drive").append($("<div />").addClass("cloud-pane-head-name").text(i.name));break;default:r.addClass("native")}if(t&&t.length){for(var a=$("<div />").addClass("items-container"),s=0,l=t.length;s<l;s++)try{var d,u=t[s],p=!1,h=[];if(u.id===i.id&&(d=this.filesPanel.drive.supportsCorporateStorage())){try{h=await this.filesPanel.drive.getCorporateStorages()}catch(e){console.error(e)}p=h.length>0}(e=>{const t=$("<div />").addClass("item").addClass(e.id===this.filesPanel.getCurrentDriveId()?"selected":"").addClass("cloud-".concat(e.type)).append($("<div />").addClass("icon-container").append($("<span />").addClass("icon").addClass(e.className&&"".concat(e.className,"-icon")||""))).append($("<div />").addClass("name").text(e.name)).on("click",async function(){if(e.id!==this.filesPanel.getCurrentDriveId()){gDesigner.stats("filespanel-view_open_cloud-drive",e.name),this.toggleLoading(!0);try{await this.filesPanel.setCloudDrive(e)}catch(e){var t;e&&e instanceof g.default&&(t=e),c.default.alert(t||o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed"))),console.error(">>>failed to set cloud drive",e)}}n.gOverlay("close")}.bind(this)).appendTo(a);if(d&&p&&t.append($("<div />").addClass("corporate-storage-list").addClass("arrow-open-right")),e.deletable&&t.append($("<div />").addClass("account-settings-container").append($("<span />").addClass("edit-account").addClass("icon").addClass("gravit-icon-context-icon")).on("click",t=>{t.preventDefault(),t.stopPropagation(),this._editCloudPane(e),gDesigner.stats("filespanel-view_open_edit-cloud-account-dialog"),this._closeCorporateSubMenu(),n.gOverlay("close")})),d&&p){var i=this.filesPanel.drive.getCorporateStorage(),r=[{default:!0,name:o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.my-drive")),active:!i,data:null}];r=r.concat(h.map(e=>({active:i&&e.id===i.id,default:!1,name:e.name,data:e}))),this._corporateStoragesPane(t,r,async e=>{await this.filesPanel.drive.setCorporateStorage(e.data),this.filesPanel.drive.setCurrentFolder(null),this.filesPanel.updateFilesList(),n.gOverlay("close")})}else t.hover(()=>{this._closeCorporateSubMenu()})})(u)}catch(e){console.error(e)}a.appendTo(n)}t.some(e=>["googledrive"].includes(e.type))||$("<div/>").addClass("new-item").append($("<div />").addClass("icon-container").append($("<span />").addClass("icon").addClass("gravit-icon-plus-add"))).append($("<div />").addClass("text-container").append($("<div />").addClass("item-text").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.connect-new-cloud-drive"))))).on("click",function(){this._newCloudAccountDialog(),n.gOverlay("close")}.bind(this)).appendTo(n),n.gOverlay({padding:!1,releaseOnClose:!0,clazz:"cloud-pane-overlay",offsetX:10,offsetY:-40,closeCallback:()=>{this._closeCorporateSubMenu()}}).gOverlay("open",e,this.panel)}catch(e){c.default.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))}},b.prototype._editCloudPane=function(e){const t=this;if(e){var n=$("<div />").addClass("edit-account-dialog-content").on("keypress",(function(e){13===e.keyCode&&$(this).closest(".edit-account-dialog").find(".vendor-form-save").click()})).append($("<div />").addClass("g-btn-close").append($("<span />").addClass("gravit-icon-close")).on("click",()=>{gDesigner.stats("filespanel-view_close_edit-cloud-account-dialog",e.name),n.gDialog("close")})).append($("<div />").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.edit-drive-title")))).append($("<label />").append($("<div />").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.add-new-account-field-name")))).append($("<input />").attr("type","text").attr("tabindex",1).attr("name","name").val(e.name).attr("id","cloud-account-name"))).gDialog({className:"edit-account-dialog",closable:!0,buttons:[$("<button />").addClass("cloud-button").addClass("edit-account-disconnect-button").attr("tabindex",4).on("click",i=>{i.preventDefault(),i.stopPropagation(),gDesigner.stats("filespanel-view_disconnect_cloud-account",e.name),t.filesPanel.deleteCloudDrive(e).then(async()=>{try{t.filesPanel.getCurrentDriveId()===e.id&&(t.toggleLoading(!0),t.filesPanel.drive instanceof l.default&&await t.filesPanel.drive.uninstall(),t.filesPanel.setCloudDrive(t.filesPanel.getCloudSettingsById(1)))}catch(e){console.error(">>>e",e)}n.gDialog("close")})}).text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.button-edit-cloud-drive-disconnect"))),$("<button />").addClass("vendor-form-cancel").addClass("cloud-button").attr("tabindex",3).on("click",(function(t){t.preventDefault(),t.stopPropagation(),gDesigner.stats("filespanel-view_close_edit-cloud-account-dialog",e.name),n.gDialog("close")})).text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.button-add-cloud-drive-cancel"))),$("<button />").addClass("vendor-form-save").addClass("cloud-button").addClass("primary").attr("tabindex",2).on("click",(async function(i){i.preventDefault(),i.stopPropagation();var o=n.find("#cloud-account-name").val();let r=[];o||r.push("cloud-account-name"),r.length?r.forEach(e=>{n.find("#".concat(e)).addClass("error")}):(gDesigner.stats("filespanel-view_save_edit-cloud-account-dialog",e.name),await t.filesPanel.updateCloudAccountName(e.id,o),n.gDialog("close"))})).text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.button-add-cloud-drive-save")))]});n.gDialog("open",!0),n.find("#cloud-account-name").focus()}else console.error("vendor object is missing")},b.prototype._newCloudAccountDialog=async function(){var e=this,t=await this.filesPanel.getCreateCloudAccountOptions();if(gDesigner.stats("filespanel-view_open_add-cloud-drive-account-dialog"),!(t.length<1)){var n=$("<div />").append($("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>{gDesigner.stats("filespanel-view_close_new-cloud-account-dialog"),n.gDialog("close")})).append($("<div />").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.add-new-cloud-drive")))),i=$("<div />").addClass("vendor-options");n.gDialog({releaseOnClose:!0,closable:!0,className:"g-cloud-account-options"});for(var r=0,a=t.length;r<a;r++){!function(t){i.append($("<div />").addClass("vendor-option").addClass(t.pro&&!gDesigner.isEnabledProFeatures()?"pro":"").addClass(t.type).append($("<div />").addClass("icon").addClass(t.className&&"".concat(t.className,"-icon")||"")).append($("<div />").addClass("name").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.connect-cloud-drive-text")).replace("%name",t.name))).on("click",(function(){if(t.pro&&!gDesigner.isEnabledProFeatures())return gDesigner.stats("filespanel-view_nonprotriespro_clouddriver",t.type),gDesigner.handlePROFeatureInterruption();n.gDialog("close"),e._addCloudDriveDialog(t)})))}(t[r])}n.append(i),n.gDialog("open")}},b.prototype._addCloudDriveDialog=function(e){var t=this;if(e){if(gDesigner.stats("filespanel-view_open_add-cloud-drive-account-form-dialog",e.type),"googledrive"===e.type)return function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.filesPanel.saveNewCloudAccount(e).then(async()=>{try{await t.filesPanel.setCloudDrive(e)}catch(i){return t.filesPanel.deleteCloudDrive(e).then(()=>{if(n)throw i.message;c.default.alert(i.message)}),Promise.reject(i)}})}({type:"googledrive",deletable:!1,className:"google-drive",name:o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.personal-google-drive"))}).then(()=>{const e=this.filesPanel.drive;e&&e.hasEventListeners(l.default.DriveEvent)&&e.trigger(new l.default.DriveEvent(this.filesPanel.getContextSource(),l.default.DriveEvent.Type.Added))})}else console.error("vendor object is missing")},b.prototype._closeCorporateSubMenu=function(){this._corporateSubMenu&&(this._corporateSubMenu.gOverlay("close"),this._corporateSubMenu=null)},b.prototype.updateUserDetails=function(e){let t;e instanceof u.default||(e=new u.default(e)),t=e.getUserReference(),t&&this.panel.find(".g-files-top-account-name").html(t)},b.prototype._corporateStoragesPane=async function(e,t,n){const i=()=>{for(var i=$("<div/>").addClass("corporate-storages-pane").on("click",()=>{gDesigner.stats("filespanel-view_close_corporate-storages-pane"),i.gOverlay("close")}),o=$("<div />").addClass("storage-container"),r=0,s=t.length;r<s;r++){var l=t[r];(function(e){$("<div />").addClass("item").addClass(e.active?"selected":"").append($("<div />").addClass("icon-container").append($("<span />").addClass("icon"))).append($("<div />").addClass("name").text(e.name)).appendTo(o)[0].addEventListener("mousedown",()=>{i.gOverlay("close"),gDesigner.stats("filespanel-view_select_corporate-storage"),n(e)},!0)}).call(this,l)}o.appendTo(i),this._closeCorporateSubMenu(),e.addClass("active"),i.gOverlay({padding:!1,releaseOnClose:!0,clazz:"cloud-corporate-storage-pane-overlay",offsetX:e.outerWidth()-11,offsetY:-e.outerHeight(),closeCallback:()=>{e.removeClass("active"),gContainer.getRuntime()===a.default.Runtime.IPad&&e.gOverlay("close")}}).gOverlay("open",e,this.panel),this._corporateSubMenu=i};gContainer.getRuntime()===a.default.Runtime.IPad?e.click(()=>{e.gOverlay("open"),i()}):e.hover(i)},b.prototype._sortPane=function(e){var t=$("<div/>").addClass("context-pane");void 0!==this.filesPanel.drive.SORT_TYPES.UPDATED&&$("<div/>").addClass("context-button").addClass("sort-option").addClass("updated").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.updated")))).on("click",function(){gDesigner.stats("filespanel-view_sort-by_cloud",s.GFilesPanelSortTypes.UPDATED),this.filesPanel.setSortType("updated"),this.filesPanel.sort(),t.gOverlay("close")}.bind(this)).appendTo(t),void 0!==this.filesPanel.drive.SORT_TYPES.NAME&&$("<div/>").addClass("context-button").addClass("sort-option").addClass("name").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.name")))).on("click",function(){gDesigner.stats("filespanel-view_sort-by_cloud",s.GFilesPanelSortTypes.NAME),this.filesPanel.setSortType("name"),this.filesPanel.sort(),t.gOverlay("close")}.bind(this)).appendTo(t),void 0!==this.filesPanel.drive.SORT_TYPES.CREATED&&$("<div/>").addClass("context-button").addClass("sort-option").addClass("created").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.created")))).on("click",function(){gDesigner.stats("filespanel-view_sort-by_cloud",s.GFilesPanelSortTypes.CREATED),this.filesPanel.setSortType("created"),this.filesPanel.sort(),t.gOverlay("close")}.bind(this)).appendTo(t),$("<hr/>").appendTo(t),$("<div/>").addClass("context-button").addClass("sort-option").addClass("ascending").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.ascending")))).on("click",function(){gDesigner.stats("filespanel-view_sort-type_cloud","ascending"),this.filesPanel.setSortDirection(s.GFilesPanelSortDirections.ASCEND),this.filesPanel.sort(),t.gOverlay("close")}.bind(this)).appendTo(t),$("<div/>").addClass("context-button").addClass("sort-option").addClass("descending").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.descending")))).on("click",function(){gDesigner.stats("filespanel-view_sort-type_cloud","descending"),this.filesPanel.setSortDirection(s.GFilesPanelSortDirections.DESCEND),this.filesPanel.sort(),t.gOverlay("close")}.bind(this)).appendTo(t),t.gOverlay({padding:!1,releaseOnClose:!0,clazz:"context-overlay",offsetX:-70,offsetY:8}).gOverlay("open",e,this.panel),this._updateSortStates()},b.prototype._handleFilterItemClick=function(e,t,n){const i=$(n);e?this.filesPanel.addFileTypeToSelectedFilter(t):this.filesPanel.deleteFileTypeFromSelectedFilter(t),this.filesPanel.sort(),0!==this.filesPanel.getSelectedFilterForFileTypes().length?i.hasClass("g-check")||i.addClass("g-check"):i.hasClass("g-check")&&i.removeClass("g-check")},b.prototype._createFilterFileTypeOverlay=function(e){var t=$("<div/>").addClass("context-pane");const n=this.filesPanel.getAvailableFileTypesFilter();if(!n||!n.length)return;var i=this;return n.forEach(n=>{!function(t,n){const r=$('<input type="checkbox"/>').on("click",(function(n){n.stopImmediatePropagation(),i._handleFilterItemClick(r[0].checked,t.type,e)}));$("<div/>").addClass("context-button").addClass("sort-option").addClass(t.id).append(r).append($("<label/>").addClass("label").css("cursor","pointer").text(o.GLocale.get(t.name))).on("click",(function(n){n.preventDefault(),n.stopImmediatePropagation(),r[0].checked=!r[0].checked,i._handleFilterItemClick(r[0].checked,t.type,e)})).appendTo(n)}(n,t)}),t.append($("<hr>")),$("<div/>").addClass("context-button").addClass("sort-option").addClass("clear-option").append($("<span>").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.clear")))).on("click",function(){if(0===this.filesPanel.getSelectedFilterForFileTypes().length)return;const e=t.find("input[type=checkbox]");for(let t=0;t<e.length;t++)e[t].checked=!1;this.filesPanel.clearAllFileTypesFromSelectedFilter(),this.clearFileTypeFilterState(),this.filesPanel.sort()}.bind(this)).appendTo(t),t.gOverlay({padding:!1,releaseOnClose:!0,clazz:"context-overlay",offsetX:-70,offsetY:8}).gOverlay("open",e,this.panel),this._updateFilterFileTypeStates(),t},b.prototype._updateSortStates=function(){var e=this.panel.closest(".g-dialog-container");e.find(".sort-option").removeClass("sort-selected"),e.find(".sort-option."+this.filesPanel.getSortType()).addClass("sort-selected"),this.filesPanel.getSortDirection()?e.find(".sort-option.ascending").addClass("sort-selected"):e.find(".sort-option.descending").addClass("sort-selected")},b.prototype._updateFileTypeFilterButtonColor=function(e){0!==this.filesPanel.getSelectedFilterForFileTypes().length&&$(e).addClass("g-check")},b.prototype._updateFilterFileTypeStates=function(){var e=this.panel.closest(".g-dialog-container");if(!e.length)return;this.filesPanel.getSelectedFilterForFileTypes().forEach(t=>{const n=this.filesPanel.getAvailableFileTypesFilter().find(e=>e.type===t);e.find(".sort-option.".concat(n.id)).find("input[type=checkbox]")[0].checked=!0})},b.prototype._addToSelection=function(e){var t=e.data("node");t&&(e.addClass("selected"),this.filesPanel.addToSelection(t))},b.prototype.resetSelection=function(){this.panel.find(".g-gravit-folder").removeClass("selected"),this.panel.find(".g-gravit-file").removeClass("selected").removeClass("last-selected"),this.filesPanel.resetSelection()},b.prototype.manageOpenFolder=function(e,t,n){(this.panel.find(".g-gravit-folder").removeClass("opened"),e)?$(e).addClass("opened"):t&&this.panel.find(".g-gravit-folder").each((e,n)=>{const i=$(n),o=i.data("node");(o&&"id"in o&&(o.id===t.id||o.id===t)||o===t)&&i.addClass("opened")});if(n&&!n.isRootFolder()){var i=n.getChildren();i&&i.length&&i.forEach(e=>e.refresh())}},b.prototype._isMultiSelectionEnabled=function(){return this.filesPanel.isMultiSelectionEnabled()},b.prototype.manageSelection=function(e,t){if(this.panel.find(".g-gravit-file").removeClass("last-selected"),r.GPlatform.modifiers.metaKey)e.hasClass("selected")?(e.removeClass("selected"),this.filesPanel.removeFromSelection(t)):this._addToSelection(e);else if(this._isMultiSelectionEnabled()&&r.GPlatform.modifiers.shiftKey){var n=$(e),i=n.nextAll(".g-cloud-element.selected"),o=n.prevAll(".g-cloud-element.selected"),a=o.length>0?o[0]:null,s=i.length>0?i[0]:null;if(!a||!s){this.resetSelection();var l=[],c=null;if(a?(c=$(a),l=$(a).nextUntil(e)):(c=$(s),l=$(e).nextUntil(s)),l.length>0)for(var d=0;d<l.length;++d){let e=$(l[d]);this._addToSelection(e)}this._addToSelection(e),this._addToSelection(c)}}else this.resetSelection(),this._addToSelection(e),e.addClass("last-selected")},b.prototype.addToClipboard=function(e){let t="";t=this.filesPanel.isClipboardModeCopy(e)?"copy":"cut",this.panel.find(".g-gravit-folder.selected").addClass(t),this.panel.find(".g-gravit-file.selected").addClass(t),this.resetSelection()},b.prototype.resetClipboard=function(e){let t="";this.filesPanel.isClipboardModeCopy(e)?t="copy":this.filesPanel.isClipboardModeCut(e)&&(t="cut"),this.panel.find(".g-gravit-folder").removeClass(t),this.panel.find(".g-gravit-file").removeClass(t)},b.prototype.shouldFilesBeRequested=function(){var e=this.panel.find(".g-right-side");return Math.floor(e[0].scrollHeight-e.scrollTop())===Math.floor(e.outerHeight())},b.prototype.clearFilesAndFolders=function(){this._cloudFolders=[],this.clearFiles(),this.panel.find(".g-folders-list").empty()},b.prototype.clearFiles=function(){this.panel.find(".g-files-list").empty(),this.panel.find(".g-recent-files-list").empty(),this.panel.find(".g-search-no-results").hide(),this.toggleRecentFiles(!1)},b.prototype._showCDRWarningUnsupportedObjects=function(){this.panel.find(".save-form-container").addClass("warning").find(".warning-container").css("display","")},b.prototype.minimizeWindow=function(){this.panel.closest(".g-dialog-container").removeClass("fullscreen"),this.panel.find(".g-files-top-bar").find(".maximize-button").show(),this.panel.find(".g-files-top-bar").find(".minimize-button").hide()},b.prototype.maximizeWindow=function(){this.panel.closest(".g-dialog-container").addClass("fullscreen"),this.panel.find(".g-files-top-bar").find(".maximize-button").hide(),this.panel.find(".g-files-top-bar").find(".minimize-button").show()},b.prototype.toListView=function(){this.panel.find(".g-files-list").addClass("list-view"),this.panel.find(".g-recent-files-list").addClass("list-view"),this.panel.find(".header").find(".g-button.list-view").addClass("g-selected"),this.panel.find(".header").find(".g-button.card-view").removeClass("g-selected"),this.updateLayout()},b.prototype.toCardView=function(){this.panel.find(".g-files-list").removeClass("list-view"),this.panel.find(".g-recent-files-list").removeClass("list-view"),this.panel.find(".header").find(".g-button.card-view").addClass("g-selected"),this.panel.find(".header").find(".g-button.list-view").removeClass("g-selected"),this.updateLayout()},b.prototype.toggleEmptyPanel=function(e){if(e){const e=this.filesPanel.drive.getDefaultEmptyMessage();e&&this.panel.find(".g-empty-panel").empty().prepend($("<div/>").append($("<span/>").html(e.title)).append(e.buttons?e.buttons.map(e=>$("<button/>").addClass("g-highlight-button highlighted").text(e.title).on("click",()=>(gDesigner.stats("filespanel-view_execute_action",e.title),e.execute(this.filesPanel.getContextSource())))):"")).show()}else this.panel.find(".g-empty-panel").hide()},b.prototype.toggleExampleFiles=function(e){e?this.panel.find(".g-example-files-list").show():this.panel.find(".g-example-files-list").hide()},b.prototype.removeExampleFiles=function(){this.panel.find(".g-gravit-example-file").remove()},b.prototype.renderNewFolderButton=function(e,t){var n=$("<div/>").addClass("header-left-actions");$("<div/>").addClass("g-button").addClass("cloud-button").addClass("new-folder").append($("<span/>").addClass("icon").addClass("gravit-icon-w-newfolder")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.new-folder")))).attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.new-folder-tooltip"))).on("click",e=>{e.stopPropagation();const n=$(e.currentTarget).hasClass("g-disabled");this._isCreateFolderEnabled()&&!n&&this.filesPanel.handleNewFolder(t)}).appendTo(n),n.appendTo(e)},b.prototype._isCreateFolderEnabled=function(){return!gDesigner.getApplicationManager().isOnlyFileOpenFromCloudEnabled()&&this.hasPermission(b.Permission.CreateFolder)},b.prototype.renderSortButton=function(e){var t=this,n=$("<div/>").addClass("g-button").addClass("cloud-button").addClass("sort").css("margin-left","5px").append($("<span/>").addClass("icon").addClass("gravit-icon-w-sort")).attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.sort"))).on("click",(function(e){e.stopPropagation(),gDesigner.stats("filespanel-view_sort_cloud"),t._sortPane(this)}));this._sortButton=n,n.appendTo(e)},b.prototype.renderFileTypeFilterButton=function(e){var t=this,n=$("<div/>").addClass("g-button").addClass("cloud-button").addClass("filter-button").addClass("sort").append($("<span/>").addClass("icon").addClass("gravit-icon-filter-view")).attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.filter"))).on("click",(function(e){e.stopPropagation(),t._createFilterFileTypeOverlay(this)}));n.appendTo(e),this._fileTypeFilterButton=n,this._updateFileTypeFilterButtonColor(n)},b.prototype.clearFileTypeFilterState=function(){this._fileTypeFilterButton&&this._fileTypeFilterButton.removeClass("g-check")},b.prototype.hideFileTypeFilterButton=function(){this._fileTypeFilterButton&&(this._fileTypeFilterButton.css("display","none"),this._sortButton.css("marginLeft","15px"))},b.prototype.displayFileTypeFilterButton=function(){this._fileTypeFilterButton&&(this._fileTypeFilterButton.css("display","block"),this._sortButton.css("marginLeft","5px"))},b.prototype.renderToParentFolderButton=function(e){$("<div/>").addClass("g-button").addClass("cloud-button").addClass("back").addClass("g-hidden").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.back-tooltip"))).append($("<span/>").addClass("icon").addClass("gravit-icon-w-back")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.back")))).on("click",function(e){e.stopPropagation(),this.filesPanel.handleBack()}.bind(this)).appendTo(e)},b.prototype.renderToRootFolderButton=function(e){$("<div/>").addClass("g-button").addClass("cloud-button").addClass("back").addClass("g-hidden").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.my-cloud-tooltip"))).append($("<span/>").addClass("icon").addClass("gravit-icon-w-back")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.my-cloud")))).on("click",function(e){e.stopPropagation(),this.filesPanel.navigateToRoot()}.bind(this)).appendTo(e)},b.prototype.renderGridStyleButtons=function(e){var t=this;$("<div />").addClass("grid-styles-container").append($("<div />").addClass("g-button").addClass("cloud-button").addClass("style-button").addClass("card-view").addClass("g-selected").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.card-view-button"))).append($("<span />").addClass("icon").addClass("gravit-icon-card-view")).on("click",(function(e){e.stopPropagation(),$(this).hasClass("g-selected")||(gDesigner.stats("filespanel-view_view-files_card"),t.filesPanel.toCardView())}))).append($("<div />").addClass("g-button").addClass("cloud-button").addClass("style-button").addClass("list-view").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.list-view-button"))).append($("<span />").addClass("icon").addClass("gravit-icon-list-view")).on("click",(function(e){e.stopPropagation(),$(this).hasClass("g-selected")||(gDesigner.stats("filespanel-view_view-files_list"),t.filesPanel.toListView())}))).appendTo(e)},b.prototype._getSaveOptions=function(){return{}},b.prototype.addSearchBar=function(){},b.prototype.getSearchValue=function(){},b.prototype.updateControls=function(){},b.prototype.updateToolControls=function(){},b.prototype.createHeader=function(){},b.prototype.createFooter=function(){},b.prototype.addFile=function(){},b.prototype.addFolder=function(){},b.prototype.focusFileNameInput=function(){},b.prototype.scrollToSelectedElement=function(){},b.Permission={CreateFolder:"create-folder",RecentFilesShowMore:"recent-files-show-more"},b.prototype._permissions=[],b.prototype.hasPermission=function(e){return this._permissions.includes(e)},b.prototype.setPermission=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._permissionSupported(e)){if(t)this.hasPermission(e)||this._permissions.push(e);else if(this.hasPermission(e)){var n=this._permissions.indexOf(e);this._permissions.splice(n,1)}this._permissionChanged()}else console.warn("Permission not supported: "+e)},b._createFileInfoPanel=function(){return $("<div/>").on("click",e=>{e.stopPropagation(),e.preventDefault()}).addClass("g-file-info-panel")},b.prototype._closeFileInfoPanel=function(){this._rightSide.toggleClass("show-info-panel",!1),this._fileInfoPanel.toggleClass("g-active",!1),this._fileInfoPanelIsOpen=!1},b.prototype._openFileInfoPanel=function(){this._rightSide.toggleClass("show-info-panel",!0),this._fileInfoPanel.toggleClass("g-active",!0),this._fileInfoPanelIsOpen=!0},b.prototype._updateFileInfoPanel=async function(e,t,n){const i=this.filesPanel.getSelection();if(!e||!this._user||i&&1!==i.length)this._closeFileInfoPanel();else{i[0].id!==e.id&&(e=i[0]);try{this._openFileInfoPanel(),this._fileInfoPanel.toggleClass("loading",!0),this._fileInfoPanel.empty();const i=$("<div/>").addClass("g-file-detail-container").appendTo(this._fileInfoPanel),o=y.getRenderForFile(e);await o.render(i,e),o.addEventListener(v,i=>{switch(i.type){case v.Type.DoubleClickFile:this.filesPanel.handleFileDblClick(i.data);break;case v.Type.Reload:this._updateFileInfoPanel(e,t,n)}})}finally{this._fileInfoPanel.toggleClass("loading",!1),this._scrollToTheFile(t,n),n&&this._expandRecentListIfFileWasHidden(t)}}},b.prototype._scrollToTheFile=function(e){const t=this._rightSide.height()/3,n=e[0],i=n.offsetTop-t>0?n.offsetTop-t:0;this._rightSide.animate({scrollTop:i+"px"},400)},b.prototype._expandRecentListIfFileWasHidden=function(e){const t=this.panel.find(".g-recent-files-list"),n=this._getGridData(t);t.find(".g-gravit-file").index(e)>=n.columnsAmount&&(this.panel.find(".g-recent-files-show-more").hide(),t.css("max-height","max-content"))},b.prototype._permissionSupported=function(e){return Object.values(b.Permission).includes(e)},b.prototype.handleShortcut=function(e){switch(e.which){case 70:this._forceSearchInput(e);break;case 86:this._handlePasteShortcut(e);break;case 27:this._handleEscShortcut(e)}},b.prototype._forceSearchInput=function(e){if(r.GPlatform.modifiers.metaKey||r.GPlatform.modifiers.ctrlKey){var t=this.panel.find(".search-container > input.search-field");t.length>0&&(e.preventDefault(),t.focus())}},b.prototype._handlePasteShortcut=function(e){function t(){e.preventDefault(),e.stopPropagation()}(r.GPlatform.modifiers.metaKey||r.GPlatform.modifiers.ctrlKey)&&(this.filesPanel.isClipboardModeCut()?(t(),this.filesPanel.performCutPaste()):this.filesPanel.isClipboardModeCopy()&&(t(),this.filesPanel.performCopyPaste()))},b.prototype._handleEscShortcut=function(e){this._fileInfoPanelIsOpen&&(this._closeFileInfoPanel(),e.preventDefault(),e.stopPropagation())},b.prototype.handleParentClose=function(){window.removeEventListener("keydown",this._bindedHandleSearchShortcut,!0),gDesigner.removeEventListener(l.default.DriveEvent,this._handleDriveEvent,this)},b.prototype._setContextMenuActiveRangeSize=function(e){const t=e||this._contextMenu,n=$(".frame.cloud-frame"),i=n.offset();i&&(t.setActiveRangeSize(i.left,i.top,n.height(),n.width()),this._downloadContextMenu&&this._downloadContextMenu.setActiveRangeSize(i.left,i.top,n.height(),n.width()))},b.prototype._permissionChanged=function(){},b.prototype._isContextMenuAvailableForFile=function(e){return this.filesPanel._isContextMenuAvailableForFile(e)},e.exports=b},function(e,t,n){"use strict";function i(){}n(45),n(25),i.prototype.type=null,i.prototype.hasKey=function(e){return this.hasOwnProperty(e)},i.prototype.hasValue=function(e){return this.hasKey(e)&&void 0!==this[e]&&null!==this[e]},i.prototype.getAsInt=function(e){return parseInt(this[e])},i.from=function(e){if(!e||e&&!Object.keys(e).length)return null;var t=new i;return t=Object.assign(t,e)},i.FileExtension={CDR:"cdr",DES:"des",CDRAPP:"cdr",GVDESIGN:"gvdesign"},e.exports=i},function(e,t,n){"use strict";var i=setInterval((function(){navigator.onLine&&($(document).trigger("networkAvailable"),clearInterval(i))}),2e4);t.youtubePlaylist="https://www.youtube.com/playlist?list=PLqsk_4aqUvEYxmy5NpQakcZXa6_3w-I8F"},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16),a=n(775),s=n(778),l=n(1062),c=n(723),d=n(550),u=n(784),p=n(1063),g=n(1064),h=n(776),f=n(724),m=n(1065),y=n(779),v=n(1066);const _=n(1187),b=n(1188),w=n(1189),C=n(1190),E=n(1191),S=n(1192);var G=n(780),A=n(783),T=n(781),P=n(782),L=n(217),D=n(308),x=n(717),I=n(1067),O=n(1193),k=n(1194),F=n(1195),R=n(785),M=n(1068);const N=n(786);var B=n(770),U=n(403),K=n(36),j=n(78);function H(e){var t=this._createContextMenu(),n=this._createCropMenu(),o=this._createPageMenu(),r=this._createTouchContextMenu(),a=this._createFillPropertyMenu(),s=this._createBorderPropertyMenu(),l=this._createEffectPropertyMenu();e.on("contextmenu",function(e,c){if(gDesigner.getWindows().getActiveWindow().getView()){var d=c&&c.previousEvent?c.previousEvent:c,u=gDesigner.getToolManager().getActiveTool(),p=e.data&&e.data.context||d&&d.data&&d.data.context;if(!u||!u.catchesContextMenu(p==U.LayerPanel||!1)){var g=t,h=!1;p===U.PagePanel?(g=o,gDesigner.stats("contextmenu_open_page-menu")):p===U.LayerPanel?(h=!0,gDesigner.stats("contextmenu_open_layer-menu")):p===U.FillPropertyPanel?(g=a,gDesigner.stats("contextmenu_open_fill-properties-menu")):p===U.BorderPropertyPanel?(g=s,gDesigner.stats("contextmenu_open_border-properties-menu")):p===U.EffectPropertyPanel?(g=l,gDesigner.stats("contextmenu_open_effect-properties-menu")):u instanceof i.GSelectTool&&u.isCropContext()?(g=n,gDesigner.stats("contextmenu_open_crop-menu")):(h=!0,gDesigner.stats("contextmenu_open_context-menu"));var f="number"==typeof e.clientX?e:d;this._contextMenuClientPosition=gDesigner.getWindows().getActiveWindow().getView()._convertClientPositionFromMousePosition(f);var m=e.pageX?e.pageX:d.pageX,y=e.pageY?e.pageY:d.pageY;return this._mouseEvent=e.pageX?e:d,this._options=c,gDesigner.isTouchEnabled()&&h?r.gOverlay("open",{x:m,y:y},void 0,()=>{gDesigner.trigger(new j(j.Type.ContextMenuOpened,gDesigner.getActiveDocument()))}):g.open({x:m,y:y}),this._contextMenuTouch=r,this._contextMenuDesktop=g,!0}}}.bind(this))}H.ID="context.menu",H.prototype._contextMenuClientPosition=null,H.prototype._mouseEvent=null,H.prototype._options=null,H.prototype._contextMenuTouch=null,H.prototype._contextMenuDesktop=null,H.prototype._createContextMenu=function(){var e=new L;e.__which="context",e.createAddItem(gDesigner.getAction(F.ID));var t=new D(D.Type.Menu,L);t.setCaption(o.GLocale.get(new o.GLocaleKey("GPaste","action.paste"))),t.getMenu().createAddItem(gDesigner.getAction(M.ID),null,null,null,H.ID).addEventListener(D.UpdateEvent,function(){gDesigner.getAction(M.ID).setPosition(this._contextMenuClientPosition)}.bind(this)),t.getMenu().createAddItem(gDesigner.getAction(N.ID)),t.getMenu().createAddItem(gDesigner.getAction(R.ID)),e.addItem(t),e.createAddDivider();var n=new D(D.Type.Menu,L);n.setCaption(o.GLocale.get(new o.GLocaleKey("GContextMenu","text.arrange"))),n.getMenu().createAddItem(gDesigner.getAction(s.ID+"."+i.GEditor.ArrangeOrderType.SendToFront)),n.getMenu().createAddItem(gDesigner.getAction(s.ID+"."+i.GEditor.ArrangeOrderType.BringForward)),n.getMenu().createAddItem(gDesigner.getAction(s.ID+"."+i.GEditor.ArrangeOrderType.SendBackward)),n.getMenu().createAddItem(gDesigner.getAction(s.ID+"."+i.GEditor.ArrangeOrderType.SendToBack)),e.addItem(n);var x=new D(D.Type.Menu,L);x.setCaption(o.GLocale.get(new o.GLocaleKey("GContextMenu","text.align"))),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignLeft)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignCenter)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignRight)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignJustifyHorizontal)),x.getMenu().createAddDivider(),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignTop)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignMiddle)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignBottom)),x.getMenu().createAddItem(gDesigner.getAction(a.ID+"."+i.GEditor.ArrangeAlignType.AlignJustifyVertical)),x.getMenu().createAddDivider(),x.getMenu().createAddItem(gDesigner.getAction(h.ID+"."+h.Type.Horizontal)),x.getMenu().createAddItem(gDesigner.getAction(h.ID+"."+h.Type.Vertical)),e.addItem(x);var O=new D(D.Type.Menu,L);O.setCaption(o.GLocale.get(new o.GLocaleKey("GContextMenu","text.transform"))),O.getMenu().createAddItem(gDesigner.getAction(T.ID+"."+T.Type.Rotate90Left)),O.getMenu().createAddItem(gDesigner.getAction(T.ID+"."+T.Type.Rotate90Right)),O.getMenu().createAddItem(gDesigner.getAction(T.ID+"."+T.Type.FlipHorizontal)),O.getMenu().createAddItem(gDesigner.getAction(T.ID+"."+T.Type.FlipVertical)),e.addItem(O),e.createAddDivider(),e.createAddItem(gDesigner.getAction(f.ID)),e.createAddItem(gDesigner.getAction(y.ID)),e.createAddItem(gDesigner.getAction(G.ID)),e.createAddItem(gDesigner.getAction(I.ID)),e.createAddDivider(),e.createAddItem(gDesigner.getAction(c.ID)),e.createAddItem(gDesigner.getAction(P.ID)),e.createAddItem(gDesigner.getAction(m.ID)),e.createAddItem(gDesigner.getAction(A.ID)),e.createAddDivider(),e.createAddItem(gDesigner.getAction(d.ID)),e.createAddItem(gDesigner.getAction(p.ID)),e.createAddItem(gDesigner.getAction(u.ID)),e.createAddDivider(),e.createAddItem(gDesigner.getAction(l.ID)),e.createAddItem(gDesigner.getAction(g.ID)),e.createAddDivider();const k=new D(D.Type.Menu,L);k.setCaption(o.GLocale.get(new o.GLocaleKey("GContextMenu","text.select-same"))),k.getMenu().createAddItem(gDesigner.getAction(v.ID)),k.getMenu().createAddDivider(),k.getMenu().createAddItem(gDesigner.getAction(_.getId(_.Type.Fill))),k.getMenu().createAddItem(gDesigner.getAction(_.getId(_.Type.Border))),k.getMenu().createAddItem(gDesigner.getAction(_.getId(_.Type.FillAndBorder))),k.getMenu().createAddDivider(),k.getMenu().createAddItem(gDesigner.getAction(b.ID)),k.getMenu().createAddItem(gDesigner.getAction(w.ID)),k.getMenu().createAddItem(gDesigner.getAction(C.ID)),k.getMenu().createAddItem(gDesigner.getAction(E.ID)),k.getMenu().createAddItem(gDesigner.getAction(S.ID)),e.addItem(k),e.createAddDivider();var B=new D(D.Type.Menu,L);return B.setCaption(o.GLocale.get(new o.GLocaleKey("GContextMenu","text.select"))),B.setIcon("gravit-icon-cursor-filled"),B.addEventListener(D.UpdateEvent,function(){B.getMenu().clearItems(),B.setEnabled(!1);var{elementHits:e,filteredElementHits:t,submenus:n}=this._getHitsElments();if(!(e&&e.length>0&&e[0]instanceof o.GPage)&&e&&e.length>0){B.setEnabled(!0);for(var i=0;i<t.length;i++){var a=t[i].element,s=a instanceof o.GBlock?a.getLabel():a.getNodeNameTranslated(),l="temp-"+e.indexOf(t[i]);if(n[l]){var c=new D(D.Type.Menu,L);c.setCaption((i+1).toString()+". "+s),c.setData(l),c.addEventListener(D.UpdateEvent,(function(){var e=n[this.getData()];this.getMenu().clearItems();for(var t=0;t<e.length;t++)this.getMenu().createAddItem((t+1).toString()+". "+(e[t]instanceof o.GBlock?e[t].getLabel():e[t].getNodeNameTranslated()),(function(){this.element.removeFlag(o.GNode.Flag.Highlighted),gDesigner.getActiveDocument().getEditor().updateSelection(r.GPlatform.modifiers.shiftKey,[this.element])}),(function(){this.element.setFlag(o.GNode.Flag.Highlighted)}),(function(){this.element.removeFlag(o.GNode.Flag.Highlighted)})).element=e[t]})),B.getMenu().addItem(c)}else B.getMenu().createAddItem((i+1).toString()+". "+s,(function(){this.element.removeFlag(o.GNode.Flag.Highlighted),gDesigner.getActiveDocument().getEditor().updateSelection(r.GPlatform.modifiers.shiftKey,[this.element])}),(function(){this.element.setFlag(o.GNode.Flag.Highlighted)}),(function(){this.element.removeFlag(o.GNode.Flag.Highlighted)})).element=a}}}.bind(this)),e.addItem(B),e},H.prototype._createCropMenu=function(){var e=new L;return e.__which="crop",e.createAddItem(gDesigner.getAction(O.ID)),e.createAddItem(gDesigner.getAction(k.ID)),e},H.prototype._getHitsElments=function(e){e=e||this._mouseEvent;var t=gDesigner.getWindows().getActiveWindow().getView()._convertClientPositionFromMousePosition(e),n=gDesigner.getActiveDocument().getScene(),r=gDesigner.getWindows().getActiveWindow().getView(),a=r.getWorldTransform(n),s=function(e){return!(e instanceof o.GPage)}.bind(this),l=n.hitTest(t,a,s,!0,-1,i.GEditorOptions.pickDistance,!0,null,!0,!1,r.getViewConfiguration().multiPageView);if(l&&l.length>0&&(l=l.filter((function(e){var t=e.element.getProperty("plkt");return!(t&o.GBlock.ProgramLck.NoEdit&&t&o.GBlock.ProgramLck.NoSizeChanges&&t&o.GBlock.ProgramLck.NoMove&&t&o.GBlock.ProgramLck.NoDelete)}))),l&&l.length>0&&l[0]instanceof o.GPage)return{elementHits:l};var c=[],d={};if(l&&l.length>0)for(var u=0;u<l.length;++u){for(var p=l[u].element.getParent(),g=!1,h=0;h<l.length;++h)if(l[h].element===p){g=!0,d["temp-"+h]?d["temp-"+h].push(l[u].element):d["temp-"+h]=[l[u].element];break}g||c.push(l[u])}return{elementHits:l,filteredElementHits:c,submenus:d}},H.prototype._createPageMenu=function(){var e=new L(null,"g-page-option-menu"),t={DUPLICATE:o.GLocale.get(new o.GLocaleKey("GContextMenu","page-panel.text.duplicate")),DELETE:o.GLocale.get(new o.GLocaleKey("GContextMenu","page-panel.text.delete")),COPY:o.GLocale.get(new o.GLocaleKey("GContextMenu","page-panel.text.copy")),EXPORT:o.GLocale.get(new o.GLocaleKey("GContextMenu","page-panel.text.export"))},n=e.createAddItem(t.DUPLICATE,(function(){var e=gDesigner.getActiveDocument().getScene();i.GEditor.tryRunTransaction(e,(function(){var t=e.getActivePage(),n=t.clone({copy:!0,copyIgnoreProperties:i.GEditorOptions.propertiesExcludedFromCopying});e.insertChild(n),e.renameClone(t,n);var r=n.getPosition(!0,!0,!0,!0);n.setProperty("off",new o.GTransform(1,0,0,1,r.getX(),r.getY()))}),t.DUPLICATE),gDesigner.stats("contextmenu_pages_duplicate")})),r=e.createAddItem(t.DELETE,(function(){var e=gDesigner.getActiveDocument().getScene(),n=e.getActivePage(),r=n.getSlavePages().length>0;n.getProperty("plkt")&o.GBlock.ProgramLck.NoDelete||(r?K.confirm(o.GLocale.get(new o.GLocaleKey("GOutlineSidebar","text.confirm-delete-masterpage")),(function(t){t&&i.GEditor.tryRunTransaction(e,(function(){e.deleteActivePage()}),o.GLocale.get(new o.GLocaleKey("GOutlineSidebar","action.delete-page")))}),null,null,!0,!0):i.GEditor.tryRunTransaction(e,(function(){e.deleteActivePage()}),t.DELETE),gDesigner.stats("contextmenu_pages_delete"))})),a=e.createAddItem(t.COPY,(function(){var e=gDesigner.getActiveDocument(),n=e.getScene();i.GEditor.tryRunTransaction(n,(function(){var t=e.isCommercialProductFile()||!gDesigner.getApplicationManager().isCopyPasteEnabled(),r=n.getActivePage(),a=o.GNode.serialize(r,{copy:!0,copyIgnoreProperties:i.GEditorOptions.propertiesExcludedFromCopying}),s='<gravit mimeType="'+o.GNode.MIME_TYPE+'" restricted="'+(!!t&&e.getStorageItem().getId())+'">'+$("<div/>").text(a).html()+"</gravit>";gContainer.copyToClipboard(s)}),t.COPY),gDesigner.stats("contextmenu_pages_copy")})),s=e.createAddItem(t.EXPORT,(function(){var e=gDesigner.getActiveDocument().getScene().getActivePage();gDesigner.executeAction(B.ID,[{element:e}],null,!0),gDesigner.stats("contextmenu_pages_export")}));return n.setIcon("gravit-icon-duplicate"),r.setIcon("gravit-icon-delete"),a.setIcon("gravit-icon-copy"),s.setIcon("gravit-icon-export"),s.setProFeatureInterruption(!1),e.addEventListener(x.EVENT,(function(e){gDesigner.isEnabledProFeatures()||s.setPro(!0)})),e.__which="page",e},H.prototype._createFillPropertyMenu=function(){var e=new L(null,"fill-context-menu"),t=null,n={DELETE:o.GLocale.get(new o.GLocaleKey("GContextMenu","fill-properties-panel.text.delete-fill")),COPY:o.GLocale.get(new o.GLocaleKey("GContextMenu","fill-properties-panel.text.copy-fill"))},a=e.createAddItem(n.DELETE,(function(){if(t){var e=gDesigner.getActiveDocument().getEditor().getSelection();i.GEditor.tryRunTransaction(e[0],(function(){for(var n=0;n<e.length;n++)for(var i=e[n].getPaintLayers().getFillLayers(),r=0;r<i.length;r++){var a=i[r];if(o.GStylable.FillPaintLayer.equals(a,t)){a.getParent().removeChild(a);break}}}),n.DELETE)}gDesigner.stats("contextmenu_fills_delete")})),s=e.createAddItem(n.COPY,(function(){if(t){var e=o.GNode.serialize([t],{copy:!0,copyIgnoreProperties:i.GEditorOptions.propertiesExcludedFromCopying}),n='<gravit mimeType="'+o.GNode.MIME_TYPE+'">'+$("<div/>").text(e).html()+"</gravit>";gContainer.copyToClipboard(n)}gDesigner.stats("contextmenu_fills_copy")}));return a.setIcon("gravit-icon-trash"),s.setIcon("gravit-icon-copy"),a.setShortcutHint([r.GKey.Constant.DELETE]),s.setShortcutHint([r.GKey.Constant.META,"C"]),e.addEventListener(x,function(){t=this._options&&this._options.data&&this._options.data.paintLayer}.bind(this)),e.__which="fill",e},H.prototype._createBorderPropertyMenu=function(){var e=new L(null,"border-context-menu"),t=null,n={ADVANCED:o.GLocale.get(new o.GLocaleKey("GContextMenu","border-properties-panel.text.advanced-settings")),DELETE:o.GLocale.get(new o.GLocaleKey("GContextMenu","border-properties-panel.text.delete-border")),COPY:o.GLocale.get(new o.GLocaleKey("GContextMenu","border-properties-panel.text.copy-border"))},a=e.createAddItem(n.ADVANCED,function(){this._options&&this._options.data&&this._options.data.openAdvancedSettings(),gDesigner.stats("contextmenu_borders_advanced-settings")}.bind(this)),s=e.createAddItem(n.DELETE,(function(){if(t){var e=gDesigner.getActiveDocument().getEditor().getSelection();i.GEditor.tryRunTransaction(e[0],(function(){for(var n=0;n<e.length;n++)for(var i=e[n].getPaintLayers().getBorderLayers(),r=0;r<i.length;r++){var a=i[r];if(o.GStylable.BorderPaintLayer.equals(a,t)){a.getParent().removeChild(a);break}}}),n.DELETE)}gDesigner.stats("contextmenu_borders_delete")})),l=e.createAddItem(n.COPY,(function(){if(t){var e=o.GNode.serialize([t],{copy:!0,copyIgnoreProperties:i.GEditorOptions.propertiesExcludedFromCopying}),n='<gravit mimeType="'+o.GNode.MIME_TYPE+'">'+$("<div/>").text(e).html()+"</gravit>";gContainer.copyToClipboard(n)}gDesigner.stats("contextmenu_borders_copy")}));return a.setIcon("gravit-icon-settings"),s.setIcon("gravit-icon-trash"),l.setIcon("gravit-icon-copy"),s.setShortcutHint([r.GKey.Constant.DELETE]),l.setShortcutHint([r.GKey.Constant.META,"C"]),e.addEventListener(x,function(){t=this._options&&this._options.data&&this._options.data.paintLayer}.bind(this)),e.__which="border",e},H.prototype._createEffectPropertyMenu=function(){var e=new L(null,"effect-context-menu"),t=null,n={COPY:o.GLocale.get(new o.GLocaleKey("GContextMenu","effect-properties-panel.text.copy-effect")),APPLY_TO_ELEMENT:o.GLocale.get(new o.GLocaleKey("GContextMenu","effect-properties-panel.text.apply-to-element")),APPLY_TO_FILL:o.GLocale.get(new o.GLocaleKey("GContextMenu","effect-properties-panel.text.apply-to-fill")),APPLY_TO_BORDER:o.GLocale.get(new o.GLocaleKey("GContextMenu","effect-properties-panel.text.apply-to-border"))},a=new D(D.Type.Menu,L);a.getMenu().addClass("effect-context-menu");var s=a.getMenu().createAddItem(n.APPLY_TO_ELEMENT,(function(){u(null,n.APPLY_TO_ELEMENT)})),l=a.getMenu().createAddItem(n.APPLY_TO_FILL,(function(){u(o.GStylable.StyleLayer.Fill,n.APPLY_TO_FILL)})),c=a.getMenu().createAddItem(n.APPLY_TO_BORDER,(function(){u(o.GStylable.StyleLayer.Border,n.APPLY_TO_BORDER)})),d=e.createAddItem(n.COPY,(function(){if(t){var e=o.GNode.serialize([t],{copy:!0,copyIgnoreProperties:i.GEditorOptions.propertiesExcludedFromCopying}),n='<gravit mimeType="'+o.GNode.MIME_TYPE+'">'+$("<div/>").text(e).html()+"</gravit>";gContainer.copyToClipboard(n)}gDesigner.stats("contextmenu_effects_copy")})),u=function(e,n){i.GEditor.tryRunTransaction(t,(function(){t.setProperty("ly",e)}),n),gDesigner.stats("contextmenu_effects_change-layer",n)};return a.setCaption(n.APPLY_TO_ELEMENT),d.setIcon("gravit-icon-copy"),s.setIcon("gravit-icon-circle"),l.setIcon("gravit-icon-fill"),c.setIcon("gravit-icon-stroke"),d.setShortcutHint([r.GKey.Constant.META,"C"]),e.addItem(a),e.addEventListener(x,function(){let e=null,i=null,r=(t=this._options&&this._options.data&&this._options.data.effect).getProperty("ly");r===o.GStylable.StyleLayer.Fill?(e="gravit-icon-fill",i=n.APPLY_TO_FILL):r===o.GStylable.StyleLayer.Border?(e="gravit-icon-stroke",i=n.APPLY_TO_BORDER):(e="gravit-icon-circle",i=n.APPLY_TO_ELEMENT),a.setIcon(e),a.setCaption(i)}.bind(this)),e.__which="effect",e},H.prototype.close=function(){this._contextMenuTouch&&this._contextMenuTouch.gOverlay("close"),this._contextMenuDesktop&&this._contextMenuDesktop.close()},H.prototype.toString=function(){return"[Object GContextMenu]"},e.exports=H},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(e){this._type=e,r.default.call(this,a.getId(e),a.getTitle(e))}o.GObject.inherit(a,r.default),a.ID="edit.select-by-paintlayer",a.getId=function(e){return"".concat(a.ID,".").concat(e)},a.getTitle=function(e){return new o.GLocaleKey("GSelectByPaintLayerAction","title.".concat(e))},a.Type={Fill:"fill",Border:"border",FillAndBorder:"fill_border"},a.prototype._type=null,a.prototype.getGroup=function(){return"edit/select-by-paintlayer"},a.prototype._getValue=function(e){switch(this._type){case a.Type.Fill:return this._getFillPatterns(e);case a.Type.Border:return this._getBorderPatterns(e);case a.Type.FillAndBorder:{const t=this._getFillPatterns(e),n=this._getBorderPatterns(e);return t===r.default.EmptyValue||n===r.default.EmptyValue?r.default.EmptyValue:{fills:t,borders:n}}default:return r.default.EmptyValue}},a.prototype._getFillPatterns=function(e){if(e.hasMixin(o.GStylable)){const t=e.getPaintLayers(),n=t&&t.getFillLayers(!0);if(n&&n.length>0)return n.map(e=>e.getProperty("_pt"))}return r.default.EmptyValue},a.prototype._getBorderPatterns=function(e){if(e.hasMixin(o.GStylable)){const t=e.getPaintLayers(),n=t&&t.getBorderLayers(!0);if(n&&n.length)return n.map(e=>e.getProperty("_pt"))}return r.default.EmptyValue},a.prototype.toString=function(){return"[Object GSelectByPaintLayerAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(){r.default.call(this,a.ID,a.TITLE)}o.GObject.inherit(a,r.default),a.ID="edit.select-by-border-width",a.TITLE=new o.GLocaleKey("GSelectByBorderWidthAction","title"),a.prototype.getGroup=function(){return"edit/select-by-style"},a.prototype._getValue=function(e){if(e.hasMixin(o.GStylable)){const t=e.getPaintLayers(),n=t&&t.getBorderLayers(!0);if(n&&n.length>0)return n.map(e=>e.getProperty("_bw"))}return r.default.EmptyValue},a.prototype.toString=function(){return"[Object GSelectByBorderWidthAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(){r.default.call(this,a.ID,a.TITLE)}o.GObject.inherit(a,r.default),a.ID="edit.select-by-transparency",a.TITLE=new o.GLocaleKey("GSelectByTransparencyAction","title"),a.prototype.getGroup=function(){return"edit/select-by-style"},a.prototype._getValue=function(e){return e.hasMixin(o.GNode.Properties)?e.getProperty("_stop"):r.default.EmptyValue},a.prototype.toString=function(){return"[Object GSelectByTransparencyAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(){r.default.call(this,a.ID,a.TITLE)}o.GObject.inherit(a,r.default),a.ID="edit.select-by-blend-mode",a.TITLE=new o.GLocaleKey("GSelectByBlendModeAction","title"),a.prototype.getGroup=function(){return"edit/select-by-style"},a.prototype._getValue=function(e){return e.hasMixin(o.GNode.Properties)?e.getProperty("_sbl"):r.default.EmptyValue},a.prototype.toString=function(){return"[Object GSelectByBlendModeAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(){r.default.call(this,a.ID,a.TITLE)}o.GObject.inherit(a,r.default),a.ID="edit.select-by-shape",a.TITLE=new o.GLocaleKey("GSelectByShapeAction","title"),a.prototype.getGroup=function(){return"edit/select-by-style"},a.prototype._getValue=function(e){return e.getNodeName()},a.prototype.toString=function(){return"[Object GSelectByShapeAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(551));function a(){r.default.call(this,a.ID,a.TITLE)}o.GObject.inherit(a,r.default),a.ID="edit.select-by-effect",a.TITLE=new o.GLocaleKey("GSelectByEffectAction","title"),a.prototype.getGroup=function(){return"edit/select-by-style"},a.prototype._getValue=function(e){if(!e.hasMixin(o.GStylable))return r.default.EmptyValue;const t=e.getEffects();return t?t.getChildren():[]},a.prototype.toString=function(){return"[Object GSelectByEffectAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(43),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.crop",s.TITLE=new i.GLocaleKey("GCropAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getIcon=function(){return"gravit-icon-crop"},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY},s.prototype.getGroup=function(){return"structure-group"},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor(),n=t.getIndividualSelection();if(n&&n.length&&n[0]instanceof i.GImage&&t.hasSelectionDetail())return n[0].isReady()}return!1},s.prototype.execute=function(e,t){var n=gDesigner.getToolManager();n.getActiveTool()instanceof o.GSubSelectTool?(n.activateTool(o.GPointerTool,null,!0),n.getActiveTool().setEditMode(o.GSelectTool.EditMode.Select)):n.getActiveTool()instanceof o.GPointerTool&&n.getActiveTool().setEditMode(o.GSelectTool.EditMode.Select)},s.prototype.toString=function(){return"[Object GCropAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(43),r=n(18),a=(n(26),n(94));function s(){}i.GObject.inherit(s,a),s.ID="modify.cancel-crop",s.TITLE=new i.GLocaleKey("GCancelCropAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getIcon=function(){return null},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY},s.prototype.getGroup=function(){return"structure-group"},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor(),n=t.getIndividualSelection();if(n&&n.length&&n[0]instanceof i.GImage&&t.hasSelectionDetail())return n[0].isReady()}return!1},s.prototype.execute=function(e,t){if(!a.prototype.isEnabled.call(this))return!1;var n=gDesigner.getActiveDocument();if(n){var r=n.getEditor().getIndividualSelection(),l=r&&r.length?r[0]:null;l&&l instanceof i.GImage&&!i.GTransform.equals(l.getTransform(),l.getImageTransform())&&o.GEditor.tryRunTransaction(l,function(){var e=l.getImageTransform();l.setProperties(["trf","ut","tl_sx"],[e,!0,0])}.bind(this),i.GLocale.get(s.TITLE))}var c=gDesigner.getToolManager();c.getActiveTool()instanceof o.GSubSelectTool?(c.activateTool(o.GPointerTool,null,!0),c.getActiveTool().setEditMode(o.GSelectTool.EditMode.Select)):c.getActiveTool()instanceof o.GPointerTool&&c.getActiveTool().setEditMode(o.GSelectTool.EditMode.Select)},s.prototype.toString=function(){return"[Object GCancelCropAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=(n(16),n(18)),a=n(94);function s(){this._title=new o.GLocaleKey("GEditElementActon","title")}o.GObject.inherit(s,a),s.ID="edit.edit",s.prototype._title=null,s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return this._title},s.prototype.getCategory=function(){return r.CATEGORY_EDIT},s.prototype.getGroup=function(){return"select"},s.prototype.getShortcut=function(){return null},s.prototype.isEnabled=function(e){if(!a.prototype.isEnabled.call(this))return!1;var t=!1;if((e=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null))&&e.length>0&&!gDesigner.getActiveDocument().getEditor().isInlineEditing())if(gDesigner.getToolManager().getActiveTool()!=gDesigner.getToolManager().getTool(i.GSubSelectTool))t=!0;else for(var n=0;n<e.length;++n)e[n]instanceof o.GText&&(t=!0);return t},s.prototype.execute=function(e){var t=!1;if((e=e||(gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null))&&e.length>0){for(var n=0;n<e.length&&!t;++n)if(e[n]instanceof o.GText){var r=e[n].getGeometryBBox(),a=gDesigner.getWindows().getActiveWindow(),s=a?a.getView():null;r&&s&&(t=gDesigner.getActiveDocument().getEditor().openInlineEditor(e[n],s,new o.GPoint(r.getX(),r.getY())))}t||gDesigner.getToolManager().getActiveTool()==gDesigner.getToolManager().getTool(i.GSubSelectTool)||gDesigner.getToolManager().activateTool(i.GSubSelectTool,null,!0)}},s.prototype.toString=function(){return"[Object GEditElementActon]"},e.exports=s},function(e,t,n){"use strict";n(28);var i=n(43),o=n(1),r=n(16),a=n(230),s=n(531),l=n(511);function c(){var e=navigator.userAgent.toLowerCase().indexOf("safari")>=0;window.hasOwnProperty("ClipboardEvent")?((navigator.userAgent.toLowerCase().indexOf("firefox")>=0||e)&&(this._pasteArea=$("<div></div>").css({overflow:"hidden",height:"1px",top:"-9999px",position:"absolute"}).prop("contenteditable",!0).prop("tabindex",-1).appendTo($("body"))),document.addEventListener("paste",this._documentPasteEvent.bind(this))):(this._pasteArea=$("<div></div>").css({overflow:"hidden",height:"1px",top:"-9999px",position:"absolute"}).prop("contenteditable",!0).prop("tabindex",-1).appendTo($("body")),this._pasteArea[0].addEventListener("paste",this._documentPasteEvent.bind(this))),this._pasteArea&&this._pasteArea.on("focus",()=>{gDesigner.getWindows()&&(this._allowFocus||(this._pasteArea.blur(),gDesigner.getWindows().getActiveWindow()&&gDesigner.getWindows().getActiveWindow().getView().focus()))})}o.GObject.inherit(c,o.GObject),c.prototype._pasteArea=null,c.prototype._allowFocus=!1,c.prototype._callback=null,c.prototype._documentPasteEvent=function(e){if(!this._canTrigger())return!1;if(!document.activeElement||!$(document.activeElement).is(":editable")||this._pasteArea&&document.activeElement===this._pasteArea[0]||gDesigner.isGravitIME(document.activeElement)){var t=e.clipboardData;if(e.clipboardData&&e.clipboardData.items&&e.clipboardData.items.length){for(var n=t.items,i={},a=0;a<n.length;a++){var s=null;switch(d=n[a].type){case"image/png":case"image/jpeg":case"image/gif":case"application/pdf":s=n[a].getAsFile();break;default:s=t.getData(d)||null}s&&(i[d]=s)}this._handlePasteData(i),r.GPlatform.webBrowser===r.GPlatform.constructor.WebBrowser.Firefox&&(e.stopPropagation(),e.preventDefault())}else if(this._pasteArea){i={};var l=0;if(t.types&&t.types.length){var c=t.types;for(a=0;a<c.length;a++){var d;if("public.file-url"===(d=c[a])&&t.files&&l<t.files.length){var u=t.files[l++];u&&(i[u.type]=u)}else{(s=t.getData(d))&&(i[d]=s)}}}setTimeout(function(){var e=this._pasteArea.children();if(1===e.length&&e.is("img")){var t=o.GUtil.dataUrlToBlob(e[0].src);t&&(i[t.type]=t)}this._handlePasteData(i),this._pasteArea.empty()}.bind(this),1)}this._pasteArea&&(this._allowFocus=!1,this._pasteArea.blur(),gDesigner.getWindows().getActiveWindow()&&gDesigner.getWindows().getActiveWindow().getView().focus())}},c.prototype._canTrigger=function(){var e=gDesigner.getActiveDocument();const t=e&&e.getEditor();if(t&&t.isInlineEditing()){const e=this._filterForInlineEditing(t.getSelection());if(e&&1===e.length&&e[0]instanceof o.GText)return!0}return!(!e||gDesigner.getRightSidebars().getActiveSidebar()==l.ID)},c.prototype.handlePasteData=function(e){return this._handlePasteData(e)},c.prototype._handlePasteData=function(e){if(!this._canTrigger())return!1;for(var t=!this._callback,n=["text/xml","text/plain"],r=gDesigner.getActiveDocument(),l=r.getEditor(),c=0;c<n.length;++c){var d=e[n[c]];if(d)try{var u=$.parseXML(d);if(u){if("svg"===u.documentElement.nodeName){e["image/svg+xml"]=new Blob([d],{type:"image/svg+xml"});break}if("gravit"===u.documentElement.nodeName&&u.documentElement.hasAttribute("mimeType")){if(u.documentElement.hasAttribute("restricted")){let e=u.documentElement.getAttribute("restricted");if(e&&"false"!=e&&(!r.getStorageItem()||r.getStorageItem().getId()!=e))return}e[u.documentElement.getAttribute("mimeType")]=$("<div/>").html(u.documentElement.textContent).text()}}}catch(e){}if(e[o.GNode.MIME_TYPE]){var p=o.GNode.deserialize(e[o.GNode.MIME_TYPE]),g=p instanceof o.GPage,h=r.filterUnrestrictedCommercialFileElements(g?p.getChildren():p);if(h&&h.length>0||g){var f=h.filter((function(e){return e instanceof o.GElement})),m=h.filter((function(e){return e instanceof o.GStyle})),y=1===h.length&&h[0]instanceof o.GText&&l.hasSelection()&&l.getSelection()[0]instanceof o.GText&&l.isInlineEditing();if(y||0==f.length&&1==h.length&&!g){var v=h[0];l.beginTransaction();try{if(y){if(!i.GInlineTextEditor.HANDLECOPYPASTE){var _=l.getSelection()[0];i.GElementEditor.getEditor(_).processPaste(v)}}else if(v instanceof o.GStylable.FillPaintLayer||v instanceof o.GStylable.BorderPaintLayer){f=l.getSelection();0!=(f=this._filterForStyleExceptions(f)).length&&(f.length>1?f.forEach((function(e){var t=v instanceof o.GStylable.FillPaintLayer?new o.GStylable.FillPaintLayer:new o.GStylable.BorderPaintLayer;t.assignFrom(v),e.getPaintLayers().appendChild(t)})):f[0].getPaintLayers().appendChild(v))}else if(v instanceof o.GStylable.Effect){f=l.getSelection();0!=(f=this._filterForStyleExceptions(f)).length&&(f.length>1?f.forEach((function(e){var t=new o.GStylable.Effect;t.assignFrom(v),e.getEffects().appendChild(t)})):f[0].getEffects().appendChild(v))}}finally{l.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPaste","action.paste")))}}else{var b=r.getScene().getStyles();if(f.length>0||g){t&&l.beginTransaction();try{for(var w=0;w<m.length;++w){let e=m[w],t=e.getReferenceId(),n=null;for(var C=b.getFirstChild();null!==C;C=C.getNext())if(C.arePropertiesEqual(e,["ps","defaultStyle"])&&C.equalsStyle(e)){n=C;break}n||(n=new o.GStyle,n.setProperties(["name","defaultStyle","ps"],[e.getProperty("name"),!1,e.getProperty("ps")]),n.assignStyleFrom(e),r.getScene().getStyles().insertChild(n));for(var E=0;E<f.length;++E){let e=f[E];e.hasProperty("sref")&&e.getProperty("sref")===t&&e.setProperty("sref",n.getReferenceId())}}if(!this.executeCallback(f)){var S=gDesigner.getActiveDocument().getScene();g?(p.clearChildren(),p.setProperty("off",null),S.appendChild(p),f.length>0&&l.insertElements(f,!0,!0,!1,!0,p),S.setActivePage(p)):l.insertElements(f,!0,!0,!0,!0),S.isFixedSized()||this._centerToView(!0)}}finally{t&&l.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPaste","action.paste")))}}}}return}if(d){var G,A=a.getProviderInstance(s),T=gDesigner.getWorkspace()&&gDesigner.getWorkspace().getFontManager()&&gDesigner.getWorkspace().getFontManager().getDefaultFont()&&gDesigner.getWorkspace().getFontManager().getDefaultFont().getFamily();const e=this._filterForInlineEditing(l.getSelection());if(e&&e.length>0&&e[0]instanceof o.GText&&l.isInlineEditing()){if(!i.GInlineTextEditor.HANDLECOPYPASTE){var P=e[0];return void i.GElementEditor.getEditor(P).processPaste(d)}}else{(P=new o.GText).setText(d,!0,!0),t&&l.beginTransaction();try{if(!this.executeCallback([P],!0)){if(l.insertElements([P],!1,!0,!0),(G=A&&A.getDefaultFamilyForString(d))&&G!==T){var L=o.GOpenTypeFont.getDirectionForString(d);L!==o.GTLDirectionTextTransformer.LTR?P.setProperties(["_tff","dir","_we"],[G,L,!0]):P.setProperties(["_tff","_we"],[G,!0])}else P.setProperty("_we",!0);i.GElementEditor.getEditor(P).invalidateTextWidth(),this._centerToView()}}finally{return void(t&&l.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPaste","action.paste"))))}}}}for(var D=["image/svg+xml","image/png","image/jpg","image/gif","application/pdf"],x=0;x<D.length;++x){var I=D[x];if(e[I]){t&&l.beginTransaction();try{r.placeOrImport(e[I],null,!1,!0,this.executeCallback.bind(this))}finally{t&&l.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPaste","action.paste-image")))}return}}},c.prototype._filterForInlineEditing=function(e){return e?e.filter(e=>!(e instanceof o.GCollaborativeTextAnnotation)):null},c.prototype._filterForStyleExceptions=function(e){for(var t=[o.GPage,o.GGroup,o.GSymbol],n=[],i=0;i<e.length;i++){for(var r=e[i],a=!0,s=0;s<t.length;s++){if(r instanceof t[s]){a=!1;break}}a&&n.push(r)}return n},c.prototype._centerToView=function(e){var t,n,r=gDesigner.getActiveDocument().getEditor(),a=gDesigner.getActiveDocument().getScene(),s=gDesigner.getWindows().getActiveWindow(),l=a.getActivePage();if(n=a.isFixedSized()?l.getGeometryBBox():a.getPaintBBox(),s){var c=s.getView(),d=c.getViewTransform(l),u=o.GPaintCanvas.getScreenDPI(),p=c.getViewBox().scaled(u,u);t=d.mapRect(p),a.isFixedSized()&&(t=t.intersected(n)),t.isEmpty()&&(t=n)}else t=n;r.arrangeAlign(i.GEditor.ArrangeAlignType.AlignCenter,null,!0,t,!0,e),r.arrangeAlign(i.GEditor.ArrangeAlignType.AlignMiddle,null,!0,t,!0,e)},c.prototype.getArea=function(){return this._pasteArea},c.prototype.setAllowFocus=function(e){this._allowFocus=e},c.prototype.getAllowFocus=function(){return this._allowFocus},c.prototype.assignCallback=function(e){this._callback=e},c.prototype.executeCallback=function(e,t){return!!this._callback&&(this._callback(e,t),this._callback=null,!0)},e.exports=c},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(18),s=n(94);n(724);function l(){}i.GObject.inherit(l,s),l.USE_DPI=!0,l.ID="modify.path2bmp",l.TITLE=new i.GLocaleKey("GConvertToImageAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-flatten":""},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY},l.prototype.getGroup=function(){return"structure-bitmap"},l.prototype.getShortcut=function(){return[o.GKey.Constant.F7]},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null;if(e)for(var t=0;t<e.length;++t)if(e[t]instanceof i.GElement&&e[t].getPaintBBox()&&!e[t].getPaintBBox().isEmpty())return!0;return!1},l.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?i.GNode.order(t.getIndividualSelection().slice()):null,o=[];if(n)for(var r=0;r<n.length;++r)n[r]instanceof i.GElement&&n[r].getPaintBBox()&&!n[r].getPaintBBox().isEmpty()&&o.push(n[r]);if(o.length){t.beginTransaction(),t.clearSelection();try{var a=this._groupStuff(o);if(a){var s=a.getParent(),l=a.getNext(),c=this._convertToImage(a);c&&(s.insertChild(c,l),s.removeChild(a),t.updateSelection(!1,[c]))}}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}},l.prototype._groupStuff=function(e){if(e&&1===e.length)return e[0];for(var t=gDesigner.getActiveDocument(),n=t?t.getEditor():null,o=new i.GGroup,a=[],s=0;s<e.length;++s){(g=e[s]).validateInsertion(o)&&a.push(g)}if(a.length>0){var l,c=a[a.length-1],d=c.getParent(),u=c.getNext();if(!d.isLocked()&&o.validateInsertion(d)){d.insertChild(o,u);var p=gDesigner.getActiveDocument().getScene();try{l=new Set;for(s=0;s<a.length;++s)l.add(a[s].getParent());(0,r.blockChanges)(n,l,p,o);for(s=0;s<a.length;++s){var g;(g=a[s]).getParent().removeChild(g),o.appendChild(g)}}finally{(0,r.releaseChanges)(n,l,p,o)}}}return o},l.prototype._convertToImage=function(e){var t,n;e instanceof i.GImage||(t=i.GPaintCanvas.getScreenDPI()*i.GLength.DPI),e instanceof i.GElement&&(n=e.getScene()),e instanceof i.GImage||(t=Math.max(t||i.GLength.DPI,n&&n.getProperty("dpi")||i.GLength.DPI));var o=e.toBitmap(null,null,null,null,null,t),r=new i.GImage,a=1;e instanceof i.GImage||(a/=t/i.GLength.DPI);var s=e.getPaintBBox().getSide(i.GRect.Side.TOP_LEFT),l=(new i.GTransform).scaled(a,a).translated(s.getX(),s.getY());return r.setProperties(["iw","ih","url","trf","itrf"],[o.getWidth(),o.getHeight(),o.toImageDataUrl(i.GBitmap.ImageType.PNG),l,l]),r},l.prototype.toString=function(){return"[Object GConvertToImageAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="edit.duplicate",s.TITLE=new i.GLocaleKey("GDuplicateAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT},s.prototype.getGroup=function(){return"ccp"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"D"]},s.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-duplicate":null},s.prototype.getAdditionalShortcuts=function(){return[[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"D"]]},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();return e&&null!=e.getEditor().getSelection()},s.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor();e.beginTransaction();try{e.cloneSelection(!1,!0)}finally{e.commitTransaction(i.GLocale.get(this.getTitle()))}},s.prototype.toString=function(){return"[Object GDuplicateAction]"},e.exports=s},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(18),s=n(94);function l(){}i.GObject.inherit(l,s),l.ID="modify.createnestedcompound",l.TITLE=new i.GLocaleKey("GCreateNestedCompoundAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY},l.prototype.getGroup=function(){return"structure-boolean"},l.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.ALT_LEFT,"M"]},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-nested-compound":""},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection(),n=0;if(t&&t.length)for(var o=0;o<t.length;++o){if(t[o]instanceof i.GCompoundShape&&n++,n>=2)return!0}}return!1},l.prototype.execute=function(){var e=gDesigner.getActiveDocument().getEditor(),t=i.GNode.order(e.getIndividualSelection().slice());e.beginTransaction();try{for(var n,o=[],a=new Set,s=0;s<t.length;++s){(l=t[s])instanceof i.GCompoundShape&&(n?(o.push(l),a.add(l.getParent())):n=l)}if(o.length>0){try{(0,r.blockChanges)(e,a,null,n);for(s=0;s<o.length;++s){var l;(l=o[s]).getParent().removeChild(l),n.appendChild(l)}}finally{(0,r.releaseChanges)(e,a,null,n)}e.updateSelection(!1,[n])}}finally{e.commitTransaction("Create nested compound")}},l.prototype.toString=function(){return"[Object GCreateNestedCompoundAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(1071);function r(){}i.GObject.inherit(r,o),r.ID="modify.offset",r.TITLE=new i.GLocaleKey("GOffsetAction","title"),r.prototype.getId=function(){return r.ID},r.prototype.getTitle=function(){return r.TITLE},r.prototype.getGroup=function(){return"structure/modify"},r.prototype.getShortcut=function(){return null},r.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-expand-shrink":null},r.prototype._dialogPromptMessage=function(){return i.GLocale.get(new i.GLocaleKey("GOffsetAction","text.dialog-prompt-message"))},r.prototype._makeOffsetter=function(e,t){var n;if(t.hasMixin(i.GStylable)){var o=t.getPaintLayers();if(o){var r=o.getBorderLayers(!0).pop();r&&(n=r.$_blc)}}return t=i.GPathUtil.makeClockWise(t),e>0?new i.GVertexOffsetter(t,e,!1,!0,0,n):new i.GVertexOffsetter(t,-e,!0,!1,0,n)},r.prototype._dialogAlertMessage=function(){return i.GLocale.get(new i.GLocaleKey("GOffsetAction","text.invalid-value"))},r.prototype.toString=function(){return"[Object GOffsetAction]"},e.exports=r},function(e,t,n){"use strict";n(774),n(168),n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(18),s=n(94),l=n(36);function c(){}i.GObject.inherit(c,s),c.ID="modify.simplify",c.TITLE=new i.GLocaleKey("GSimplifyAction","title"),c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},c.prototype.getGroup=function(){return"structure/modify"},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-simplity":null},c.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.OPTION,"S"]},c.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getIndividualSelection():null,t=!1;if(e)for(var n=0;!t&&n<e.length;++n)e[n]instanceof i.GImage||!e[n].hasMixin(i.GVertexSource)||(t=!0);return t},c.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getIndividualSelection():null,o=e?e.getScene():null,a=[];if(n)for(var s=0;s<n.length;++s){var c=n[s];c.hasMixin(i.GVertexSource)&&a.push(c)}if(a.length){var d=$("<div></div>").append($("<div>").gInputSlider({min:0,max:100,step:1}).attr("name","tolerance").css("width","50%").gInputSlider("value",10).on("change",(function(e){if(o){var t=Number(o.stringToPoint($(this).gInputSlider("value")).toFixed(0));$(this).parent().find("input").val(t)}}))).append($("<span>").css("width","50%").append($("<input>").attr("type","text").css("width","3em").val(10).on("change",(function(e){var t=Number(o.stringToPoint($(this).val()).toFixed(0));$(this).parent().find(".g-input-slider").gInputSlider("value",t)}))).append($("<label>").html(i.GLocale.get(new i.GLocaleKey("GSimplifyAction","text.tolerance")))));l.prompt(i.GLocale.get(new i.GLocaleKey("GSimplifyAction","text.simplification")),e=>{if(e){var n=parseFloat(d.find(".g-input-slider").gInputSlider("value"));if(isNaN(n)||!isFinite(n)||i.GMath.isEqualEps(n,0))l.alert(i.GLocale.get(new i.GLocaleKey("GSimplifyAction","text.invalid-value")));else{t.beginTransaction();try{for(var o=[],s=new Set,c=0;c<a.length;++c){var u=a[c].getParent();u&&s.add(u)}try{(0,r.blockChanges)(t,s);for(c=0;c<a.length;++c){var p=a[c],g=p.getParent(),h=p.getNext(),f=this._makeSimplified(n,p),m=i.GPathUtil.createPathFromVertexSource(f);m&&(i.GElement.prototype.assignFrom.call(m,p),g.insertChild(m,h),o.push(m)),g.removeChild(p)}}finally{(0,r.releaseChanges)(t,s),o.length&&t.updateSelection(!1,o)}}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}}},d)}},c.prototype._makeSimplified=function(e,t){var n=e>0?e:-e;return new i.GVertexSimplifier(t).simplify(n/2,!1,!0)},c.prototype.toString=function(){return"[Object GSimplifyAction]"},e.exports=c},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(43),o=n(1),r=n(32),a=n(18),s=n(94);function l(){}o.GObject.inherit(l,s),l.ID="modify.split-line",l.TITLE=new o.GLocaleKey("GSplitLineAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},l.prototype.getGroup=function(){return"structure/path"},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-break-curve":null},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null,t=!1;if(e)for(var n=0;!t&&n<e.length;++n)e[n]instanceof o.GPath&&(t=this._isPathSplittable(e[n]));return t},l.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getSelection():null,i=[];if(n)for(var a=0;a<n.length;++a){var s=n[a];s instanceof o.GPath&&this._isPathSplittable(s)&&i.push(s)}if(i.length){t.beginTransaction();try{var l,c=[];l=new Set;for(a=0;a<i.length;++a)l.add(i[a].getParent());try{(0,r.blockChanges)(t,l);for(a=0;a<i.length;++a){var d,u=i[a],p=u.getParent(),g=u.getNext(),h=u.getAnchorPoints(),f=!1;if(u.getProperty("closed"))for(d=h.getFirstChild();null!==d&&!d.hasFlag(o.GNode.Flag.Selected);d=d.getNext());else(d=h.getFirstChild()).hasFlag(o.GNode.Flag.Selected)||(f=!0);var m=d,y=m,v=m?m.getNext()||m.getPrevious():null,_=!1;for(u.getProperty("closed")&&(_=!0);null!==m&&(m.hasFlag(o.GNode.Flag.Selected)||f)&&null!==v;){var b,w=new o.GPath,C=w.getAnchorPoints();if(f=!1,w.assignFrom(u),p.insertChild(w,g),c.push(w),d=h.getNextPoint(m),_)(b=new o.GPathBase.AnchorPoint).deserialize(m.serialize()),m=b,_=!1;else h.removeChild(m);for(C.appendChild(m);null!==d&&!d.hasFlag(o.GNode.Flag.Selected)&&h.getFirstChild();)v=h.getNextPoint(d),h.removeChild(d),C.appendChild(d),d=v;if(null!==d&&d.hasFlag(o.GNode.Flag.Selected)&&h.getFirstChild())(b=new o.GPathBase.AnchorPoint).deserialize(d.serialize()),C.appendChild(b),v=(m=d)===y?null:h.getNextPoint(d);else v=null;w.isLine()&&(w.getPaintLayers().getBorderLayers(!0).length||(u.getPaintLayers().getFillLayers(!0).length?w.getPaintLayers().appendChild(new o.GStylable.BorderPaintLayer(o.GRGBColor.BLACK)):w.getPaintLayers().appendChild(u.getPaintLayers().getFillLayers(!0)[0])))}p.removeChild(u)}}finally{(0,r.releaseChanges)(t,l),c.length&&t.updateSelection(!1,c.slice(-1))}}finally{t.commitTransaction(o.GLocale.get(this.getTitle()))}}},l.prototype._isPathSplittable=function(e){var t=!1,n=i.GElementEditor.getEditor(e),o=n?n.getPartSelection():null;if(o&&o.length)for(var r=0;!t&&r<o.length;++r)o[r].type==i.GPathEditor.PartType.Point&&(e.getProperty("closed")||o[r].point!=e.getAnchorPoints().getFirstChild()&&o[r].point!=e.getAnchorPoints().getLastChild())&&(t=!0);return t},l.prototype.toString=function(){return"[Object GSplitLineAction]"},e.exports=l},function(e,t,n){"use strict";n(19),n(24),n(3);var i=n(1),o=n(16),r=n(32),a=n(18),s=n(94);function l(){}i.GObject.inherit(l,s),l.ID="modify.converttorawpath",l.TITLE=new i.GLocaleKey("GConvertToRawPathAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_MODIFY_PATH},l.prototype.getGroup=function(){return"structure/modify"},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-convert-to-raw-path":null},l.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.SHIFT,"R"]},l.prototype._isValidElement=function(e){if(e instanceof i.GPath||e instanceof i.GCompoundPath){var t=[];if(e instanceof i.GCompoundPath)for(var n=e.getPaths().getFirstChild();null!==n;n=n.getNext())t.push(n);else t=[e];for(var o=0;o<t.length;o++)for(var r=t[o].getAnchorPoints().getFirstChild();r;){if(i.GPathBase.isCornerType(r.getProperty("tp")))return!0;r=r.getNext()}return!1}return!(!e.hasMixin(i.GVertexSource)||e instanceof i.GImage||e instanceof i.GPathsGraph)},l.prototype.isEnabled=function(){if(!s.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t)for(var n=0;n<t.length;++n)if(this._isValidElement(t[n]))return!0}return!1},l.prototype.execute=function(){var e,t=gDesigner.getActiveDocument(),n=t?t.getEditor():null,o=n?n.getIndividualSelection():null,a=[],s=new Set;if(o)for(var l=0;l<o.length;++l){var c=o[l];this._isValidElement(c)&&(a.push(c),s.add(c.getParent()))}n.beginTransaction();try{try{(0,r.blockChanges)(n,s),e=[];for(l=0;l<a.length;++l){var d=a[l],u=d.getParent(),p=d.getNext(),g=i.GPathUtil.createPathFromVertexSource(d);g&&(i.GElement.prototype.assignFrom.call(g,d),u.insertChild(g,p),e.push(g)),u.removeChild(d)}}finally{(0,r.releaseChanges)(n,s),e.length&&n.updateSelection(!1,e)}}finally{n.commitTransaction(i.GLocale.get(this.getTitle()))}},l.prototype.toString=function(){return"[Object GConvertToRawPathAction]"},e.exports=l},function(e,t,n){"use strict";n(25),n(3);var i=n(1);function o(e,t){this.notification=Object.assign({popup:!1,annonymous:!1},e||{}),this.builder=t}i.GObject.inherit(o,i.GEvent),o.prototype.notification=null,o.prototype.toString=function(){return"GEvent [GNotificationEvent]"},e.exports=o},function(e,t,n){"use strict";var i=n(17);n(19),n(24),n(9),n(111),n(90),n(14),n(29),n(25),n(28),n(3);var o=n(1),r=i(n(231)),a=i(n(385)),s=n(32);const l=n(36),c=n(264),d=n(78),u=n(200),p=n(202),g=n(352),h=n(1206),f=n(77),{DESIGNER:m,SHARE_ENGINE:y,HAS_ANNOTATIONS:v,gApi:_,ShareRoles:b,SharePermissions:w,Share:C,LEGACY_SHARE_DIALOG:E,ENABLE_REQUEST_ACCESS:S}=n(12),G=n(386),A=n(1207),T=n(175),P=n(1434),L=n(777),D=n(1072),x=n(216),I=n(E?1435:1436);function O(){y&&(gDesigner.addEventListener(c,this._userEvent,this),gDesigner.addEventListener(d,this._documentEvent,this)),this._states=new Map,this._isDefaulNotificationAlreadyShown=new Map}O.prototype._states=null,O.prototype._requestAccessDialog=null,O.prototype._requestPermissionDialog=null,O.prototype._requestEmailHasBeenSent=!1,O.prototype._collaboratorsCached={},O.prototype.share=function(e,t){const n=this,i=e instanceof x.Item,o=async function(){let o=null;if(i)o=e;else{const t=e||gDesigner.getActiveDocument();o=t&&t.getStorageItem()}o.supportsExternalSharing()&&await n._syncExternalPermissions(o),n._openShareDialog(await gDesigner.getUser(),o,t)};gDesigner.isOffline()?r.default.openUnavailableFeature(o):this.isShareProRestricted()?gDesigner.handlePROFeatureInterruption():o()},O.prototype._openShareDialog=async function(e,t,n){const i=new I(e,t,n);await i.open()},O.prototype._documentEvent=async function(e){const t=e.document;if(!t||!t.isLockedByVersionHistory())switch(e.type){case d.Type.Activated:await this._checkAccessAndUpdateState(t)&&(this._showDefaultNotification(t),t.removeEventListener(g,this._collaborationEvent,this),t.addEventListener(g,this._collaborationEvent,this));break;case d.Type.Deactivated:t.removeEventListener(g,this._collaborationEvent,this);break;case d.Type.Removed:t.getId()&&delete this._collaboratorsCached[t.getId()],this._states.delete(t);break;case d.Type.StorageItemUpdated:{t.isShareable()&&t.lock();const e=async n=>{if(n.status!==f.Loading)try{t.removeEventListener(u,e),await this._checkAccessAndUpdateState(t)&&this._showDefaultNotification(t)}finally{t.unlock()}};t.addEventListener(u,e);break}}},O.prototype.isPermissionRequestEnabled=function(){return S&&!gDesigner.getLicense().isGuest()},O.prototype.getRole=function(e){e=e||gDesigner.getActiveDocument();const{role:t}=this._getState(e);return t||G.ROLES.NO_ACCESS_ROLE},O.prototype._collaborationEvent=async function(e){const{sender:t,type:n}=e;if(t===gDesigner.getActiveDocument())switch(n){case g.Type.ShareUpdate:this.resetCollaboratorsCached(t),this._getState(t).sharing||await this._updateState(t);const e=this.getRole(t);if(await this._checkAccessAndUpdateState(t)){const n=this.getRole(t);e.equals(n)||t.getStatus()!==f.Loading&&this._showRoleNotification(t)}break;case g.Type.UserUpdate:this._updateRealtimeCollaborators(t)}},O.prototype._userEvent=async function(){const e=gDesigner.getActiveDocument();e&&(await this._updateState(e),this._showDefaultNotification(e))},O.prototype._showRoleNotification=function(e){if(!e)return;const t=this.getRole(e);if(!t)return;const n=o.GLocale.get(new o.GLocaleKey("GShareManager","text.new-role-is-".concat(t.getId())));n&&gDesigner.addNotification({document:e,message:n,anonymous:gDesigner.isAnonymous(),popup:!0})},O.prototype._showDefaultNotification=async function(e){if(!e)return;if(void 0===this._isDefaulNotificationAlreadyShown.get(e.sessionId)&&this._isDefaulNotificationAlreadyShown.set(e.sessionId,!1),this._isDefaulNotificationAlreadyShown.get(e.sessionId))return;const t=e.isDocumentFromTemplate()&&e.isShared();let n;if(t)n={name:m.TITLE};else{const t=await gDesigner.getUser(),i=await this._getFileExtended(e);if(t&&i){i.getPrivateShareList().some(e=>{if(e.owner&&e.id!==t.getUID())return n={name:e.name||e.email,id:e.id},!0});const e=new URL(location.href).searchParams.get("token");if(e){const o=i.getPublicShare();if(o&&o.token===e){const e=o.shared_by;e&&e.id&&e.id!==t.getUID()&&(n=e)}}}}if(n){e.setOwner(n);const i=[];if(t)i.push(o.GLocale.get(new o.GLocaleKey("GShareManager","text.template-shared-by")).replace("%name",n.name));else if(i.push(o.GLocale.get(new o.GLocaleKey("GShareManager","text.shared-by")).replace("%name",n.name)),!E){const t=this.getRole(e);t&&t.getStatus()&&i.push(t.getStatus())}if(E){const t=this._getState(e);t.copy||t.inspect?(t.copy||i.push(o.GLocale.get(new o.GLocaleKey("GShareManager","text.save-warning"))),t.inspect||i.push(o.GLocale.get(new o.GLocaleKey("GShareManager","text.inspect-warning")))):i.push(o.GLocale.get(new o.GLocaleKey("GShareManager","text.combined-warnings")))}i.length&&gDesigner.addNotification({document:e,message:i.join(" "),anonymous:gDesigner.isAnonymous(),popup:!0,closeCallback:()=>{this._isDefaulNotificationAlreadyShown.set(e.sessionId,!0)}})}},O.prototype._canAccess=async function(e){return!!await this._getFileExtended(e).catch(()=>!1)},O.prototype.getRealtimeCollaborators=async function(e){return _.realtime.getCollaborators(e.id,{anonymous:!1}).then(t=>t.map(t=>{const n=(t=>{const n=e.getPrivateShare(t.access_id);if(n)return G.makeFromShare(n);const i=e.getPublicShare();return i?G.makeFromShare(i):G.makeFromShareRole(b.NoAccess)})(t);return new A(Object.assign(t,{role:n}))})).catch(()=>[])},O.prototype._getFileExtended=function(e){return gDesigner.getCloudCommunicationManager().getFileExtendedCached(e)},O.prototype._getCollaborators=async function(e){const t=await this._getFileExtended(e);if(!t)return null;let n=[];return n=n.concat(await this._getFileCollaboratorsAsUsers(t)),n=n.concat(this._getInvitedCollaboratorsAsUsers(t)),n},O.prototype._getInvitedCollaboratorsAsUsers=function(e){return e.getInvitedShareList().map(e=>{const t=G.makeFromShare(e),n=new T({id:e.email});return n.setRole(t),n})},O.prototype._getFileCollaboratorsAsUsers=function(e){return gDesigner.getCloudCommunicationManager().getCollaborators(e.id).then(t=>t.map(t=>{const n=new T(t),i=(t=>{const n=e.getPrivateShare(t.getUID());if(n)return G.makeFromShare(n);const i=e.getPublicShare();return i?G.makeFromShare(i):G.makeFromShareRole(b.NoAccess)})(n);return n.setRole(i),n})).catch(()=>[])},O.prototype.resetCollaboratorsCached=function(e){if((e=e||gDesigner.getActiveDocument())&&e.getId()){const t=this._collaboratorsCached[e.getId()];t&&t.reset()}},O.prototype.getCollaboratorsCached=async function(e){return(e=e||gDesigner.getActiveDocument())&&e.getId()?(this._collaboratorsCached[e.getId()]||(this._collaboratorsCached[e.getId()]=new D(()=>this._getCollaborators(e))),this._collaboratorsCached[e.getId()].get()):[]},O.prototype.getPrivateInvitedShareList=async function(e){const t=await this._getFileExtended(e);return this._getPrivateInvitedShareListForFile(t)},O.prototype.getRoleNameByUserId=async function(e){const t=gDesigner.getActiveDocument();if(!t.isCloudFile()&&!t.isExternalFile())return G.ROLES.OWNER_ROLE.getName();const n=await this.getCollaboratorById(e);return(n&&n.getRole()||G.ROLES.NO_ACCESS_ROLE).getName()},O.prototype.getCollaboratorById=async function(e){let t=null;const n=await this.getCollaboratorsCached();return n&&(t=n.find(t=>t.getUID()===e)),t},O.prototype._getPrivateInvitedShareListForFile=function(e){if(!e)return null;const t=e.getPrivateShareList(),n=e.getInvitedShareList&&e.getInvitedShareList()||[];return t.concat(n)},O.prototype.updateStateForDocument=function(e){this._updateState(e)},O.prototype._updateState=async function(e){const t=this._createDefaultShareStateForDoc(e),n=e&&e.getStorageItem(),i=await gDesigner.getUser();if(!i)return this._setState(e,t);if(e&&e.isDocumentFromTemplate()&&e.isShared())this._applyStateFromTemplate(t);else if(n instanceof p.Item){const n=await this._getFileExtended(e);n&&await this._applyStateFromFile(i,n,t)}else if(n&&n.getId()&&n.supportsSharing()&&n.supportsShadowFile()){const n=await this._getFileExtended(e);n&&(t.share=!0,await this._applyStateFromFile(i,n,t))}else await this._getFileExtended(e);this._setState(e,t),gDesigner.hasEventListeners(L)&&gDesigner.trigger(new L(L.Type.Updated))},O.prototype._createDefaultShareStateForDoc=function(e){return new P(Object.assign({},this._getState(e),{owner:!0,share:!1,sharing:!1,role:G.ROLES.OWNER_ROLE,isPrivate:!0}))},O.prototype._applyStateFromTemplate=function(e){return Object.assign(e,{edit:!0,inspect:!0,copy:!0,comment:!1,share:!1,owner:!1,sharing:!1,realtimeCollaborators:[]})},O.prototype._applyStateFromFile=async function(e,t,n){if(!t)throw new a.default("File object is required");const i=(0,s.getFileStateAndRole)(e,t,n);let o=i.role;const{state:r}=i;if(!o){const e=t.getPublicShare();if(e){const{copy:t,inspect:n,comment:i,edit:a}=e;o=G.makeFromShare(e),Object.assign(r,{owner:!1,edit:a,copy:t,inspect:n,comment:!!v&&i})}}r.role=o||G.ROLES.NO_ACCESS_ROLE;const l=await this.getRealtimeCollaborators(t);Object.assign(r,{realtimeCollaborators:l})},O.prototype._updateRealtimeCollaborators=async function(e){const t=await this._getFileExtended(e);if(t){const n=await this.getRealtimeCollaborators(t);this._setState(e,new P(Object.assign({},this._getState(e),{realtimeCollaborators:n})))}},O.prototype._setState=function(e,t){this._states.set(e,t),gDesigner.hasEventListeners(h)&&gDesigner.trigger(new h(e,t))},O.prototype._getState=function(e){return this._states.get(e)||new P},O.prototype._checkAccessAndUpdateState=async function(e){if(!await this._requestAccessIfAbsent(e))return!1;this._closeRequestAccessDialog();const t=this.getRole(e);await this._updateState(e);const n=this.getRole(e);return t&&t.equals(n)||this._requestPermissionToCommentIfAbsent(e),await this._isUserUnableToOperateSystem(e)&&this._openRequestAccessDialog(e),!0},O.prototype._isUserUnableToOperateSystem=async function(e){if(!e.getId())return!1;var t=await this._getShareLevelForCurrentUser(e);return!!(gDesigner.getLicense().isGuest()&&t<1)},O.prototype._getShareLevelForCurrentUser=async function(e){const t=await gDesigner.getUser(),n=await this._getFileExtended(e);if(t&&n){var i=n.getPrivateShareList().find(e=>{if(e.id===t.getUID())return!0});if(i)return i.getRole().level;const e=n.getPublicShare();return e?e.getRole().level:new G.makeFromShareRole(b.NoAccess)}return new G.makeFromShareRole(b.NoAccess).level},O.prototype._requestAccessIfAbsent=async function(e){return!e.isShareable()||(!!await this._canAccess(e)||(this._openRequestAccessDialog(e),!1))},O.prototype._requestPermissionToCommentIfAbsent=function(e){if(!e.isShareable())return;if(!e.getFocusAnnotationId())return;const t=this.getRole(e);t&&t.is(b.Owner)||t.hasPermission(w.COMMENT)||this._requestPermissionToComment(e)},O.prototype._requestPermissionToComment=function(e){if(this._requestPermissionDialog)return;const t=this.getRole(e);t&&!t.is(b.NoAccess)&&(this._requestPermissionDialog=this._createRequestDialog(e,{className:"g-request-permission-dialog",openCallback:()=>{gDesigner.stats("permission-dialog_comment-access_open")},closeCallback:()=>{this._requestPermissionDialog=null},title:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-can-not-be-commented-title")).replace("%role",t.getName()),subtitle:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-can-not-be-commented-info")),requestButton:{label:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-request-permission-to-comment")),permissions:{comment:!0}},statType:"comment-access"}))},O.prototype._openRequestAccessDialog=function(e){this._requestAccessDialog||(this._requestAccessDialog=this._createRequestDialog(e,{className:"g-request-access-dialog",openCallback:()=>{gDesigner.stats("permission-dialog_no-access_open")},closeCallback:async()=>{this._requestAccessDialog=null,await this._canAccess(e)||(gDesigner.removeDocument(e,null,!0),this._requestEmailHasBeenSent&&(l.alert(o.GLocale.get(new o.GLocaleKey("GShareManager","text.sent-request-email"))),this._requestEmailHasBeenSent=!1))},title:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-can-not-be-accessed-title")),subtitle:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-can-not-be-accessed-info")),requestButton:{label:o.GLocale.get(new o.GLocaleKey("GShareManager","text.file-request-access")),permissions:{access:!0}},statType:"no-access"}))},O.prototype._closeRequestAccessDialog=function(){this._requestAccessDialog&&(this._requestAccessDialog.gDialog("close"),this._requestAccessDialog=null)},O.prototype._createRequestDialog=function(e){let{className:t="",title:n,subtitle:i,closeCallback:r,requestButton:{label:a,permissions:s={}}={},statType:c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var d=[];return this.isPermissionRequestEnabled()&&d.push({label:a,onclick:t=>{gDesigner.stats("permission-dialog_".concat(c,"_request-access"));const n=Object.assign(s,{isToken:!e.getId()});_.requestPermission(e.getId()||e.getFailedDocumentIdOrToken(),n).then(()=>{t.gDialog("close"),this._requestEmailHasBeenSent=!0}).catch(()=>{l.error(o.GLocale.get(new o.GLocaleKey("GShareManager","text.cannot-request-access")))})}}),d.push({label:o.GLocale.get(new o.GLocaleKey("GLocale","ok")),onclick:async t=>{gDesigner.stats("permission-dialog_".concat(c,"_click-ok")),t.gDialog("close"),await this._isUserUnableToOperateSystem(e)&&gDesigner.signout(!0)},highlighted:!0}),l.custom({icon:"error",closeable:!1,className:t,closeCallback:r,title:n,subtitle:i,buttons:d})},O.prototype._syncExternalPermissions=async function(e){const t=await e.getPermissionsList(),n=await async function t(){return gDesigner.getCloudCommunicationManager().getExternalFile(e.getId()).catch(n=>{if(n&&404===n.status&&e.supportsShadowFile())return e.createShadowFile().then(()=>t.call(this));throw n})}.call(this),i=this._getPrivateInvitedShareListForFile(n),o=await gDesigner.getUser();return function(){const n=[],r=[],a=[];t.forEach(t=>{let{email:o,role:r,externalRole:a}=t;if(o){let t=!1;i.some(n=>{let{email:i,role:r}=n;if(o&&o===i&&e.rolesMatch(a,r))return t=!0,t}),t||n.push({email:o,role:r})}}),i.forEach(e=>{let n=!1;t.some(t=>{let{email:i}=t;if(e.email===i)return n=!0,n}),n||G.makeFromShare(e).is(b.NoAccess)||r.push({email:e.email})}),n.length&&a.concat(n.map(async t=>{let{email:n,role:i}=t;if(o.getEmail()===n)return null;const r=Object.values(b).find(e=>{let{id:t}=e;return t===i}),a=i&&r?r:b.NoAccess,s=(new C).assignRole(a);try{return await _.shareWithUser(e.getId(),n,s)}catch(e){return null}}));r.length&&a.concat(r.map(async t=>{let{email:n}=t;return _.shareWithUser(e.getId(),n,(new C).assignRole(b.NoAccess))}));return Promise.all(a)}.call(this)},O.prototype.getPermalink=async function(e,t){const n=await this._getFileExtended(e);if(n){const e=gDesigner.getAppBaseUrl(!0),i=new URL(n.getShareLink(e));return i.searchParams.set("annot",t.getId()),i.toString()}return null},O.prototype.isShareProRestricted=function(){return C.isPro()&&!gDesigner.isEnabledProFeatures()},e.exports=O},function(e,t,n){"use strict";n(3);var i=n(1);function o(e,t){this.document=e,this.state=t}i.GObject.inherit(o,i.GEvent),o.prototype.document=null,o.prototype.state=null,o.prototype.toString=function(){return"Object [GShareStateChangedEvent]"},e.exports=o},function(e,t,n){"use strict";n(14),n(29);const i=n(175),{SharePermissions:{COMMENT:o,EDIT:r},ShareRoles:a}=n(12),{GLocale:s,GLocaleKey:l}=n(1);e.exports=class extends i{constructor(){let{access_id:e,file_id:t,accessed:n,name:i,last_name:o,avatar:r,anonymous:a=!1,role:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({file_id:t,accessed:n,name:i,last_name:o,avatar:r,anonymous:a}),this.id=e,this._role=s}getTooltip(){const e=this.getRole();return e.is(a.Owner)?s.get(new l("GCollaborators","text.owner-tooltip")).replace("%username",this.getFullUserName()):s.get(new l("GCollaborators",e.hasPermission(r)?"text.can-edit-tooltip":"text.can-comment-tooltip")).replace("%username",this.getFullUserName())}getIcon(){const e=this.getRole();return e.hasPermission(o)&&!e.hasPermission(r)?"gravit-icon-avatar-comment":null}}},function(e,t,n){"use strict";n(25),n(9),n(14),n(115),n(475),n(28);var i=n(12);const o=n(1209),r=n(1447),a=n(231),s=n(544),l={offlineWarning:()=>a.openOfflineWarning(),trialExpired:()=>r.openTrialExpired(),proExpireSoon:()=>r.openProExpireSoon(),proExpireToday:()=>r.openProExpireSoon(),proExpired:()=>r.openProExpired(),proOfferInTrial:()=>o.openOfferReminder(),proOfferInTrialExpired:()=>o.openOfferReminder(),proOfferInTrialExpireSoon:()=>o.openOfferReminder(),proOfferInTrialLastWarning:()=>o.openOfferReminder(),proOfferSpecialPrice:()=>o.openOfferReminder(),proOfferInFree:()=>o.openOfferReminder()};e.exports=new class{constructor(){this._settings=Object.assign({},i.defaultUserSettings.defaultUserSettings),this._flags={proOfferInTrialLastWarning:!0,proOfferInTrialExpireSoon:!0}}async start(){try{let e=await i.gApi.getUserSettings().catch(()=>null);e&&(this._settings=Object.assign(this._settings,e))}catch(e){console.info("GReminderManager","exception",e)}this._settings&&this._settings.reminders&&(this._settings.reminders.proOfferInTrialExpireSoon=i.DateAPI.daysToMilliseconds(1)),setInterval(this.checkReminders.bind(this),i.DateAPI.daysToMilliseconds(1)),this.checkReminders(),gDesigner.addEventListener(s,this.checkReminders,this)}checkReminders(){if(!gDesigner.isEnabledSubscriptions())return;let e=gDesigner.getSyncUser();if(!e||e.deactivated)return;if(i.DateAPI.lte(i.DateAPI.toUTCZone(gDesigner.now()),e.trial_created))return;let t=gDesigner.getLicense();if(t.isExpired()){if(t.isTrial()&&this.once("trialExpired"))return void this._checkPoint("proOfferInTrialExpired",gDesigner.now());if(t.isPro())return void this.once("proExpired");this.execute("proOfferInTrialExpired")}else if(t.isPro())t.getExpirationDate()&&(this.once("proExpireSoon",t.getExpirationDate())||this.once("proExpireToday",t.getExpirationDate()));else if(t.isTrial())this.execute("proOfferInTrial")||this.once("proOfferInTrialExpireSoon",t.getExpirationDate())||this.once("proOfferInTrialLastWarning",t.getExpirationDate());else if(t.isFree()){const{reminders:{proOfferInFree:e=15}={}}=this._settings;if(t.getCreationDate()){const n=i.DateAPI.addTime(t.getCreationDate(),e),o=gDesigner.now();i.DateAPI.gte(o,n)&&this.execute("proOfferInFree")&&this.reset("proOfferInTrial",o)}}t.isPro()||t.isLegacy()&&t.getSpecialPriceDate()&&this.once("proOfferSpecialPrice",t.getSpecialPriceDate(),!0),t.isOffline()&&!t.isOfflinePeriodExpired()&&(t.isPro()||t.isTrial())&&this.execute("offlineWarning",t.getOfflineWarningDate()),t.isPro()&&!t.isExpired()&&(this.reset("proExpired"),this.reset("proExpireToday"))}execute(e,t){const n=gDesigner.now();t&&(t=i.DateAPI.addTime(t,-this._settings.reminders[e]||0));const o=gDesigner.getSetting(e);return!(o&&!i.DateAPI.isExpired(n,new Date(o),this._settings.reminders[e]))&&(!(t&&!i.DateAPI.isExpired(n,t))&&this._executeReminder(e))}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(gDesigner.getSetting(e))return!1;const o=gDesigner.now();return t&&(t=i.DateAPI.addTime(t,-this._settings.reminders[e]||0)),!t||!n&&i.DateAPI.isExpired(o,t)||n&&i.DateAPI.eq(o,t)?this._executeReminder(e):void 0}_checkPoint(e,t){gDesigner.setSetting(e,t)}_executeReminder(e){return!!this._checkFlag(e)&&(/^prod/.test("production")||console.info("ReminderManager",e),this._checkPoint(e,gDesigner.now()),this._handleStats(e),l[e].call(null),!0)}_checkFlag(e){return this._flags.hasOwnProperty(e)?this._flags[e]:!1!==this._settings.flags[e]}_handleStats(e){let t,n;switch(e){case"offlineWarning":gDesigner.pageTracking("/ProOfflineWarning");break;case"trialExpired":gDesigner.pageTracking("/ProTrialExpired");break;case"proExpireSoon":t=gDesigner.getLicense(),n=i.DateAPI.millisecondsToDays(i.DateAPI.diff(i.DateAPI.toUTCZone(gDesigner.now()),t.getExpirationDate())),gDesigner.pageTracking("/ProReminders"+n);break;case"proExpireToday":gDesigner.pageTracking("/ProReminders1");break;case"proExpired":gDesigner.pageTracking("/ProSubExpired");break;case"proOfferInTrial":gDesigner.pageTracking("/ProTrial");break;case"proOfferInTrialExpired":gDesigner.pageTracking("/ProTrialExpired");break;case"proOfferInTrialExpireSoon":t=gDesigner.getLicense(),n=i.DateAPI.millisecondsToDays(i.DateAPI.diff(i.DateAPI.toUTCZone(gDesigner.now()),t.getExpirationDate())),gDesigner.pageTracking("/ProTrialExpireSoon"+n);break;case"proOfferInTrialLastWarning":gDesigner.pageTracking("/ProTrialExpireToday");break;case"proOfferSpecialPrice":gDesigner.pageTracking("/ProTrialSpecialPrice");break;case"proOfferInFree":gDesigner.pageTracking("/ProFree")}}reset(e,t){gDesigner.setSetting(e,t)}resetAll(){Object.keys(l).forEach(e=>this.reset(e))}}},function(e,t,n){"use strict";n(9);var i=n(1);const o=n(1210),r=n(1446);class a{static openOfferReminder(e){return a._openPaywall("reminder",e)}static openSubscriptionOffer(e){return a._openPaywall("subscribe",e)}static async _openPaywall(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"reminder",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this._getProduct(),a=this._getLayout(),s=gDesigner.getApplicationManager().isInAppPurchaseAvailable();return(await o.newBuilder(r)).setId("paywall-cross-frame").setEndpoint("/pro/paywall/".concat(e)).setTime(gDesigner.now()).setLanguage(i.GLocale.getLanguage()).setCampaign(t.campaign).setShareFile(t.shareFile).setDashboard(t.dashboard).setProduct(n).setInAppPurchasesAvailable(s).setLayout(a).build().open()}static _getProduct(){return gInAppPurchase.getProduct().catch(()=>null)}static _getLayout(){return r.DEFAULT_LAYOUT}}e.exports=a},function(e,t,n){"use strict";n(9);const i=n(1443),o=n(1445);n(1073);e.exports=class{static async newBuilder(e){return await gDesigner.isOfflineAsync()?new o(e):new i}}},function(e,t,n){"use strict";var i=n(1);function o(e){this.paintMode=e}i.GObject.inherit(o,i.GEvent),o.prototype.paintMode=null,e.exports=o},function(e,t,n){"use strict";var i=n(17),o=i(n(790)),r=i(n(1076));class a extends o.default{canActivate(){return!0}activate(e,t){super.activate(e,t),this._panState=new r.default}deactivate(e,t){super.deactivate(e,t),this._panState=null}start(e,t){this._panState&&this._panState.update(e.getOriginalEvent())}move(e,t){this._panState&&e.isCancelable()&&e.iterateChangedTouches(e=>{this._panState.hasActiveIdentifier(e)&&this._dispatchEventFromTouch("mousemove",e)})}end(e,t){super.end(e,t),this._panState=null}cancel(e,t){super.cancel(e,t),this._panState=null}}e.exports=a},function(e,t,n){"use strict";var i=n(1);function o(e){this.fullscreen=e}i.GObject.inherit(o,i.GEvent),o.prototype.fullscreen=!1,e.exports=o},function(e,t,n){"use strict";n(3);var i=n(1),o=n(43),r=n(16),a=n(12),s=n(32),l=n(18),c=n(26);n(36);const d=n(549);function u(e){this._isCut=e,document.addEventListener(this._isCut?"cut":"copy",this._documentCutOrCopyEvent.bind(this)),document.addEventListener(this._isCut?"beforecut":"beforecopy",this._documentBeforeCutOrCopyEvent.bind(this)),window.hasOwnProperty("ClipboardEvent")||(this._cutCopyArea=$("<textArea></textArea>").css({position:"absolute",top:"-9999px",opacity:0}).prop("tabindex",-1).appendTo($("body")))}i.GObject.inherit(u,c),u.ID_COPY="edit.copy",u.ID_CUT="edit.cut",u.prototype._cutCopyArea=null,u.prototype.getId=function(){return this._isCut?u.ID_CUT:u.ID_COPY},u.prototype.getTitle=function(){return new i.GLocaleKey("GCutCopyAction","title."+(this._isCut?"cut":"copy"))},u.prototype.getIcon=function(){return"gravit-icon-"+(this._isCut?"cut":"copy")},u.prototype.getCategory=function(){return l.CATEGORY_EDIT},u.prototype.getGroup=function(){return"ccp"},u.prototype.getShortcut=function(){return this._isCut?[r.GKey.Constant.META,"X"]:[r.GKey.Constant.META,"C"]},u.prototype.isEnabled=function(){return!(!gDesigner.getActiveDocument()||!gDesigner.getActiveDocument().getEditor().getSelection())},u.prototype.executeFromShortcut=function(){return this._isEditableElementFocused()||this._cutCopyArea&&this._cutCopyArea.focus(),!1},u.prototype.execute=function(){this._documentCutOrCopyEvent(null)},u.prototype._documentCutOrCopyEvent=function(e){if(!this._isEditableElementFocused()||$(document.activeElement).is("button")||this._cutCopyArea&&document.activeElement===this._cutCopyArea[0]){e&&e.preventDefault();var t=gDesigner.getActiveDocument(),n=t&&t.getEditor(),r=gDesigner.getMouseOverContext(),l=t.getActiveStylesList();if(r.context&&(l.Fill||l.Border||l.Effect)){var c=null;r.context===d.FillPropertiesPanel?c=l.Fill:r.context===d.BorderPropertiesPanel?c=l.Border:r.context===d.EffectPropertiesPanel&&(c=l.Effect),r.contextCallback&&r.contextCallback(r.prevEvt);var u=i.GNode.serialize([c],{copy:!0,copyIgnoreProperties:o.GEditorOptions.propertiesExcludedFromCopying}),p='<gravit mimeType="'+i.GNode.MIME_TYPE+'">'+$("<div/>").text(u).html()+"</gravit>";e?e.clipboardData.setData("text/xml",p):gDesigner.setClipboardContent(i.GNode.MIME_TYPE,u)}else{var g=n&&n.getSelection();if(g){g=i.GNode.order(g.slice());for(var h=[],f=function(e){var t=!1;return h.forEach(n=>{e.findParent(e=>{t=e===n})}),t},m=0;m<g.length;++m)f(g[m])||h.push(g[m]);g=h}if(g&&(g=g.filter((function(e){return e instanceof i.GItem||e instanceof i.GLayer})))&&g.length){var y=[];for(m=0;m<g.length;m++)y=y.concat(gDesigner.getActiveDocument().getEditor().getLinkedElementsInSelection(g[m],g));a.HAS_ANNOTATIONS&&(y=y.concat(gDesigner.getActiveDocument().getEditor().getAnnotationsExceptions(g)));var v=[];for(m=0;m<g.length;m++){var _=g[m];_.hasProperty("sref")&&_.getReferencedStyle()&&v.push(_.getReferencedStyle())}g.push.apply(g,v);const n=t.isCommercialProductFile()||!gDesigner.getApplicationManager().isCopyPasteEnabled();n&&(g=t.restrictElements(g));var b=i.GNode.serialize(g,{exceptions:y,copy:!0,copyIgnoreProperties:o.GEditorOptions.propertiesExcludedFromCopying});if(gDesigner.setClipboardContent(i.GNode.MIME_TYPE,b),e){var w=1===g.length&&g[0];w&&w.hasMixin(i.GNode.Properties)&&w.getProperty("collab")||e.clipboardData.setData("text/xml",'<gravit mimeType="'+i.GNode.MIME_TYPE+'" restricted="'+(!!n&&t.getStorageItem().getId())+'">'+$("<div/>").text(b).html()+"</gravit>");for(m=0;m<g.length;m++)if(g[m]instanceof i.GText){var C,E=g[m],S=E.getTLCore();if(S){var G=o.GElementEditor.getEditor(E);C=G&&1===g.length&&G.isInlineEdit()?S.selectedRange().plainText():S.getDocumentRange().plainText()}else C=E.getContent();e.clipboardData.setData("text/plain",C);break}}}}if(this._isCut&&n){var A=i.GLocale.get(new i.GLocaleKey("text.cut-selection"));n.beginTransaction();try{if(r.context&&(l.Fill||l.Border||l.Effect)){var T=null,P=null,L=n.getSelection();r.context===d.FillPropertiesPanel?(T=l.Fill,P="fill"):r.context===d.BorderPropertiesPanel?(T=l.Border,P="border"):r.context===d.EffectPropertiesPanel&&(T=l.Effect,P="effect"),(0,s.iterateEqualStyleLayers)(P,T,L,(function(e){e.getParent().removeChild(e)})),A=i.GLocale.get(this.getTitle())}else n.deleteSelection(!0)}finally{n.commitTransaction(A)}}this._cutCopyArea&&setTimeout((function(){var e=gDesigner.getWindows();e&&e.getActiveWindow()&&e.getActiveWindow().getView().focus()}),1)}},u.prototype._documentBeforeCutOrCopyEvent=function(e){document.activeElement&&$(document.activeElement).is(":editable")&&!gDesigner.isGravitIME(document.activeElement)||e.preventDefault()},u.prototype._isEditableElementFocused=function(){return!(!document.activeElement||!$(document.activeElement).is(":editable")||gDesigner.isGravitIME(document.activeElement))},u.prototype.toString=function(){return"[Object GCutCopyAction]"},e.exports=u},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(43),a=n(16),s=n(12),l=n(32),c=i(n(36)),d=n(511),u=n(18),p=n(26);const g=n(323),h=n(549);function f(){}o.GObject.inherit(f,p),f.ID="edit.delete",f.TITLE=new o.GLocaleKey("GDeleteAction","title"),f.prototype.getId=function(){return f.ID},f.prototype.getTitle=function(){return f.TITLE},f.prototype.getCategory=function(){return u.CATEGORY_EDIT},f.prototype.getGroup=function(){return"ccp"},f.prototype.getShortcut=function(){return[a.GKey.Constant.REMOVE]},f.prototype.getAdditionalShortcuts=function(){var e=[];return o.GSystem.operatingSystem===o.GSystem.OperatingSystem.OSX_IOS?e.push([a.GKey.Constant.DELETE]):e.push([a.GKey.Constant.BACKSPACE]),e},f.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getSelection();if(t)for(var n=0;n<t.length;++n)if(t[n]instanceof o.GItem||t[n]instanceof o.GLayer)return!0}return!1},f.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e.getEditor(),n=e.getActiveStylesList(),i=gDesigner.getMouseOverContext();if(s.HAS_ANNOTATIONS&&gDesigner.getRightSidebars().getActiveSidebar()===d.ID){var a=t.getSelection().filter(e=>g.canDeleteAnnotation(e));a.length&&c.default.confirm(o.GLocale.get(new o.GLocaleKey("GAnnotationPanel","text.confirm-remove")),e=>{e&&gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getEditor()===t&&g.removeAnnotations(a,a[0].getParent(),o.GLocale.get(this.getTitle()))},null,null,null,!0,!0)}else if(i.context&&(n.Fill||n.Border||n.Effect)){var u=null,p=null,m=t.getSelection();if(i.context===h.FillPropertiesPanel)u=n.Fill,p="fill";else if(i.context===h.BorderPropertiesPanel)u=n.Border,p="border";else{if(i.context!==h.EffectPropertiesPanel)return void t.deleteSelection();u=n.Effect,p="effect"}r.GEditor.tryRunTransaction(e.getScene(),(function(){(0,l.iterateEqualStyleLayers)(p,u,m,(function(e){e.getParent().removeChild(e)}))}),o.GLocale.get(f.TITLE))}else t.deleteSelection()},f.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-delete":""},f.prototype.toString=function(){return"[Object GDeleteAction]"},e.exports=f},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="edit.select-all",s.TITLE=new i.GLocaleKey("GSelectAllAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT},s.prototype.getGroup=function(){return"select"},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"A"]},s.prototype.isEnabled=function(){return!(!document.activeElement||!$(document.activeElement).is(":editable"))||!!gDesigner.getActiveDocument()},s.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable")&&!$(document.activeElement).is("button")&&!gDesigner.isGravitIME(document.activeElement))document.execCommand("selectAll");else{var e=gDesigner.getActiveDocument().getEditor(),t=gDesigner.getActiveDocument().getScene(),n=t.getActivePage(),o=gDesigner.getActiveDocument().getActiveWindow().getView().getViewConfiguration().multiPageView,r=[];t.accept((function(e){if(e instanceof i.GItem&&!e.hasMixin(i.GAnnotation)&&!(e.getParent()instanceof i.GItem)&&(e.getPage()===n||o)&&!e.isLocked()){var t=!e.getProperty("vis")||e.findParent((function(e){return e instanceof i.GBlock&&!e.getProperty("vis")})),a=e.getProperty("plkt"),s=a&i.GBlock.ProgramLck.NoEdit&&a&i.GBlock.ProgramLck.NoSizeChanges&&a&i.GBlock.ProgramLck.NoMove&&a&i.GBlock.ProgramLck.NoDelete;t||s||r.push(e)}})),e.updateSelection(!1,r)}},s.prototype.toString=function(){return"[Object GSelectAllAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="edit.deselect-all",s.TITLE=new i.GLocaleKey("GDeselectAllAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT},s.prototype.getGroup=function(){return"select"},s.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"A"]},s.prototype.isEnabled=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))return!0;if(gDesigner.getActiveDocument()){var e=gDesigner.getActiveDocument().getEditor().getSelection();if(e&&e.length)return!0}return!1},s.prototype.execute=function(){document.activeElement&&$(document.activeElement).is(":editable")&&!$(document.activeElement).is("button")&&!gDesigner.isGravitIME(document.activeElement)?document.execCommand("selectAll"):gDesigner.getActiveDocument().getEditor().clearSelection()},s.prototype.toString=function(){return"[Object GDeselectAllAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(16),a=i(n(396)),s=i(n(1213));const{isExecutingOnMSTeamsSync:l}=a.default;var c=n(772),d=n(402),u=n(18),p=n(26),g=n(1457);function h(){this._banner.setBannerText(o.GLocale.get(new o.GLocaleKey("GToggleFullscreenAction","fullscreen-banner")))}o.GObject.inherit(h,p),h.ID="view.fullscreen",h.TITLE=new o.GLocaleKey("GToggleFullscreenAction","title"),h.prototype._lastStates={},h.prototype._banner=new g,h.prototype.getId=function(){return h.ID},h.prototype.getTitle=function(){return h.TITLE},h.prototype.getCategory=function(){return u.CATEGORY_VIEW},h.prototype.getShortcut=function(){return[r.GKey.Constant.ALT_LEFT,r.GKey.Constant.ENTER]},h.prototype.isEnabled=function(){return!!gDesigner.getActiveDocument()&&this._isSupported()},h.prototype.isVisible=function(){return this._isSupported()},h.prototype._isSupported=function(){return!l()},h.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-toggle-full-screen":null},h.prototype.isFullscreen=function(){return!(gDesigner.isPartVisible(c.Header)||gDesigner.isPartVisible(c.Toolbar)||gDesigner.isPartVisible(c.RightSidebars)||gDesigner.isPartVisible(c.LeftSidebars)||gDesigner.isPartVisible(c.Panels))},h.prototype.execute=function(){var e=this.isFullscreen();e?this._banner.hide():(this._updateLastStates(),gDesigner.isTouchEnabled()||this._banner.show()),gDesigner.setPartVisible(c.Header,!!e&&this._lastStates.header,""),gDesigner.setPartVisible(c.Toolbar,!!e&&this._lastStates.toolbar,""),gDesigner.setPartVisible(c.Panels,!!e&&this._lastStates.panels),gDesigner.setPartVisible(c.RightSidebars,!!e&&this._lastStates.rightSidebar),gDesigner.setPartVisible(c.LeftSidebars,!!e&&this._lastStates.leftSidebar),gDesigner.relayout(),gDesigner.executeAction(d.ID,void 0,void 0,!0),gDesigner.hasEventListeners(s.default)&&gDesigner.trigger(new s.default(e))},h.prototype._updateLastStates=function(){this._lastStates={header:gDesigner.isPartVisible(c.Header),toolbar:gDesigner.isPartVisible(c.Toolbar),panels:gDesigner.isPartVisible(c.Panels),leftSidebar:gDesigner.isPartVisible(c.LeftSidebars),rightSidebar:gDesigner.isPartVisible(c.RightSidebars)}},h.prototype.toString=function(){return"[Object GToggleFullscreenAction]"},e.exports=h},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26),a=n(1458);function s(){}i.GObject.inherit(s,r),s.ID="help.open-quick-help",s.TITLE=new i.GLocaleKey("GOpenQuickHelpScreenAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return o.CATEGORY_HELP},s.prototype.getGroup=function(){return"help"},s.prototype.isEnabled=function(){return!0},s.prototype.isVisible=function(){return gDesigner.isTouchEnabled()},s.prototype.execute=function(){a.open()},s.prototype.toString=function(){return"[Object GOpenQuickHelpScreenAction]"},e.exports=s},function(e,t,n){"use strict";function i(){}i.Orientation={Vertical:"vertical",Horizontal:"horizontal"},function(e){const t={_toggleTransitions:function(t){return e(this).toggleClass("g-transitions-off",!t),this},_toggleVisibilty:function(t){const n=e(this);if(n.hasClass("expanded")!==t)return n.toggleClass("collapsed",!t).toggleClass("expanded",t),n.hasClass(i.Orientation.Vertical)?n.children(".g-collapsible-button:first").find("span").toggleClass("gravit-icon-touch-arrow-up",!t).toggleClass("gravit-icon-touch-arrow-down",t):n.siblings(".g-collapsible-button:first").find("span").toggleClass("gravit-icon-touch-arrow-right",!t).toggleClass("gravit-icon-touch-arrow-left",t),this},init:function(n){n=e.extend({orientation:i.Orientation.Vertical},n);const o=this;return this.each((function(){const i=e(this).addClass("g-collapsible g-transitions-off expanded").addClass(n.orientation);"vertical"===n.orientation?i.prepend(e("<div/>").addClass("g-collapsible-button").append(e("<span/>").addClass("gravit-icon-touch-arrow-down")).on("click",()=>{const e=i.hasClass("expanded");t._toggleTransitions.call(o,!0),t._toggleVisibilty.call(o,!e),i.trigger("visibilitychanged",[!e])})):i.before(e("<div/>").addClass("g-collapsible-button").append(e("<span/>").addClass("gravit-icon-touch-arrow-left")).on("click",()=>{const e=i.hasClass("expanded");t._toggleTransitions.call(o,!0),t._toggleVisibilty.call(o,!e,!0),i.trigger("visibilitychanged",[!e])}))}))},collapse:function(){return t._toggleVisibilty.call(this,!1)},expand:function(){return t._toggleVisibilty.call(this,!0)}};e.fn.gCollapsible=function(n){return t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.gCollapsible"):t.init.apply(this,arguments)}}(jQuery),e.exports=i},function(e,t,n){"use strict";class i{static get Events(){return{SETTING_CHANGED_EVENT:"SETTING_CHANGED_EVENT",USER_COMPLETED_PURCHASE_EVENT:"USER_COMPLETED_PURCHASE_EVENT"}}static isInitialized(){return"undefined"!=typeof dataLayer}static updateProperty(e,t){i.isInitialized()&&dataLayer.push({[e]:t})}static fireEvent(e){i.isInitialized()&&dataLayer.push({event:e})}}e.exports=i},function(e,t,n){"use strict";var i=n(17);n(28),n(14),n(63),n(58),n(29),n(3);var o=n(1),r=n(43),a=n(32),s=n(12),l=n(56),c=i(n(309)),d=n(108),u=n(1042),p=n(118),g=n(545),h=n(1211),f=n(395);const m=n(36),y=n(1472),v=n(78);function _(){}o.GObject.inherit(_,d),_.prototype._panel=null,_.prototype._canvasPropertiesRowInTouch=null,_.prototype._canvasPropertiesRowInNormal=null,_.prototype._hrAfterCanvasRow=null,_.prototype._bleedRowInTouch=null,_.prototype._bleedRowInNormal=null,_.prototype._pageSizeRowInNormal=null,_.prototype._hrAfterPageSizeRow=null,_.prototype._toolbar=null,_.prototype._document=null,_.prototype._oldDocument=null,_.prototype._pages=null,_.prototype._styleEditorChange=!1,_.prototype._styleEdOn=!1,_.prototype._ownChange=!1,_.prototype._chooserElem=null,_.prototype._clipContentButton=null,_.prototype._excludedPresets=[u.TYPE.MERCH],_.prototype._createInput=function(e){var t=this,n=this;if("bck"===e)return $("<div></div>").attr("data-property",e).gPatternChooser({types:[o.GColor,o.GGradient,o.GTexturePattern]}).on("chooseropen",(function(){gDesigner.getWorkspace().getStyleEdManager().updateEditor(n._pages[0],e,!1),n._styleEdOn=!0,n._chooserElem=$(this),n.updatePropertiesAvailability(gDesigner.getActiveDocument().getScene().getActivePage())})).on("chooserclose",(function(e,t,i){if(gDesigner.getWorkspace().getStyleEdManager().getOverlayLock(i))t();else{if(n._document&&n._document.hasCDR()){var r=gPatternChooser.getPattern();!r||r instanceof o.GRGBColor||m.showCDRUnsupportedObjectWarning()}n._styleEdOn=!1,gDesigner.getWorkspace().getStyleEdManager().deactivateEditor()}n._chooserElem=null})).on("patternchange",(function(e,t,i,r,a,s){var l=[],c=[];if(void 0!==t&&(l.push("bck"),c.push(t)),"number"==typeof i&&(l.push("bop"),c.push(i)),n._pages)if(r)n._pages.forEach((function(e){e.setProperties(l,c,!1,!1,r)}));else{var d=null;a&&(d={chooserOn:!0,pagePattern:!0},null!==s&&(d.activeStopIdx=s)),n._assignProperties(l,c,o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-background")),d)}}));if("preset-size"===e)return $("<select></select>").attr("data-property","preset-size").css("width","100%").on("change",e=>{var t=$(e.target).find("option:selected"),n=t.attr("data-preset-locale-en"),i="";i=n||t.text(),gDesigner.stats("pageproperties_preset_size",i),this._assignPresetSize(e.target.value)});if("w"===e||"h"===e){var i=o.GLocale.get(new o.GLocaleKey("GCommonNames","property-".concat(e.toLowerCase())),e);return $("<div>").append($("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("pageproperties_change_size");var t=$(this).gInputBox("value"),i=n._document.getScene().stringToPoint(t);""===t||0===i?n._assignProperties(["w","h"],[i,i],o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size"))):null!==i&&"number"==typeof i&&i>=0?n._assignProperty(e,i,o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size"))):n._updateProperties()})).gInputBox()).gInputLabel({label:i,autoPadding:i.length>1})}if("bl"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("pageproperties_change_bleeding");var t=n._document.getScene().stringToPoint($(this).gInputBox("value"));null!==t&&"number"==typeof t&&t>=0?n._assignProperty(e,t,o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-bleeding"))):n._updateProperties()})).gInputBox();if("mt"===e||"mb"===e||"ml"===e||"mr"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("pageproperties_change_margins");var t=n._document.getScene().stringToPoint($(this).gInputBox("value"));null!==t&&"number"==typeof t&&t>=0?"yes"===n._panel.find("[data-lock-margin]").attr("data-lock-margin")?n._assignProperties(["mt","mb","ml","mr"],[t,t,t,t],o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-margins"))):n._assignProperty(e,t,o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-margin"))):n._updateProperties()})).gInputBox();if("equal-margins"===e)return $("<span></span>").addClass("g-button g-flat valign-middle").append($("<span></span>").addClass("gravit-icon-linked")).on("click",(function(){var e=$(this).closest(".g-button");gDesigner.stats("pageproperties_lock_margin",e.attr("data-lock-margin")),"yes"===e.attr("data-lock-margin")?e.attr("data-lock-margin","no").find("span:first-child").attr("class","gravit-icon-unlinked"):e.attr("data-lock-margin","yes").find("span:first-child").attr("class","gravit-icon-linked")})).attr("data-title",o.GLocale.get(new o.GLocaleKey("GPageProperties","action.equal-margin"))).attr("data-lock-margin","yes");if("master-page"===e)return $("<select></select>").attr("data-property","master-page").css("width","100%").gPro().on("mousedown",a.watchDog.trap(null,null,()=>gDesigner.stats("pageproperties_nonprotriespro_masterpages"))).on("change",a.watchDog.trap(e=>{gDesigner.stats("pageproperties_change_masterpages"),this._assignMasterPage($(e.target).find('option[value="'+e.target.value+'"]').data("page"))},null,()=>gDesigner.stats("pageproperties_nonprotriespro_masterpages")));if("bop"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){gDesigner.stats("pageproperties_change_canvas-opacity"),n._assignProperty(e,o.GLength.parseEquationValue($(this).gInputBox("value"))/100,o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-canvas-opacity")))})).gInputBox({minValue:0,maxValue:100,incrementValue:gDesigner.getOpacityIncrement(),postfix:"%"});if("rotate-canvas"===e)return $("<button>").attr("data-property",e).attr("data-title",o.GLocale.get(new o.GLocaleKey("GPageProperties","text.rotate-canvas"))).append($("<span/>").addClass("gravit-icon-flip-canvas")).on("click",(function(){gDesigner.stats("pageproperties_change_rotate");var e=n._pages[0];e&&e.getProperty("w")>0&&e.getProperty("h")>0&&n._assignProperties(["w","h"],[e.getProperty("h"),e.getProperty("w")],o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size")))}));if("trim-canvas"===e)return $("<button>").attr("data-property",e).attr("data-title",o.GLocale.get(new o.GLocaleKey("GPageProperties","text.size-trim"))).append($("<span/>").addClass("gravit-icon-trim-canvas")).on("click",(function(){gDesigner.stats("pageproperties_trim_page"),n._panel.find('select[data-property="preset-size"]').val("@trim"),n._assignPresetSize("@trim")}));if("clip-content"===e){this._clipContentButton=$("<button>").attr("data-property",e).attr("disabled",!0).addClass("g-disabled").attr("data-title",o.GLocale.get(new o.GLocaleKey("GPageProperties","text.clip-content"))).append($("<span/>").addClass("gravit-icon-clip-content")).on("click",(function(){var e=gDesigner.getWindows().getActiveWindow();if(e){var t=e.getView().getViewConfiguration().paintMode;gDesigner.stats("pageproperties_clip_content",t!==o.GScenePaintConfiguration.PaintMode.Output),n(t!==o.GScenePaintConfiguration.PaintMode.Output,!1)}}));const n=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i;n&&e||(e?(i=o.GScenePaintConfiguration.PaintMode.Output,t._updatePageSetting(f.PAGE_CLIP_CONTENT_ENABLED)):(i=o.GScenePaintConfiguration.PaintMode.Full,t._updatePageSetting(f.PAGE_CLIP_CONTENT_DISABLED)),gDesigner.setPaintMode(i))};return this._clipContentButton}throw new Error("Unknown input property: "+e)},_.prototype._windowEvent=function(e){const{type:t,window:n}=e;if(t!==g.WindowEvent.Type.Activated)return void(t===g.WindowEvent.Type.Removed&&this._lastScene&&(this._lastScene.removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._propertiesUpdateEventHandler,this),this._lastScene.removeEventListener(o.GNode.AfterFlagChangeEvent,this._pageActivationEventHandler,this),this._lastScene=null));if(n.getDocument()!==gDesigner.getActiveDocument())return;const i=gDesigner.getActiveDocument().getScene();i.addEventListener(o.GNode.AfterFlagChangeEvent,this._pageActivationEventHandler,this),i.addEventListener(o.GNode.AfterPropertiesChangeEvent,this._propertiesUpdateEventHandler,this),this._lastScene&&(this._lastScene.removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._propertiesUpdateEventHandler,this),this._lastScene.removeEventListener(o.GNode.AfterFlagChangeEvent,this._pageActivationEventHandler,this)),this._lastScene=i,this._pageActivationEventHandler({node:i.getActivePage(),flag:o.GNode.Flag.Active})},_.prototype._paintModeEvent=function(){this.updatePropertiesAvailability(gDesigner.getActiveDocument().getScene().getActivePage())},_.prototype._pageActivationEventHandler=function(e){let{node:t,flag:n}=e;if(t instanceof o.GPage&&n===o.GNode.Flag.Active){const e=gDesigner.getWindows().getActiveWindow().getView().getViewConfiguration().paintMode,n=!t.isFixedSized();if(n&&e===o.GScenePaintConfiguration.PaintMode.Output)gDesigner.setPaintMode(o.GScenePaintConfiguration.PaintMode.Full),this._updatePageSetting(f.PAGE_CLIP_CONTENT_DISABLED);else if(!n){var i=t.getProperty(f.PAGE_CLIP_PROPERTY_NAME,!0)||(s.PAGE_CLIP_DEFAULT?f.PAGE_CLIP_CONTENT_ENABLED:f.PAGE_CLIP_CONTENT_DISABLED);gDesigner.setPaintMode(i===f.PAGE_CLIP_CONTENT_ENABLED?o.GScenePaintConfiguration.PaintMode.Output:o.GScenePaintConfiguration.PaintMode.Full)}this.updatePropertiesAvailability(t)}},_.prototype._propertiesUpdateEventHandler=function(e){let{node:t,temporary:n,properties:i}=e;if(!n&&t instanceof o.GPage&&(i.indexOf("w")>=0||i.indexOf("h")>=0)){var r=gDesigner.getWindows().getActiveWindow().getView().getViewConfiguration().paintMode,a=!t.isFixedSized();a&&r===o.GScenePaintConfiguration.PaintMode.Output?(gDesigner.setPaintMode(o.GScenePaintConfiguration.PaintMode.Full),this._updatePageSetting(f.PAGE_CLIP_CONTENT_DISABLED)):this._manageClipButtonState(!1,!a)}},_.prototype._updatePageSetting=function(e){gDesigner.getActiveDocument().getScene().getActivePage().setProperty(f.PAGE_CLIP_PROPERTY_NAME,e,!0)},_.prototype._reInitLayout=function(){this._canvasPropertiesRowInNormal=$("<div></div>").attr("data-property-row","canvas-size").addClass("canvas-properties-normal").gPropertyRow({columns:[{width:"25%",content:this._createInput("bck"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.color"))},{width:"25%",content:this._createInput("w"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width"))},{width:"25%",content:this._createInput("h"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.height"))},{width:"25%",content:this._createInput("bop"),label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.opacity"))}]}).insertBefore(this._hrAfterbleedRow),this._hrAfterCanvasRow=$("<hr/>").insertBefore(this._hrAfterbleedRow),this._pageSizeRowInNormal=$("<div></div>").addClass("page-size-properties-normal").gPropertyRow({columns:[{width:"25%",content:$("<span>"+o.GLocale.get(new o.GLocaleKey("GPageProperties","text.page-size"))+"</span>")},{width:"30%",content:this._createInput("preset-size")},{width:"15%",content:this._createInput("rotate-canvas")},{width:"15%",content:this._createInput("trim-canvas")},{width:"15%",content:this._createInput("clip-content")}]}).insertBefore(this._hrAfterbleedRow),this._hrAfterPageSizeRow=$("<hr/>").attr("data-property-row","fixed-size").insertBefore(this._hrAfterbleedRow),this._bleedRowInNormal=$("<div></div>").addClass("bleed-properties-normal").attr("data-property-row","fixed-size").gPropertyRow({columns:[{width:"25%",content:$("<span>"+o.GLocale.get(new o.GLocaleKey("GPageProperties","text.bleed"))+"</span>")},{width:"20%",content:this._createInput("bl")}]}).insertBefore(this._hrAfterbleedRow)},_.prototype.init=function(e,t){this._panel=e,this._toolbar=t,gDesigner.getWindows().addEventListener(g.WindowEvent,this._windowEvent,this),gDesigner.addEventListener(h,this._paintModeEvent,this),gDesigner.addEventListener(v,this._documentEvent,this),this.setTouchTools([new c.default({id:"document",icon:"gravit-icon-touch-document",panel:[this._panel,".scene-properties-panel"],toolbar:[this._toolbar,".scene-properties-toolbar"],panelWidth:"380px"})]),t.addClass("filled"),t.addClass("page-toolbar"),t.addClass("page-properties-toolbar"),e.addClass("page-properties-panel"),$("<label></label>").text(o.GLocale.get(new o.GLocaleKey("GPageProperties","title")).toUpperCase()).appendTo(t),this._hrAfterbleedRow=$("<hr/>").attr("data-property-row","fixed-size").appendTo(e);const n=l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.margin-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.margin-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#margins-7"});$("<div></div>").attr("data-property-row","fixed-size").addClass("page-margin-properties").gPropertyRow({columns:[{clazz:"margin-title-column",content:$("<span>"+o.GLocale.get(new o.GLocaleKey("GPageProperties","text.margin"))+"</span>").addClass("margin-title")},{clazz:"margin-input-column",labelClass:"margin-input-labels",label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.left")),content:this._createInput("ml").gRichTooltip(n)},{clazz:"margin-input-column",labelClass:"margin-input-labels",label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.top")),content:this._createInput("mt").gRichTooltip(n)},{clazz:"margin-input-column",labelClass:"margin-input-labels",label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.right")),content:this._createInput("mr").gRichTooltip(n)},{clazz:"margin-input-column",labelClass:"margin-input-labels",label:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.bottom")),content:this._createInput("mb").gRichTooltip(n)},{clazz:"margin-btn-column",labelClass:"margin-input-labels",content:this._createInput("equal-margins")}]}).appendTo(e),$("<hr/>").attr("data-property-row","fixed-size").appendTo(e);var i=gDesigner.getLicense();$("<div></div>").attr("data-property-row","fixed-size").addClass("master-property-row").gPropertyRow({columns:[{clazz:"master-property-title",content:$("<span>"+o.GLocale.get(new o.GLocaleKey("GPageProperties","text.master"))+"</span>")},{clazz:"master-property-selector",content:$("<div></div>").append(this._createInput("master-page")).append($("<span></span>").gPro()).gRichTooltip(l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.master-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.master-tooltip-description")),middle:!1,isPro:!gDesigner.isEnabledProFeatures()||!(i.isPro()&&!i.isExpired()),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#master-pages"}))}]}).appendTo(e),e.find('[data-property="rotate-canvas"]').parent(".content").gRichTooltip(l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.rotate-canvas-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.rotate-canvas-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#orientation-4"})),e.find('[data-property="trim-canvas"]').parent(".content").gRichTooltip(l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.trim-canvas-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.trim-canvas-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#trim-canvas-5"})),e.find('[data-property="clip-content"]').parent(".content").gRichTooltip(l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.clip-content-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.clip-content-tooltip-description"))})),e.find('[data-property="bl"]').parent(".content").gRichTooltip(l.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.bleed-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GPageProperties","text.bleed-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#bleed-6"})),gDesigner.getWorkspace().getStyleEdManager().addEventListener(r.GStyleEdManager.EditorEvent,this._styleEditorEventHandler,this),this._updateUI()},_.prototype._documentEvent=function(e){e.type===v.Type.Removed&&this._panel.find('select[data-property="master-page"]').empty().append($("<option></option>"))},_.prototype._assignPresetSize=function(e){if("@infinite"===e)this._assignProperties(["w","h"],[0,0],o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size")),null,!0);else if("@trim"===e){this._ownChange=!0;var t=this._document.getEditor();t.beginTransaction();try{this._pages.forEach(e=>e.trimToContent())}finally{t.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size"))),this._ownChange=!1}}else{var n=this._document.getScene(),i=e.split("x"),r=n.stringToPoint(i[0]),a=n.stringToPoint(i[1]),s=+i[2];n.getProperty("dpi")!==s&&n.setProperty("dpi",s),this._assignProperties(["w","h"],[r,a],o.GLocale.get(new o.GLocaleKey("GPageProperties","action.change-size")))}},_.prototype._assignMasterPage=function(e){var t=this._document.getScene(),n=this._document.getEditor();if(e){n.beginTransaction();try{this._pages.forEach(n=>{var i=n.getMasterPages(),o=!1;i.forEach((function(i){e!==i?t.unlink(i,n):o=!0})),o||t.link(e,n)}),this._updateSlavePages(e)}finally{n.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPageProperties","action.assign-master-page")))}}else{n.beginTransaction();try{this._pages.forEach(e=>{e.getMasterPages().forEach((function(n){t.unlink(n,e)}))})}finally{n.commitTransaction(o.GLocale.get(new o.GLocaleKey("GPageProperties","action.assign-master-page")))}}},_.prototype.update=function(e,t,n){if(this._updateUI(),this._styleEditorChange)return this._styleEditorChange=!1,!0;if(this._ownChange)return!0;this._chooserElem&&this._chooserElem.gPatternChooser("close");var i=e!==this._oldDocument;if(this._oldDocument=e,this._document&&(this._document.getScene().removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.removeEventListener(p,this._settingChanged),this._document=null),this._pages=null,e&&(t=t.filter(e=>e instanceof o.GPage)).length)return this._pages=t.slice(),this._document=e,this._document.getScene().addEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.addEventListener(p,this._settingChanged,this),i&&this._updatePresetSizes(),this._updateProperties(n),!0;const a=gDesigner.getActiveDocument(),s=a&&a.getScene();if(gDesigner.isTouchEnabled()&&s&&s.getActivePage()){const e=gDesigner.getActiveView(),t=e&&e.getViewConfiguration();if(t&&t.elementAnnotations){const e=gDesigner.getToolManager().getActiveTool();if(!e||e instanceof r.GSelectTool)return!0}}return!1},_.prototype._afterPropertiesChange=function(e){e.node===this._pages[0]?this._updateProperties():!e.temporary&&e.node===this._document.getScene()&&e.properties.indexOf("ut")>=0&&(this._updatePresetSizes(),this._updateProperties()),this._updateSlavePages(e.node,e.properties)},_.prototype._updateUI=function(){this._removeOldHtmlElement(),gDesigner.isTouchEnabled()?y._reInitLayout.call(this):this._reInitLayout(),this._document?(this._updatePresetSizes(),this._updateProperties()):this._oldDocument&&this._updatePresetSizes()},_.prototype._removeOldHtmlElement=function(){this._removeHtmlElem(this._canvasPropertiesRowInNormal),this._canvasPropertiesRowInNormal=null,this._removeHtmlElem(this._hrAfterCanvasRow),this._hrAfterCanvasRow=null,this._removeHtmlElem(this._bleedRowInNormal),this._bleedRowInNormal=null,this._removeHtmlElem(this._pageSizeRowInNormal),this._pageSizeRowInNormal=null,this._removeHtmlElem(this._hrAfterPageSizeRow),this._hrAfterPageSizeRow=null,this._removeHtmlElem(this._canvasPropertiesRowInTouch),this._canvasPropertiesRowInTouch=null,this._removeHtmlElem(this._bleedRowInTouch),this._bleedRowInTouch=null},_.prototype._removeHtmlElem=function(e){e&&e.remove()},_.prototype._settingChanged=function(e){"decimals_num"===e.key?this._updateProperties():"touch"===e.key&&this._updateUI()},_.prototype._updateSlavePages=function(e,t){var n=["mt","mb","ml","mr","bop","bl","bck"];if(e instanceof o.GPage){t||(t=n);var i=n.filter(e=>t.indexOf(e)>=0);i.length&&e.getSlavePages().forEach(t=>{var n;t.setProperties(i,(n=[],i.forEach(t=>n.push(e.getProperty(t))),n))})}},_.prototype._updatePresetSizes=function(){var e=(this._document||this._oldDocument).getScene().getProperty("ut"),t=this._panel.find('select[data-property="preset-size"]').empty(),n=$("<optgroup></optgroup>").attr("label",o.GLocale.get(new o.GLocaleKey("GPageProperties","text.size-custom")));$("<option></option>").attr("value","@infinite").text(o.GLocale.get(new o.GLocaleKey("GPageProperties","text.size-infinite"))).appendTo(n),t.append(n),u.getPresets().forEach(n=>{var i=$("<optgroup></optgroup>").attr("label",n.name),r=!1;n.layouts.forEach(t=>{if(t.unit===e){var a=t.includes;if(a)for(var s=0;s<a.length;s++){var l=a[s];$("<option></option>").attr("data-preset-id",n.id).attr("data-preset-locale-en",o.GLocale.get(l.localeClass,null,o.GLocaleLanguage.English)).attr("value",l.width+"x"+l.height+"x"+(t.dpi||72)).text("".concat(l.name).concat(l.displaySize?" "+l.width+"x"+l.height:"")).appendTo(i)}else $("<option></option>").attr("data-preset-id",n.id).attr("data-preset-locale-en",o.GLocale.get(t.localeClass,null,o.GLocaleLanguage.English)).attr("value",t.width+"x"+t.height+"x"+(t.dpi||72)).text("".concat(t.name).concat(t.displaySize?" "+t.width+"x"+t.height:"")).appendTo(i);r=!0}}),n.hidden&&i.css({display:"none"}),r&&t.append(i)})},_.prototype._styleEditorEventHandler=function(e){this._styleEdOn&&e.type===r.GStyleEdManager.EditorEventType.PrepareModifiedEvent&&(this._styleEditorChange=!0)},_.prototype._updateProperties=function(e){var t=this._document.getScene(),n=this._pages[0],i=t.isFixedSized(),a=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.page"));gDesigner.isTouchEnabled()&&(a=a.toUpperCase());var s=a+" (";this._pages.length>1?s+=this._pages.length+" "+o.GLocale.get(new o.GLocaleKey("GCommonNames","text.pages")):s+=n.getProperty("name")||o.GLocale.get(new o.GLocaleKey("GCommonNames","text.active")),s+=")",this._toolbar.find("label:first-child").text(s),this._panel.find('input[data-property="bl"]').val(t.pointToString(n.getProperty("bl"),t.getOptimalDecimalsCount())),n.getProperty("bck")||(n.setProperty("bck",o.GRGBColor.WHITE),n.setProperty("bop",0));var l=n.getProperty("bck",!1,!1,!0);if(this._panel.find('[data-property-row="background"]').css("display",""),this._panel.find('[data-property="bck"]').css("display",l?"":"none").gPatternChooser("updateSettings",i?{types:[o.GColor,o.GGradient,o.GTexturePattern]}:{types:[o.GColor]}).gPatternChooser("setPattern",l).gPatternChooser("value",l).gPatternChooser("opacity",n.getProperty("bop",!1,!1,!0)),this._panel.find('input[data-property="bop"]').css("display",l?"":"none").gInputBox("value",o.GUtil.formatOpacity(100*n.getProperty("bop"))),i){var c=t.pointToString(n.getProperty("w"),t.getOptimalDecimalsCount())+"x"+t.pointToString(n.getProperty("h"),t.getOptimalDecimalsCount())+"x"+t.getProperty("dpi"),d=this._panel.find('select[data-property="preset-size"]');d.val(d.find('option[value="'+c+'"]').length?c:"@custom")}else this._panel.find('select[data-property="preset-size"]').val("@infinite");this._panel.find('input[data-property="w"]').gInputBox("value",t.pointToString(n.getProperty("w"),t.getOptimalDecimalsCount())),this._panel.find('input[data-property="h"]').gInputBox("value",t.pointToString(n.getProperty("h"),t.getOptimalDecimalsCount())),this._panel.find('input[data-property="mt"]').gInputBox("value",t.pointToString(n.getProperty("mt"),t.getOptimalDecimalsCount())),this._panel.find('input[data-property="mb"]').gInputBox("value",t.pointToString(n.getProperty("mb"),t.getOptimalDecimalsCount())),this._panel.find('input[data-property="ml"]').gInputBox("value",t.pointToString(n.getProperty("ml"),t.getOptimalDecimalsCount())),this._panel.find('input[data-property="mr"]').gInputBox("value",t.pointToString(n.getProperty("mr"),t.getOptimalDecimalsCount()));var u=this._panel.find('select[data-property="master-page"]').empty().append($("<option></option>")),p=-1,g=null;this._pages.forEach((function(e){var t=e.getMasterPages();t.length&&(null===g?g=t[0]:g!==t[0]&&(g=void 0))})),t.iteratePages(e=>{if(this._pages.indexOf(e)<0){p++;var t=$("<option></option>").data("page",e).attr("value",p).text(e.getProperty("name")).appendTo(u);g===e&&t.prop("selected",!0)}},!0),e&&(e.evtType===r.GEditor.ModifiedEvent.Type.Undo||e.evtType===r.GEditor.ModifiedEvent.Type.Redo)&&e.chooserOn&&e.pagePattern&&this._panel.find('[data-property="bck"]').find(".preview").trigger("click",null!==e.activeStopIdx?e.activeStopIdx:null),this.updatePropertiesAvailability(n)},_.prototype.updatePropertiesAvailability=function(e){var t=e.getProperty("plkt"),n=e.isFixedSized(),i=!1;if(t&&t&o.GBlock.ProgramLck.NoSizeChanges)this._panel.find('[data-property="bck"]').attr("disabled",!0),this._panel.find('input[data-property="bop"]').attr("disabled",!0),this._panel.find('input[data-property="w"]').attr("disabled",!0),this._panel.find('input[data-property="h"]').attr("disabled",!0),this._panel.find('button[data-property="rotate-canvas"]').attr("disabled",!0),this._panel.find('select[data-property="preset-size"]').attr("disabled",!0),this._panel.find('button[data-property="trim-canvas"]').attr("disabled",!0),this._manageClipButtonState(!1,!1),this._panel.find('input[data-property="bl"]').attr("disabled",!0),this._panel.find('input[data-property="mt"]').attr("disabled",!0),this._panel.find('input[data-property="mb"]').attr("disabled",!0),this._panel.find('input[data-property="ml"]').attr("disabled",!0),this._panel.find('input[data-property="mr"]').attr("disabled",!0),this._panel.find("[data-lock-margin]").attr("disabled",!0),this._panel.find('select[data-property="master-page"]').attr("disabled",!0);else{i=this._document&&this._document.isDocumentFromTemplate();var r=e.getProperty("bck",!1,!1,!0),a=this._panel.find('select[data-property="preset-size"]'),s=a.find('option[value="'+a.val()+'"]').data("preset-id"),l=i&&this._excludedPresets.includes(s);a.attr("disabled",l),this._panel.find('[data-property="bck"]').attr("disabled",!r),this._panel.find('input[data-property="bop"]').attr("disabled",!r),this._panel.find('input[data-property="w"]').attr("disabled",!1),this._panel.find('input[data-property="h"]').attr("disabled",!1),n?this._panel.find('button[data-property="rotate-canvas"]').attr("disabled",!1):this._panel.find('button[data-property="rotate-canvas"]').attr("disabled",!0),this._panel.find('button[data-property="trim-canvas"]').attr("disabled",!1),this._manageClipButtonState(gDesigner.getWindows().getActiveWindow()&&gDesigner.getWindows().getActiveWindow().getView()&&gDesigner.getWindows().getActiveWindow().getView().getViewConfiguration().paintMode===o.GScenePaintConfiguration.PaintMode.Output,n),this._panel.find('input[data-property="bl"]').attr("disabled",!1),this._panel.find('input[data-property="mt"]').attr("disabled",!1),this._panel.find('input[data-property="mb"]').attr("disabled",!1),this._panel.find('input[data-property="ml"]').attr("disabled",!1),this._panel.find('input[data-property="mr"]').attr("disabled",!1),this._panel.find("[data-lock-margin]").attr("disabled",!1);var c=!1,d=e.getScene();d&&f.CDR_ORIGIN_PROPERTY_NAME&&(c=!!d.getProperty(f.CDR_ORIGIN_PROPERTY_NAME,!0)),this._panel.find('select[data-property="master-page"]').attr("disabled",c).attr("i18n","text.plkt-no-size-changes")}var u=t&&t&o.GBlock.ProgramLck.NoSizeChanges?"text.plkt-no-size-changes":"text.infinite-canvas-no-size-changes";this._panel.find("[data-title]:not([default-data-title])").each((function(){const e=$(this);e.attr("default-data-title",e.attr("data-title")||"")})),this._panel.find(":disabled").each((function(){const e=$(this);l||(e.attr("default-data-title",e.attr("default-data-title")||""),e.attr("data-title",o.GLocale.get(new o.GLocaleKey("GCommonNames",e.attr("i18n")||u)).replace("%name",e.attr("default-data-title")||"")))})),this._panel.find(":not(:disabled)[default-data-title]").removeAttr("data-title").each((function(){const e=$(this);e.attr("default-data-title").length&&e.attr("data-title",e.attr("default-data-title"))}));const p=e=>$("<div></div>").addClass("tooltip-wrapper").attr("data-title",o.GLocale.get(new o.GLocaleKey("GCommonNames",e&&e.attr("i18n")||u)));this._panel.find(".tooltip-wrapper").remove(),this._panel.find("select:disabled").each((function(){l||p($(this)).insertAfter($(this))})),p().insertAfter(this._panel.find('[data-property="bck"][disabled]'))},_.prototype._manageClipButtonState=function(e,t){this._clipContentButton&&(t||this._clipContentButton.hasClass("g-disabled")?t&&(this._clipContentButton.hasClass("g-disabled")&&(this._clipContentButton.removeAttr("disabled"),this._clipContentButton.removeClass("g-disabled")),e?this._clipContentButton.addClass("g-active"):this._clipContentButton.removeClass("g-active")):(this._clipContentButton.attr("disabled",!0),this._clipContentButton.addClass("g-disabled"),this._clipContentButton.removeClass("g-active")))},_.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},_.prototype._assignProperties=function(e,t,n,i,r){this._ownChange=!0;var a=this._document.getEditor();a.beginTransaction();try{this._pages.forEach((function(n){var i=e,a=t;r&&(i=e.slice(),a=t.slice(),n.getProperty("bck")instanceof o.GColor||(i.push("bck"),a.push(o.GRGBColor.WHITE),i.push("bop"),a.push(1)));n.setProperties(i,a)}))}finally{a.commitTransaction(n,i||null),this._ownChange=!1}},_.prototype.toString=function(){return"[Object GPageProperties]"},e.exports=_},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=i(n(18)),s=n(193);const l=n(26);class c extends l{getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return a.default.CATEGORY_EDIT}getShortcut(){return[o.GKey.Constant.OPTION,"R"]}isVisible(){return!1}execute(){const e=gDesigner.getLeftSidebars().getActiveSidebar(),t=gDesigner.getLeftSidebars().getSidebar(s.SidebarsIds.GOutlineSidebar),n=t.getLayerPanel(),{currentFocus:i}=n.data("glayerpanel");if(i&&e===t.getId()){const e=n.gLayerPanel("getTitleOfLayer",$(i.row));e.gAutoEdit("open",e.data("gautoedit"))}}toString(){return"[Object GRenameLayerAction]"}}c.ID="edit.rename-layer",c.TITLE=new r.GLocaleKey("GRenameLayerAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(26)),s=i(n(18)),l=n(193);class c extends a.default{constructor(e){super(),this._type=e,this._title=new o.GLocaleKey("GChangeActivePageAction","title.".concat(this._type))}getId(){return"".concat(c.ID,".").concat(this._type)}getTitle(){return this._title}getCategory(){return s.default.CATEGORY_VIEW}isVisible(){return!1}getShortcut(){const e=[r.GKey.Constant.META,r.GKey.Constant.OPTION];switch(this._type){case c.Type.Next:return e.concat(r.GKey.Constant.DOWN);case c.Type.Previous:return e.concat(r.GKey.Constant.UP);default:return null}}getAdditionalShortcuts(){switch(this._type){case c.Type.Next:return[r.GKey.Constant.PAGE_DOWN];case c.Type.Previous:return[r.GKey.Constant.PAGE_UP];default:return null}}execute(){const e=gDesigner.getLeftSidebars(),t=e&&e.getSidebar(l.SidebarsIds.GOutlineSidebar),n=gDesigner.getActiveDocument(),i=n&&n.getScene();if(t&&i){const e=this.getNextPage(i);t.changeActivePage(e)}}getNextPage(e){const t=e.getActivePage();for(let e=this._getNextPageAccordingToType(t);null!==e;e=this._getNextPageAccordingToType(e))if(e instanceof o.GPage)return e;return null}_getNextPageAccordingToType(e){switch(this._type){case c.Type.Next:return e.getNext();case c.Type.Previous:return e.getPrevious();default:return null}}toString(){return"[Object GChangeActivePageAction]"}}c.ID="view.change-active-page",c.Type={Next:"next",Previous:"previous"},e.exports=c},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(18)),a=i(n(26));const s="designer.settings.enhanced-tooltips.enabled";let l=!0;function c(){gContainer.getProperty(s).then(e=>{"boolean"==typeof e&&(l=e)})}o.GObject.inherit(c,a.default),c.ID="help.tooltip-visibility",c.TITLE=new o.GLocaleKey("GEnhancedTooltipsAction","title"),c.GroupID="help/learn",c.StoragePropertyName=s,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return o.GLocale.get(c.TITLE)},c.prototype.getCategory=function(){return r.default.CATEGORY_HELP_LEARN},c.prototype.getGroup=function(){return c.GroupID},c.prototype.isCheckable=function(){return!0},c.prototype.isChecked=function(){return l},c.prototype.isEnabled=function(){return!0},c.prototype.execute=function(){l=!l,gContainer.setProperty(s,l)},c.prototype.statsValue=function(){return"".concat(c.ID,".").concat(l?"on":"off")},c.prototype.toString=function(){return"[Object GEnhancedTooltipsAction]"},e.exports=c},function(e,t,n){"use strict";n(9),n(83),n(28),n(14),n(29),n(84),n(63),n(19),n(24);var i=n(1);const{TRANSLATION_MANAGER:o}=n(12);function r(){}i.GObject.inherit(r,i.GObject),r.prototype._translationBase=null,r.prototype.getProjectsDescription=function(){return this._translationBase.getMapped().map(e=>e.project)},r.prototype.loadProjectTranslations=function(e){if(!i.GTranslation.Projects.hasOwnProperty(e))throw Error("Can't load translations, invalid project!");this._project=e,this._translations=this._translationBase.getByProject(e),this._classesMap=Object.keys(this._translations.find(e=>e.keyValue===i.GLocaleLanguage.English).translations)},r.prototype.getActiveProject=function(){return this._project},r.prototype._translations=null,r.prototype._project=null,r._CSV_SEPARATOR="|||",r.prototype.init=function(){return this._translationBase=new i.GTranslation,this.loadProjectTranslations(i.GTranslation.Projects.Designer),this._localeLanguage=i.GLocaleLanguage,this.isConsideringExtension()&&i.GLocale.enableExtension(),Promise.resolve()},r.prototype.getTranslationByKey=function(e){return this._translations.find(t=>t.keyValue===e)},r.prototype._clone=function(e){return JSON.parse(JSON.stringify(e))},r.prototype.getTranslationCopy=function(e){return this._clone(this.getTranslationByKey(e))},r.FormatTypes={CSV:"CSV"},r.prototype.import=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.FormatTypes.CSV,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];switch(t){case r.FormatTypes.CSV:return this._handleCSVImport(e).then(e=>this.applyTranslationPatch(e,n))}},r.prototype.applyTranslationPatch=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var n=t?this._translations:this._clone(this._translations);return e.forEach(e=>{var t=n.find(t=>t.language===e.language);let o=e.translations;Object.keys(o).forEach(e=>{Object.keys(o[e]).forEach(n=>{t.translations[e][n]=o[e][n]})});let r=e.translationsExtended;r&&Object.keys(r).forEach(e=>{if(0===Object.keys(r[e]).length)delete t.translationsExtended[e];else{t.translationsExtended||(t.translationsExtended={}),t.translationsExtended[e]||(t.translationsExtended[e]={}),Object.keys(r[e]).forEach(n=>{t.translationsExtended[e][n]=r[e][n]})}}),t.translationsExtended&&0===Object.keys(t.translationsExtended).length&&delete t.translationsExtended;var a=this._clone(e);delete a.translations,delete a.translationsExtended,t=i.GUtil.extend(t,a)}),Promise.resolve(n)},r.prototype.export=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.FormatTypes.CSV,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e){case r.FormatTypes.CSV:return this._exportAsCSV({language:t,onlyEmpty:n})}},r.prototype.getMetaData=function(){return Promise.resolve(JSON.stringify(this._translations,null,4))},r.prototype._exportAsCSV=function(e){let{language:t=null,onlyEmpty:n=!1}=e;const i=function(e){return e&&e.replace(/\r?\n|\r/g,"")||""};var o=null!=t&&!isNaN(t)&&this._translations.filter(e=>e.keyValue===t)||this._translations,a=[];const s=this._translations.find(e=>e.isDefault);return o.forEach(e=>{Object.keys(e.translations).forEach(t=>{Object.keys(e.translations[t]).forEach(o=>{var l;this.isConsideringExtension()&&(l=e.translationsExtended&&e.translationsExtended[t]&&e.translationsExtended[t][o]),n&&""!==e.translations[t][o].trim()||a.push([e.language,t,o,i(n?s.translations[t][o]:e.translations[t][o]),i(l)].join(r._CSV_SEPARATOR))})})}),Promise.resolve(a.join("\r\n"))},r.prototype._handleCSVImport=function(e){var t=e=>e.length>=4,n=[];return new Promise((o,a)=>{if(e){var s=e.split(/\r?\n/);if(s.length<1)return a("No rows were found!");for(let e=0;e<s.length;e++){var l=s[e],c=l.split(r._CSV_SEPARATOR);if(!t(c))return a("Invalid number of columns on row "+(e+1)+(l.trim().length?", content '"+l.substr(0,30)+"...'":", is empty"));var[d,u,p,g,h]=c;if(!i.GLocaleLanguage.hasOwnProperty(d))return a("Language not available ('".concat(d,"'), row ").concat(e+1,"!"));if(!this._classesMap.find(e=>e===u))return a("Reference to UI not available ('".concat(u,"')!, row ").concat(e+1));var f=this._translations.find(e=>e.language===d.trim());if(f){var m=n.find(e=>e.language===d);m||(m={language:d,translations:{}},n.push(m)),f.translations[u]&&(m.translations[u]||(m.translations[u]={}),f.translations[u].hasOwnProperty(p)&&(m.translations[u][p]=g,h&&this.isConsideringExtension()&&(m.translationsExtended||(m.translationsExtended={}),m.translationsExtended[u]||(m.translationsExtended[u]={}),m.translationsExtended[u][p]=h)))}}return o(n)}})},r.prototype.getTranslationRealName=function(e){var t=this._translations.find(t=>t.keyValue===e);return t?t.realName:null},r.prototype.createNewLanguage=async function(e,t,n){return new Promise((i,o)=>{var r=this.getTranslationTemplate();return r.language=e,r.realName=t,r.abbreviation=n,r.keyValue=this._localeLanguage.hasOwnProperty(e)?this._localeLanguage[e]:Math.max(...Object.values(this._localeLanguage))+1,this._translations.push(r),this._localeLanguage.hasOwnProperty(e)||(this._localeLanguage[e]=r.keyValue),i(r)})},r.prototype.getTranslationTemplate=function(){var e=this.getTranslationCopy(this._localeLanguage.Default);return e.keyValue=null,e.language=null,e.isDefault=!1,e.isAvailable=!0,e.abbreviation=null,Object.keys(e.translations).forEach(t=>{Object.keys(e.translations[t]).forEach(n=>{e.translations[t][n]=""})}),e.translationsExtended&&Object.keys(e.translationsExtended).forEach(t=>{Object.keys(e.translationsExtended[t]).forEach(n=>{e.translationsExtended[t][n]=""})}),e},r.prototype.isConsideringExtension=function(){return!!o.CONSIDER_EXTENSION},e.exports=r},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=i(n(18)),s=i(n(26)),l=n(193);class c extends s.default{constructor(e){super(),this._type=e,this._title=new r.GLocaleKey("GCycleThroughLayersAction","title.".concat(this._type))}getId(){return"".concat(c.ID,".").concat(this._type)}getTitle(){return this._title}getCategory(){return a.default.CATEGORY_VIEW}getShortcut(){switch(this._type){case c.Type.Next:return[o.GKey.Constant.TAB];case c.Type.Previous:return[o.GKey.Constant.SHIFT,o.GKey.Constant.TAB];default:return null}}isVisible(){return!1}execute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.Mode.Level;const t=gDesigner.getLeftSidebars().getActiveSidebar(),n=gDesigner.getLeftSidebars().getSidebar(l.SidebarsIds.GOutlineSidebar),i=n.getLayerPanel(),o=i.gLayerPanel("getCurrentFocusedNode");if(!o||t!==n.getId())return;const a=this._getNextNodeInIteration(e,o);if(a){const e=i.gLayerPanel("getItem",o),t=i.gLayerPanel("getItem",a);e.removeFlag(r.GNode.Flag.Selected),t.setFlag(r.GNode.Flag.Selected),i.gLayerPanel("setCurrentFocusedNode",a),i.gLayerPanel("relayout")}}_getNextNodeInIteration(e,t){switch(e){case c.Mode.Level:return this._getNextNodeOfCurrentLevel(t);case c.Mode.Focus:return this._getNextFocusableNode(t);default:return null}}_getNextNodeOfCurrentLevel(e){switch(this._type){case c.Type.Next:return e.next||e.parent.firstChild;case c.Type.Previous:return e.previous||e.parent.lastChild;default:return null}}_getNextFocusableNode(e){switch(this._type){case c.Type.Next:return e.getNextFocusableNode();case c.Type.Previous:return e.getPreviousFocusableNode();default:return null}}toString(){return"[Object GCycleThroughLayersAction]"}}c.ID="view.cycle-through-layers",c.Type={Next:"next",Previous:"previous"},c.Mode={Focus:"focus",Level:"level"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1);function o(){}i.GObject.inherit(o,i.GEvent),o.prototype.message=null,o.prototype.toString=function(){return"[Object GUnloadEvent]"},e.exports=o},function(e,t,n){"use strict";var i=n(1);function o(e,t){this.type=e,this.data=t}i.GObject.inherit(o,i.GEvent),o.Type={OpenInAppLink:1},o.prototype.type=null,o.prototype.data=null,e.exports=o},function(e,t,n){"use strict";n(9),n(163);var i=n(43),o=n(1);const{gApi:r}=n(12),a=n(352),s=n(200),l=n(77);function c(e){this._document=e,this._currentLock=null,this._openingInlineEditor=!1,this._alreadyRequestedAccess=!1,this._document.addEventListener(a,this._collaborationEvent,this,null,!0);const t=this._document.getEditor();t&&t.addEventListener(i.GEditor.InlineEditorEvent,this._inlineEditorEvent,this,null,!0)}c.StatusChangedEvent=function(e){this.status=e},o.GObject.inherit(c.StatusChangedEvent,o.GEvent),c.StatusChangedEvent.prototype.status=null,c.Status={Initial:0,Editing:1,Finished:2,Previewing:3,Previewed:4,Sending:5,UpdateAvailable:6,Updating:7},c.LockUpdateEvent=function(e){this.lock=e},o.GObject.inherit(c.LockUpdateEvent,o.GEvent),c.LockUpdateEvent.prototype.lock=null,c.prototype._status=c.Status.Initial,c.prototype._openingInlineEditor=!1,c.prototype._currentLock=null,c.prototype._alreadyRequestedAccess=!1,c.prototype.detach=function(){this._document.removeEventListener(a,this._collaborationEvent,this);const e=this._document.getEditor();e&&e.removeEventListener(i.GEditor.InlineEditorEvent,this._inlineEditorEvent,this)},c.prototype.getStatus=function(){return this._status},c.prototype.getCurrentLock=async function(){return this._currentLock||(this._currentLock=await r.lock.get(this._document.getId()).catch(()=>null),this._currentLock&&this._fireLockUpdateEvent()),this._currentLock},c.prototype.acquireLock=async function(){return await this.canLock()?(this._currentLock||(this._currentLock=await r.lock.acquire(this._document.getId()).catch(()=>null),this._currentLock&&this._fireLockUpdateEvent()),this._currentLock):null},c.prototype.releaseLock=function(){return r.lock.release(this._document.getId()).then(()=>{this._currentLock=null})},c.prototype.canLock=async function(){return!await this.getCurrentLock()||this.isLockedByMe()},c.prototype.isLockedByMe=function(){if(!this._currentLock)return!1;const e=gDesigner.getSyncUser();return this._currentLock.isLockedBy(e)},c.prototype.reloadDocument=async function(){this._updateStatus(c.Status.Updating);const e=t=>{t.status!==l.Loading&&(this._document.removeEventListener(s,e),this._document.unlock(),this.resetTextEditing())};await this.releaseLock(),this._document.addEventListener(s,e),this._document.lock(),this._document.reload()},c.prototype.resetTextEditing=function(){this._updateStatus(c.Status.Initial)},c.prototype.finishTextEditing=async function(){this._closeInlineEditor(),this._updateStatus(c.Status.Finished)},c.prototype.backToTextEditing=async function(){this._closeInlineEditor(),this._updateStatus(c.Status.Editing)},c.prototype.sendChanges=async function(){return this._closeInlineEditor(),this._document.lock(),this._updateStatus(c.Status.Sending),new Promise(async(e,t)=>{this._document.storeToCloud(this._document.getScene(),async()=>{await this.releaseLock().catch(e=>console.error(e)),e()},t,!0,{collabTextUpdate:!0,sendEmail:!0})}).then(async()=>{await gDesigner.updateCollabTextPreviews().catch(e=>console.error(e)),this.resetTextEditing()}).catch(e=>{throw this.finishTextEditing(),this._document.updateStatus(l.SaveCancelled),this._document.updateStatus(l.Ready),e}).finally(()=>{this._document.unlock()})},c.prototype.previewChanges=async function(){return this._closeInlineEditor(),this._updateStatus(c.Status.Previewing),this._document.lock(),gDesigner.updateCollabTextPreviews().then(()=>{this._updateStatus(c.Status.Previewed)}).catch(()=>{this.finishTextEditing()}).finally(()=>{this._document.unlock()})},c.prototype.requestAccess=async function(){return r.lock.request(this._document.getId()).then(()=>this._alreadyRequestedAccess=!0)},c.prototype.hasAlreadyRequestedAccess=function(){return this._alreadyRequestedAccess},c.prototype._updateStatus=function(e){e!==this._status&&(this._status=e,this._document.hasEventListeners(c.StatusChangedEvent)&&this._document.trigger(new c.StatusChangedEvent(this._status)))},c.prototype._closeInlineEditor=function(){const e=this._document.getEditor();e&&(e.closeInlineEditor(),e.clearSelection())},c.prototype._inlineEditorEvent=function(e){switch(e.type){case i.GEditor.InlineEditorEvent.Type.TryOpen:this._tryOpenInlineEditor(e)}},c.prototype._tryOpenInlineEditor=async function(e){if(!this._openingInlineEditor&&this._document.isCollaborativeTextEditing())if(e.editor.disableInlineEditingSupport(),e.editor instanceof i.GCollabTextEditor){this._openingInlineEditor=!0;try{gDesigner.toggleLoading(!0);if(!await this.acquireLock())return void this._closeInlineEditor();e.editor.enableInlineEditingSupport();const t=this._document.getEditor();if(t){const n=this._document.getActiveWindow(),i=n&&n.getView();i&&t.openInlineEditor(e.editor.getElement(),i)&&this._updateStatus(c.Status.Editing)}}finally{this._openingInlineEditor=!1,gDesigner.toggleLoading(!1)}}else this._closeInlineEditor()},c.prototype._fireLockUpdateEvent=function(){this._document.hasEventListeners(c.LockUpdateEvent)&&this._document.trigger(new c.LockUpdateEvent(this._currentLock))},c.prototype._collaborationEvent=function(e){if(e.type===a.Type.LockUpdated)this._currentLock=e.data,this._fireLockUpdateEvent();else if(e.type===a.Type.FileUpdate){if(e.data&&e.data.from===gDesigner.getSyncUser().id)return;this._updateStatus(c.Status.UpdateAvailable)}},e.exports=c},function(e,t,n){"use strict";e.exports={CheckingForUpdate:"checking-for-update",UpdateAvailable:"update-available",UpdateNotAvailable:"update-not-available",Error:"error",DownloadProgress:"download-progress",UpdateDownloaded:"update-downloaded",CommandInstallUpdate:"install-update",CommandDownloadUpdate:"donwload-update",CommandCheckForUpdates:"check-for-updates"}},function(e,t,n){"use strict";n(9),n(25);const i=n(306),o=n(1221),{gApi:r,PurchaseStatus:a}=n(12),{IS_TRUNK:s}=n(198);let l;class c{static getInstance(){return l||(l=new c),l}waitForPurchase(){return this.cancelPurchase(),this._promiseCapabilities={},new Promise((e,t)=>{Object.assign(this._promiseCapabilities,{resolve:e,reject:t}),this._ws=new r.WebSocketClient,this._ws.connect("/payload"),this._ws.on("payload",async t=>{try{const{data:n}=t;await this._tryCheckLicense(),await this._tryFireEvent(n),e(n)}finally{this._ws.close()}})})}cancelPurchase(){this._promiseCapabilities&&this._promiseCapabilities.resolve&&this._promiseCapabilities.resolve(),this._ws&&this._ws.close()}async _tryCheckLicense(){try{await i.checkLicense()}catch(e){console.error("GLicenseManager.checkLicense",e)}}async _tryFireEvent(e){try{this._shouldFireUserCompletedPurchaseEvent(e)&&o.fireEvent(o.Events.USER_COMPLETED_PURCHASE_EVENT)}catch(e){console.error("GTMHelper.fireEvent",e)}}_shouldFireUserCompletedPurchaseEvent(e){const{statusId:t}=e;return!(!s||t!==a.SuccessfulTestOrder)||t===a.Paid}}e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildLayerItemContainer=function(e,t,n,r){var a=$(e);a.attr("draggable",!1),a.gPro({pro:t instanceof i.GElement&&!!t.getProperty("_pro",!0)});var s=$("<span></span>").addClass("layer-title-group").toggleClass("g-selected",t.hasFlag(i.GNode.Flag.Selected));s.appendTo(a),a.on("mouseenter",(function(e){t.hasFlag(i.GElement.Flag.Hidden)||t.setFlag(i.GNode.Flag.Highlighted)})).on("mouseleave",(function(e){t.hasFlag(i.GElement.Flag.Hidden)||t.removeFlag(i.GNode.Flag.Highlighted)}));var l=t.getProperty("name");l=l||t.getNodeNameTranslated();var c=$("<span></span>").html(l);c.addClass("layer-title").appendTo(s);var d=function(e){return e instanceof i.GSymbol&&!!e.getMasterSymbol()};(d(t)||t.findParent(d))&&a.addClass("g-symbol-row");a.toggleClass("g-active",t.hasFlag(i.GNode.Flag.Active)).toggleClass("g-has-selection",n).toggleClass("g-selected",t.hasFlag(i.GNode.Flag.Selected));var u,{icon:p,overlayIcon:g}=o(t,r);p&&("<svg"===p.substr(0,4)?u=$("<span></span>").addClass("layer-icon").append($(p).addClass("layer-icon").attr({width:"16px",height:"16px"}).css({verticalAlign:"middle",paddingLeft:"1px",opacity:"initial"})).insertBefore(c):(gDesigner.isTouchEnabled()&&(p+="-small"),u=$("<span></span>").addClass("layer-icon "+p).css({opacity:"initial"}).insertBefore(c)));g&&u&&g.appendTo(u);return{container:a,title:c,titleGroup:s}},t.getIconByLayerType=o,t.getLayerOrItemStatus=function(e){var t=!1,n=null,o=!1,r=e;for(;(r=r.getParent())&&!(r instanceof i.GScene);){r instanceof i.GBlock&&(t=!1===r.getProperty("vis")||t,(s=r.getProperty("lkt"))&&(n?s===i.GBlock.LockType.Full&&(n=s):n=s)),r instanceof i.GLayer&&(o=!0===r.getProperty("otl")||o)}var a=t||!1===e.getProperty("vis"),s=n||e.getProperty("lkt"),l=o||e instanceof i.GLayer&&e.getProperty("otl"),c=!1;if(e.hasMixin(i.GNode.Container))for(var d=e.getFirstChild();null!==d&&!c;d=d.getNext())d instanceof i.GItem&&d.hasFlag(i.GNode.Flag.Selected)&&(c=!0);return{parentHidden:t,parentLockType:n,parentOutlined:o,isHidden:a,lockType:s,isOutlined:l,hasSelection:c}};var i=n(1);function o(e,t){var n=null,o=null;if(e instanceof i.GLayer?n=t?"gravit-icon-folderopen":"gravit-icon-folderclose":e instanceof i.GSlice?n="gravit-icon-slice":e instanceof i.GGroup?n="gravit-icon-group":e instanceof i.GShape?e instanceof i.GPathsGraph?n="gravit-icon-pathgraph3":e instanceof i.GSimpleShape?n=e.getIcon():e instanceof i.GText?(n="gravit-icon-textbox",e.isFakeText()&&(o=$("<div></div>").addClass("layer-icon-overlay"))):e instanceof i.GImage?n="gravit-icon-picture":e instanceof i.GEllipse?n="gravit-icon-ellipse":e instanceof i.GRectangle?n="gravit-icon-rectangle":e instanceof i.GPath||e instanceof i.GCompoundPath?n="gravit-icon-pen":e instanceof i.GPolygon?n="gravit-icon-polygon":e instanceof i.GCompoundShape&&(n="gravit-icon-merge-union"):e instanceof i.GSymbol&&(n="gravit-icon-symbol",e.isMaster()?n+="master":e.getMasterSymbol()?n+="instance":n+="detached"),e instanceof i.GShape&&e.getParent()instanceof i.GCompoundShape&&e.getPrevious())switch(e.getProperty("bool")){case i.GVertexPolyBoolean.OR:n="gravit-icon-merge-union";break;case i.GVertexPolyBoolean.AND:n="gravit-icon-merge-intersect";break;case i.GVertexPolyBoolean.SUB:n="gravit-icon-merge-subtract";break;case i.GVertexPolyBoolean.XOR:n="gravit-icon-merge-difference"}return{icon:n,overlayIcon:o}}},function(e,t,n){"use strict";const{GLocale:i,GLocaleKey:o}=n(1),r=n(793);e.exports={ADDITIONAL_COLLABORATORS:{MENTION_ALL_REVIEWERS:new r({name:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-reviewers-name")),showText:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-reviewers-show-text")),id:"@reviewers",avatar:"assets/icon/notification-icon.svg",fontWeight:"bold",type:"contact",role:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-reviewers-role")),email:""}),MENTION_ALL_APPROVERS:new r({name:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-approvers-name")),showText:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-approvers-show-text")),id:"@approvers",avatar:"assets/icon/notification-icon.svg",fontWeight:"bold",type:"contact",role:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-approvers-role")),email:""}),MENTION_ALL_CO_AUTHORS:new r({name:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-co-author-name")),showText:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-co-author-show-text")),id:"@coauthors",avatar:"assets/icon/notification-icon.svg",fontWeight:"bold",type:"contact",role:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-co-author-role")),email:""}),MENTION_ALL:new r({name:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-name")),showText:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-show-text")),id:"@all",avatar:"assets/icon/notification-icon.svg",fontWeight:"bold",type:"contact",role:i.get(new o("GAnnotationPanel","text.additional-collaborators-all-role")),email:""}),MENTION_OWNER:new r({name:i.get(new o("GAnnotationPanel","text.additional-collaborators-owner-name")),showText:i.get(new o("GAnnotationPanel","text.additional-collaborators-owner-show-text")),id:"@owner",avatar:"assets/icon/notification-icon.svg",fontWeight:"bold",type:"contact",role:i.get(new o("GAnnotationPanel","text.additional-collaborators-owner-role")),email:""})}}},function(e,t,n){"use strict";function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,{fileCache:!0,collaboratorsCache:!0},e)}n(25),n(3),i.NO_CACHE_INVALIDATION=Object.freeze(new i({fileCache:!1,collaboratorsCache:!1})),i.prototype.collaboratorsCache=!0,i.prototype.fileCache=!0,i.prototype.toString=function(){return"[Object GInvalidationOptions]"},e.exports=i},function(e,t,n){"use strict";n(9);var i=n(1);function o(e,t,n,i,o,r,a,s,l,c){this._container=e,this._renderer=t,this._nodeStyle=n,this._expandStyle=i,this._nodeClick=o,this._nodeExpand=r,this._upSpan1Style=a,this._upSpan2Style=s,this._downSpan1Style=l,this._downSpan2Style=c}o.GSimpleTreeNodeNamed=function(e){this.id=e},o.GSimpleTreeNodeNamed.prototype.id=-1,o.GSimpleTreeNodeNamed.prototype.virtualNode=!1,o.GSimpleTreeNodeNamed.prototype._depth=void 0,o.GSimpleTreeNodeNamed.prototype.isVisible=function(){return!0},o.EXPAND_ID=i.GUtil.uuid(),o.COLLAPSE_ID=i.GUtil.uuid(),o.prototype._container=null,o.prototype._renderer=null,o.prototype._nodeStyle=null,o.prototype._expandStyle=null,o.prototype._nodeClick=null,o.prototype._nodeExpand=null,o.prototype._upSpan1Style=null,o.prototype._upSpan2Style=null,o.prototype._downSpan1Style=null,o.prototype._downSpan2Style=null,o.prototype._updateCount=0,o.prototype._nodes=[],o.prototype._invalidation=null,o.prototype.refresh=function(){this.requestInvalidation()},o.prototype._checkTreeSanity=function(){return!0},o.prototype._isInvalidationBlocked=function(){return!0},o.prototype._beforeInvalidationStart=async function(e){},o.prototype._afterInvalidationEnd=function(e){},o.prototype.requestInvalidation=function(e,t){if(null===this._invalidation){var n=$(this._container);if(!this._checkTreeSanity())return;this._invalidation=setTimeout(()=>{if(this._isInvalidationBlocked())return this._invalidation=null,void this.requestInvalidation(500);this._beforeInvalidationStart(t).then(()=>{n.empty();let e=document.createDocumentFragment();for(let t=0;t<this._nodes.length;t++){let n=this._newNode(this._nodes[t]),i=this._renderer(this._nodes[t],n[0]);$(e).append(n),n.hasClass("last-row")&&$(e).append($("<div/>").addClass("last-row-division")),i&&i.length&&n.before(i)}n.append(e),this._afterInvalidationEnd(),this._invalidation=null})},e||1)}},o.prototype.expandAndFocus=function(){},o.prototype.beginUpdate=function(){this._updateCount++},o.prototype.endUpdate=function(e){this._updateCount=Math.max(0,this._updateCount-1),0===this._updateCount&&this.requestInvalidation(0,e)},o.prototype._newNode=function(e){return $("<div>").addClass(this._nodeStyle).attr("id",e.id).css("padding-left",25*e._depth).on("click",t=>{t.stopPropagation(),this._nodeClick(e)})},o.prototype.appendNode=function(e,t,n){var i=e?this._nodes.indexOf(e):0;if(i<0)console.error("no parent found");else if(this._nodes.indexOf(t)>=0)console.error("node already added");else{var o,r=e?e._depth:-1;if(t._depth=r+1,n)for(var a=o=e?i+1:0;a<this._nodes.length;a++){if(this._nodes[a]._depth<=r||this._nodes[a].virtualNode){o=Math.max(0,a-1);break}o=a}else o=e?i:0;var s=null;s=o>=this._nodes.length?this._nodes.length?this._nodes[this._nodes.length-1]:null:this._nodes[o],this.insertNodeAfter(s,t)}},o.prototype.prependNode=function(e,t){if((e?this._nodes.indexOf(e):0)<0)console.error("no parent found");else if(this._nodes.indexOf(t)>=0)console.error("node already added");else{var n=e?e._depth:-1;t._depth=n+1,this.insertNodeAfter(e,t)}},o.prototype.removeNode=function(e){var t=this._nodes.indexOf(e);if(!(t<0)){var n=$(this._container);n.find("#"+this._nodes[t].id).remove(),this._nodes.splice(t,1);for(var i=this._nodes[t];i&&e._depth<i._depth;)n.find("#"+i.id).remove(),this._nodes.splice(t,1),i=this._nodes[t]}},o.prototype.insertNodeAfter=function(e,t){var n=e?this._nodes.indexOf(e):this._nodes.length;if(n<0)console.error("no ref node found");else if(this._nodes.indexOf(t)>=0)console.error("node already added");else{var i=e?e._depth:0;if(void 0===t._depth)t._depth=i;else if(t._depth>i)return void this._nodes.splice(n+1,0,t);for(n+=1;this._nodes[n]&&(this._nodes[n]._depth>i||this._nodes[n].virtualNode&&(0===i||this._nodes[n]._depth<i));)n++;n>=this._nodes.length?this._nodes.push(t):this._nodes.splice(n,0,t)}},o.prototype.insertNodeBefore=function(e,t){var n=e?this._nodes.indexOf(e):-1;if(n<0)console.error("no ref node found");else if(this._nodes.indexOf(t)>=0)console.error("node already added");else{var i=e?e._depth:0;for(void 0===t._depth&&(t._depth=i);n>=0&&(this._nodes[n]._depth>i||this._nodes[n].virtualNode);)n--;n<0?this._nodes.unshift(t):this._nodes.splice(n,0,t)}},o.prototype.clean=function(){this._nodes=[],this.requestInvalidation()},o.prototype.isPendingInvalidation=function(){return null!==this._invalidation},o.prototype.refresh=function(){},e.exports=o},function(e,t,n){"use strict";var i=n(17);n(14),n(63),n(84),n(58),n(19),n(24),n(9),n(28),n(132),n(25),n(29);var o=n(12),r=n(792),a=n(1234),s=n(238),l=n(56),c=i(n(323)),d=i(n(1207)),u=i(n(793));const{GSystem:p,GLocale:g,GLocaleKey:h,GUtil:f,GComment:m,GAnnotation:y,GObject:v,GNode:_}=n(1),{NEW_COMMENT_READ_TIMEOUT:b,ANNOTATION_PERMANENT_LINK:w,IS_COREL:C}=n(12),E=n(1078),S=n(1054),G=n(387),{getAnnotationType:A}=n(32);function T(e){let{container:t,annotation:n,relatedNodesCount:i,sidebarActive:o,isLastRow:r,mentionData:a,onMouseEnter:s,onMouseLeave:l,onChange:c,onToggleState:d,onResolve:u,onReopen:p,onDelete:g,onCancel:h,onExpandClick:f,onCopyPermalinkClick:m,onAssignTo:y,mainAnnotObject:v,isCommentingEditingEnable:_,hasResolveAccess:b,hasReopenAccess:w}=e;this._container=t,this._annotation=n,this._relatedNodesCount=i,this._sidebarActive=o,this._isLastRow=r,this._onMouseEnter=s,this._onMouseLeave=l,this._onChange=c,this._onToggleState=d,this._onResolve=u,this._onReopen=p,this._onDelete=g,this._onCancel=h,this._onExpandClick=f,this._onCopyPermalinkClick=m,this._onAssignTo=y,this._mainAnnotObject=v,this._shouldAssign=!1,this._assignees=[],this._mentionsCollection=[],this._data=a.data,this._owner=a.owner,this._additionalMentions=a.additionalMentions,this._mentionData=a,this._isCommentingEditingEnable=_,this._hasResolveAccess=b,this._hasReopenAccess=w,this._init()}function P(e){if(13!==e.keyCode)return!1;if(p.operatingSystem!==p.OperatingSystem.OSX_IOS){if(!e.shiftKey)return!0}else{if(!e.altKey)return!0;if("keydown"===e.type){let t=$(e.target).val();$(e.target).val(t+"\n")}}return!1}function L(e){return t=>t.getFirstName()===e||t.getFullUserName()===e||t.getEmail()===e}function D(e){return Object.values(a.ADDITIONAL_COLLABORATORS).find(t=>t.getUID()===e)}function x(e){return f.xss(e)}v.inherit(T,E),T.prototype._isRead=!1,T.prototype._isTypeResolved=!1,T.prototype._isTypeReopened=!1,T.prototype._isParentAnnotResolved=!1,T.prototype._init=function(){var e,t=this._container,n=this._annotation,i=A(this._annotation instanceof m?this._annotation._parent:this._annotation),o=this,a=gDesigner.getSyncUser(),s=c.default.isOwner(a,n),d=gDesigner.getApplicationManager();const u=this._isCommentingEditingEnable&&(this._hasResolveAccess||s),f=this._isCommentingEditingEnable&&(this._hasReopenAccess||s);var v=$("<span></span>").addClass("annotation-title-group").appendTo(t);t.on("mouseenter",this._onMouseEnter).on("mouseleave",this._onMouseLeave);var b=$("<div/>").addClass("email-and-role-tooltop").appendTo(v);gDesigner.getShareManager().getRoleNameByUserId(n.getProperty("uid")).then(e=>{b.gRichTooltip(l.GRichTooltipConfig.from({title:n.getProperty("email")||a.getEmail()||" ",description:e,forceShow:!0,middle:!1,flipHorizontal:!0,marginLeft:26}))});var E=n.getProperty("name");E=E||n.getProperty("login")||n.getProperty("email").split("@")[0]||g.get(new h("GAnnotationPanel","text.empty"));var T=$("<span></span>").html(x(E)).addClass("annotation-title").appendTo(b);gDesigner.getShareManager().getCollaboratorById(n.getProperty("uid")).then(e=>{const t=S.getUserDataFromAnnotAndUser(n,e||a);new S(t).build().addClass("g-user-comment-preview").insertBefore(T)});var L=new Date(n.getProperty("mtime")||n.getProperty("time")),D=g.toLocaleDate(L,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"});$("<span>").text("·").addClass("dot").appendTo(v),$("<span></span>").text(D).addClass("annotation-date").appendTo(v),this._annotationCommentContainer=$("<div/>").addClass("annotation-comment-container").appendTo(t),this._contentEditorButtons=$("<div>");var I=$("<span></span>").addClass("annotation-comment-content").appendTo(this._annotationCommentContainer);if(n instanceof m)switch(this._updateParentAnnotResolvedStatus(n.getParent()),n.getProperty("type")){case m.Type.User:e=this._generateCommentContentHTML(n),I.html(e.html),this._updateReadUnreadStatus(v);break;case m.Type.Open:I.addClass("automatic").text(g.get(new h("GAnnotationPanel","text.re-opened"))),this._updateReadUnreadStatus(v),this._isTypeReopened=!0,this._isTypeResolved=!1;break;case m.Type.Close:I.addClass("automatic").text(g.get(new h("GAnnotationPanel","text.marked-as-resolved"))),this._isRead=!0,this._isTypeResolved=!0,this._isTypeReopened=!1}else this._updateParentAnnotResolvedStatus(n),e=this._generateCommentContentHTML(n),I.html(e.html),this._updateReadUnreadStatus(v);var O=e=>{((e=((e=r.replaceAdditionalCollabShowTextBeforeSend.call(this,e))||"").trim())||n.isEmptyTextAllowed())&&(this._onChange(e),this._shouldAssign&&this._assignees&&this._assignees.length&&o._onAssignTo(o._assignees))},k=$("<textarea></textarea>").appendTo(this._annotationCommentContainer).addClass("annotation-comment-editor").addClass("mention").on("click",(function(e){o.isEditMode()&&e.stopPropagation()})).on("blur",(function(){!o.isEditMode()||o._mentionsCollection&&o._mentionsCollection.length||(O(this.value),o.cancelEditMode())})).on("keydown",(function(e){o.isEditMode()&&P(e)&&e.preventDefault()})).on("keypress",(function(e){o.isEditMode()&&p.operatingSystem===p.OperatingSystem.OSX_IOS&&13===e.keyCode&&e.altKey&&e.preventDefault()})).on("keyup",(function(e){const t=k.parent().find(".mentions-autocomplete-list").data("assign");o.isEditMode()&&(P(e)&&!t?(O(this.value),o.cancelEditMode(),e.preventDefault()):27===e.keyCode&&(o.cancelEditMode(),o._onCancel()))}));if(k.mentionsInput({elastic:!1,onDataRequest:(e,t,n)=>{let i=this._data.filter(e=>e.getFullUserName().toLowerCase().includes(t.toLowerCase())||e.getEmail()&&e.getEmail().toLowerCase().includes(t.toLowerCase()));i.push(...this._additionalMentions),n.call(this,i)},onSelectItem:()=>{gDesigner.stats("commentdocker_mention_select-user",i)}}).on("input",(function(){r.showAssigneeRow.call(o,k),this.style.height=0,this.style.height=this.scrollHeight+"px"})),this._annotationCommentContainer.find(".mentions-autocomplete-list").delegate("li","mousedown",()=>{r.showAssigneeRow.call(this,k)}),this.setMentionOverlayBorderVisiblity(!1),this._onlyOneAssignee=$("<span>").addClass("only-one-assignee").html(1===this._mentionsCollection.length?this._mentionsCollection[0].name:"").css("display","none"),this._assigneeSelector=$("<div>").addClass("assignee-selector").css("display","none").append($("<select>").on("change",e=>{r.updateAssignee.call(this,$(e.target).val())})),this._assigneeCheckBox=$("<input>").attr("type","checkbox").prop("checked",this._shouldAssign).on("change",e=>{this._shouldAssign=$(e.target).prop("checked"),gDesigner.stats("commentdocker_mention_assign-user",i)}),this._assigneeRow=$("<div>").css("display","none").addClass("assignee-row-container").append($("<label>").addClass("label").addClass("assignee-row-label").append(this._assigneeCheckBox).append($("<span>").html(g.get(new h("GAnnotationPanel","text.assign-to")))).append(this._onlyOneAssignee).append(this._assigneeSelector)).appendTo(this._annotationCommentContainer),this._contentEditorButtons.appendTo(this._annotationCommentContainer).css("display","none").addClass("contenteditor-buttonrow").append($("<button>").addClass("annotations-cancelcomment").text(g.get(new h("GAnnotationPanel","text.cancel"))).on("mousedown",e=>{e.preventDefault()}).on("click",e=>{e.stopPropagation(),gDesigner.stats("commentdocker_cancel-btn",i),o.cancelEditMode(),o._onCancel()})).append($("<button>").addClass("annotations-addcomment").text(g.get(new h("GAnnotationPanel","text.fill-contents"))).on("mousedown",e=>{e.preventDefault()}).on("click",e=>{e.stopPropagation(),gDesigner.stats(n.getProperty("text").trim().length>0?"commentdocker_edit-btn":"commentdocker_add-btn",i),O(k.val()),o.cancelEditMode()})),$(t).toggleClass("g-active",n.hasFlag(_.Flag.Active)).toggleClass("g-selected",n.hasFlag(_.Flag.Selected)||n instanceof m&&n.getParent().hasFlag(_.Flag.Selected)),this._relatedNodesCount>1)this.isCollapsible()?(this._container.addClass("collapsible"),this._expandIcon=$("<div></div>").addClass(this._mainAnnotObject.expanded?"gravit-icon-down ":"gravit-icon-right").addClass("annotation-collapse").click(this._onExpandClick),v.prepend(this._expandIcon)):this._mainAnnotObject.expanded?t.show():t.hide();else{const e=$("<div></div>").addClass("annotation-collapse-empty");v.prepend(e)}(n.hasFlag(_.Flag.Selected)||n instanceof m&&n.getParent().hasFlag(_.Flag.Selected))&&(this.setCollapseState(!0),this.setVisiblity(!0));var F=$("<span>").addClass("annotation-action-group").appendTo(v);if(this._isCommentingEditingEnable&&n.hasMixin(y)){var R=n.getProperty("rsv"),M=!1,N="";R?(M=!0,N=f?g.get(new h("GAnnotationPanel","text.reopen")):g.get(new h("GAnnotationPanel","text.marked-as-resolved"))):(M=!1,N=g.get(new h("GAnnotationPanel","text.resolve"))),!R&&!f||(n.getProperty("asgn")||[]).length||$("<span>").addClass("icon "+(R?"gravit-icon-resolved":"gravit-icon-resolve")).addClass(M?"visible":"").addClass("annotation-action").attr("data-title",N).click(e=>{e.stopPropagation(),d.hasAccess(G.RESOLVE_COMMENT_ANNOTATION).then(e=>{e||s?this._onToggleState(n):d.hasAccess(G.REOPEN_COMMENT_ANNOTATION).then(e=>{(e||s)&&this._onToggleState(n)})})}).appendTo(F)}var B=$("<span>").append($("<span></span>").addClass("gravit-annotation-icon-menu")).addClass("annotationpanel-menubutton").addClass("annotation-action"),U=$("<div></div>").addClass("annotations-menu").gOverlay({releaseOnClose:!1,closeCallback:()=>{B.removeClass("g-active")}});if(t.data("annotmenu",U),n.hasMixin(y)&&(u||f)&&!(n.getProperty("asgn")||[]).length&&(n.getProperty("rsv")?U.append($("<label>").append($("<span>").addClass("icon gravit-icon-reopen").addClass("annot-menu-icon")).on("click",e=>{e.stopPropagation(),gDesigner.stats("commentdocker_option_reopen",i),U.gOverlay("close"),this._onReopen(n)}).append($("<span>").text(g.get(new h("GAnnotationPanel","text.reopen"))))):U.append($("<label>").append($("<span>").addClass("icon ".concat(C?"gravit-icon-resolved":"gravit-icon-resolve")).addClass("annot-menu-icon")).on("click",e=>{e.stopPropagation(),gDesigner.stats("commentdocker_option_resolve",i),U.gOverlay("close"),this._onResolve(n)}).append($("<span>").text(g.get(new h("GAnnotationPanel","text.resolve")))))),s&&(n.hasMixin(y)&&!n.getProperty("rsv")||n instanceof m&&!n.getParent().getProperty("rsv"))&&n.isFillingCompleted()){const e=n.getProperty("text").trim().length>0;this._isCommentingEditingEnable&&U.append($("<label>").append($("<span>").addClass("icon gravit-icon-edit").addClass("annot-menu-icon")).on("click",function(t){t.stopPropagation();let r=e?"commentdocker_option_edit":"commentdocker_option_add";gDesigner.stats("".concat(r),i),o._startEditMode(o._annotationCommentContainer,n.getProperty("text").trim().length>0,n.getProperty("text"),I.outerWidth(),I.outerHeight(),o._data,o._additionalMentions),U.gOverlay("close")}.bind(I)).append($("<span>").text(g.get(new h("GAnnotationPanel",e?"text.edit-comment":"text.add-comment")))))}s&&this._isCommentingEditingEnable&&U.append($("<label>").append($("<span>").addClass("icon gravit-icon-trash").addClass("annot-menu-icon")).on("click",e=>{e.stopPropagation(),gDesigner.stats("commentdocker_option_delete",i),U.gOverlay("close"),this._onDelete(n)}).append($("<span>").text(g.get(new h("GAnnotationPanel","text.delete")))));const K=gDesigner.getActiveDocument();w&&K&&K.isShareable()&&U.append($("<label/>").append($("<span/>").addClass("icon gravit-icon-copy-annot").addClass("annot-menu-icon")).append($("<span>").text(g.get(new h("GAnnotationPanel","text.copy-permalink")))).on("click",async e=>{e.stopPropagation(),gDesigner.stats("commentdocker_option_copy-permalink",i);const t=$("<span/>").addClass("g-loading").appendTo($(e.target).closest("label"));try{await this._onCopyPermalinkClick(this._annotation)}finally{t.remove(),U.gOverlay("close")}})),(n.hasMixin(y)||n.getProperty("type")===m.Type.User)&&U.find(".annot-menu-icon").length&&B.on("click",e=>{e.stopPropagation(),B.addClass("g-active"),U.gOverlay("open",$(e.target).closest("span").closest("span"))}).appendTo(F)},T.prototype.isCollapsible=function(){return this._annotation.hasMixin(y)},T.prototype.setCollapseState=function(e){if(this.isCollapsible())return $(this._expandIcon).removeClass(e?"gravit-icon-right":"gravit-icon-down").addClass(e?"gravit-icon-down":"gravit-icon-right")},T.prototype.isEditMode=function(){return this._annotationCommentContainer.hasClass("g-edit-mode")},T.prototype._clearOwnData=function(){var e=this._container.data("annotmenu");e&&(e.empty(),this._container.data("annotmenu",null))},T.prototype.cancelEditMode=function(){this._annotationCommentContainer.removeClass("g-edit-mode"),this._contentEditorButtons.hide(),this._assigneeRow.hide(),this.setMentionOverlayBorderVisiblity(!1)},T.prototype.toggleHighlight=function(e){this._container.toggleClass("g-highlighted-row",e)},T.prototype.isRead=function(){return this._isRead},T.prototype.isTypeResolved=function(){return this._isTypeResolved},T.prototype.isTypeReopened=function(){return this._isTypeReopened},T.prototype.isParentAnnotationResolved=function(){return this._isParentAnnotResolved},T.prototype.setVisiblity=function(e){e?this._container.show():this._container.hide()},T.prototype.setMentionOverlayBorderVisiblity=function(e){e?this._annotationCommentContainer.find(".mentions-input-box").css("display","block"):this._annotationCommentContainer.find(".mentions-input-box").css("display","none")},T.prototype._updateParentAnnotResolvedStatus=function(e){this._isParentAnnotResolved=!!e.getProperty("rsv")},T.prototype._updateReadUnreadStatus=function(e){var t=this._annotation,n=gDesigner.getSyncUser(),i=c.default.isOwner(n,t);if(this._isParentAnnotResolved||i||(t.getProperty("read")||[]).includes(n.getUID()))this._isRead=!0;else{var r=null;o.SHOW_SIDEBAR_BADGE&&(r=$("<div/>").addClass("new-comment").append([$("<span/>").addClass("dot").text("·"),$("<span/>").addClass("text-new").text(g.get(new h("GAnnotationPanel","text.unread-comment")))]).appendTo(e),this._container.addClass("new-element")),this._sidebarActive&&setTimeout(()=>{let e=t.getProperty("read")||[];e.includes(n.getUID())||(t.setProperty("read",e.concat(n.getUID())),r&&r.remove(),this._isRead=!0,this._container.addClass("new-element"))},b)}},T.prototype.scrollIntoView=function(){this._scrollToElement(this._container)},T.prototype._startEditMode=function(e,t,n,i,o){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];if(!e.hasClass("g-edit-mode")){var s=e.find(".annotation-comment-editor"),l=e.find(".contenteditor-buttonrow");s.val(x(n));var c=this._generateCommentContentHTML(n);let i=c.mentioned.map(e=>e.id),o=r.concat(a).filter(e=>i.includes(e.id)).map(e=>u.default.clone(e));o&&o.length&&(o.forEach(e=>{const t=c.mentioned.find(t=>t.id===e.id);e.value=t.showText,e.showText=t.showText}),e.find(".annotation-comment-editor").mentionsInput("setMentions",o)),this.setMentionOverlayBorderVisiblity(!0),s.trigger("input"),s[0].setSelectionRange(s[0].textLength,s[0].textLength),l.show(),l.find(".annotations-addcomment").text(g.get(new h("GAnnotationPanel",t?"text.edit-comment":"text.add-comment"))),setTimeout(()=>s.focus()),e.addClass("g-edit-mode")}},T.prototype._generateCommentContentHTML=function(e){let t="string"==typeof e?e:x(e.getProperty("text"));if(t=t||"",!gDesigner.getActiveDocument()||!gDesigner.getActiveDocument().getStorageItem())return{html:t,mentioned:[]};let n=t.match(s.GRegex.String.USERNAME_RE);if(!(n||[]).length)return{html:t,mentioned:[]};let i=(this._data||[]).filter(e=>{let t=e.getRole&&e.getRole()||e.role;return!t.is(o.ShareRoles.Viewer)&&!t.is(o.ShareRoles.NoAccess)}),r=[];if(n.forEach(e=>{const t=e.substring(1);if(!t)return;if(D(e))return void r.push(e);const n=i.find(L(t));n&&!r.find(function(e){return t=>e.getFirstName()===t.substring(1)||e.getFullUserName()===t.substring(1)||e.getEmail()===t.substring(1)}(n))&&r.push(e)}),!(r||[]).length)return{html:t,mentioned:[]};let a=i.filter(e=>r.includes("@"+e.getFirstName())||r.includes("@"+e.getFullUserName())||e.getEmail()&&r.includes("@"+e.getEmail()));return a=a.map(e=>{const t=Object.assign(new d.default,e),n="@"+t.getEmail(),i="@"+t.getFirstName();return r.includes(i)?t.showText="@"+t.getFullUserName():r.includes(n)&&(t.showText=n),t}),r.forEach(e=>{let n=e;const i=D(e);if(i)n=i.showText,a.push(i);else{const i=e.substring(1),o=a.find(L(i));o&&(n=o.showText,t.includes(n)&&(e=n))}t=t.replace(e,"<strong><span>"+n+"</span></strong>")}),{html:t,mentioned:a}},e.exports=T},function(e,t,n){"use strict";n(58),n(19),n(24),n(84);var i=n(16),o=n(792);const r=n(36),{GSystem:a,GLocale:s,GLocaleKey:l,GObject:c,GNode:d}=n(1),u=n(1078),{getAnnotationType:p}=n(32);n(76);function g(e){let{container:t,annotation:n,onSubmit:i,onCancel:o,onAssignTo:r,mentionData:a}=e;this._containter=t,this._annotation=n,this._onSubmit=i,this._onCancel=o,this._onAssignTo=r,this._shouldAssign=!1,this._assignees=[],this._mentionsCollection=[],this._data=a.data,this._owner=a.owner,this._additionalMentions=a.additionalMentions||[],this._mentionData=a,this._init()}function h(e){if(13===e.keyCode)if(a.operatingSystem!==a.OperatingSystem.OSX_IOS){if(!e.shiftKey)return!0}else{if(!e.altKey)return!0;if("keydown"===e.type){let t=$(e.target).val();$(e.target).val(t+"\n")}}return!1}c.inherit(g,u),g.prototype._init=function(){var e=this._containter;this._containter.addClass("reply-docker");var t,n=p(this._annotation);e.toggleClass("g-active",this._annotation.hasFlag(d.Flag.Active)).toggleClass("g-selected",this._annotation.hasFlag(d.Flag.Selected));const c=!this._annotation.isFillingCompleted();e.on("focusout",n=>{if(e.find(n.relatedTarget).length)return n.stopPropagation(),n.preventDefault(),!1;$(n.target).val()||r.isDialogOpen(".g-system-dialog.g-confirm-dialog")||($(n.target).attr("rows",1),t.hide())}).on("keydown",(function(e){h(e)&&e.preventDefault()})).on("keypress",(function(e){a.operatingSystem===a.OperatingSystem.OSX_IOS&&13===e.keyCode&&e.altKey&&e.preventDefault()})).on("keyup",e=>{const t=u.find(".mentions-autocomplete-list").data("assign");h(e)&&!t&&(this._addContent(),e.preventDefault())});var u=$("<span>").addClass("annotations-comment-area").appendTo(e);this._onlyOneAssignee=$("<span>").addClass("only-one-assignee").html(1===this._mentionsCollection.length?this._mentionsCollection[0].name:"").css("display","none"),this._assigneeSelector=$("<div>").addClass("assignee-selector").css("display","none").append($("<select>").on("change",e=>{o.updateAssignee.call(this,$(e.target).val())})),this._assigneeCheckBox=$("<input>").attr("type","checkbox").prop("checked",this._shouldAssign).on("change",e=>{this._shouldAssign=$(e.target).prop("checked"),gDesigner.stats("replydocker_mention_assign-user",n)}),this._assigneeRow=$("<div>").css("display","none").addClass("assignee-row-container").append($("<label>").addClass("label").addClass("assignee-row-label").append(this._assigneeCheckBox).append($("<span>").html(s.get(new l("GAnnotationPanel","text.assign-to")))).append(this._onlyOneAssignee).append(this._assigneeSelector)).appendTo(u),t=$("<div>").css("display","none").addClass("annotations-buttonrow").append($("<button>").addClass("annotations-cancelcomment").text(s.get(new l("GAnnotationPanel","text.cancel"))).on("click",e=>{e.stopImmediatePropagation(),gDesigner.stats("replydocker_cancel-reply",n),t.hide(),this._input.val("").attr("rows",1).trigger("input"),this._onCancel()})).append($("<button>").addClass("annotations-addcomment").text(c?s.get(new l("GAnnotationPanel","text.fill-contents")):s.get(new l("GAnnotationPanel","text.comment"))).on("click",()=>{gDesigner.stats("replydocker_add-reply",n),this._addContent()})).appendTo(u),e.attr("draggable",!1);const g=c&&i.GPlatform.webBrowser!==i.GPlatform.constructor.WebBrowser.Safari;this._input=$("<textarea>").attr("placeholder",s.get(new l("GAnnotationPanel",c?"text.write-annotation-here":"text.write-reply-here"))).attr("rows",1).attr("autofocus",g).addClass("annotations-comment-placeholder").addClass("mention").on("input",(function(){if(gDesigner.isTouchEnabled())this.style.height=0,this.style.height=this.scrollHeight+"px";else{const t=18;var e=Math.ceil(this.scrollHeight/t);this.rows=Math.max(e,5)}})).on("click",e=>{$(e.target).attr("rows")<=5&&$(e.target).attr("rows",5),t.show(),o.showAssigneeRow.call(this,this._input),gDesigner.isTouchEnabled()&&this.requestFocus()}).prependTo(u),this._input.mentionsInput({onDataRequest:(e,t,n)=>{let i=this._data.filter(e=>e.getFullUserName().toLowerCase().includes(t.toLowerCase())||e.getEmail()&&e.getEmail().toLowerCase().includes(t.toLowerCase()));i.push(...this._additionalMentions),n.call(this,i)},onSelectItem:()=>{gDesigner.stats("replydocker_mention_select-user",n)}}).on("input",()=>{o.showAssigneeRow.call(this,this._input)}),u.find(".mentions-autocomplete-list").delegate("li","mousedown",()=>{o.showAssigneeRow.call(this,this._input)}),c&&(this._input.trigger("click"),this._input.focus())},g.prototype._addContent=function(){var e=o.replaceAdditionalCollabShowTextBeforeSend.call(this,$(this._input).val());e=e.trim(),this._onSubmit(e),this._shouldAssign&&this._assignees&&this._assignees.length&&this._onAssignTo(this._assignees)},g.prototype.requestFocus=function(){const e=this._input[0];e&&e.focus?e.focus():this._input.focus()},g.prototype.forceSubmit=function(){this._addContent()},g.prototype.isVisible=function(){return"none"!==this._containter.find(".annotations-buttonrow").css("display")},g.prototype.show=function(){this._containter.find(".annotations-buttonrow").show()},g.prototype.hide=function(){this._containter.find(".annotations-buttonrow").hide()},g.prototype.scrollIntoView=function(){this._scrollToElement(this._input)},e.exports=g},,,,,,,,,,,,,,function(e,t,n){"use strict";var i,o,r=n(1253),a=n(1361);function s(){var e=new r;e.initLanguage((function(){i=e.init(a),o&&i.then(()=>{l(o)})}))}function l(e){gDesigner&&gDesigner.setPwaEvent?gDesigner.setPwaEvent(e):window.__pwaEvent__=e}"complete"===document.readyState?s():window.addEventListener("load",s),window.addEventListener("beforeinstallprompt",(function(e){if(e&&"beforeinstallprompt"===e.type){if(!i)return void(o=e);i.then(()=>{l(e)})}})),window.addEventListener("appinstalled",e=>{e&&"appinstalled"===e.type&&location.reload()})},function(e,t,n){"use strict";n(19),n(24),n(111),n(90),n(83),n(14),n(9),n(58),n(3);var i=n(0),o=n(8),r=n(39),a=n(76),s=n(1080);const l=n(1256);var c=n(230),d=n(1257),u=n(1258),p=n(1007),g=n(1084),h=n(202),f=n(1263),m=n(1264),y=n(106),v=n(144),_=n(77),b=n(1042),w=n(36),C=n(12).LOCAL_FONTS_API_ENABLED;const E=n(1360),{base64StringToString:S}=n(32);function G(){this._storage=new s,"serviceWorker"in navigator&&setTimeout((function(){navigator.serviceWorker.register("/cacher.js").then((function(e){e.update&&e.update()}))}),15e3)}i.inheritAndMix(G,a,[E]),G.prototype.getRuntime=function(){return window.matchMedia("(display-mode: standalone)").matches?a.Runtime.PWA:a.Runtime.Browser},G.prototype.getStorage=function(){return this._storage},G.prototype.getSystemFontsProvider=function(){return u},G.prototype.supportsLocalFonts=function(){return C&&"fonts"in navigator},G.prototype.registerFontProviders=function(){if(a.prototype.registerFontProviders.call(this),c.registerProvider(p),c.registerProvider(d),this.supportsLocalFonts())try{c.registerProvider(g)}catch(e){console.error("Local Fonts Access API is not available")}window.GSystemFontsProvider=u},G.prototype.openExternalLink=function(e,t){e&&e.preventDefault(),window.open(t,"_blank")},G.prototype.start=function(){var e,t,n,i=new URL(window.location.href),o=null;if(i.searchParams){if(i.searchParams.get("token")&&i.searchParams.get("d"))o=new a.OpenFileRequest(a.OpenFileRequest.Type.DocumentOrToken,JSON.stringify({token:i.searchParams.get(a.OpenFileRequest.Type.Token),doc:i.searchParams.get("d")}));else if(i.searchParams.get("token"))o=new a.OpenFileRequest(a.OpenFileRequest.Type.Token,i.searchParams.get(a.OpenFileRequest.Type.Token));else if(i.searchParams.get("d"))o=new a.OpenFileRequest(a.OpenFileRequest.Type.Document,i.searchParams.get("d"));else if(i.searchParams.get("storeContent"))o=new a.OpenFileRequest(a.OpenFileRequest.Type.StoreContent,i.searchParams.get(a.OpenFileRequest.Type.StoreContent));else if(i.searchParams.get(a.OpenFileRequest.Type.ExternalAsset))o=new a.OpenFileRequest(a.OpenFileRequest.Type.ExternalAsset,i.searchParams.get(a.OpenFileRequest.Type.ExternalAsset));else if(i.searchParams.get("directlink")){t=i.searchParams.get("directlink");try{(e=JSON.parse(S(decodeURIComponent(t))).type)===a.OpenFileRequest.Type.Preset?o=new a.OpenFileRequest(a.OpenFileRequest.Type.Preset,t):e===a.OpenFileRequest.Type.Template&&(o=new a.OpenFileRequest(a.OpenFileRequest.Type.Template,t))}catch(e){"function"==typeof gdb_showScene&&console.warn("Invalid parameters.")}}}else{for(var r=/[&\?]((?:(?![#=])[\s\S])+)=((?:(?![#&])[\s\S])*)/g,s={};n=r.exec(window.location.href);)s[n[1]]=n[2];if(s.token&&s.d)o=new a.OpenFileRequest(a.OpenFileRequest.Type.DocumentOrToken,{token:s[a.OpenFileRequest.Type.Token],doc:s.d});else if(s.token)o=new a.OpenFileRequest(a.OpenFileRequest.Type.Token,s[a.OpenFileRequest.Type.Token]);else if(s.d)o=new a.OpenFileRequest(a.OpenFileRequest.Type.Document,s.d);else if(s.storeContent)o=new a.OpenFileRequest(a.OpenFileRequest.Type.StoreContent,s[a.OpenFileRequest.Type.StoreContent]);else if(s[a.OpenFileRequest.Type.ExternalAsset])o=new a.OpenFileRequest(a.OpenFileRequest.Type.StoreContent,s[a.OpenFileRequest.Type.ExternalAsset]);else if(s.directlink){t=s.directlink;try{(e=JSON.parse(S(decodeURIComponent(t))).type)===a.OpenFileRequest.Type.Preset?o=new a.OpenFileRequest(a.OpenFileRequest.Type.Preset,t):e===a.OpenFileRequest.Type.Template&&(o=new a.OpenFileRequest(a.OpenFileRequest.Type.Template,t))}catch(e){"function"==typeof gdb_showScene&&console.warn("Invalid parameters.")}}}return o},G.prototype.copyToClipboard=function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e);try{var t=function(){if(window.getSelection){var e=window.getSelection();if(e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange()}(),n=document.createElement("textArea");return n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),function(e){if(e)if(window.getSelection){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)}else document.selection&&e.select&&e.select()}(t),Promise.resolve()}catch(e){return Promise.reject(e)}},G.prototype.openStorageFile=function(e,t,n){G.openStorageFile(e,t,n,this._storage)},G.openStorageFile=function(e,t,n,i){var s={progress:null};e.updateStatus(_.Loading,s),async function(){try{let d,u=t.getType(),p=t.getContent();if(u===a.OpenFileRequest.Type.StoreContent)d=await gApi.getProviderContentDetails(p),d&&n(new f.Item(i,d.id,d.name,d),{loadingData:s});else if(u===a.OpenFileRequest.Type.ExternalAsset)d=await gApi.getProviderContentDetails(p),d&&n(new m.Item(i,d.id,d.name,d,p),{loadingData:s});else if(u===a.OpenFileRequest.Type.Preset){let e=JSON.parse(S(decodeURIComponent(p))),t=e&&function(e){let t=b.getPresets(),n=null,i=null;for(let o of t){let t=o.layouts.find(t=>t.template?t.template===e:t.id===e);if(t){n=o.name,i=t;break}}return{presetCategory:n,presetLayout:i}}(e.id);t&&t.presetLayout&&(t.presetLayout.template?(d=await gApi.getPresetTemplate({type:t.presetLayout.template}).catch(()=>null),d&&n(new l(i,d.data,"".concat(e.id,".gvdesign"),d.id),{content:e,file:d,preset:t,loadingData:s})):n(t,{content:e,category:t.presetCategory,loadingData:s}))}else if(u===a.OpenFileRequest.Type.Template){let e=JSON.parse(S(decodeURIComponent(p))),{file:t,data:o}=await y.loadDesignData(e.id),r=v.FileTypes.find(e=>e.mime===t.type).ext;t&&o&&n(new l(i,o,"".concat(t.name,".").concat(r),t.id),{content:e,file:t,category:t.path,loadingData:s})}else{let t;if(u===a.OpenFileRequest.Type.DocumentOrToken){let e=JSON.parse(p);d=await gApi.getShare(e.token,!0).catch(()=>null),d?t=e.token:d=await gApi.getFile(e.doc).catch(()=>null)}else u===a.OpenFileRequest.Type.Document?d=await gApi.getFile(p).catch(()=>null):u===a.OpenFileRequest.Type.Token&&(t=p,d=await gApi.getShare(t,!0).catch(()=>null));if(d)n(new h.Item(i,d.id,d.name,d,null,t,d.autosave),{loadingData:s});else{s.text=o.get(new r("GContainer","text.load-failed")),e.updateStatus(_.LoadFailed,s),e.setFailedDocumentIdOrToken(p),n(null);var c=[];gDesigner.getShareManager().isPermissionRequestEnabled()&&c.push({label:o.get(new r("GShareManager","text.file-request-access")),onclick:e=>{gDesigner.stats("permission-dialog_no-access_request-access"),gApi.requestPermission(p,{access:!0,isToken:u===a.OpenFileRequest.Type.Token}).then(()=>{e.gDialog("close"),w.alert(o.get(new r("GShareManager","text.sent-request-email")))}).catch(()=>{w.error(o.get(new r("GShareManager","text.cannot-request-access")))})}}),c.push({label:o.get(new r("GLocale","ok")),onclick:e=>{gDesigner.stats("permission-dialog_no-access_click-ok"),e.gDialog("close")},highlighted:!0}),w.custom({icon:"error",className:"g-file-can-not-be-found-dialog",closeable:!1,closeCallback:()=>gDesigner.removeDocument(e,null,!0),title:o.get(new r("GShareManager","text.file-can-not-be-accessed-title")),subtitle:o.get(new r("GShareManager","text.file-can-not-be-accessed-info")),buttons:c})}}}catch(t){console.log(t),setTimeout((function(){e.updateStatus(_.LoadFailed,s)}),10),e.updateStatus(_.LoadFailed,s),n(null)}}()},G.prototype.handleDeepLinking=function(e){const t=a.prototype.handleDeepLinking.call(this,e),n=[a.DeepLinking.DirectLink,a.DeepLinking.FocusAnnot,a.DeepLinking.CreateShare];return t&&!n.includes(t.link)&&window.history.pushState(null,null,window.location.pathname),t},G.prototype.toString=function(){return"[Object GBrowserContainer]"},e.exports=G},function(e,t,n){"use strict";var i=n(6),o=n(406),r=n(109),a=n(110),s=i.TypeError,l=function(e,t,n,i,c,d,u,p){for(var g,h,f=c,m=0,y=!!u&&a(u,p);m<i;){if(m in n){if(g=y?y(n[m],m,t):n[m],d>0&&o(g))h=r(g),f=l(e,t,g,h,f,d-1)-1;else{if(f>=9007199254740991)throw s("Exceed the acceptable array length");e[f]=g}f++}m++}return f};e.exports=l},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";var i=n(17);n(3);var o=i(n(1080));function r(e,t,n,i){o.default.Item.call(this,e,t,n),this._fileId=i}n(1).GObject.inheritAndMix(r,o.default.Item),r.prototype.isRegistrable=function(){return!!this.getId()},r.prototype.getId=function(){return this._fileId},r.prototype.toString=function(){return"[Object GMarketingFileStorageItem]"},e.exports=r},function(e,t,n){"use strict";n(28),n(45);var i=n(1),o=n(341);function r(e){o.call(this,e)}i.GObject.inherit(r,o);var a=i.GUtil.uuid(),s=[],l={};i.GObject.inherit(r,o),r.prototype._totalFonts=0,r.prototype._initialized=!1,r.prototype._initializing=!1,r.prototype._resolveCallbacks=[],r.prototype._loadCallbacks=[],r.prototype._clearCallbacks=function(e){this._resolveCallbacks.forEach((function(t){t(e)})),this._resolveCallbacks=[],this._loadCallbacks.forEach((function(t){t(e)})),this._loadCallbacks=[]},r.prototype.addPreviews=function(e,t){for(var n=new DOMParser,i=!1,o=function(e,t){e?(this.cb=e,this.svg&&e(this.svg)):(this.svg=t,this.cb&&this.cb(t))},r=0;r<e.length;r++)e[r].cachedPreview||e[r].addPreviewCallback||(e[r].addPreviewCallback=o);if(t){e.length;if(!e.length)return;var a=[];for(r=0;r<e.length;r++){for(var l=0;l<s.length;l++)if(s[l].family===e[r].family){var c=parseInt(l/10);a.indexOf(c)<0&&a.push(c);break}if(l===s.length)return void console.warn("Error while generating previews: couldn't find font.")}for(r=0;r<a.length;r++){c=a[r];if(s[10*c].cachedPreview||(i=!0),i){var d=new XMLHttpRequest,u=gContainer.getRootPath();d.open("GET",u+"/assets/data/google_previews/previews"+c+".json"),d.num=c,d.onload=function(){if(this.status>=200&&this.status<300){var e;try{e=JSON.parse(this.response)}catch(e){return void("undefined"!=typeof gdb_loaddesign&&console.warn("couldn't parse font preview"))}for(var t=Math.min(s.length,10*(this.num+1))-10*this.num,i=0;i<t;i++){var r,a=s[10*this.num+i];a.addPreviewCallback||(a.addPreviewCallback=o);try{(r=n.parseFromString(e[i],"image/svg+xml").firstChild)&&r.getAttribute("xmlns")&&(r.setAttribute("height","20px"),a.addPreviewCallback(null,r))}catch(e){"undefined"!=typeof gdb_loaddesign&&console.warn("error parsing svg")}}}},d.send()}}}},r.prototype.initialize=function(){this._initialized||this._initializing||this._load.apply(this,arguments)},r.prototype._load=function(){this._initializing=!0;var e=Array.prototype.slice.call(arguments),t=gContainer.getRootPath(),n=new XMLHttpRequest,i=gDesigner?gDesigner.getVersion():~~(1e4*Math.random());n.open("GET",t+"/assets/data/googlefonts.json?"+i),n.onload=function(){n.status>=200&&n.status<300?(this._initialized=!0,this._initializing=!1,s=JSON.parse(n.response),this._totalFonts=s.length,e.length,this._clearCallbacks()):n.status>=400&&(this._initialized=!0,this._initializing=!1,this._clearCallbacks(!0))}.bind(this),n.onerror=function(){this._initialized=!0,this._initializing=!1,this._clearCallbacks(o.Errors.ConnectionError)}.bind(this),n.send()},r.prototype.load=function(e,t,n,i){if(!this._initialized&&!this._initializing)return this._loadCallbacks.push(function(o){o?i.fail(o):this.load(e,t,n,i)}.bind(this)),void this.initialize(this.load,e,t,n,i);this._initializing?this._loadCallbacks.push(function(o){o?i.fail(o):this.load(e,t,n,i)}.bind(this)):i.done(s.filter(this._searchFilter(e)).slice(t,t+n),!0,null)},r.prototype.getTotalFonts=function(e){return e?s.filter(this._searchFilter(e)).length:this._totalFonts},r.prototype.resolveFont=function(e,t,n,r){if(!this._initialized&&!this._initializing)return this._loadCallbacks.push(function(i){i?r.fail(i):this.resolveFont(e,t,n,r)}.bind(this)),void this.initialize(this.resolveFont,e,t,n,r);if(this._initializing)this._resolveCallbacks.push(function(i){i?r.fail(i):this.resolveFont(e,t,n,r)}.bind(this));else{for(var a=0;a<s.length;a++){var c=s[a];if(c.family===e)for(var d=c.fonts,u=0;u<d.length;u++){var p=d[u];if(p.weight===(n||400)&&p.style===(t||i.GFont.Style.Normal)){if(l[p.url])l[p.url].push(r);else{var g=new XMLHttpRequest;g.responseType="arraybuffer",g.open("GET",p.url),l[p.url]=[],l[p.url].push(r),g.onload=function(){if(this.status>=200&&this.status<300){var e=l[p.url];delete l[p.url],e.forEach(e=>{e.done(this.response)})}},g.onerror=()=>{delete l[p.url],r.fail(o.Errors.ConnectionError)},g.send()}return}}}r.fail()}},r.prototype.getProviderId=function(){return a},r.prototype.resetProvider=function(){this._load()},e.exports=r},function(e,t,n){"use strict";n(14),n(29),n(19),n(158),n(201),n(166),n(167),n(63),n(45),n(574),n(537),n(28),n(129);var i=n(1),o=n(12),r=n(341);function a(e){if(a._instance)throw new Error("This class cannot be instantiated multiple times");a._instance=this,r.call(this,e)}i.GObject.inherit(a,r);var s=i.GUtil.uuid();a.DEFAULT_PORT=32119,a.START_PORT_SPAN=1,a.PORT_SPAN=5,a.HOST="undefined"==typeof window||!window||window.process&&window.process.type?"":window.location.href.replace(/\/$/,""),a.LAUNCHER_PATH="/assets/data/launcher.swf",a.Cmd={success:0,font:1,list:2,probe:3,close:4,previews:5,error:255,stamp:3735941121},a._instance=null,a._launcherInstall=function(){a._instance._providerManager.setLock()},a._closeLauncher=function(){var e,t=0,n=function(){if(this._isInitialized())return console.log("initialized: finish"),void clearInterval(e);if(!this._taskLock){if(this._fontList=null,this._cachedInstallButton){var n=this._cachedInstallButton.parentElement;n&&n.contains(this._cachedInstallButton)&&n.removeChild(this._cachedInstallButton),this._cachedInstallButton=null}this._providerManager.reset(),t++>10&&(this._cbFatal(),clearInterval(e))}}.bind(a._instance);e=setInterval(n,2e3)},a.prototype._firstConnect=!0,a.prototype._tlsError=!1,a.prototype._initialized=!1,a.prototype._connection=null,a.prototype._tmpConnection=null,a.prototype._fontList=null,a.prototype._doReverse=!1,a.prototype._fontListLength=-1,a.prototype._taskQueue=[],a.prototype._taskLock=!1,a.prototype._resolveCallback=null,a.prototype._oldUnresolved=null,a.prototype._listCallbacks=[],a.prototype._previewCallback=null,a.prototype._cachedInstallButton=null,a.prototype._timeout=null,a.prototype._connect=function(e){var t=e||a.DEFAULT_PORT;if(this._firstConnect?t>a.DEFAULT_PORT+a.START_PORT_SPAN&&this._error():t>a.DEFAULT_PORT+a.PORT_SPAN&&this._error(),!(this._tmpConnection&&this._taskLock||this._connection))if(this._fontList&&1==this._fontList.length&&this._fontList[0].special)this._cbFail();else try{console.log("tasklock: true (connect)"),this._taskLock=!0,t===a.DEFAULT_PORT?this._tmpConnection=new WebSocket("wss://127.0.0.1:"+t):this._tmpConnection=new WebSocket("ws://127.0.0.1:"+t),this._tmpConnection.onopen=this._onOpen.bind(this),this._tmpConnection.onclose=this._onClose.bind(this),this._tmpConnection.onerror=this._error.bind(this),this._timeout||(this._timeout=setTimeout(function(){this._tmpConnection&&this._taskLock&&(this._tmpConnection.close(),this._tmpConnection=null,console.log("tasklock: false"),this._taskLock=!1,this._timeout=null,console.log("connection time out"),this._cbFatal())}.bind(this),3e4))}catch(e){t===a.DEFAULT_PORT?(this._tlsError=!0,setTimeout(this._connect.bind(this),50,t+1)):setTimeout(this._connect.bind(this),2e3,t+1)}},a.prototype._onOpen=function(){this._connection=this._tmpConnection,this._connection.onmessage=this._onmsg.bind(this),this._tmpConnection=null,this._timeout=null;var e=new Uint8Array(5);this._setData(e,a.Cmd.probe),this._connection.send(e.buffer)},a.prototype._onClose=function(e){console.log("socket closing:"+e),this._connection=null,this._tmpConnection=null,this._initialized=!1},a.prototype._error=function(){if(console.log("tasklock: false (error)"),this._taskLock=!1,this._tmpConnection&&!this._connection){var e=this._tmpConnection.url.split(":"),t=parseInt(e[e.length-1]);this._tmpConnection=null;var n=this._firstConnect?a.START_PORT_SPAN:a.PORT_SPAN;if(t>a.DEFAULT_PORT+n)return void this._cbFatal();setTimeout(this._connect.bind(this),2e3,t+1)}},a.prototype._onmsg=function(e){var t=e.data;if(t instanceof Blob){var n=t.slice(0,1),i=t.slice(1,5);t=t.slice(5);var o=null,r=null,s=new FileReader;s.addEventListener("loadend",function(){var e=!1;if(null===o)o=s.result,o=(o=new Uint8Array(o))[0],s.readAsArrayBuffer(i);else if(null===r){r=s.result;var n=new Uint8Array(r),l=new Uint32Array(n.buffer);l[0]!==a.Cmd.stamp?(n.reverse(),(l=new Uint32Array(n.buffer))[0]===a.Cmd.stamp&&(this._doReverse=!0,e=!0)):e=!0,e&&s.readAsArrayBuffer(t)}else this._handleCmd(o,s.result)}.bind(this));try{s.readAsArrayBuffer(n)}catch(e){return}}},a.prototype._cbFail=function(){for(var e=0;e<this._listCallbacks.length;e++){var t=this._listCallbacks[e];this._listCallbacks.shift(),this._fontList&&1==this._fontList.length&&this._fontList[0].special?t.done(this._fontList,!0,null):t.fail()}this._resolveCallback&&(t=this._resolveCallback,this._isInitialized()||(this._oldUnresolved?this._oldUnresolved.push(t):this._oldUnresolved=[t]),this._resolveCallback=null,t.fail?t.fail():t(!0)),this._taskLock=!1},a.prototype._cbFatal=function(){gDesigner.getSetting("system_fonts_enabled",!0)?(this._fontListLength=1,this._fontList=[{family:"",special:!0,fonts:[{weight:400,style:"N"}]}]):(this._fontListLength=0,this._fontList=[]),this._firstConnect=!1,this._cbFail()},a.prototype._cbDone=function(e){var t;if(console.log("cb done"),this._listCallbacks)for(var n=0;n<this._listCallbacks.length;n++)t=this._listCallbacks[n],this._listCallbacks.shift(),this._listCallbacks=null,t.done(this._fontList,!0,null);this._resolveCallback&&(t=this._resolveCallbacks[n],this._resolveCallback=null,e?t.done(e):t()),this._oldUnresolved&&(this._oldUnresolved.forEach((function(t){e?t.done(e):t()})),this._oldUnresolved=null),this._taskLock=!1},a.prototype._handleCmd=function(e,t){try{switch(e){case a.Cmd.probe:var n;if(this._doReverse){var i=new Uint8Array(t);i.reverse(),n=new Uint32Array(i.buffer)}else n=new Uint32Array(t);this._fontListLength=n[0];var o=new Uint8Array(13);this._setData(o,a.Cmd.list),this._connection.send(o.buffer);break;case a.Cmd.list:if((w=(b=new Uint8Array(t))[0])==a.Cmd.success){b=b.slice(3);var r=String.fromCharCode.apply(null,new Uint8Array(b.buffer)),s=JSON.parse(r),l=[],c={};if(s.length)if("string"==typeof s[0]||s[0]instanceof String){for(var d=0;d<s.length;d++){var u=s[d].split("_"),p=(h=u[0]).toLowerCase(),g={weight:parseInt(u[1]),style:0==parseInt(u[2])?"N":"I",f:h};c[p]?c[p].push(g):c[p]=[g]}for(var h in c){g=c[h];l.push({family:g[0].f,fonts:g})}}else for(d=0;d<s.length;d++){for(var f=s[d],m=(h=f[0],[]),y={family:h,fonts:m},v=1;v<f.length;v++){var _=f[v].split("_");m.push({weight:parseInt(_[0]),style:0==parseInt(_[1])?"N":"I"})}l.push(y)}this._fontListLength=l.length,this._fontList=l,this._initialized=!0,console.log("tasklock: false (cmd list)"),this._taskLock=!1,this._cbDone()}else w==a.Cmd.error?(console.log("tasklock: false (cmd list err1)"),this._taskLock=!1,this._cbFail()):(console.log("tasklock: false (cmd list err2)"),this._taskLock=!1,this._cbFail());break;case a.Cmd.previews:break;case a.Cmd.font:var b,w;(w=(b=new Uint8Array(t))[0])==a.Cmd.success?(b=b.slice(1),this._cbDone(b.buffer)):(w==a.Cmd.error||console.warn("Error receiving data"),this._cbFail())}}catch(e){console.warn("Error receiving data from server:"+e.message)}},a.prototype._setData=function(e,t){var n=a.Cmd.stamp;e[0]=n>>24,e[1]=n>>16&255,e[2]=n>>8&255,e[3]=n>>0&255,e[4]=t},a.prototype.hasEnabler=function(){return!0},a.prototype.getEnabler=function(){var e=document.createElement("div");return e.appendChild(this._getInstallButton()),e},a.prototype.isInitialized=function(){return this._isInitialized()},a.prototype._isInitialized=function(){return!(!this._connection||!this._initialized)&&(0==this._connection.readyState||1==this._connection.readyState||(this._connection=null,this._tmpConnection=null,this._initialized=!1,!1))},a.prototype._getInstallButton=function(){if(this._cachedInstallButton)return this._cachedInstallButton;"http://127.0.0.1:9000"===a.HOST&&(a.HOST="https://"+(o.domain.startsWith("gravit")?"designer-":"")+gDesigner.getEnv().split(".")[0]+"."+o.domain);var e=document.createElement("object");e.data=a.LAUNCHER_PATH;var t=document.createElement("div");t.innerHTML="<b>To enable system fonts, either:</b><ul style='list-style:initial'><li>enable flash</li><li>download, install and run gravit font server manually: <a name='_SPECIAL_' href='/assets/data/fonts.air?no_redirect=true'>DOWNLOAD LINK</a></li><li>import fonts into browser in the settings panel.</li></ul>",t.style.width="310px",t.style.textAlign="left";var n=document.createElement("param");return n.setAttribute("name","FlashVars"),n.setAttribute("value","host="+escape(a.HOST)+"&appurl="+escape("/assets/data/fonts.air?no_redirect=true")),e.appendChild(n),(n=document.createElement("param")).setAttribute("name","wmode"),n.setAttribute("value","transparent"),e.appendChild(n),e.type="application/x-shockwave-flash",e.name="_SPECIAL_",e.height="150",e.width="300",this._cachedInstallButton=e,e},a.prototype.addPreviews=function(e){if(e.length)if(1==e.length&&e[0].special){var t=this;e[0].addPreviewCallback=function(e){e(t.getEnabler())}}else{if(!this._isInitialized())return this._previewCallback=this.addPreviews,void this._initialize();for(var n=0;n<e.length;n++)e[n].cachedPreview||(e[n].addPreviewCallback=function(e){var t=document.createElement("div");t.innerHTML=this.family,t.style.fontFamily=this.family,t.style.fontSize="13px",e(t)})}},a.prototype._initialize=function(){gDesigner.getSetting("system_fonts_enabled",!0)?this._taskLock||(this._tlsError?this._connect(a.DEFAULT_PORT+1):this._connect(a.DEFAULT_PORT)):this._cbFatal()},a.prototype.load=function(e,t,n,i){if(!this._isInitialized())return this._listCallbacks.push(i),void this._initialize();i.done(this._fontList.filter((function(t){return e.indexOf("%")>=0?t.family.toLowerCase().startsWith(e.replace(/%/g,"")):t.family.toLowerCase()==e.toLowerCase()})).slice(t,t+n),!0,null)},a.prototype.getTotalFonts=function(e){return this._isInitialized()?e?this._fontList.filter(this._searchFilter(e)).length:this._fontListLength:(this._initialize(),0)},a.prototype.resolveFont=function(e,t,n,i){if(!this._isInitialized())return this._resolveCallback=function(o){o?i.fail():this.resolveFont(e,t,n,i)}.bind(this),void this._initialize();if(!this._taskLock){var o=e.length;this._resolveCallback=i;var r=new Uint8Array(9+o+4);this._setData(r,a.Cmd.font),r[5]=(4278190080&o)>>24,r[6]=(16711680&o)>>16,r[7]=(65280&o)>>8,r[8]=(255&o)>>0;for(var s=9;s<9+o;s++)r[s]=e.charCodeAt(s-9);var l=parseInt(n);r[s]=(65280&l)>>8,r[s+1]=(255&l)>>0,r[s+3]="N"==t?0:1,this._connection.send(r)}},a.prototype.getProviderId=function(){return s},e.exports=a},function(e,t,n){n(1260)("asyncIterator")},function(e,t,n){var i=n(1261),o=n(59),r=n(1262),a=n(73).f;e.exports=function(e){var t=i.Symbol||(i.Symbol={});o(t,e)||a(t,e,{value:r.f(e)})}},function(e,t,n){var i=n(6);e.exports=i},function(e,t,n){var i=n(38);t.f=i},function(e,t,n){"use strict";n(9);var i=n(1),o=n(12),r=n(216),a=n(202),s=n(32).decrypt;n(143);function l(){}i.GObject.inherit(l,r),l.prototype.canPromptOpen=function(){return!1},l.prototype.canPromptSave=function(e){return!1},l.prototype.canSave=function(){return!1},l.prototype.canDownload=function(){return!1},l.Item=function(e,t,n,i){a.CommercialProduct.call(this,e,t,n,i)},i.GObject.inherit(l.Item,a.CommercialProduct),l.Item.prototype.getPrice=async function(){return Promise.resolve(this._file.price)},l.Item.prototype.getName=function(){return this._filename?this._filename:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.image"))},l.Item.prototype.getFullName=function(){return this._filename?this._filename:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.image"))},l.Item.prototype.getFormattedPrice=async function(){const e=await this.getPrice(),t=i.GLocale.toLocaleCurrency(e,"USD");return new Promise(e=>e(t))},l.Item.prototype.setFile=function(e){if(!e)throw new Error("File can not be null");this._file=e,this._id=e.id,this._name=e.name},l.Item.prototype.getFile=function(){return this._file},l.Item.prototype.read=async function(e,t,n){var i=await o.gApi.getProviderContentFile(this._file.hash);return e((new TextEncoder).encode(s(i)))},l.Item.prototype.getExtension=function(){return this._file.extension&&this._file.extension.toUpperCase()},e.exports=l},function(e,t,n){"use strict";n(9);var i=n(1),o=n(12),r=n(216),a=(n(202),n(32).decrypt);n(143);function s(){}i.GObject.inherit(s,r),s.prototype.canPromptOpen=function(){return!1},s.prototype.canPromptSave=function(e){return!0},s.prototype.canSave=function(){return!0},s.prototype.canDownload=function(){return!0},s.Item=function(e,t,n,i,o){r.Item.call(this,e),this._filename=n,this._id=t,this._file=i,this._hash=o},i.GObject.inherit(s.Item,r.Item),s.Item.prototype.getName=function(){return this._filename?this._filename:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.image"))},s.Item.prototype.getFullName=function(){return this._filename?this._filename:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.image"))},s.Item.prototype.setFile=function(e){if(!e)throw new Error("File can not be null");this._file=e,this._id=e.id,this._name=e.name},s.Item.prototype.getFile=function(){return this._file},s.Item.prototype.read=async function(e,t,n){try{var i=await o.gApi.getProviderExternalAsset(this._hash||this._file.hash);return e((new TextEncoder).encode(a(i)))}catch(e){return t(e)}},s.Item.prototype.getExtension=function(){return this._file.extension&&this._file.extension.toUpperCase()},e.exports=s},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){n(313)("Int8",(function(e){return function(t,n,i){return e(this,t,n,i)}}))},function(e,t){e.exports=require("zlib")},,,,,,,,,,,function(e,t,n){var i={"./effects/sketchblureffect":1012,"./effects/sketchblureffect.js":1012,"./effects/sketchcoloradjusteffect":1013,"./effects/sketchcoloradjusteffect.js":1013,"./effects/sketchdropshadoweffect":1014,"./effects/sketchdropshadoweffect.js":1014,"./effects/sketcheffect":538,"./effects/sketcheffect.js":538,"./effects/sketchinnershadoweffect":1015,"./effects/sketchinnershadoweffect.js":1015,"./geometry/sketchcurvepoint":1016,"./geometry/sketchcurvepoint.js":1016,"./geometry/sketchpoint":539,"./geometry/sketchpoint.js":539,"./geometry/sketchrect":542,"./geometry/sketchrect.js":542,"./model/item/sketchartboard":1017,"./model/item/sketchartboard.js":1017,"./model/item/sketchbitmap":1090,"./model/item/sketchbitmap.js":1090,"./model/item/sketchoval":1091,"./model/item/sketchoval.js":1091,"./model/item/sketchpage":1024,"./model/item/sketchpage.js":1024,"./model/item/sketchpolygon":1092,"./model/item/sketchpolygon.js":1092,"./model/item/sketchrectangle":1093,"./model/item/sketchrectangle.js":1093,"./model/item/sketchshapepath":507,"./model/item/sketchshapepath.js":507,"./model/item/sketchstar":1094,"./model/item/sketchstar.js":1094,"./model/item/sketchtext":1025,"./model/item/sketchtext.js":1025,"./model/item/sketchtriangle":1096,"./model/item/sketchtriangle.js":1096,"./model/sketchbase":709,"./model/sketchbase.js":709,"./model/sketchelement":393,"./model/sketchelement.js":393,"./model/sketchgroup":1097,"./model/sketchgroup.js":1097,"./model/sketchnode":708,"./model/sketchnode.js":708,"./model/sketchpathutil":1023,"./model/sketchpathutil.js":1023,"./model/sketchshape":707,"./model/sketchshape.js":707,"./model/sketchshapegroup":1098,"./model/sketchshapegroup.js":1098,"./model/sketchsymbolinstance":1028,"./model/sketchsymbolinstance.js":1028,"./model/sketchsymbolmaster":1029,"./model/sketchsymbolmaster.js":1029,"./ns/bplistparser":1027,"./ns/bplistparser.js":1027,"./ns/nsarchiver":1026,"./ns/nsarchiver.js":1026,"./pattern/sketchangulargradient":1020,"./pattern/sketchangulargradient.js":1020,"./pattern/sketchcolor":540,"./pattern/sketchcolor.js":540,"./pattern/sketchgradient":706,"./pattern/sketchgradient.js":706,"./pattern/sketchlineargradient":1018,"./pattern/sketchlineargradient.js":1018,"./pattern/sketchnoisepattern":1022,"./pattern/sketchnoisepattern.js":1022,"./pattern/sketchpattern":541,"./pattern/sketchpattern.js":541,"./pattern/sketchradialgradient":1019,"./pattern/sketchradialgradient.js":1019,"./pattern/sketchtexturepattern":1021,"./pattern/sketchtexturepattern.js":1021,"./sketchclasses":505,"./sketchclasses.js":505,"./sketchdocument":1030,"./sketchdocument.js":1030,"./sketchfile":1011,"./sketchfile.js":1011,"./sketchfontsearch":1031,"./sketchfontsearch.js":1031,"./sketchimport":1010,"./sketchimport.js":1010,"./sketchmeta":1099,"./sketchmeta.js":1099,"./sketchparser":506,"./sketchparser.js":506};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=1278},function(e,t){!function(e){"use strict";var t=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],n=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],i=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function l(){var e,t,n,i,l,c;function d(e,t,o,r,a,s,d,u,p,g,h){var f,m,y,v,_,b,w,C,E,S,G,A,T,P,L;S=0,_=o;do{n[e[t+S]]++,S++,_--}while(0!==_);if(n[0]==o)return d[0]=-1,u[0]=0,0;for(C=u[0],b=1;b<=15&&0===n[b];b++);for(w=b,C<b&&(C=b),_=15;0!==_&&0===n[_];_--);for(y=_,C>_&&(C=_),u[0]=C,P=1<<b;b<_;b++,P<<=1)if((P-=n[b])<0)return-3;if((P-=n[_])<0)return-3;for(n[_]+=P,c[1]=b=0,S=1,T=2;0!=--_;)c[T]=b+=n[S],T++,S++;_=0,S=0;do{0!==(b=e[t+S])&&(h[c[b]++]=_),S++}while(++_<o);for(o=c[y],c[0]=_=0,S=0,v=-1,A=-C,l[0]=0,G=0,L=0;w<=y;w++)for(f=n[w];0!=f--;){for(;w>A+C;){if(v++,L=(L=y-(A+=C))>C?C:L,(m=1<<(b=w-A))>f+1&&(m-=f+1,T=w,b<L))for(;++b<L&&!((m<<=1)<=n[++T]);)m-=n[T];if(L=1<<b,g[0]+L>1440)return-3;l[v]=G=g[0],g[0]+=L,0!==v?(c[v]=_,i[0]=b,i[1]=C,b=_>>>A-C,i[2]=G-l[v-1]-b,p.set(i,3*(l[v-1]+b))):d[0]=G}for(i[1]=w-A,S>=o?i[0]=192:h[S]<r?(i[0]=h[S]<256?0:96,i[2]=h[S++]):(i[0]=s[h[S]-r]+16+64,i[2]=a[h[S++]-r]),m=1<<w-A,b=_>>>A;b<L;b+=m)p.set(i,3*(G+b));for(b=1<<w-1;0!=(_&b);b>>>=1)_^=b;for(_^=b,E=(1<<A)-1;(_&E)!=c[v];)v--,E=(1<<(A-=C))-1}return 0!==P&&1!=y?-5:0}function u(o){var r;for(e||(e=[],t=[],n=new Int32Array(16),i=[],l=new Int32Array(15),c=new Int32Array(16)),t.length<o&&(t=[]),r=0;r<o;r++)t[r]=0;for(r=0;r<16;r++)n[r]=0;for(r=0;r<3;r++)i[r]=0;l.set(n.subarray(0,15),0),c.set(n.subarray(0,16),0)}this.inflate_trees_bits=function(n,i,o,r,a){var s;return u(19),e[0]=0,-3==(s=d(n,0,19,19,null,null,o,i,r,e,t))?a.msg="oversubscribed dynamic bit lengths tree":-5!=s&&0!==i[0]||(a.msg="incomplete dynamic bit lengths tree",s=-3),s},this.inflate_trees_dynamic=function(n,i,l,c,p,g,h,f,m){var y;return u(288),e[0]=0,0!=(y=d(l,0,n,257,o,r,g,c,f,e,t))||0===c[0]?(-3==y?m.msg="oversubscribed literal/length tree":-4!=y&&(m.msg="incomplete literal/length tree",y=-3),y):(u(288),0!=(y=d(l,n,i,0,a,s,h,p,f,e,t))||0===p[0]&&n>257?(-3==y?m.msg="oversubscribed distance tree":-5==y?(m.msg="incomplete distance tree",y=-3):-4!=y&&(m.msg="empty distance tree with lengths",y=-3),y):0)}}l.inflate_trees_fixed=function(e,t,o,r){return e[0]=9,t[0]=5,o[0]=n,r[0]=i,0};function c(){var e,n,i,o,r=0,a=0,s=0,l=0,c=0,d=0,u=0,p=0,g=0,h=0;function f(e,n,i,o,r,a,s,l){var c,d,u,p,g,h,f,m,y,v,_,b,w,C,E,S;f=l.next_in_index,m=l.avail_in,g=s.bitb,h=s.bitk,v=(y=s.write)<s.read?s.read-y-1:s.end-y,_=t[e],b=t[n];do{for(;h<20;)m--,g|=(255&l.read_byte(f++))<<h,h+=8;if(0!==(p=(d=i)[S=3*((u=o)+(c=g&_))]))for(;;){if(g>>=d[S+1],h-=d[S+1],0!=(16&p)){for(p&=15,w=d[S+2]+(g&t[p]),g>>=p,h-=p;h<15;)m--,g|=(255&l.read_byte(f++))<<h,h+=8;for(p=(d=r)[S=3*((u=a)+(c=g&b))];;){if(g>>=d[S+1],h-=d[S+1],0!=(16&p)){for(p&=15;h<p;)m--,g|=(255&l.read_byte(f++))<<h,h+=8;if(C=d[S+2]+(g&t[p]),g>>=p,h-=p,v-=w,y>=C)y-(E=y-C)>0&&2>y-E?(s.window[y++]=s.window[E++],s.window[y++]=s.window[E++],w-=2):(s.window.set(s.window.subarray(E,E+2),y),y+=2,E+=2,w-=2);else{E=y-C;do{E+=s.end}while(E<0);if(w>(p=s.end-E)){if(w-=p,y-E>0&&p>y-E)do{s.window[y++]=s.window[E++]}while(0!=--p);else s.window.set(s.window.subarray(E,E+p),y),y+=p,E+=p,p=0;E=0}}if(y-E>0&&w>y-E)do{s.window[y++]=s.window[E++]}while(0!=--w);else s.window.set(s.window.subarray(E,E+w),y),y+=w,E+=w,w=0;break}if(0!=(64&p))return l.msg="invalid distance code",m+=w=h>>3<(w=l.avail_in-m)?h>>3:w,f-=w,h-=w<<3,s.bitb=g,s.bitk=h,l.avail_in=m,l.total_in+=f-l.next_in_index,l.next_in_index=f,s.write=y,-3;c+=d[S+2],p=d[S=3*(u+(c+=g&t[p]))]}break}if(0!=(64&p))return 0!=(32&p)?(m+=w=h>>3<(w=l.avail_in-m)?h>>3:w,f-=w,h-=w<<3,s.bitb=g,s.bitk=h,l.avail_in=m,l.total_in+=f-l.next_in_index,l.next_in_index=f,s.write=y,1):(l.msg="invalid literal/length code",m+=w=h>>3<(w=l.avail_in-m)?h>>3:w,f-=w,h-=w<<3,s.bitb=g,s.bitk=h,l.avail_in=m,l.total_in+=f-l.next_in_index,l.next_in_index=f,s.write=y,-3);if(c+=d[S+2],0===(p=d[S=3*(u+(c+=g&t[p]))])){g>>=d[S+1],h-=d[S+1],s.window[y++]=d[S+2],v--;break}}else g>>=d[S+1],h-=d[S+1],s.window[y++]=d[S+2],v--}while(v>=258&&m>=10);return m+=w=h>>3<(w=l.avail_in-m)?h>>3:w,f-=w,h-=w<<3,s.bitb=g,s.bitk=h,l.avail_in=m,l.total_in+=f-l.next_in_index,l.next_in_index=f,s.write=y,0}this.init=function(t,r,a,s,l,c){e=0,u=t,p=r,i=a,g=s,o=l,h=c,n=null},this.proc=function(m,y,v){var _,b,w,C,E,S,G,A=0,T=0,P=0;for(P=y.next_in_index,C=y.avail_in,A=m.bitb,T=m.bitk,S=(E=m.write)<m.read?m.read-E-1:m.end-E;;)switch(e){case 0:if(S>=258&&C>=10&&(m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,v=f(u,p,i,g,o,h,m,y),P=y.next_in_index,C=y.avail_in,A=m.bitb,T=m.bitk,S=(E=m.write)<m.read?m.read-E-1:m.end-E,0!=v)){e=1==v?7:9;break}s=u,n=i,a=g,e=1;case 1:for(_=s;T<_;){if(0===C)return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);v=0,C--,A|=(255&y.read_byte(P++))<<T,T+=8}if(A>>>=n[(b=3*(a+(A&t[_])))+1],T-=n[b+1],0===(w=n[b])){l=n[b+2],e=6;break}if(0!=(16&w)){c=15&w,r=n[b+2],e=2;break}if(0==(64&w)){s=w,a=b/3+n[b+2];break}if(0!=(32&w)){e=7;break}return e=9,y.msg="invalid literal/length code",v=-3,m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);case 2:for(_=c;T<_;){if(0===C)return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);v=0,C--,A|=(255&y.read_byte(P++))<<T,T+=8}r+=A&t[_],A>>=_,T-=_,s=p,n=o,a=h,e=3;case 3:for(_=s;T<_;){if(0===C)return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);v=0,C--,A|=(255&y.read_byte(P++))<<T,T+=8}if(A>>=n[(b=3*(a+(A&t[_])))+1],T-=n[b+1],0!=(16&(w=n[b]))){c=15&w,d=n[b+2],e=4;break}if(0==(64&w)){s=w,a=b/3+n[b+2];break}return e=9,y.msg="invalid distance code",v=-3,m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);case 4:for(_=c;T<_;){if(0===C)return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);v=0,C--,A|=(255&y.read_byte(P++))<<T,T+=8}d+=A&t[_],A>>=_,T-=_,e=5;case 5:for(G=E-d;G<0;)G+=m.end;for(;0!==r;){if(0===S&&(E==m.end&&0!==m.read&&(S=(E=0)<m.read?m.read-E-1:m.end-E),0===S&&(m.write=E,v=m.inflate_flush(y,v),S=(E=m.write)<m.read?m.read-E-1:m.end-E,E==m.end&&0!==m.read&&(S=(E=0)<m.read?m.read-E-1:m.end-E),0===S)))return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);m.window[E++]=m.window[G++],S--,G==m.end&&(G=0),r--}e=0;break;case 6:if(0===S&&(E==m.end&&0!==m.read&&(S=(E=0)<m.read?m.read-E-1:m.end-E),0===S&&(m.write=E,v=m.inflate_flush(y,v),S=(E=m.write)<m.read?m.read-E-1:m.end-E,E==m.end&&0!==m.read&&(S=(E=0)<m.read?m.read-E-1:m.end-E),0===S)))return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);v=0,m.window[E++]=l,S--,e=0;break;case 7:if(T>7&&(T-=8,C++,P--),m.write=E,v=m.inflate_flush(y,v),S=(E=m.write)<m.read?m.read-E-1:m.end-E,m.read!=m.write)return m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);e=8;case 8:return v=1,m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);case 9:return v=-3,m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v);default:return v=-2,m.bitb=A,m.bitk=T,y.avail_in=C,y.total_in+=P-y.next_in_index,y.next_in_index=P,m.write=E,m.inflate_flush(y,v)}},this.free=function(){}}var d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function u(e,n){var i,o=this,r=0,a=0,s=0,u=0,p=[0],g=[0],h=new c,f=0,m=new Int32Array(4320),y=new l;o.bitk=0,o.bitb=0,o.window=new Uint8Array(n),o.end=n,o.read=0,o.write=0,o.reset=function(e,t){t&&(t[0]=0),6==r&&h.free(e),r=0,o.bitk=0,o.bitb=0,o.read=o.write=0},o.reset(e,null),o.inflate_flush=function(e,t){var n,i,r;return i=e.next_out_index,(n=((r=o.read)<=o.write?o.write:o.end)-r)>e.avail_out&&(n=e.avail_out),0!==n&&-5==t&&(t=0),e.avail_out-=n,e.total_out+=n,e.next_out.set(o.window.subarray(r,r+n),i),i+=n,(r+=n)==o.end&&(r=0,o.write==o.end&&(o.write=0),(n=o.write-r)>e.avail_out&&(n=e.avail_out),0!==n&&-5==t&&(t=0),e.avail_out-=n,e.total_out+=n,e.next_out.set(o.window.subarray(r,r+n),i),i+=n,r+=n),e.next_out_index=i,o.read=r,t},o.proc=function(e,n){var c,v,_,b,w,C,E,S;for(b=e.next_in_index,w=e.avail_in,v=o.bitb,_=o.bitk,E=(C=o.write)<o.read?o.read-C-1:o.end-C;;)switch(r){case 0:for(;_<3;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}switch(f=1&(c=7&v),c>>>1){case 0:v>>>=3,v>>>=c=7&(_-=3),_-=c,r=1;break;case 1:var G=[],A=[],T=[[]],P=[[]];l.inflate_trees_fixed(G,A,T,P),h.init(G[0],A[0],T[0],0,P[0],0),v>>>=3,_-=3,r=6;break;case 2:v>>>=3,_-=3,r=3;break;case 3:return v>>>=3,_-=3,r=9,e.msg="invalid block type",n=-3,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n)}break;case 1:for(;_<32;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}if((~v>>>16&65535)!=(65535&v))return r=9,e.msg="invalid stored block lengths",n=-3,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);a=65535&v,v=_=0,r=0!==a?2:0!==f?7:0;break;case 2:if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);if(0===E&&(C==o.end&&0!==o.read&&(E=(C=0)<o.read?o.read-C-1:o.end-C),0===E&&(o.write=C,n=o.inflate_flush(e,n),E=(C=o.write)<o.read?o.read-C-1:o.end-C,C==o.end&&0!==o.read&&(E=(C=0)<o.read?o.read-C-1:o.end-C),0===E)))return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);if(n=0,(c=a)>w&&(c=w),c>E&&(c=E),o.window.set(e.read_buf(b,c),C),b+=c,w-=c,C+=c,E-=c,0!=(a-=c))break;r=0!==f?7:0;break;case 3:for(;_<14;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}if(s=c=16383&v,(31&c)>29||(c>>5&31)>29)return r=9,e.msg="too many length or distance symbols",n=-3,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);if(c=258+(31&c)+(c>>5&31),!i||i.length<c)i=[];else for(S=0;S<c;S++)i[S]=0;v>>>=14,_-=14,u=0,r=4;case 4:for(;u<4+(s>>>10);){for(;_<3;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}i[d[u++]]=7&v,v>>>=3,_-=3}for(;u<19;)i[d[u++]]=0;if(p[0]=7,0!=(c=y.inflate_trees_bits(i,p,g,m,e)))return-3==(n=c)&&(i=null,r=9),o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);u=0,r=5;case 5:for(;!(u>=258+(31&(c=s))+(c>>5&31));){var L,D;for(c=p[0];_<c;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}if(c=m[3*(g[0]+(v&t[c]))+1],(D=m[3*(g[0]+(v&t[c]))+2])<16)v>>>=c,_-=c,i[u++]=D;else{for(S=18==D?7:D-14,L=18==D?11:3;_<c+S;){if(0===w)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);n=0,w--,v|=(255&e.read_byte(b++))<<_,_+=8}if(_-=c,L+=(v>>>=c)&t[S],v>>>=S,_-=S,(S=u)+L>258+(31&(c=s))+(c>>5&31)||16==D&&S<1)return i=null,r=9,e.msg="invalid bit length repeat",n=-3,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);D=16==D?i[S-1]:0;do{i[S++]=D}while(0!=--L);u=S}}g[0]=-1;var x=[],I=[],O=[],k=[];if(x[0]=9,I[0]=6,c=s,0!=(c=y.inflate_trees_dynamic(257+(31&c),1+(c>>5&31),i,x,I,O,k,m,e)))return-3==c&&(i=null,r=9),n=c,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);h.init(x[0],I[0],m,O[0],m,k[0]),r=6;case 6:if(o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,1!=(n=h.proc(o,e,n)))return o.inflate_flush(e,n);if(n=0,h.free(e),b=e.next_in_index,w=e.avail_in,v=o.bitb,_=o.bitk,E=(C=o.write)<o.read?o.read-C-1:o.end-C,0===f){r=0;break}r=7;case 7:if(o.write=C,n=o.inflate_flush(e,n),E=(C=o.write)<o.read?o.read-C-1:o.end-C,o.read!=o.write)return o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);r=8;case 8:return n=1,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);case 9:return n=-3,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n);default:return n=-2,o.bitb=v,o.bitk=_,e.avail_in=w,e.total_in+=b-e.next_in_index,e.next_in_index=b,o.write=C,o.inflate_flush(e,n)}},o.free=function(e){o.reset(e,null),o.window=null,m=null},o.set_dictionary=function(e,t,n){o.window.set(e.subarray(t,t+n),0),o.read=o.write=n},o.sync_point=function(){return 1==r?1:0}}var p=[0,0,255,255];function g(){var e=this;function t(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=7,e.istate.blocks.reset(e,null),0):-2}e.mode=0,e.method=0,e.was=[0],e.need=0,e.marker=0,e.wbits=0,e.inflateEnd=function(t){return e.blocks&&e.blocks.free(t),e.blocks=null,0},e.inflateInit=function(n,i){return n.msg=null,e.blocks=null,i<8||i>15?(e.inflateEnd(n),-2):(e.wbits=i,n.istate.blocks=new u(n,1<<i),t(n),0)},e.inflate=function(e,t){var n,i;if(!e||!e.istate||!e.next_in)return-2;for(t=4==t?-5:0,n=-5;;)switch(e.istate.mode){case 0:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,8!=(15&(e.istate.method=e.read_byte(e.next_in_index++)))){e.istate.mode=13,e.msg="unknown compression method",e.istate.marker=5;break}if(8+(e.istate.method>>4)>e.istate.wbits){e.istate.mode=13,e.msg="invalid window size",e.istate.marker=5;break}e.istate.mode=1;case 1:if(0===e.avail_in)return n;if(n=t,e.avail_in--,e.total_in++,i=255&e.read_byte(e.next_in_index++),((e.istate.method<<8)+i)%31!=0){e.istate.mode=13,e.msg="incorrect header check",e.istate.marker=5;break}if(0==(32&i)){e.istate.mode=7;break}e.istate.mode=2;case 2:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,e.istate.mode=3;case 3:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,e.istate.mode=4;case 4:if(0===e.avail_in)return n;n=t,e.avail_in--,e.total_in++,e.istate.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,e.istate.mode=5;case 5:return 0===e.avail_in?n:(n=t,e.avail_in--,e.total_in++,e.istate.need+=255&e.read_byte(e.next_in_index++),e.istate.mode=6,2);case 6:return e.istate.mode=13,e.msg="need dictionary",e.istate.marker=0,-2;case 7:if(-3==(n=e.istate.blocks.proc(e,n))){e.istate.mode=13,e.istate.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,e.istate.blocks.reset(e,e.istate.was),e.istate.mode=12;case 12:return 1;case 13:return-3;default:return-2}},e.inflateSetDictionary=function(e,t,n){var i=0,o=n;return e&&e.istate&&6==e.istate.mode?(o>=1<<e.istate.wbits&&(i=n-(o=(1<<e.istate.wbits)-1)),e.istate.blocks.set_dictionary(t,i,o),e.istate.mode=7,0):-2},e.inflateSync=function(e){var n,i,o,r,a;if(!e||!e.istate)return-2;if(13!=e.istate.mode&&(e.istate.mode=13,e.istate.marker=0),0===(n=e.avail_in))return-5;for(i=e.next_in_index,o=e.istate.marker;0!==n&&o<4;)e.read_byte(i)==p[o]?o++:o=0!==e.read_byte(i)?0:4-o,i++,n--;return e.total_in+=i-e.next_in_index,e.next_in_index=i,e.avail_in=n,e.istate.marker=o,4!=o?-3:(r=e.total_in,a=e.total_out,t(e),e.total_in=r,e.total_out=a,e.istate.mode=7,0)},e.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():-2}}function h(){}h.prototype={inflateInit:function(e){return this.istate=new g,e||(e=15),this.istate.inflateInit(this,e)},inflate:function(e){return this.istate?this.istate.inflate(this,e):-2},inflateEnd:function(){if(!this.istate)return-2;var e=this.istate.inflateEnd(this);return this.istate=null,e},inflateSync:function(){return this.istate?this.istate.inflateSync(this):-2},inflateSetDictionary:function(e,t){return this.istate?this.istate.inflateSetDictionary(this,e,t):-2},read_byte:function(e){return this.next_in.subarray(e,e+1)[0]},read_buf:function(e,t){return this.next_in.subarray(e,e+t)}};var f=e.zip||e;f.Inflater=f._jzlib_Inflater=function(){var e=new h,t=new Uint8Array(512),n=!1;e.inflateInit(),e.next_out=t,this.append=function(i,o){var r,a,s=[],l=0,c=0,d=0;if(0!==i.length){e.next_in_index=0,e.next_in=i,e.avail_in=i.length;do{if(e.next_out_index=0,e.avail_out=512,0!==e.avail_in||n||(e.next_in_index=0,n=!0),r=e.inflate(0),n&&-5===r){if(0!==e.avail_in)throw new Error("inflating: bad input")}else if(0!==r&&1!==r)throw new Error("inflating: "+e.msg);if((n||1===r)&&e.avail_in===i.length)throw new Error("inflating: bad input");e.next_out_index&&(512===e.next_out_index?s.push(new Uint8Array(t)):s.push(new Uint8Array(t.subarray(0,e.next_out_index)))),d+=e.next_out_index,o&&e.next_in_index>0&&e.next_in_index!=l&&(o(e.next_in_index),l=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return a=new Uint8Array(d),s.forEach((function(e){a.set(e,c),c+=e.length})),a}},this.flush=function(){e.inflateEnd()}}}(this)},function(e,t){!function(e){"use strict";var t,n="File format is not recognized.",i="Error while reading zip file.";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function o(){this.crc=-1}function r(){}function a(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function s(){}function l(e){var t,n=this;n.size=0,n.init=function(i,o){var r=new Blob([e],{type:"text/plain"});(t=new d(r)).init((function(){n.size=t.size,i()}),o)},n.readUint8Array=function(e,n,i,o){t.readUint8Array(e,n,i,o)}}function c(t){var n,i=this;i.size=0,i.init=function(e){for(var o=t.length;"="==t.charAt(o-1);)o--;n=t.indexOf(",")+1,i.size=Math.floor(.75*(o-n)),e()},i.readUint8Array=function(i,o,r){var s,l=a(o),c=4*Math.floor(i/3),d=4*Math.ceil((i+o)/3),u=e.atob(t.substring(c+n,d+n)),p=i-3*Math.floor(c/4);for(s=p;s<p+o;s++)l.array[s-p]=u.charCodeAt(s);r(l.array)}}function d(e){var t=this;t.size=0,t.init=function(n){t.size=e.size,n()},t.readUint8Array=function(t,n,i,o){var r=new FileReader;r.onload=function(e){i(new Uint8Array(e.target.result))},r.onerror=o;try{r.readAsArrayBuffer(function(e,t,n){if(t<0||n<0||t+n>e.size)throw new RangeError("offset:"+t+", length:"+n+", size:"+e.size);return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}(e,t,n))}catch(e){o(e)}}}function u(){}function p(e){var n;this.init=function(e){n=new Blob([],{type:"text/plain"}),e()},this.writeUint8Array=function(e,i){n=new Blob([n,t?e:e.buffer],{type:"text/plain"}),i()},this.getData=function(t,i){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=i,o.readAsText(n,e)}}function g(t){var n="",i="";this.init=function(e){n+="data:"+(t||"")+";base64,",e()},this.writeUint8Array=function(t,o){var r,a=i.length,s=i;for(i="",r=0;r<3*Math.floor((a+t.length)/3)-a;r++)s+=String.fromCharCode(t[r]);for(;r<t.length;r++)i+=String.fromCharCode(t[r]);s.length>2?n+=e.btoa(s):i=s,o()},this.getData=function(t){t(n+e.btoa(i))}}function h(e){var n=[];this.init=function(e){e()},this.writeUint8Array=function(e,i){n.push(t?e:e.buffer),i()},this.getData=function(t){t(new Blob(n,{type:e}))}}function f(e,t,n,i,o,r,a,s,l,c){var d,u,p,g=0,h=t.sn;function f(){e.removeEventListener("message",m,!1),s(u,p)}function m(t){var n=t.data,o=n.data,s=n.error;if(s)return s.toString=function(){return"Error: "+this.message},void l(s);if(n.sn===h)switch("number"==typeof n.codecTime&&(e.codecTime+=n.codecTime),"number"==typeof n.crcTime&&(e.crcTime+=n.crcTime),n.type){case"append":o?(u+=o.length,i.writeUint8Array(o,(function(){y()}),c)):y();break;case"flush":p=n.crc,o?(u+=o.length,i.writeUint8Array(o,(function(){f()}),c)):f();break;case"progress":a&&a(d+n.loaded,r);break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",n)}}function y(){(d=524288*g)<=r?n.readUint8Array(o+d,Math.min(524288,r-d),(function(n){a&&a(d,r);var i=0===d?t:{sn:h};i.type="append",i.data=n;try{e.postMessage(i,[n.buffer])}catch(t){e.postMessage(i)}g++}),l):e.postMessage({sn:h,type:"flush"})}u=0,e.addEventListener("message",m,!1),y()}function m(e,t,n,i,r,a,s,l,c,d){var u,p=0,g=0,h="input"===a,f="output"===a,m=new o;!function o(){var a;if((u=524288*p)<r)t.readUint8Array(i+u,Math.min(524288,r-u),(function(t){var i;try{i=e.append(t,(function(e){s&&s(u+e,r)}))}catch(e){return void c(e)}i?(g+=i.length,n.writeUint8Array(i,(function(){p++,setTimeout(o,1)}),d),f&&m.append(i)):(p++,setTimeout(o,1)),h&&m.append(t),s&&s(u,r)}),c);else{try{a=e.flush()}catch(e){return void c(e)}a?(f&&m.append(a),g+=a.length,n.writeUint8Array(a,(function(){l(g,m.get())}),d)):l(g,m.get())}}()}function y(t,n,i,o,a,s,l,c,d,u,p){e.zip.useWebWorkers&&l?f(t,{sn:n,codecClass:"NOOP",crcType:"input"},i,o,a,s,d,c,u,p):m(new r,i,o,a,s,"input",d,c,u,p)}function v(e){var t,n,i="",o=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++)i+=(n=255&e.charCodeAt(t))>127?o[n-128]:String.fromCharCode(n);return i}function _(e){return decodeURIComponent(escape(e))}function b(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function w(e,t,n,i,o){e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(e){}}(e.lastModDateRaw),1!=(1&e.bitFlag)?((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(n+22,!0),e.extraFieldLength=t.view.getUint16(n+24,!0)):o("File is using Zip64 (4gb+ file size).")):o("File contains encrypted entry.")}function C(t,o,r){var s=0;function l(){}l.prototype.getData=function(i,o,l,c){var d=this;function u(e,t){c&&!function(e){var t=a(4);return t.view.setUint32(0,e),d.crc32==t.view.getUint32(0)}(t)?r("CRC failed."):i.getData((function(e){o(e)}))}function p(e){r(e||"Error while reading file data.")}function g(e){r(e||"Error while writing file data.")}t.readUint8Array(d.offset,30,(function(o){var h,v=a(o.length,o);1347093252==v.view.getUint32(0)?(w(d,v,4,!1,r),h=d.offset+30+d.filenameLength+d.extraFieldLength,i.init((function(){0===d.compressionMethod?y(d._worker,s++,t,i,h,d.compressedSize,c,u,l,p,g):function(t,n,i,o,r,a,s,l,c,d,u){var p=s?"output":"none";e.zip.useWebWorkers?f(t,{sn:n,codecClass:"Inflater",crcType:p},i,o,r,a,c,l,d,u):m(new e.zip.Inflater,i,o,r,a,p,c,l,d,u)}(d._worker,s++,t,i,h,d.compressedSize,c,u,l,p,g)}),g)):r(n)}),p)};var c={getEntries:function(e){var o=this._worker;!function(e){if(t.size<22)r(n);else{o(22,(function(){o(Math.min(65558,t.size),(function(){r(n)}))}))}function o(n,o){t.readUint8Array(t.size-n,n,(function(t){for(var n=t.length-22;n>=0;n--)if(80===t[n]&&75===t[n+1]&&5===t[n+2]&&6===t[n+3])return void e(new DataView(t.buffer,n,22));o()}),(function(){r(i)}))}}((function(s){var c,d;c=s.getUint32(16,!0),d=s.getUint16(8,!0),c<0||c>=t.size?r(n):t.readUint8Array(c,t.size-c,(function(t){var i,s,c,u,p=0,g=[],h=a(t.length,t);for(i=0;i<d;i++){if((s=new l)._worker=o,1347092738!=h.view.getUint32(p))return void r(n);w(s,h,p+6,!0,r),s.commentLength=h.view.getUint16(p+32,!0),s.directory=16==(16&h.view.getUint8(p+38)),s.offset=h.view.getUint32(p+42,!0),c=b(h.array.subarray(p+46,p+46+s.filenameLength)),s.filename=2048==(2048&s.bitFlag)?_(c):v(c),s.directory||"/"!=s.filename.charAt(s.filename.length-1)||(s.directory=!0),u=b(h.array.subarray(p+46+s.filenameLength+s.extraFieldLength,p+46+s.filenameLength+s.extraFieldLength+s.commentLength)),s.comment=2048==(2048&s.bitFlag)?_(u):v(u),g.push(s),p+=46+s.filenameLength+s.extraFieldLength+s.commentLength}e(g)}),(function(){r(i)}))}))},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null),e&&e()},_worker:null};e.zip.useWebWorkers?T("inflater",(function(e){c._worker=e,o(c)}),(function(e){r(e)})):o(c)}function E(e){return unescape(encodeURIComponent(e))}function S(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function G(t,n,i,o){var r={},s=[],l=0,c=0;function d(e){i(e||"Error while writing zip file.")}function u(e){i(e||"Error while reading file data.")}var p={add:function(n,p,g,h,v){var _,b,w,C=this._worker;function G(e,n){var i=a(16);l+=e||0,i.view.setUint32(0,1347094280),void 0!==n&&(_.view.setUint32(10,n,!0),i.view.setUint32(4,n,!0)),p&&(i.view.setUint32(8,e,!0),_.view.setUint32(14,e,!0),i.view.setUint32(12,p.size,!0),_.view.setUint32(18,p.size,!0)),t.writeUint8Array(i.array,(function(){l+=16,g()}),d)}function A(){v=v||{},n=n.trim(),v.directory&&"/"!=n.charAt(n.length-1)&&(n+="/"),r.hasOwnProperty(n)?i("File already exists."):(b=S(E(n)),s.push(n),function(e){var i;w=v.lastModDate||new Date,_=a(26),r[n]={headerArray:_.array,directory:v.directory,filename:b,offset:l,comment:S(E(v.comment||""))},_.view.setUint32(0,335546376),v.version&&_.view.setUint8(0,v.version),o||0===v.level||v.directory||_.view.setUint16(4,2048),_.view.setUint16(6,(w.getHours()<<6|w.getMinutes())<<5|w.getSeconds()/2,!0),_.view.setUint16(8,(w.getFullYear()-1980<<4|w.getMonth()+1)<<5|w.getDate(),!0),_.view.setUint16(22,b.length,!0),(i=a(30+b.length)).view.setUint32(0,1347093252),i.array.set(_.array,4),i.array.set(b,30),l+=i.array.length,t.writeUint8Array(i.array,e,d)}((function(){p?o||0===v.level?y(C,c++,p,t,0,p.size,!0,G,h,u,d):function(t,n,i,o,r,a,s,l,c){e.zip.useWebWorkers?f(t,{sn:n,options:{level:r},codecClass:"Deflater",crcType:"input"},i,o,0,i.size,s,a,l,c):m(new e.zip.Deflater,i,o,0,i.size,"input",s,a,l,c)}(C,c++,p,t,v.level,G,h,u,d):G()})))}p?p.init(A,u):A()},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null);var n,i,o,c=0,u=0;for(i=0;i<s.length;i++)c+=46+(o=r[s[i]]).filename.length+o.comment.length;for(n=a(c+22),i=0;i<s.length;i++)o=r[s[i]],n.view.setUint32(u,1347092738),n.view.setUint16(u+4,5120),n.array.set(o.headerArray,u+6),n.view.setUint16(u+32,o.comment.length,!0),o.directory&&n.view.setUint8(u+38,16),n.view.setUint32(u+42,o.offset,!0),n.array.set(o.filename,u+46),n.array.set(o.comment,u+46+o.filename.length),u+=46+o.filename.length+o.comment.length;n.view.setUint32(u,1347093766),n.view.setUint16(u+8,s.length,!0),n.view.setUint16(u+10,s.length,!0),n.view.setUint32(u+12,c,!0),n.view.setUint32(u+16,l,!0),t.writeUint8Array(n.array,(function(){t.getData(e)}),d)},_worker:null};e.zip.useWebWorkers?T("deflater",(function(e){p._worker=e,n(p)}),(function(e){i(e)})):n(p)}o.prototype.append=function(e){for(var t=0|this.crc,n=this.table,i=0,o=0|e.length;i<o;i++)t=t>>>8^n[255&(t^e[i])];this.crc=t},o.prototype.get=function(){return~this.crc},o.prototype.table=function(){var e,t,n,i=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),r.prototype.append=function(e,t){return e},r.prototype.flush=function(){},l.prototype=new s,l.prototype.constructor=l,c.prototype=new s,c.prototype.constructor=c,d.prototype=new s,d.prototype.constructor=d,u.prototype.getData=function(e){e(this.data)},p.prototype=new u,p.prototype.constructor=p,g.prototype=new u,g.prototype.constructor=g,h.prototype=new u,h.prototype.constructor=h;var A={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function T(t,n,i){if(null===e.zip.workerScripts||null===e.zip.workerScriptsPath){var o,r,a;if(e.zip.workerScripts){if(o=e.zip.workerScripts[t],!Array.isArray(o))return void i(new Error("zip.workerScripts."+t+" is not an array!"));r=o,a=document.createElement("a"),o=r.map((function(e){return a.href=e,a.href}))}else(o=A[t].slice(0))[0]=(e.zip.workerScriptsPath||"")+o[0];var s=new Worker(o[0]);s.codecTime=s.crcTime=0,s.postMessage({type:"importScripts",scripts:o.slice(1)}),s.addEventListener("message",(function e(t){var o=t.data;if(o.error)return s.terminate(),void i(o.error);"importScripts"===o.type&&(s.removeEventListener("message",e),s.removeEventListener("error",l),n(s))})),s.addEventListener("error",l)}else i(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));function l(e){s.terminate(),i(e)}}function P(e){console.error(e)}e.zip={Reader:s,Writer:u,BlobReader:d,Data64URIReader:c,TextReader:l,BlobWriter:h,Data64URIWriter:g,TextWriter:p,createReader:function(e,t,n){n=n||P,e.init((function(){C(e,t,n)}),n)},createWriter:function(e,t,n,i){n=n||P,i=!!i,e.init((function(){G(e,t,n,i)}),n)},useWebWorkers:!0,workerScriptsPath:null,workerScripts:null}}(this)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n(9),n(25);var i=n(1347),o=n(12);e.exports=new class{async register(e){const t=gDesigner.getEnv();if("production"===t||"trunk"===t||"lts"===t||"rc"===t){const t=(0,i.getOS)(),n=gDesigner.getVersion();return o.gApi.diagnostic(Object.assign({runtime:gContainer.getRuntime(),os:t,userAgent:window.navigator.userAgent,version:n},e))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOS=void 0;var i=n(1);t.getOS=()=>{let e=null;switch(i.GSystem.operatingSystem){case i.GSystem.OperatingSystem.Unix:e="Unix";break;case i.GSystem.OperatingSystem.Windows:e="Windows";break;case i.GSystem.OperatingSystem.OSX_IOS:e="OSX"}return e}},function(e,t,n){"use strict";n(19),n(24);const i=n(230);e.exports=class{constructor(){this._missingFonts=[]}start(){i.getInstance().addEventListener(i.MissingFontEvent,this._missingFontEvent,this)}stop(){i.getInstance().removeEventListener(i.MissingFontEvent,this._missingFontEvent,this)}getMissingFonts(){return[...new Set(this._missingFonts)]}_missingFontEvent(e){var t=e.evt;this._missingFonts.push(t.family)}}},function(e,t,n){"use strict";n(9);const{GFontManager:i}=n(1);e.exports=class{constructor(e){this._fontManager=e,this._fontManager.addEventListener(i.FontAvailableEvent,this._fontEvent,this),this._fontManager.addEventListener(i.FontUnavailableEvent,this._fontEvent,this),this._promise=new Promise(e=>{this._resolver=e})}_fontEvent(){this._checkPendingFonts()}_checkPendingFonts(){this._fontManager.hasPendingFonts()||(this._fontManager.removeEventListener(i.FontAvailableEvent,this._fontEvent,this),this._fontManager.removeEventListener(i.FontUnavailableEvent,this._fontEvent,this),this._resolver())}waitForAllPendingFonts(){return this._checkPendingFonts(),this._promise}}},function(e,t,n){"use strict";let i;n(9),n(19),n(24);class o{static async getInstance(){if(!i){const e=await n.e(12).then(n.t.bind(null,1608,7));i=e.default}return new o}parse(e){return i({blob:e})}}e.exports=o},function(e,t,n){"use strict";n(9);var i=n(1),o=n(32);n(12);n(1352),n(202),n(36),n(106);function r(e,t,n){this._document=e,this._storageItem=t,this._file=t.getFile(),this._action=n,this._init()}i.GObject.inherit(r,i.GObject),r.prototype._init=function(){this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-paywall-dialog",closeTimeout:1100}),$("<div></div>").addClass("header").append($("<span></span>").addClass("gravit-icon-welcome")).appendTo(this._dialog),$("<div></div>").addClass("content").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GPaywallDialog","text.paywall-info"))).append($("<span></span>").addClass("price g-loading")).append($("<span></span>").text("."))).appendTo(this._dialog),$("<hr/>").appendTo(this._dialog),$("<div></div>").addClass("footer").append($("<button></button>").addClass("highlight").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GPaywallDialog","text.paywall-buy")))).append($("<span></span>").addClass("price g-loading")).on("click",this._buy.bind(this))).append($("<button></button>").text(i.GLocale.get(new i.GLocaleKey("GPaywallDialog","text.paywall-edit"))).on("click",this.close.bind(this))).appendTo(this._dialog),this._load()},r.prototype._load=async function(){const e=await this._storageItem.getFormattedPrice();this._dialog.find("span.price").removeClass("g-loading").text(e)},r.prototype._buy=async function(){},r.prototype.open=async function(){this._dialog.gDialog("open",!0),await(0,o.sleep)(100),this._dialog.closest(".g-dialog").addClass("slide-up")},r.prototype.close=function(){this._dialog.gDialog("close"),this._dialog.closest(".g-dialog").removeClass("slide-up")},e.exports=r},function(e,t,n){"use strict";n(58),n(14),n(29),n(9);var i=n(1),o=n(32);function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"file.save";this._document=e,this._user=t,this._action=n,this._init()}i.GObject.inherit(r,i.GObject),r.prototype._init=function(){this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-confirmation-dialog"}),$("<div></div>").addClass("header").append($("<span></span>").addClass("gravit-icon-thanks")).appendTo(this._dialog);const e=gDesigner.getAction(this._action);let t,n="save";e.getId().includes("save")?t=i.GLocale.get(new i.GLocaleKey("GConfirmationDialog","text.confirm-save")):e.getId().includes("export")?(t=i.GLocale.get(new i.GLocaleKey("GConfirmationDialog","text.confirm-export")),n="export"):t=e.getTitle()instanceof i.GLocaleKey?i.GLocale.get(e.getTitle()):e.getTitle(),$("<div></div>").addClass("content").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GConfirmationDialog","text.confirm-info-"+n)).replace("%email",this._user.email))).appendTo(this._dialog),$("<hr/>").appendTo(this._dialog),$("<div></div>").addClass("footer").append($("<button></button>").addClass("highlight").text(t).on("click",()=>{let e=[];"file.save"===this._action&&(e=[void 0,!0]),gDesigner.executeAction(this._action,e,"confirmationdialog"),this.close()})).appendTo(this._dialog)},r.prototype.open=async function(){this._dialog.gDialog("open",!0),await(0,o.sleep)(100),this._dialog.closest(".g-dialog").addClass("slide-up")},r.prototype.close=function(){this._dialog.gDialog("close"),this._dialog.closest(".g-dialog").removeClass("slide-up")},e.exports=r},function(e,t,n){"use strict";n(9);var i=n(710),o=n(1);n(232);function r(e,t,n,i,r,a){this._currentDocument=e,this._newDocument=t,this._localName=n,this._cloudName=i,this._callback=r,this._onCancel=a,this._dialog=$("<div></div>"),$("<div></div>").addClass("g-btn-close").css("display",this._onCancel?"":"none").append($("<span></span>").addClass("gravit-icon-close")).on("click",this.close.bind(this)).appendTo(this._dialog);var s=$("<div></div>").addClass("header").appendTo(this._dialog);$("<div></div>").addClass("title").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GDocumentChooser","text.cloud.sync.title")))).appendTo(s),$("<div></div>").addClass("subtitle").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GDocumentChooser","text.cloud.sync.subtitle")))).appendTo(s),this._container=$("<div></div>").addClass("container").appendTo(this._dialog),this._footer=$("<div></div>").addClass("footer").css("display",this._onCancel?"":"none").appendTo(this._dialog);let l=$("<div></div>").addClass("buttons").appendTo(this._footer);$("<button></button>").addClass("g-button").text(o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))).on("click",this.close.bind(this)).appendTo(l);this._dialog.gDialog({releaseOnClose:!0,className:"g-document-chooser"}),this._updatePreview()}o.GObject.inherit(r,o.GObject),r.prototype.open=function(){this._dialog.gDialog("open",!1)},r.prototype.close=function(){this._dialog.gDialog("close"),this._onCancel&&this._onCancel()},r.prototype._updatePreview=function(){this._container.empty(),this._createPreview(this._newDocument,"online",this._cloudName,this._newDocument.lastModifiedDate()>this._currentDocument.lastModifiedDate()),this._createPreview(this._currentDocument,"offline",this._localName,this._currentDocument.lastModifiedDate()>this._newDocument.lastModifiedDate())},r.prototype._loadPreview=function(e,t){return new Promise((function(n){if("offline"!==t){var i=[],r=function(e){if(e.image.getStatus()===o.GImage.ImageStatus.Loaded||e.image.getStatus()===o.GImage.ImageStatus.Error){e.image.removeEventListener(o.GImage.StatusEvent,this);var t=i.indexOf(e.image);-1!==t&&i.splice(t,1),i.length||n()}};e.acceptChildren(e=>{e instanceof o.GImage&&(e.getStatus()===o.GImage.ImageStatus.Error&&e.getStatus()===o.GImage.ImageStatus.Loaded||(i.push(e),e.addEventListener(o.GImage.StatusEvent,r)))}),i.length||n()}else n()}))},r.prototype._createPreview=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var a=$("<div />").addClass("image"),s=$("<div></div>").addClass("preview").on("click",()=>{gDesigner.stats("documentchooser_click_preview",t),this.close(),this._callback(e)}).appendTo(this._container),l=$("<div></div>").addClass("preview-image loading").css("background",o.GPattern.asCSSBackground(null)).append(a).appendTo(s);this._loadPreview(e,t).then(()=>{var t=i.GBitmapExport.export(e);l.removeClass("loading"),a.css("background-image","url(".concat(t.toImageDataUrl(o.GBitmap.ImageType.JPEG,1),")"))});var c=function(e){return 0===e.getTime()?o.GLocale.get(new o.GLocaleKey("GDocumentChooser","text.cloud.unavailable")):o.GLocale.toLocaleDate(e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})};s.append($("<div></div>").addClass("title").append($("<span></span>").text(n+" "+o.GLocale.get(new o.GLocaleKey("GDocumentChooser","text.cloud."+t))))).append($("<div></div>").addClass("subtitle").append($("<span></span>").text(c(e.lastModifiedDate())+(r?" "+o.GLocale.get(new o.GLocaleKey("GDocumentChooser","text.cloud.newer-file")):""))))},e.exports=r},function(e,t,n){var i=function(){"use strict";return i=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},i.prototype._singletonInstance)return i.prototype._singletonInstance;if(i.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),i.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},i.prototype._openPopup=function(e,t,n,i){try{var o=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=a/2-n/2+o,c=s/2-i/2+r,d=window.open(e,t,"width="+n+", height="+i+", top="+c+", left="+l);return d.focus&&d.focus(),d}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},i.prototype._handlePopupError=function(e,t,n,i,o){this.warn(i),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,i),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(i,null,n)},i.prototype._loginPopup=function(e,t,n){var i=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null!=i){if(this._openedWindows.push(i),-1!=this.config.redirectUri.indexOf("#"))var r=this.config.redirectUri.split("#")[0];else r=this.config.redirectUri;var a=this,s=window.setInterval((function(){if(!i||i.closed||void 0===i.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",n+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(o,t,e,n,n),void window.clearInterval(s)}try{var l=i.location;if(-1!=encodeURI(l.href).indexOf(encodeURI(r)))return a.isAngular?a._broadcast("adal:popUpHashChanged",l.hash):a.handleWindowCallback(l.hash),window.clearInterval(s),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void i.close()}catch(e){}}),1)}else{var l="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,t,"Error opening popup",l,l)}},i.prototype._broadcast=function(e,t){!function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},i.prototype.loginInProgress=function(){return this._loginInProgress},i.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},i.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),i=this.config.expireOffsetSeconds||300;return n&&n>this._now()+i?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},i.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},i.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var i=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,o,r,a){i._activeRenewals[t]=null;for(var s=0;s<i._callBacksMappedToRenewStates[e].length;++s)try{i._callBacksMappedToRenewStates[e][s](n,o,r,a)}catch(r){i.warn(r)}i._callBacksMappedToRenewStates[e]=null,i._callBackMappedToRenewStates[e]=null})},i.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var i=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),n=n||"token";var r=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),r+="&nonce="+encodeURIComponent(this._idTokenNonce)),r+="&prompt=none",r=this._addHintParameters(r),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+r),i.src="about:blank",this._loadFrameTimeout(r,"adalRenewFrame"+e,e)},i.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),i=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=i,this._renewStates.push(i),this.verbose("Renew Idtoken Expected state: "+i);var o=null==t?null:this.config.clientId,r=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt"));r+="&prompt=none",r=this._addHintParameters(r),r+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(i,this.config.clientId,e),this.verbosePii("Navigate to:"+r),n.src="about:blank",this._loadFrameTimeout(r,"adalIdTokenFrame",this.config.clientId)},i.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},i.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},i.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var i=this;setTimeout((function(){if(i._getItem(i.CONSTANTS.STORAGE.RENEW_STATUS+n)===i.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){i.verbose("Loading frame has timed out after: "+i.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=i._activeRenewals[n];e&&i._callBackMappedToRenewStates[e]&&i._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),i._saveItem(i.CONSTANTS.STORAGE.RENEW_STATUS+n,i.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),i.CONSTANTS.LOADFRAME_TIMEOUT)},i.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var i=t;setTimeout((function(){var t=n._addAdalFrame(i);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,i))}),500)},i.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},i.prototype.acquireTokenPopup=function(e,t,n,i){if(this._isEmpty(e))return this.warn("resource is required"),void i("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var r=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(r+="&prompt=select_account",t&&(r+=t),n&&-1===r.indexOf("&claims"))r+="&claims="+encodeURIComponent(n);else if(n&&-1!==r.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");r=this._addHintParameters(r),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,i),this._loginPopup(r,e,i)},i.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void i("resource is required",null,"resource is required");var i=this.callback;if(!this._user)return this.warn("User login is required"),void i("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void i("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var r=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(r+="&prompt=select_account",t&&(r+=t),n&&-1===r.indexOf("&claims"))r+="&claims="+encodeURIComponent(n);else if(n&&-1!==r.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");r=this._addHintParameters(r),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(r)},i.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},i.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},i.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},i.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},i.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},i.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},i.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},i.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},i.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},i.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},i.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},i.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var i="";if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),i=t.state,n.stateResponse=i,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,r=0;r<o.length;r++)if(o[r]===n.stateResponse){n.stateMatch=!0;break}}}return n},i.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.profile.nonce)return!0}return!1},i.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]&&t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var i=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(i){i=i.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<i.length;n++)if(i[n]&&i[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},i.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},i.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t,n=this._getResourceFromState(e.stateResponse);e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)?(this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description))):e.stateMatch?(this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),n=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(n)||(t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,t+n+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+n,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+n,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))):(e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse));this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},i.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},i.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},i.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var i,o,r=t.getRequestInfo(e),a=null;o=n||window.parent!==window?t._callBackMappedToRenewStates[r.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(r),r.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),i=r.parameters[t.CONSTANTS.ACCESS_TOKEN]||r.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ACCESS_TOKEN):r.requestType===this.REQUEST_TYPE.LOGIN&&(i=r.parameters[t.CONSTANTS.ID_TOKEN],a=t.CONSTANTS.ID_TOKEN);var s=r.parameters[t.CONSTANTS.ERROR_DESCRIPTION],l=r.parameters[t.CONSTANTS.ERROR];try{o&&o(s,i,l,a)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},i.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var i=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+i),i},i.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,i=this._base64DecodeStringUrlSafe(n);return i?JSON.parse(i):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},i.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},i.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var i,o,r,a,s,l,c,d,u="",p=0;p<n;p+=4){if(i=t.indexOf(e.charAt(p)),o=t.indexOf(e.charAt(p+1)),r=t.indexOf(e.charAt(p+2)),a=t.indexOf(e.charAt(p+3)),p+2===n-1){l=(s=i<<18|o<<12|r<<6)>>16&255,c=s>>8&255,u+=String.fromCharCode(l,c);break}if(p+1===n-1){l=(s=i<<18|o<<12)>>16&255,u+=String.fromCharCode(l);break}l=(s=i<<18|o<<12|r<<6|a)>>16&255,c=s>>8&255,d=255&s,u+=String.fromCharCode(l,c,d)}return u},i.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},i.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},i.prototype._serialize=function(e,t,n){var i=[];if(null!==t){i.push("?response_type="+e),i.push("client_id="+encodeURIComponent(t.clientId)),n&&i.push("resource="+encodeURIComponent(n)),i.push("redirect_uri="+encodeURIComponent(t.redirectUri)),i.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&i.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&i.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();i.push("client-request-id="+encodeURIComponent(o))}return i.join("&")},i.prototype._deserialize=function(e){var t,n=/\+/g,i=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},r={};for(t=i.exec(e);t;)r[o(t[1])]=o(t[2]),t=i.exec(e);return r},i.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},i.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",i="0123456789abcdef",o=0,r="",a=0;a<36;a++)"-"!==n[a]&&"4"!==n[a]&&(o=16*Math.random()|0),"x"===n[a]?r+=i[o]:"y"===n[a]?(o&=3,r+=i[o|=8]):r+=n[a];return r},i.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},i.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},i.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},i.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var i=this._getItem(e)||"";localStorage.setItem(e,i+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},i.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},i.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},i.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},i.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},i.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},i.prototype.log=function(e,t,n,i){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&i)return;var o=(new Date).toUTCString(),r="";r=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(r+="\nstack:\n"+n.stack),Logging.log(r)}},i.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},i.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},i.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},i.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},i.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},i.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},i.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},i.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},i.prototype._libVersion=function(){return"1.0.18"},e.exports&&(e.exports=i,e.exports.inject=function(e){return new i(e)}),i}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GMicrosoftUser=a,t.default=void 0,n(3);var i=n(1),o=n(1356),r=n(1126);function a(e){let{Id:t,Email:n,Title:i,UserId:o,UserPrincipalName:r}=e;this._id=t,this._email=n,this._name=i,this._userId=o,this._userPrincipalName=r}i.GObject.inherit(a,o.GCloudUser),a.ValidRoles=[r.GCloudRole.Type.Viewer,r.GCloudRole.Type.ContentEditor],a.prototype._userId=null,a.prototype.getValidRoles=function(){return a.ValidRoles},a.prototype.getEmail=function(){return this._email},a.prototype.getUserPrincipalName=function(){return this._userPrincipalName},a.prototype.getNameId=function(){return this._userId&&this._userId.NameId},a.prototype.toString=function(){return"[GObject GMicrosoftUser]"};var s=a;t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GCloudUser=o,t.default=void 0,n(58),n(3);var i=n(1126);function o(){}o.ValidRoles=[i.GCloudRole.Type.Viewer,i.GCloudRole.Type.Coauthor,i.GCloudRole.Type.Creator,i.GCloudRole.Type.Reviewer,i.GCloudRole.Type.Approver,i.GCloudRole.Type.ContentEditor],o.prototype._role=null,o.prototype._id=null,o.prototype._name=null,o.prototype._email=null,o.prototype.setRole=function(e){if(!(e instanceof i.GCloudRole))throw new Error("Incorrect type parameter");if(!this.getValidRoles().includes(e.getRole()))throw new Error("Incorrect User role");return this._role=e,this},o.prototype.getRole=function(){return this._role},o.prototype.getValidRoles=function(){return o.ValidRoles},o.prototype.getEmail=function(){return this._email},o.prototype.getId=function(){return this._id},o.prototype.getName=function(){return this._name},o.prototype.toString=function(){return"[Object GCloudUser]"};var r=o;t.default=r},function(e,t,n){"use strict";n(261);const i=n(12),{IS_LOCALHOST:o,IS_RC:r}=n(198);i.IS_TEAMS="teams.coreldraw.app"===window.location.hostname;const a=window.location.hostname.endsWith(".ngrok.io");i.IS_TEAMS?i.gApi.url=i.cloudTeamsURL:o||a?(i.trunkwebcdr&&(i.gApi.webcdr=i.cloudTrunkURL+"/api/webcdr"),i.gApi.url=i.cloudTrunkURL):i.IS_BETA?(i.cloudBetaURL&&(i.gApi.url=i.cloudBetaURL),i.betaWebcdr&&(i.gApi.webcdr=i.betaWebcdr)):r?(i.cloudRCURL&&(i.gApi.url=i.cloudRCURL),i.stagingWebcdr&&(i.gApi.webcdr=i.stagingWebcdr)):i.IS_TRUNK&&(i.gApi.url=i.cloudTrunkURL,i.trunkwebcdr&&(i.gApi.webcdr=i.trunkwebcdr)),!i.gApi.webcdr&&i.webcdr&&(i.gApi.webcdr=i.webcdr),window.gApi=i.gApi,e.exports=i},function(e,t,n){window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";var i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||((i=i||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.sendMessageEventToChild=t.waitForMessageQueue=t.sendMessageToParent=t.uninitializeCommunication=t.initializeCommunication=t.Communication=void 0;var o=n(4),r=n(6),a=n(3),s=function(){};t.Communication=s;var l=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e}();function c(e,t,n){var i;t instanceof Function?n=t:t instanceof Array&&(i=t),t=s.parentWindow,e=function(e,t){return{id:l.nextMessageId++,func:e,timestamp:Date.now(),args:t||[]}}(e,i),r.GlobalVars.isFramelessWindow?s.currentWindow&&s.currentWindow.nativeInterface&&s.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(e)):(i=g(t),t&&i?t.postMessage(e,i):p(t).push(e)),n&&(l.callbacks[e.id]=n)}function d(e){var t,n;e&&e.data&&"object"==typeof e.data&&function(e,t){return(!s.currentWindow||e!==s.currentWindow)&&(s.currentWindow&&s.currentWindow.location&&t&&t===s.currentWindow.location.origin||!!(o.validOriginRegExp.test(t.toLowerCase())||r.GlobalVars.additionalValidOriginsRegexp&&r.GlobalVars.additionalValidOriginsRegexp.test(t.toLowerCase())))}(t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin)&&(function(e,t){r.GlobalVars.isFramelessWindow||s.parentWindow&&!s.parentWindow.closed&&e!==s.parentWindow?s.childWindow&&!s.childWindow.closed&&e!==s.childWindow||(s.childWindow=e,s.childOrigin=t):(s.parentWindow=e,s.parentOrigin=t),s.parentWindow&&s.parentWindow.closed&&(s.parentWindow=null,s.parentOrigin=null),s.childWindow&&s.childWindow.closed&&(s.childWindow=null,s.childOrigin=null),h(s.parentWindow),h(s.childWindow)}(t,n),t===s.parentWindow?u(e):t===s.childWindow&&function(e){var t,n;"id"in e.data&&"func"in e.data&&(t=e.data,e=(n=(0,a.callHandler)(t.func,t.args))[0],n=n[1],e&&void 0!==n?f(t.id,Array.isArray(n)?n:[n]):c(t.func,t.args,(function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];s.childWindow&&(e=n.pop(),f(t.id,n,e))})))}(e))}function u(e){var t,n;"id"in e.data&&"number"==typeof e.data.id?(n=e.data,(t=l.callbacks[n.id])&&(t.apply(null,i(i([],n.args,!0),[n.isPartialResponse],!1)),function(e){return!0===e.data.isPartialResponse}(e)||delete l.callbacks[n.id])):"func"in e.data&&"string"==typeof e.data.func&&(n=e.data,(0,a.callHandler)(n.func,n.args))}function p(e){return e===s.parentWindow?l.parentMessageQueue:e===s.childWindow?l.childMessageQueue:[]}function g(e){return e===s.parentWindow?s.parentOrigin:e===s.childWindow?s.childOrigin:null}function h(e){for(var t=g(e),n=p(e);e&&t&&0<n.length;)e.postMessage(n.shift(),t)}function f(e,t,n){var i=s.childWindow;t=function(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}(e,t,n),n=g(i),i&&n&&i.postMessage(t,n)}t.initializeCommunication=function(e,t){l.messageListener=function(e){return d(e)},s.currentWindow=s.currentWindow||window,s.parentWindow=s.currentWindow.parent!==s.currentWindow.self?s.currentWindow.parent:s.currentWindow.opener,(s.parentWindow||t)&&s.currentWindow.addEventListener("message",l.messageListener,!1),s.parentWindow||(r.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=u);try{s.parentOrigin="*",c("initialize",[o.version],e)}finally{s.parentOrigin=null}},t.uninitializeCommunication=function(){s.currentWindow.removeEventListener("message",l.messageListener,!1),s.parentWindow=null,s.parentOrigin=null,s.childWindow=null,s.childOrigin=null,l.parentMessageQueue=[],l.childMessageQueue=[],l.nextMessageId=0,l.callbacks={}},t.sendMessageToParent=c,t.waitForMessageQueue=function(e,t){var n=s.currentWindow.setInterval((function(){0===p(e).length&&(clearInterval(n),t())}),100)},t.sendMessageEventToChild=function(e,t){var n=s.childWindow;e=function(e,t){return{func:e,args:t||[]}}(e,t),t=g(n),n&&t?n.postMessage(e,t):p(n).push(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processAdditionalValidOrigins=t.isAPISupportedByPlatform=t.ensureInitialized=void 0;var i=n(4),o=n(6),r=n(5);t.ensureInitialized=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!o.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized");if(o.GlobalVars.frameContext&&e&&0<e.length){for(var n=!1,i=0;i<e.length;i++)if(e[i]===o.GlobalVars.frameContext){n=!0;break}if(!n)throw new Error("This call is not allowed in the '"+o.GlobalVars.frameContext+"' context")}},t.isAPISupportedByPlatform=function(e){return void 0===e&&(e=i.defaultSDKVersionForCompatCheck),e=(0,r.compareSDKVersions)(o.GlobalVars.clientSupportedSDKVersion,e),!isNaN(e)&&0<=e},t.processAdditionalValidOrigins=function(e){e=o.GlobalVars.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&i.userOriginUrlValidationRegExp.test(e)})));var t={};e=e.filter((function(e){return!t[e]&&(t[e]=!0)})),o.GlobalVars.additionalValidOrigins=e,0<o.GlobalVars.additionalValidOrigins.length?o.GlobalVars.additionalValidOriginsRegexp=(0,r.generateRegExpFromUrls)(o.GlobalVars.additionalValidOrigins):o.GlobalVars.additionalValidOriginsRegexp=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelType=t.TaskModuleDimension=t.UserTeamRole=t.TeamType=t.FrameContexts=t.HostClientType=void 0,function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(t.HostClientType||(t.HostClientType={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(t.FrameContexts||(t.FrameContexts={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(t.TeamType||(t.TeamType={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(t.UserTeamRole||(t.UserTeamRole={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(t.TaskModuleDimension||(t.TaskModuleDimension={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(t.ChannelType||(t.ChannelType={}))},function(e,t,n){"use strict";var i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||((i=i||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerFocusEnterHandler=t.registerBackButtonHandler=t.handleThemeChange=t.registerOnThemeChangeHandler=t.removeHandler=t.registerHandler=t.callHandler=t.initializeHandlers=void 0;var o=n(8),r=n(0),a=function(){function e(){}return e.handlers={},e}();function s(e){a.themeChangeHandler&&a.themeChangeHandler(e),r.Communication.childWindow&&(0,r.sendMessageEventToChild)("themeChange",[e])}function l(){a.backButtonPressHandler&&a.backButtonPressHandler()||(0,o.navigateBack)()}function c(e){a.focusEnterHandler&&a.focusEnterHandler(e)}function d(e){a.loadHandler&&a.loadHandler(e),r.Communication.childWindow&&(0,r.sendMessageEventToChild)("load",[e])}function u(){function e(){(0,r.sendMessageToParent)("readyToUnload",[])}a.beforeUnloadHandler&&a.beforeUnloadHandler(e)||e()}t.initializeHandlers=function(){a.handlers.themeChange=s,a.handlers.backButtonPress=l,a.handlers.load=d,a.handlers.beforeUnload=u,a.handlers.focusEnter=c},t.callHandler=function(e,t){return(e=a.handlers[e])?[!0,e.apply(this,t)]:[!1,void 0]},t.registerHandler=function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=[]),t?(a.handlers[e]=t,n&&(0,r.sendMessageToParent)("registerHandler",i([e],o,!0))):delete a.handlers[e]},t.removeHandler=function(e){delete a.handlers[e]},t.registerOnThemeChangeHandler=function(e){(a.themeChangeHandler=e)&&(0,r.sendMessageToParent)("registerHandler",["themeChange"])},t.handleThemeChange=s,t.registerBackButtonHandler=function(e){(a.backButtonPressHandler=e)&&(0,r.sendMessageToParent)("registerHandler",["backButton"])},t.registerFocusEnterHandler=function(e){(a.focusEnterHandler=e)&&(0,r.sendMessageToParent)("registerHandler",["focusEnter"])},t.registerOnLoadHandler=function(e){(a.loadHandler=e)&&(0,r.sendMessageToParent)("registerHandler",["load"])},t.registerBeforeUnloadHandler=function(e){(a.beforeUnloadHandler=e)&&(0,r.sendMessageToParent)("registerHandler",["beforeUnload"])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userOriginUrlValidationRegExp=t.validOriginRegExp=t.validOrigins=t.scanBarCodeAPIMobileSupportVersion=t.getMediaCallbackSupportVersion=t.mediaAPISupportVersion=t.captureImageMobileSupportVersion=t.peoplePickerRequiredVersion=t.locationAPIsRequiredVersion=t.getUserJoinedTeamsSupportedAndroidClientVersion=t.videoAndImageMediaAPISupportVersion=t.defaultSDKVersionForCompatCheck=t.version=void 0,n=n(5),t.version="1.11.0",t.defaultSDKVersionForCompatCheck="2.0.1",t.videoAndImageMediaAPISupportVersion="2.0.2",t.getUserJoinedTeamsSupportedAndroidClientVersion="2.0.1",t.locationAPIsRequiredVersion="1.9.0",t.peoplePickerRequiredVersion="2.0.0",t.captureImageMobileSupportVersion="1.7.0",t.mediaAPISupportVersion="1.8.0",t.getMediaCallbackSupportVersion="2.0.0",t.scanBarCodeAPIMobileSupportVersion="1.9.0",t.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://teams.live.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.live.com","https://local.teams.live.com:8080","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com","https://www.office.com","https://word.office.com","https://excel.office.com","https://powerpoint.office.com","https://www.officeppe.com","https://*.www.office.com"],t.validOriginRegExp=(0,n.generateRegExpFromUrls)(t.validOrigins),t.userOriginUrlValidationRegExp=/^https\:\/\//},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateGUID=t.compareSDKVersions=t.getGenericOnCompleteHandler=t.generateRegExpFromUrls=void 0;var i=n(22);function o(e){for(var t="^",n=e.split("."),i=0;i<n.length;i++)t+=(0<i?"[.]":"")+n[i].replace("*","[^/^.]+");return t+"$"}t.generateRegExpFromUrls=function(e){for(var t="",n=0;n<e.length;n++)t+=(0===n?"":"|")+o(e[n]);return new RegExp(t)},t.getGenericOnCompleteHandler=function(e){return function(t,n){if(!t)throw new Error(e||n)}},t.compareSDKVersions=function(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),i=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!i.every(o))return NaN;for(;n.length<i.length;)n.push("0");for(;i.length<n.length;)i.push("0");for(var r=0;r<n.length;++r)if(Number(n[r])!=Number(i[r]))return Number(n[r])>Number(i[r])?1:-1;return 0},t.generateGUID=function(){return i.v4()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalVars=void 0;var i=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}();t.GlobalVars=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=t.FileOpenPreference=void 0,function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(t.FileOpenPreference||(t.FileOpenPreference={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(t.ErrorCode||(t.ErrorCode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharing=t.video=t.people=t.monetization=t.meeting=t.location=t.media=t.ParentAppWindow=t.ChildAppWindow=t.tasks=t.settings=t.navigateToTab=t.navigateCrossDomain=t.navigateBack=t.returnFocus=t.shareDeepLink=t.setFrameContext=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerOnThemeChangeHandler=t.registerOnLoadHandler=t.registerFullScreenHandler=t.registerEnterSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerBackButtonHandler=t.print=t.initializeWithFrameContext=t.initialize=t.getTabInstances=t.getMruTabInstances=t.getContext=t.executeDeepLink=t.enablePrintCapability=t.FileOpenPreference=t.ErrorCode=t.ChannelType=t.UserTeamRole=t.TeamType=t.TaskModuleDimension=t.HostClientType=t.FrameContexts=t.authentication=t.appInitialization=void 0;var i=n(25);Object.defineProperty(t,"appInitialization",{enumerable:!0,get:function(){return i.appInitialization}});var o=n(11);Object.defineProperty(t,"authentication",{enumerable:!0,get:function(){return o.authentication}});var r=n(2);Object.defineProperty(t,"FrameContexts",{enumerable:!0,get:function(){return r.FrameContexts}}),Object.defineProperty(t,"HostClientType",{enumerable:!0,get:function(){return r.HostClientType}}),Object.defineProperty(t,"TaskModuleDimension",{enumerable:!0,get:function(){return r.TaskModuleDimension}}),Object.defineProperty(t,"TeamType",{enumerable:!0,get:function(){return r.TeamType}}),Object.defineProperty(t,"UserTeamRole",{enumerable:!0,get:function(){return r.UserTeamRole}}),Object.defineProperty(t,"ChannelType",{enumerable:!0,get:function(){return r.ChannelType}});var a=n(7);Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return a.ErrorCode}}),Object.defineProperty(t,"FileOpenPreference",{enumerable:!0,get:function(){return a.FileOpenPreference}});var s=n(26);Object.defineProperty(t,"enablePrintCapability",{enumerable:!0,get:function(){return s.enablePrintCapability}}),Object.defineProperty(t,"executeDeepLink",{enumerable:!0,get:function(){return s.executeDeepLink}}),Object.defineProperty(t,"getContext",{enumerable:!0,get:function(){return s.getContext}}),Object.defineProperty(t,"getMruTabInstances",{enumerable:!0,get:function(){return s.getMruTabInstances}}),Object.defineProperty(t,"getTabInstances",{enumerable:!0,get:function(){return s.getTabInstances}}),Object.defineProperty(t,"initialize",{enumerable:!0,get:function(){return s.initialize}}),Object.defineProperty(t,"initializeWithFrameContext",{enumerable:!0,get:function(){return s.initializeWithFrameContext}}),Object.defineProperty(t,"print",{enumerable:!0,get:function(){return s.print}}),Object.defineProperty(t,"registerBackButtonHandler",{enumerable:!0,get:function(){return s.registerBackButtonHandler}}),Object.defineProperty(t,"registerBeforeUnloadHandler",{enumerable:!0,get:function(){return s.registerBeforeUnloadHandler}}),Object.defineProperty(t,"registerFocusEnterHandler",{enumerable:!0,get:function(){return s.registerFocusEnterHandler}}),Object.defineProperty(t,"registerEnterSettingsHandler",{enumerable:!0,get:function(){return s.registerEnterSettingsHandler}}),Object.defineProperty(t,"registerFullScreenHandler",{enumerable:!0,get:function(){return s.registerFullScreenHandler}}),Object.defineProperty(t,"registerOnLoadHandler",{enumerable:!0,get:function(){return s.registerOnLoadHandler}}),Object.defineProperty(t,"registerOnThemeChangeHandler",{enumerable:!0,get:function(){return s.registerOnThemeChangeHandler}}),Object.defineProperty(t,"registerAppButtonClickHandler",{enumerable:!0,get:function(){return s.registerAppButtonClickHandler}}),Object.defineProperty(t,"registerAppButtonHoverEnterHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverEnterHandler}}),Object.defineProperty(t,"registerAppButtonHoverLeaveHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverLeaveHandler}}),Object.defineProperty(t,"setFrameContext",{enumerable:!0,get:function(){return s.setFrameContext}}),Object.defineProperty(t,"shareDeepLink",{enumerable:!0,get:function(){return s.shareDeepLink}});var l=n(27);Object.defineProperty(t,"returnFocus",{enumerable:!0,get:function(){return l.returnFocus}}),Object.defineProperty(t,"navigateBack",{enumerable:!0,get:function(){return l.navigateBack}}),Object.defineProperty(t,"navigateCrossDomain",{enumerable:!0,get:function(){return l.navigateCrossDomain}}),Object.defineProperty(t,"navigateToTab",{enumerable:!0,get:function(){return l.navigateToTab}});var c=n(12);Object.defineProperty(t,"settings",{enumerable:!0,get:function(){return c.settings}});var d=n(28);Object.defineProperty(t,"tasks",{enumerable:!0,get:function(){return d.tasks}});var u=n(16);Object.defineProperty(t,"ChildAppWindow",{enumerable:!0,get:function(){return u.ChildAppWindow}}),Object.defineProperty(t,"ParentAppWindow",{enumerable:!0,get:function(){return u.ParentAppWindow}});var p=n(17);Object.defineProperty(t,"media",{enumerable:!0,get:function(){return p.media}});var g=n(29);Object.defineProperty(t,"location",{enumerable:!0,get:function(){return g.location}});var h=n(30);Object.defineProperty(t,"meeting",{enumerable:!0,get:function(){return h.meeting}});var f=n(31);Object.defineProperty(t,"monetization",{enumerable:!0,get:function(){return f.monetization}});var m=n(32);Object.defineProperty(t,"people",{enumerable:!0,get:function(){return m.people}});var y=n(33);Object.defineProperty(t,"video",{enumerable:!0,get:function(){return y.video}});var v=n(34);Object.defineProperty(t,"sharing",{enumerable:!0,get:function(){return v.sharing}})},function(e,t){var n,i,o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);o?(n=new Uint8Array(16),e.exports=function(){return o(n),n}):(i=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i})},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0;return[(t=n)[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],"-",t[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],t[e[i++]],t[e[+i]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.authentication=void 0;var i=n(1),o=n(6),r=n(2),a=n(0),s=n(3);!function(e){var t,n;function l(){c();try{a.Communication.childWindow&&a.Communication.childWindow.close()}finally{a.Communication.childWindow=null,a.Communication.childOrigin=null}}function c(){n&&(clearInterval(n),n=0),(0,s.removeHandler)("initialize"),(0,s.removeHandler)("navigateCrossDomain")}function d(){c(),n=a.Communication.currentWindow.setInterval((function(){if(!a.Communication.childWindow||a.Communication.childWindow.closed)p("CancelledByUser");else{var e=a.Communication.childOrigin;try{a.Communication.childOrigin="*",(0,a.sendMessageEventToChild)("ping")}finally{a.Communication.childOrigin=e}}}),100),(0,s.registerHandler)("initialize",(function(){return[r.FrameContexts.authentication,o.GlobalVars.hostClientType]})),(0,s.registerHandler)("navigateCrossDomain",(function(){return!1}))}function u(e){try{t&&t.successCallback&&t.successCallback(e)}finally{t=null,l()}}function p(e){try{t&&t.failureCallback&&t.failureCallback(e)}finally{t=null,l()}}function g(e,t,n){var i;e&&((i=document.createElement("a")).href=decodeURIComponent(e),i.host&&i.host!==window.location.host&&"outlook.office.com"===i.host&&-1<i.search.indexOf("client_type=Win32_Outlook")&&(t&&"result"===t&&(n&&(i.href=h(i.href,"result",n)),a.Communication.currentWindow.location.assign(h(i.href,"authSuccess",""))),t&&"reason"===t&&(n&&(i.href=h(i.href,"reason",n)),a.Communication.currentWindow.location.assign(h(i.href,"authFailure","")))))}function h(e,t,n){var i=e.indexOf("#"),o=(o=-1===i?"#":e.substr(i))+"&"+t+(""!==n?"="+n:"");return(e=-1===i?e:e.substr(0,i))+o}e.initialize=function(){(0,s.registerHandler)("authentication.authenticate.success",u,!1),(0,s.registerHandler)("authentication.authenticate.failure",p,!1)},e.registerAuthenticationHandlers=function(e){t=e},e.authenticate=function(e){var n=void 0!==e?e:t;(0,i.ensureInitialized)(r.FrameContexts.content,r.FrameContexts.sidePanel,r.FrameContexts.settings,r.FrameContexts.remove,r.FrameContexts.task,r.FrameContexts.stage,r.FrameContexts.meetingStage),o.GlobalVars.hostClientType===r.HostClientType.desktop||o.GlobalVars.hostClientType===r.HostClientType.android||o.GlobalVars.hostClientType===r.HostClientType.ios||o.GlobalVars.hostClientType===r.HostClientType.rigel||o.GlobalVars.hostClientType===r.HostClientType.teamsRoomsWindows||o.GlobalVars.hostClientType===r.HostClientType.teamsRoomsAndroid||o.GlobalVars.hostClientType===r.HostClientType.teamsPhones||o.GlobalVars.hostClientType===r.HostClientType.teamsDisplays?((e=document.createElement("a")).href=n.url,(0,a.sendMessageToParent)("authentication.authenticate",[e.href,n.width,n.height],(function(e,t){e?n.successCallback(t):n.failureCallback(t)}))):function(e){t=e,l();var n=t.width||600,i=t.height||400,o=(n=Math.min(n,a.Communication.currentWindow.outerWidth-400),i=Math.min(i,a.Communication.currentWindow.outerHeight-200),document.createElement("a"));o.href=t.url;var r=void 0!==a.Communication.currentWindow.screenLeft?a.Communication.currentWindow.screenLeft:a.Communication.currentWindow.screenX;e=void 0!==a.Communication.currentWindow.screenTop?a.Communication.currentWindow.screenTop:a.Communication.currentWindow.screenY,r+=a.Communication.currentWindow.outerWidth/2-n/2,e+=a.Communication.currentWindow.outerHeight/2-i/2,a.Communication.childWindow=a.Communication.currentWindow.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+e+", left="+r+", width="+n+", height="+i),a.Communication.childWindow?d():p("FailedToOpenWindow")}(n)},e.getAuthToken=function(e){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getAuthToken",[e.resources,e.claims,e.silent],(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.getUser=function(e){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("authentication.getUser",(function(t,n){t?e.successCallback(n):e.failureCallback(n)}))},e.notifySuccess=function(e,t){g(t,"result",e),(0,i.ensureInitialized)(r.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.success",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))},e.notifyFailure=function(e,t){g(t,"reason",e),(0,i.ensureInitialized)(r.FrameContexts.authentication),(0,a.sendMessageToParent)("authentication.authenticate.failure",[e]),(0,a.waitForMessageQueue)(a.Communication.parentWindow,(function(){return setTimeout((function(){return a.Communication.currentWindow.close()}),200)}))}}(t.authentication||(t.authentication={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.settings=void 0;var i=n(1),o=n(2),r=n(5),a=n(0),s=n(3);!function(e){var t,n;function l(e){e=new c(e),t?t(e):e.notifySuccess()}e.initialize=function(){(0,s.registerHandler)("settings.save",l,!1),(0,s.registerHandler)("settings.remove",d,!1)},e.setValidityState=function(e){(0,i.ensureInitialized)(o.FrameContexts.settings,o.FrameContexts.remove),(0,a.sendMessageToParent)("settings.setValidityState",[e])},e.getSettings=function(e){(0,i.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.remove,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.getSettings",e)},e.setSettings=function(e,t){(0,i.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.settings,o.FrameContexts.sidePanel),(0,a.sendMessageToParent)("settings.setSettings",[e],t||(0,r.getGenericOnCompleteHandler)())},e.registerOnSaveHandler=function(e){(0,i.ensureInitialized)(o.FrameContexts.settings),(t=e)&&(0,a.sendMessageToParent)("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){(0,i.ensureInitialized)(o.FrameContexts.remove,o.FrameContexts.settings),(n=e)&&(0,a.sendMessageToParent)("registerHandler",["remove"])};var c=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function d(){var e=new u;n?n(e):e.notifySuccess()}var u=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),(0,a.sendMessageToParent)("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}()}(t.settings||(t.settings={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logs=void 0;var i=n(1),o=n(0),r=n(3);(t.logs||(t.logs={})).registerGetLogHandler=function(e){(0,i.ensureInitialized)(),e?(0,r.registerHandler)("log.request",(function(){var t=e();(0,o.sendMessageToParent)("log.receive",[t])})):(0,r.removeHandler)("log.request")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerUserSettingsChangeHandler=t.getConfigSetting=t.getChatMembers=t.registerCustomHandler=t.sendCustomEvent=t.sendCustomMessage=t.uploadCustomApp=t.showNotification=t.openFilePreview=t.exitFullscreen=t.enterFullscreen=t.getUserJoinedTeams=t.initializePrivateApis=void 0;var i=n(1),o=n(2),r=n(5),a=n(0),s=n(15),l=n(3),c=n(6),d=n(7),u=n(4);t.initializePrivateApis=function(){s.menus.initialize()},t.getUserJoinedTeams=function(e,t){if((0,i.ensureInitialized)(),(c.GlobalVars.hostClientType===o.HostClientType.android||c.GlobalVars.hostClientType===o.HostClientType.teamsRoomsAndroid||c.GlobalVars.hostClientType===o.HostClientType.teamsPhones||c.GlobalVars.hostClientType===o.HostClientType.teamsDisplays)&&!(0,i.isAPISupportedByPlatform)(u.getUserJoinedTeamsSupportedAndroidClientVersion)){var n={errorCode:d.ErrorCode.OLD_PLATFORM};throw new Error(JSON.stringify(n))}(0,a.sendMessageToParent)("getUserJoinedTeams",[t],e)},t.enterFullscreen=function(){(0,i.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("enterFullscreen",[])},t.exitFullscreen=function(){(0,i.ensureInitialized)(o.FrameContexts.content),(0,a.sendMessageToParent)("exitFullscreen",[])},t.openFilePreview=function(e){(0,i.ensureInitialized)(o.FrameContexts.content),e=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId],(0,a.sendMessageToParent)("openFilePreview",e)},t.showNotification=function(e){(0,i.ensureInitialized)(o.FrameContexts.content),e=[e.message,e.notificationType],(0,a.sendMessageToParent)("showNotification",e)},t.uploadCustomApp=function(e,t){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("uploadCustomApp",[e],t||(0,r.getGenericOnCompleteHandler)())},t.sendCustomMessage=function(e,t,n){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)(e,t,n)},t.sendCustomEvent=function(e,t){if((0,i.ensureInitialized)(),!a.Communication.childWindow)throw new Error("The child window has not yet been initialized or is not present");(0,a.sendMessageEventToChild)(e,t)},t.registerCustomHandler=function(e,t){var n=this;(0,i.ensureInitialized)(),(0,l.registerHandler)(e,(function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.apply(n,e)}))},t.getChatMembers=function(e){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("getChatMembers",e)},t.getConfigSetting=function(e,t){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("getConfigSetting",[t],e)},t.registerUserSettingsChangeHandler=function(e,t){(0,i.ensureInitialized)(),(0,l.registerHandler)("userSettingsChange",t,!0,[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.menus=void 0;var i=n(1),o=n(0),r=n(3);!function(e){var t,n,a,s=function(){this.enabled=!0,this.selected=!1};function l(e){a&&a(e)||((0,i.ensureInitialized)(),(0,o.sendMessageToParent)("viewConfigItemPress",[e]))}function c(e){t&&t(e)||((0,i.ensureInitialized)(),(0,o.sendMessageToParent)("handleNavBarMenuItemPress",[e]))}function d(e){n&&n(e)||((0,i.ensureInitialized)(),(0,o.sendMessageToParent)("handleActionMenuItemPress",[e]))}e.MenuItem=s,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){(0,r.registerHandler)("navBarMenuItemPress",c,!1),(0,r.registerHandler)("actionMenuItemPress",d,!1),(0,r.registerHandler)("setModuleView",l,!1)},e.setUpViews=function(e,t){(0,i.ensureInitialized)(),a=t,(0,o.sendMessageToParent)("setUpViews",[e])},e.setNavBarMenu=function(e,n){(0,i.ensureInitialized)(),t=n,(0,o.sendMessageToParent)("setNavBarMenu",[e])},e.showActionMenu=function(e,t){(0,i.ensureInitialized)(),n=t,(0,o.sendMessageToParent)("showActionMenu",[e])}}(t.menus||(t.menus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParentAppWindow=t.ChildAppWindow=void 0;var i=n(1),o=n(2),r=n(5),a=n(0),s=n(3);n=function(){function e(){}return e.prototype.postMessage=function(e,t){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("messageForChild",[e],t||(0,r.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForParent",t)},e}(),t.ChildAppWindow=n,n=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){(0,i.ensureInitialized)(o.FrameContexts.task),(0,a.sendMessageToParent)("messageForParent",[e],t||(0,r.getGenericOnCompleteHandler)())},e.prototype.addEventListener=function(e,t){"message"===e&&(0,s.registerHandler)("messageForChild",t)},e}(),t.ParentAppWindow=n},function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:!0}),t.media=void 0;var o=n(6),r=n(7),a=n(1),s=n(2),l=n(5),c=n(18),d=n(0),u=n(3),p=n(4);!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var t=function(){};e.File=t,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),o.GlobalVars.isFramelessWindow?(0,a.isAPISupportedByPlatform)(p.captureImageMobileSupportVersion)?(0,d.sendMessageToParent)("captureImage",e):e({errorCode:r.ErrorCode.OLD_PLATFORM},void 0):e({errorCode:r.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},void 0)};var n=function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return i(t,e),t.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)?(0,c.validateGetMediaInputs)(this.mimeType,this.format,this.content)?(0,a.isAPISupportedByPlatform)(p.getMediaCallbackSupportVersion)?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:r.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:r.ErrorCode.OLD_PLATFORM},null)},t.prototype.getMediaViaCallback=function(e){var t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];(0,d.sendMessageToParent)("getMedia",n,(function(n){var i;e&&(n&&n.error?e(n.error,null):n&&n.mediaChunk?n.mediaChunk.chunkSequence<=0?(i=(0,c.createFile)(t.assembleAttachment,t.mediaMimeType),e(n.error,i)):(n=(0,c.decodeAttachment)(n.mediaChunk,t.mediaMimeType),t.assembleAttachment.push(n)):e({errorCode:r.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null))}))},t.prototype.getMediaViaHandler=function(e){var t=(0,l.generateGUID)(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},i=[t,this.content];this.content&&e&&(0,d.sendMessageToParent)("getMedia",i),(0,u.registerHandler)("getMedia"+t,(function(i){var o;e&&((o=JSON.parse(i)).error?(e(o.error,null),(0,u.removeHandler)("getMedia"+t)):o.mediaChunk?o.mediaChunk.chunkSequence<=0?(i=(0,c.createFile)(n.assembleAttachment,n.mediaMimeType),e(o.error,i),(0,u.removeHandler)("getMedia"+t)):(o=(0,c.decodeAttachment)(o.mediaChunk,n.mediaMimeType),n.assembleAttachment.push(o)):(e({errorCode:r.ErrorCode.INTERNAL_ERROR,message:"data received is null"},null),(0,u.removeHandler)("getMedia"+t)))}))},t}(t);e.Media=n,function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if((0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)){if((0,c.isMediaCallForVideoAndImageInputs)(e)){if(o.GlobalVars.hostClientType!=s.HostClientType.android&&o.GlobalVars.hostClientType!=s.HostClientType.ios){var i={errorCode:r.ErrorCode.NOT_SUPPORTED_ON_PLATFORM};return void t(i,null)}if(!(0,a.isAPISupportedByPlatform)(p.videoAndImageMediaAPISupportVersion))return l={errorCode:r.ErrorCode.OLD_PLATFORM},void t(l,null)}(0,c.validateSelectMediaInputs)(e)?(0,d.sendMessageToParent)("selectMedia",[e],(function(e,i){if(i){for(var o=[],r=0,a=i;r<a.length;r++){var s=a[r];o.push(new n(s))}t(e,o)}else t(e,null)})):(e={errorCode:r.ErrorCode.INVALID_ARGUMENTS},t(e,null))}else{var l={errorCode:r.ErrorCode.OLD_PLATFORM};t(l,null)}},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),(0,a.isAPISupportedByPlatform)(p.mediaAPISupportVersion)?(0,c.validateViewImagesInput)(e)?(0,d.sendMessageToParent)("viewImages",[e],t):t({errorCode:r.ErrorCode.INVALID_ARGUMENTS}):t({errorCode:r.ErrorCode.OLD_PLATFORM})},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");(0,a.ensureInitialized)(s.FrameContexts.content,s.FrameContexts.task),o.GlobalVars.hostClientType!==s.HostClientType.desktop&&o.GlobalVars.hostClientType!==s.HostClientType.web&&o.GlobalVars.hostClientType!==s.HostClientType.rigel&&o.GlobalVars.hostClientType!==s.HostClientType.teamsRoomsWindows&&o.GlobalVars.hostClientType!==s.HostClientType.teamsRoomsAndroid&&o.GlobalVars.hostClientType!==s.HostClientType.teamsPhones&&o.GlobalVars.hostClientType!==s.HostClientType.teamsDisplays?(0,a.isAPISupportedByPlatform)(p.scanBarCodeAPIMobileSupportVersion)?(0,c.validateScanBarCodeInput)(t)?(0,d.sendMessageToParent)("media.scanBarCode",[t],e):e({errorCode:r.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:r.ErrorCode.OLD_PLATFORM},null):e({errorCode:r.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},null)}}(t.media||(t.media={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validatePeoplePickerInput=t.validateScanBarCodeInput=t.validateViewImagesInput=t.validateGetMediaInputs=t.isMediaCallForVideoAndImageInputs=t.validateSelectMediaInputs=t.decodeAttachment=t.createFile=void 0;var i=n(17);t.createFile=function(e,t){if(null==e||null==t||e.length<=0)return null;var n,i=1;return e.sort((function(e,t){return e.sequence>t.sequence?1:-1})),e.forEach((function(e){e.sequence==i&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),i++)})),n},t.decodeAttachment=function(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),i=new Array(n.length),o=0;o<n.length;o++)i[o]=n.charCodeAt(o);var r=new Uint8Array(i);return t=new Blob([r],{type:t}),{sequence:e.chunkSequence,file:t}},t.validateSelectMediaInputs=function(e){return!(null==e||10<e.maxMediaCount)},t.isMediaCallForVideoAndImageInputs=function(e){return!(!e||e.mediaType!=i.media.MediaType.VideoAndImage&&!e.videoAndImageProps)},t.validateGetMediaInputs=function(e,t,n){return null!=e&&null!=t&&t==i.media.FileFormat.ID&&null!=n},t.validateViewImagesInput=function(e){return!(null==e||e.length<=0||10<e.length)},t.validateScanBarCodeInput=function(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||60<e.timeOutIntervalInSec)},t.validatePeoplePickerInput=function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){e[i=void 0===i?n:i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(20),t),o(n(8),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=t.appEntity=t.files=t.remoteCamera=t.meetingRoom=t.conversations=t.registerUserSettingsChangeHandler=t.uploadCustomApp=t.registerCustomHandler=t.sendCustomEvent=t.showNotification=t.sendCustomMessage=t.openFilePreview=t.getUserJoinedTeams=t.getConfigSetting=t.getChatMembers=t.exitFullscreen=t.enterFullscreen=t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=t.logs=t.menus=t.bot=void 0;var i=n(21);Object.defineProperty(t,"bot",{enumerable:!0,get:function(){return i.bot}});var o=n(15);Object.defineProperty(t,"menus",{enumerable:!0,get:function(){return o.menus}});var r=n(13);Object.defineProperty(t,"logs",{enumerable:!0,get:function(){return r.logs}});var a=n(35);Object.defineProperty(t,"NotificationTypes",{enumerable:!0,get:function(){return a.NotificationTypes}}),Object.defineProperty(t,"ViewerActionTypes",{enumerable:!0,get:function(){return a.ViewerActionTypes}}),Object.defineProperty(t,"UserSettingTypes",{enumerable:!0,get:function(){return a.UserSettingTypes}});var s=n(14);Object.defineProperty(t,"enterFullscreen",{enumerable:!0,get:function(){return s.enterFullscreen}}),Object.defineProperty(t,"exitFullscreen",{enumerable:!0,get:function(){return s.exitFullscreen}}),Object.defineProperty(t,"getChatMembers",{enumerable:!0,get:function(){return s.getChatMembers}}),Object.defineProperty(t,"getConfigSetting",{enumerable:!0,get:function(){return s.getConfigSetting}}),Object.defineProperty(t,"getUserJoinedTeams",{enumerable:!0,get:function(){return s.getUserJoinedTeams}}),Object.defineProperty(t,"openFilePreview",{enumerable:!0,get:function(){return s.openFilePreview}}),Object.defineProperty(t,"sendCustomMessage",{enumerable:!0,get:function(){return s.sendCustomMessage}}),Object.defineProperty(t,"showNotification",{enumerable:!0,get:function(){return s.showNotification}}),Object.defineProperty(t,"sendCustomEvent",{enumerable:!0,get:function(){return s.sendCustomEvent}}),Object.defineProperty(t,"registerCustomHandler",{enumerable:!0,get:function(){return s.registerCustomHandler}}),Object.defineProperty(t,"uploadCustomApp",{enumerable:!0,get:function(){return s.uploadCustomApp}}),Object.defineProperty(t,"registerUserSettingsChangeHandler",{enumerable:!0,get:function(){return s.registerUserSettingsChangeHandler}});var l=n(36);Object.defineProperty(t,"conversations",{enumerable:!0,get:function(){return l.conversations}});var c=n(37);Object.defineProperty(t,"meetingRoom",{enumerable:!0,get:function(){return c.meetingRoom}});var d=n(38);Object.defineProperty(t,"remoteCamera",{enumerable:!0,get:function(){return d.remoteCamera}});var u=n(39);Object.defineProperty(t,"files",{enumerable:!0,get:function(){return u.files}});var p=n(40);Object.defineProperty(t,"appEntity",{enumerable:!0,get:function(){return p.appEntity}});var g=n(41);Object.defineProperty(t,"teams",{enumerable:!0,get:function(){return g.teams}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bot=void 0;var i=n(0),o=n(1);!function(e){e.sendQuery=function(e,t,n){(0,o.ensureInitialized)(),(0,i.sendMessageToParent)("bot.executeQuery",[e],(function(e,i){(e?t:n)(i)}))},e.getSupportedCommands=function(e,t){(0,o.ensureInitialized)(),(0,i.sendMessageToParent)("bot.getSupportedCommands",(function(n,i){(n?e:t)(i)}))},e.authenticate=function(e,t,n){(0,o.ensureInitialized)(),(0,i.sendMessageToParent)("bot.authenticate",[e],(function(e,i){(e?t:n)(i)}))},function(e){e.Results="Results",e.Auth="Auth"}(e.ResponseType||(e.ResponseType={}))}(t.bot||(t.bot={}))},function(e,t,n){var i=n(23),o=n(24);(n=o).v1=i,n.v4=o,e.exports=n},function(e,t,n){var i,o,r=n(9),a=n(10),s=0,l=0;e.exports=function(e,t,n){var c=t&&n||0,d=t||[],u=(e=e||{}).node||i,p=void 0!==e.clockseq?e.clockseq:o;null!=u&&null!=p||(h=r(),null==u&&(u=i=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==p&&(p=o=16383&(h[6]<<8|h[7])));var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=(n=void 0!==e.nsecs?e.nsecs:l+1,g-s+(n-l)/1e4);if(h<0&&void 0===e.clockseq&&(p=p+1&16383),1e4<=(n=(h<0||s<g)&&void 0===e.nsecs?0:n))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=g,o=p,n=(1e4*(268435455&(g+=122192928e5))+(l=n))%4294967296,d[c++]=n>>>24&255,d[c++]=n>>>16&255,d[c++]=n>>>8&255,d[c++]=255&n,g=g/4294967296*1e4&268435455,d[c++]=g>>>8&255,d[c++]=255&g,d[c++]=g>>>24&15|16,d[c++]=g>>>16&255,d[c++]=p>>>8|128,d[c++]=255&p;for(var f=0;f<6;++f)d[c+f]=u[f];return t||a(d)}},function(e,t,n){var i=n(9),o=n(10);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[r+s]=a[s];return t||o(a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appInitialization=void 0;var i=n(1),o=n(4),r=n(0);!function(e){e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.notifyAppLoaded=function(){(0,i.ensureInitialized)(),(0,r.sendMessageToParent)(e.Messages.AppLoaded,[o.version])},e.notifySuccess=function(){(0,i.ensureInitialized)(),(0,r.sendMessageToParent)(e.Messages.Success,[o.version])},e.notifyFailure=function(t){(0,i.ensureInitialized)(),(0,r.sendMessageToParent)(e.Messages.Failure,[t.reason,t.message])},e.notifyExpectedFailure=function(t){(0,i.ensureInitialized)(),(0,r.sendMessageToParent)(e.Messages.ExpectedFailure,[t.reason,t.message])}}(t.appInitialization||(t.appInitialization={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initializeWithFrameContext=t.setFrameContext=t.executeDeepLink=t.shareDeepLink=t.getMruTabInstances=t.getTabInstances=t.registerEnterSettingsHandler=t.registerFocusEnterHandler=t.registerBeforeUnloadHandler=t.registerOnLoadHandler=t.registerBackButtonHandler=t.registerAppButtonHoverLeaveHandler=t.registerAppButtonHoverEnterHandler=t.registerAppButtonClickHandler=t.registerFullScreenHandler=t.registerOnThemeChangeHandler=t.getContext=t.print=t.enablePrintCapability=t._uninitialize=t._initialize=t.initialize=void 0;var i=n(1),o=n(6),r=n(4),a=n(12),s=n(5),l=n(13),c=n(2),d=n(0),u=n(11),p=n(14),g=n(3);function h(e,t){o.GlobalVars.initializeCalled||(o.GlobalVars.initializeCalled=!0,g.initializeHandlers(),(0,d.initializeCommunication)((function(e,t,n){void 0===n&&(n=r.defaultSDKVersionForCompatCheck),o.GlobalVars.frameContext=e,o.GlobalVars.hostClientType=t,o.GlobalVars.clientSupportedSDKVersion=n,o.GlobalVars.initializeCallbacks.forEach((function(e){return e()})),o.GlobalVars.initializeCallbacks=[],o.GlobalVars.initializeCompleted=!0}),t),u.authentication.initialize(),a.settings.initialize(),(0,p.initializePrivateApis)()),Array.isArray(t)&&(0,i.processAdditionalValidOrigins)(t),e&&(o.GlobalVars.initializeCompleted?e():o.GlobalVars.initializeCallbacks.push(e))}function f(){window.print()}function m(e){(0,i.ensureInitialized)(),g.registerOnThemeChangeHandler(e)}function y(e){(0,i.ensureInitialized)(),g.registerHandler("fullScreenChange",e)}function v(e){(0,i.ensureInitialized)(),g.registerBackButtonHandler(e)}function _(e){(0,i.ensureInitialized)(),g.registerOnLoadHandler(e)}function b(e){(0,i.ensureInitialized)(),g.registerBeforeUnloadHandler(e)}function w(e){(0,i.ensureInitialized)(),g.registerFocusEnterHandler(e)}function C(e){(0,i.ensureInitialized)(c.FrameContexts.content),(0,d.sendMessageToParent)("setFrameContext",[e])}t.initialize=h,t._initialize=function(e){d.Communication.currentWindow=e},t._uninitialize=function(){o.GlobalVars.initializeCalled&&(o.GlobalVars.frameContext&&(m(null),y(null),v(null),b(null),w(null),_(null),l.logs.registerGetLogHandler(null)),o.GlobalVars.frameContext===c.FrameContexts.settings&&a.settings.registerOnSaveHandler(null),o.GlobalVars.frameContext===c.FrameContexts.remove&&a.settings.registerOnRemoveHandler(null),o.GlobalVars.initializeCalled=!1,o.GlobalVars.initializeCompleted=!1,o.GlobalVars.initializeCallbacks=[],o.GlobalVars.additionalValidOrigins=[],o.GlobalVars.frameContext=null,o.GlobalVars.hostClientType=null,(o.GlobalVars.isFramelessWindow=!1,d.uninitializeCommunication)())},t.enablePrintCapability=function(){o.GlobalVars.printCapabilityEnabled||(o.GlobalVars.printCapabilityEnabled=!0,(0,i.ensureInitialized)(),document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(f(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})))},t.print=f,t.getContext=function(e){(0,i.ensureInitialized)(),(0,d.sendMessageToParent)("getContext",(function(t){t.frameContext||(t.frameContext=o.GlobalVars.frameContext),e(t)}))},t.registerOnThemeChangeHandler=m,t.registerFullScreenHandler=y,t.registerAppButtonClickHandler=function(e){(0,i.ensureInitialized)(c.FrameContexts.content),g.registerHandler("appButtonClick",e)},t.registerAppButtonHoverEnterHandler=function(e){(0,i.ensureInitialized)(c.FrameContexts.content),g.registerHandler("appButtonHoverEnter",e)},t.registerAppButtonHoverLeaveHandler=function(e){(0,i.ensureInitialized)(c.FrameContexts.content),g.registerHandler("appButtonHoverLeave",e)},t.registerBackButtonHandler=v,t.registerOnLoadHandler=_,t.registerBeforeUnloadHandler=b,t.registerFocusEnterHandler=w,t.registerEnterSettingsHandler=function(e){(0,i.ensureInitialized)(c.FrameContexts.content),g.registerHandler("changeSettings",e)},t.getTabInstances=function(e,t){(0,i.ensureInitialized)(),(0,d.sendMessageToParent)("getTabInstances",[t],e)},t.getMruTabInstances=function(e,t){(0,i.ensureInitialized)(),(0,d.sendMessageToParent)("getMruTabInstances",[t],e)},t.shareDeepLink=function(e){(0,i.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.sidePanel,c.FrameContexts.meetingStage),(0,d.sendMessageToParent)("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},t.executeDeepLink=function(e,t){(0,i.ensureInitialized)(c.FrameContexts.content,c.FrameContexts.sidePanel,c.FrameContexts.settings,c.FrameContexts.task,c.FrameContexts.stage,c.FrameContexts.meetingStage),(0,d.sendMessageToParent)("executeDeepLink",[e],t||(0,s.getGenericOnCompleteHandler)())},t.setFrameContext=C,t.initializeWithFrameContext=function(e,t,n){h(t,n),C(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.navigateBack=t.navigateCrossDomain=t.navigateToTab=t.returnFocus=void 0;var i=n(1),o=n(5),r=n(2),a=n(0);t.returnFocus=function(e){(0,i.ensureInitialized)(r.FrameContexts.content),(0,a.sendMessageToParent)("returnFocus",[e])},t.navigateToTab=function(e,t){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("navigateToTab",[e],t||(0,o.getGenericOnCompleteHandler)("Invalid internalTabInstanceId and/or channelId were/was provided"))},t.navigateCrossDomain=function(e,t){(0,i.ensureInitialized)(r.FrameContexts.content,r.FrameContexts.sidePanel,r.FrameContexts.settings,r.FrameContexts.remove,r.FrameContexts.task,r.FrameContexts.stage,r.FrameContexts.meetingStage),(0,a.sendMessageToParent)("navigateCrossDomain",[e],t||(0,o.getGenericOnCompleteHandler)("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest."))},t.navigateBack=function(e){(0,i.ensureInitialized)(),(0,a.sendMessageToParent)("navigateBack",[],e||(0,o.getGenericOnCompleteHandler)("Back navigation is not supported in the current client or context."))}},function(e,t,n){"use strict";var i=this&&this.__rest||function(e,t){var n={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]]);return n};Object.defineProperty(t,"__esModule",{value:!0}),t.tasks=void 0;var o=n(2),r=n(16),a=n(0),s=n(1);!function(e){e.startTask=function(e,t){return(0,s.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.sidePanel,o.FrameContexts.meetingStage),(0,a.sendMessageToParent)("tasks.startTask",[e],t),new r.ChildAppWindow},e.updateTask=function(e){(0,s.ensureInitialized)(o.FrameContexts.task),e.width,e.height;var t=i(e,["width","height"]);if(Object.keys(t).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");(0,a.sendMessageToParent)("tasks.updateTask",[e])},e.submitTask=function(e,t){(0,s.ensureInitialized)(o.FrameContexts.task),(0,a.sendMessageToParent)("tasks.completeTask",[e,Array.isArray(t)?t:[t]])}}(t.tasks||(t.tasks={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.location=void 0;var i=n(7),o=n(1),r=n(2),a=n(0),s=n(4);!function(e){e.getLocation=function(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");(0,o.ensureInitialized)(r.FrameContexts.content,r.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.getLocation",[e],t):t({errorCode:i.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:i.ErrorCode.OLD_PLATFORM},void 0)},e.showLocation=function(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");(0,o.ensureInitialized)(r.FrameContexts.content,r.FrameContexts.task),(0,o.isAPISupportedByPlatform)(s.locationAPIsRequiredVersion)?e?(0,a.sendMessageToParent)("location.showLocation",[e],t):t({errorCode:i.ErrorCode.INVALID_ARGUMENTS},void 0):t({errorCode:i.ErrorCode.OLD_PLATFORM},void 0)}}(t.location||(t.location={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meeting=void 0;var i=n(0),o=n(3),r=n(1),a=n(2);!function(e){!function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,i.sendMessageToParent)("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,i.sendMessageToParent)("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage,a.FrameContexts.settings,a.FrameContexts.content),(0,i.sendMessageToParent)("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel,a.FrameContexts.meetingStage),(0,i.sendMessageToParent)("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,o.registerHandler)("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");(0,r.ensureInitialized)(a.FrameContexts.sidePanel),(0,i.sendMessageToParent)("meeting.getAppContentStageSharingState",e)}}(t.meeting||(t.meeting={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.monetization=void 0;var i=n(0),o=n(1),r=n(2);(t.monetization||(t.monetization={})).openPurchaseExperience=function(e,t){if(!e)throw new Error("[open purchase experience] Callback cannot be null");(0,o.ensureInitialized)(r.FrameContexts.content),(0,i.sendMessageToParent)("monetization.openPurchaseExperience",[t],e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.people=void 0;var i=n(1),o=n(2),r=n(7),a=n(18),s=n(0),l=n(4);(t.people||(t.people={})).selectPeople=function(e,t){if(!e)throw new Error("[people picker] Callback cannot be null");(0,i.ensureInitialized)(o.FrameContexts.content,o.FrameContexts.task,o.FrameContexts.settings),(0,i.isAPISupportedByPlatform)(l.peoplePickerRequiredVersion)?(0,a.validatePeoplePickerInput)(t)?(0,s.sendMessageToParent)("people.selectPeople",[t],e):e({errorCode:r.ErrorCode.INVALID_ARGUMENTS},null):e({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.video=void 0;var i=n(0),o=n(1),r=n(2),a=n(3);!function(e){function t(){(0,i.sendMessageToParent)("video.videoFrameProcessed")}function n(e){(0,i.sendMessageToParent)("video.notifyError",[e])}!function(e){e[e.NV12=0]="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e[e.EffectChanged=0]="EffectChanged",e[e.EffectDisabled=1]="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(e,s){(0,o.ensureInitialized)(r.FrameContexts.sidePanel),(0,a.registerHandler)("video.newVideoFrame",(function(i){void 0!==i&&e(i,t,n)})),(0,i.sendMessageToParent)("video.registerForVideoFrame",[s])},e.notifySelectedVideoEffectChanged=function(e,t){(0,o.ensureInitialized)(r.FrameContexts.sidePanel),(0,i.sendMessageToParent)("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){(0,o.ensureInitialized)(r.FrameContexts.sidePanel),(0,a.registerHandler)("video.effectParameterChange",e)}}(t.video||(t.video={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharing=void 0;var i=n(1),o=n(0),r=n(7),a=n(2);!function(e){e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(t,n){(function(e,t){if(e&&e.content&&e.content.length)return 1;t&&t({errorCode:r.ErrorCode.INVALID_ARGUMENTS,message:"Shared content is missing"})})(t,n)&&function(e,t){if(e.content.some((function(e){return!e.type})))t&&t({errorCode:r.ErrorCode.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"});else{if(!e.content.some((function(t){return t.type!==e.content[0].type})))return 1;t&&t({errorCode:r.ErrorCode.INVALID_ARGUMENTS,message:"Shared content must be of the same type"})}}(t,n)&&function(e,t){if("URL"===e.content[0].type){if(!e.content.some((function(e){return!e.url})))return 1;t&&t({errorCode:r.ErrorCode.INVALID_ARGUMENTS,message:"URLs are required for URL content types"})}else t&&t({errorCode:r.ErrorCode.INVALID_ARGUMENTS,message:"Content type is unsupported"})}(t,n)&&((0,i.ensureInitialized)(a.FrameContexts.content,a.FrameContexts.sidePanel,a.FrameContexts.task,a.FrameContexts.stage,a.FrameContexts.meetingStage),(0,o.sendMessageToParent)(e.SharingAPIMessages.shareWebContent,[t],n))}}(t.sharing||(t.sharing={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserSettingTypes=t.ViewerActionTypes=t.NotificationTypes=void 0,function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(t.NotificationTypes||(t.NotificationTypes={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(t.ViewerActionTypes||(t.ViewerActionTypes={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(t.UserSettingTypes||(t.UserSettingTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conversations=void 0;var i=n(1),o=n(2),r=n(0),a=n(3);!function(e){e.openConversation=function(e){(0,i.ensureInitialized)(o.FrameContexts.content),(0,r.sendMessageToParent)("conversations.openConversation",[{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId}],(function(e,t){if(!e)throw new Error(t)})),e.onStartConversation&&(0,a.registerHandler)("startConversation",(function(t,n,i,o){return e.onStartConversation({subEntityId:t,conversationId:n,channelId:i,entityId:o})})),e.onCloseConversation&&(0,a.registerHandler)("closeConversation",(function(t,n,i,o){return e.onCloseConversation({subEntityId:t,conversationId:n,channelId:i,entityId:o})}))},e.closeConversation=function(){(0,i.ensureInitialized)(o.FrameContexts.content),(0,r.sendMessageToParent)("conversations.closeConversation"),(0,a.removeHandler)("startConversation"),(0,a.removeHandler)("closeConversation")}}(t.conversations||(t.conversations={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meetingRoom=void 0;var i=n(1),o=n(0),r=n(3);!function(e){!function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.toggleCaptions="toggleCaptions",e.volume="volume",e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.leaveMeeting="leaveMeeting"}(e.Capability||(e.Capability={})),e.getPairedMeetingRoomInfo=function(e){(0,i.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.getPairedMeetingRoomInfo",e)},e.sendCommandToPairedMeetingRoom=function(e,t){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(!t)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Callback cannot be null");(0,i.ensureInitialized)(),(0,o.sendMessageToParent)("meetingRoom.sendCommandToPairedMeetingRoom",[e],t)},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");(0,i.ensureInitialized)(),(0,r.registerHandler)("meetingRoom.meetingRoomCapabilitiesUpdate",(function(t){(0,i.ensureInitialized)(),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");(0,i.ensureInitialized)(),(0,r.registerHandler)("meetingRoom.meetingRoomStatesUpdate",(function(t){(0,i.ensureInitialized)(),e(t)}))}}(t.meetingRoom||(t.meetingRoom={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remoteCamera=void 0;var i=n(1),o=n(2),r=n(0),a=n(3);!function(e){!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,r.sendMessageToParent)("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,r.sendMessageToParent)("remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,r.sendMessageToParent)("remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,r.sendMessageToParent)("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");(0,i.ensureInitialized)(o.FrameContexts.sidePanel),(0,a.registerHandler)("remoteCamera.sessionStatusChange",e)}}(t.remoteCamera||(t.remoteCamera={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.files=void 0;var i=n(0),o=n(1),r=n(8);!function(e){!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),e.getCloudStorageFolders=function(e,t){if((0,o.ensureInitialized)(r.FrameContexts.content),!e||0==e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");(0,i.sendMessageToParent)("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if((0,o.ensureInitialized)(r.FrameContexts.content),!e||0==e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");(0,i.sendMessageToParent)("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if((0,o.ensureInitialized)(r.FrameContexts.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");(0,i.sendMessageToParent)("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if((0,o.ensureInitialized)(r.FrameContexts.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");(0,i.sendMessageToParent)("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if((0,o.ensureInitialized)(r.FrameContexts.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");(0,i.sendMessageToParent)("files.openCloudStorageFile",[e,t,n])}}(t.files||(t.files={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appEntity=void 0;var i=n(0),o=n(1),r=n(8);(t.appEntity||(t.appEntity={})).selectAppEntity=function(e,t,n,a){if((0,o.ensureInitialized)(r.FrameContexts.content),!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!a)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");(0,i.sendMessageToParent)("appEntity.selectAppEntity",[e,t,n],a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.teams=void 0;var i=n(0),o=n(1),r=n(8);!function(e){!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if((0,o.ensureInitialized)(r.FrameContexts.content),!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");(0,i.sendMessageToParent)("teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if((0,o.ensureInitialized)(),!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");(0,i.sendMessageToParent)("teams.refreshSiteUrl",[e],t)}}(t.teams||(t.teams={}))}])},function(e,t,n){"use strict";function i(e,t){this._low=parseInt(e,10),this._hight=parseInt(t,10)}n(45),i.Permissions={ViewListItems:1,AddListItems:2,EditListItems:3,DeleteListItems:4,ApproveItems:5,OpenItems:6,ViewVersions:7,DeleteVersions:8,CancelCheckout:9,ManagePersonalViews:10,ManageLists:12,ViewFormPages:13,AnonymousSearchAccessList:14,Open:17,ViewPages:18,AddAndCustomizePages:19,ApplyThemeAndBorder:20,ApplyStyleSheets:21,ViewUsageData:22,CreateSSCSite:23,ManageSubwebs:24,CreateGroups:25,ManagePermissions:26,BrowseDirectories:27,BrowseUserInfo:28,AddDelPrivateWebParts:29,UpdatePersonalWebParts:30,ManageWeb:31,AnonymousSearchAccessWebLists:32,UseClientIntegration:37,UseRemoteAPIs:38,ManageAlerts:39,CreateAlerts:40,EditMyUserInfo:41,EnumeratePermissions:63},i.prototype.hasPermission=function(e){var t=this._low;return e>=32&&(t=this._high,e-=32),2^e-1|t==t},e.exports=i},function(e,t,n){"use strict";n(9);const i=n(1006).saveAs;function o(){}o.prototype.download=async function(){let{buffer:e,name:t,extension:n,mime:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(new Blob([e],o),"".concat(t,".").concat(n))},e.exports=o},function(e,t,n){"use strict";var i=n(17);n(14),n(115),n(9),n(28),n(19),n(24),n(111),n(90),n(171),n(25),n(163),n(29);var o=n(12),r=n(198),a=n(43),s=n(1),l=n(16),c=n(32),d=n(56),u=i(n(1362)),p=i(n(396)),g=i(n(1363)),h=i(n(1364)),f=i(n(1365));const{nodeEnv:m,isBeta:y,storeVendor:v,isCorel:_,isTeams:b}=n(716),w=!v,C=n(767);n(1366);n(1367);var E=n(1368),S=n(144),G=n(775),A=n(778),T=n(1062),P=n(1194),L=n(722),D=n(1466),x=n(723),I=n(1203),O=n(550),k=n(1193),F=n(784),R=n(1063),M=n(1199),N=n(1214),B=n(1215),U=n(1217),K=n(1064),j=n(776),H=n(1198),V=n(1195),z=n(770),W=n(402),q=n(1467),Y=n(510),X=n(724),Q=n(1468),Z=n(1059),J=n(1065),ee=n(1055),te=n(779),ne=n(1469),ie=n(1470),oe=n(1179),re=n(1200),ae=n(1165),se=n(1071),le=n(1180),ce=n(1471),de=n(787),ue=n(1069);const pe=n(786);var ge=n(1070),he=n(1068),fe=n(785),me=n(1473),ye=n(1474),ve=n(1475),_e=n(1223),be=n(725),we=n(1476),Ce=n(1477),Ee=n(1478),Se=n(1167),Ge=n(1480),Ae=n(400),Te=n(1481),Pe=n(398),Le=n(1216),De=n(1066);const xe=n(1187),Ie=n(1188),Oe=n(1189),ke=n(1190),Fe=n(1191),Re=n(1192);var Me=n(1482),Ne=n(1168),Be=n(1056),$e=n(1169),Ue=n(1483),Ke=n(1484),je=n(1201),He=n(1178),Ve=n(780),ze=n(1202),We=n(783),qe=n(1170),Ye=n(1171),Xe=n(1172),Qe=n(1166),Ze=n(1164),Je=n(781),et=n(1058),tt=n(782),nt=n(1485),it=n(1197),ot=n(1173),rt=n(1174),at=n(1486),st=n(1488),lt=n(1218),ct=n(401),dt=n(1140),ut=n(1489),pt=n(1490),gt=n(1219),ht=n(1492),ft=n(751),mt=n(1067),yt=n(1493),vt=n(1225),_t=n(1181),bt=n(1494),wt=n(1495),Ct=n(1497),Et=n(1176),St=n(1498),Gt=n(1499),At=n(1500),Tt=n(1501),Pt=n(1503),Lt=n(1504),Dt=n(1046),xt=n(1505),It=n(1506),Ot=n(1507),kt=n(1508);const Ft=n(1509);var Rt=n(1138),Mt=n(1510),Nt=n(1512);n(1513);const Bt=n(1514),$t=n(1516),Ut=n(1517),Kt=n(1518),jt=n(1227),Ht=n(1519),Vt=n(1520),zt=n(1521),Wt=n(1224),qt=n(1522),Yt=n(1523),Xt=n(1524);n(78),n(77);var Qt=n(1228),Zt=(n(1229),n(1048)),Jt=n(1145),en=n(1050),tn=n(1148),nn=n(1146),on=n(1149),rn=n(1150),an=n(1525),sn=n(1526),ln=n(1527),cn=n(773),dn=n(1144),un=n(511),pn=n(1153),gn=n(1039),hn=n(1528),fn=n(1154),mn=n(1155),yn=n(1222),vn=n(1529),_n=n(1530),bn=n(1156),wn=n(1157),Cn=n(1177),En=n(1531),Sn=n(1158),Gn=n(1532),An=n(1533),Tn=n(1536),Pn=n(1537),Ln=n(1539),Dn=n(1540),xn=n(1541),In=n(76),On=n(1543),kn=(n(216),n(1544)),Fn=n(106),Rn=n(1545),Mn=n(36),Nn=n(769),Bn=n(1546),$n=n(306),Un=n(1208),Kn=n(698),jn=n(1547),Hn=n(721),Vn=n(264);const zn=o.FILE_FORMATS.find(e=>e.default).ext,Wn=o.FILE_FORMATS.filter(e=>e.secondary).map(e=>e.ext);var qn=n(1549);const Yn=new(n(1226));Yn.init();const Xn=n(1555),Qn=n(1557),Zn=n(1558),Jn=n(1139),{isExecutingOnMSTeams:ei,isExecutingOnMSTeamsSync:ti,isTeamsChannel:ni,getTeamsLocale:ii}=p.default;n(18),n(1559),n(768),n(1560),n(1561),n(1562),n(1564),n(1565);var oi=window;const ri=!!/^trunk/.test("production")&&!y;oi.gApi=n(12).gApi,oi.gApi.webcdr=null;let ai=0,si=!1,li=null;const ci=async()=>{if(navigator.onLine){if(!(Date.now()-ai>6e4))return li;try{ai=Date.now(),li=o.gApi.getAppStatus("".concat(_?"corel":"gravit","-cloud").concat(ri?"-trunk":"")).then(e=>{let{maintenance:t}=e;return t}).catch(()=>!1),si=await li}finally{ai=Date.now()}}return Promise.resolve(si)};ci(),ri&&(oi.gApi.url=o.cloudTrunkURL,oi.gApi.managementUrl="https://cloud-management-trunk.herokuapp.com",o.trunkWebsocketURL&&(oi.gApi.websocketURL=o.trunkWebsocketURL),s.GTranslationEvents.addEventListener(s.GTranslationNotificationEvent,e=>{let{project:t,type:n,content:i,data:o}=e;if(t===s.GTranslation.Projects.Designer)switch(n){case s.GTranslationNotificationEvent.Type.Warning:gContainer.getRuntime()===In.Runtime.Electron?console.error(i):console.error({content:i,data:o})}},void 0)),y&&(_&&b&&o.cloudTeamsURL?oi.gApi.url=o.cloudTeamsURL:o.cloudBetaURL&&(oi.gApi.url=o.cloudBetaURL),o.betaWebsocketURL&&(oi.gApi.websocketURL=o.betaWebsocketURL)),oi.gApi.lang=s.GLocale.getLanguage();let di=null;oi.gravit=null,n(1607),oi.gDesigner=new E,oi.gDesigner.getUser(),oi.gQA=h.default;const ui=oi.gDesigner.isOfflineAsync();oi.gInAppPurchase=qn.newInAppPurchase(v);const{GA:{customDimensions:pi}={}}=n(12);gDesigner.addEventListener(Vn,e=>{let{user:t}=e;t&&!gDesigner.isAnonymous()&&"undefined"!=typeof dataLayer&&pi&&pi.forEach(e=>dataLayer.push({[e]:void 0}))}),gDesigner._translationManager=Yn;var gi=$("<div></div>").addClass("g-drag-image").appendTo($("body"));oi.gDragImage=function(){return gi.empty().attr({class:"g-drag-image",style:""})},oi.gPatternChooser=null,oi.gPatternChooserNormal=null,oi.gPatternChooserTouch=null,oi.gContainer=null;e.exports=async function(e){oi.gContainer=e,(0,c._tryAndCatch)(()=>$n.start());let t=null;const n=gDesigner.getUser();n.then(e=>{e&&(t=o.gApi.isEnabledSubscriptions())}),window.onerror=function(e,t,n,i,o){Rn.isPluginError(o)?Mn.alert(o.message):("production"===m||"trunk"===m||"lts"===m||"rc"===m)&&Fn.isOnline()},C.getRuntimeCode()===o.Runtime.WindowsStore.code&&(new Xn).init(),y&&!_&&(new Qn).init(),_?(gContainer.setCookie({name:"_access_token",value:"b03f5f7f11d50a3a"}),gDesigner.setSupportedBrowsers([l.GPlatform.constructor.WebBrowser.Chrome,l.GPlatform.constructor.WebBrowser.Firefox,l.GPlatform.constructor.WebBrowser.Edge]),gDesigner.setSupportedTabletBrowsers([{operatingSystem:s.GSystem.OperatingSystem.Unix,platform:l.GPlatform.constructor.WebBrowser.Chrome},{operatingSystem:s.GSystem.OperatingSystem.OSX_IOS,platform:l.GPlatform.constructor.WebBrowser.Safari}])):(gDesigner.setSupportedBrowsers([l.GPlatform.constructor.WebBrowser.Chrome,l.GPlatform.constructor.WebBrowser.Firefox,l.GPlatform.constructor.WebBrowser.Edge]),gDesigner.setSupportedTabletBrowsers([{operatingSystem:s.GSystem.OperatingSystem.Unix,platform:l.GPlatform.constructor.WebBrowser.Chrome},{operatingSystem:s.GSystem.OperatingSystem.OSX_IOS,platform:l.GPlatform.constructor.WebBrowser.Safari}]));if(await ci()){if(gContainer.getRuntime()!==In.Runtime.Electron||!await n){$("<iframe></iframe>").addClass("cross-frame").attr("src","assets/static/maintenance/index.html").appendTo($("body"));const e=setInterval(async()=>{await ci()||(clearInterval(e),location.reload())},6e4);return}}const i=C.getRuntimeCode();i&&gContainer.setCookie({name:"_ginst",value:i,url:o.gApi.url});const p=new URL(window.location.href).searchParams;if(p&&p.has("pd")&&gContainer.setCookie({name:"_gtpd",value:p.get("pd")}),p&&p.has("newuser")&&gDesigner.setShowCreateAccount(!0),p&&p.has("dt")?gContainer.setCookie({name:"_gdt",value:p.get("dt")}):gContainer.setCookie({name:"_gdt",value:""}),p&&p.has("coupon")?gContainer.setCookie({name:"_gcoupon",value:p.get("coupon")}):gContainer.setCookie({name:"_gcoupon",value:""}),p&&p.has("recaptchaToken")&&gContainer.setCookie({name:"__grecaptchaToken",value:p.get("recaptchaToken")}),p&&p.has("magiclink")&&(await gContainer.signWithMagicLink(p.get("magiclink"),p.get("d"),p.get("token")).catch(()=>null),t=o.gApi.isEnabledSubscriptions()),p){gDesigner.setUTM(new Map(Array.from(p.entries()).filter(e=>{let[t]=e;return/^utm/.test(t)})));const e=["firstName","lastName","email","to"],t=Array.from(p.entries()).filter(t=>{let[n]=t;return e.includes(n)}).reduce((e,t)=>{let[n,i]=t;return Object.assign(e,{[n]:i})},{});Object.keys(t).length&&gDesigner.setSignupOptions(t)}var h,b,E,Vn;gContainer.setCookie({name:"_gdesignerv",value:"3.5.71",url:o.gApi.url}),gDesigner.setEnv(m),gContainer.getRuntime()===In.Runtime.Electron||_||o.gApi.initRecaptcha(),async function(e,t){const n=await gDesigner.getUser();(0,g.default)(e,t,gDesigner.getAppBaseUrl(),n)}(gContainer.getRuntime(),v),!y||gContainer.getRuntime()!==In.Runtime.Browser&&gContainer.getRuntime()!==In.Runtime.PWA||(h=window,b=document,h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)},h._hjSettings={hjid:754178,hjsv:6},E=b.getElementsByTagName("head")[0],(Vn=b.createElement("script")).async=1,Vn.src="https://static.hotjar.com/c/hotjar-"+h._hjSettings.hjid+".js?sv="+h._hjSettings.hjsv,E.appendChild(Vn)),gDesigner.setStoreVendor(v),gDesigner.setVersion("3.5.71"),gDesigner.setCommitSHA("824b4e4b7f2e5126d4e73a52cecfe04e9940899e"),gDesigner.setBuildNum("7135"),gDesigner.setVersionFriendlyName("2021.i13");let qn,ii=(0,c._tryAndCatch)(()=>gDesigner.preInit(t)),ai=gContainer.handleDeepLinking();ai&&(qn=await gDesigner.runDeepLink(ai.link,ai.options).then(()=>null).catch(e=>e));const si=async()=>{await new Promise(e=>gContainer.initLanguage(e)),gDesigner.hasEventListeners(Hn)&&gDesigner.trigger(new Hn(Hn.Status.Init)),gDesigner.setIsBeta(y),gravit={plugins:[],actions:[new ne,new ht,new ie,new be,new we].concat([new ct(ct.Actions.Open),new ft,new Ae,new Pe(zn),...Wn.map(e=>new Pe(e)),new ct(ct.Actions.SaveAs),new Et,new St,new Vt,new dt,new Rt]).concat([new Te]).concat([new Qe,new Ft(Ft.Source.PHOTOS),new Ft(Ft.Source.FILES),new Ze,new Ct(new Ce),_?new Ct(new z):new z]).concat(S.FileTypes.filter(e=>e.store&&"cdrapp"!==e.ext&&"des"!==e.ext&&"gvdesign"!==e.ext&&"pdf"!==e.ext).map(e=>new Pe(e.ext))).concat([new Pe("pdf",{dpi:72}),new Pe("pdf",{dpi:96}),new Pe("pdf",{dpi:150}),new Ct(new Pe("pdf",{dpi:300})),_?new Ct(new z({format:"pdf"})):new z({format:"pdf"})]).concat([new At,new Tt,new Gt,new Ee,new Z,new Pt,new et,new Se,new N(!0),new N(!1),new de,new ue,new pe,new ge,new he,new fe,new B,new H,new V,new Le,new U,new Q,new De,new xe(xe.Type.Fill),new xe(xe.Type.Border),new xe(xe.Type.FillAndBorder),new Ie,new Oe,new ke,new Fe,new Re,new Me,new $t($t.Type.Fill),new $t($t.Type.Border),new _e,new Kt,new A(a.GEditor.ArrangeOrderType.SendToFront),new A(a.GEditor.ArrangeOrderType.BringForward),new A(a.GEditor.ArrangeOrderType.SendBackward),new A(a.GEditor.ArrangeOrderType.SendToBack),new G(a.GEditor.ArrangeAlignType.AlignLeft),new G(a.GEditor.ArrangeAlignType.AlignCenter),new G(a.GEditor.ArrangeAlignType.AlignRight),new G(a.GEditor.ArrangeAlignType.AlignTop),new G(a.GEditor.ArrangeAlignType.AlignMiddle),new G(a.GEditor.ArrangeAlignType.AlignBottom),new G(a.GEditor.ArrangeAlignType.AlignJustifyHorizontal),new G(a.GEditor.ArrangeAlignType.AlignJustifyVertical),new j(j.Type.Horizontal),new j(j.Type.Vertical),new He(He.Type.FullUnit),new He(He.Type.HalfUnit),new Je(Je.Type.Rotate45Left),new Je(Je.Type.Rotate90Left),new Je(Je.Type.Rotate180Left),new Je(Je.Type.Rotate45Right),new Je(Je.Type.Rotate90Right),new Je(Je.Type.Rotate180Right),new Je(Je.Type.FlipVertical),new Je(Je.Type.FlipHorizontal),new X,new te,new L,new Ve,new mt,new k,new P,new te(s.GVertexPolyBoolean.OR),new te(s.GVertexPolyBoolean.SUB),new te(s.GVertexPolyBoolean.AND),new te(s.GVertexPolyBoolean.XOR),new M,new J,new We,new x,new I,new se,new re,new tt,new nt,new T,new K,new je,new D,new ze,new Ge,new O,new F,new R,new it,new ye,new Ht(Ht.Type.General),new Ht(Ht.Type.Straight),new Ht(Ht.Type.Mirrored),new Ht(Ht.Type.Disconnected),new Ht(Ht.Type.Asymmetric),new Ht(Ht.Type.Connector),new Yt,new Xt,new ae,new Y,new q,new W,new me(!1),new me(!0),new ve,new jt(jt.Type.Next),new jt(jt.Type.Previous),new zt,new Wt(Wt.Type.Next),new Wt(Wt.Type.Previous),new qt(qt.Type.Next),new qt(qt.Type.Previous)].concat(ee.ZOOM_LEVELS.map(e=>new ee(e)))).concat([new ot,new rt,new le,new ce,new Ue,new Be,new $e,new Ne,new Ke,new st,new Ut,new Ye,...o.HAS_SNAPZONES?[new Xe]:[],new qe(a.GGridGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-grid"))),new qe(a.GGuideLinesGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-guide-lines"))),new qe(a.GFullPixelsGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-full-pixels"))),new qe(a.GPointsGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-anchor-points"))),new qe(a.GBBoxGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-shapes"))),new qe(a.GPageGuide.ID,s.GLocale.get(new s.GLocaleKey("GCommonNames","text.snap-to-pages"))),new oe,new at,new lt,new Ct(new xt)]).concat(pt.Links.filter(e=>"eula"!==e.name).map(e=>new pt(e)),_?[]:new vt,new Lt,new gt).concat(...ti()?[]:In.GravitLanguages.map(e=>new ut(e,Yn.getTranslationRealName(e)))).concat([..._?[new Nt("STAGING",ri),new Nt("BETA",y)]:[],new yt,...w?[new bt]:[],...pt.Links.filter(e=>"eula"===e.name).map(e=>new pt(e)),new _t,new wt,new Dt,new Mt,..._?[new kt]:[],new Bt]).concat([new It,new Ot]),sidebars:[new cn,...o.HAS_ANNOTATIONS?[new un]:[],new dn,new An,new Gn],panels:[],footer:[new Tn,new Pn,..._?[new Ln,new Dn]:[]],tools:[{tool:a.GPointerTool,toolString:"GPointerTool",title:_?s.GLocale.get(new s.GLocaleKey("GCommonNames","tool.pointer")):s.GLocale.get(new s.GLocaleKey("GPointerTool","name")),group:"select",key:"V",icon:"gravit-icon-cursor-filled",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GPointerTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GPointerTool","tooltip-description")),middle:!1,shortcut:["V"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Pointer_Tool.mp4",learnMore:"https://documentation.designer.io/tools/selection-tools/#pointer-tool"})},{tool:a.GSubSelectTool,toolString:"GSubSelectTool",title:s.GLocale.get(new s.GLocaleKey("GSubSelectTool","name")),group:"select",key:"D",icon:_?"gravit-icon-cursor-subselect":"gravit-icon-cursor",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GSubSelectTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GSubSelectTool","tooltip-description")),middle:!1,shortcut:["D"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Subselect_Tool.mp4",learnMore:"https://documentation.designer.io/tools/selection-tools/#subselect-tool"})},{tool:a.GLassoTool,toolString:"GLassoTool",title:s.GLocale.get(new s.GLocaleKey("GLassoTool","name")),group:"select",category:"special",key:"O",icon:"gravit-icon-rope",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GLassoTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GLassoTool","tooltip-description")),middle:!1,shortcut:["O"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Lasso_Tool.mp4",learnMore:"https://documentation.designer.io/tools/selection-tools/#lasso-tool"})},{tool:a.GLayerTool,toolString:"GLayerTool",title:s.GLocale.get(new s.GLocaleKey("GLayerTool","name")),group:"select",category:"special",icon:"gravit-icon-sheets",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GLayerTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GLayerTool","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/tools/selection-tools/#layer-tool"})},{tool:a.GSliceTool,toolString:"GSliceTool",title:s.GLocale.get(new s.GLocaleKey("GSliceTool","name")),group:"select",category:"other",key:"S",icon:"gravit-icon-slice",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GSliceTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GSliceTool","tooltip-description")),middle:!1,shortcut:["S"],learnMore:"https://documentation.designer.io/tools/selection-tools/#slice-tool"})},{tool:a.GPenTool,toolString:"GPenTool",title:s.GLocale.get(new s.GLocaleKey("GPenTool","name")),group:"path",key:"P",icon:"gravit-icon-pen",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GPenTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GPenTool","tooltip-description")),middle:!1,shortcut:["P"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Pen_Too.mp4",learnMore:"https://documentation.designer.io/tools/drawing-tools/#pen-tool"})},{tool:a.GBezigonTool,toolString:"GBezigonTool",title:s.GLocale.get(new s.GLocaleKey("GBezigonTool","name")),group:"path",key:"B",icon:"gravit-icon-pen-filled",pro:!0,feature:"bezigon",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GBezigonTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GBezigonTool","tooltip-description")),middle:!1,shortcut:["B"],isPro:gDesigner.isProTooltipNeeded("bezigon"),video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Bezigon_Tool.mp4",learnMore:"https://documentation.designer.io/tools/drawing-tools/#bezigon-tool"})},{tool:a.GKnifeTool,toolString:"GKnifeTool",title:s.GLocale.get(new s.GLocaleKey("GKnifeTool","name")),group:"knife",category:"modify",key:"K",icon:"gravit-icon-scalpel",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GKnifeTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GKnifeTool","tooltip-description")),middle:!1,shortcut:["K"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Knife_Tool.mp4",learnMore:"https://documentation.designer.io/tools/other-tools/#knife-tool"})},{tool:a.GFreehandTool,toolString:"GFreehandTool",title:s.GLocale.get(new s.GLocaleKey("GFreehandTool","name")),group:"path",category:"hand",icon:"gravit-icon-free-hand-draw",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GFreehandTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GFreehandTool","tooltip-description")),middle:!1,video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Freehand_Tool.mp4",learnMore:"https://documentation.designer.io/tools/drawing-tools/#freehand-tool"})},{tool:a.GMagicTool,toolString:"GMagicTool",title:s.GLocale.get(new s.GLocaleKey("GMagicTool","name")),group:"knife",category:"modify",icon:"gravit-icon-freehand-shape",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GMagicTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GMagicTool","tooltip-description")),middle:!1,video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Freehand_Shaping_Tool.mp4",learnMore:"https://documentation.designer.io/tools/other-tools/#freehand-shaping-tool"})},{tool:a.GLineTool,toolString:"GLineTool",title:s.GLocale.get(_?new s.GLocaleKey("GCommonNames","tool.line"):new s.GLocaleKey("GLineTool","name")),group:"shape",key:"L",icon:"gravit-icon-line",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GLineTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GLineTool","tooltip-description")),middle:!1,shortcut:["L"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Line_Tool.mp4",learnMore:"https://documentation.designer.io/basics/shapes-paths/#line"})},{tool:a.GRectangleTool,toolString:"GRectangleTool",title:s.GLocale.get(new s.GLocaleKey("GRectangleTool","name")),group:"shape",key:"R",shortcuts:[["M"]],icon:"gravit-icon-rectangle",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GRectangleTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GRectangleTool","tooltip-description")),middle:!1,shortcut:["R"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Rectangle_Tool.mp4",learnMore:"https://documentation.designer.io/basics/shapes-paths/#rectangle-r"})},{tool:a.GEllipseTool,toolString:"GEllipseTool",title:s.GLocale.get(new s.GLocaleKey("GEllipseTool","name")),group:"shape",key:"E",icon:"gravit-icon-ellipse",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GEllipseTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GEllipseTool","tooltip-description")),middle:!1,shortcut:["E"],video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Ellipse_Tool.mp4",learnMore:"https://documentation.designer.io/basics/shapes-paths/#ellipse-e"})},{tool:a.GPolygonTool,toolString:"GPolygonTool",title:s.GLocale.get(new s.GLocaleKey("GPolygonTool","name")),group:"shape",category:"polygon",icon:"gravit-icon-polygon",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GPolygonTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GPolygonTool","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/shapes-paths/#polygon"})},{tool:a.GTriangleTool,toolString:"GTriangleTool",title:s.GLocale.get(new s.GLocaleKey("GTriangleTool","name")),group:"shape",category:"polygon",icon:"gravit-icon-triangle",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GTriangleTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GTriangleTool","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/shapes-paths/#triangle-star"})},{tool:a.GStarTool,toolString:"GStarTool",title:s.GLocale.get(new s.GLocaleKey("GStarTool","name")),group:"shape",category:"polygon",icon:"gravit-icon-star",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GStarTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GStarTool","tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/shapes-paths/#triangle-star"})},{tool:a.GTextTool,toolString:"GTextTool",title:s.GLocale.get(new s.GLocaleKey("GTextTool","name")),group:"insert",key:"T",icon:"gravit-icon-textbox",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GTextTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GTextTool","tooltip-description")),middle:!1,video:"https://d2lcdgwsultzrn.cloudfront.net/videos/Text_Tool.mp4",shortcut:["T"],learnMore:"https://documentation.designer.io/working-with-text/"})},{tool:a.GHandTool,toolString:"GHandTool",title:s.GLocale.get(new s.GLocaleKey("GHandTool","name")),group:"view",key:"H",icon:"gravit-icon-move",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GHandTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GHandTool","tooltip-description")),middle:!1,shortcut:["H"],learnMore:"https://documentation.designer.io/tools/other-tools/#pan"})},{tool:a.GZoomTool,toolString:"GZoomTool",title:s.GLocale.get(new s.GLocaleKey("GZoomTool","name")),group:"view",key:"Z",icon:"gravit-icon-zoom-in",richTooltipConfig:d.GRichTooltipConfig.from({title:s.GLocale.get(new s.GLocaleKey("GZoomTool","tooltip-title")),description:s.GLocale.get(new s.GLocaleKey("GZoomTool","tooltip-description")),middle:!1,shortcut:["Z"],learnMore:"https://documentation.designer.io/tools/other-tools/#zoom-tool"})}],properties:[new Cn,new Sn,new En,new yn,new _n,new sn,new an,new ln,new fn,new pn,new on,new wn,new rn,new mn,new bn,new tn,new vn,new Zt,new Jt,new en,new nn]},"function"!=typeof window.gdb_initsavestepsaction||y||r.IS_RC||window.gdb_initsavestepsaction(window.gravit.actions,Ae),"function"==typeof window.gdb_initsetupsystemdateaction&&window.gdb_initsetupsystemdateaction(window.gravit.actions),"function"!=typeof window.gdb_inittranslationtoolaction||y||r.IS_RC||window.gdb_inittranslationtoolaction(window.gravit.actions,Ae),"function"!=typeof window.gdb_initrecordgravitaction||y||r.IS_RC||window.gdb_initrecordgravitaction(window.gravit.actions,Ae);let t=new xn(e._storage);t.load(),t.init(gravit),oi.gPatternChooserNormal=new gn,oi.gPatternChooserTouch=new hn,gDesigner.isTouchEnabled()?oi.gPatternChooser=oi.gPatternChooserTouch:oi.gPatternChooser=oi.gPatternChooserNormal,gDesigner.init(),gDesigner.relayout(),await gDesigner.start().finally(()=>{gDesigner.isTouchDevice()&&!gDesigner.isTouchEnabled()&&o.TOUCH_LAYOUT&&(gDesigner.stats("touch-dialog_open"),Mn.confirm("".concat(s.GLocale.get(new s.GLocaleKey("GSystemDialog","text.supported-touch-title")),"<br>\n                         ").concat(s.GLocale.get(new s.GLocaleKey("GSystemDialog","text.supported-touch-footer"))),e=>{gDesigner.stats("touch-dialog_click_".concat(e?"ok":"cancel")),e&&gDesigner.executeAction(xt.ID,void 0,void 0,!0)},s.GLocale.get(new s.GLocaleKey("GLocale","cancel")),{text:s.GLocale.get(new s.GLocaleKey("GLocale","ok")),pro:!0},!1,!1,!1,"designer.settings.dont_show_supported_touch_dialog"))}),"undefined"!=typeof dataLayer&&dataLayer.push({runtime1:gContainer.getRuntime()});var n=e.start();gContainer.getRuntime()===In.Runtime.Electron&&gDesigner.getUser().then(e=>{e||ui.then(e=>{e||Fn.performLogin()})}),gDesigner.updateRecentDocumentsAction(),kn.init();let i=gDesigner.getSetting("webcdr_choice",y?"BETA":"STAGING");if(ri?o.trunkwebcdr&&(r.IS_LOCALHOST?oi.gApi.webcdr=i&&"BETA"===i?o.cloudBetaURL+"/api/webcdr":o.cloudTrunkURL+"/api/webcdr":oi.gApi.webcdr=i&&"BETA"===i?o.betaWebcdr:o.trunkwebcdr):y?oi.gApi.webcdr=i&&"BETA"===i?o.betaWebcdr:o.stagingWebcdr:o.webcdr&&(oi.gApi.webcdr=o.webcdr),$("body").removeClass("loading"),window.onbeforeunload=function(e){gDesigner.isReloading()||gContainer.canUnload(gDesigner.hasModifiedDocuments(),gDesigner.hasSynchronizingDocuments(),!1)||(e.preventDefault(),e.returnValue="")},window.onunload=function(){gDesigner.hasEventListeners(Qt)&&gDesigner.trigger(new Qt)},n){let e=new S;if(gContainer.getRuntime()===In.Runtime.Browser||gContainer.getRuntime()===In.Runtime.PWA||gContainer.getRuntime()===In.Runtime.IPad){let t="";if(n.getType()===In.OpenFileRequest.Type.DocumentOrToken)try{t=JSON.parse(n.getContent()).doc}catch(e){}else t=n.getContent();e.setTitle(t),ai&&e.setFocusAnnotationId(ai.options.annot),gDesigner.addDocument(e)}gContainer.getRuntime()===In.Runtime.Electron?gContainer.openStorageFile(e,n,e=>{e&&gDesigner.openDocument(e)}):Jn.handleOpenFileRequest(e,n),gDesigner.createNewDocumentDialog()}else f.default.isEnabled()?gDesigner.handleWelcomeScreenOpenWithUserPermissions():gDesigner.newInfiniteDocument();gDesigner.hasEventListeners(Hn)&&gDesigner.trigger(new Hn(Hn.Status.Ready)),(0,c.isSupportedScreenSize)()?!(0,c.isSupportedScreenSize)(document.body.clientWidth)&&o.msTeamsMode&&await ni()&&Mn.alert(s.GLocale.get(new s.GLocaleKey("GSystemDialog","text.unsupported-windows-size-msteams"))):o.msTeamsMode?Mn.alert(s.GLocale.get(new s.GLocaleKey("GSystemDialog","text.unsupported-screen-size-msteams"))):(gDesigner.stats("touch-dialog_unsupport-size"),Mn.showOneTimeDialog(s.GLocale.get(new s.GLocaleKey("GSystemDialog","text.unsupported-screen-size")).replace("%app",o.DESIGNER.TITLE),"designer.settings.dont_show_unsupported_screen_size_dialog")),t.start(),await Un.start(),w&&await(0,c._tryAndCatch)(()=>{gDesigner._softwareUpdateManager=new jn,gDesigner._softwareUpdateManager.start()}),oi.gMemoryManager=new Zn,oi.gMemoryManager.start()};if("function"!=typeof gdb_initSetupSystemDate||y||await gdb_initSetupSystemDate(),await ii,await(0,c._tryAndCatch)(()=>Kn.init()),await null,_||gDesigner.isEnabledSubscriptions()){const e=async()=>{const e=await gDesigner.getUser();let t;if(e&&e.isAnonymous()&&ai&&ai.link===In.DeepLinking.DirectLink){let e=ai.options[In.DeepLinking.DirectLink];t=JSON.parse((0,c.base64StringToString)(e)).signup}if(!e||e.reload||e.deactivated||e.isAnonymous()&&t){const n=ai&&ai.link;e&&!e.isAnonymous()&&await(0,c._tryAndCatch)(()=>gDesigner.signout(!0,!0));const i=new URL(window.location.href).searchParams.get("token");if(i){const{enterprise:e}=await o.gApi.checkEnterpriseToken(i).catch({enterprise:!1});e&&gDesigner.setEnterpriseLoginForm(!0)}await gContainer.preLogin().catch(e=>{console.warn("gContainer preLogin error",e)}),new Nn(si).open({flow:n,signup:t,version:"2021.i13"}),On.setupInAppLinkReloadAppForOnce(),p&&p.has(In.DeepLinking.PWADialog)&&gDesigner.executeWhenReady(()=>{gDesigner.showInstallPwaDialog(!0)}),qn&&Mn.error(qn)}else await si(),p&&p.has(In.DeepLinking.PWADialog)&&gDesigner.executeWhenReady(()=>{gDesigner.showInstallPwaDialog()})};if(o.msTeamsMode)await ei()?new u.default(si).load():window.location.replace(window.location.origin);else if(navigator.onLine||gDesigner.isEnabledProFeatures("offline"))await e();else{const t=Mn.custom({icon:"clock",title:s.GLocale.get(new s.GLocaleKey("GCommonNames","text.license-offline-title")),subtitle:s.GLocale.get(new s.GLocaleKey("GCommonNames","text.license-offline-expired-subtitle")),closeable:!1}),n=()=>{navigator.onLine&&(e(),t.gDialog("close"),$(window).off("online",n))};$(window).on("online",n)}}else await si();o.gApi.setHooks({onError:()=>{di||ci().then(e=>e&&void(di||(di=new Bn,di.open())))}})}},function(e,t,n){"use strict";var i=n(17);n(9);var o=i(n(160)),r=n(1),a=i(n(1127)),s=i(n(36)),l=i(n(396)),c=n(1128);const{isPrivateChat:d,isTeamsChannel:u}=l.default;function p(e){if("function"!=typeof e)throw"GMSTeamsAppLoader constructor error: Wrong argument is provided";this._callback=e}p.prototype.isExeuteOnMobileDevice=function(){return o.default.hardware===o.default.Hardware.Phone},p.prototype.load=async function(){if(this.isExeuteOnMobileDevice())return void s.default.splashScreenError(r.GLocale.get(new r.GLocaleKey("GSystemDialog","text.unsupported-mobile-for-msteams-new")));const e=[c.MS_TEAMS_COMMAND];await d()?e.push(c.ONE_DRIVE_BUSINESS_COMMAND):await u()&&e.push(c.SHAREPOINT_COMMAND),a.default.getInstance().authenticate(e).then(()=>{this._callback()})},e.exports=p},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=async function(e,t,n,i){var o=void 0!==window.dataLayer?window.dataLayer:[],s=n;o.push({version:"3.5.71"}),o.push({gtmLocation:s}),o.push({hardware:u()}),await(0,a._tryAndCatch)(async()=>{if(i&&!i.isAnonymous()){l&&l.forEach(e=>dataLayer.push({[e]:void 0}));const{type:e="EWOSU",token:t}=i;o.push({[e]:t})}});var c=r.default.getRuntimeCode();o.push({installType:c}),o.push({event:"INIT_GTM_EVENT"})},n(9),n(28);var o=n(1),r=i(n(767)),a=n(32),s=n(716);const{GA:{customDimensions:l}={},GoogleTagManagerSettings:c}=n(12);window.dataLayer=[];const d=c.getContainerId(s.nodeEnv);!function(e,t,n,i,o){e[i]=e[i]||[],e[i].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var r=t.getElementsByTagName(n)[0],a=t.createElement(n);a.async=!0,a.src="https://www.googletagmanager.com/gtm.js?id="+o,r.parentNode.insertBefore(a,r)}(window,document,"script","dataLayer",d);const u=()=>{switch(o.GSystem.hardware){case o.GSystem.Hardware.Desktop:return"desktop";case o.GSystem.Hardware.Tablet:return"tablet";case o.GSystem.Hardware.Phone:return"phone";default:return"unknown"}}},function(e,t,n){"use strict";var i=n(17);n(25);var o=n(768),r=i(n(390)),a=i(n(144)),s=i(n(1130)),l=n(1);e.exports={debugDownloadPNG:function(){(0,o.downloadActiveFile)(r.default.PNG.ext)},debugDownloadPDF:function(e){(0,o.downloadActiveFile)(r.default.PDF.ext,{dpi:e||l.GLength.DPI})},debugDownloadSVG:function(){(0,o.downloadActiveFile)(r.default.SVG.ext)},debugDownloadJPEG:function(){(0,o.downloadActiveFile)(r.default.JPG.ext)},debugOpenFile:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=gDesigner.getDefaultStorage(),i=Object.assign({disableFileSystemAccessAPI:!0,silent:!0},t);n.openPrompt(a.default.FileTypes.filter(e=>e.load),t=>{gDesigner.openDocument(t),e&&e()},!1,i)},debugImportFont:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.assign({disableFileSystemAccessAPI:!0,silent:!0},t),i=new s.default;i.import(e,n)}}},function(e,t,n){"use strict";e.exports=class{static getSetting(){return"show_welcome_screen"}static isEnabled(){const e=gDesigner.getSetting("show_welcome_screen");return"boolean"!=typeof e||e}}},function(e,t,n){"use strict";var i=n(17);n(45),n(3),n(28),n(14),n(63);var o,r=n(12),a=n(32),s=i(n(509));!function(e){var t=function(){function e(){this._dropEffect="move",this._effectAllowed="all",this._data={}}return Object.defineProperty(e.prototype,"dropEffect",{get:function(){return this._dropEffect},set:function(e){this._dropEffect=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectAllowed",{get:function(){return this._effectAllowed},set:function(e){this._effectAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){return Object.keys(this._data)},enumerable:!0,configurable:!0}),e.prototype.clearData=function(e){null!=e?delete this._data[e]:this._data=null},e.prototype.getData=function(e){return this._data[e]||""},e.prototype.setData=function(e,t){this._data[e]=t},e.prototype.setDragImage=function(e,t,i){var o=n._instance;o._imgCustom=e,o._imgOffset={x:t,y:i}},e}();e.DataTransfer=t;var n=function(){function e(){if(e._instance)throw"DragDropTouch instance already created.";var t=(0,a.isPassiveSupported)();if("ontouchstart"in document||"undefined"!=typeof TouchEvent){this._documentTouchStart=this._documentTouchStart.bind(this),this._documentTouchEnd=this._documentTouchEnd.bind(this),this._documentDragStart=this._documentDragStart.bind(this),document.addEventListener("touchstart",this._documentTouchStart,!t||{passive:!0,capture:!0}),document.addEventListener("touchend",this._documentTouchEnd,!t||{passive:!0,capture:!0}),document.addEventListener("touchcancel",this._documentTouchEnd,!t||{passive:!0,capture:!0}),document.addEventListener("dragstart",this._documentDragStart,!0);var n=document;this._touchstart=this._touchstart.bind(this),this._touchmove=this._touchmove.bind(this),this._touchend=this._touchend.bind(this);var i=!!t&&{passive:!1,capture:!1};n.addEventListener("touchstart",this._touchstart,i)}}return e.getInstance=function(){return e._instance},e.prototype._touching=!1,e.prototype._documentTouchStart=function(e){e.isTrusted&&(this._touching=!0)},e.prototype._documentTouchEnd=function(e){e.isTrusted&&(this._touching=!1,this._touchend(e))},e.prototype._documentDragStart=function(e){e.isTrusted&&this._touching&&e.cancelable&&(e.preventDefault(),e.stopPropagation())},e.prototype._touchstart=function(t){var n=this;if(this._shouldHandle(t)){this._reset();var i=this._closestDraggable(t.target);i&&(e._ISPRESSHOLDMODE=parseInt(i.dataset.dragMode)===s.default.PRESS_AND_HOLD,this._dragSource=i,this._updateImageOffset(t),this._startTouchTime=(new Date).getTime(),this._ptDown=this._getPoint(t),this._lastTouch=t,this._dragSource.addEventListener("touchmove",this._touchmove,!0),this._dragSource.addEventListener("touchend",this._touchend,!0),this._dragSource.addEventListener("touchcancel",this._touchend,!0),e._ISPRESSHOLDMODE&&(this._pressHoldInterval=setTimeout((function(){n._isDragEnabled=!0,n._dragInitEvent=t,n._touchmove(t)}),e._PRESSHOLDAWAIT)))}},e.prototype._touchmove=function(t){if(this._shouldCancelPressHoldMove(t))this._reset();else if(this._shouldHandleMove(t)||this._shouldHandlePressHoldMove(t)){var n=this._getTarget(t);if(!this._img&&this._dragSource&&(t.cancelable&&t.preventDefault(),e._ISPRESSHOLDMODE&&(this._dispatchEvent(this._dragInitEvent||t,"draginit",this._dragSource),this._dragSource.classList.add("g-draggable"),this._dragSource.parentElement&&this._dragSource.parentElement.classList.add("g-draggable-parent"))),!this._img&&this._dragSource&&this._shouldStartDragging(t))t.cancelable&&t.preventDefault(),this._dragSource.classList.remove("g-draggable"),this._dragSource.parentElement&&this._dragSource.parentElement.classList.remove("g-draggable-parent"),this._dispatchEvent(t,"dragstart",this._dragSource)||(this._createImage(t),this._dispatchEvent(t,"dragenter",n));if(this._img){const e=gDesigner.getContextMenu();e&&e.close(),this._lastTouch=t,t.cancelable&&t.preventDefault(),this._dispatchEvent(t,"drag",this._dragSource),n!=this._lastTarget&&(this._dispatchEvent(t,"dragenter",n),this._dispatchEvent(this._lastTouch,"dragleave",this._lastTarget),this._lastTarget=n),this._moveImage(t),this._isDropZone=this._dispatchEvent(t,"dragover",n)}}else this._img&&this._destroyImage()},e.prototype._touchend=function(e){try{this._shouldHandle(e)&&this._dragSource&&("touchcancel"!==e.type&&this._isDropZone&&this._dispatchEvent(this._lastTouch,"drop",this._lastTarget),this._dispatchEvent(this._lastTouch,"dragend",this._dragSource))}finally{this._reset()}},e.prototype._shouldHandle=function(e){if(e.touches&&1===e.touches.length){var t=e.touches[0]&&e.touches[0].target;if(t&&t.hasAttribute("draggable")&&!t.draggable)return!1}return e&&!e.defaultPrevented&&e.touches&&e.touches.length<2},e.prototype._shouldHandleMove=function(t){return!e._ISPRESSHOLDMODE&&t.cancelable&&this._shouldHandle(t)},e.prototype._shouldHandlePressHoldMove=function(t){return e._ISPRESSHOLDMODE&&this._isDragEnabled&&t&&t.touches&&t.touches.length},e.prototype._shouldCancelPressHoldMove=function(t){return e._ISPRESSHOLDMODE&&!this._isDragEnabled&&this._getDelta(t)>e._PRESSHOLDMARGIN},e.prototype._shouldStartDragging=function(t){var n=this._getDelta(t);return n>e.DRAG_MOVE_THRESHOLD&&n<=e.DRAG_MOVE_LIMIT&&(new Date).getTime()-this._startTouchTime>=e.DRAG_MOVE_DELAY||e._ISPRESSHOLDMODE&&n>=e._PRESSHOLDTHRESHOLD},e.prototype._reset=function(){this._destroyImage(),this._dragSource&&(this._dragSource.classList.remove("g-draggable"),this._dragSource.parentElement&&this._dragSource.parentElement.classList.remove("g-draggable-parent"),this._dragSource.removeEventListener("touchmove",this._touchmove),this._dragSource.removeEventListener("touchend",this._touchend),this._dragSource.removeEventListener("touchcancel",this._touchend)),this._dragSource=null,this._startTouchTime=0,this._lastTouch=null,this._lastTarget=null,this._ptDown=null,this._isDragEnabled=!1,this._isDropZone=!1,this._dataTransfer=new t,this._pressHoldInterval&&clearTimeout(this._pressHoldInterval)},e.prototype._getPoint=function(e,t){return e&&e.touches&&(e=e.touches[0]),{x:t?e.pageX:e.clientX,y:t?e.pageY:e.clientY}},e.prototype._getDelta=function(t){if(e._ISPRESSHOLDMODE&&!this._ptDown)return 0;var n=this._getPoint(t);return Math.abs(n.x-this._ptDown.x)+Math.abs(n.y-this._ptDown.y)},e.prototype._getTarget=function(e){for(var t=this._getPoint(e),n=document.elementFromPoint(t.x,t.y);n&&"none"==getComputedStyle(n).pointerEvents;)n=n.parentElement;return n},e.prototype._translate=function(e,t,n){e.style.transform="translate3d(".concat(t,"px, ").concat(n,"px, 0px)")},e.prototype._createImage=function(t){this._img&&this._destroyImage();var n=this._imgCustom||this._dragSource;this._img=n.cloneNode(!0),this._copyStyle(n,this._img),e._ISPRESSHOLDMODE&&this._img.classList.add("g-draggable-drag-image"),this._img.style.left=this._img.style.top="0px",this._translate(this._img,-9999,-9999);var i=this._img.style;i.position="absolute",i.pointerEvents="none",i["touch-action"]="none",i.zIndex="999999",this._imgCustom||(this._img.style.opacity=e._OPACITY.toString()),this._moveImage(t),document.body.appendChild(this._img)},e.prototype._updateImageOffset=function(e){var t=(this._imgCustom||this._dragSource).getBoundingClientRect(),n=this._getPoint(e);this._imgOffset={x:n.x-t.left,y:n.y-t.top}},e.prototype._destroyImage=function(){this._img&&this._img.parentElement&&this._img.parentElement.removeChild(this._img),this._img=null,this._imgCustom=null},e.prototype._moveImage=function(e){if(this._img){var t=this._getPoint(e);this._translate(this._img,t.x-this._imgOffset.x,t.y-this._imgOffset.y)}},e.prototype._copyProps=function(e,t,n){for(var i=0;i<n.length;i++){var o=n[i];e[o]=t[o]}},e.prototype._copyStyle=function(t,n){if(e._rmvAtts.forEach((function(e){n.removeAttribute(e)})),n.classList.add(e._CUSTOM_DRAGGING_ELEMENT_CLASS),t instanceof HTMLCanvasElement){var i=t,o=n;o.width=i.width,o.height=i.height,o.getContext("2d").drawImage(i,0,0)}for(var r=getComputedStyle(t),a=0;a<r.length;a++){var s=r[a];s.indexOf("transition")<0&&(n.style[s]=r[s])}n.style.pointerEvents="none";for(a=0;a<t.children.length;a++)this._copyStyle(t.children[a],n.children[a])},e.prototype._dispatchEvent=function(t,n,i){try{if(t&&i){var o=document.createEvent("Event"),r=t.touches?t.touches[0]:t;if(o.initEvent(n,!0,!0),o.button=0,o.which=o.buttons=1,this._copyProps(o,t,e._kbdProps),this._copyProps(o,r,e._ptProps),o.dataTransfer=this._dataTransfer,!o.layerX&&!o.layerY){var a=i.getBoundingClientRect(),s=o.clientX-a.left,l=o.clientY-a.top;o.layerX=s,o.layerY=l}const c=i.dispatchEvent(o);return o.defaultPrevented||!1===c}}catch(t){console.warn("DragDropTouch dispatch event error",t)}return!1},e.prototype._closestDraggable=function(e){for(;e;e=e.parentElement)if(e.hasAttribute("draggable")&&e.draggable)return e;return null},e}();n._instance=new n,n._OPACITY=.5,n._ISPRESSHOLDMODE=!1,n._PRESSHOLDAWAIT=r.LONG_PRESS_TIME_OUT,n._PRESSHOLDMARGIN=25,n._PRESSHOLDTHRESHOLD=r.MIN_TOUCH_MOVE_DISTANCE,n.DRAG_MOVE_THRESHOLD=r.MIN_TOUCH_MOVE_DISTANCE||0,n.DRAG_MOVE_LIMIT=25,n.DRAG_MOVE_DELAY=100,n._rmvAtts="draggable".split(","),n._CUSTOM_DRAGGING_ELEMENT_CLASS="g-dragging-shadow-element",n._kbdProps="altKey,ctrlKey,metaKey,shiftKey".split(","),n._ptProps="pageX,pageY,clientX,clientY,screenX,screenY".split(","),e.DragDropTouch=n}(o||(o={}))},function(e,t,n){(function(i){var o,r;void 0===(r="function"==typeof(o=function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?a(e):t}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o(e);if(t){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return s(this,n)}}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}var d=function(){function t(){e(this,t),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return n(t,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],i=0,o=n.length;i<o;i++)if(n[i].callback===t)return void n.splice(i,1)}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,i=t.length;n<i;n++){var o=t[n];try{o.callback.call(this,e)}catch(e){Promise.resolve().then((function(){throw e}))}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),t}(),u=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}(s,t);var i=l(s);function s(){var t;return e(this,s),(t=i.call(this)).listeners||d.call(a(t)),Object.defineProperty(a(t),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(a(t),"onabort",{value:null,writable:!0,configurable:!0}),t}return n(s,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),c(o(s.prototype),"dispatchEvent",this).call(this,e)}}]),s}(d),p=function(){function t(){e(this,t),Object.defineProperty(this,"signal",{value:new u,writable:!0,configurable:!0})}return n(t,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),t}();function g(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}"undefined"!=typeof Symbol&&Symbol.toStringTag&&(p.prototype[Symbol.toStringTag]="AbortController",u.prototype[Symbol.toStringTag]="AbortSignal"),function(e){if(g(e))if(e.fetch){var t=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,i=t.Request,o=void 0===i?n.Request:i,r=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!g({fetch:n,Request:o,AbortController:r,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:l};var l=o;(l&&!l.prototype.hasOwnProperty("signal")||s)&&((l=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var i=new o(e,t);return n&&Object.defineProperty(i,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),i}).prototype=o.prototype);var c=n;return{fetch:function(e,t){var n=l&&l.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var i;try{i=new DOMException("Aborted","AbortError")}catch(e){(i=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(i);var o=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(i)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([o,c(e,t)])}return c(e,t)},Request:l}}(e),n=t.fetch,i=t.Request;e.fetch=n,e.Request=i,Object.defineProperty(e,"AbortController",{writable:!0,enumerable:!1,configurable:!0,value:p}),Object.defineProperty(e,"AbortSignal",{writable:!0,enumerable:!1,configurable:!0,value:u})}else console.warn("fetch() is not available, cannot install abortcontroller-polyfill")}("undefined"!=typeof self?self:i)})?o.call(t,n,t,e):o)||(e.exports=r)}).call(this,n(105))},function(e,t,n){"use strict";var i=n(17);n(28),n(129),n(83),n(14),n(29),n(19),n(9),n(24),n(3),n(537),n(63),n(25),n(171),n(45),n(58);var o=n(43),r=n(1),a=n(16),s=n(12),l=n(322),c=i(n(1369)),d=n(1131),u=n(32),p=n(1132),g=(i(n(1134)),i(n(1043))),h=i(n(502)),f=i(n(648)),m=i(n(1371)),y=i(n(1373)),v=n(144),_=n(217),b=n(308),w=n(717),C=n(1375),E=n(1393),S=n(1394),G=n(1144),A=n(773),T=n(511),P=n(1411),L=n(354);n(1412);var D=n(1413),x=n(545),I=n(772),O=n(1177),k=n(118),F=n(1040),R=n(78),M=n(1179),N=n(1059),B=n(1057),U=n(1180),K=(n(1181),n(230)),j=n(531),H=n(1416),V=n(1430),z=n(1432),W=n(1186);n(1433);var q=n(106),Y=n(202),X=n(76),Q=n(36),Z=n(1160),J=n(1135),ee=n(263),te=n(1196),ne=n(769),ie=n(544),oe=n(264),re=n(718),ae=n(1204),se=n(351),le=n(777),ce=n(1205),de=n(1437),ue=n(1438),pe=n(1440),ge=n(1053),he=n(1441),fe=n(754),me=n(306),ye=n(1208),ve=n(698),_e=n(231),be=n(546),we=n(1209),Ce=n(1211),Ee=n(721),Se=n(1075),Ge=n(400),Ae=n(77),Te=(n(18),n(395));const{defaultLegacyUserSettings:{features:Pe}}=s.defaultUserSettings;var Le=n(12);const{gApi:De}=Le;var xe=n(348),Ie=n(1449);const Oe=n(1450),ke=n(1453);var Fe=n(1456);n(549);const Re=n(32),Me=n(175),Ne=n(1221),Be=n(1060),$e=(n(1460),n(1461)),Ue=n(1462),Ke=n(1463);var je=n(1464);n(1465),je.addKeycodes({173:"-"}),je.addKeycodes({187:"="}),je.addKeycodes({61:"="});var He,Ve,ze=0,We=null;function qe(){this._settings={},this._settingsLoaded=!1,this._swatches={},this._workspace=new o.GEditorWorkspace,this._documents=[],this._actions=[],this._actionsMap={},this._clipboardMimeTypes={},this._license=void 0,this._reloading=!1,this._mainMenu=new _,this._enabledSubscriptions=!1,this._documentTouchHandler=new Oe(document),this._editorTouchHandler=new ke,de.clearSingleton(),this._cloudCommunicationManager=new de(this),this._cursorManager=new c.default,document.addEventListener("gesturechange",(function(e){e.stopPropagation()})),window.addEventListener("dragover",e=>{e.preventDefault()},!1),window.addEventListener("drop",e=>{e.preventDefault();var t=this.getWindows().getActiveWindow(),n=t&&t.getView();n&&n.handleDropEvent(e)},!1),window.addEventListener("wheel",e=>{(a.GPlatform.modifiers.ctrlKey||a.GPlatform.modifiers.metaKey)&&e.preventDefault()}),window.addEventListener("gesturestart",e=>{e.preventDefault()}),window.addEventListener("gestureend",e=>{e.preventDefault()}),window.addEventListener("gesturechange",e=>{e.preventDefault();var t=e.scale;t>1?t*=-1:t=2-t;var n=new WheelEvent("wheel",{deltaY:t,clientX:e.clientX,clientY:e.clientY,ctrlKey:!0}),i=this.getWindows()&&this.getWindows().getActiveWindow(),o=i&&i.getView()&&i.getView()._htmlElement;o&&o.dispatchEvent(n)}),document.addEventListener("keydown",function(e){if(document.activeElement&&$(document.activeElement).is(":button")&&(13==e.keyCode||32==e.keyCode)&&(e.preventDefault(),document.activeElement.blur()),this._windows){var t=document.activeElement,n=this._windows.getActiveWindow(),i=$(t).is("input")&&"number"===$(t).attr("type")&&!$(t).hasClass("g-disabled")&&"true"!==$(t).attr("disabled");!n||!n.getView()||t&&($(t).is(":editable")||i)||n.getView().focus()}}.bind(this),!1),document.addEventListener("contextmenu",function(e){return!$(e.target).is(":editable")||this.propertyPanelHasContextMenu(e)?(e.preventDefault(),!1):(e.stopPropagation(),!0)}.bind(this),!0),this._workspace.addEventListener(r.GWorkspace.ResolveUrlEvent,this._workspaceResolveUrlEvent,this),this.addEventListener(R,this._documentEvent,this),this.addEventListener(k,this._settingChangedEvent,this),this.addEventListener(oe,this._userLoggedEvent,this),this.addEventListener(re,this._userPropertiesChangedEvent,this),this.addEventListener(ie,this._licenseChangedEvent,this),this.addEventListener(Se.BeforeInstallUpdate,this._beforeInstallUpdate,this),this.addEventListener(Ee,this._applicationStatusEvent,this),this.addEventListener(se,this._applicationStateChangedEvent,this),this.addEventListener(le,this._shareEvent,this),this._settings.theme="light",this._settings.snap_disabled=!1,this._settings.snap_zones=!1,this._settings.snap_guides=[o.GGuideLinesGuide.ID,o.GFullPixelsGuide.ID,o.GPointsGuide.ID,o.GBBoxGuide.ID,o.GPageGuide.ID,o.GGridGuide.ID],this._settings.rulers_visible=!1,this._settings.guide_lines_visible=!0,this._settings.symbol_labels_visible=!0,this._settings.grid_visible=!0,this._settings.page_labels_visible=!0,this._settings.highlight_on_hover=!0,this._settings.invert_selection=!1,this._settings.auto_expand_layers=!0,this._settings.system_fonts_enabled=!0,this._settings.symbols_panel_shown=!1,this._settings.decimals_num=null,this._settings.enable_steps_debug=!1,this._settings.enable_cache="function"==typeof gdb_loaddesign,this._settings.ui_toolbar_alignment=!0,this._settings.eps_outline_fonts=!0,this._settings[Z.AUTO_SAVE_SETTING]=!1,this._settings[Z.AUTO_SAVE_INTERVAL_SETTING]=s.AUTOSAVE_INTERVAL_DEFAULT,this._settings.notifications_disabled=!1,this._settings.touch=!1,this._settings[L.getSettingNameForSidebar(L.Orientation.Left)]=!0,this._settings[L.getSettingNameForSidebar(L.Orientation.Right)]=!0,$(document).on("networkAvailable",()=>{this._initialized&&gDesigner.updateRecentDocumentsAction()}),this._paste=new te;const e=e=>{this.hasEventListeners(ee)&&this.trigger(new ee(e))};$(window).on("online",()=>e(!0)),$(window).on("offline",()=>{"undefined"!=typeof dataLayer&&dataLayer.push({event:"NETWORK_DISCONNECTED_EVENT"}),e(!1)})}r.GObject.inherit(qe,r.GEventTarget),qe.prototype._documentTouchHandler=null,qe.prototype._editorTouchHandler=null,qe.prototype._persona=d.GPersona.GraphicDesign,qe.prototype._paymentFlow=null,qe.prototype._license=void 0,qe.prototype._translationManager=void 0,qe.prototype._initialized=!1,qe.prototype._ready=!1,qe.prototype._settings=null,qe.prototype._settingsLoaded=!1,qe.prototype._softwareUpdateManager=null,qe.prototype._swatches=null,qe.prototype._workspace=null,qe.prototype._CDRIntegrationEngine=null,qe.prototype._documents=null,qe.prototype._activeDocument=null,qe.prototype._mainframe=null,qe.prototype._frame=null,qe.prototype._info=null,qe.prototype._footer=null,qe.prototype._header=null,qe.prototype._toolbar=null,qe.prototype._panels=null,qe.prototype._leftSidebars=null,qe.prototype._rightSidebars=null,qe.prototype._windows=null,qe.prototype._actions=null,qe.prototype._actionsMap=null,qe.prototype._clipboardMimeTypes=null,qe.prototype._newDocumentDialog=null,qe.prototype._userNameConfigDialog=null,qe.prototype._contextMenu=null,qe.prototype._stylesPreview={},qe.prototype._version=null,qe.prototype._commitSHA=null,qe.prototype._buildNum=null,qe.prototype._isBeta=null,qe.prototype._storeVendor=null,qe.prototype._env=null,qe.prototype._user=null,qe.prototype._fontsPath=null,qe.prototype._paste=null,qe.prototype._enabledSubscriptions=!1,qe.prototype._reloading=!1,qe.prototype._utm=null,qe.prototype._location=null,qe.prototype._supportedBrowsers=[],qe.prototype._supportedTabletBrowsers=[],qe.prototype._isBrowserSupported=!0,qe.prototype._showCreateAccount=!1,qe.prototype._signupOptions=null,qe.prototype._enterpriseLoginForm=!1,qe.prototype._anonymous=!1,qe.prototype._assistantBar=null,qe.prototype._mainMenu=null,qe.prototype._mouseOverContext={context:null,prevEvt:null,contextCallback:null},qe.prototype._realtimeManager=null,qe.prototype._fileReviewManager=null,qe.prototype._shareManager=null,qe.prototype._cloudCommunicationManager=null,qe.prototype._annotationsManager=null,qe.prototype._cursorManager=null,qe.prototype._draggableItemIsDragging=!1,qe.prototype.getMainMenu=function(){return this._mainMenu},qe.prototype.propertyPanelHasContextMenu=function(e){var t=!1;return e.composedPath&&e.composedPath()&&e.path.forEach(e=>{$(e).hasClass("properties-panel")&&(t=!!$(e).data("contextmenu"))}),t},qe.prototype.getMouseOverContext=function(){return this._mouseOverContext},qe.prototype.setMouseOverContext=function(e,t,n){this._mouseOverContext={context:e,prevEvt:t,contextCallback:n}},qe.prototype._pwaEvent=window.__pwaEvent__||null,qe.prototype.isAnonymous=function(){return this._anonymous},qe.prototype.toggleLoading=function(e){e?$("body").addClass("g-loading"):$("body").removeClass("g-loading")},qe.prototype.setSupportedBrowsers=function(e){this._supportedBrowsers=e},qe.prototype.setSupportedTabletBrowsers=function(e){this._supportedTabletBrowsers=e},qe.prototype._initBrowserSupported=function(e){var t=t=>t.some(t=>t instanceof Object?r.GSystem.operatingSystem==t.operatingSystem&&e==t.platform:e===t);r.GSystem.hardware===r.GSystem.Hardware.Tablet?this._isBrowserSupported=t(this._supportedTabletBrowsers):r.GSystem.hardware==r.GSystem.Hardware.Desktop?this._isBrowserSupported=t(this._supportedBrowsers):this._isBrowserSupported=!1},qe.prototype.isBrowserSupported=function(){return gContainer.getRuntime()===X.Runtime.IPad||this._isBrowserSupported},qe.prototype.setUTM=function(e){this._utm=e},qe.prototype.getUTM=function(){return this._utm},qe.prototype.getTranslationManager=function(){return this._translationManager},qe.prototype.activatePersona=function(e){var t=this._persona;t!==e&&(this._persona=e,this.hasEventListeners(J)&&this.trigger(new J(t,this._persona)))},qe.prototype.getActivePersona=function(){return this._persona},qe.prototype.getDefaultStorage=function(){return gContainer.getStorage()},qe.prototype.getWorkspace=function(){return this._workspace},qe.prototype.getCDRIntegrationEngine=function(){return this._CDRIntegrationEngine},qe.prototype.getApplicationManager=function(){return this._applicationManager},qe.prototype.getSoftwareUpdateManager=function(){return this._softwareUpdateManager},qe.prototype.getShareManager=function(){return this._shareManager},qe.prototype.getCloudCommunicationManager=function(){return this._cloudCommunicationManager},qe.prototype.getAnnotationsManager=function(){return this._annotationsManager},qe.prototype.getCursorManager=function(){return this._cursorManager},qe.prototype.getRealtimeManager=function(){return this._realtimeManager},qe.prototype.getFileReviewManager=function(){return this._fileReviewManager},qe.prototype.getToolManager=function(){return this._workspace.getToolManager()},qe.prototype.getDocuments=function(){return this._documents},qe.prototype.getActiveDocument=function(){return this._activeDocument?this._activeDocument:null},qe.prototype.getActiveView=function(){const e=gDesigner.getActiveDocument(),t=e&&e.getActiveWindow();return t&&t.getView()},qe.prototype.getHeader=function(){return this._header},qe.prototype.getInfo=function(){return this._info},qe.prototype.getToolbar=function(){return this._toolbar},qe.prototype.getPanels=function(){return this._panels},qe.prototype.getLeftSidebars=function(){return this._leftSidebars},qe.prototype.getRightSidebars=function(){return this._rightSidebars},qe.prototype.getWindows=function(){return this._windows},qe.prototype.isPartVisible=function(e){return"none"!==this.getPart(e).css("display")},qe.prototype.setPartVisible=function(e,t,n){t!=this.isPartVisible(e)&&(this.getPart(e).css("display",t?n||""===n?n:"block":"none"),this.relayout())},qe.prototype.getPart=function(e){return this._mainframe.find("#"+e.id)},qe.prototype.getActions=function(){return this._actions},qe.prototype.getAction=function(e){return this._actionsMap[e]||null},qe.prototype.addMenu=function(e,t,n,i,o){e=e||this._mainMenu;var r=new b(b.Type.Menu,_);return r.setCaption(t),r.setIcon(i),e.addItem(r),n&&r.getMenu().addEventListener(w,n),o&&r.addEventListener(b.UpdateEvent,()=>o(r)),r.getMenu()},qe.prototype.addMenuSeparator=function(e,t){var n=new b(b.Type.Divider,null,null,t);return e.addItem(n),n},qe.prototype.addMenuItem=function(e,t,n,i,o,r,a,s,l,c,d){var u=new b(b.Type.Item);return r&&u.addEventListener(b.ActivateEvent,r),o&&(gDesigner.registerShortcut(o,function(){return r("shortcut")}.bind(this),a),u.setShortcutHint(o)),u.setIcon(n),u.setPro(s),u.setNoHover(d),c&&u.addClass(c),this.updateMenuItem(u,t,!0,!1),e.addItem(u),l&&u.setAction(l),u},qe.prototype.updateMenuItem=function(e,t,n,i,o,r){e.setCaption(t),e.setEnabled(n),e.setChecked(i),e.setPro(!!o,r)},qe.prototype.removeMenuItem=function(e,t){e.removeItem(e.indexOf(t))},qe.prototype.getClipboardMimeTypes=function(){return this._clipboardMimeTypes?Object.keys(this._clipboardMimeTypes):null},qe.prototype.getClipboardContent=function(e){return this._clipboardMimeTypes&&this._clipboardMimeTypes.hasOwnProperty(e)?this._clipboardMimeTypes[e]:null},qe.prototype.setClipboardContent=function(e,t){this._clipboardMimeTypes[e]=t},qe.prototype.getSetting=function(e,t){return this._settings.hasOwnProperty(e)?this._settings[e]:t},qe.prototype.setSetting=function(e,t){if(this._settingsLoaded){for(var n=e instanceof Array?e:[e],i=e instanceof Array?t:[t],o=!1,a=0;a<n.length;++a){e=n[a],t=i[a];if(!this._settings.hasOwnProperty(e)||!r.GUtil.equals(this._settings[e],t,!0)){var s=this._settings[e];this._settings[e]=t,this.trigger(new k(e,s||void 0,t)),o=!0}}if(o)try{gContainer.setProperty("designer.settings",this._settings)}catch(e){}return o}},qe.prototype.getSwatches=function(e){if(e.startsWith("document")&&this.getActiveDocument()){var t=this.getActiveDocument().getScene().getSwatches(),n=[];if(t)for(var i=t.getFirstChild();null!==i;i=i.getNext()){var o=r.GPattern.serialize(i.getProperty("_pt"));((o.startsWith("C#")||o.startsWith("Y#"))&&"document"===e||o.startsWith("L#")&&"document-linear-gradient"===e||o.startsWith("R#")&&"document-radial-gradient"===e||o.startsWith("A#")&&"document-angular-gradient"===e||o.startsWith("T#")&&"document-texture-pattern"===e||o.startsWith("N#")&&"document-noise-pattern"===e)&&n.push(i)}return n}return this._swatches[e]},qe.prototype.setSwatches=function(e,t,n){if((!e.startsWith("document")||this.getActiveDocument())&&(e.startsWith("document")||this._swatches.hasOwnProperty(e))){e.startsWith("document")||(this._swatches[e]=t);var i=e.startsWith("document"),o=e.startsWith("global"),a=this.getActiveDocument().getScene();if(i){if(n)a.getSwatches().clearChildren();else{for(var s=this.getSwatches(e),l=[],c=a.getSwatches().getFirstChild();null!==c;c=c.getNext())for(var d=0;d<s.length;++d)r.GUtil.equals(c,s[d])&&l.push(c);for(d=0;d<l.length;++d)a.getSwatches().removeChild(l[d])}for(d=0;d<t.length;++d)a.getSwatches().appendChild(t[d])}else if(o){var u=this._swatches.global;u=(u=(u=(u=(u=u.concat(this._swatches["global-linear-gradient"])).concat(this._swatches["global-angular-gradient"])).concat(this._swatches["global-radial-gradient"])).concat(this._swatches["global-texture-pattern"])).concat(this._swatches["global-noise-pattern"]);var p=[];for(d=0;d<u.length;++d)p.push(r.GNode.serialize(u[d]));gContainer.setProperty("swatches",p)}this.trigger(new F(e))}},qe.prototype.getAllSwatches=function(e){var t=[];if(e.startsWith("document"))for(var n=this.getActiveDocument().getScene().getSwatches().getFirstChild();null!==n;n=n.getNext())t.push(n);else t=(t=(t=(t=(t=(t=t.concat(this._swatches.global)).concat(this._swatches["global-linear-gradient"])).concat(this._swatches["global-angular-gradient"])).concat(this._swatches["global-radial-gradient"])).concat(this._swatches["global-texture-pattern"])).concat(this._swatches["global-noise-pattern"]);return t},qe.prototype.newInfiniteDocument=function(){var e=this.createScene();e.getActivePage().setProperties(["bck","w","h"],[r.GRGBColor.WHITE,0,0]);var t=new v(e);return this.addDocument(t),t},qe.prototype.createScene=function(e){var t=new r.GScene(this.getWorkspace(),e);return void 0!==o.GEditorOptions.scaleBorderWidth&&t.setBorderScale(o.GEditorOptions.scaleBorderWidth),void 0!==o.GEditorOptions.scaleCorners&&t.setCornersScale(o.GEditorOptions.scaleCorners),t},qe.prototype.createNewDocumentDialog=function(){this._newDocumentDialog=new H},qe.prototype.openNewDocumentDialog=function(e){const t=this.getApplicationManager();(t.isCreatingNewDocumentEnabled()||t.isOpenFromCloudEnabled())&&(this._newDocumentDialog||(this._newDocumentDialog=new H),0===$(".g-new-document-dialog").length?this._newDocumentDialog.open(e):e&&e.openFromCloud&&this._newDocumentDialog.getDialogElement().find(".option.cloud-option").click())},qe.prototype.openCloudSaveDialog=function(e,t,n,i,o){0===$(".g-new-document-dialog").length&&(this._newDocumentDialog||(this._newDocumentDialog=new H),this._newDocumentDialog.saveCloudFile(e,t,n,i,o))},qe.prototype._shouldOpenUserNameConfigDialog=function(){return!(this._user&&!this._user.canUpdateSelfAccountData())&&(!(this._user&&this._user.isAnonymous()&&!s.ANONYMOUS_SESSION_ENABLED)&&(!this._user||!this._user.getFirstName()))},qe.prototype.openUserNameConfigDialog=function(){if(!s.ENABLE_COLLABORATION)return;let e=this._shouldOpenUserNameConfigDialog();if(!this._userNameConfigDialog&&e){const e=this._user||{name:"",last_name:"",anonymous:""};this._userNameConfigDialog=new V(e.name,e.last_name,e.anonymous)}e&&0===$(".g-username-config-dialog").length&&this._userNameConfigDialog.open()},qe.prototype.closeNewDocumentDialog=function(){this._newDocumentDialog&&this._newDocumentDialog.close()},qe.prototype.addDocument=function(e,t){void 0!==t?this._documents.splice(t,0,e):this._documents.push(e),this.hasEventListeners(R)&&this.trigger(new R(R.Type.Added,e)),this._windows.addWindow(e,!1,t)},qe.prototype.notifyDocumentModified=function(e){this.hasEventListeners(R)&&this.trigger(new R(R.Type.Modified,e,null))},qe.prototype._isNativeDesign=function(e){return e===s.FILE_FORMATS.find(e=>e.default).ext.toUpperCase()},qe.prototype.isInitialized=function(){return this._initialized},qe.prototype._canOpenDocument=function(e){if(!this._initialized)return!1;if(!this.isEnabledProFeatures()){let t=v.FileTypes.find(t=>t.ext.toUpperCase()===(e.getExtension()||"").toUpperCase());if(t&&t.pro)return gDesigner.stats("document_nonprotriespro_".concat(t.ext.toLowerCase())),this.handlePROFeatureInterruption(),!1}return!0},qe.prototype._processOpenDocument=function(e,t){const n=e.getExtension(),i=this._isNativeDesign(n),o=new v(i?e:null);if(o.isExtensionAvailableForLoading(n))return this.addDocument(o,t),o.load(e),o;var a=!!v.FileTypes.find(e=>e.ext.toUpperCase()===n.toUpperCase()&&"image"===e.category)?"text.suggestion-open-image":"text.unsupported-file-extension";return Q.alert(r.GLocale.get(new r.GLocaleKey("GDocument",a))),null},qe.prototype.openDocumentWithReload=function(e,t){if(this._canOpenDocument(e))return this._processOpenDocument(e,t)},qe.prototype.openDocument=function(e,t){if(!this._canOpenDocument(e))return;if(e&&(0,p.shouldShowExternalFileError)(e))throw new f.default;const n=e.getExtension();if(this._isNativeDesign(n)){const t=e.getUniqueId();if(null!=t)for(var i=0;i<this._documents.length;++i){const n=this._documents[i];if(n.getStorageItem()&&n.getStorageItem().getUniqueId()===t&&(!n.getStorageItem().getVersionId||!e.getVersionId||n.getStorageItem().getVersionId()===e.getVersionId()))return this.activateDocument(n),n}}return this._processOpenDocument(e,t)},qe.prototype.addToRecentFiles=function(e){function t(t,n){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];gContainer.getProperty(t).then((function(o){i&&o&&(o=JSON.parse(Re.base64StringToString(o))),o||(o=[]);for(var r=0;r<o.length;++r){let t=!1;if(gContainer.getRuntime()===X.Runtime.Electron)t=o[r]===n(e);else{let n=JSON.parse(o[r]),i=e.getFile();t=n.file.id===i.id}if(t){o.splice(r,1);break}}o.unshift(n(e)),o.splice(10,o.length),i&&(o=Re.stringToBase64String(JSON.stringify(o))),gContainer.setProperty(t,o),gDesigner.updateRecentDocumentsAction()}))}e&&(e instanceof Y.Item?gDesigner.updateRecentDocumentsAction():gContainer.getRuntime()===X.Runtime.Electron?t("recent_documents",e=>e.getUniqueId()):e instanceof xe.Item&&gDesigner.getUser().then(e=>{t("recent_external_".concat(e.getUID()),e=>{const t=e instanceof h.default.Item?"googledrive":null;return JSON.stringify({type:t,file:e.getFile()})},!0)}))},qe.prototype.activateDocument=function(e,t){if(e!=this._activeDocument){if(this._activeDocument){var n=this._activeDocument;this._activeDocument=null,n.deactivate(),this.hasEventListeners(R)&&this.trigger(new R(R.Type.Deactivated,n)),n.getActiveWindow()===this._windows.getActiveWindow()&&this._windows.activateWindow(null)}e&&(this._activeDocument=e,t||this._windows.activateWindow(e.getActiveWindow()),e.activate(),this.hasEventListeners(R)&&this.trigger(new R(R.Type.Activated,e)))}},qe.prototype.replaceDocument=function(e,t,n){var i=this._documents.indexOf(e);i<0||(this.addDocument(t,i),this.removeDocument(e,null,n))},qe.prototype.removeDocument=function(e,t,n){var i=this._documents.indexOf(e);if(!(i<0)){var o=e.getWindows();if(o.length){var r=function(){o.length>0?this._windows.removeWindow(o[0],r,n):this.removeDocument(e,t)}.bind(this);r()}else e===this.getActiveDocument()&&this.activateDocument(null),e.release(),this._documents.splice(i,1),t&&t(),this.hasEventListeners(R)&&this.trigger(new R(R.Type.Removed,e)),0===this._documents.length&&this.handleWelcomeScreenOpenWithUserPermissions()}},qe.prototype.handleWelcomeScreenOpenWithUserPermissions=function(){let e={closable:this.getApplicationManager().isCreatingNewDocumentEnabled(),showCloudOptions:!0,closeCallback:e=>{e&&gDesigner.newInfiniteDocument()}};this.openNewDocumentDialog(e)},qe.prototype.canExecuteAction=function(e,t){var n=this.getAction(e);return!!n&&(n.isAvailable()&&n.isEnabled.apply(n,t))},qe.prototype.canActivateTool=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t||!s.HAS_ANNOTATIONS||this.getRightSidebars().getActiveSidebar()!=T.ID)return!0;const n=["path","shape","knife","insert"],i=["special"];return!gravit.tools.some(t=>{let{tool:o,group:r,category:a}=t;return o===e&&(n.includes(r)||i.includes(a))})},qe.prototype.executeAction=function(e,t,n,i){var o=this.getAction(e);if(!o)throw new Error("Unable to execute action '"+e+"' - not registered.");var r=this._windows.getActiveWindow();if(!r||!r.isPreview()){if(o.isAvailable()&&o.isEnabled.apply(o,t)){if(e===Ge.ID)this.getPart(I.Toolbar).find(".toolbar-button[data-action='"+e+"']").find("button").toggleClass("g-disabled",!0);var a=o.execute;if("shortcut"===n&&(a=o.executeFromShortcut),!i){var s=o.isPro()?gDesigner.isEnabledProFeatures(e)?"execute":"nonprotriespro":"execute";this.stats("action_"+s+"_"+(n||"button"),o.statsValue()||e)}var l=a.apply(o,t);if(void 0!==l)return l}return!0}},qe.prototype.setOpenSansDefaultFont=function(){var e=this._workspace.getFontManager();e.setDefaultFont(e.getFont("Open Sans",r.GFont.Style.Normal,r.GFont.Weight.Regular)),e.setDefaultFontStyles([r.GFont.Style.Normal,r.GFont.Style.Italic]),e.setDefaultFontWeights([300,400,600,700,800])},qe.prototype.isTouchDevice=function(){return s.TOUCH_LAYOUT&&("ontouchstart"in window||!!navigator.msMaxTouchPoints||!!navigator.maxTouchPoints)},qe.prototype.isTouchEnabled=function(){return gContainer.getRuntime()===X.Runtime.IPad||!!s.TOUCH_LAYOUT&&this.isEnabledProFeatures()&&!!this.getSetting("touch",!1)},qe.prototype.setTouchEnabled=function(e){this.setSetting("touch",!!e)},qe.prototype.init=function(){this._shareManager=new ce,this._realtimeManager=new pe,this._fileReviewManager=new ge,this._annotationsManager=new he,gContainer.registerFontProviders(),K.getInstance().init();var e=this._workspace.getFontManager();if(e.addEventListener(r.GFontManager.ResolveFontEvent,this._fontManagerResolveFontEvent,this),e.addEventListener(r.GFontManager.QueryFontFamilyEvent,this._fontManagerQueryFontFamilyEvent,this),this.setOpenSansDefaultFont(),r.GLocale.getLanguage()===r.GLocaleLanguage.Chinese||r.GLocale.getLanguage()===r.GLocaleLanguage.ChineseTaiwan)K.getProviderInstance(j).hasFont("Noto Sans CS")&&(e.setDefaultFont(e.getFont("Noto Sans CS",r.GFont.Style.Normal,r.GFont.Weight.Regular)),e.setDefaultFontStyles([r.GFont.Style.Normal]),e.setDefaultFontWeights([100,200,300,400,500,600,800]));else if(r.GLocale.getLanguage()===r.GLocaleLanguage.Japanese){K.getProviderInstance(j).hasFont("Noto Sans CJK JP")&&(e.setDefaultFont(e.getFont("Noto Sans CJK JP",r.GFont.Style.Normal,r.GFont.Weight.Regular)),e.setDefaultFontStyles([r.GFont.Style.Normal]),e.setDefaultFontWeights([400,700]))}this._CDRIntegrationEngine=Ie.createCDRIntegrationEngine(),o.GEditorOptions.selectDoubleClickBehavior="subselect",o.GEditorOptions.coordinatesTooltip=!0,o.GEditorOptions.bboxPositionTooltip=!1,o.GEditorOptions.sizeTooltip=!1,o.GEditorOptions.angleTooltip=!1,o.GEditorOptions.showTooltips=!0,o.GEditorOptions.propertiesExcludedFromCopying=Te.PropertiesToExcludeFromCopying,o.GEditorOptions.adaptiveResizeHandles=!0,o.GSkewHorizontalAnnotation.setIcon("assets/annotation/touch/skew-horizontal-handle.png"),o.GSkewVerticalAnnotation.setIcon("assets/annotation/touch/skew-vertical-handle.png"),o.GPreserveAspectRatioAnnotation.setIcon("assets/annotation/touch/preserve-aspect-ratio-handle.png"),o.GRotateAnnotation.setIcon("assets/annotation/touch/rotate-handle.png"),l.DESIGNER.HIGHLIGHT_COLOR&&(r.GPaintContext.prototype.highlightOutlineColor=l.DESIGNER.HIGHLIGHT_COLOR),gContainer.getProperty(O._keepRatioName).then(e=>{e=e||!1,o.GEditorOptions.preserveAspectRatio=e,o.GEditorOptions.allowTextRatioPreservation=e}),r.GSceneOptions.scaleLabel=!1,o.GEditorPaintConfiguration.prototype.pageDecoration.shadow=4,o.GEditorPaintConfiguration.prototype.pageDecoration.shadowOffsetY=2,o.GEditorPaintConfiguration.prototype.pageDecoration.shadowBackground="rgba(0,0,0,0.25)",gContainer.getProperty(U.StoragePropertyName).then(e=>{e&&this.updateGEditorSceneConfigurationPaintMode(r.GScenePaintConfiguration.PaintMode.Outline)}),o.GGridGuide.MIN_CELL_SPACE=5;var t=$("body");t.attr("data-long-press-delay",s.LONG_PRESS_TIME_OUT),t.on("long-press",e=>{const t=jQuery.Event("contextmenu",{pageX:e.detail.clientX,pageY:e.detail.clientY,clientX:e.detail.clientX,clientY:e.detail.clientY});$(e.target).trigger(t)}),this._mainframe=$("<div></div>").attr("id","mainframe").css("display","none").prependTo(t);var n=this._frame=$("<div></div>").appendTo(this._mainframe),i=$("<div></div>").attr("id",I.Windows.id).appendTo(n);this._windows=new x(i);var c=$("<div></div>").attr("id",I.Info.id).appendTo(n);this._info=new S(c);var d=$("<div></div>").attr("id",I.Header.id).appendTo(n);this._header=new C(d);var p=$("<div></div>").attr("id",I.Toolbar.id).appendTo(n);this._toolbar=new D(p);var g=$("<div></div>").attr("id",I.Panels.id).appendTo(n),h=$("<div></div>").attr("id",I.Footer.id).appendTo(n);this._footer=new E(h),this._panels=new P(g);var f=$("<div></div>").attr("id",I.LeftSidebars.id).on("mousedown",()=>{this._toggleSideBarAndAssistBarZIndex(!0,!1,!1,!1)}).appendTo(n);this._leftSidebars=new L(f,L.Orientation.Left,n);var m=$("<div></div>").attr("id",I.RightSidebars.id).on("mousedown",()=>{this._toggleSideBarAndAssistBarZIndex(!1,!0,!1,!1)}).appendTo(n);this._rightSidebars=new L(m,L.Orientation.Right,n),this._updateStyles(t),this._initBrowserSupported(a.GPlatform.webBrowser),this.isBrowserSupported()||Q.showOneTimeDialog(r.GLocale.get(new r.GLocaleKey("GSystemDialog",r.GSystem.hardware===r.GSystem.Hardware.Tablet?"text.unsupported-browser-touch":"text.unsupported-browser")).replace("%app",Le.DESIGNER.TITLE),"designer.settings.dont_show_unsupported_browser_dialog");let y=(0,u.debounce)(function(){this.relayout(),setTimeout(()=>{this._windows.getActiveWindow()&&this._windows.getActiveWindow().getView().invalidate(null,!0)})}.bind(this),500);$(window).resize(function(){y()}.bind(this));var v=-1;this._actions=gravit.actions.map((e,t)=>(e.getId()===M.ID&&(v=t),e));var _=gravit.sidebars.map(e=>new B(e));if(Array.prototype.splice.apply(this._actions,[v,0].concat(_)),this._createMainMenu(),gravit.tools){for(var b=e=>{let{tool:t,pro:n=!1,feature:i}=e;return()=>!(!this.isEnabledProFeatures(i)&&n)&&(!!this.canActivateTool(t,!0)&&(gDesigner.stats("tools_activate_shortcut",D.getToolName(t)||"unknown_tool"),this.getToolManager().tempToolKeyActivate(t)))},w=e=>{let{tool:t,pro:n=!1,feature:i}=e;return()=>!this.isEnabledProFeatures(i)&&n?(this.handlePROFeatureInterruption(),!1):this.getToolManager().tempToolKeyRelease(t,450)},k=0;k<gravit.tools.length;++k){var F=gravit.tools[k];if(F.key||F.shortcuts){var R=b(F),N=w(F);F.key&&this.registerShortcut([F.key],R,!1,N),Array.isArray(F.shortcuts)&&F.shortcuts.forEach(e=>{this.registerShortcut(e,R,!1,N)})}}this.getToolManager().activateTool(gravit.tools[0].tool);var H=function(){var e=this.getToolManager();return this.getRightSidebars().getActiveSidebar()==T.ID||(e.getActiveTool()&&e.getActiveTool()instanceof o.GSelectTool||e.activateTool(o.GPointerTool),e.getActiveTool()instanceof o.GSelectTool&&e.getActiveTool().getEditMode()!==o.GSelectTool.EditMode.Transform&&e.getActiveTool().setEditMode(o.GSelectTool.EditMode.Transform)),!0}.bind(this);this.registerShortcut(["Q"],H)}this._info.init(),this._header.init(),this._toolbar.init(),this._panels.init(),this._footer.init(),this._leftSidebars.init(),this._rightSidebars.init(),this._windows.init(),this._leftSidebars.setActiveSidebar(G.ID),this._rightSidebars.setActiveSidebar(A.ID),this.setPartVisible(I.Panels,!1),this.setPartVisible(I.Info,!1),this._mainframe.css("display",""),r.GColor.setCMYKProfile("USWebCoatedSWOPv2","assets/data/icc/"),this._initialized=!0,this._windows.addEventListener(x.WindowEvent,this._windowEvent,this),this._leftSidebars.addEventListener(L.SidebarEvent,this._sidebarEvent,this),this._rightSidebars.addEventListener(L.SidebarEvent,this._sidebarEvent,this),this._contextMenu=new W(i),this.updateLicenseInfo(),this._updateTitle({saveToSessionHistory:!1}),s.AUTO_SAVE_ENABLED&&(this._autoSaveManager=Z.getInstance()),this.getCursorManager().init(),this._updateLayout()},qe.prototype._updateStyles=function(e){switch(a.GPlatform.webBrowser){case a.GPlatform.constructor.WebBrowser.Edge:e.addClass("g-edge");break;case a.GPlatform.constructor.WebBrowser.Opera:e.addClass("g-opera");break;case a.GPlatform.constructor.WebBrowser.Chrome:e.addClass("g-chrome");break;case a.GPlatform.constructor.WebBrowser.Firefox:e.addClass("g-firefox");break;case a.GPlatform.constructor.WebBrowser.Safari:e.addClass("g-safari");break;case a.GPlatform.constructor.WebBrowser.MSIE:e.addClass("g-msie")}switch(r.GSystem.hardware){case r.GSystem.Hardware.Desktop:e.addClass("g-desktop");break;case r.GSystem.Hardware.Tablet:e.addClass("g-tablet");break;case r.GSystem.Hardware.Phone:e.addClass("g-phone")}switch(r.GSystem.operatingSystem){case r.GSystem.OperatingSystem.Unix:e.addClass("g-os-unix");break;case r.GSystem.OperatingSystem.Windows:e.addClass("g-os-windows");break;case r.GSystem.OperatingSystem.OSX_IOS:e.addClass("g-os-osx_ios")}gContainer.getRuntime()===X.Runtime.IPad&&e.addClass("g-ipad")},qe.prototype.getContextMenu=function(){return this._contextMenu},qe.prototype.getAutoSaveManager=function(){if(this._autoSaveManager)return this._autoSaveManager},qe.prototype.isActiveDocument=function(e){const t=this.getActiveDocument();return!!t&&(!!(e&&e instanceof v)&&(t===e||!(!t.getId()||t.getId()!==e.getId())))},qe.prototype._setActiveAssistantBar=function(e){if(e){if(!this._assistantBar){const e=$("<div/>").attr("id",I.AssistantBar.id).on("mousedown",()=>{this._toggleSideBarAndAssistBarZIndex(!1,!1,!0,!1)}).appendTo(this._frame);this._assistantBar=new Fe(e)}this._assistantBar.activate()}else this._assistantBar&&this._assistantBar.deactivate()},qe.prototype._toggleSideBarAndAssistBarZIndex=function(e,t,n,i){gDesigner.isTouchEnabled()&&(this._leftSidebars.getHtmlElement().toggleClass("bring-to-front",e),this._rightSidebars.getHtmlElement().toggleClass("bring-to-front",t),this._assistantBar.getHtmlElement().toggleClass("bring-to-front",n),void 0!==i&&$(".g-notification-panel").toggleClass("bring-to-front",i))},qe.prototype.sendSideBarAndAssistBarToBack=function(){this._toggleSideBarAndAssistBarZIndex(!1,!1,!1)},qe.prototype.start=function(){return Promise.all([gContainer.getProperty("designer.settings").then(e=>{for(var t in e=e||{},this._settings)e.hasOwnProperty(t)||(e[t]=this._settings[t]);for(var n in this._settings=e,this._settingsLoaded=!0,this._settings)this.trigger(new k(n,void 0,this._settings[n],!0))}).catch(e=>Promise.reject(e)),gContainer.getProperty("swatches").then(e=>{if(this._swatches.global=[],this._swatches["global-linear-gradient"]=[],this._swatches["global-radial-gradient"]=[],this._swatches["global-angular-gradient"]=[],this._swatches["global-texture-pattern"]=[],this._swatches["global-noise-pattern"]=[],e)for(var t=0;t<e.length;++t){var n=r.GNode.deserialize(e[t])||r.GPattern.deserialize(e[t]),i=n instanceof r.GSwatch?n:new r.GSwatch(n);this._addGlobalSwatch(i)}this.trigger(new F("global"))}).catch(e=>Promise.reject(e))])},qe.prototype._addGlobalSwatch=function(e){var t=r.GPattern.serialize(e.getProperty("_pt"));t.startsWith("C#")||t.startsWith("Y#")?this._swatches.global.push(e):t.startsWith("L#")?this._swatches["global-linear-gradient"].push(e):t.startsWith("R#")?this._swatches["global-radial-gradient"].push(e):t.startsWith("A#")?this._swatches["global-angular-gradient"].push(e):t.startsWith("T#")?this._swatches["global-texture-pattern"].push(e):t.startsWith("N#")&&this._swatches["global-noise-pattern"].push(e)},qe.prototype.updateRecentDocumentsAction=function(){let e=[];const t=gContainer.getProperty("recent_documents"),n=gDesigner.getUser();Promise.all([t,n]).then(e=>{let[t,n]=e;return n?Promise.all([t,n,gContainer.getProperty("recent_external_".concat(n.getUID()))]):Promise.reject()}).then(t=>{let[n,i,o]=t;var r,a;if(n)for(r=0,a=n.length;r<a;++r){let t=gContainer.getStorage(),i=new t.constructor.Item(t,n[r]);e.push(i)}if(o)for(o=JSON.parse(Re.base64StringToString(o)),r=0,a=o.length;r<a;++r){let t,n=gContainer.getStorage(),i=JSON.parse(o[r]);"googledrive"===i.type&&(i.file.hasOwnProperty("version")&&delete i.file.version,t=new h.default.Item(n,i.file)),t&&e.push(t)}var s=function(){gContainer.updateRecentDocumentsAction(e)};q.getRecentStorageItems().then((async function(t){if(t.length>0)for(var n=0;n<t.length;++n)e.push(await Y.from(gDesigner.getDefaultStorage(),t[n]))})).then(s).catch(s)})},qe.prototype.removeExternalRecentFiles=function(e,t){gDesigner.getUser().then(e=>e?Promise.all([e,gContainer.getProperty("recent_external_".concat(e.getUID()))]):Promise.reject()).then(n=>{let[i,o]=n,r=o?JSON.parse(Re.base64StringToString(o)):[];r instanceof Array||(r=new Array);const a=[];for(let n=0,i=r.length;n<i;n++){let i=JSON.parse(r[n]);i&&((i.type!==e||i.file&&i.file.settings&&!i.file.settings.accountId||i.file&&i.file.settings&&i.file.settings.accountId!==t)&&a.push(JSON.stringify(i)))}r.length>0?gContainer.setProperty("recent_external_".concat(i.getUID()),Re.stringToBase64String(JSON.stringify(a))):gContainer.removeProperty("recent_external_".concat(i.getUID())),gDesigner.updateRecentDocumentsAction()})},qe.prototype.relayout=function(){if(!this._initialized)return;var e,t,n=0,i=0;e=this._getTopOffset(n,i),n=this._getLeftOffset(e),i=this._getRightOffset(e),t=this._getBottomOffset(n,i);const o=this.isTouchEnabled();this._header.relayout(),this._toolbar.relayout(),this._panels.relayout(),this._footer.relayout(),this._leftSidebars.relayout(),this._rightSidebars.relayout(),this._windows.relayout([o?0:n,e,o?0:i,t])},qe.prototype.updateCollabTextPreviews=async function(){var e,t=this.getActiveDocument();t&&((e=t.getEditor())&&e.closeInlineEditor(),await this._CDRIntegrationEngine.processCollabText(t))},qe.prototype._getTopOffset=function(e,t){var n=0,i=this.getPart(I.Info);n+=this.isPartVisible(I.Info)?i.outerHeight():0;var o=this.getPart(I.Header);o.css("top",n.toString()+"px"),n+=this.isPartVisible(I.Header)?o.outerHeight():0;var r=this.getPart(I.Toolbar);return r.css("left",e.toString()+"px"),r.css("top",n.toString()+"px"),r.css("right",t.toString()+"px"),n+=this.isPartVisible(I.Toolbar)?r.outerHeight():0},qe.prototype._getLeftOffset=function(e){var t=0,n=this._leftSidebars.getSidebar(this._leftSidebars.getActiveSidebar()),i=n?n.getMinimumWidth():0,o=this.getPart(I.LeftSidebars),r=this.isPartVisible(I.LeftSidebars);return o.outerWidth()<i&&r&&o.outerWidth(i),o.css("top",e.toString()+"px"),o.height(this._mainframe.height()-e),t+=r?o.outerWidth():0},qe.prototype._getRightOffset=function(e){var t=0,n=this._rightSidebars.getSidebar(this._rightSidebars.getActiveSidebar()),i=n?n.getMinimumWidth():0,o=this.getPart(I.RightSidebars),r=this.isPartVisible(I.RightSidebars);return o.outerWidth()<i&&r&&o.outerWidth(i),o.css("top",e.toString()+"px"),o.height(this._mainframe.height()-e),t+=r?o.outerWidth():0},qe.prototype._getBottomOffset=function(e,t){var n=0,i=this.getPart(I.Panels);i.css("left",e.toString()+"px"),i.css("width",(this._mainframe.width()-e-t).toString()+"px");var o=this.getPart(I.Footer);return o.css("left",e.toString()+"px"),o.css("width",(this._mainframe.width()-e-t).toString()+"px"),n+=this.isPartVisible(I.Panels)?i.outerHeight():0,n+=this.isPartVisible(I.Footer)?o.outerHeight():0},qe.prototype.positionIsOnCanvas=function(e,t){var n,i,o=0,r=0;return n=this._getTopOffset(o,r),o=this._getLeftOffset(n),r=this._getRightOffset(n),i=this._getBottomOffset(o,r),e>o&&e<window.innerWidth-r&&t>n&&t<window.innerHeight-i},qe.prototype.updateGEditorSceneConfigurationPaintMode=function(e){[r.GScenePaintConfiguration.PaintMode.Full,r.GScenePaintConfiguration.PaintMode.Outline,r.GScenePaintConfiguration.PaintMode.Fast].indexOf(e)<0||(o.GEditorPaintConfiguration.prototype.paintMode=e)},qe.prototype.registerShortcut=function(e,t,n,i){var s=function(e,t){return n=>{var i,a,s=this.getActiveDocument();if(s&&(i=s.getEditor())&&i.isInlineEditing()){var l=i.getCurrentInlineEditorNode();o.GElementEditor&&l instanceof r.GText&&(a=o.GElementEditor.getEditor(l))}if(!(t&&a&&a.handleKeyDown(n)&&(t||a)||!0!==e()))return n.preventDefault(),n.stopPropagation(),!1}}.bind(this),l=n?je.bindGlobal:je.bind;2===e.length&&e[0]===a.GKey.Constant.META&&"+"===e[1]?(l(this._shortcutToMouseTrapShortcut(e),s(t,!0)),l("mod+=",s(t,!0),"keydown"),i&&l("mod+=",s(i,!1),"keyup")):(l(this._shortcutToMouseTrapShortcut(e),s(t,!0),"keydown"),i&&l(this._shortcutToMouseTrapShortcut(e),s(i,!1),"keyup"))},qe.prototype._createMainMenu=function(){for(var e=[],t={items:[]},n=function(t){for(var n=0;n<e.length;++n)if(e[n].item===t)return e[n].group},i=function(t,i,o){if(t.items.length>0){var r=t.items[t.items.length-1];if(n(r)!==o){var a={type:"divider"};if("item"===r.type&&r.action){var s=function(t){for(var i=n(t),o=[],r=0;r<e.length;++r)e[r].group===i&&o.push(t);return o}(r);a.isVisible=function(){return s.some(e=>e.action.isVisible())}}t.items.push(a)}}e.push({item:i,group:o})},o=0;o<this._actions.length;++o){var a=this._actions[o];if(this._actionsMap[a.getId()]=a,!a.isAvailable())continue;let e=a.getCategory();for(var s=[e];e=e.parent;)s.push(e);s.reverse();var l=a.getGroup(),c=a.getGroupIcon(),d=(a.getStyleClass(),l?[""].concat(l.split("/")):null);if(d&&s&&s.length!==d.length-1)throw new Error("The number of categories is different than the number of groups.");var u=t;if(s)for(var p=0;p<s.length;++p){let e=s[p],t=d?d[p]:null;for(var g=null,h=e.label.split("/")[p],f=0;f<u.items.length;++f)h==u.items[f].caption&&(g=u.items[f]);g||(i(u,g={type:"menu",caption:h,items:[],icon:c,category:e},t),u.items.push(g)),u=g}var m={type:"item",action:a};i(u,m,d?d[d.length-1]:null),u.items.push(m)}var y=function(e,t){"menu"===e.type?e.menu=v(e,t):"divider"===e.type?e.separator=this.addMenuSeparator(t,e.isVisible):"item"===e.type&&(e.item=this.addMenuItem(t,r.GLocale.get(e.action.getTitle()),e.action.getIcon(),e.action.isCheckable(),e.action.getShortcut(),function(t){if("shortcut"===t)return this.executeAction(e.action.getId(),void 0,"shortcut")}.bind(this),e.action.isShortcutGlobal(),e.action.isPro(),e.action,e.action._sidebar?e.action.getStyleClass()+" hidepanel":e.action.getStyleClass(),e.action.noHover()),this.registerAdditionalShortcuts(e.action))}.bind(this),v=function(e,t){const n=e.category?t=>{t.setVisible(e.category.visible),t.setIcon(e.category.icon)}:null;for(var i=this.addMenu(t,e.caption,function(){for(var t=0;t<e.items.length;++t){var n=e.items[t];"item"===n.type&&this.updateMenuItem(n.item,r.GLocale.get(n.action.getTitle()),n.action.isEnabled(),!!n.action.isCheckable()&&n.action.isChecked(),n.action.isPro(),n.action.getId())}}.bind(this),e.icon,n),o=0;o<e.items.length;++o)y(e.items[o],i);return i}.bind(this);for(o=0;o<t.items.length;++o)g=t.items[o],v(t.items[o],null);this._mainMenu.update()},qe.prototype._workspaceResolveUrlEvent=function(e){q.resolveImage(e,this.getActiveDocument())},qe.prototype._shareEvent=function(e){e.type===le.Type.Updated&&this._updateSidebars()},qe.prototype._applicationStateChangedEvent=function(e){this._updateSidebars();const t=this.getActiveDocument();if(t&&t.getStatus()===Ae.Ready){this.getApplicationManager().isCommentingEnabled()&&this.openUserNameConfigDialog()}},qe.prototype._updateSidebars=function(){const e=this.getApplicationManager(),t=e.isInspectEnabled(),n=e.isCommentingEnabled(),i=e.isEditingEnabled();if(L.isOrientationActiveInSetting(L.Orientation.Right)){const e=this._rightSidebars.getSidebar(this._rightSidebars.getActiveSidebar());e&&e.isVisible()||(i||t?this._rightSidebars.setActiveSidebar(A.ID):n?this._rightSidebars.setActiveSidebar(T.ID):this._rightSidebars.setActiveSidebar(null)),this.setPartVisible(I.RightSidebars,n||i||t),this._rightSidebars.relayout()}if(L.isOrientationActiveInSetting(L.Orientation.Left)){const e=this._leftSidebars.getSidebar(this._leftSidebars.getActiveSidebar());e&&e.isVisible()||(t?this._leftSidebars.setActiveSidebar(G.ID):this._leftSidebars.setActiveSidebar(null)),this.setPartVisible(I.LeftSidebars,t),this._leftSidebars.relayout()}},qe.prototype._fontManagerResolveFontEvent=function(e){const t=Object.assign({},e);try{K.resolveFont(t)}catch(t){throw e.failed(),t}},qe.prototype._fontManagerQueryFontFamilyEvent=function(e){try{K.resolveQueryFontFamily(e)}catch(t){throw e.failed(),t}},qe.prototype._documentEvent=function(e){switch(e.type){case R.Type.OwnerUpdated:if(e.document){const t=e.document.getOwner();if(t){const n=e.document.isCloudFile()?e.document.getStorageItem().getFile():null,i=n?n.url_t||n.url:null,o=r.GLocale.get(new r.GLocaleKey("GDesigner","text.preview-by")).replace("%name",t.name).replace("%appname",Le.DESIGNER.TITLE);$('meta[name="description"]').attr("content",o),$('meta[property="og:title"]').attr("content",r.GLocale.get(new r.GLocaleKey("GDesigner","text.design-by")).replace("%name",t.name).replace("%appname",Le.DESIGNER.TITLE)),$('meta[property="og:description"]').attr("content",o),i&&$('meta[property="og:image"]').attr("content",i),$('meta[property="og:url"]').attr("content",location.href),$('meta[name="twitter:card"]').attr("content","summary_large_image"),$('meta[property="og:site_name"]').attr("content",Le.DESIGNER.TITLE)}}this._updateTitle({saveToSessionHistory:!1});break;case R.Type.StorageItemUpdated:this._updateTitle(),this._registerUsage(e.document);break;case R.Type.Added:this._newDocumentDialog&&this._newDocumentDialog.close()}},qe.prototype._registerUsage=function(e){const t=e.getStorageItem();t&&t.isRegistrable()&&De.usage(t.getId()).catch(e=>{console.error("gApi.usage error",e)})},qe.prototype._windowEvent=function(e){let t;switch(e.type){case x.WindowEvent.Type.Added:case x.WindowEvent.Type.Removed:this._updateTitle();break;case x.WindowEvent.Type.Activated:1===this._windows.getWindows().length&&this._updateTheme(),this.getToolManager().setView(e.window.getView()),this._leftSidebars.setView(e.window.getView()),this._rightSidebars.setView(e.window.getView()),this._updateTitle(),t=e.window.getView().getHtmlElement(),this._editorTouchHandler.activate(t);break;case x.WindowEvent.Type.Deactivated:t=e.window.getView().getHtmlElement(),this._editorTouchHandler.deactivate(t),this.getToolManager().setView(null),this._leftSidebars.setView(null),this._rightSidebars.setView(null),this._updateTitle()}},qe.prototype._sidebarEvent=function(e){e.type===L.SidebarEvent.Type.Activated&&this.relayout()},qe.prototype._settingChangedEvent=function(e){switch(e.key){case"touch":e.restoring&&e.newValue&&!this.isTouchEnabled()?this.setTouchEnabled(!1):this._updateLayout(),this._updateEditorOptions(),this._updateGTM();break;case"theme":this._setTheme(e.newValue);break;case"snap_disabled":o.GGuides.options.disabled=e.newValue;break;case"snap_zones":o.GGuides.options.zones=e.newValue;break;case"snap_guides":o.GGuides.options.guides=e.newValue;break;case"highlight_on_hover":o.GEditorOptions.highlightOnHover=e.newValue;break;case"dont_store_textpath":r.GText.dontStorePaths=e.newValue;break;case"decimals_num":r.GScene.decimalsNum=e.newValue;break;case"enable_steps_debug":o.GEditorOptions.debugTransactions=e.newValue;break;case"enable_cache":"function"==typeof gdb_loaddesign&&(r.GRendererConfig.ENABLE_CACHE=e.newValue,gDesigner.getActiveDocument()&&gDesigner.getActiveDocument().getActiveWindow()&&(gDesigner.getActiveDocument().getActiveWindow().getView().cleanCache(),gDesigner.getActiveDocument().getActiveWindow().getView().configureCache()));break;case"ui_toolbar_alignment":e.newValue?this._frame.removeClass("ui-toolbar-center"):this._frame.addClass("ui-toolbar-center")}},qe.prototype._updateGTM=async function(){const e=!!this.isTouchEnabled();Ne.updateProperty("touch",e),Ne.fireEvent(Ne.Events.SETTING_CHANGED_EVENT)},qe.prototype._updateEditorOptions=function(){this.isTouchEnabled()?this._applyTouchEditorOptions():this._applyDefaultEditorOptions();const e=this.getActiveDocument(),t=e&&e.getActiveWindow(),n=t&&t.getView();n&&a.GPlatform.scheduleFrame(()=>n.invalidate(null,!0))},qe.prototype._applyTouchEditorOptions=function(){const e=r.GPaintCanvas.getScreenDPI();o.GEditorOptions.distanceHelperBehaviour=o.GSelectTool._DistanceHelperBehaviour.Click,o.GEditorOptions.resizeHandlesInDetailMode=!1,o.GEditorOptions.rotateHandleInDetailMode=!1,o.GEditorOptions.annotationHandles.suppressRedundantCorners=!0,o.GEditorOptions.annotationHandles.gradient.size=16*e,o.GEditorOptions.annotationHandles.gradient.sizeBig=20*e,o.GEditorOptions.annotationHandles.preserveAspectRatio.side=r.GRect.Side.BOTTOM_RIGHT,o.GEditorOptions.annotationHandles.tranformBox.skew.enabled=!0,o.GEditorOptions.annotationHandles.tranformBox.rotate.enabled=!0,o.GEditorOptions.annotationHandles.preserveAspectRatio.enabled=!0,r.GPaintContext.prototype.transformBoxOutlineColor=r.GPaintContext.prototype.selectionOutlineColor,o.GTransformBox.OUTSIDE_TOLERANCE=0,o.GEditorOptions.annotPickDistance=4,o.GEditorOptions.pickDistance=20,o.GEditorOptions.annotationHandles.tranformBox.size=23*e,o.GEditorOptions.annotationHandles.tranformBox.outlineWidth=3*e,o.GEditorOptions.annotationHandles.tranformBox.pivotSize=23*e,o.GEditorOptions.annotationHandles.tranformBox.pivotOutlineWidth=3*e,o.GEditorOptions.annotationHandles.tranformBox.outsideStroke=!0,o.GEditorOptions.annotationHandles.tranformBox.shadowColor="transparent",o.GEditorOptions.rotateHandle="bottom",o.GEditorOptions.annotationHandles.rotate.size=23*e,o.GEditorOptions.annotationHandles.rotate.iconSize=23*e,o.GEditorOptions.annotationHandles.rotate.outlineWidth=e,o.GEditorOptions.annotationHandles.rotate.shadowColor="transparent",o.GEditorOptions.annotationHandles.rotate.distance=46*e,o.GEditorOptions.annotationHandles.resize.size=23*e,o.GEditorOptions.annotationHandles.resize.outlineWidth=3*e,o.GEditorOptions.annotationHandles.resize.outsideStroke=!0,o.GEditorOptions.annotationHandles.resize.shadowColor="transparent",o.GEditorOptions.annotationHandles.rectangle.size=22*e,o.GEditorOptions.annotationHandles.rectangle.outlineWidth=4*e,o.GEditorOptions.annotationHandles.rectangle.outsideStroke=!0,o.GEditorOptions.annotationHandles.rectangle.shadowColor="transparent",o.GEditorOptions.annotationHandles.rectangle.maxNumberOfDetailedSegments=1,o.GEditorOptions.annotationHandles.polygon.size=22*e,o.GEditorOptions.annotationHandles.polygon.outlineWidth=4*e,o.GEditorOptions.annotationHandles.polygon.outsideStroke=!0,o.GEditorOptions.annotationHandles.polygon.shadowColor="transparent",o.GEditorOptions.annotationHandles.polygon.maxNumberOfDetailedSegments=2,o.GEditorOptions.annotationHandles.ellipse.size=22*e,o.GEditorOptions.annotationHandles.ellipse.outlineWidth=4*e,o.GEditorOptions.annotationHandles.ellipse.outsideStroke=!0,o.GEditorOptions.annotationHandles.ellipse.shadowColor="transparent",o.GEditorOptions.annotationHandles.ellipse.maxNumberOfDetailedSegments=2,o.GEditorOptions.annotationHandles.path.node.size=20*e,o.GEditorOptions.annotationHandles.path.node.outlineWidth=2*e,o.GEditorOptions.annotationHandles.path.control.size=10*e,o.GSkewHorizontalAnnotation.setIconVisible(!0),o.GSkewVerticalAnnotation.setIconVisible(!0),o.GPreserveAspectRatioAnnotation.setIconVisible(!0),o.GRotateAnnotation.setIconVisible(!0)},qe.prototype._applyDefaultEditorOptions=function(){const e=r.GPaintCanvas.getScreenDPI();o.GEditorOptions.distanceHelperBehaviour=o.GSelectTool._DistanceHelperBehaviour.Default,o.GEditorOptions.resizeHandlesInDetailMode=!0,o.GEditorOptions.rotateHandleInDetailMode=!0,o.GEditorOptions.annotationHandles.suppressRedundantCorners=!1,o.GEditorOptions.annotationHandles.gradient.size=9*e,o.GEditorOptions.annotationHandles.gradient.sizeBig=12*e,o.GSkewHorizontalAnnotation.setIconVisible(!1),o.GSkewVerticalAnnotation.setIconVisible(!1),o.GPreserveAspectRatioAnnotation.setIconVisible(!1),o.GRotateAnnotation.setIconVisible(!1),r.GPaintContext.prototype.transformBoxOutlineColor=new r.GRGBColor([23,104,196]),o.GTransformBox.OUTSIDE_TOLERANCE=100,o.GEditorOptions.annotPickDistance=0,o.GEditorOptions.pickDistance=4,o.GEditorOptions.annotationHandles.tranformBox.size=10*e,o.GEditorOptions.annotationHandles.tranformBox.outlineWidth=null,o.GEditorOptions.annotationHandles.tranformBox.pivotSize=null,o.GEditorOptions.annotationHandles.tranformBox.pivotOutlineWidth=null,o.GEditorOptions.annotationHandles.tranformBox.outsideStroke=!1,o.GEditorOptions.annotationHandles.tranformBox.shadowColor=null,o.GEditorOptions.annotationHandles.tranformBox.skew.enabled=!1,o.GEditorOptions.annotationHandles.tranformBox.rotate.enabled=!1,o.GEditorOptions.annotationHandles.preserveAspectRatio.enabled=!1,o.GEditorOptions.rotateHandle="top",o.GEditorOptions.annotationHandles.rotate.size=10*e,o.GEditorOptions.annotationHandles.rotate.outlineWidth=null,o.GEditorOptions.annotationHandles.rotate.shadowColor=null,o.GEditorOptions.annotationHandles.rotate.distance=16*e,o.GEditorOptions.annotationHandles.resize.size=10*e,o.GEditorOptions.annotationHandles.resize.outlineWidth=null,o.GEditorOptions.annotationHandles.resize.outsideStroke=!1,o.GEditorOptions.annotationHandles.resize.shadowColor=null,o.GEditorOptions.annotationHandles.rectangle.size=8*e,o.GEditorOptions.annotationHandles.rectangle.outlineWidth=null,o.GEditorOptions.annotationHandles.rectangle.outsideStroke=!1,o.GEditorOptions.annotationHandles.rectangle.shadowColor=null,o.GEditorOptions.annotationHandles.polygon.size=8*e,o.GEditorOptions.annotationHandles.polygon.outlineWidth=null,o.GEditorOptions.annotationHandles.polygon.outsideStroke=!1,o.GEditorOptions.annotationHandles.polygon.shadowColor=null,o.GEditorOptions.annotationHandles.ellipse.size=8*e,o.GEditorOptions.annotationHandles.ellipse.outlineWidth=null,o.GEditorOptions.annotationHandles.ellipse.outsideStroke=!1,o.GEditorOptions.annotationHandles.ellipse.shadowColor=null,o.GEditorOptions.annotationHandles.path.node.size=10*e,o.GEditorOptions.annotationHandles.path.node.outlineWidth=null,o.GEditorOptions.annotationHandles.path.control.size=6*e},qe.prototype._updateLayout=function(){$("body").toggleClass("g-touch",this.isTouchEnabled()),this.isTouchEnabled()||(this._leftSidebars&&this._leftSidebars.getHtmlElement().toggleClass("bring-to-front",!1),this._rightSidebars&&this._rightSidebars.getHtmlElement().toggleClass("bring-to-front",!1),this._assistantBar&&this._assistantBar.getHtmlElement().toggleClass("bring-to-front",!1)),this._initialized&&(this._leftSidebars.getActiveSidebar()||this._leftSidebars.setActiveSidebar(G.ID),this._rightSidebars.getActiveSidebar()||this._rightSidebars.setActiveSidebar(A.ID),this._leftSidebars.setActiveTouchTool(null),this._rightSidebars.setActiveTouchTool(null),this._setActiveAssistantBar(this.isTouchEnabled())),this.relayout()},qe.prototype._setTheme=function(e){e&&"default"!==e||(e="light");var t=$('head > link[href$=".css"]'),n=t.attr("href").split(".");n[2]=e,t.attr("href",n.join(".")),$(t).load(n.join("."),function(){var t=this._windows.getWindows();l.DESIGNER.GUIDELINE_COLOR?o.GEditorOptions.guideLineColor=l.DESIGNER.GUIDELINE_COLOR:o.GEditorOptions.guideLineColor="light"===e?new r.GRGBColor([107,156,228]):new r.GRGBColor([227,0,97]),l.DESIGNER.GUIDELINEHINT_COLOR?o.GEditorOptions.guideLineHintColor=l.DESIGNER.GUIDELINEHINT_COLOR:o.GEditorOptions.guideLineHintColor="light"===e?"blue":"#F790B6",l.DESIGNER.DISTANCEHELPER_COLOR&&(o.GEditorOptions.distanceHelperColor=l.DESIGNER.DISTANCEHELPER_COLOR),l.DESIGNER.HIGHLIGHTOUTLINE_COLOR&&(r.GPaintContext.prototype.highlightOutlineColor=new r.GRGBColor([197,17,98]));for(var n=0;n<t.length;++n){var i=t[n].getView();i&&(i.setRulers(!i.hasRulers()),i.setRulers(!i.hasRulers()))}this._updateTheme()}.bind(this))},qe.prototype._updateTheme=function(){var e=this._windows.getActiveWindow();e&&e.getView()&&a.GPlatform.scheduleFrame(function(){var t=r.GRGBColor.BLACK,n=getComputedStyle(this._windows.getHtmlElement()[0]).getPropertyValue("background-color"),i=r.GRGBColor.fromCSSColor(n);if(i){var o=i.toScreen();t=(299*o[0]+587*o[1]+114*o[2])/1e3>=128?r.GRGBColor.BLACK:r.GRGBColor.WHITE}r.GPaintContext.prototype.labelColor=t,e&&e.getView()&&e.getView().invalidate()}.bind(this)),this.relayout()},qe.prototype._updateTitle=async function(){let{saveToSessionHistory:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t="";let n=Le.DESIGNER.TITLE;var i=gContainer.getRuntime()===X.Runtime.Browser||gContainer.getRuntime()===X.Runtime.PWA;i&&e&&window.history.pushState(null,"Title","/");var o=this.getWindows().getActiveWindow();if(o){t=o.getTitle()+" - ";let e=o.getDocument();if(e&&e.getOwner()&&!e.isDocumentFromTemplate()&&(n="",t=r.GLocale.get(new r.GLocaleKey("GDesigner","text.design-by")).replace("%name",e.getOwner().name).replace("%appname",Le.DESIGNER.TITLE)),i){let t=e.getStorageItem();e&&t&&(t instanceof Y.Item||t.supportsShadowFile()&&await t.getCollaborativeFile())&&(e.getStorageItem().getToken()?e.getFocusAnnotationId()?window.history.pushState(null,"Title","/?token="+t.getToken()+"&annot="+e.getFocusAnnotationId()):window.history.pushState(null,"Title","/?token="+t.getToken()):t.getId()&&(e.getFocusAnnotationId()?window.history.pushState(null,"Title","/?d="+t.getId()+"&annot="+e.getFocusAnnotationId()):window.history.pushState(null,"Title","/?d="+t.getId())))}}t+=n,document.title=(0,u.decodeHTML)(t)},qe.prototype.addNotification=function(e,t){this.hasEventListeners(ae)&&this.trigger(new ae(e,t))},qe.prototype._shortcutToMouseTrapShortcut=function(e){for(var t="",n=0;n<e.length;++n){n>0&&(t+="+");var i=e[n];if("number"==typeof i)switch(i=a.GKey.transformKey(i)){case a.GKey.Constant.SPACE:t+="space";break;case a.GKey.Constant.ENTER:t+="enter";break;case a.GKey.Constant.TAB:t+="tab";break;case a.GKey.Constant.BACKSPACE:t+="backspace";break;case a.GKey.Constant.CONTROL:t+="ctrl";break;case a.GKey.Constant.SHIFT:t+="shift";break;case a.GKey.Constant.ALT_LEFT:case a.GKey.Constant.ALT_RIGHT:t+="alt";break;case a.GKey.Constant.LEFT:t+="left";break;case a.GKey.Constant.UP:t+="up";break;case a.GKey.Constant.RIGHT:t+="right";break;case a.GKey.Constant.DOWN:t+="down";break;case a.GKey.Constant.PAGE_UP:t+="pageup";break;case a.GKey.Constant.PAGE_DOWN:t+="pagedown";break;case a.GKey.Constant.HOME:t+="home";break;case a.GKey.Constant.END:t+="end";break;case a.GKey.Constant.INSERT:t+="ins";break;case a.GKey.Constant.DELETE:t+="del";break;case a.GKey.Constant.COMMAND:t+="meta";break;case a.GKey.Constant.F1:t+="f1";break;case a.GKey.Constant.F2:t+="f2";break;case a.GKey.Constant.F3:t+="f3";break;case a.GKey.Constant.F4:t+="f4";break;case a.GKey.Constant.F5:t+="f5";break;case a.GKey.Constant.F6:t+="f6";break;case a.GKey.Constant.F7:t+="f7";break;case a.GKey.Constant.F8:t+="f8";break;case a.GKey.Constant.F9:t+="f9";break;case a.GKey.Constant.F10:t+="f10";break;case a.GKey.Constant.F11:t+="f11";break;case a.GKey.Constant.F12:t+="f12";break;default:throw new Error("Unknown key code")}else t+=i.toLowerCase()}return t},qe.prototype.isGravitIME=function(e){return e&&e.className===a.GSceneWidget.GRAVIT_IME},qe.prototype.hasModifiedDocuments=function(){for(var e=!1,t=this.getDocuments(),n=0;n<t.length;++n)if(t[n].isModified()){e=!0;break}return e},qe.prototype.getCanvasWidth=function(){return this.getWindows().getActiveWindow().getView().getWidth()-("none"!==$("#right-sidebars").css("display")?$("#right-sidebars").width():0)-("none"!==$("#left-sidebars").css("display")?$("#left-sidebars").width():0)},qe.prototype.getCanvasHeight=function(){return this.getWindows().getActiveWindow().getView().getHeight()-this.getHeader().getHeight()-this.getToolbar().getHeight()},qe.prototype.getCanvasCenter=function(){var e=r.GPaintCanvas.getScreenDPI(),t=this.getCanvasWidth()/2,n=this.getCanvasHeight()/2;return t+="none"!==$("#left-sidebars").css("display")?$("#left-sidebars").width():0,n+=this.getHeader().getHeight()+this.getToolbar().getHeight(),new r.GPoint(t*e,n*e)},qe.prototype.getStylePreview=function(e,t){return this._stylesPreview[e.getReferenceId()]?t?this._stylesPreview[e.getReferenceId()].textBitmap:this._stylesPreview[e.getReferenceId()].bitmap:this.createNewStylePreview(e,!0,t)},qe.prototype.createStyleElement=function(e,t){var n=new r.GRectangle(0,0,50,50);if(t&&$.inArray(r.GStylable.PropertySet.Text,e.getProperty("ps"))>=0){var i=new r.GText;i.setText("Ab"),i.assignStyleFrom(e),i.setProperty("_tfi","20"),i.setBounds(7,10,50,50),n.appendChild(i)}else n.assignStyleFrom(e),$.inArray(r.GStylable.PropertySet.FillPaintLayers,e.getProperty("ps"))<0&&$.inArray(r.GStylable.PropertySet.BorderPaintLayers,e.getProperty("ps"))<0&&n.getPaintLayers().appendChild(new r.GStylable.FillPaintLayer(new r.GRGBColor([235,235,235]),1));return n},qe.prototype.createNewStylePreview=function(e,t,n){var i=this.createStyleElement(e,!1),o=this.createStyleElement(e,!0);if(!gDesigner.getActiveDocument())return null;var a=gDesigner.getActiveDocument().getEditor().getSelection()||[];a.length>0&&a[0].appendChild(o);var s=i.toBitmap().toImageDataUrl(r.GBitmap.ImageType.PNG),l=o.toBitmap().toImageDataUrl(r.GBitmap.ImageType.PNG);return a.length>0&&a[0].removeChild(o),t&&(this._stylesPreview[e.getReferenceId()]={preview:i,bitmap:s,textBitmap:l}),n?l:s},qe.prototype.setVersion=function(e){this._version=e},qe.prototype.getVersion=function(){return this._version},qe.prototype.setVersionFriendlyName=function(e){this._versionFriendlyName=e},qe.prototype.getVersionFriendlyName=function(){return this._versionFriendlyName},qe.prototype.setCommitSHA=function(e){this._commitSHA=e},qe.prototype.getCommitSHA=function(){return this._commitSHA},qe.prototype.setBuildNum=function(e){this._buildNum=e},qe.prototype.getBuildNum=function(){return this._buildNum},qe.prototype.setIsBeta=function(e){this._isBeta=e},qe.prototype.isBeta=function(){return this._isBeta},qe.prototype.setStoreVendor=function(e){this._storeVendor=e},qe.prototype.getStoreVendor=function(){return this._storeVendor},qe.prototype._userLoggedEvent=function(e){let t=e.user,n=this.getHeader();if(n&&n.updateLoginInfo(t),t&&t.getUID())this.executeWhenReady(()=>{this.updateRecentDocumentsAction()}),o.GEditorOptions.userConfig={userName:t.getFullUserName(),uid:t.getUID()};else{const e=r.GLocale.get(new r.GLocaleKey("GCommonNames","text.anonymous-user")),n=t&&t.getFullUserName()||e;o.GEditorOptions.userConfig={userName:n,uid:-1}}},qe.prototype._userPropertiesChangedEvent=function(e){const{user:t}=e;t&&t.getUID()&&(o.GEditorOptions.userConfig={userName:t.getFullUserName(),uid:t.getUID()})},qe.prototype._beforeInstallUpdate=function(e){this._reloading=!0},qe.prototype._updateDataLayerWithLicenseData=function(){if(this._user&&"undefined"!=typeof dataLayer){dataLayer.push({userType:this.getSubscriberUserType()});const a=this.getLicense();var e=a.getExpirationDate()||new Date(0),t=Math.floor(e.getTime()/1e3),n=a.getCreationDate()||new Date(0),i=Math.floor(n.getTime()/1e3),o=s.DateAPI.diff(n,e),r=s.DateAPI.millisecondsToDays(o);s.DateAPI.eq(n,new Date(0))&&(i="0000000000"),s.DateAPI.eq(e,new Date(0))&&(r=0,t="0000000000"),dataLayer.push({expirationDate:t}),dataLayer.push({licenseDuration:r}),dataLayer.push({creationDate:i})}},qe.prototype._licenseChangedEvent=async function(e){e.license.isDefault()||(this._enabledSubscriptions=!0,gContainer.setProperty("enabled_subscriptions",!0)),"undefined"!=typeof dataLayer&&(this._utm&&this._utm.forEach((e,t)=>dataLayer.push({[t]:e})),this._updateDataLayerWithLicenseData(),dataLayer.push({event:"LICENSE_CHANGED_EVENT"})),e.license.isOffline()&&!this.isEnabledProFeatures("offline")&&this.reload({icon:"clock",title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-offline-title")),subtitle:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-offline-subtitle")),footer:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-offline-footer")).replace("%close",$("<span/>").addClass("link").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-offline-footer-highlight"))).prop("outerHTML")).replace("%time",5),buttons:[{label:r.GLocale.get(new r.GLocaleKey("GLocale","ok")),onclick:e=>e.gDialog("close")}],attachTimer:e=>{const t=()=>{this._reloading=!1,this.clearCountdown(e),$(window).off("online",t)};navigator.onLine&&t(),$(window).on("online",t)}}),$("body").toggleClass("pro-expired",this.isEnabledSubscriptions()&&!this.isEnabledProFeatures()).toggleClass("pro-license",this.isEnabledSubscriptions()&&this.isEnabledProFeatures()).toggleClass("pro-legacy",e.license.isLegacy()).toggleClass("pro-subscription",e.license.isPro()&&!e.license.isExpired()).toggleClass("trial-expired",e.license.isTrial()&&e.license.isExpired()),this._toggleAdditionalSubscriptionClasses(e.license),this.isEnabledProFeatures()||this.setTouchEnabled(!1)},qe.prototype._toggleAdditionalSubscriptionClasses=function(){},qe.prototype.signout=function(e,t){if(this.isEnabledSubscriptions()&&!e){if(this.getDocuments().some(e=>e.isModified()))return Q.alert(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.save-before-logging-out"))),Promise.reject(void 0)}return ve.clear(),new Promise(async(e,n)=>{await(0,u._tryAndCatch)(()=>De.signout()),this._user=null,this.hasEventListeners(oe)&&this.trigger(new oe(null)),this.isEnabledSubscriptions()&&(t||(this._reloading=!0,location.reload())),e()})},qe.prototype.isReloading=function(){return this._reloading},qe.prototype.reload=function(e){let{title:t,subtitle:n,icon:i,footer:o,buttons:r,attachTimer:a}=e;this._initialized&&(this._reloading||(this._reloading=!0,Q.custom({icon:i,title:t,subtitle:n,footer:o,buttons:r,closeCallback:()=>{const e=this.createCountdown(()=>this.signout(!0),3e5);a&&a(e)}}).css({zIndex:9999})))},qe.prototype.clearCountdown=function(e){let{timeoutID:t,intervalID:n=0}=e;n&&clearInterval(n),t&&clearInterval(t),$(".g-timer[data-interval=".concat(n,"]")).remove()},qe.prototype.createCountdown=function(e,t){let n=null;const i=s.DateAPI.addTime(new Date,t),o=setInterval(()=>{const e=i-Date.now();if(e<0)return clearInterval(o),void(n&&n.remove());const t=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3);n||(n=$("<time></time>").attr("data-interval",o).addClass("g-timer").appendTo($("body"))),n.text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.countdown-timer")).replace("%minutes",t).replace("%seconds",a))},1e3);let a=null;return e&&(a=setTimeout(e,t)),{intervalID:o,timeoutID:a}},qe.prototype.openDeactivatedUserDialog=async function(e){const t=$("<div>".concat(r.GLocale.get(new r.GLocaleKey("GDocument","text.account-deactivated")).replace("%app",Le.DESIGNER.TITLE).replace("%name",e.getFullUserName()||e.getEmail()),"</div>"));t.find("a").on("click",t=>{t.preventDefault();let n=$(t.target).closest(".g-dialog-content");return q.resendEmailConfirmation(e).then(()=>n.gDialog("close")),!1}),Q.custom({className:"g-deactivated-user-dialog",subtitle:t,icon:"email"})},qe.prototype.getSyncUser=function(){return this._user},qe.prototype.getUser=function(){return new Promise(async(e,t)=>{let n=await this.getCloudCommunicationManager().getUser();this._anonymous=!!n&&n.isAnonymous();let i=await this.isOfflineAsync();if(!n&&i){const e=ve.getUser();e&&(n=e)}if(!n||"lts"!==gDesigner.getEnv()||this.isEnabledProFeatures()){if(n&&n.reload)return this.reload({title:"We are currently doing some important maintenance work. Please save your design in the next five minutes to avoid loss of progress!"}),void e(null);if(n)if(!n||this._user&&Me.equals(this._user,n)){if(this._user&&n&&!n.isDeactivated()){const e={stats:void 0};r.GUtil.equals(Object.assign({},this._user,e),Object.assign({},n,e),!0)||this.hasEventListeners(re)&&this.trigger(new re(n))}}else"undefined"==typeof dataLayer||n.isAnonymous()||n.isDeactivated()||(dataLayer.push({userId:n.getUID()}),dataLayer.push({userEmail:n.getEmail()}),dataLayer.push({userName:n.name||""}),dataLayer.push({userLogin:n.login}),this._utm&&this._utm.forEach((e,t)=>dataLayer.push({[t]:e})),this._updateDataLayerWithLicenseData(),dataLayer.push({event:"USER_LOGGED_EVENT"})),this.hasEventListeners(oe)&&this.trigger(new oe(n));var o;this._user&&n&&this._user.getUID()===n.getUID()&&(o=this._user.stats),this._user=n,this._user&&!i&&ve.updateUser(this._user),o&&(this._user.stats=o),e(this._user)}else e(null)})},qe.prototype.stats=function(e,t,n,i){return m.default.pageStats(e,t,this._user,n,i)},qe.prototype.pageTracking=function(e,t){return m.default.pageTracking(e,t)},qe.prototype.gtmEvent=function(e,t){"undefined"!=typeof dataLayer&&(t&&t.forEach(e=>{"object"==typeof e&&dataLayer.push(e)}),dataLayer.push({event:e}))},qe.prototype.intercomStats=function(e){"function"==typeof Intercom&&Intercom("trackEvent",e)},qe.prototype.saveStats=function(){if(this._user&&this._user.stats){var e=Re.toMD5(JSON.stringify(this._user.stats||""));Ve!==e&&(De.updateUser({stats:this._user.stats}),Ve=e)}},qe.prototype.setEnv=function(e){this._env=e},qe.prototype.getEnv=function(){return this._env},qe.prototype.hasSynchronizingDocuments=function(){for(var e=!1,t=this.getDocuments(),n=0;n<t.length;++n)if(t[n].isSynchronizing()){e=!0;break}return e},qe.prototype.zoomAtViewCenter=function(e,t){var n,i,o=this.getActiveDocument();if(!o||!(i=o.getEditor().getSelectionBBox())){n=!0;var a=e.getScene();a&&(i=a.getPaintBBox())}var s=i&&!i.isEmpty()?i.getSide(r.GRect.Side.CENTER):new r.GPoint(0,0);if(n&&!e.getViewConfiguration().multiPageView){var l=e.getViewTransform().mapPoint(this.getCanvasCenter());isNaN(l.getX())||isNaN(l.getY())||(s=l)}if(e.getViewConfiguration().multiPageView){var c=e.getScene().getActivePage();c&&(s=s.add(c.getPosition(!0)))}e.zoomAtCenter(s,t)},qe.prototype.handleUnsavedDocuments=function(){return gDesigner.hasModifiedDocuments()?this.getDocuments().filter(e=>e.isModified()).reduce((e,t)=>e.then(()=>new Promise(async(e,n)=>{this.canUnloadDocument(t).then(i=>{i?e():this.executeAction(Ge.ID,[t,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{documentStatus:i=null}=t;i&&i===Ae.SaveCancelled?n(t):e()}],"unsavedhandler")}).catch(e=>{n(e)})})),Promise.resolve()):Promise.resolve()},qe.prototype.canUnloadDocument=function(e){let{changeActiveDocument:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((n,i)=>{if(!e.isModified()&&!e.isSynchronizing())return n(!0);t&&this.getActiveDocument()!==e&&this.activateDocument(e),gDesigner.canExecuteAction(Ge.ID,[e])||n(!0),Q.advanced({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.document-modified")).replace("%title",e.getTitle()),closeCallback:e=>e&&i({documentStatus:Ae.SaveCancelled}),buttons:[{label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.dont-save")),onclick:()=>{n(!0)},closeOnClick:!0,position:"left",shortcut:"n"},{label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.cancel")),onclick:()=>i({documentStatus:Ae.SaveCancelled}),closeOnClick:!0,shortcut:"esc"},{label:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.save"))+"...",onclick:()=>{n(!1)},shortcut:this._shortcutToMouseTrapShortcut(a.GKey.Constant.ENTER),highlighted:!0,closeOnClick:!0}]})})},qe.prototype.exportSwatches=function(e){for(var t=this.getAllSwatches(e),n=new r.GSwatches,i=0;i<t.length;++i){var o=t[i].clone();n.appendChild(o)}var a=pako.gzip(r.GNode.serialize(n),{level:9}),s=this.getDefaultStorage();if(s.canPromptSave())s.savePrompt(null,[{ext:"gvswatch",mime:"application/gzip"}],e=>{e.setSaveCounterMeasureEnabled(!0),e.write(a),e.setSaveCounterMeasureEnabled(!1)},null);else if(s.canDownload()){s.download("Swatches.gvswatch",e=>{e&&(e.setSaveCounterMeasureEnabled(!0),e.write(a),e.setSaveCounterMeasureEnabled(!1))})}},qe.prototype.importSwatches=function(e){var t=this.getDefaultStorage(),n=e.startsWith("document");t.openPrompt([{ext:"gvswatch",mime:"text/plain"}],t=>{t.read(t=>{try{for(var i=this.getAllSwatches(e),o=r.GNode.deserialize(pako.ungzip(t,{to:"string"})),a=[],s=o.getFirstChild();null!==s;s=s.getNext()){for(var l=!0,c=0;c<i.length;++c)if(r.GUtil.equals(s,i[c])){l=!1;break}l&&a.push(s.clone())}if(i=i.concat(a),n)this.setSwatches(e,i,!0);else{for(c=0;c<a.length;++c)this._addGlobalSwatch(a[c]);this.setSwatches(e,this._swatches[e])}}catch(e){console.warn("error importing swatches: "+e),Q.alert(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.fail-import-swatch")))}})},!1)},qe.prototype.getFontsPath=function(){return this._fontsPath},qe.prototype.calculateFontsSize=function(e){var t=this;return new Promise((function(n,i){var o={},r=function(e){return new Promise((function(n,i){var r=new XMLHttpRequest;r.open("HEAD",t.getAssetsURL()+""+e,!0),r.onload=function(){this.status>=200&&this.status<400?(o[e]=parseInt(r.getResponseHeader("Content-Length")),n()):i({status:this.status,statusText:r.statusText})},r.onerror=function(){i({status:this.status,statusText:r.statusText})},r.send()}))},a=[];e.forEach(e=>{a.push(r(e.preview));for(var t=0;t<e.fonts.length;++t)a.push(r(e.fonts[t].url))}),Promise.all(a).then(()=>{n(o)},e=>{i(e)})}))},qe.prototype.downloadFonts=function(e,t){var n=this,i=0,o={},a=Object.keys(t);if(a.length){for(var s=0,l=0;l<a.length;++l)s+=t[a[l]];i=s}$("#right-sidebars").find(".fonts-download-progress").remove();var c=$("<div/>").addClass("fonts-download-progress").append($("<span/>").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.downloading-fonts"))).addClass("info")).append($("<span/>").addClass("count").text(" (0%)")).appendTo($("#right-sidebars")),d=function(e){c.find(".info").text(r.GLocale.get(new r.GLocaleKey("GCommonNames",e?"text.fonts-downloaded":"text.error-downloading"))),c.find(".count").remove(),c.append($("<span/>").text("X").addClass("g-button").addClass("close").on("click",(function(){gDesigner.stats("font_downloaded_closebutton"),c.remove()})))};return new Promise((function(t,r){var a=[];try{var s=function(e){return new Promise((function(t,r){var a=new XMLHttpRequest;a.open("GET",n.getAssetsURL()+""+e,!0),a.responseType="blob",a.onprogress=function(t){o[e]=t.loaded,function(){let e=Object.keys(o);if(e.length){let n=0;for(var t=0;t<e.length;++t)n+=o[e[t]];let r=Math.round(n/i*100);c.find(".count").text(" ("+(r<100?r:100)+"%)")}}()},a.onload=function(){this.status>=200&&this.status<400?t({blob:a.response,url:e}):r({status:this.status,statusText:a.statusText})},a.onerror=function(){r({status:this.status,statusText:a.statusText})},a.send()}))},l=[],u=function(e){a.push(e)},p=function(){throw new Exception("error downloading fonts")};e.forEach(e=>{l.push(s(e.preview).then((function(e){u(e)})).catch(()=>{p()}));for(var t=0;t<e.fonts.length;++t)l.push(s(e.fonts[t].url).then((function(e){u(e)})).catch(e=>{console.log(e),p()}))}),Promise.all(l).then(()=>{d(!0),t(a)},e=>{console.log(e),d(!1),r()})}catch(e){console.log(e),d(!1),r()}}))},qe.prototype.showCreateAccount=function(){return this._showCreateAccount},qe.prototype.setShowCreateAccount=function(e){this._showCreateAccount=e},qe.prototype.getSignupOptions=function(){return this._signupOptions},qe.prototype.setSignupOptions=function(e){this._signupOptions=e},qe.prototype.enterpriseLoginForm=function(){return!1},qe.prototype.setEnterpriseLoginForm=function(e){},qe.prototype.runDeepLink=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.log("Called: "+e),e)try{const n=await this.getUser();if(0===e.indexOf("purchase")){let i;return t.hasOwnProperty("newuser")&&(this._showCreateAccount=!0),Le.PURCHASE.URL_TO_PRODUCT&&(i=Le.PURCHASE.URL_TO_PRODUCT[e]),i&&(Object.assign(t,{productId:i}),n?await De.updateUserSettings({subscription:{annual:{productId:i}}}):gContainer.setCookie({name:"_gproductid",value:i||"",url:De.url})),this.openPaymentDialog(null,Object.assign(t,{flow:e}))}if("login_dialog"===e)this._user||q.performLogin();else{if("confirm_email"===e){const{confirm_email:e,flow:i}=t;return this.getCloudCommunicationManager().confirmEmail(e).then(async()=>{let e=await this.getUser();e&&e.isEmailVerified()&&this.executeWhenReady(()=>{const e=this.getLicense();Q.custom({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.activating-your-account")),subtitle:(e.isPro()||e.isTrial())&&r.GLocale.get(new r.GLocaleKey("GCommonNames","text.activating-your-account-subtitle")),icon:"ok"}),i&&"confirm_email"!==i&&this.runDeepLink(i,t)})}).catch(e=>{if(!n)return Promise.reject(e);this.executeWhenReady(()=>Q.error(e))})}if("account"===e)n&&!this.isAnonymous()&&this.executeWhenReady(()=>{new be(n).open()});else if("purchases"===e){n&&await De.hasPurchases()&&this.executeWhenReady(()=>{new be(n,"purchase").open()})}else if("newuser"===e)this._showCreateAccount=!0;else if("enterprise"===e)n||(this._enterpriseLoginForm=!0);else if("reset_trial"===e){const e=()=>{De.license.resetTrial().then(()=>gDesigner.requestLicenseUpdate())};n?e():(new g.default).listen(oe).when(e=>!!e&&!!e.user).do(e)}else if("procoupon"===e)this.executeWhenReady(()=>{q.activateCoupon(t.procoupon)});else if("annot"===e)s.HAS_ANNOTATIONS&&this.executeWhenReady(()=>{const{annot:e}=t;this.setPartVisible(I.RightSidebars,!0),this._rightSidebars.setActiveSidebar(T.ID)});else if(e===X.DeepLinking.CreateShare&&"true"===t[X.DeepLinking.CreateShare])(new g.default).listen(Ee).when(()=>this._initialized).do(()=>{const e=t=>{if(t.type===le.Type.Updated){const t=this.getActiveDocument();t&&t.getStatus()===Ae.Loaded&&(t.isShareable()&&!this.getApplicationManager().isSharing()&&this.getShareManager().share(),this.removeEventListener(le,e,this))}};this.addEventListener(le,e,this)});else if(e===X.DeepLinking.ActivateTrial&&t[X.DeepLinking.ActivateTrial]){const e=t[X.DeepLinking.ActivateTrial];De.license.activateTrial(e).then(()=>me.checkLicense())}else{if(e===X.DeepLinking.SetPassword)return(new $e).execute(t);if(e===X.DeepLinking.ResetPassword)return(new Ue).execute(t);if(e===X.DeepLinking.PasswordlessToken)return(new Ke).execute(t)}}return Promise.resolve()}catch(e){return Promise.reject(e)}},qe.prototype.openProOffer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};we.openSubscriptionOffer(e)},qe.prototype.handlePROFeatureInterruption=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=$.extend({campaign:"profeature"},e),this.isAnonymous()?new ne(()=>{}).open({anonymous:!0,signup:!0,animate:!0,options:e}):this.openProOffer(e)},qe.prototype.handleShareFilePROFeatureInterruption=function(){this.handlePROFeatureInterruption({shareFile:!0})},qe.prototype._applicationStatusEvent=function(e){e.status===Ee.Status.Ready&&(this._ready=!0)},qe.prototype.executeWhenReady=function(e){return(new g.default).listen(Ee).when(()=>this._ready).do(e)},qe.prototype.isReady=function(){return this._ready},qe.prototype.isInAppPurchaseAllowed=function(){return gInAppPurchase.canMakePayments()},qe.prototype.openPaymentDialog=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return gInAppPurchase.purchase(e,t)},qe.prototype.getWebURL=function(){return gContainer.getRuntime()===X.Runtime.Browser||gContainer.getRuntime()===X.Runtime.PWA?location.origin:gDesigner.getAssetsURL()},qe.prototype.getAssetsURL=function(){return"production"===this.getEnv()?s.prodURL:this.isBeta()?s.betaURL:"lts"===this.getEnv()?s.ltsURL:"rc"===this.getEnv()?s.rcURL:"https://designer-"+this.getEnv().split(".")[0]+"."+s.domain+"/"},qe.prototype.getTabByDocument=function(e){return this.getHeader().getWindowTab(this.getWindows().getWindow(e))},qe.prototype.getOpacityIncrement=function(){return 1},qe.prototype.registerAdditionalShortcuts=function(e){var t=e.getAdditionalShortcuts();t&&t.length&&t.forEach(t=>{gDesigner.registerShortcut(t,()=>this.executeAction(e.getId(),void 0,"shortcut"),!1)})},qe.prototype.getPaste=function(){return this._paste},qe.prototype.getSubscriberUserType=function(){return this.getLicense().getSubscriberUserType()},qe.prototype.isLegacyFeature=function(e){return!!e&&Pe.includes(e)},qe.prototype.isEnabledProFeatures=function(e){if(!this.isEnabledSubscriptions())return!0;const t=this.getLicense();return!(t.isFree()||this.isAnonymous()||t.isGuest())&&(!(!t.isLegacy()||!this.isLegacyFeature(e))||!t.isExpired()&&(!t.isOffline()||!t.isOfflinePeriodExpired()))},qe.prototype.isProTooltipNeeded=function(e){const t=this.getLicense();return!(e&&this.isLegacyFeature(e)&&t.isLegacy())&&!(t.isPro()&&!t.isExpired())},qe.prototype.preInit=async function(e){const t=this;await async function(){e||(e=De.isEnabledSubscriptions());if(await e.catch(()=>!1))return t._enabledSubscriptions=!0,void gContainer.setProperty("enabled_subscriptions",t._enabledSubscriptions);t._enabledSubscriptions=await gContainer.getProperty("enabled_subscriptions").catch(()=>!1)}(),await new Promise(e=>{t._applicationManager=new ue(e)})},qe.prototype.isEnabledSubscriptions=function(){return!!this.isInAppPurchaseAllowed()||!!this._enabledSubscriptions},qe.prototype.setLicense=function(e){!e||this._license&&e.equals(this._license)||(this._license=e,this.hasEventListeners(ie)&&this.trigger(new ie(this._license))),this.updateLicenseInfo()},qe.prototype.updateLicenseInfo=async function(){let e=this._license,t=$(".license-info");const n=t.data("type");if(n&&n===e.getLicenseType()||(t.remove(),t=null),e.isFree()&&!this.isAnonymous()){if(!t&&this.getApplicationManager().isLicenseUpgradeable(e)){let{trialDays:e}=await De.getUserSettings().catch(()=>Object.create({}));("number"!=typeof e||isNaN(e))&&(e=15),t=$("<div />").addClass("license-info big").append($("<button />").addClass("g-button start-trial-now").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.start-trial-now-button")).replace("%days",e)).on("click",()=>{gDesigner.stats("license-info_click_activate-trial"),this.activateTrialLicense()})).appendTo($("#right-sidebars")),t.css("display","")}}else if(e.isTrial()||e.isExpired()&&e.isPro()){let n;if(t||(t=$("<div />").on("click",()=>{gDesigner.stats("license-info_click_purchase-pro"),this.openPaymentDialog()}).addClass("license-info").append($("<span />").addClass("countdown")).append($("<span />").addClass("buy").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.buy-now")))).appendTo($("#right-sidebars"))),e.isExpired())n=r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-".concat(e.isTrial()?"trial":"pro","-expired")));else if(e.isTrial()){let t=s.DateAPI.millisecondsToDays(s.DateAPI.diff(s.DateAPI.toUTCZone(gDesigner.now()),e.getExpirationDate()));n=t>0?r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-trial-day".concat(t>1?"s":"","-left"))).replace("%days",t):r.GLocale.get(new r.GLocaleKey("GCommonNames","text.license-trial-expires-today"))}t.css("display","").find(".countdown").text(n)}else t&&t.remove();t&&t.data("type",e.getLicenseType())},qe.prototype.getLicense=function(){return navigator.onLine?this._license||fe.newDefaultLicense():fe.newOfflineLicense()},qe.prototype.getLicenseAsync=async function(){return await this.isOfflineAsync()?fe.newOfflineLicense():this._license||fe.newDefaultLicense()},qe.prototype.activateTrialLicense=async function(){const e=async()=>{this.toggleLoading(!0);try{await De.license.activateTrial().then(()=>gDesigner.requestLicenseUpdate()).catch(e=>Q.alert(De.formatError(e)))}finally{this.toggleLoading(!1)}};gDesigner.isOffline()?_e.openUnavailableFeature(e):e()},qe.prototype.requestLicenseUpdate=function(){let{showProOfferInTrial:e=s.LICENSE.UPGRADEABLE}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ye.reset("proOfferInTrial",e?void 0:gDesigner.now()),me.checkLicense()},qe.prototype.now=function(){return new Date},qe.prototype.isOffline=function(e){if(!navigator.onLine)return He=!0,ze=Date.now(),!0;const t=e||s.OFFLINE_CHECK_MIN_WAIT;var n=!!He;if(Date.now()-ze>t){n=!1;var i=new XMLHttpRequest;i.onerror=function(){console.log("OFFLINE!!!"),n=!0};try{i.open("HEAD",De.url+"/connection/test",!1),i.withCredentials=s.CONNECTION_TEST_WITH_CREDENTIALS,i.setRequestHeader("Accept","text/plain"),i.setRequestHeader("Content-Type","text/plain"),i.send()}catch(e){n=!0}He=n}return ze=Date.now(),!navigator.onLine||n},qe.prototype.setPaintMode=function(e){var t=this.getWindows().getActiveWindow();if(t){var n=t.getView();n.getViewConfiguration().paintMode=e,a.GPlatform.scheduleFrame(()=>{n.invalidateAndResetCache(null),this.hasEventListeners(Ce)&&this.trigger(new Ce(e))})}},qe.prototype.isOfflineAsync=async function(){if(!navigator.onLine)return He=!0,ze=Date.now(),!0;var e=!!He,t=!1;if(null===We&&Date.now()-ze>3100){var n=this.getHeader();n&&n.showBusyIcon(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.checking-connectivity")));try{await(()=>new Promise((n,i)=>{let o;o=this._initialized?3e3:2e4;var r=new XMLHttpRequest;r.onerror=i=>{e=!0,t=!0,n()},r.onload=i=>{e=!1,t=!0,n()};var a=We=setTimeout(()=>{a===We&&(We=null),t||(e=!0,n())},o);try{r.open("HEAD",De.url+"/connection/test",!0),r.withCredentials=s.CONNECTION_TEST_WITH_CREDENTIALS,r.timeout=2e3,r.setRequestHeader("Accept","text/plain"),r.setRequestHeader("Content-Type","text/plain"),r.send()}catch(i){e=!0,t=!0,n()}}))()}finally{n&&n.hideBusyIcon(),He=e}}return ze=Date.now(),!navigator.onLine||e},qe.prototype.getLinkerParam=function(e){const t=window[window.GoogleAnalyticsObject];if(t){const n=t.getAll&&t.getAll();if(n)for(let t=0;t<n.length;t++){let i=n[t];if(!e||i.get("trackingId")===e)return i.get("linkerParam")}}return null},qe.prototype.isLocalhost=function(){return"localhost"===window.location.hostname},qe.prototype.getAppBaseUrl=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return y.default.getAppBaseUrl(e)},qe.prototype.setPwaEvent=function(e){if(!e||"beforeinstallprompt"!==e.type)return;if(this._pwaEvent=e,this._waitingPwaDialog&&!this._installPwaDialog&&(this.showInstallPwaDialog(this._waitingPwaDialogDarkBackground),this._waitingPwaDialog=null,this._waitingPwaDialogDarkBackground=null),window.screen.availWidth<1024)return;const t=gDesigner.now().getTime();gContainer.getProperty(N.closedInstallPWADialogDatePropName).then(e=>{e&&t-e<s.DateAPI.daysToMilliseconds(30)?gContainer.setProperty(N.installPWA3timesAWeekPropName,JSON.stringify([])):gContainer.getProperty(N.installPWA3timesAWeekPropName).then(e=>{let n,i=[];if(e&&e.length)try{n=JSON.parse(e)}catch(e){}n||(n=[]);for(let e=0,o=n.length;e<o;e++){const o=n[e];t-o<s.DateAPI.daysToMilliseconds(7)&&i.push(o)}2===i.length&&(gDesigner._ready?gDesigner.showInstallPwaDialog():this.executeWhenReady(()=>{gDesigner.showInstallPwaDialog()})),i.push(t),i.length>2&&(i=i.slice(-2)),gContainer.setProperty(N.installPWA3timesAWeekPropName,JSON.stringify(i))})})},qe.prototype.showInstallPwaDialog=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._installPwaDialog){this._shouldWaitForPWAEvent()?(this._waitingPwaDialog=!0,this._waitingPwaDialogDarkBackground=e):(this._installPwaDialog=new z(e),this._installPwaDialog.open())}},qe.prototype._shouldWaitForPWAEvent=function(){return!this.hasPwaEvent()&&!!Be.isSupported()},qe.prototype.closeInstallPwaDialog=function(){this._installPwaDialog&&(this._installPwaDialog.close(),this._installPwaDialog=null)},qe.prototype.getPwaEvent=function(){return this._pwaEvent},qe.prototype.hasPwaEvent=function(){return!!this._pwaEvent},qe.prototype.draggableItemIsDragging=function(){return this._draggableItemIsDragging},qe.prototype.setItemDraggingState=function(e){this._draggableItemIsDragging=e},e.exports=qe},function(e,t,n){"use strict";var i=n(1);e.exports=class{constructor(){this._lastMousePoint=null}init(){document.addEventListener("mousemove",this._mouseMoveEventHandler.bind(this),!0)}_mouseMoveEventHandler(e){let{pageX:t,pageY:n}=e;this._lastMousePoint=new i.GPoint(t,n)}getLastCursorPoint(){return this._lastMousePoint}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(28);t.default=class{constructor(){this._executions=[]}step(e){this._executions.push(e)}abort(){this._executions.forEach(e=>e.abort())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(14),n(63),n(9),n(129),n(261),n(29);const{isBeta:i}=n(716);var o=n(1372);let r=0,a=0;const s={pageStats:(e,t,n,l,c)=>{if(l||function(e,t,n){const i=e=>"string"==typeof e;function r(e){return(e||"").split("/").map((function(e){return function(e){if(!e)return"";let t=String(e).replace(/^(?:(?![0-9A-Za-z])[\s\S])*|(?:(?![0-9A-Za-z])[\s\S])*$/g,"$").replace(/(?:(?![0-9A-Za-z])[\s\S])+/g,"$").replace(/([a-z])([A-Z])/g,(function(e,t,n){return t+"$"+n})).toLowerCase().replace(/(\$)([0-9A-Z_a-z]?)/g,(function(e,t,n){return n.toUpperCase()}));return e.startsWith("!")&&(t="!"+t),t}(e)})).join("/")}if("undefined"==typeof _GLOBAL_GA_EVENTS)return;if(!n&&Date.now()-a<=100)return;var l=e.split("_"),c=l[0],d=l[1],u=(l[2]||"")+("string"==typeof t||"number"==typeof t||t instanceof String?":"+t:"");if("undefined"!=typeof dataLayer){var p=function(e,t,n){var a=n?n.split(":"):"",s=e,l=t,c=a[0]||"",d=a[1]||"";if(!s)return null;var u="";if(i(o[s]))u=o[s];else if(l&&i(o[s][l]))u=o[s][l];else if(l&&c&&i(o[s][l][c]))u=o[s][l][c];else{if(!(l&&c&&d&&i(o[s][l][c][d])))return null;u=o[s][l][c][d]}return(u=(u=(u=(u=u.replace("$EVENTNAME",r(s))).replace("$CATEGORY",r(l))).replace("$ACTION",r(c))).replace("$VALUE",r(d)))&&!u.startsWith("/")&&(u="/"+u),u}(c,d,u);p&&s.pageTracking(p),a=Date.now()}}(e,t),n&&(("function"==typeof gdb_loaddesign||i)&&console.log("updating stats:"+e+" value: "+(t||"null")),"undefined"!=typeof _GLOBAL_GA_EVENTS&&"undefined"!=typeof ga)){var d=n;if(!d&&n.isAnonymous()&&(d={}),d){var u=t?e+"_"+t:e;if(d.hasOwnProperty(u)&&"number"==typeof d[u]?d[u]++:d[u]=1,c||Date.now()-r>100){var p=e.split("_"),g=(p[2]||"unknown")+("string"==typeof t||"number"==typeof t||t instanceof String?":"+t:"");ga(_GLOBAL_GA_EVENTS,"event",p[0],p[1]||"unknown",g),r=Date.now()}}}},pageTracking:async function(e,t){"undefined"!=typeof _GLOBAL_GA_EVENTS&&(Date.now()-a<=100||(e.startsWith("/")||(e="/"+e),e.endsWith("/")&&(e=e.slice(0,e.length-1)),t&&(t.startsWith("/")?e+=t:e=e+"/"+t),e=s.modifyPageStatsForUserLicense(e),e=await s.modifyPageStatsForAppMode(e),("function"==typeof gdb_loaddesign||i)&&console.log("pagestats: "+e),window.ga(_GLOBAL_GA_EVENTS,"pageview",e),a=Date.now()))},modifyPageStatsForUserLicense:function(e){return e},modifyPageStatsForAppMode:function(e){return e}};var l=s;t.default=l},function(e,t,n){"use strict";e.exports={action:{nonprotriespro:{context:{"gravit-versions-history":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/ShowVersionHistory","font.import":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/AddFonts","file.export":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/AdvancedExport","file.save-as.pdf":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/300Dpi","file.export.pdf":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/AdvancedOptions","view.toggle-touch":"NonProTriesPro/MainArea/Canvas/CanvasContextMenu/TouchInterface"},menu:{"gravit-versions-history":"NonProTriesPro/MainArea/MenuBar/File/ShowVersionHistory","font.import":"NonProTriesPro/MainArea/MenuBar/FileImport/AddFonts","file.export":"NonProTriesPro/MainArea/MenuBar/FileExport/AdvancedExport","file.save-as.pdf":"NonProTriesPro/MainArea/MenuBar/FileExportPdfDocumentPdf/300Dpi","file.export.pdf":"NonProTriesPro/MainArea/MenuBar/FileExportPdfDocumentPdf/AdvancedOptions","view.toggle-touch":"NonProTriesPro/MainArea/MenuBar/View/TouchInterface"},shortcut:{"gravit-versions-history":"NonProTriesPro/MainArea/Shortcut/ShowVersionHistory","font.import":"NonProTriesPro/MainArea/Shortcut/AddFonts","file.export":"NonProTriesPro/MainArea/Shortcut/AdvancedExport","file.save-as.pdf":"NonProTriesPro/MainArea/Shortcut/300Dpi","file.export.pdf":"NonProTriesPro/MainArea/Shortcut/AdvancedOptions","view.toggle-touch":"NonProTriesPro/MainArea/Shortcut/TouchInterface"},toolbar:{"gravit-versions-history":"NonProTriesPro/MainArea/Toolbar/ShowVersionHistory","font.import":"NonProTriesPro/MainArea/Toolbar/AddFonts","file.export":"NonProTriesPro/MainArea/Toolbar/AdvancedExport","file.save-as.pdf":"NonProTriesPro/MainArea/Toolbar/300Dpi","file.export.pdf":"NonProTriesPro/MainArea/Toolbar/AdvancedOptions","view.toggle-touch":"NonProTriesPro/MainArea/Toolbar/TouchInterface"},button:{}},execute:{button:{},assistantbar:{"view.fullscreen":"Touch/MainArea/AssistantBar/ToggleFullscreen","paste.paste":"Touch/MainArea/AssistantBar/Paste","edit.delete":"Touch/MainArea/AssistantBar/Delete","edit.deselect-all":"Touch/MainArea/AssistantBar/DeselectAll","edit.select-all":"Touch/MainArea/AssistantBar/SelectAll","modify.group":"Touch/MainArea/AssistantBar/GroupSelection","modify.split":"Touch/MainArea/AssistantBar/UngroupSelection","modify.converttopath":"Touch/MainArea/AssistantBar/ConvertToPath","arrange.order.send-front":"Touch/MainArea/AssistantBar/BringToFront","arrange.order.bring-forward":"Touch/MainArea/AssistantBar/BringForward","arrange.order.send-backward":"Touch/MainArea/AssistantBar/SendBackward","arrange.order.send-back":"Touch/MainArea/AssistantBar/SendToBack","edit.copy":"Touch/MainArea/AssistantBar/Copy","edit.paste.in-place":"Touch/MainArea/AssistantBar/PasteInPlace","edit.paste.inside":"Touch/MainArea/AssistantBar/PasteInsideSelection","edit.paste.here":"Touch/MainArea/AssistantBar/PasteHere","edit.paste.style":"Touch/MainArea/AssistantBar/PasteStyle"},touchmenu:{"arrange.transform.rotate-90-left":"Touch/MainArea/ContextualMenu/Rotate90Left","arrange.transform.rotate-90-right":"Touch/MainArea/ContextualMenu/Rotate90Right","arrange.transform.flip-vertical":"Touch/MainArea/ContextualMenu/FlipVertical","arrange.transform.flip-horizontal":"Touch/MainArea/ContextualMenu/FlipHorizontal","paste.paste":"Touch/MainArea/ContextualMenu/Paste","modify.merge":"Touch/MainArea/ContextualMenu/CreateCompound","modify.converttopath":"Touch/MainArea/ContextualMenu/ConvertToPath","modify.createsymbol":"Touch/MainArea/ContextualMenu/CreateSymbol","modify.clip":"Touch/MainArea/ContextualMenu/ClipSelection","modify.mask-with-shape":"Touch/MainArea/ContextualMenu/MaskWithShape","modify.path2bmp":"Touch/MainArea/ContextualMenu/Flatten","edit.duplicate":"Touch/MainArea/ContextualMenu/Duplicate","edit.paste.in-place":"Touch/MainArea/ContextualMenu/PasteInPlace","edit.paste.inside":"Touch/MainArea/ContextualMenu/PasteInsideSelection","edit.paste.here":"Touch/MainArea/ContextualMenu/PasteHere","edit.paste.style":"Touch/MainArea/ContextualMenu/PasteStyle","modify.merge.op-1":"Touch/MainArea/ContextualMenu/Union","modify.merge.op-4":"Touch/MainArea/ContextualMenu/Subtract","modify.merge.op-3":"Touch/MainArea/ContextualMenu/Intersect","modify.merge.op-2":"Touch/MainArea/ContextualMenu/Difference","modify.vectorize":"Touch/MainArea/ContextualMenu/VectorizeBorder","modify.converttorawpath":"Touch/MainArea/ContextualMenu/ConvertToRawPath","modify.ouline":"Touch/MainArea/ContextualMenu/ConvertToOutline","modify.offset":"Touch/MainArea/ContextualMenu/ExpandShrink","modify.simplify":"Touch/MainArea/ContextualMenu/SimplifyPath","modify.join-paths":"Touch/MainArea/ContextualMenu/JoinPaths","modify.split-path":"Touch/MainArea/ContextualMenu/SplitPath","modify.split-line":"Touch/MainArea/ContextualMenu/BreakCurve","modify.detachsymbol":"Touch/MainArea/ContextualMenu/DetachSymbolInstance","modify.resetinstance":"Touch/MainArea/ContextualMenu/ResetInstance","modify.attachToPath":"Touch/MainArea/ContextualMenu/AttachTextToPath","modify.detachFromPath":"Touch/MainArea/ContextualMenu/DetachTextFromPath","edit.selectbyfonttype":"Touch/MainArea/ContextualMenu/SelectByFontType"},context:{"use-coupon-action":"MainArea/Canvas/CanvasContextMenu/UseCoupon","file.new":"MainArea/Canvas/CanvasContextMenu/NewDesign","file.open-from-template":"MainArea/Canvas/CanvasContextMenu/NewDesignFromTemplate","file.new.clipboard":"MainArea/Canvas/CanvasContextMenu/NewFromClipboard","file.open":"MainArea/Canvas/CanvasContextMenu/OpenFile","gravit-cloud.open":"MainArea/Canvas/CanvasContextMenu/OpenFromCloud","file.open-recent":"MainArea/Canvas/CanvasContextMenu/NoRecentFiles","file.save":"MainArea/Canvas/CanvasContextMenu/Save","file.save-as.gvdesign":"MainArea/Canvas/CanvasContextMenu/DownloadFile","gravit-cloud.save-as":"MainArea/Canvas/CanvasContextMenu/SaveToCloud","cloud.sync.sync-to-cloud":"MainArea/Canvas/CanvasContextMenu/SyncToCloud","cloud.sync.unsync-from-cloud":"MainArea/Canvas/CanvasContextMenu/UnsyncFromCloud","cloud.sync.info":"MainArea/Canvas/CanvasContextMenu/LastSyncedAt11197010000Am","gravit-versions-history":"Pro/MainArea/Canvas/CanvasContextMenu/ShowVersionHistory","file.save-all":"MainArea/Canvas/CanvasContextMenu/SaveAll","file.place-import":"MainArea/Canvas/CanvasContextMenu/PlaceImage","file.link-import":"MainArea/Canvas/CanvasContextMenu/LinkImage","font.import":"Pro/MainArea/Canvas/CanvasContextMenu/AddFonts","file.export":"Pro/MainArea/Canvas/CanvasContextMenu/AdvancedExport","file.save-as.png":"MainArea/Canvas/CanvasContextMenu/PngImagePng","file.save-as.jpg":"MainArea/Canvas/CanvasContextMenu/JpegImageJpg","file.save-as.svg":"MainArea/Canvas/CanvasContextMenu/ScalableVectorGraphicsSvg","file.save-as.pdf":"Pro/MainArea/Canvas/CanvasContextMenu/300Dpi","file.export.pdf":"Pro/MainArea/Canvas/CanvasContextMenu/AdvancedOptions","file.share":"MainArea/Canvas/CanvasContextMenu/ShareFile","file.print":"MainArea/Canvas/CanvasContextMenu/Print","file.quit":"MainArea/Canvas/CanvasContextMenu/Quit","edit.undo":"MainArea/Canvas/CanvasContextMenu/Undo","edit.redo":"MainArea/Canvas/CanvasContextMenu/Redo","edit.cut":"MainArea/Canvas/CanvasContextMenu/Cut","edit.copy":"MainArea/Canvas/CanvasContextMenu/Copy","paste.paste":"MainArea/Canvas/CanvasContextMenu/Paste","edit.paste.in-place":"MainArea/Canvas/CanvasContextMenu/PasteInPlace","edit.paste.inside":"MainArea/Canvas/CanvasContextMenu/PasteInsideSelection","edit.paste.here":"MainArea/Canvas/CanvasContextMenu/PasteHere","edit.paste.style":"MainArea/Canvas/CanvasContextMenu/PasteStyle","edit.paste.replace":"MainArea/Canvas/CanvasContextMenu/PasteAndReplace","edit.delete":"MainArea/Canvas/CanvasContextMenu/Delete","edit.duplicate":"MainArea/Canvas/CanvasContextMenu/Duplicate","edit.edit":"MainArea/Canvas/CanvasContextMenu/EditSelection","edit.select-all":"MainArea/Canvas/CanvasContextMenu/SelectAll","edit.deselect-all":"MainArea/Canvas/CanvasContextMenu/DeselectAll","edit.invert-selection":"MainArea/Canvas/CanvasContextMenu/InvertSelection","edit.selectbyfonttype":"MainArea/Canvas/CanvasContextMenu/SelectByFontType","edit.settings":"MainArea/Canvas/CanvasContextMenu/Settings","arrange.order.send-front":"MainArea/Canvas/CanvasContextMenu/BringToFront","arrange.order.bring-forward":"MainArea/Canvas/CanvasContextMenu/BringForward","arrange.order.send-backward":"MainArea/Canvas/CanvasContextMenu/SendBackward","arrange.order.send-back":"MainArea/Canvas/CanvasContextMenu/SendToBack","arrange.align.align-left":"MainArea/Canvas/CanvasContextMenu/AlignLeft","arrange.align.align-center":"MainArea/Canvas/CanvasContextMenu/AlignCenter","arrange.align.align-right":"MainArea/Canvas/CanvasContextMenu/AlignRight","arrange.align.align-top":"MainArea/Canvas/CanvasContextMenu/AlignTop","arrange.align.align-middle":"MainArea/Canvas/CanvasContextMenu/AlignMiddle","arrange.align.align-bottom":"MainArea/Canvas/CanvasContextMenu/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/Canvas/CanvasContextMenu/SameWidth","arrange.align.align-justify-vertical":"MainArea/Canvas/CanvasContextMenu/SameHeight","arrange.distribute.horizontal":"MainArea/Canvas/CanvasContextMenu/DistributeHorizontally","arrange.distribute.vertical":"MainArea/Canvas/CanvasContextMenu/DistributeVertically","arrange.snap-unit.full":"MainArea/Canvas/CanvasContextMenu/SnapToFullUnits","arrange.snap-unit.half":"MainArea/Canvas/CanvasContextMenu/SnapToHalfUnits","arrange.transform.rotate-45-left":"MainArea/Canvas/CanvasContextMenu/Rotate45Left","arrange.transform.rotate-90-left":"MainArea/Canvas/CanvasContextMenu/Rotate90Left","arrange.transform.rotate-180-left":"MainArea/Canvas/CanvasContextMenu/Rotate180Left","arrange.transform.rotate-45-right":"MainArea/Canvas/CanvasContextMenu/Rotate45Right","arrange.transform.rotate-90-right":"MainArea/Canvas/CanvasContextMenu/Rotate90Right","arrange.transform.rotate-180-right":"MainArea/Canvas/CanvasContextMenu/Rotate180Right","arrange.transform.flip-vertical":"MainArea/Canvas/CanvasContextMenu/FlipVertical","arrange.transform.flip-horizontal":"MainArea/Canvas/CanvasContextMenu/FlipHorizontal","modify.group":"MainArea/Canvas/CanvasContextMenu/GroupSelection","modify.merge":"MainArea/Canvas/CanvasContextMenu/CreateCompound","modify.clip":"MainArea/Canvas/CanvasContextMenu/ClipSelection","modify.split":"MainArea/Canvas/CanvasContextMenu/UngroupSelection","modify.mask-with-shape":"MainArea/Canvas/CanvasContextMenu/MaskWithShape","modify.crop":"MainArea/Canvas/CanvasContextMenu/ConfirmCropping","modify.cancel-crop":"MainArea/Canvas/CanvasContextMenu/CancelCropping","modify.merge.op-1":"MainArea/Canvas/CanvasContextMenu/Union","modify.merge.op-4":"MainArea/Canvas/CanvasContextMenu/Subtract","modify.merge.op-3":"MainArea/Canvas/CanvasContextMenu/Intersect","modify.merge.op-2":"MainArea/Canvas/CanvasContextMenu/Difference","modify.createnestedcompound":"MainArea/Canvas/CanvasContextMenu/CreateNestedCompound","modify.join-paths":"MainArea/Canvas/CanvasContextMenu/JoinPaths","modify.split-path":"MainArea/Canvas/CanvasContextMenu/SplitPath","modify.converttopath":"MainArea/Canvas/CanvasContextMenu/ConvertToPath","modify.converttorawpath":"MainArea/Canvas/CanvasContextMenu/ConvertToRawPath","modify.ouline":"MainArea/Canvas/CanvasContextMenu/ConvertToOutline","modify.offset":"MainArea/Canvas/CanvasContextMenu/ExpandShrink","modify.vectorize":"MainArea/Canvas/CanvasContextMenu/VectorizeBorder","modify.bmp2path":"MainArea/Canvas/CanvasContextMenu/VectorizeImage","modify.attachToPath":"MainArea/Canvas/CanvasContextMenu/AttachTextToPath","modify.detachFromPath":"MainArea/Canvas/CanvasContextMenu/DetachTextFromPath","modify.simplify":"MainArea/Canvas/CanvasContextMenu/SimplifyPath","modify.connect-lines":"MainArea/Canvas/CanvasContextMenu/ConnectPathsLines","modify.split-line":"MainArea/Canvas/CanvasContextMenu/BreakCurve","modify.reverse-order":"MainArea/Canvas/CanvasContextMenu/ReverseOrder","modify.createsymbol":"MainArea/Canvas/CanvasContextMenu/CreateSymbol","modify.detachsymbol":"MainArea/Canvas/CanvasContextMenu/DetachSymbolInstance","modify.resetinstance":"MainArea/Canvas/CanvasContextMenu/ResetInstance","modify.path2bmp":"MainArea/Canvas/CanvasContextMenu/Flatten","view.zoom.original":"MainArea/Canvas/CanvasContextMenu/OriginalView","view.zoom.fit-selection":"MainArea/Canvas/CanvasContextMenu/FitSelection","view.zoom.fit-current-layer":"MainArea/Canvas/CanvasContextMenu/FitLayer","view.zoom.fit.all":"MainArea/Canvas/CanvasContextMenu/FitAll","view.magnification.6":"MainArea/Canvas/CanvasContextMenu/6","view.magnification.12":"MainArea/Canvas/CanvasContextMenu/12","view.magnification.25":"MainArea/Canvas/CanvasContextMenu/25","view.magnification.50":"MainArea/Canvas/CanvasContextMenu/50","view.magnification.66":"MainArea/Canvas/CanvasContextMenu/66","view.magnification.100":"MainArea/Canvas/CanvasContextMenu/100","view.magnification.150":"MainArea/Canvas/CanvasContextMenu/150","view.magnification.200":"MainArea/Canvas/CanvasContextMenu/200","view.magnification.300":"MainArea/Canvas/CanvasContextMenu/300","view.magnification.400":"MainArea/Canvas/CanvasContextMenu/400","view.magnification.800":"MainArea/Canvas/CanvasContextMenu/800","view.magnification.1600":"MainArea/Canvas/CanvasContextMenu/1600","view.magnification.3200":"MainArea/Canvas/CanvasContextMenu/3200","view.magnification.6400":"MainArea/Canvas/CanvasContextMenu/6400","view.magnification.12800":"MainArea/Canvas/CanvasContextMenu/12800","view.magnification.25600":"MainArea/Canvas/CanvasContextMenu/25600","view.zoom.in":"MainArea/Canvas/CanvasContextMenu/ZoomIn","zoom.out":"MainArea/Canvas/CanvasContextMenu/ZoomOut","view.outline-view":"MainArea/Canvas/CanvasContextMenu/OutlineView","view.fast-view":"MainArea/Canvas/CanvasContextMenu/FastView","view.canvas.show-rulers":"MainArea/Canvas/CanvasContextMenu/ShowRulers","view.canvas.show-guide-lines":"MainArea/Canvas/CanvasContextMenu/ShowGuideLines","view.canvas.show-symbol-labels":"MainArea/Canvas/CanvasContextMenu/ShowSymbolLabels","view.canvas.show-grid":"MainArea/Canvas/CanvasContextMenu/ShowGrid","view.canvas.show-slices":"MainArea/Canvas/CanvasContextMenu/ShowSlices","view.canvas.show-effects":"MainArea/Canvas/CanvasContextMenu/ShowEffects","view.toggle-snap":"MainArea/Canvas/CanvasContextMenu/UseSnapping","view.toggle-snapzones":"MainArea/Canvas/CanvasContextMenu/UseSnapZones","view.toggle-guide.guide.grid":"MainArea/Canvas/CanvasContextMenu/SnapToGrid","view.toggle-guide.guide.guide-lines":"MainArea/Canvas/CanvasContextMenu/SnapToGuideLines","view.toggle-guide.guide.full-pixels":"MainArea/Canvas/CanvasContextMenu/SnapToFullPixels","view.toggle-guide.guide.points":"MainArea/Canvas/CanvasContextMenu/SnapToAnchorPoints","view.toggle-guide.guide.bbox":"MainArea/Canvas/CanvasContextMenu/SnapToShapes","view.toggle-guide.guide.scene":"MainArea/Canvas/CanvasContextMenu/SnapToPages","view.toggle-sidebar.inspector":"MainArea/Canvas/CanvasContextMenu/ShowInspectorPanel","view.toggle-sidebar.outline":"MainArea/Canvas/CanvasContextMenu/ShowLayersPanel","view.toggle-sidebar.library":"MainArea/Canvas/CanvasContextMenu/ShowLibrariesPanel","view.toggle-sidebar.symbols":"MainArea/Canvas/CanvasContextMenu/ShowSymbolsPanel","view.clone":"MainArea/Canvas/CanvasContextMenu/NewView","view.play":"MainArea/Canvas/CanvasContextMenu/PlayPresent","view.fullscreen":"MainArea/Canvas/CanvasContextMenu/ToggleFullscreen","open-link.contact-us":"MainArea/Canvas/CanvasContextMenu/ContactUs","open-link.user-guide":"MainArea/Canvas/CanvasContextMenu/UserGuide","open-link.tutorials":"MainArea/Canvas/CanvasContextMenu/Tutorials","open-link.changelog":"MainArea/Canvas/CanvasContextMenu/WhatSNew","open-link.blog":"MainArea/Canvas/CanvasContextMenu/Blog","language.0":"MainArea/Canvas/CanvasContextMenu/English","language.1":"MainArea/Canvas/CanvasContextMenu/Deutsch","language.2":"MainArea/Canvas/CanvasContextMenu/中文","language.3":"MainArea/Canvas/CanvasContextMenu/Português","language.4":"MainArea/Canvas/CanvasContextMenu/Español","language.5":"MainArea/Canvas/CanvasContextMenu/Français","language.6":"MainArea/Canvas/CanvasContextMenu/Polski","language.7":"MainArea/Canvas/CanvasContextMenu/Русский","language.8":"MainArea/Canvas/CanvasContextMenu/Türkçe","language.9":"MainArea/Canvas/CanvasContextMenu/Čeština","language.10":"MainArea/Canvas/CanvasContextMenu/繁體中文","language.11":"MainArea/Canvas/CanvasContextMenu/Italiano","language.12":"MainArea/Canvas/CanvasContextMenu/日本語","language.13":"MainArea/Canvas/CanvasContextMenu/Nederlands","open-welcome-screen":"MainArea/Canvas/CanvasContextMenu/ShowWelcomeScreen","check-for-updates":"MainArea/Canvas/CanvasContextMenu/CheckForUpdates","developer-details":"MainArea/Canvas/CanvasContextMenu/SendDeveloperDetails","help.purchase":"MainArea/Canvas/CanvasContextMenu/PurchasePro","example-files":"MainArea/Canvas/CanvasContextMenu/ExploreExampleFiles"},menu:{"use-coupon-action":"MainArea/MenuBar/Help/UseCoupon","file.new":"MainArea/MenuBar/File/NewDesign","file.open-from-template":"MainArea/MenuBar/File/NewDesignFromTemplate","file.new.clipboard":"MainArea/MenuBar/File/NewFromClipboard","file.open":"MainArea/MenuBar/File/OpenFile","gravit-cloud.open":"MainArea/MenuBar/File/OpenFromCloud","file.open-recent":"MainArea/MenuBar/FileOpenRecent/NoRecentFiles","file.save":"MainArea/MenuBar/File/Save","file.save-as.gvdesign":"MainArea/MenuBar/File/DownloadFile","gravit-cloud.save-as":"MainArea/MenuBar/File/SaveToCloud","cloud.sync.sync-to-cloud":"MainArea/MenuBar/File/SyncToCloud","cloud.sync.unsync-from-cloud":"MainArea/MenuBar/File/UnsyncFromCloud","cloud.sync.info":"MainArea/MenuBar/File/LastSyncedAt11197010000Am","gravit-versions-history":"Pro/MainArea/MenuBar/File/ShowVersionHistory","file.save-all":"MainArea/MenuBar/File/SaveAll","file.place-import":"MainArea/MenuBar/FileImport/PlaceImage","file.link-import":"MainArea/MenuBar/FileImport/LinkImage","font.import":"Pro/MainArea/MenuBar/FileImport/AddFonts","file.export":"Pro/MainArea/MenuBar/FileExport/AdvancedExport","file.save-as.png":"MainArea/MenuBar/FileExport/PngImagePng","file.save-as.jpg":"MainArea/MenuBar/FileExport/JpegImageJpg","file.save-as.svg":"MainArea/MenuBar/FileExport/ScalableVectorGraphicsSvg","file.save-as.pdf":"Pro/MainArea/MenuBar/FileExportPdfDocumentPdf/300Dpi","file.export.pdf":"Pro/MainArea/MenuBar/FileExportPdfDocumentPdf/AdvancedOptions","file.share":"MainArea/MenuBar/File/ShareFile","file.share.opensharedfile":"MainArea/MenuBar/File/ShareFile/OpenSharedFile","file.print":"MainArea/MenuBar/File/Print","file.quit":"MainArea/MenuBar/File/Quit","edit.undo":"MainArea/MenuBar/Edit/Undo","edit.redo":"MainArea/MenuBar/Edit/Redo","edit.cut":"MainArea/MenuBar/Edit/Cut","edit.copy":"MainArea/MenuBar/Edit/Copy","paste.paste":"MainArea/MenuBar/EditPaste/Paste","edit.paste.in-place":"MainArea/MenuBar/EditPaste/PasteInPlace","edit.paste.inside":"MainArea/MenuBar/EditPaste/PasteInsideSelection","edit.paste.here":"MainArea/MenuBar//PasteHere","edit.paste.style":"MainArea/MenuBar/EditPaste/PasteStyle","edit.paste.replace":"MainArea/MenuBar/EditPaste/PasteAndReplace","edit.delete":"MainArea/MenuBar/Edit/Delete","edit.duplicate":"MainArea/MenuBar/Edit/Duplicate","edit.edit":"MainArea/MenuBar/Edit/EditSelection","edit.select-all":"MainArea/MenuBar/Edit/SelectAll","edit.deselect-all":"MainArea/MenuBar/Edit/DeselectAll","edit.invert-selection":"MainArea/MenuBar/Edit/InvertSelection","edit.selectbyfonttype":"MainArea/MenuBar/Edit/SelectByFontType","edit.settings":"MainArea/MenuBar/Edit/Settings","arrange.order.send-front":"MainArea/MenuBar/ModifyArrange/BringToFront","arrange.order.bring-forward":"MainArea/MenuBar/ModifyArrange/BringForward","arrange.order.send-backward":"MainArea/MenuBar/ModifyArrange/SendBackward","arrange.order.send-back":"MainArea/MenuBar/ModifyArrange/SendToBack","arrange.align.align-left":"MainArea/MenuBar/ModifyAlign/AlignLeft","arrange.align.align-center":"MainArea/MenuBar/ModifyAlign/AlignCenter","arrange.align.align-right":"MainArea/MenuBar/ModifyAlign/AlignRight","arrange.align.align-top":"MainArea/MenuBar/ModifyAlign/AlignTop","arrange.align.align-middle":"MainArea/MenuBar/ModifyAlign/AlignMiddle","arrange.align.align-bottom":"MainArea/MenuBar/ModifyAlign/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/MenuBar/ModifyAlign/SameWidth","arrange.align.align-justify-vertical":"MainArea/MenuBar/ModifyAlign/SameHeight","arrange.distribute.horizontal":"MainArea/MenuBar/ModifyAlign/DistributeHorizontally","arrange.distribute.vertical":"MainArea/MenuBar/ModifyAlign/DistributeVertically","arrange.snap-unit.full":"MainArea/MenuBar/ModifyAlign/SnapToFullUnits","arrange.snap-unit.half":"MainArea/MenuBar/ModifyAlign/SnapToHalfUnits","arrange.transform.rotate-45-left":"MainArea/MenuBar/ModifyTransform/Rotate45Left","arrange.transform.rotate-90-left":"MainArea/MenuBar/ModifyTransform/Rotate90Left","arrange.transform.rotate-180-left":"MainArea/MenuBar/ModifyTransform/Rotate180Left","arrange.transform.rotate-45-right":"MainArea/MenuBar/ModifyTransform/Rotate45Right","arrange.transform.rotate-90-right":"MainArea/MenuBar/ModifyTransform/Rotate90Right","arrange.transform.rotate-180-right":"MainArea/MenuBar/ModifyTransform/Rotate180Right","arrange.transform.flip-vertical":"MainArea/MenuBar/ModifyTransform/FlipVertical","arrange.transform.flip-horizontal":"MainArea/MenuBar/ModifyTransform/FlipHorizontal","modify.group":"MainArea/MenuBar/Modify/GroupSelection","modify.merge":"MainArea/MenuBar/Modify/CreateCompound","modify.clip":"MainArea/MenuBar/Modify/ClipSelection","modify.split":"MainArea/MenuBar/Modify/UngroupSelection","modify.mask-with-shape":"MainArea/MenuBar/Modify/MaskWithShape","modify.crop":"MainArea/MenuBar/Modify/ConfirmCropping","modify.cancel-crop":"MainArea/MenuBar/Modify/CancelCropping","modify.merge.op-1":"MainArea/MenuBar/ModifyCreateCompoundShape/Union","modify.merge.op-4":"MainArea/MenuBar/ModifyCreateCompoundShape/Subtract","modify.merge.op-3":"MainArea/MenuBar/ModifyCreateCompoundShape/Intersect","modify.merge.op-2":"MainArea/MenuBar/ModifyCreateCompoundShape/Difference","modify.createnestedcompound":"MainArea/MenuBar/Modify/CreateNestedCompound","modify.join-paths":"MainArea/MenuBar/ModifyPath/JoinPaths","modify.split-path":"MainArea/MenuBar/ModifyPath/SplitPath","modify.converttopath":"MainArea/MenuBar/ModifyPath/ConvertToPath","modify.converttorawpath":"MainArea/MenuBar/ModifyPath/ConvertToRawPath","modify.ouline":"MainArea/MenuBar/ModifyPath/ConvertToOutline","modify.offset":"MainArea/MenuBar/ModifyPath/ExpandShrink","modify.vectorize":"MainArea/MenuBar/ModifyPath/VectorizeBorder","modify.bmp2path":"MainArea/MenuBar/ModifyPath/VectorizeImage","modify.attachToPath":"MainArea/MenuBar/ModifyPath/AttachTextToPath","modify.detachFromPath":"MainArea/MenuBar/ModifyPath/DetachTextFromPath","modify.simplify":"MainArea/MenuBar/ModifyPath/SimplifyPath","modify.connect-lines":"MainArea/MenuBar/ModifyPath/ConnectPathsLines","modify.split-line":"MainArea/MenuBar/ModifyPath/BreakCurve","modify.reverse-order":"MainArea/MenuBar/ModifyPath/ReverseOrder","modify.createsymbol":"MainArea/MenuBar/ModifySymbol/CreateSymbol","modify.detachsymbol":"MainArea/MenuBar/ModifySymbol/DetachSymbolInstance","modify.resetinstance":"MainArea/MenuBar/ModifySymbol/ResetInstance","modify.path2bmp":"MainArea/MenuBar/Modify/Flatten","view.zoom.original":"MainArea/MenuBar/View/OriginalView","view.zoom.fit-selection":"MainArea/MenuBar/View/FitSelection","view.zoom.fit-current-layer":"MainArea/MenuBar/View/FitLayer","view.zoom.fit.all":"MainArea/MenuBar/View/FitAll","view.magnification.6":"MainArea/MenuBar/ViewMagnification/6","view.magnification.12":"MainArea/MenuBar/ViewMagnification/12","view.magnification.25":"MainArea/MenuBar/ViewMagnification/25","view.magnification.50":"MainArea/MenuBar/ViewMagnification/50","view.magnification.66":"MainArea/MenuBar/ViewMagnification/66","view.magnification.100":"MainArea/MenuBar/ViewMagnification/100","view.magnification.150":"MainArea/MenuBar/ViewMagnification/150","view.magnification.200":"MainArea/MenuBar/ViewMagnification/200","view.magnification.300":"MainArea/MenuBar/ViewMagnification/300","view.magnification.400":"MainArea/MenuBar/ViewMagnification/400","view.magnification.800":"MainArea/MenuBar/ViewMagnification/800","view.magnification.1600":"MainArea/MenuBar/ViewMagnification/1600","view.magnification.3200":"MainArea/MenuBar/ViewMagnification/3200","view.magnification.6400":"MainArea/MenuBar/ViewMagnification/6400","view.magnification.12800":"MainArea/MenuBar/ViewMagnification/12800","view.magnification.25600":"MainArea/MenuBar/ViewMagnification/25600","view.zoom.in":"MainArea/MenuBar/ViewMagnification/ZoomIn","zoom.out":"MainArea/MenuBar/ViewMagnification/ZoomOut","view.outline-view":"MainArea/MenuBar/View/OutlineView","view.fast-view":"MainArea/MenuBar/View/FastView","view.canvas.show-rulers":"MainArea/MenuBar/ViewCanvas/ShowRulers","view.canvas.show-guide-lines":"MainArea/MenuBar/ViewCanvas/ShowGuideLines","view.canvas.show-symbol-labels":"MainArea/MenuBar/ViewCanvas/ShowSymbolLabels","view.canvas.show-grid":"MainArea/MenuBar/ViewCanvas/ShowGrid","view.canvas.show-slices":"MainArea/MenuBar/ViewCanvas/ShowSlices","view.canvas.show-effects":"MainArea/MenuBar/ViewCanvas/ShowEffects","view.toggle-snap":"MainArea/MenuBar/ViewSnapTo/UseSnapping","view.toggle-snapzones":"MainArea/MenuBar/ViewSnapTo/UseSnapZones","view.toggle-guide.guide.grid":"MainArea/MenuBar/ViewSnapTo/SnapToGrid","view.toggle-guide.guide.guide-lines":"MainArea/MenuBar/ViewSnapTo/SnapToGuideLines","view.toggle-guide.guide.full-pixels":"MainArea/MenuBar/ViewSnapTo/SnapToFullPixels","view.toggle-guide.guide.points":"MainArea/MenuBar/ViewSnapTo/SnapToAnchorPoints","view.toggle-guide.guide.bbox":"MainArea/MenuBar/ViewSnapTo/SnapToShapes","view.toggle-guide.guide.scene":"MainArea/MenuBar/ViewSnapTo/SnapToPages","view.toggle-sidebar.inspector":"MainArea/MenuBar/View/ShowInspectorPanel","view.toggle-sidebar.outline":"MainArea/MenuBar/View/ShowLayersPanel","view.toggle-sidebar.library":"MainArea/MenuBar/View/ShowLibrariesPanel","view.toggle-sidebar.symbols":"MainArea/MenuBar/View/ShowSymbolsPanel","view.clone":"MainArea/MenuBar/View/NewView","view.play":"MainArea/MenuBar/View/PlayPresent","view.fullscreen":"MainArea/MenuBar/View/ToggleFullscreen","open-link.contact-us":"MainArea/MenuBar/HelpSupport/ContactUs","open-link.user-guide":"MainArea/MenuBar/HelpLearn/UserGuide","open-link.tutorials":"MainArea/MenuBar/HelpLearn/Tutorials","open-link.changelog":"MainArea/MenuBar/Help/WhatSNew","open-link.blog":"MainArea/MenuBar/HelpLearn/Blog","language.0":"MainArea/MenuBar/HelpLanguage/English","language.1":"MainArea/MenuBar/HelpLanguage/Deutsch","language.2":"MainArea/MenuBar/HelpLanguage/中文","language.3":"MainArea/MenuBar/HelpLanguage/Português","language.4":"MainArea/MenuBar/HelpLanguage/Español","language.5":"MainArea/MenuBar/HelpLanguage/Français","language.6":"MainArea/MenuBar/HelpLanguage/Polski","language.7":"MainArea/MenuBar/HelpLanguage/Русский","language.8":"MainArea/MenuBar/HelpLanguage/Türkçe","language.9":"MainArea/MenuBar/HelpLanguage/Čeština","language.10":"MainArea/MenuBar/HelpLanguage/繁體中文","language.11":"MainArea/MenuBar/HelpLanguage/Italiano","language.12":"MainArea/MenuBar/HelpLanguage/日本語","language.13":"MainArea/MenuBar/HelpLanguage/Nederlands","open-welcome-screen":"MainArea/MenuBar/Help/ShowWelcomeScreen","check-for-updates":"MainArea/MenuBar/Help/CheckForUpdates","developer-details":"MainArea/MenuBar/HelpSupport/SendDeveloperDetails","help.purchase":"MainArea/MenuBar/Help/PurchasePro","example-files":"MainArea/MenuBar/HelpLearn/ExploreExampleFiles","help.tooltip-visibility":"MainArea/MenuBar/HelpLearn/DisplayEnhancedTooltips","help.tooltip-visibility.on":"MainArea/MenuBar/HelpLearn/DisplayEnhancedTooltips/SwitchOn","help.tooltip-visibility.off":"MainArea/MenuBar/HelpLearn/DisplayEnhancedTooltips/SwitchOff","view.toggle-touch.on":"MainArea/MenuBar/View/TouchInterface","view.toggle-touch.off":"MainArea/MenuBar/View/DisableTouchInterface"},shortcut:{"use-coupon-action":"MainArea/Shortcut/UseCoupon","file.new":"MainArea/Shortcut/NewDesign","file.open-from-template":"MainArea/Shortcut/NewDesignFromTemplate","file.new.clipboard":"MainArea/Shortcut/NewFromClipboard","file.open":"MainArea/Shortcut/OpenFile","gravit-cloud.open":"MainArea/Shortcut/OpenFromCloud","file.open-recent":"MainArea/Shortcut/NoRecentFiles","file.save":"MainArea/Shortcut/Save","file.save-as.gvdesign":"MainArea/Shortcut/DownloadFile","gravit-cloud.save-as":"MainArea/Shortcut/SaveToCloud","cloud.sync.sync-to-cloud":"MainArea/Shortcut/SyncToCloud","cloud.sync.unsync-from-cloud":"MainArea/Shortcut/UnsyncFromCloud","cloud.sync.info":"MainArea/Shortcut/LastSyncedAt11197010000Am","gravit-versions-history":"Pro/MainArea/Shortcut/ShowVersionHistory","file.save-all":"MainArea/Shortcut/SaveAll","file.place-import":"MainArea/Shortcut/PlaceImage","file.link-import":"MainArea/Shortcut/LinkImage","font.import":"Pro/MainArea/Shortcut/AddFonts","file.export":"Pro/MainArea/Shortcut/AdvancedExport","file.save-as.png":"MainArea/Shortcut/PngImagePng","file.save-as.jpg":"MainArea/Shortcut/JpegImageJpg","file.save-as.svg":"MainArea/Shortcut/ScalableVectorGraphicsSvg","file.save-as.pdf":"Pro/MainArea/Shortcut/300Dpi","file.export.pdf":"Pro/MainArea/Shortcut/AdvancedOptions","file.share":"MainArea/Shortcut/ShareFile","file.print":"MainArea/Shortcut/Print","file.quit":"MainArea/Shortcut/Quit","file.close-active-window":"MainArea/Shortcut/CloseActiveWindow","edit.undo":"MainArea/Shortcut/Undo","edit.redo":"MainArea/Shortcut/Redo","edit.cut":"MainArea/Shortcut/Cut","edit.copy":"MainArea/Shortcut/Copy","paste.paste":"MainArea/Shortcut/Paste","edit.paste.in-place":"MainArea/Shortcut/PasteInPlace","edit.paste.inside":"MainArea/Shortcut/PasteInsideSelection","edit.paste.here":"MainArea/Shortcut/PasteHere","edit.paste.style":"MainArea/Shortcut/PasteStyle","edit.paste.replace":"MainArea/Shortcut/PasteAndReplace","edit.delete":"MainArea/Shortcut/Delete","edit.duplicate":"MainArea/Shortcut/Duplicate","edit.edit":"MainArea/Shortcut/EditSelection","edit.select-all":"MainArea/Shortcut/SelectAll","edit.deselect-all":"MainArea/Shortcut/DeselectAll","edit.invert-selection":"MainArea/Shortcut/InvertSelection","edit.selectbyfonttype":"MainArea/Shortcut/SelectByFontType","edit.settings":"MainArea/Shortcut/Settings","edit.eyedropper.fill":"MainArea/Shortcut/OpenFillEyeDropper","edit.eyedropper.border":"MainArea/Shortcut/OpenBorderEyeDropper","edit.eyedropper.text":"MainArea/Shortcut/OpenTextEyeDropper","edit.rename-layer":"MainArea/Toolbar/RenameLayer","edit.change-opacity":"MainArea/Toolbar/ChangeOpacity","arrange.order.send-front":"MainArea/Shortcut/BringToFront","arrange.order.bring-forward":"MainArea/Shortcut/BringForward","arrange.order.send-backward":"MainArea/Shortcut/SendBackward","arrange.order.send-back":"MainArea/Shortcut/SendToBack","arrange.align.align-left":"MainArea/Shortcut/AlignLeft","arrange.align.align-center":"MainArea/Shortcut/AlignCenter","arrange.align.align-right":"MainArea/Shortcut/AlignRight","arrange.align.align-top":"MainArea/Shortcut/AlignTop","arrange.align.align-middle":"MainArea/Shortcut/AlignMiddle","arrange.align.align-bottom":"MainArea/Shortcut/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/Shortcut/SameWidth","arrange.align.align-justify-vertical":"MainArea/Shortcut/SameHeight","arrange.distribute.horizontal":"MainArea/Shortcut/DistributeHorizontally","arrange.distribute.vertical":"MainArea/Shortcut/DistributeVertically","arrange.snap-unit.full":"MainArea/Shortcut/SnapToFullUnits","arrange.snap-unit.half":"MainArea/Shortcut/SnapToHalfUnits","arrange.transform.rotate-45-left":"MainArea/Shortcut/Rotate45Left","arrange.transform.rotate-90-left":"MainArea/Shortcut/Rotate90Left","arrange.transform.rotate-180-left":"MainArea/Shortcut/Rotate180Left","arrange.transform.rotate-45-right":"MainArea/Shortcut/Rotate45Right","arrange.transform.rotate-90-right":"MainArea/Shortcut/Rotate90Right","arrange.transform.rotate-180-right":"MainArea/Shortcut/Rotate180Right","arrange.transform.flip-vertical":"MainArea/Shortcut/FlipVertical","arrange.transform.flip-horizontal":"MainArea/Shortcut/FlipHorizontal","modify.group":"MainArea/Shortcut/GroupSelection","modify.merge":"MainArea/Shortcut/CreateCompound","modify.clip":"MainArea/Shortcut/ClipSelection","modify.split":"MainArea/Shortcut/UngroupSelection","modify.mask-with-shape":"MainArea/Shortcut/MaskWithShape","modify.crop":"MainArea/Shortcut/ConfirmCropping","modify.cancel-crop":"MainArea/Shortcut/CancelCropping","modify.merge.op-1":"MainArea/Shortcut/Union","modify.merge.op-4":"MainArea/Shortcut/Subtract","modify.merge.op-3":"MainArea/Shortcut/Intersect","modify.merge.op-2":"MainArea/Shortcut/Difference","modify.createnestedcompound":"MainArea/Shortcut/CreateNestedCompound","modify.join-paths":"MainArea/Shortcut/JoinPaths","modify.split-path":"MainArea/Shortcut/SplitPath","modify.converttopath":"MainArea/Shortcut/ConvertToPath","modify.converttorawpath":"MainArea/Shortcut/ConvertToRawPath","modify.ouline":"MainArea/Shortcut/ConvertToOutline","modify.offset":"MainArea/Shortcut/ExpandShrink","modify.vectorize":"MainArea/Shortcut/VectorizeBorder","modify.bmp2path":"MainArea/Shortcut/VectorizeImage","modify.attachToPath":"MainArea/Shortcut/AttachTextToPath","modify.detachFromPath":"MainArea/Shortcut/DetachTextFromPath","modify.simplify":"MainArea/Shortcut/SimplifyPath","modify.connect-lines":"MainArea/Shortcut/ConnectPathsLines","modify.split-line":"MainArea/Shortcut/BreakCurve","modify.reverse-order":"MainArea/Shortcut/ReverseOrder","modify.createsymbol":"MainArea/Shortcut/CreateSymbol","modify.detachsymbol":"MainArea/Shortcut/DetachSymbolInstance","modify.resetinstance":"MainArea/Shortcut/ResetInstance","modify.path2bmp":"MainArea/Shortcut/Flatten","modify.lock-layer":"MainArea/Shortcut/LockLayer","modify.change-anchor-points-joint-type.straight":"MainArea/Shortcut/ChangeAnchorPointsJointTypeStraight","modify.change-anchor-points-joint-type.mirrored":"MainArea/Shortcut/ChangeAnchorPointsJointTypeMirrored","modify.change-anchor-points-joint-type.disconnected":"MainArea/Shortcut/ChangeAnchorPointsJointTypeDisconnected","modify.change-anchor-points-joint-type.asymmetric":"MainArea/Shortcut/ChangeAnchorPointsJointTypeAsymmetric","modify.change-anchor-points-joint-type.connector":"MainArea/Shortcut/ChangeAnchorPointsJointTypeConnector","modify.swap-paint-layers":"MainArea/Shortcut/SwapPaintLayers","modify.create-new-layer":"MainArea/Shortcut/CreateNewLayer","view.zoom.original":"MainArea/Shortcut/OriginalView","view.zoom.fit-selection":"MainArea/Shortcut/FitSelection","view.zoom.fit-current-layer":"MainArea/Shortcut/FitLayer","view.zoom.fit.all":"MainArea/Shortcut/FitAll","view.magnification.6":"MainArea/Shortcut/6","view.magnification.12":"MainArea/Shortcut/12","view.magnification.25":"MainArea/Shortcut/25","view.magnification.50":"MainArea/Shortcut/50","view.magnification.66":"MainArea/Shortcut/66","view.magnification.100":"MainArea/Shortcut/100","view.magnification.150":"MainArea/Shortcut/150","view.magnification.200":"MainArea/Shortcut/200","view.magnification.300":"MainArea/Shortcut/300","view.magnification.400":"MainArea/Shortcut/400","view.magnification.800":"MainArea/Shortcut/800","view.magnification.1600":"MainArea/Shortcut/1600","view.magnification.3200":"MainArea/Shortcut/3200","view.magnification.6400":"MainArea/Shortcut/6400","view.magnification.12800":"MainArea/Shortcut/12800","view.magnification.25600":"MainArea/Shortcut/25600","view.zoom.in":"MainArea/Shortcut/ZoomIn","zoom.out":"MainArea/Shortcut/ZoomOut","view.outline-view":"MainArea/Shortcut/OutlineView","view.fast-view":"MainArea/Shortcut/FastView","view.canvas.show-rulers":"MainArea/Shortcut/ShowRulers","view.canvas.show-guide-lines":"MainArea/Shortcut/ShowGuideLines","view.canvas.show-symbol-labels":"MainArea/Shortcut/ShowSymbolLabels","view.canvas.show-grid":"MainArea/Shortcut/ShowGrid","view.canvas.show-slices":"MainArea/Shortcut/ShowSlices","view.canvas.show-effects":"MainArea/Shortcut/ShowEffects","view.toggle-snap":"MainArea/Shortcut/UseSnapping","view.toggle-snapzones":"MainArea/Shortcut/UseSnapZones","view.toggle-guide.guide.grid":"MainArea/Shortcut/SnapToGrid","view.toggle-guide.guide.guide-lines":"MainArea/Shortcut/SnapToGuideLines","view.toggle-guide.guide.full-pixels":"MainArea/Shortcut/SnapToFullPixels","view.toggle-guide.guide.points":"MainArea/Shortcut/SnapToAnchorPoints","view.toggle-guide.guide.bbox":"MainArea/Shortcut/SnapToShapes","view.toggle-guide.guide.scene":"MainArea/Shortcut/SnapToPages","view.toggle-sidebar.inspector":"MainArea/Shortcut/ShowInspectorPanel","view.toggle-sidebar.outline":"MainArea/Shortcut/ShowLayersPanel","view.toggle-sidebar.library":"MainArea/Shortcut/ShowLibrariesPanel","view.toggle-sidebar.symbols":"MainArea/Shortcut/ShowSymbolsPanel","view.clone":"MainArea/Shortcut/NewView","view.play":"MainArea/Shortcut/PlayPresent","view.fullscreen":"MainArea/Shortcut/ToggleFullscreen","view.canvas.show-selection-handles":"MainArea/Shortcut/ToggleSelectionHandlesVisibility","view.enter-layer-group":"MainArea/Shortcut/EnterLayerGroup","view.enter-layer-group.reverse":"MainArea/Shortcut/LeaveLayerGroup","view.cycle-through-layers.next":"MainArea/Shortcut/SelectNextLayer","view.cycle-through-layers.previous":"MainArea/Shortcut/SelectPreviousLayer","view.toggle-layer-visibility":"MainArea/Shortcut/ToggleLayerVisibility","view.toggle-paint-layers-visibility.fill":"MainArea/Shortcut/ToggleFillPaintLayersVisibility","view.toggle-paint-layers-visibility.border":"MainArea/Shortcut/ToggleBorderPaintLayersVisibility","view.toggle-multi-page-mode":"MainArea/Shortcut/ToggleMultiPageMode","view.change-active-page.next":"MainArea/Shortcut/SelectNextPage","view.change-active-page.previous":"MainArea/Shortcut/SelectPreviousPage","view.change-active-window.next":"MainArea/Shortcut/SelectNextWindow","view.change-active-window.previous":"MainArea/Shortcut/SelectPreviousWindow","open-link.contact-us":"MainArea/Shortcut/ContactUs","open-link.user-guide":"MainArea/Shortcut/UserGuide","open-link.tutorials":"MainArea/Shortcut/Tutorials","open-link.changelog":"MainArea/Shortcut/WhatSNew","open-link.blog":"MainArea/Shortcut/Blog","language.0":"MainArea/Shortcut/English","language.1":"MainArea/Shortcut/Deutsch","language.2":"MainArea/Shortcut/中文","language.3":"MainArea/Shortcut/Português","language.4":"MainArea/Shortcut/Español","language.5":"MainArea/Shortcut/Français","language.6":"MainArea/Shortcut/Polski","language.7":"MainArea/Shortcut/Русский","language.8":"MainArea/Shortcut/Türkçe","language.9":"MainArea/Shortcut/Čeština","language.10":"MainArea/Shortcut/繁體中文","language.11":"MainArea/Shortcut/Italiano","language.12":"MainArea/Shortcut/日本語","language.13":"MainArea/Shortcut/Nederlands","open-welcome-screen":"MainArea/Shortcut/ShowWelcomeScreen","check-for-updates":"MainArea/Shortcut/CheckForUpdates","developer-details":"MainArea/Shortcut/SendDeveloperDetails","help.purchase":"MainArea/Shortcut/PurchasePro","example-files":"MainArea/Shortcut/ExploreExampleFiles"},toolbar:{"use-coupon-action":"MainArea/Toolbar/UseCoupon","file.new":"MainArea/Toolbar/NewDesign","file.open-from-template":"MainArea/Toolbar/NewDesignFromTemplate","file.new.clipboard":"MainArea/Toolbar/NewFromClipboard","file.open":"MainArea/Toolbar/OpenFile","gravit-cloud.open":"MainArea/Toolbar/OpenFromCloud","file.open-recent":"MainArea/Toolbar/NoRecentFiles","file.save":"MainArea/Toolbar/Save","file.save-as.gvdesign":"MainArea/Toolbar/DownloadFile","gravit-cloud.save-as":"MainArea/Toolbar/SaveToCloud","cloud.sync.sync-to-cloud":"MainArea/Toolbar/SyncToCloud","cloud.sync.unsync-from-cloud":"MainArea/Toolbar/UnsyncFromCloud","cloud.sync.info":"MainArea/Toolbar/LastSyncedAt11197010000Am","gravit-versions-history":"Pro/MainArea/Toolbar/ShowVersionHistory","file.save-all":"MainArea/Toolbar/SaveAll","file.place-import":"MainArea/Toolbar/PlaceImage","file.import-image-from-ios-photos":"MainArea/Toolbar/PlaceImage/Photos","file.import-image-from-ios-files":"MainArea/Toolbar/PlaceImage/Files","file.link-import":"MainArea/Toolbar/LinkImage","font.import":"Pro/MainArea/Toolbar/AddFonts","file.export":"Pro/MainArea/Toolbar/AdvancedExport","file.save-as.png":"MainArea/Toolbar/PngImagePng","file.save-as.jpg":"MainArea/Toolbar/JpegImageJpg","file.save-as.svg":"MainArea/Toolbar/ScalableVectorGraphicsSvg","file.save-as.pdf":"Pro/MainArea/Toolbar/300Dpi","file.export.pdf":"Pro/MainArea/Toolbar/AdvancedOptions","file.share":"MainArea/Toolbar/ShareFile","file.print":"MainArea/Toolbar/Print","file.quit":"MainArea/Toolbar/Quit","edit.undo":"MainArea/Toolbar/Undo","edit.redo":"MainArea/Toolbar/Redo","edit.cut":"MainArea/Toolbar/Cut","edit.copy":"MainArea/Toolbar/Copy","paste.paste":"MainArea/Toolbar/Paste","edit.paste.in-place":"MainArea/Toolbar/PasteInPlace","edit.paste.inside":"MainArea/Toolbar/PasteInsideSelection","edit.paste.here":"MainArea/Toolbar/PasteHere","edit.paste.style":"MainArea/Toolbar/PasteStyle","edit.delete":"MainArea/Toolbar/Delete","edit.duplicate":"MainArea/Toolbar/Duplicate","edit.edit":"MainArea/Toolbar/EditSelection","edit.select-all":"MainArea/Toolbar/SelectAll","edit.deselect-all":"MainArea/Toolbar/DeselectAll","edit.invert-selection":"MainArea/Toolbar/InvertSelection","edit.selectbyfonttype":"MainArea/Toolbar/SelectByFontType","edit.settings":"MainArea/Toolbar/Settings","arrange.order.send-front":"MainArea/Toolbar/BringToFront","arrange.order.bring-forward":"MainArea/Toolbar/BringForward","arrange.order.send-backward":"MainArea/Toolbar/SendBackward","arrange.order.send-back":"MainArea/Toolbar/SendToBack","arrange.align.align-left":"MainArea/Toolbar/AlignLeft","arrange.align.align-center":"MainArea/Toolbar/AlignCenter","arrange.align.align-right":"MainArea/Toolbar/AlignRight","arrange.align.align-top":"MainArea/Toolbar/AlignTop","arrange.align.align-middle":"MainArea/Toolbar/AlignMiddle","arrange.align.align-bottom":"MainArea/Toolbar/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/Toolbar/SameWidth","arrange.align.align-justify-vertical":"MainArea/Toolbar/SameHeight","arrange.distribute.horizontal":"MainArea/Toolbar/DistributeHorizontally","arrange.distribute.vertical":"MainArea/Toolbar/DistributeVertically","arrange.snap-unit.full":"MainArea/Toolbar/SnapToFullUnits","arrange.snap-unit.half":"MainArea/Toolbar/SnapToHalfUnits","arrange.transform.rotate-45-left":"MainArea/Toolbar/Rotate45Left","arrange.transform.rotate-90-left":"MainArea/Toolbar/Rotate90Left","arrange.transform.rotate-180-left":"MainArea/Toolbar/Rotate180Left","arrange.transform.rotate-45-right":"MainArea/Toolbar/Rotate45Right","arrange.transform.rotate-90-right":"MainArea/Toolbar/Rotate90Right","arrange.transform.rotate-180-right":"MainArea/Toolbar/Rotate180Right","arrange.transform.flip-vertical":"MainArea/Toolbar/FlipVertical","arrange.transform.flip-horizontal":"MainArea/Toolbar/FlipHorizontal","modify.group":"MainArea/Toolbar/GroupSelection","modify.clip":"MainArea/Toolbar/ClipSelection","modify.split":"MainArea/Toolbar/UngroupSelection","modify.mask-with-shape":"MainArea/Toolbar/MaskWithShape","modify.crop":"MainArea/Toolbar/ConfirmCropping","modify.cancel-crop":"MainArea/Toolbar/CancelCropping","modify.merge":"MainArea/Toolbar/CreateCompound","modify.merge.op-1":"MainArea/Toolbar/Union","modify.merge.op-2":"MainArea/Toolbar/Difference","modify.merge.op-3":"MainArea/Toolbar/Intersect","modify.merge.op-4":"MainArea/Toolbar/Subtract","modify.createnestedcompound":"MainArea/Toolbar/CreateNestedCompound","modify.join-paths":"MainArea/Toolbar/JoinPaths","modify.split-path":"MainArea/Toolbar/SplitPath","modify.converttopath":"MainArea/Toolbar/ConvertToPath","modify.converttorawpath":"MainArea/Toolbar/ConvertToRawPath","modify.ouline":"MainArea/Toolbar/ConvertToOutline","modify.offset":"MainArea/Toolbar/ExpandShrink","modify.vectorize":"MainArea/Toolbar/VectorizeBorder","modify.bmp2path":"MainArea/Toolbar/VectorizeImage","modify.attachToPath":"MainArea/Toolbar/AttachTextToPath","modify.detachFromPath":"MainArea/Toolbar/DetachTextFromPath","modify.simplify":"MainArea/Toolbar/SimplifyPath","modify.connect-lines":"MainArea/Toolbar/ConnectPathsLines","modify.split-line":"MainArea/Toolbar/BreakCurve","modify.reverse-order":"MainArea/Toolbar/ReverseOrder","modify.createsymbol":"MainArea/Toolbar/CreateSymbol","modify.detachsymbol":"MainArea/Toolbar/DetachSymbolInstance","modify.resetinstance":"MainArea/Toolbar/ResetInstance","modify.path2bmp":"MainArea/Toolbar/Flatten","view.zoom.original":"MainArea/Toolbar/OriginalView","view.zoom.fit-selection":"MainArea/Toolbar/FitSelection","view.zoom.fit-current-layer":"MainArea/Toolbar/FitLayer","view.zoom.fit.all":"MainArea/Toolbar/FitAll","view.magnification.6":"MainArea/Toolbar/6","view.magnification.12":"MainArea/Toolbar/12","view.magnification.25":"MainArea/Toolbar/25","view.magnification.50":"MainArea/Toolbar/50","view.magnification.66":"MainArea/Toolbar/66","view.magnification.100":"MainArea/Toolbar/100","view.magnification.150":"MainArea/Toolbar/150","view.magnification.200":"MainArea/Toolbar/200","view.magnification.300":"MainArea/Toolbar/300","view.magnification.400":"MainArea/Toolbar/400","view.magnification.800":"MainArea/Toolbar/800","view.magnification.1600":"MainArea/Toolbar/1600","view.magnification.3200":"MainArea/Toolbar/3200","view.magnification.6400":"MainArea/Toolbar/6400","view.magnification.12800":"MainArea/Toolbar/12800","view.magnification.25600":"MainArea/Toolbar/25600","view.zoom.in":"MainArea/Toolbar/ZoomIn","zoom.out":"MainArea/Toolbar/ZoomOut","view.outline-view":"MainArea/Toolbar/OutlineView","view.fast-view":"MainArea/Toolbar/FastView","view.canvas.show-rulers":"MainArea/Toolbar/ShowRulers","view.canvas.show-guide-lines":"MainArea/Toolbar/ShowGuideLines","view.canvas.show-symbol-labels":"MainArea/Toolbar/ShowSymbolLabels","view.canvas.show-grid":"MainArea/Toolbar/ShowGrid","view.canvas.show-slices":"MainArea/Toolbar/ShowSlices","view.canvas.show-effects":"MainArea/Toolbar/ShowEffects","view.toggle-snap":"MainArea/Toolbar/UseSnapping","view.toggle-snapzones":"MainArea/Toolbar/UseSnapZones","view.toggle-guide.guide.grid":"MainArea/Toolbar/SnapToGrid","view.toggle-guide.guide.guide-lines":"MainArea/Toolbar/SnapToGuideLines","view.toggle-guide.guide.full-pixels":"MainArea/Toolbar/SnapToFullPixels","view.toggle-guide.guide.points":"MainArea/Toolbar/SnapToAnchorPoints","view.toggle-guide.guide.bbox":"MainArea/Toolbar/SnapToShapes","view.toggle-guide.guide.scene":"MainArea/Toolbar/SnapToPages","view.toggle-sidebar.inspector":"MainArea/Toolbar/ShowInspectorPanel","view.toggle-sidebar.outline":"MainArea/Toolbar/ShowLayersPanel","view.toggle-sidebar.library":"MainArea/Toolbar/ShowLibrariesPanel","view.toggle-sidebar.symbols":"MainArea/Toolbar/ShowSymbolsPanel","view.clone":"MainArea/Toolbar/NewView","view.play":"MainArea/Toolbar/PlayPresent","view.fullscreen":"MainArea/Toolbar/ToggleFullscreen","open-link.contact-us":"MainArea/Toolbar/ContactUs","open-link.user-guide":"MainArea/Toolbar/UserGuide","open-link.tutorials":"MainArea/Toolbar/Tutorials","open-link.changelog":"MainArea/Toolbar/WhatSNew","open-link.blog":"MainArea/Toolbar/Blog","language.0":"MainArea/Toolbar/English","language.1":"MainArea/Toolbar/Deutsch","language.2":"MainArea/Toolbar/中文","language.3":"MainArea/Toolbar/Português","language.4":"MainArea/Toolbar/Español","language.5":"MainArea/Toolbar/Français","language.6":"MainArea/Toolbar/Polski","language.7":"MainArea/Toolbar/Русский","language.8":"MainArea/Toolbar/Türkçe","language.9":"MainArea/Toolbar/Čeština","language.10":"MainArea/Toolbar/繁體中文","language.11":"MainArea/Toolbar/Italiano","language.12":"MainArea/Toolbar/日本語","language.13":"MainArea/Toolbar/Nederlands","open-welcome-screen":"MainArea/Toolbar/ShowWelcomeScreen","check-for-updates":"MainArea/Toolbar/CheckForUpdates","developer-details":"MainArea/Toolbar/SendDeveloperDetails","help.purchase":"MainArea/Toolbar/PurchasePro","example-files":"MainArea/Toolbar/ExploreExampleFiles","view.toggle-touch.on":"MainArea/MenuBar/View/TouchInterface","view.toggle-touch.off":"MainArea/MenuBar/View/DisableTouchInterface"},confirmationdialog:{},windowalert:{"file.save":"CloseWindowAlertDialog/Save"},dimensionproperties:{"arrange.distribute.horizontal":"MainArea/Inspector/DistributeAlign/DistributeHorizontal","arrange.distribute.vertical":"MainArea/Inspector/DistributeAlign/DistributeVertical","arrange.align.align-left":"MainArea/Inspector/DistributeAlign/AlignLeft","arrange.align.align-center":"MainArea/Inspector/DistributeAlign/AlignCenter","arrange.align.align-right":"MainArea/Inspector/DistributeAlign/AlignRight","arrange.align.align-top":"MainArea/Inspector/DistributeAlign/AlignTop","arrange.align.align-middle":"MainArea/Inspector/DistributeAlign/AlignMiddle","arrange.align.align-bottom":"MainArea/Inspector/DistributeAlign/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/Inspector/DistributeAlign/AlignJustifyHorizontal","arrange.align.align-justify-vertical":"MainArea/Inspector/DistributeAlign/AlignJustifyVertical"},alignproperties:{"arrange.distribute.horizontal":"MainArea/Inspector/DistributeAlign/DistributeHorizontal","arrange.distribute.vertical":"MainArea/Inspector/DistributeAlign/DistributeVertical","arrange.align.align-left":"MainArea/Inspector/DistributeAlign/AlignLeft","arrange.align.align-center":"MainArea/Inspector/DistributeAlign/AlignCenter","arrange.align.align-right":"MainArea/Inspector/DistributeAlign/AlignRight","arrange.align.align-top":"MainArea/Inspector/DistributeAlign/AlignTop","arrange.align.align-middle":"MainArea/Inspector/DistributeAlign/AlignMiddle","arrange.align.align-bottom":"MainArea/Inspector/DistributeAlign/AlignBottom","arrange.align.align-justify-horizontal":"MainArea/Inspector/DistributeAlign/AlignJustifyHorizontal","arrange.align.align-justify-vertical":"MainArea/Inspector/DistributeAlign/AlignJustifyVertical"},outlinesidebar:{"view.zoom.fit.all":"MainArea/LayersTab/ClickToFit","view.zoom.fit-selection":"SaveFailedDialog/ClickToFitSelection"},savefailed:{"file.save-as.gvdesign":"SaveFailedDialog/TryAgain","file.save-as.cdrapp":"SaveFailedDialog/TryAgain"},unsavedhandler:{"file.save":"CloseAppAlertDialog/Save"},failedalertdialog:{"file.save":"FailedAlertDialog/TryAgainClick"}},cancelled:{anonymous:"ActionCancelled/$VALUE"},tooltips:{upgradetopro:{"gravit-versions-history":"MainArea/Tooltips/UpgradeToPro/ShowVersionHistory","font.import":"MainArea/Tooltips/UpgradeToPro/FileImport/AddFonts","file.export":"MainArea/Tooltips/UpgradeToPro/FileExport/AdvancedExport","file.save-as.pdf.300":"MainArea/Tooltips/UpgradeToPro/FileExport/PdfDocumentPdf/300DPI","file.export.pdf":"MainArea/Tooltips/UpgradeToPro/FileExport/PdfDocumentPdf/AdvancedOptions","view.toggle-touch":"MainArea/Tooltips/UpgradeToPro/ToggleTouch"}}},toolbar:{click:{menu:{select:"MainArea/Toolbar/Select",knife:"MainArea/Toolbar/Knife",shape:"MainArea/Toolbar/Shape",pen:"MainArea/Toolbar/Pen",text:"MainArea/Toolbar/Text",undoopen:"MainArea/Toolbar/Undo/Open",undoclick:"MainArea/Toolbar/Undo/Click"},share:"MainArea/Toolbar/Share"},nonprotriespro:{share:"NonProTriesPro/MainArea/Toolbar/Share"},activate:{tool:{Pointer:"MainArea/Toolbar/Select/Pointer",Subselect:"MainArea/Toolbar/Select/Subselect",Lasso:"MainArea/Toolbar/Select/Lasso",Layer:"MainArea/Toolbar/Select/Layer",Slice:"MainArea/Toolbar/Select/Slice",Pen:"MainArea/Toolbar/Path/Pen",Bezigon:"Pro/MainArea/Toolbar/Path/Bezigon",Knife:"MainArea/Toolbar/Knife/Knife",Freehand:"MainArea/Toolbar/Path/Freehand","Freehand shaping":"MainArea/Toolbar/Knife/Freehand shaping",Line:"MainArea/Toolbar/Shape/Line",Rectangle:"MainArea/Toolbar/Shape/Rectangle",Ellipse:"MainArea/Toolbar/Shape/Ellipse",Polygon:"MainArea/Toolbar/Shape/Polygon",Triangle:"MainArea/Toolbar/Shape/Triangle",Star:"MainArea/Toolbar/Shape/Star",Text:"MainArea/Toolbar/Insert/Text",Pan:"MainArea/Toolbar/View/Pan",Zoom:"MainArea/Toolbar/View/Zoom","Show Comments":"MainArea/Toolbar/ShowComments","Hide Comments":"MainArea/Toolbar/HideComments"}},zoom:{"manual-input":"MainArea/Toolbar/Zoom/ManualInput"}},filespanel:{export:{"cdr-ok":"CloudDialog/CDRFileSaveSuccess","cdr-failed":"CloudDialog/CDRFileSaveFailed"},create:{cloudfolder:"CloudDialog/Toolbar/CreateNewFolder"},maximize:{cloudfile:"CloudDialog/Header/Maximize"},minimize:{cloudfile:"CloudDialog/Header/Minimize"},close:{cloudfile:"CloudDialog/Header/Close"},delete:{cloud:"CloudDialog/FilesPanel/Context/Delete","cloud-multiple":"CloudDialog/FilesPanel/Context/DeleteMultiple"},cancelsave:{cloud:"CloudDialog/Footer/CancelSave"},"go-to-parent":{cloudfolder:"CloudDialog/Toolbar/Back"},"go-to-root":{cloudfolder:"CloudDialog/Toolbar/ReturnToMain"},download:{"multiple-files":"CloudDialog/Footer/Download",file:"CloudDialog/Footer/Download"},open:{cloudfile:"CloudDialog/File/DblClick",cloudfolder:"CloudDialog/Folder/DblClick",examplefile:"CloudDialog/Open/ExampleFile/$VALUE"},"format-filter":{on:"CloudDialog/Format/Filter/On/$VALUE",off:"CloudDialog/Format/Filter/Off/$VALUE",clear:"CloudDialog/Format/Filter/Clear"},select:{cloudfile:"CloudDialog/File/Select",cloudfolder:"CloudDialog/Folder/Select"},copy:{cloud:"CloudDialog/FilesPanel/Context/Copy","cloud-multiple":"CloudDialog/FilesPanel/Context/CopyMultiple"},cut:{cloud:"CloudDialog/FilesPanel/Context/Cut","cloud-multiple":"CloudDialog/FilesPanel/Context/CutMultiple"},"paste-from-copy":{cloud:"CloudDialog/Footer/PasteFromCopy"},"paste-from-cut":{cloud:"CloudDialog/Footer/PasteFromCut"},save:{cloudfile:"CloudDialog/SaveAs/$VALUE"},focus:{"filename-input":"CloudDialog/FilesPanel/FocusFilenameInput"},"expand-collapse":{cloudfolder:"CloudDialog/FilesPanel/ExpandCollapseFolderContent"},move:"CloudDialog/File/DragNDrop"},cloudtemplates:{click:{backbutton:"WelcomeScreen/Templates/$VALUE/Back"},add:"WelcomeScreen/Templates/$ACTION/$VALUE",load:{template:"WelcomeScreen/Templates/$VALUE"},switch:{size:"WelcomeScreen/Templates/LargePreview/$VALUE"}},savealert:{"save-failed":{"click-save-local":"SaveAlertDialog/TrySaveLocal","dont-save-local":"SaveAlertDialog/AbortSave"}},librarypanel:{click:{backtotop:"MainArea/Libraries/Click/BackToTop",search:"MainArea/Libraries/Search/$VALUE"},change:{category:"MainArea/Libraries/$VALUE"},download:{image:"MainArea/Libraries/DownloadImage"},search:{category:"MainArea/Libraries/$VALUE"}},newfile:{click:{save:"CloudDialog/NewFilePrompt",close:"CloudDialog/NewFilePrompt"},enter:{save:"CloudDialog/NewFilePrompt"}},cornertypes:{click:{open:"MainArea/Inspector/Appearance/Corners",change:"MainArea/Inspector/Appearance/Corners/$VALUE"}},designerstyle:{click:{create:"MainArea/Inspector/StyleEditor/ApplyCreate",finish:"MainArea/Inspector/StyleEditor/FinishCreateStyle",createnewstyle:"MainArea/Inspector/StyleEditor/CreateNewStyle",organize:"MainArea/Inspector/StyleEditor/Organize",openpanel:"Pro/MainArea/Inspector/StyleEditor/Open",assign:"MainArea/Inspector/StyleEditor/Assign",disconnect:"MainArea/Inspector/StyleEditor/Disconnect",open:"Pro/MainArea/Inspector/StyleEditor/Open"},nonprotriespro:{openpanel:"NonProTriesPro/MainArea/Inspector/StyleEditor/Open"}},eyedropper:{click:{pick:"MainArea/Inspector/PatternChooser/EyeDropper"}},fonts:{expand:{textfield:"MainArea/Inspector/Appearance/Fonts/OpenAvailableFonts"},click:{tab:"MainArea/Inspector/Appearance/Fonts/ClickTab/$VALUE",protab:"Pro/MainArea/Inspector/Appearance/Fonts/ClickTab/$VALUE"},nonprotriespro:{protab:"NonProTriesPro/MainArea/Inspector/Appearance/Fonts/ClickTab/$VALUE"}},fontspanel:{click:{deletefont:"MainArea/Inspector/Appearance/Fonts/DeleteFont/$VALUE",setfont:"MainArea/Inspector/Appearance/Fonts/ChooseFont/$VALUE"}},annotations:{deselect:{"all-annotations":"MainArea/AnnotationsTab/Annotations/DeselectAll"},select:{annotation:"MainArea/AnnotationsTab/Annotations/Select"},settings:{"show-resolved":"MainArea/Annotations/Settings/ShowResolved/$VALUE","resolve-all":"MainArea/Annotations/Settings/ResolveAll",notifications:{all:"MainArea/Annotations/Settings/Notification/All",assigned:"MainArea/Annotations/Settings/Notifications/Assigned",none:"MainArea/Annotations/Settings/Notifications/None"}},open:{patternchooser:"MainArea/Annotations/$VALUE/PatternChooser/Open"},click:{"toolbar-btn":"MainArea/Annotations/$VALUE",eyedropper:"MainArea/Annotations/$VALUE/Pick"},toggle:{page:"MainArea/Annotations/Page/$VALUE"},"line-width":"MainArea/Annotations/$VALUE/LineWidth","border-marker":{head:"MainArea/Annotations/Arrow/StartArrow/$VALUE",tail:"MainArea/Annotations/Arrow/EndArrow/$VALUE"}},collabtextpanel:{"bottom-bar":{"back-to-editing":"MainArea/CoText/BottomBar/BackToEditing","preview-changes":"MainArea/CoText/BottomBar/PreviewChanges","finish-editing":"MainArea/CoText/BottomBar/FinishEditing","send-changes":"MainArea/CoText/BottomBar/SendChanges","request-access":"MainArea/CoText/BottomBar/NoEditMsg/RequestAccess","file-update":"MainArea/CoText/BottomBar/UpdatedFileMsg/UpdateNow","cancel-file-update":"MainArea/CoText/BottomBar/UpdatedFileMsg/Cancel","file-locked":"MainArea/CoText/BottomBar/LockedFile"},"request-dialog":{"save-edits":"MainArea/CoText/RequestAccessDialog/SaveEdits","discard-edits":"MainArea/CoText/RequestAccessDialog/DiscardEdits",decline:"MainArea/CoText/RequestAccessDialog/Decline"},"changes-dialog":{"save-edits":"MainArea/CoText/ChangesDialog/SaveEdits","discard-edits":"MainArea/CoText/RequestAccessDialog/DiscardEdits"}},"unsupported-dialog":{open:"MainArea/UnsupportedObjDialog",click:{option:"MainArea/UnsupportedObjDialog/Option/$VALUE",details:"MainArea/UnsupportedObjDialog/Details",cancel:"MainArea/UnsupportedObjDialog/Cancel",submit:"MainArea/UnsupportedObjDialog/Submit"}},layers:{click:{"symbol-reset":"MainArea/LayersTab/Layers/ResetSymbol"},change:{locktype:"MainArea/LayersTab/Layers/ToggleLock"},toggle:{visibility:"MainArea/LayersTab/Layers/ToggleVisibility",outline:"MainArea/LayersTab/Layers/ToggleOutline"},deselect:{"all-layers":"MainArea/LayersTab/Layers/DeselectAll"},insert:{layer:"MainArea/LayersTab/Layers/InsertLayer"},start:{drag:"MainArea/LayersTab/Layers/StartDrag"},select:{layer:"MainArea/LayersTab/Layers/Select","collab-text":"MainArea/LayersTab/Layers/Select/CoText"},delete:{"layer-or-item":"MainArea/LayersTab/Layers/Delete"}},pages:{change:{lock:"MainArea/LayersTab/Pages/ToggleLock",visibility:"MainArea/LayersTab/Pages/ToggleVisibility","multipage-mode":"MainArea/LayersTab/Pages/ToggleMultipage"},insert:{page:"MainArea/LayersTab/Pages/Insert"},delete:{page:"MainArea/LayersTab/Pages/Delete"},start:{drag:"MainArea/LayersTab/Pages/StartDrag"},select:{page:"MainArea/LayersTab/Pages/Select"}},reviewdocker:{open:{"status-history":"MainArea/Annotations/Design/StatusHistory"},design:"MainArea/Annotations/Design/$VALUE",share:"MainArea/Annotations/Design/Share",nonprotriespro:{share:"NonProTriesPro/MainArea/Annotations/Design/Share"}},replydocker:{"add-reply":"MainArea/Annotations/$VALUE/Reply/Add","cancel-reply":"MainArea/Annotations/$VALUE/Reply/Cancel",mention:{"select-user":"MainArea/Annotations/$VALUE/Reply/Mention/Select","assign-user":"MainArea/Annotations/$VALUE/Reply/Mention/Assign"}},commentdocker:{"add-btn":"MainArea/Annotations/$VALUE/Comment/Add","edit-btn":"MainArea/Annotations/$VALUE/Comment/Edit","cancel-btn":"MainArea/Annotations/$VALUE/Comment/Cancel",option:{resolve:"MainArea/Annotations/$VALUE/Comment/Option/Resolve",reopen:"MainArea/Annotations/$VALUE/Comment/Option/Reopen",add:"MainArea/Annotations/$VALUE/Comment/Option/Add",edit:"MainArea/Annotations/$VALUE/Comment/Option/Edit",delete:"MainArea/Annotations/$VALUE/Comment/Option/Delete","copy-permalink":"MainArea/Annotations/$VALUE/Comment/Option/CopyPermalink"},mention:{"select-user":"MainArea/Annotations/$VALUE/Comment/Mention/Select","assign-user":"MainArea/Annotations/$VALUE/Comment/Mention/Assign"}},persona:{click:{"activate-button":"MainArea/Toolbar/Persona/Activate"}},pivot:{click:{"change-button":"MainArea/Inspector/TransformTool/CopiesSmallRectClick"}},symbol:{click:{select:"MainArea/SymbolsTab/Select",focus:"MainArea/SymbolsTab/Focus",createnewsymbol:"MainArea/SymbolsTab/CreateNewSymbol"}},unitbox:{border:{button:"MainArea/Inspector/Borders/ExpandWidthUnitChooser"},effects:{button:"MainArea/Inspector/Effects/ExpandUnitChooser"},text:{button:"MainArea/Inspector/Text/ExpandTextSizeUnitChooser"}},profile:{click:{"open-button":"MainArea/Toolbar/Profile/Open","signout-button":"MainArea/Toolbar/Profile/Logout","purchase-pro":"MainArea/Toolbar/Profile/PurchasePRO"}},font:{downloaded:{closebutton:"MainArea/DownloadFonts/Close"}},document:{open:{cdr:"OpenFile/CDR",svg:"OpenFile/SVG",eps:"Pro/OpenFile/EPS",pdf:"OpenFile/PDF",ai:"Pro/OpenFile/AI",sketch:"Pro/OpenFile/Sketch",jpg:"OpenFile/JPG",jpeg:"OpenFile/JPG",png:"OpenFile/PNG"},nonprotriespro:{eps:"NonProTriesPro/OpenFile/EPS",ai:"NonProTriesPro/OpenFile/AI",sketch:"NonProTriesPro/OpenFile/Sketch"},import:{"cdr-ok":"CDRImportOK","cdr-failed":"CDRImportFailed/$VALUE"},save:{cdr:"SaveCDRFile"},export:{"cdr-ok":"CDRFileSaveOK","cdr-failed":"CDRFileSaveError/$VALUE"},drop:{file:"MainArea/Canvas/DropFile"},canvas:{"select-collab-text":"MainArea/Canvas/Select/CoText"}},appearance:{toggle:{evenodd:{activate:"MainArea/Inspector/Appearance/EvenOdd",deactivate:"MainArea/Inspector/Appearance/NonZero"}},change:{opacity:"MainArea/Inspector/Appearance/Opacity",blending:"MainArea/Inspector/Appearance/Blending/$VALUE"},click:{stylebutton:"MainArea/Inspector/Appearance/StyleSync"}},booleanops:{click:{merge:"MainArea/Inspector/Appearance/Compound/Merge",intersect:"MainArea/Inspector/Appearance/Compound/Intersect",difference:"MainArea/Inspector/Appearance/Compound/Difference",subtract:"MainArea/Inspector/Appearance/Compound/Subtract",unkn:"MainArea/Inspector/Appearance/Compound/Unknown"}},border:{change:{miterlimit:"MainArea/Inspector/Borders/MiterLimit",dash:"MainArea/Inspector/Borders/Dash",markersposition:"MainArea/Inspector/Borders/Position",tailmarkerscalation:"MainArea/Inspector/Borders/ScaleMarker",opacity:"MainArea/Inspector/Borders/Opacity",width:"MainArea/Inspector/Borders/Width",align:"MainArea/Inspector/Borders/Align/$VALUE",cap:"MainArea/Inspector/Borders/Cap/$VALUE",join:"MainArea/Inspector/Borders/Join/$VALUE",headmarker:"MainArea/Inspector/Borders/MarkerType/$VALUE",autoscale:"MainArea/Inspector/Borders/AutoScale/$VALUE",blendmode:"MainArea/Inspector/Borders/Blending/$VALUE"},click:{paste:"MainArea/Inspector/Borders/Paste"},open:{advancedstrokepanel:"MainArea/Inspector/Borders/OpenAdvanced"},remove:{border:"MainArea/Inspector/Borders/Remove"},add:{border:"MainArea/Inspector/Borders/Add"},set:{border:"MainArea/Inspector/Borders/Select"},hide:{border:"MainArea/Inspector/Borders/Hide"},toggle:{markersoutline:"MainArea/Inspector/Borders/MarkerOutline/$VALUE"}},"filespanel-view":{copy:{cloudfile:"CloudDialog/FilesPanel/Context/Copy"},open:{"add-cloud-drive-account-dialog":"Pro/CloudDialog/Header/OpenAddCloudDrive","edit-cloud-account-dialog":"CloudDialog/Header/OpenEditCloudDrive","cloud-drive":"CloudDialog/Header/OpenCloudDrive/$VALUE","add-cloud-drive-account-form-dialog":"CloudDialog/Header/OpenAddCloudDriveAccount","cloud-pane":"CloudDialog/Header/OpenCloudAccountsMenu",cloudfile:"CloudDialog/File/DblClick",cloudfolder:"CloudDialog/FilesPanel/ContextMenu/OpenFolder"},close:{"cloud-pane":"CloudDialog/Header/CloseCloudAccountsMenu","edit-cloud-account-dialog":"CloudDialog/Header/CloseEditCloudDrive","new-cloud-account-dialog":"CloudDialog/Header/CloseAddCloudDrive","corporate-storages-pane":"CloudDialog/Header/CloseCorporateStorageMenu"},select:{"corporate-storage":"CloudDialog/Header/SelectCorporateStorage"},search:{focus:"CloudDialog/Toolbar/FocusSearch"},clear:{"search-field":"CloudDialog/Toolbar/ClearSearch",selection:"CloudDialog/File/ClearSelection"},save:{"edit-cloud-account-dialog":"CloudDialog/Header/SaveCloudDriveName/$VALUE"},cancelsave:{cloud:"CloudDialog/Footer/Cancel"},download:{"multiple-files":"CloudDialog/FilesPanel/Context/DownloadMultiple/$VALUE","multiple-files-permission-dialog":"CloudDialog/FilesPanel/Context/DownloadMultiple/PermissionDialog",cloudfile:"CloudDialog/FilesPanel/Context/Download",file:"CloudDialog/FilesPanel/Context/Download/$VALUE"},update:{"cloudfile-name":"CloudDialog/FilesPanel/File/UpdateName"},context:{cloudfile:"CloudDialog/FilesPanel/OpenFileContextMenu",cloudfolder:"CloudDialog/FilesPanel/OpenFolderContextMenu","checkin-to-sharepoint":"CloudDialog/FilesPanel/ContextMenu/CheckinToSharepoint","checkout-from-sharepoint":"CloudDialog/FilesPanel/ContextMenu/CheckoutFromSharepoint","checkout-from-sharepoint-and-open":"CloudDialog/FilesPanel/ContextMenu/CheckoutFromSharepointAndOpen","discard-checkout-from-sharepoint":"CloudDialog/FilesPanel/ContextMenu/DiscardCheckoutFromSharepoint"},"sharepoint-checkin":{cancel:"CloudDialog/CheckInDialog/Cancel",confirm:"CloudDialog/CheckInDialog/Confirm/$VALUE"},opencontext:{cloud:"CloudDialog/FilesPanel/Context/Open"},rename:{cloud:"CloudDialog/FilesPanel/Context/Rename"},cut:{cloudfile:"CloudDialog/FilesPanel/Context/Cut"},"open-cloudfolder":{"from-search":"CloudDialog/FilesPanel/Folder/DoubleClick"},delete:{cloudfile:"CloudDialog/FilesPanel/Context/Delete"},"checkin-to-sharepoint":"CloudDialog/FilesPanel/SharePointCheckIn","checkout-from-sharepoint":"CloudDialog/FilesPanel/SharePointCheckOut","checkout-from-sharepoint-and-open":"CloudDialog/FilesPanel/SharePointCheckOutAndOpen",disconnect:{"cloud-account":"CloudDialog/FilesPanel/DisconnectCloudAccount"},execute:{action:"CloudDialog/FilesPanel/ExecuteAction/$VALUE",search:"CloudDialog/Toolbar/ExecuteSearch/$VALUE"},refresh:{"file-list":"CloudDialog/FilesPanel/RefreshFilesList"},nonprotriespro:{clouddriver:"NonProTriesPro/CloudDialog/Header/OpenAddCloudDrive"},"sort-by":{cloud:{updated:"CloudDialog/Toolbar/SortByUpdated",created:"CloudDialog/Toolbar/SortByCreationDate",name:"CloudDialog/Toolbar/SortByName"}},"sort-type":{cloud:{ASCEND:"CloudDialog/Toolbar/SortAscending",DESCEND:"CloudDialog/Toolbar/SortDescending"}},sort:{cloud:"CloudDialog/Toolbar/Sort"},"view-files":{card:"CloudDialog/Toolbar/CardView",list:"CloudDialog/Toolbar/ListView"},infoPanel:{share:"CloudDialog/InfoPanel/Share","nonprotriespro-share":"NonProTriesPro/CloudDialog/InfoPanel/Share",unshare:"CloudDialog/InfoPanel/Remove","nonprotriespro-unshare":"NonProTriesPro/CloudDialog/InfoPanel/Remove"}},contextmenu:{open:{"crop-menu":"Canvas/CropContextMenu","context-menu":"Canvas/CanvasContextMenu","page-menu":"MainArea/LayersTab/Pages/ContextMenu","layer-menu":"MainArea/LayersTab/Layers/ContextMenu","fill-properties-menu":"MainArea/Inspector/Fills/ContextMenu","border-properties-menu":"MainArea/Inspector/Borders/ContextMenu","effect-properties-menu":"MainArea/Inspector/Effects/ContextMenu"},pages:{duplicate:"MainArea/LayersTab/Pages/ContextMenu/Duplicate",delete:"MainArea/LayersTab/Pages/ContextMenu/Delete",copy:"MainArea/LayersTab/Pages/ContextMenu/Copy",export:"MainArea/LayersTab/Pages/ContextMenu/Export"},fills:{delete:"MainArea/Inspector/Fills/ContextMenu/Delete",copy:"MainArea/Inspector/Fills/ContextMenu/Copy"},borders:{"advanced-settings":"MainArea/Inspector/Borders/ContextMenu/Delete",delete:"MainArea/Inspector/Borders/ContextMenu/Delete",copy:"MainArea/Inspector/Borders/ContextMenu/Copy"},effects:{"change-layer":"MainArea/Inspector/Effects/ContextMenu/ChangeLayer/$VALUE",copy:"MainArea/Inspector/Effects/ContextMenu/Copy"}},dimension:{set:{positionOrSize:"MainArea/Inspector/Dimensions/SizeOrPosition",rotation:"MainArea/Inspector/Dimensions/Rotation","anchors-horizontalstart":"MainArea/Inspector/Anchors/HorizontalStart","anchors-horizontalmiddle":"MainArea/Inspector/Anchors/Horizontal/Middle","anchors-horizontalend":"MainArea/Inspector/Anchors/Horizontal/End","anchors-verticalstart":"MainArea/Inspector/Anchors/Vertical/Start","anchors-verticalmiddle":"MainArea/Inspector/Anchors/Vertical/Middle","anchors-verticalend":"MainArea/Inspector/Anchors/Vertical/End"},change:{"transform-mode":"MainArea/Inspector/Dimensions/OpenTransformPanel"},toggle:{preserveratio:"MainArea/Inspector/Dimensions/TogglePreserveRatio"}},documentchooser:{click:{preview:{online:"DocumentChooserDialog/ChooseCloudFile",offline:"DocumentChooserDialog/ChooseLocalFile"}}},effects:{delete:{effect:"MainArea/Inspector/Effects/Delete/$VALUE"},change:{effectlayer:"MainArea/Inspector/Effects/LayersContextMenu",layer:{F:"MainArea/Inspector/Effects/FillLayer",B:"MainArea/Inspector/Effects/BorderLayer",E:"MainArea/Inspector/Effects/WholeElement",null:"MainArea/Inspector/Effects/WholeElement"},grading:"MainArea/Inspector/Effects/SelectColorGrading/$VALUE",colorgrading:"MainArea/Inspector/Effects/CustomColorGrading"},toggle:{collapse:"MainArea/Inspector/Effects/Collapse",visibility:"MainArea/Inspector/Effects/Visibility"},choose:{acv:"MainArea/Inspector/Effects/ChooseCustomColorGrading",type:"MainArea/Inspector/Effects/EffectType/$VALUE"},add:{effectdefault:"MainArea/Inspector/Effects/Add/$VALUE",proeffectdefault:"Pro/MainArea/Inspector/Effects/Add/$VALUE",effectsmenu:"MainArea/Inspector/Effects/AddEffect/$VALUE",panelbutton:"MainArea/Inspector/Effects/AddEffect/$VALUE"},nonprotriespro:{proeffectdefault:"NonProTriesPro/MainArea/Inspector/Effects/Add/$VALUE"},assign:{effectproperty:"MainArea/Inspector/Effects/AssignValue/$VALUE"},open:{effectsmenu:{main:"MainArea/Inspector/Effects/OpenEffectsMenu",more:"MainArea/Inspector/Effects/OpenMoreMenu"}}},ellipse:{change:{angle:"MainArea/Inspector/Appearance/Ellipse/Angle",type:"MainArea/Inspector/Appearance/Ellipse/Type/$VALUE"}},error:{close:{button:"ErrorHandlerDialog/Close"}},export:{open:{"size-menu":"ExportDialog/SizeMenu"},change:{"jpeg-quality":"ExportDialog/JpegQuality",decimalprecision:"Pro/ExportDialog/SVGDecimalPrecision",mode:"ExportDialog/$VALUE",documenttype:"ExportDialog/Format/$VALUE",size:"ExportDialog/Size/$VALUE","background-pattern":"ExportDialog/Background/$VALUE",colorspace:"ExportDialog/PDFColorSpace",output:"ExportDialog/Output/$VALUE"},nonprotriespro:{decimalprecision:"NonProTriesPro/ExportDialog/SVGDecimalPrecision","preserve-svg-editing-capabilities":"NonProTriesPro/ExportDialog/PreserveSVGEditing/$VALUE","layer-as-id":"NonProTriesPro/ExportDialog/LayerAsId",size:"NonProTriesPro/ExportDialog/Size","jpeg-quality":"NonProTriesPro/ExportDialog/JpegQuality","select-background":"NonProTriesPro/ExportDialog/SelectBackground","color-space":"NonProTriesPro/ExportDialog/ColorSpace","ignore-effects":"NonProTriesPro/ExportDialog/IgnoreEffects","convert-text-to-path":"NonProTriesPro/ExportDialog/ConvertTextToPath","export-all":"NonProTriesPro/ExportDialog/ExportAll","do-not-downsample-images":"NonProTriesPro/ExportDialog/DoNotDownsampleImages",export:"NonProTriesPro/ExportDialog/Export"},click:{exportall:"ExportDialog/ExportAll","layer-as-id":"Pro/ExportDialog/LayerAsId"},cancel:{button:"ExportDialog/Cancel"},toggle:{ignoreeffects:"ExportDialog/IgnoreEffects/$VALUE","convert-to-path":"ExportDialog/ConverToPath/$VALUE","preserve-svg-editing-capabilities":"Pro/ExportDialog/PreserveSVGEditing/$VALUE","do-not-downsample-images":"ExportDialog/DoNotDownsample/$VALUE"},execute:{button:"ExportDialog/Export"}},exportproperties:{click:{export:"MainArea/LayersTab/Export/DoExport",createslice:"MainArea/LayersTab/Export/CreateSlice","add-item-to-export":"MainArea/LayersTab/Export/Add","change-size":"MainArea/LayersTab/Export/ChangeSize",removeitem:"MainArea/LayersTab/Export/Remove"},cancel:{anonymous:"MainArea/LayersTab/Export/Cancel"},change:{"size-dropdown":"MainArea/LayersTab/Export/SizeDropdown"},toggle:{multiple:"MainArea/LayersTab/Export/ToggleMultiple"},format:{dropdown:"MainArea/LayersTab/Export/Format"}},fill:{open:{advancedfillpanel:"MainArea/Inspector/Fill/OpenAdvanced"},remove:{fill:"MainArea/Inspector/Fill/Remove"},add:{fill:"MainArea/Inspector/Fill/Add"},change:{opacity:"MainArea/Inspector/Fill/Opacity","blend-mode":"MainArea/Inspector/Fill/Blending/$VALUE"},hide:{show:"MainArea/Inspector/Fill/ToggleVisibility"},toggle:{"fill-rule":{enable:"MainArea/Inspector/Fill/FillRule/EvenOdd",disable:"MainArea/Inspector/Fill/FillRule/NonZero"}}},header:{remove:{tab:"MainArea/Files/Close"},change:{tab:"MainArea/Files/Change"},click:{login:"MainArea/AccountPanel/Open","more-button":"MainArea/Files/More"},contextmenu:{tab:"MainArea/Tab/ContextMenu",rename:"MainArea/Files/Rename",save:"MainArea/Files/Save","save-as":"MainArea/Files/SaveAs",share:"MainArea/Files/Share","open-shared-file":"/MainArea/Files/OpenSharedFile","version-history":"MainArea/Files/VersionHistory","advanced-export":"MainArea/Files/AdvancedExport",duplicate:"MainArea/Files/Duplicate","close-other":"MainArea/Files/CloseOther","close-all":"MainArea/Files/CloseAll"}},image:{replace:{image:"MainArea/Inspector/ImageProperties/Replace"},reset:{size:"MainArea/Inspector/ImageProperties/OrigSize"},change:{croptype:"MainArea/Inspector/ImageProperties/Crop"},update:{palette:"MainArea/Inspector/ImageProperties/Colors"}},itemproperties:{click:{through:"MainArea/Inspector/Group/ClickThrough"},toggle:{"scale-with-content":"MainArea/Inspector/ItemProperties/AutoScale/$VALUE"}},missingfonts:{keep:{fonts:"MissingFontsDialog/Keep"},replace:{fonts:"MissingFontsDialog/Replace"}},newdocumentdialog:{show:{gravitversion:"WelcomeScreen/ShowVersion"},open:{cloudfiles:"WelcomeScreen/OpenFromCloud",externallink:"WelcomeScreen/Links/$VALUE",blog:"WelcomeScreen/Blog"},click:{openrecentdocument:"WelcomeScreen/OpenRecent/Open",document:"WelcomeScreen/$VALUE",opendocument:"WelcomeScreen/OpenFromComputer","got-it-checkbox":"WelcomeScreen/GotItCheckbox","got-it":"WelcomeScreen/GotItButton",newdesign:"WelcomeScreen/NewDesign",recent:"WelcomeScreen/OpenRecent",templates:"WelcomeScreen/NewFromTemplate","example-files":"WelcomeScreen/ExampleFiles"},change:{preset:"WelcomeScreen/NewDesign/ChangePreset/$VALUE",unit:{px:"WelcomeScreen/NewDesign/Unit/Pixels",pc:"WelcomeScreen/NewDesign/Unit/Picas",cm:"WelcomeScreen/NewDesign/Unit/Centimeters",mm:"WelcomeScreen/NewDesign/Unit/Millimeters",in:"WelcomeScreen/NewDesign/Unit/Inches",pt:"WelcomeScreen/NewDesign/Unit/Points"}},new:{"custom-sized":"WelcomeScreen/NewDesign/Create","document-from-preset":"WelcomeScreen/NewDesign/$VALUE"},toggle:{"show-welcome-screen":"WelcomeScreen/NewDesign/DontShowAnymore"}},pageproperties:{preset:{size:"MainArea/Inspector/PageProperties/PageSize/$VALUE"},change:{size:"MainArea/Inspector/PageProperties/Size",rotate:"MainArea/Inspector/PageProperties/Rotate",bleeding:"MainArea/Inspector/PageProperties/Bleed",margins:"MainArea/Inspector/PageProperties/Margin",masterpages:"Pro/MainArea/Inspector/PageProperties/Master","canvas-opacity":"MainArea/Inspector/PageProperties/Opacity"},nonprotriespro:{masterpages:"NonProTriesPro/MainArea/Inspector/PageProperties/Master"},lock:{margin:"MainArea/Inspector/PageProperties/EqualMargins"},trim:{page:"MainArea/Inspector/PageProperties/Trim"},clip:{content:"MainArea/Inspector/PageProperties/Clip"}},panels:{set:{active:"Panels/Activate"}},pathproperties:{assign:{nodetype:"MainArea/Inspector/Appearance/Path/$VALUE"},modify:{closed:"MainArea/Inspector/Appearance/Path/ToggleClosed",autoscale:"MainArea/Inspector/Appearance/Path/ToggleAutoScale",x:"MainArea/Inspector/Appearance/Path/Point/x",y:"MainArea/Inspector/Appearance/Path/Point/y",corner:"MainArea/Inspector/Appearance/Path/Point/CornerSize",uniform:"MainArea/Inspector/Appearance/Path/Point/UniformCorners","point-properties":"MainArea/Inspector/Appearance/Path/PointProperties"}},patternchooser:{change:{type:"MainArea/Inspector/PatternChooser/$VALUE","color-from-colorslider":"MainArea/Inspector/PatternChooser/ColorSlider",opacity:"MainArea/Inspector/PatternChooser/Opacity","stops-order":"MainArea/Inspector/PatternChooser/ChangeStopsOrder","noise-amount":"MainArea/Inspector/PatternChooser/NoiseIntensity",noise:"MainArea/Inspector/PatternChooser/NoiseIntensity",texture:"MainArea/Inspector/PatternChooser/Texture/$VALUE",colormode:"MainArea/Inspector/PatternChooser/ColorMode/$VALUE",procolormode:"Pro/MainArea/Inspector/PatternChooser/ColorMode/$VALUE",colorinput:"MainArea/Inspector/PatternChooser/ColorInput"},nonprotriespro:{palette:"NonProTriesPro/MainArea/Inspector/PatternChooser/ActivatePalette/$VALUE",procolormode:"NonProTriesPro/MainArea/Inspector/PatternChooser/ColorMode/$VALUE"},click:{systemcolor:"MainArea/Inspector/PatternChooser/SystemColor",advanced:"MainArea/Inspector/PatternChooser/Texture/Advanced",swatch:"MainArea/Inspector/PatternChooser/ClickPalette",open:"MainArea/Inspector/PatternChooser/Open"},choose:{image:"MainArea/Inspector/PatternChooser/Texture/Browse"},paste:{texture:"MainArea/Inspector/PatternChooser/Texture/Paste"},import:{swatches:"MainArea/Inspector/PatternChooser/Swatches/Import"},export:{swatches:"MainArea/Inspector/PatternChooser/Swatches/Export"},add:{swatch:"MainArea/Inspector/PatternChooser/Swatches/Add$VALUE"},rotate:{gradient:"MainArea/Inspector/PatternChooser/RotateGradient/$VALUE"},activate:{palette:"Pro/MainArea/Inspector/PatternChooser/ActivatePalette/$VALUE"},update:{color:"MainArea/Inspector/PatternChooser/EnterHexColor"}},polygonproperties:{change:{radius:"MainArea/Inspector/Appearance/Polygon/Radius",angle:"MainArea/Inspector/Appearance/Polygon/Angle","corner-radius":"MainArea/Inspector/Appearance/Polygon/SingleCornerRadius","corners-radius":"MainArea/Inspector/Appearance/Polygon/AllCornersRadius","number-of-points":"MainArea/Inspector/Appearance/Polygon/Points","plain-edges":"MainArea/Inspector/Appearance/Polygon/ChangePlainEdges"},click:{"advanced-corners":"MainArea/Inspector/Appearance/Polygon/OpenAdvanced"},toggle:{"plain-edges":"MainArea/Inspector/Appearance/Polygon/PlainEdges","autoscale-corners":"MainArea/Inspector/Appearance/Polygon/AutoscaleCorners"}},rectangleproperties:{scale:{"individual-corners":"MainArea/Inspector/Appearance/Rectangle/Corners/InputScale"},toggle:{"individual-uniform-corners":"MainArea/Inspector/Appearance/Rectangle/Corners/ToggleLock",uniform:"MainArea/Inspector/Appearance/Rectangle/Corners/ToggleUniform","scale-corners":"MainArea/Inspector/Appearance/Rectangle/Corners/ToggleAutoscale"},input:{"corners-radius":"MainArea/Inspector/Appearance/Rectangle/Corner"},slide:{"corners-radius":"MainArea/Inspector/Appearance/Rectangle/InputCorner"},open:{advanced:"MainArea/Inspector/Appearance/Rectangle/OpenAdvanced"}},savedialog:{save:{file:"DesktopSaveChooserDialog/SaveToFile",cloud:"DesktopSaveChooserDialog/SaveToCloud"}},sceneproperties:{change:{"canvas-dpi":"MainArea/Inspector/Page/DPI/$VALUE","rect-grid-settings":"MainArea/Inspector/Page/GridSettings/$VALUE","axono-grid-settings":"MainArea/Inspector/Page/GridIsometricSettings/$VALUE","grid-mode":"MainArea/Inspector/Page/GridMode/$VALUE","color-mode":"MainArea/Inspector/Page/ColorMode/$VALUE","canvas-unit":{px:"MainArea/Inspector/Page/Unit/Pixels",mm:"MainArea/Inspector/Page/Unit/Millimeters",cm:"MainArea/Inspector/Page/Unit/Centimeters",pc:"MainArea/Inspector/Page/Unit/Picas",in:"MainArea/Inspector/Page/Unit/Inches",pt:"MainArea/Inspector/Page/Unit/Points"}},enable:{"cloud-sync":"MainArea/Inspector/Page/EnableCloudSync"},click:{"welcome-to-gravit-cloud-medium-com":"MainArea/Inspector/Page/WelcomeToGravitCloud"},toggle:{sync:"MainArea/Inspector/Page/ToggleSync/$VALUE","cloud-sync":"MainArea/Inspector/Page/EnableSync"}},settings:{toggle:{"highlight-on-hover":"AppSettings/HighlightOnHover","auto-expand-layers":"AppSettings/AutoExpandLayers","auto-save":"AppSettings/AutoSave","auto-save-warning-enabled":"AppSettings/AutoSaveWarning/Enabled/$VALUE","auto-save-not-support-for-cdr-des-reminder-enabled":"AppSettings/AutoSaveNotSupportForCDRDESReminder/Enabled/$VALUE","auto-save-enabled":"MainArea/AutosaveDialog/Enabled","auto-save-disabled":"MainArea/AutosaveDialog/Disabled","auto-save-no-entries-created-warning-enabled":"MainArea/AutoSaveNoEntriesCreatedWaring/Enabled/$VALUE","steps-debug":"AppSettings/StepsDebug",cache:"AppSettings/EnableCache","ui-toolbar-alignment":"AppSettings/LeftAlignedIcons","store-textpath":"AppSettings/SaveTextLayersAsPaths","warning-unsupported-features":"AppSettings/DisableWarningMessages","cdr-warning":"AppSettings/DisableWarningsWhileOpeningCDR","cdr-unsupported-effects":"AppSettings/DisableWarningSavingUnsupportedObjectsCDR","cdr-unsupported-effect":"AppSettings/DisableWarningEditingUnsupportedObjectsCDR","eps-outline-fonts":"AppSettings/OutlineFontsInEpsImport","enable-beta":"AppSettings/EnableBeta","disable-notifications":"AppSettings/DisableNotifications","create-backup-copy":"/AppSettings/DisableBackupCopy","disable-scrubbing":"/AppSettings/DisableScrubbing"},cancel:{settings:"AppSettings/Cancel"},save:{settings:"AppSettings/SaveChanges"},change:{"decimals-num":"AppSettings/Rounding",theme:"AppSettings/ChangeTheme/$VALUE","auto-save-interval":"AppSettings/AutoSave/Interval/$VALUE","email-notification-interval":"AppSettings/EmailNotification/Interval/$VALUE"}},sharedialog:{"invalid-email":"ShareDialog/Msg/InvalidEmail",click:{copy:"ShareDialog/CopyToClipboard",save:"ShareDialog/AllowToSave",inspect:"Pro/ShareDialog/AllowToInspect",sharing:"ShareDialog/ToggleSharing/$VALUE"},"public-share":{role:"ShareDialog/PublicSharingMenu/Set$VALUE"},"private-share":{role:"ShareDialog/PrivateSharing/Set$VALUE",add:"ShareDialog/PrivateSharing/Add",invite:"ShareDialog/PrivateSharing/Invite",resend:"ShareDialog/PrivateSharing/ResendInvitation",cloud:"ShareDialog/PrivateSharing/NativeCloud",googledrive:"ShareDialog/PrivateSharing/ShareWithGoogleDrive",sharepoint:"ShareDialog/PrivateSharing/ShareWithSharePoint",onedrivebusiness:"ShareDialog/PrivateSharing/ShareWithOneDriveBusiness","corporate-googledrive":"ShareDialog/PrivateSharing/ShareWithGSuite","corporate-sharepoint":"ShareDialog/PrivateSharing/ShareWithMSO365","corporate-onedrivebusiness":"ShareDialog/PrivateSharing/ShareWithMSO365"},nonprotriespro:{save:"NonProTriesPro/ShareDialog/AllowToSave",inspect:"NonProTriesPro/ShareDialog/AllowToInspect"}},sliceproperties:{change:{size:"MainArea/Inspector/SliceProperties/LeftRightWidthHeight",background:"MainArea/Inspector/SliceProperties/CheckBackground"},trim:{transparent:"MainArea/Inspector/SliceProperties/TrimTransparent"}},symbolproperties:{select:{swap:"MainArea/Inspector/SymbolProperties/InstanceSwapDropdown"}},symbols:{new:{symbol:"MainArea/SymbolsTab/CreateNewSymbol"},click:{symbol:"MainArea/SymbolsTab/Click"},delete:{symbol:"MainArea/SymbolsTab/DeleteSymbol"}},textproperties:{change:{"vertical-align":"MainArea/Inspector/Appearance/Text/VerticalAlign/$VALUE",size:"MainArea/Inspector/Appearance/Text/Size",wordspacing:"MainArea/Inspector/Appearance/Text/WordSpacing",charspacing:"MainArea/Inspector/Appearance/Text/CharSpacing","line-height":"MainArea/Inspector/Appearance/Text/LineHeight","set-of-fonts":"MainArea/Inspector/Appearance/Text/SetOfFonts","paragraph-spacing":"MainArea/Inspector/Appearance/Text/ParagraphSpacing","paragraph-indent":"MainArea/Inspector/Appearance/Text/Indent","list-type":"MainArea/Inspector/Appearance/Text/List$VALUE",typography:{subscript:"MainArea/Inspector/Appearance/Text/SubScript",superscript:"MainArea/Inspector/Appearance/Text/SuperScript",ligatures:"MainArea/Inspector/Appearance/Text/Ligatures",fractions:"MainArea/Inspector/Appearance/Text/Fractions"},"language-script":"MainArea/Inspector/Appearance/Text/LanguageScript",language:"MainArea/Inspector/Appearance/Text/Language","stylistic-set":"MainArea/Inspector/Appearance/Text/StylisticSet",variation:"MainArea/Inspector/Appearance/Text/Variation",transformation:"MainArea/Inspector/Appearance/Text/Transformation/$VALUE","paragraph-align":"MainArea/Inspector/Appearance/Text/ParagraphAlign/$VALUE","auto-widthheight":"MainArea/Inspector/Appearance/Text/AutoWidthOrHeight/$VALUE","path-attachment":{direction:"MainArea/Inspector/Appearance/Text/OnPathDirection",offset:"MainArea/Inspector/Appearance/Text/OnPathOffset"},decoration:"MainArea/Inspector/Appearance/Text/Decoration/$VALUE","paragraph-spacing-unit":"MainArea/Inspector/Appearance/Text/ChangeParagraphSpacingUnit",orientation:"MainArea/Inspector/Appearance/Text/OnPathOrientation/$VALUE"},choose:{fontstyle:"MainArea/Inspector/Appearance/Text/Style"},scale:{content:"MainArea/Inspector/Appearance/Text/ScaleOnResize"},open:{"advanced-settings":"Pro/MainArea/Inspector/Appearance/Text/OpenAdvanced"},nonprotriespro:{"advanced-settings":"NonProTriesPro/MainArea/Inspector/Appearance/Text/OpenAdvanced"},hotkey:{"change-decoration":"MainArea/Inspector/Appearance/Text/HotKey/$VALUE"}},transformproperties:{open:{advanced:"MainArea/Inspector/Dimensions/Transform/AdvancedOpen"},change:{"move-x":"MainArea/Inspector/Dimensions/Transform/Move-X","move-y":"MainArea/Inspector/Dimensions/Transform/Move-Y","scale-x":"MainArea/Inspector/Dimensions/Transform/Scale-X","scale-y":"MainArea/Inspector/Dimensions/Transform/Scale-Y","rotate-up":"MainArea/Inspector/Dimensions/Transform/RotateUp","rotate-down":"MainArea/Inspector/Dimensions/Transform/RotateDown","skew-x":"MainArea/Inspector/Dimensions/Transform/Skew-X","skew-y":"MainArea/Inspector/Dimensions/Transform/Skew-Y",copies:"MainArea/Inspector/Dimensions/Transform/Copies"},apply:{transformation:"MainArea/Inspector/Dimensions/Transform/Apply"},toggle:{"autoscale-borders":"MainArea/Inspector/Dimensions/ToggleAutoScaleBorders","autoscale-corners":"MainArea/Inspector/Dimensions/ToggleAutoScaleCorners"}},"version-history-panel":{close:{panel:"VersionHistoryPanel/Close",preview:"VersionHistoryPanel/ClosePreview"},click:{"setting-icon":"VersionHistoryPanel/ContextMenu",disabled:"VersionHistoryPanel/ClickDisabled"},"show-preview":{"from-settings-menu":"VersionHistoryPanel/PreviewFromContext","from-main-panel":"VersionHistoryPanel/PreviewFromMainPanel"},"restore-version":{"from-settings-menu":"VersionHistoryPanel/Restore"},dblclick:{disabled:"VersionHistoryPanel/DblClickDisabled"},"apply-version":"VersionHistoryPanel/ApplyVersion","edit-version":"VersionHistoryPanel/EditThisVersion",open:{version:"VersionHistoryPanel/ClickItem"}},"action-cancelled":{export:{open:"CancelOpenFromCloud",new:"CancelNewFromCloud","save-as":"CancelSaveAsFromCloud"},anonymous:{"file.export":"CancelFileExport","file.open":"CancelOpenLocalFile","file.print":"CancelPrint"}},"import-placeimport":{open:{localfile:"PlaceOrImportFile/$VALUE"}},tools:{activate:{shortcut:"MainArea/Toolbar/Shortcut/$VALUE"}},frameproperties:{toggle:{frame:"MainArea/Inspector/FrameProperties/ToggleFrame"}},groupframeproperties:{toggle:{frame:"MainArea/Inspector/Group/ToggleFrame"}},sidebars:{activate:{sidebar:"MainArea/ActivateSidebar/$VALUE"}},"offline-dialog":{retry:"OfflineDialog/Retry",cancel:"OfflineDialog/Cancel"},"license-info":{click:{"activate-trial":"MainArea/Inspector/ActivateTrial","purchase-pro":"MainArea/Inspector/PurchasePRO"}},"profile-dialog":{tab:{account:"ProfileDialog/Tab/AccountPanel",purchase:"ProfileDialog/Tab/PurchasePanel","change-password":"ProfileDialog/Tab/ChangePasswordPanel"},"account-panel":{save:"ProfileDialog/AccountPanel/Save",delete:"ProfileDialog/AccountPanel/Delete","cleverbridge-link":"ProfileDialog/AccountPanel/CleverbridgeLink","account-setting-link":"ProfileDialog/AccountPanel/AccountSettingLink","update-user-name-link":"ProfileDialog/AccountPanel/UpdateUserNameLink"},"purchase-panel":{search:"ProfileDialog/PurchasePanel/Search",sort:"ProfileDialog/PurchasePanel/Sort/$VALUE","order-by":"ProfileDialog/PurchasePanel/OrderBy/$VALUE","activate-subscription":"ProfileDialog/PurchasePanel/ActivateSubscription","cancel-subscription":"ProfileDialog/PurchasePanel/CancelSubscription","cleverbridge-link":"ProfileDialog/PurchasePanel/CleverbridgeLink"},"change-password-panel":{"change-password":"ProfileDialog/ChangePasswordPanel/ChangePassword"},click:{"update-avatar":"ProfileDialog/UpdateAvatar","purchase-pro":"ProfileDialog/PurchasePRO"}},"user-name-config-dialog":{open:"UserNameConfigDialog/Open","update-user-name":"UserNameConfigDialog/Ok"},"permission-dialog":{"no-access":{open:"PermissionDialog/NoAccess","request-access":"PermissionDialog/NoAccess/RequestAccess","click-ok":"PermissionDialog/NoAccess/Ok"},"comment-access":{open:"PermissionDialog/CommentAccess","request-access":"PermissionDialog/CommentAccess/RequestPermission","click-ok":"PermissionDialog/CommentAccess/Ok"}},directlink:{template:{"social-media":"DirectLink/Template/SocialMedia/$VALUE",presentation:"DirectLink/Template/Presentation/$VALUE",poster:"DirectLink/Template/Poster/$VALUE","facebook-post":"DirectLink/Template/FacebookPost/$VALUE","blog-graphic":"DirectLink/Template/BlogGraphic/$VALUE",card:"DirectLink/Template/Card/$VALUE"},preset:{print:"DirectLink/Preset/Print/$VALUE","web-desktop":"DirectLink/Preset/WebDesktop/$VALUE","social-media":"DirectLink/Preset/SocialMedia/$VALUE",devices:"DirectLink/Preset/Devices/$VALUE","print-on-demand":"DirectLink/Preset/PrintOnDemand/$VALUE"}},"login-signup":{login:{open:"LoginSignup/Login",help:"LoginSignup/Login/Help",login:"LoginSignup/Login/Login","forgot-password":"LoginSignup/Login/ForgotYourPassword","login-facebook":"LoginSignup/Login/LoginWithFacebook","login-google":"LoginSignup/Login/LoginWithGoogle","login-microsoft":"LoginSignup/Login/LoginWithMicrosoft","create-free-account":"LoginSignup/Login/CreateFreeAccount","learn-more":"LoginSignup/Login/LearnMore"},"forgot-password":{help:"LoginSignup/ForgotYourPassword/Help","send-request":"LoginSignup/ForgotYourPassword/SendRequest","back-to-login":"LoginSignup/ForgotYourPassword/GoBackToLogin","learn-more":"LoginSignup/ForgotYourPassword/LearnMore"},"create-account":{open:"LoginSignup/CreateAccount",help:"LoginSignup/CreateAccount/Help","back-to-login":"LoginSignup/CreateAccount/GoBackToLogin","i-agree":"LoginSignup/CreateAccount/IAgree",subscribe:"LoginSignup/CreateAccount/Subscribe","create-account":"LoginSignup/CreateAccount/CreateAccount","login-facebook":"LoginSignup/CreateAccount/LoginWithFacebook","login-google":"LoginSignup/CreateAccount/LoginWithGoogle","login-microsoft":"LoginSignup/CreateAccount/LoginWithMicrosoft","terms-of-use":"LoginSignup/CreateAccount/TermsOfUse","privacy-policy":"LoginSignup/CreateAccount/PrivacyPolicy","learn-more":"LoginSignup/CreateAccount/LearnMore"},"account-created":{"try-pro":"LoginSignup/AccountCreated/TryOutPro","get-started-free":"LoginSignup/AccountCreated/GetStartedFree","send-activation-email":"LoginSignup/AccountCreated/SendActivationEmail","learn-more":"LoginSignup/AccountCreated/LearnMore"}},"corel-login":{"sign-in":{open:"SignIn","forgot-password":"SignIn/ForgotPassword","sign-in":"SignIn/SignIn","learn-more":"SignIn/LearnMore"},"enterprise-sign-in":{open:"SignIn/EnterpriseSignIn",gsuite:"SignIn/Enterprise/GSuite",mso365:"SignIn/Enterprise/MSO365","go-back":"SignIn/Enterprise/Back"},"guest-sign-in":{open:"SignIn/SignInAsGuest","send-link":"SignIn/SignInAsGuest/Send","resend-link":"SignIn/SignInAsGuest/Resend"}},"open-shared":{click:{login:"OpenShared/Login","create-account":"OpenShared/CreateAccount","learn-more":"OpenShared/LearnMore"}},virtualkey:{assistantbar:{click:{5:"Touch/MainArea/AssistantBar/VirtualKey/Control",6:"Touch/MainArea/AssistantBar/VirtualKey/Shift",7:"Touch/MainArea/AssistantBar/VirtualKey/Alt",8:"Touch/MainArea/AssistantBar/VirtualKey/Left",9:"Touch/MainArea/AssistantBar/VirtualKey/Up",10:"Touch/MainArea/AssistantBar/VirtualKey/Right",11:"Touch/MainArea/AssistantBar/VirtualKey/Down"}}},touchmenu:{"go-to-master":"Touch/MainArea/ContextualMenu/GoToMaster","crop-image":"Touch/MainArea/ContextualMenu/CropImage","original-size":"Touch/MainArea/ContextualMenu/OriginalSize","replace-image":"Touch/MainArea/ContextualMenu/ReplaceImage","lock-layer":"Touch/MainArea/ContextualMenu/LockLayer","hide-layer":"Touch/MainArea/ContextualMenu/HideLayer"},"touch-dialog":{open:"MainArea/TouchDialog","unsupport-size":"MainArea/UnsupportedScreensizeDialog",click:{ok:"MainArea/TouchDialog/Ok",cancel:"MainArea/TouchDialog/Cancel"}},msteams:{open:"OpenFile",create:"NewFile","template-category":"Template Category",template:"Template"},memorywarningdialog:{open:"MainArea/LowMemoryWarning"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(716),o=n(12);const r=window&&window.location&&"localhost"===window.location.hostname;var a={getAppBaseUrl:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(i.nodeEnv){case"production":return o.prodURL;case"lts":return o.ltsURL;case"rc":return o.rcURL}return i.isBeta?o.betaURL:e&&r?"http://localhost:9000":o.trunkURL}};t.default=a},function(e,t,n){"use strict";n(3);var i=n(1);function o(e){this.item=e}i.GObject.inherit(o,i.GEvent),o.item=null,o.prototype.toString=function(){return"[Object GMenuActivateEvent]"},o.EVENT=new o,e.exports=o},function(e,t,n){"use strict";var i=n(17);n(14),n(29),n(9),n(84),n(115),n(321),n(3),n(132),n(45),n(19),n(24);var o=n(1),r=n(16),a=n(12),s=n(322),l=i(n(217)),c=i(n(308)),d=i(n(1376)),u=i(n(1377)),p=i(n(545)),g=i(n(78)),h=i(n(200)),f=i(n(77)),m=i(n(106)),y=i(n(400)),v=i(n(401)),_=i(n(770)),b=i(n(1138)),w=i(n(1140)),C=i(n(348)),E=i(n(202)),S=i(n(36)),G=i(n(771)),A=i(n(151)),T=i(n(144)),P=n(238),L=n(1389);const D=n(232);let x=null;a.LICENSE.UPGRADEABLE&&(x=n(544));const I=n(118),O=n(351),k=n(718),{InParenthesis:{NotNegativeNumberInTheEnd:F},NotNegativeNumber:R}=P.GRegex.String,M=[{title:new o.GLocaleKey("GFilesPanel","action.rename"),shortcut:null,callback:function(e,t){const n=this,i=e.getDocument(),r=i.getStorageItem();let s=!0;if(r&&(s=!(r instanceof C.default.Item)),!s)return!1;const l=()=>{const s=t.find("input"),c=e.getTitle();let d=c;r&&a.USE_EXTENSION_IN_FILENAME&&(d+="."+r.getExtension().toLowerCase()),s.off("focusout"),s.off("keypress");var u=t.find("span.cover");u.text(d),s.css("width",u.outerWidth()),s.val(c);var p=s.val(),h=!1;s.show(),u.hide(),s.focus();var f=async function(){try{s.hide(),u.show();let d,h=s.val().trim();if(h&&h!==c)if(r){if(n._updateSyncStatus(t,o.GLocale.get(new o.GLocaleKey("GCommonNames","text.synchronizing"))+"...",!0),r instanceof E.default.Item){let e=r.getFile();const c=new G.default;try{let i=0;if(c.supportsSaveCollisionFlow()){if(e.ext||(e.ext=a.FILE_FORMATS.find(e=>e.default).ext.toUpperCase()),await c.fileExists(h,e.ext,e.parent||c.getRootFolder())&&!await(e=>{let t;return t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.file-already-exists-on-current-location")).replace("%filename",'"'.concat(e,'"')),new Promise(e=>{S.default.confirm(t,t=>e(!!t),null,null,!1,!0,!0)})})(h))return n._updateSyncStatus(t,""),l();if(c.requiresOverwriteCollisionHandling())for(d=h;await c.fileExists(d,e.ext,e.parent||c.getRootFolder());)d="".concat(h," (").concat(++i,")")}d||(d=h),await c.renameItem(e,d)}catch(e){return console.log(">>>.error-renaming e",e),s.val(p),n._updateSyncStatus(t,o.GLocale.get(new o.GLocaleKey("GCommonNames","text.failed-to-synch")),!1,!1,!0,i.isCloudFile()),void S.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-renaming")))}e.name=d}else d=h;i.setTitle(d),r.setFileName(d),gDesigner.trigger(new g.default(g.default.Type.Modified,i)),n._updateSyncStatus(t,""),u.text(d+(a.USE_EXTENSION_IN_FILENAME?"."+r.getExtension().toLowerCase():"")),s.css("width",u.outerWidth())}else e.getDocument().setTitle(h);else s.val(p)}catch(e){throw e}};s.on("focusout",(function(){h||(f(),h=!0)})).on("keypress",(function(e){13!==e.which||h||(f(),h=!0)}))};return l(),!0},stats:"header_contextmenu_rename",requiresPro:!1,isEnabled:()=>gDesigner.getApplicationManager().isEditingEnabled(),isVisible:e=>{const t=e.getDocument().getStorageItem();return!(t&&t instanceof C.default.Item)}},{separator:!0,isVisible:e=>{const t=e.getDocument().getStorageItem();return!(t&&t instanceof C.default.Item)}},{title:y.default.TITLE,shortcut:y.default.SHORTCUT,id:y.default.ID,needsAction:!0,stats:"header_contextmenu_save",icon:()=>gDesigner.getAction(y.default.ID).getIcon(),requiresPro:!1},{title:new o.GLocaleKey("GSaveAsAction","title"),shortcut:[r.GKey.Constant.SHIFT,r.GKey.Constant.META,"S"],id:()=>"".concat(v.default.ID,".").concat(v.default.Actions.SaveAs),needsAction:!0,requiresPro:!1},{separator:!0},{title:new o.GLocaleKey("GToolbar","text.share"),shortcut:null,callback:function(){gDesigner.getShareManager().share()},stats:"header_contextmenu_share",isEnabled:e=>{const t=e.getDocument().getStorageItem();return gDesigner.getApplicationManager().isShareEnabled()&&t instanceof E.default.Item},requiresPro:!1},{title:new o.GLocaleKey("GOpenSharedFileAction","title"),stats:"header_contextmenu_open-shared-file",id:()=>b.default.ID,needsAction:!0,requiresPro:!1},{title:new o.GLocaleKey("GVersionsHistoryAction","title"),shortcut:null,stats:"header_contextmenu_version-history",icon:()=>gDesigner.getAction(w.default.ID).getIcon(),id:w.default.ID,needsAction:!0,requiresPro:!0},{title:_.default.TITLE,shortcut:_.default.SHORTCUT,stats:"header_contextmenu_advanced-export",icon:()=>gDesigner.getAction(_.default.ID).getGroupIcon(),id:_.default.ID,needsAction:!0,requiresPro:!0},{title:new o.GLocaleKey("GHeader","action.context-menu.duplicate"),shortcut:null,callback:function(e){const t=e.getDocument(),n=t.getStorageItem(),i=()=>{const e=t.getScene(),n=new T.default(e.clone(null,gDesigner.getWorkspace()));t.getFileFormatVersion()&&n.setFileFormatVersion(t.getFileFormatVersion());const i=t.getTitle();let o;if(new RegExp(F).test(i)){const e=i.match(F),t=parseInt(e[0].match(R)[0]);o=i.replace(F,"(".concat(t+1,")"))}else o="".concat(i,"(1)");const r=gDesigner.getDocuments().indexOf(t);n.setTitle(o),gDesigner.addDocument(n,r+1)};n&&n instanceof E.default.Item?(()=>{const e=n.getFile().parent,i=gDesigner.getDocuments().indexOf(t),o=new G.default;o.setCurrentFolder(A.default.from({id:e})),o.copyPaste([n.getFile()]).then((function(e){let[{id:t}]=e;return o.openFile(t,i+1)}))})():i()},isEnabled:e=>{if(!gDesigner.getApplicationManager().isSavingAsEnabled())return!1;return!(e.getDocument().getStorageItem()instanceof C.default.Item)},stats:"header_contextmenu_duplicate",icon:"gravit-icon-duplicate",requiresPro:!1},{separator:!0},{title:new o.GLocaleKey("GHeader","action.context-menu.close-other"),shortcut:null,callback:function(e){const t=gDesigner.getWindows().getWindows().slice().filter(t=>t!==e);S.default.confirm(o.GLocale.get(new o.GLocaleKey("GHeader","text.close-other-tabs-confirmation")),e=>{e&&N(t)},null,null,null,!0,!0)},isEnabled:e=>gDesigner.getWindows().getWindows().slice().filter(t=>t!==e).length>0,stats:"header_contextmenu_close-other",requiresPro:!1},{title:new o.GLocaleKey("GHeader","action.context-menu.close-all"),shortcut:null,callback:function(){S.default.confirm(o.GLocale.get(new o.GLocaleKey("GHeader","text.close-all-tabs-confirmation")),e=>{e&&N(gDesigner.getWindows().getWindows().slice())},null,null,null,!0,!0)},stats:"header_contextmenu_close-all",icon:"gravit-icon-close",requiresPro:!1}];function N(e){const t=gDesigner.getWindows();for(let n=0,i=e.length;n<i;n++){const i=e[n];t.removeWindow(i)}}function B(e){this._htmlElement=e,this._menuBar=new d.default(gDesigner.getMainMenu()),this._menuBar.__which="menubar",this._personaBar=new u.default}B.prototype._personaBar=null,B.prototype._menuBar=null,B.prototype._windows=null,B.prototype._login=null,B.prototype._busy=null,B.prototype._contextMenu=null,B.prototype.getMenuBar=function(){return this._menuBar},B.prototype.init=function(){s.SHOW_BETA_BRANDING&&gDesigner.isBeta()&&$("<div></div>").css({width:"40px",backgroundColor:"#29d029",color:"#fff",font:'400 1em "Helvetica Neue", Helvetica, Arial, sans-serif',lineHeight:"1.54em",textAlign:"center",borderRadius:"4px",marginLeft:"12px",marginRight:"-5px",padding:"2px"}).text("βETA").appendTo(this._htmlElement),$("<div></div>").addClass("section menu").append(this._menuBar._htmlElement).appendTo(this._htmlElement),a.LICENSE.UPGRADEABLE&&gDesigner.getLicense().canUpgrade()&&$("<div></div>").addClass("section tryout").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.try-out-coreldrawpp-pro")))).on("click",()=>gDesigner.activateTrialLicense()).appendTo(this._htmlElement),$("<div></div>").addClass("section persona").append(this._personaBar._htmlElement).appendTo(this._htmlElement),this._windows=$("<div></div>").addClass("section windows").append(this._createWindows()).appendTo(this._htmlElement),a.ALLOW_REARRANGE_TABS&&(0,L.allowRearrangeTabs)(this._htmlElement),this._busy=$("<div></div>").addClass("section busy").css({display:"none",color:"$(BRAND_COLOR}"}).append($("<span>").addClass("txt").css({marginRight:"4px"})).append($("<span>").css({border:"4px solid #f3f3f3",borderTop:"4px solid $(BRAND_COLOR}",borderRadius:"50%",width:"6px",height:"6px",animation:"spin 2s linear infinite"})).appendTo(this._htmlElement),this._createLoginTab().appendTo(this._htmlElement),this.updateLoginInfo(),this.checkUser(),gDesigner.addEventListener(g.default,this._documentEvent,this),gDesigner.addEventListener(I,this._settingChangedEvent,this),gDesigner.getWindows().addEventListener(p.default.WindowEvent,this._windowEvent,this),gDesigner.addEventListener(k,this._userPropertiesChangedEvent,this),gDesigner.addEventListener(O,this._applicationStateChangedEvent,this),$(document).on("networkAvailable",function(){this.checkUser()}.bind(this)),a.LICENSE.UPGRADEABLE&&gDesigner.addEventListener(x,this._licenseChangeEvent,this),this._documentStatusEvent=this._documentStatusEvent.bind(this),this._personaBar.init(),this._updateViewBasedOnPermissions()},B.prototype._updateViewBasedOnPermissions=function(){const e=gDesigner.getApplicationManager().isDocumentTabManagementEnabled();this._windows.find(".tabs").css("display",e?"":"none"),(0,L.toggleRearrangeTabsVisibility)(this._htmlElement,e)},B.prototype.relayout=function(){gDesigner.getApplicationManager().isInspectEnabled()?this._htmlElement.removeClass("lone"):this._htmlElement.addClass("lone")},B.prototype._licenseChangeEvent=function(e){a.LICENSE.UPGRADEABLE&&(e.license.isDefault()||this._htmlElement.find(".tryout").remove())},B.prototype._documentEvent=function(e){a.ALLOW_REARRANGE_TABS&&(0,L.updateTabsInterface)();var t=e.document||gDesigner.getActiveDocument(),n=this.getWindowTab(gDesigner.getWindows().getWindow(t)),i=e.type===g.default.Type.StorageItemUpdated;if(i||e.type===g.default.Type.AutoSaveSynchronized||e.type===g.default.Type.Modified){i&&this.updateWindowIcon($(".windows").find(".tab.g-active"));for(var r=e.document.getWindows(),s=0;s<r.length;++s)this._windows.find(".tab").each((function(t,n){var i=$(n);if(i.data("window")===r[s])return i.find(".title").find(".cover").html(r[s].getTitleWithExtension()+(e.document.isModified()?"*":"")),i.find(".title").find("input").val(r[s].getTitle()+(e.document.isModified()?"*":"")),!1}));e.type!==g.default.Type.Modified&&e.type!==g.default.Type.AutoSaveSynchronized||(this._updateSyncStatus(n,""),this.updateWindowIcon(n,!1,!0,t))}else e.type===g.default.Type.SynchronismUpdated||e.type===g.default.Type.AutoSaveSynchronizing?(t.isSynchronizing()||e.type===g.default.Type.AutoSaveSynchronizing)&&(this.updateWindowIcon(n,!0,!0,t),this._updateSyncStatus(n,o.GLocale.get(new o.GLocaleKey("GCommonNames","text.synchronizing"))+"...",!0)):e.type===g.default.Type.SynchronismUpdateFailed||e.type===g.default.Type.AutoSaveSynchronizationFailed?this._updateSyncStatus(n,o.GLocale.get(new o.GLocaleKey("GCommonNames","text.failed-to-synch")),!1,!1,!0,t.isCloudFile()):e.type===g.default.Type.Activated?e.document.addEventListener(h.default,this._documentStatusEvent):e.type===g.default.Type.Deactivated&&e.document.removeEventListener(h.default,this._documentStatusEvent)},B.prototype._documentStatusEvent=function(e){e.status===f.default.Loaded&&this.updateWindowIcon($(".windows").find(".tab.g-active"))},B.prototype._settingChangedEvent=function(e){"touch"!==e.key||gDesigner.isTouchEnabled()||this._menuBar.setMenu(gDesigner.getMainMenu())},B.prototype._userPropertiesChangedEvent=function(e){this.updateLoginInfo(e.user)},B.prototype._applicationStateChangedEvent=function(){this._updateViewBasedOnPermissions()},B.prototype._windowEvent=function(e){switch(e.type){case p.default.WindowEvent.Type.Added:this._addWindowTab(e.window,e.index);break;case p.default.WindowEvent.Type.Removed:this._removeWindowTab(e.window);break;case p.default.WindowEvent.Type.Activated:case p.default.WindowEvent.Type.Deactivated:this._updateActiveWindowTab()}},B.prototype._addWindowTab=function(e,t){var n=this,i=$("<div></div>").data("window",e).addClass("tab");const o=this._windows.find(".tabs").find(".tab");"number"==typeof t&&t!==o.length?i.insertBefore(o.eq(t)):i.appendTo(this._windows.find(".tabs")),i.append($("<div />").addClass("title").append($("<span />").addClass("cover").html(e.getTitleWithExtension())).append($("<input />").attr("type","text").css("display","none").val(e.getTitle()).css("width",i.find(".cover").outerWidth()))).on("click",(function(){gDesigner.stats("header_change_tab",e.getTitleWithExtension()),gDesigner.getWindows().activateWindow($(this).data("window"),!0)})),i.on("contextmenu",(function(t){t.stopPropagation(),n.handleContextMenu(e,i)})),gDesigner.getLicense().isGuest()||i.append($("<span></span>").addClass("close").html("&#x2715;").on("click",(function(e){gDesigner.stats("header_remove_tab"),e.stopPropagation(),gDesigner.getWindows().removeWindow($(this).parents(".tab").data("window"),void 0,void 0,!0)})))},B.prototype._createLoginTab=function(){var e=$("<div/>").addClass("section login").append($("<div/>").addClass("avatar")).append($("<div/>").addClass("username").append($("<span/>"))).on("click",(function(){gDesigner.stats("header_click_login"),"yes"!==$(this).attr("has-been-clicked")&&($(this).attr("has-been-clicked","yes"),gDesigner.getUser().then(t=>{t&&!gDesigner.isAnonymous()?e.gUserLogin():m.default.performLogin(),$(this).attr("has-been-clicked","no")}))}));return e},B.prototype.checkUser=function(){return gDesigner.getUser().then(e=>{this.updateLoginInfo(e)})},B.prototype.updateLoginInfo=function(e){$(".login").css("display",e&&e.isAnonymous()?"none":""),$(".login .username").find("span").text(e?e.getFullUserName():o.GLocale.get(new o.GLocaleKey("GCommonNames","text.cloud-login"))),e?e.hasOwnPictureAvatar()?($(".login .avatar").css("background-image",'url("'+e.avatar+'")'),$(".login .avatar").removeClass("gravit-user-bonhomme"),$(".login .avatar").css({"background-color":"transparent"}),$(".login .avatar").text("")):$(".login .avatar").addClass("gravit-user-bonhomme").text(e.getUserNameInitials()).css({"background-color":e.getUserColor()}):$(".login .avatar").css("background-image","none"),$(".login .avatar").removeClass(e?"header-cloud":"user-avatar"),$(".login .avatar").addClass(e?"user-avatar":"header-cloud"),e?$(".login").addClass("user"):$(".login").removeClass("user")},B.prototype._removeWindowTab=function(e){this._windows.find(".tab").each((function(t,n){var i=$(n);if(i.data("window")===e)return i.remove(),!1}))},B.prototype._updateActiveWindowTab=function(){this._windows.find(".tab").each((function(e,t){var n=$(t);n.toggleClass("g-active",n.data("window")===gDesigner.getWindows().getActiveWindow())}))},B.prototype._createWindows=function(){return $("<div></div>").addClass("tabs")},B.prototype.getHeight=function(){return this._htmlElement[0].clientHeight},B.prototype.updateWindowIcon=function(e,t,n,i){var o=$(e).find(".header-cloud"),r=i||gDesigner.getActiveDocument();r&&(r.isCloudFile()||r.isExternalFile())||t?0===o.length&&$("<span/>").addClass("header-cloud").addClass(this._getCloudDocumentIconClass(r)).insertBefore($(e).find(".close")):n&&o.length>0?o.fadeOut(2e3,(function(){o.remove()})):o.remove()},B.prototype.showBusyIcon=function(e){this._busy.find(".txt").text(e),this._busy.css({display:"inherit"})},B.prototype.hideBusyIcon=function(){this._busy.css({display:"none"})},B.prototype._updateSyncStatus=function(e,t,n,i,o,r){var a=$(e).find(".sync-status");const s="."+D["header-cloud"];if($(e).find(s).length>0&&(n?$(e).find(s).addClass("animated"):$(e).find(s).removeClass("animated")),i&&$(e).find(s).length>0&&$(e).find(s).addClass("animated"),a&&0!==a.length||$("<span/>").addClass("sync-status").insertAfter($(e).find(".close")),$(e).find(".sync-status").text(t),o){$(e).find(".sync-status").fadeOut(2e3,(function(){$(e).find(".sync-status").remove()}));var l=$(e).find(s);l.length>0&&!r&&l.fadeOut(2e3,(function(){$(e).find(".close").css("margin-left","0px"),l.remove()}))}},B.prototype.getWindowTab=function(e){for(var t=this._windows.find(".tabs").find(".tab"),n=null,i=0;i<t.length;++i)if($(t[i]).data("window")===e){n=t[i];break}return n},B.prototype.handleContextMenu=function(e,t){var n=t.outerWidth()-10;t.addClass("context-pane-opened"),gDesigner.stats("header_contextmenu_tab","Contextmenu"),gDesigner.getWindows().activateWindow(e),this._contextMenu=this._createContextMenu(e,t),this._contextMenu.gOverlay({padding:!1,releaseOnClose:!0,clazz:"g-header-context-overlay",bottomClazz:"from-bottom",customRight:n,offsetY:-13,closeCallback:()=>{t.removeClass("context-pane-opened")}}).gOverlay("open",t)},B.prototype._createContextMenu=function(e,t){const n=new l.default,i=this;return M.map(r=>{let a,s,{title:l,callback:d,shortcut:u,requiresPro:p,separator:g,icon:h,id:f,needsAction:m,stats:y,isEnabled:v,isVisible:_}=r;const b=l instanceof o.GLocaleKey?o.GLocale.get(l):l;if(f&&(a="function"==typeof f?f():f),g){const t=n.createAddDivider();return _ instanceof Function?t.setVisible(_(e)):"boolean"==typeof _&&t.setVisible(_),t}d?s=n.createAddItem(b,()=>{d.call(i,e,t)}):(s=n.createAddItem(b),m&&s.setAction(gDesigner.getAction(a))),u&&s.setShortcutHint(u),p&&s.setPro(p,a),v instanceof Function&&s.setEnabled(v(e)),_ instanceof Function?s.setVisible(_(e)):"boolean"==typeof _&&s.setVisible(_),h&&("function"==typeof h?s.setIcon(h()):s.setIcon(h)),s.addEventListener(c.default.BeforeActivateEvent,()=>{!function(e){e&&gDesigner.stats(e);i._contextMenu.gOverlay("close"),i._contextMenu=null,n.clearItems()}(y),v&&s.setEnabled(v(e))}),s.setCaption(b)}),n.getHtmlElement()},B.prototype._getCloudDocumentIconClass=function(e){var t="",n=e.getStorageItem();switch(n?n.toString():null){case"[Object GGoogleDriveStorage.Item]":t=D["gravit-icon-googledrive-cloud-file"];break;case"[Object GSharePointStorage.Item]":t=D["gravit-icon-sharepoint-cloud-file"];break;case"[Object GOneDriveBusinessStorage.Item]":t=D["gravit-icon-onedrivebusiness-cloud-file"];break;default:t=D["gravit-icon-cloud"]}return t},e.exports=B},function(e,t,n){"use strict";n(3);var i=n(217),o=n(308),r=n(1045);function a(e){this._htmlElement=$("<nav></nav>").addClass("g-menu-bar"),this.setMenu(e||new i(this))}a.prototype._menu=null,a.prototype.getMenu=function(){return this._menu},a.prototype.isActive=function(){var e=r.getActiveMenu();return!!(e&&e._parent&&e._parent instanceof o)&&e._parent.getMenuBar()===this},a.prototype.getParent=function(){return null},a.prototype.setMenu=function(e){e.detach(),this._menu=e,this._menu._parent=this,this._menu._htmlElement.addClass("g-menu-root"),this._htmlElement.append(this._menu._htmlElement),e.update()},a.prototype.toString=function(){return"[Object GMenuBar]"},e.exports=a},function(e,t,n){"use strict";n(28);var i=n(1131),o=n(1135);e.exports=class{constructor(){this._htmlElement=$("<div></div>").addClass("g-persona-bar"),this._container=$("<div></div>").addClass("g-persona-container").appendTo(this._htmlElement)}init(){var e=Object.keys(i.GPersona);e.length>1&&(gDesigner.addEventListener(o,this._personaChangeEvent,this),e.forEach(e=>{var t=i.GPersona[e];$("<div></div>").data("persona",t).attr("data-title",t.name).addClass("g-persona-item").append($("<img>").attr("src",t.icon)).on("click",e=>{gDesigner.stats("persona_click_activate-button");var t=$(e.target).closest(".g-persona-item").data("persona");gDesigner.activatePersona(t)}).appendTo(this._container)}),this._activate(gDesigner.getActivePersona()))}_activate(e){this._htmlElement.find(".g-persona-item").removeClass("g-active"),this._htmlElement.find(".g-persona-item").each((function(t,n){var i=$(n);if(i.data("persona")===e)return i.addClass("g-active"),!1}))}_personaChangeEvent(e){this._activate(e.newPersona)}}},function(e,t,n){"use strict";n(3),n(261),n(14),n(29);var i=n(43),o=n(1),r=n(16),a=n(32),s=n(12),l=n(77),c=n(200),d=n(78),u=(n(143),n(398)),p=n(230),g=(n(144),n(395));const h=s.FILE_FORMATS.find(e=>e.default).ext;function f(e,t){this._container=$("<div></div>").addClass("window"),this._overlay=$("<div></div>").addClass("window-overlay").append($("<div></div>").addClass("window-overlay-container").append($("<div></div>").addClass("window-overlay-content"))),this._document=e,this._document.addEventListener(c,this._documentStatusChanged,this,void 0,void 0,!0),gDesigner.addEventListener(d,this._documentEvent,this),this._container.on("mousedown",function(e){this._view&&this._view.focus()}.bind(this)),t&&(this._isPreview=t),this._updateScene()}o.GObject.inherit(f,o.GEventTarget),f.VIEW_MARGIN=10,f.prototype._requiresViewTransformation=!0,f.prototype._container=null,f.prototype._document=null,f.prototype._view=null,f.prototype._overlay=null,f.prototype._contextMenuClientPosition=null,f.prototype._isPreview=!1,f.prototype.isPreview=function(){return this._isPreview},f.prototype.getDocument=function(){return this._document},f.prototype.getView=function(){return this._view},f.prototype.getTitle=function(){var e=this._document.getTitle(),t=this._document._windows.indexOf(this);return t>0&&(e+=":"+t.toString()),e},f.prototype.getTitleWithExtension=function(){var e=this.getTitle();if(this._document.getStorageItem()&&s.USE_EXTENSION_IN_FILENAME){const t="."+this._document.getStorageItem().getExtension().toLowerCase();if(!e.endsWith(t))return e+t}return e},f.prototype.activate=function(e){this._view&&(this._requiresViewTransformation&&(1===this._view.getZoom()&&0===this._view.getScrollX()&&0===this._view.getScrollY()||e)&&this.centerAndZoom(),this._requiresViewTransformation=!1,this._view.setRulers(gDesigner.getSetting("rulers_visible")),$("#mainframe").toggleClass("rulers",gDesigner.getWindows().getActiveWindow().getView().hasRulers()),this._view.getViewConfiguration().guideLinesVisible=gDesigner.getSetting("guide_lines_visible"),this._view.getViewConfiguration().symbolLabelsVisible=gDesigner.getSetting("symbol_labels_visible"),this._view.getViewConfiguration().gridVisible=!0,this._view.focus())},f.prototype.deactivate=function(){if(this._document){var e=this._document.getEditor();e&&e.closeInlineEditor(),this._view.cleanCache()}},f.prototype.relayout=function(e,t,n,i){if(this._view){this._container.width(e),this._container.height(t),this._view.setViewOffset(n);var o=this._view.getWidth(),r=this._view.getHeight();this._view.resize(e,t,i,()=>{o&&r&&(o!=e||r!=t)&&this._view.scrollBy((o-e)/2,(r-t)/2)})}this._overlay.css({left:(n?n[0]:0)+"px",top:(n?n[1]:0)+"px",right:(n?n[2]:0)+"px",bottom:(n?n[3]:0)+"px"})},f.prototype.release=function(){this._releaseScene(),this._releaseView(),this._document.removeEventListener(c,this._documentStatusChanged,this),gDesigner.removeEventListener(d,this._documentEvent,this),p.getInstance().releaseDocumentListener(this._document.sessionId)},f.prototype.centerAndZoom=function(){var e=this._document.getScene(),t=e.getActivePage(),n=e.getPaintBBox();if(t)if(this._view.getViewConfiguration().multiPageView){var i=t.getPosition(1),r=t.getPaintBBox(1);r&&(n=r.translated(i.getX(),i.getY()))}else if(g.CDR_ORIGIN_PROPERTY_NAME&&t.getProperty(g.CDR_ORIGIN_PROPERTY_NAME,!0)){var a=t.getContentBBox();n=a&&!a.isEmpty()?a:t.getPaintBBox()}else n=t.getPaintBBox();else e.isFixedSized()&&(n=new o.GRect(0,0,e.getProperty("w"),e.getProperty("h")));var s=this._view.getViewBox(!0);!n||n.isEmpty()||s.isEmpty()?this._view.zoomAt(new o.GPoint(0,0),1):n.getWidth()>=s.getWidth()||n.getHeight()>=s.getHeight()?this._view.zoomAll(n,!1):this._view.zoomAtCenter(n.getSide(o.GRect.Side.CENTER),1)},f.prototype.viewContainsMouse=function(e,t){if(!this._view)return!1;var n=this._view.getViewOffset(),i=n[0],o=n[1],r=this._view.getWidth()-n[2],a=this._view.getHeight()-n[3];return!(e<i||e>r||t<o||t>a)},f.prototype._releaseView=function(){this._view&&(this._view.release(),this._view=null)},f.prototype._releaseScene=function(){this._view&&this._view.getScene()&&(this._view.getScene().removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._sceneAfterPropertiesChanged,this),this._view.getScene().removeEventListener(o.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this))},f.prototype.activateProgress=function(e,t){return this._setOverlayContent($("<div></div>").append($("<span></span>").append($("<p></p>").addClass("text").text(e)).append($("<progress>").attr({min:"0",max:"100"}).css("width","200px").val(0)).append($("<p></p>").css("display","none").addClass("progress-info"))).append($("<div></div>").append($("<button></button>").addClass("cancel-loading").css("display","none"))),t)},f.prototype.deactivateProgress=function(){this._setOverlayContent(null)},f.prototype.activateCancelLoading=function(e){var t=this;this._overlay.find(".cancel-loading").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.cancel-loading"))).on("click",(function(){e(),t.deactivateProgress()})).css("display","")},f.prototype._setOverlayContent=function(e,t){if(e){if(this._overlay.appendTo(this._container).find(".window-overlay-content").empty().append(e),t){var n=this;this._overlay.on("click",(function(){n._overlay.unbind("click",this),n._setOverlayContent(null)}))}}else this._overlay.remove();return this._overlay},f.prototype._documentEvent=function(e){e.type===d.Type.StorageItemUpdated&&this._updateViewConfiguration()},f.prototype._documentStatusChanged=function(e){switch(e.status){case l.Ready:this._updateScene(),gDesigner.saveStats();break;case l.Loading:case l.Saving:case l.Syncing:case l.Downloading:var t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading")),n=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-file"));e.status===l.Saving?(t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.saving")),n=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.saving-file"))):e.status===l.Syncing?(t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.synchronizing")),n=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.synchronizing-file"))):e.status===l.Downloading&&(t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.downloading")),n=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.downloading-file")));let c=e.data&&e.data.filename?e.data.filename:this._document.getTitle();c&&(n=n.replace("%name",c));let d=c?n+"...":o.GLocale.get(new o.GLocaleKey("GDocument","text.opening-your-image"));this.activateProgress(d,e.data&&e.data.cancelHandlerHolder?e.data.cancelHandlerHolder:null),e.data.text=(e,t)=>this._overlay.find(".text").text(c&&!t?n:e),e.data.progressInfo=e=>this._overlay.find(".progress-info").text(e).css("display",e?"":"none");var i=0,r=(new Date).getTime(),s=e.data.progress;e.data.progress=function(e){var t,n,o=(new Date).getTime();if(100===e||e-i>=.5&&o-r>=40){r=o;var l=this._overlay.find("progress");l.val(e),i=e;t=l[0],n=t.style.display,t.style.display="none",t.offsetHeight,t.style.display=n,t.offsetHeight,l.hide(0,(function(){$(this).show(),$(this)[0].offsetHeight})),s&&(0,a.isFunction)(s)&&s(e)}}.bind(this);break;case l.LoadCancelled:case l.DownloadCancelled:case l.SaveCancelled:this._setOverlayContent(null);break;case l.Saved:this._document.setErrored(!1),gDesigner.intercomStats("File saved/exported"),this._setOverlayContent(null);break;case l.Loaded:this.centerAndZoom(),gDesigner.intercomStats("File opened");break;case l.SyncFailed:case l.Downloaded:case l.DownloadFailed:this._setOverlayContent(null);break;case l.LoadFailed:t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed"));!e.data||!e.data.text||e.data.text instanceof Function||(t=e.data.text),this._setOverlayContent($("<span></span>").text(t));break;case l.SaveFailed:if(this._document.setErrored(!0),this._document.isCollaborativeTextEditing())return;this._setOverlayContent($("<span></span>").css({padding:"6px",display:"inline-block",backgroundColor:"#333",borderRadius:"6px"}).append($("<p></p>").text("string"==typeof e.data?e.data:o.GLocale.get(new o.GLocaleKey("GCommonNames","text.unable-to-save"))).css({lineHeight:"1.5em",margin:"10px"})).append($("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))).on("click",function(){this._document.updateStatus(l.SaveCancelled),this._setOverlayContent(null)}.bind(this)).css({margin:"10px"})).append($("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.try-again"))).on("click",function(){this._document&&gDesigner.executeAction(u.ID+"."+h,[null,this._document,null],"failedalertdialog")}.bind(this)).css({margin:"10px"})))}},f.prototype._updateScene=function(){if(!this._view||this._document.getScene()!==this._view.getScene()){this._releaseScene(),this._releaseView();const e=this._document.getStatus();!this._document.getScene()||e!==l.Ready&&e!==l.Locked||(this._view=new i.GEditorWidget(this._document.getEditor()),this._updateViewConfiguration(),this._view.setViewMargin([f.VIEW_MARGIN,f.VIEW_MARGIN,f.VIEW_MARGIN,f.VIEW_MARGIN]),this._container.empty().append(this._view._htmlElement),this._updateWindowBackground(),this._view.getScene().addEventListener(o.GNode.AfterPropertiesChangeEvent,this._sceneAfterPropertiesChanged,this,void 0,void 0,!0),this._view.getScene().addEventListener(o.GNode.AfterFlagChangeEvent,this._afterFlagChangeEvent,this,void 0,void 0,!0),this._requiresViewTransformation=!0)}},f.prototype._updateViewConfiguration=function(){if(this._document&&this._document.isCommercialProductFile()){var e=new Image;e.onload=()=>{e.naturalWidth>0&&e.naturalHeight>0&&(this._view.getViewConfiguration().watermark=e,this._view.invalidate())},e.src="assets/img/brand/watermark.png"}else this._view.getViewConfiguration().watermark=null,this._view.invalidate()},f.prototype._sceneAfterPropertiesChanged=function(e){!e.temporary&&o.GUtil.containsOneOf(e.properties,["w","h"])&&this._updateWindowBackground()},f.prototype._updateWindowBackground=function(){this._document.getScene().isFixedSized()?this._view._htmlElement.style.background="":this._view._htmlElement.style.background="white"},f.prototype.getVisibleBBox=function(){if(this._document.getScene().isFixedSized()){var e=this._document.getScene();return new o.GRect(0,0,e.getProperty("w"),e.getProperty("h"))}return this._view?new o.GRect(0,0,this._view.getWidth(),this._view.getHeight()):null},f.prototype._afterFlagChangeEvent=function(e){e.node instanceof o.GPage&&e.flag===o.GNode.Flag.Active&&this._updateWindowBackground()},f.prototype.scrollIntoView=function(e){if(e&&!e.isEmpty()){const t=this.getView(),n=t.getViewVisibleArea(),i=t.getWorldTransform().mapRect(e);if(!n.containsRect(i)){let e=n.getSide(o.GRect.Side.CENTER),a=i.getSide(o.GRect.Side.CENTER).subtract(e);r.GPlatform.scheduleFrame(()=>t.scrollBy(a.getX(),a.getY()))}}},e.exports=f},function(e,t,n){"use strict";n(14),n(29),n(9),n(28),n(262);var i=n(322),o=n(1),r=n(32);const{gApi:a,LINKS:s,DESIGNER:{TITLE:l}={},SubscriptionStatus:c}=n(12),d=(n(143),n(306)),u=["number","name","price","date"];function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._user=e,this._options=n,this._query={skip:0,name:"",issued:"true"},this._messageHandler=t,this._typing=!1,this._init(),this._allowReactivateSubscriptions=!1,this._load()}o.GObject.inherit(p,o.GObject),p.prototype._init=function(){this._container=$("<div></div>").addClass("g-purchase-panel");let e=void 0;const t=()=>this._showInfoIfAny(),n=n=>{e&&clearTimeout(e),e=setTimeout(t,500),this._search($(n.target).closest("input").val())};$("<div></div>").addClass("search-panel").append($("<input>").attr("type","text").attr("data-property","search").attr("placeholder",o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.search-label"))).on("input",(0,r.debounce)((0,r.throttle)(n,500),500)).on("keyup",e=>{13===e.which&&(gDesigner.stats("profile-dialog_purchase-panel_search"),n(e))})).append($("<label></label>").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.orderby-label")))).append($("<select></select>").attr("data-property","orderby").append(u.map(e=>$("<option></option>").attr("value",e).text(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.orderby-"+e))))).on("change",e=>{gDesigner.stats("profile-dialog_purchase-panel_order-by",e.target.value),this._orderBy.bind(this)})).append($("<span></span>").data("direction","").attr("data-property","direction").addClass("gravit-icon-sort-asc").on("click",e=>{let t=$(e.target).closest("span"),n=t.data("direction"),i="asc";"-"===n?(n="",i="asc"):(n="-",i="desc"),t.data("direction",n),t.toggleClass("gravit-icon-sort-asc gravit-icon-sort-desc"),gDesigner.stats("profile-dialog_purchase-panel_sort",i),this._orderBy()}))).appendTo(this._container),this._purchaseList=$("<div></div>").addClass("purchase-list").appendTo(this._container),$("<footer></footer>").append($("<span>".concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.contact-partner-billing-alternative")),"</span>").replace("%partner%",$("<a/>").addClass("cb-link").text(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.contact-partner-cleverbridge"))).prop("outerHTML")))).appendTo(this._container),this._container.find(".cb-link").on("click",e=>{gDesigner.stats("profile-dialog_purchase-panel_cleverbridge-link"),gContainer.openExternalLink(e,s.CLEVERBRIDGE_SUPPORT_URL)}),$(this._purchaseList).scroll(e=>{let t=$(e.currentTarget);t[0].scrollHeight-t.scrollTop()===t.outerHeight()&&$(this._purchaseList).children().length>0&&this._load()})},p.prototype._search=async function(e){this._messageHandler(void 0),this._query.skip=0,this._query.name=e,this._query.by=this._container.find('select[data-property="orderby"] > option:selected').attr("value"),this._query.direction=this._container.find('span[data-property="direction"]').data("direction"),await this._load(!0)},p.prototype._orderBy=function(){this._search(this._container.find('input[data-property="search"]').val()),this._showInfoIfAny()},p.prototype._showInfoIfAny=function(){this._purchaseList[0].hasChildNodes()||this._messageHandler(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.empty-search")),"info")},p.prototype._load=async function(e){if(-1!==this._query.skip){this._toggleLoading(!0);try{let t=await a.listPurchasedProducts(this._query),n=t.length;this._query.skip=n>0?n<10?-1:this._query.skip+n:-1,e&&this._purchaseList.empty(),t.forEach(e=>this._addOrUpdateItem(e))}catch(e){this._handleError(e)}finally{this._toggleLoading(!1)}}},p.prototype._addOrUpdateItem=function(e,t){const n=e.issued_coupon&&e.issued_coupon.lifetime;(t=t||$("<div></div>").addClass("purchase-item").data("purchase",e).on("click",e=>{this._purchaseList.find(".purchase-item.g-active").removeClass("g-active"),$(e.target).closest(".purchase-item").addClass("g-active")}).appendTo(this._purchaseList)).empty();let r=!1,s=!1;this._options&&this._options.subscription&&e.purchase_id==this._options.subscription.purchase&&(r=!0,s=!!this._options.subscription.reinstate,this._options=null),r&&t.addClass("g-selected");const u=e.name||(n?o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.pro-subscription-lifetime")).replace("%app",l):o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.pro-subscription")).replace("%app",l));$("<div></div>").addClass("header").append($("<label></label>").addClass("title").text(u)).appendTo(t);e.invoice&&$("<div></div>").addClass("orderno").append($("<a></a>").attr("href",e.invoice).attr("target","_blank").append($("<span></span>").text("".concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.orderno"))," ").concat(e.purchase_id)))).appendTo(t),i.PURCHASEPANEL.HAS_PRODUCT_DESCRIPTION&&$("<div></div>").addClass("description").append($("<label></label>").text(e.description)).appendTo(t);let p="".concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.purchased"))," ").concat(e.created?o.GLocale.toLocaleDate(new Date(e.created)):"");!n&&e.issued_coupon&&e.issued_coupon.expires&&(p+=", ".concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.purchased-expires")).replace("%date",o.GLocale.toLocaleDate(new Date(e.issued_coupon.expires)))));let g=$("<span></span>").text(p+".");if(e.subscription&&!e.refunded){let r=p;g.text(p+"..."),a.getSubscriptionByPurchase(e.purchase_id,e.provider).then(u=>{const p=(e,n,i,r,a)=>{let s=$("<div></div>").addClass("prompt").append($("<div></div>").append($("<span></span>").addClass("title").text(e)).append($("<div></div>").append($("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GLocale","yes"))).on("click",()=>r(s))).append($("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GLocale","no"))).on("click",()=>s.removeClass("show"))))).append($("<div></div>").append($("<div></div>").addClass("subtitle").append($("<span></span>").html(n)))).insertAfter(t);return $("<div></div>").addClass("subscription").append($("<label></label>").html("&nbsp;")).append($("<button></button>").toggleClass("highlight",!!a).text(i).on("click",()=>s.addClass("show"))).appendTo(t),s};if(u.status===c.Active)n?g.text(r+"."):g.text("".concat(r,", ").concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.purchased-renews"))," ").concat(o.GLocale.toLocaleDate(new Date(u.endDate)),".")),p(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.prompt-cancel-title")),o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.prompt-cancel-info")).replace("%app",l).replace("%date",o.GLocale.toLocaleDate(new Date(u.endDate))),o.GLocale.get(new o.GLocaleKey("GLocale","cancel")),async n=>{this._toggleLoading(!0);try{await a.deactivateSubscription(u.id,e.provider).then(()=>{gDesigner.stats("profile-dialog_purchase-panel_cancel-subscription"),n.remove(),this._addOrUpdateItem(e,t)}).catch(e=>this._handleError(e)),await d.checkLicense()}finally{this._toggleLoading(!1)}});else{if(g.text("".concat(r,", ").concat(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.subscription-ends")).replace("%date",o.GLocale.toLocaleDate(new Date(u.endDate))),".")),!this._allowReactivateSubscriptions)return;if(u.repurchase)return;let n=p(o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.prompt-activate-title")),o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.prompt-activate-info")).replace("%date",o.GLocale.toLocaleDate(new Date(u.nextBillingDate))),o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.prompt-activate-label")),async n=>{this._toggleLoading(!0);try{await a.activateSubscription(u.id,e.provider).then(()=>{gDesigner.stats("profile-dialog_purchase-panel_activate-subscription"),n.remove(),this._addOrUpdateItem(e,t)}).catch(e=>this._handleError(e)),await d.checkLicense()}finally{this._toggleLoading(!1)}},i.PURCHASEPANEL.HAS_HIGHLIGHT);s&&n.addClass("show")}}).catch(()=>g.text(r+"."))}return $("<div></div>").addClass("purchased").append($("<label></label>").append(g)).appendTo(t),t},p.prototype._handleError=function(e){let t=o.GLocale.get(new o.GLocaleKey("GCommonNames","text.something-wrong"));e&&e.message?t=e.message:e&&e.errors&&(t=e.errors.map(e=>e[1]).join("<br>")),this._messageHandler(t)},p.prototype._toggleLoading=function(e){e?this._container.addClass("g-loading"):this._container.removeClass("g-loading")},p.prototype.getHTMLElement=function(){return this._container},e.exports=p},function(e,t,n){"use strict";n(9),n(163),n(3),n(14),n(29),n(63),n(84);var i=n(12),o=n(1);const r=n(36),a=function(e){return e.json().then((function(t){return Promise[e.status>=400?"reject":"resolve"](t)}))};function s(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._user=e,this._messageHandler=t,this._parent=n,this._options=i,this._init()}o.GObject.inherit(s,o.GObject),s.prototype._openAccountDeletionConfirmationDialog=function(){let e="<span>".concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-title")),'</span>\n    <mark style="min-width: 100px;\n        background: #F23C3C;\n        border-radius: 3px;\n        padding: 3px 30px;\n        color: white;\n        margin-top: 2px;\n        margin-bottom: 2px;\n        display: block;\n        text-align: center;">\n        ').concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-sub-title")),'\n    </mark>\n    <ul style="list-style-type: disc; transform: translateX(30px); margin-bottom: 10px;">\n        <li>').concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-list-1")),"</li>\n        <li>").concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-list-2")),"</li>\n        <li>").concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-list-3")),"</li>\n    </ul>\n    <span>").concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete-account-action-cant-undone")),"</span>");r.custom({title:e,styles:{buttons:{"justify-content":"flex-end"}},buttons:[{label:o.GLocale.get(new o.GLocaleKey("GLocale","cancel")),closeOnClick:!0},{label:o.GLocale.get(new o.GLocaleKey("GLocale","ok")),highlighted:!0,onclick:e=>{e.gDialog("close"),this._deleteAccount()}}]})},s.prototype._deleteAccount=function(){return this._toggleLoading(!0),fetch(i.gApi.url+"/user/"+this._user.id,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json",Accept:"json"}}).then(a).then(()=>{this._parent.close(),gDesigner.stats("profile-dialog_account-panel_delete"),gDesigner.signout(!0)}).catch(e=>{this._messageHandler(e&&e.message||e&&e.errors.toString()||"")}).finally(()=>{this._toggleLoading(!1)})},s.prototype._getFooter=function(){const e=$("<footer></footer>").append($("<div></div>").addClass("buttons").append($("<button></button>").addClass("highlight").attr("type","submit").text(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.save")))).append($("<button></button>").attr("type","button").attr("data-property","delete-account").text(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.delete"))).on("click",e=>(e.preventDefault(),this._openAccountDeletionConfirmationDialog(),!1))));return i.gApi.hasPurchases({issued:!0}).then(t=>{t&&$("<div/>").addClass("info").append($("<span>".concat(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.contact-partner-billing-alternative")),"</span>").replace("%partner%",$("<a/>").addClass("cb-link").text(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.contact-partner-cleverbridge"))).prop("outerHTML")))).appendTo(e),this._container.find(".cb-link").on("click",e=>{gDesigner.stats("profile-dialog_account-panel_cleverbridge-link"),gContainer.openExternalLink(e,i.LINKS.CLEVERBRIDGE_SUPPORT_URL)})}),e},s.prototype._init=function(){this._container=$("<div></div>").addClass("g-account-panel");let e=$("<form></form>").appendTo(this._container).on("submit",e=>(e.preventDefault(),gDesigner.stats("profile-dialog_account-panel_save"),this._updateUser(),!1)),t=$("<div></div>").addClass("section").append($("<div></div>").addClass("header").append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.contact"))))).appendTo(e);const n=this._getFooter();n&&n.appendTo(e);const i=(e,t,n,i,o)=>{const a=$("<input>").attr("type",i||"text").attr("placeholder",o||"").attr("value",t||"");let s=r(e,n,a);return"password"===i&&s.append($("<span></span>").addClass("gravit-icon-hide btn-display").on("click",e=>{let t=$(e.target).closest(".btn-display").toggleClass("gravit-icon-hide gravit-icon-display"),n=!t.data("visible");t.data("visible",n),s.find("input").attr("type",n?"text":"password")})),s},r=(e,t,n)=>$("<div></div>").addClass("input-field").attr("data-property",t).append($("<label></label>").text(e)).append(n);let a=this._user.getFirstName(),s=this._user.getLastName();if(!s){let{first:e,last:t}=(e=>{let t=(e||"").split(" "),n=t.slice(0,t.length-1).join(" "),i=t.slice(-1).join("");return n.trim().length||(n=i,i=""),{first:n,last:i}})(a);a=e,s=t||""}let l=$("<div></div>").addClass("group-section").appendTo(t);i(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.first-name")),a,"name").appendTo(l).find("input").attr("required",!0),i(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.last-name")),s,"last_name").appendTo(l).find("input").attr("required",!0),i(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.email")),this._user.getEmail(),"email").appendTo(t),i(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.old-password")),"","old_password","password").appendTo(t),i(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.new-password")),"","new_password","password",o.GLocale.get(new o.GLocaleKey("GPurchasePanel","text.placeholder-password"))).appendTo(t)},s.prototype._updateUser=async function(){this._toggleLoading(!0);const e=e=>{let t=o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.error"));e&&e.message?t=e.message:e&&e.errors&&(t=e.errors.map(e=>e[1]).join("<br>")),this._messageHandler(t),this._toggleLoading(!1)};let t={webUrl:gDesigner.getWebURL()},n=this;this._container.find(".input-field > input").each((function(){let e=$(this),i=e.closest(".input-field").attr("data-property");("login"!==i&&"email"!==i||n._user[i]!==e.val().trim())&&(t[i]=e.val())})),this._container.find(".input-field > select").each((function(){let e=$(this),n=e.closest(".input-field").attr("data-property"),i=e.find("option:selected").attr("value");t[n]=i})),this._messageHandler(void 0);try{await gDesigner.getCloudCommunicationManager().updateUser(t).then(()=>this._messageHandler(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.success")),"success")).then(()=>{t.email&&this._user.getEmail()!==t.email&&r.alert(o.GLocale.get(new o.GLocaleKey("GAccountPanel","text.user-email-message")).replace("%email",t.email))}).then(async()=>this._user=await gDesigner.getUser()).catch(e)}finally{this._toggleLoading(!1)}},s.prototype.getHTMLElement=function(){return this._container},s.prototype._toggleLoading=function(e){e?this._container.addClass("g-loading"):this._container.removeClass("g-loading")},e.exports=s},function(e,t,n){"use strict";n(14),n(29),n(84),n(3);var i=n(12),o=n(1);function r(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._user=e,this._messageHandler=t,this._parent=n,this._options=r;const a=function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return $("<div></div>").addClass("input-field").attr("data-property",t).append($("<span></span>").append($("<label></label>").text(e)).append($("<label></label>").text(i))).append(n)},s=(e,t,n,i,o,r)=>{let s=a(e,n,$("<input>").attr("type",i||"text").attr("placeholder",o||"").val(t||""),r);return"password"===i&&s.append($("<span></span>").addClass("gravit-icon-hide btn-display").on("click",e=>{let t=$(e.target).closest(".btn-display").toggleClass("gravit-icon-hide gravit-icon-display"),n=!t.data("visible");t.data("visible",n),s.find("input").attr("type",n?"text":"password")})),s};this._container=$("<div></div>").addClass("g-change-password-panel");const{changePasswordOptions:{autoClose:l,title:c=o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.change-password")),info:d=o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.reset-password-info"))}={}}=r;let u=$("<div></div>").addClass("section").append($("<div></div>").addClass("header").append($("<span></span>").text(c.replace("%name",e.email)))).appendTo(this._container);$("<footer></footer>").append($("<button></button>").addClass("highlight").text(o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.assign"))).on("click",()=>{const{token:e}=this._options,t=this._container.find('[data-property="new_password"] > input').val().trim(),n=this._container.find('[data-property="confirm_password"] > input').val().trim();gDesigner.stats("profile-dialog_change-password-panel_change-password"),i.gApi.updatePassword({password:t,confirm_password:n},e).then(()=>this._messageHandler(o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.reset-password-done")),"success")).then(()=>this._toggleLoading(!1)).then(()=>{l&&this._parent.close()}).catch(e=>this._messageHandler(i.gApi.formatError(e)))})).appendTo(this._container),s(o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.new-password")),"","new_password","password",o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.placeholder-new-password")),o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.new-password-tip"))).appendTo(u),s(o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.confirm-password")),"","confirm_password","password",o.GLocale.get(new o.GLocaleKey("GChangePasswordPanel","text.placeholder-confirm-password"))).appendTo(u),this._messageHandler(d,"important")}o.GObject.inherit(r,o.GObject),r.prototype.getHTMLElement=function(){return this._container},r.prototype._toggleLoading=function(e){e?this._container.addClass("g-loading"):this._container.removeClass("g-loading")},r.prototype.toString=function(){return"[Object GChangePasswordPanel]"},e.exports=r},function(e,t,n){"use strict";n(9);var i=n(1),o=n(32),r=n(232);class a{constructor(e){let{closeCallback:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n=this;this._dialog=$("<div/>").addClass("g-save-chooser").append($("<div/>").addClass("save-to-file").append($("<div/>").addClass("content").append($("<span/>").addClass("gravit-icon-local-file").addClass("icon")).append($("<span/>").addClass("label").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.save-to-file"))))).on("click",(async function(){gDesigner.stats("savedialog_save_file"),await n.close(),e(a.file())}))).append($("<hr/>")).append($("<div/>").addClass("save-to-file").append($("<div/>").addClass("content").append($("<span/>").addClass(r["gravit-icon-cloud-save-choose"]).addClass("icon")).append($("<span/>").addClass("label").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.save-to-cloud"))))).on("click",(async function(){gDesigner.stats("savedialog_save_cloud"),await n.close(),e(a.cloud())}))),this._dialog.gDialog({releaseOnClose:!0,className:"g-save-chooser-dialog",closeTimeout:0,closeCallback:t})}open(){this._dialog.gDialog("open",!0)}close(){return this._dialog.gDialog("close",!1),(0,o.sleep)(0)}static file(){return"file"}static cloud(){return"cloud"}}e.exports=a},function(e,t,n){"use strict";var i=n(1);function o(e,t){this._neverRemind=!1,this._agreeCb=e,this._rejectCb=t||this.close,gContainer.getProperty("designer.settings.warn-linked-image-dialog.never-remind").then(t=>{(t=t||!1)?e():this._init()})}i.GObject.inherit(o,i.GObject),o.prototype._init=function(){this._dialog=$("<div></div>").addClass("container").append($("<div />").addClass("text-content").text(i.GLocale.get(new i.GLocaleKey("GWarnLinkedImageDialog","warn-linked-image.text")))).append($("<div />").addClass("checkbox-content").append($("<input />").attr("type","checkbox").attr("name","never-remind").attr("checked",this._neverRemind).on("change",function(){this._neverRemind=!this._neverRemind}.bind(this))).append($("<span />").addClass("checkbox-text").html(i.GLocale.get(new i.GLocaleKey("GWarnLinkedImageDialog","warn-linked-image.never-remind"))))).gDialog({releaseOnClose:!0,className:"g-warn-linked-image-dialog",buttons:[$("<button />").addClass("native-button").attr("type","submit").html(i.GLocale.get(new i.GLocaleKey("GWarnLinkedImageDialog","warn-linked-image.proceed"))).on("click",this.save.bind(this)),$("<button />").addClass("native-button").html(i.GLocale.get(new i.GLocaleKey("GWarnLinkedImageDialog","warn-linked-image.cancel"))).on("click",this._rejectCb.bind(this))]}),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",this.close.bind(this)).appendTo(this._dialog)},o.prototype.save=function(){this._neverRemind&&gContainer&&gContainer.setProperty&&gContainer.setProperty("designer.settings.warn-linked-image-dialog.never-remind",!0),this.close(),this._agreeCb()},o.prototype.open=function(){this._dialog.gDialog("open",!0)},o.prototype.close=function(){this._dialog.gDialog("close")},e.exports=o},function(e,t,n){"use strict";n(9),n(129),n(28),n(19),n(158),n(201),n(166),n(167),n(1081),n(1082);var i=n(160),o=n(0);n(12);var r=n(216),a=n(1006).saveAs,s=null,l=null;function c(){this._fileInput=null,this._fileInputCallback=null}function d(e){return e.queryPermission({writable:!0}).then(t=>"granted"!==t?e.requestPermission({writable:!0}):t).then(e=>{if("granted"!==e)throw new Error("Cannot get write access")})}o.inherit(c,r),c.Directory=function(e,t){r.Directory.call(this,e),this._dirHandle=t,this._id=null},o.inherit(c.Directory,r.Directory),c.Directory.prototype._dirHandle=null,c.Directory.prototype._id=null,c.Directory.prototype.getUniqueId=function(){return null},c.Directory.prototype.addDirectory=async function(e){let t=null;try{return t=await this._dirHandle.getDirectory(e,{create:!0}),await d(t),new c.Directory(this._storage,t)}catch(t){throw new Error("Cannot create a directory: "+e)}},c.Directory.prototype.addFile=async function(e){let t=null;try{return t=await this._dirHandle.getFile(e,{create:!0}),await d(t),new c.Item(this._storage,null,t.name,t)}catch(e){throw new Error("Cannot create a file")}},c.Item=function(e,t,n,i){r.Item.call(this,e),this._data=t,this._filename=n,this._fileHandle=i},o.inherit(c.Item,r.Item),c.Item.prototype._data=null,c.Item.prototype._filename=null,c.Item.prototype._fileHandle=null,c.Item.prototype.getFullName=function(){return this._filename},c.Item.prototype.setFileName=function(e){this._filename=e},c.Item.prototype.read=function(e){if(this._data||!this._fileHandle)return e(this._data);this._fileHandle.getFile().then(e=>e.arrayBuffer()).then(t=>{this._data=t,e(this._data)})},c.Item.prototype.write=function(e,t,n,i,o){if(this._verifyFileNotTooSmall(e.length,o),this._fileHandle){let i=null;this._fileHandle.createWritable().then(e=>(i=e,i.truncate(0))).then(()=>i.write(e)).then(()=>i.close()).then(()=>{t&&t()}).catch(i=>{if(i instanceof DOMException&&i.code===DOMException.QUOTA_EXCEEDED_ERR)return this.notEnoughDiskSpace(),void(n?n():t&&t());a(new Blob([e]),this._filename),t&&t()})}else a(new Blob([e]),this._filename),t&&t()},c.prototype._isFileAPIAvailable=function(){return!1},c.prototype._hasDirectoryWriteAPI=function(){return"function"==typeof window.chooseFileSystemEntries},c.prototype.canChooseDirectory=function(){return this._hasDirectoryWriteAPI()&&!0},c.prototype.canPromptOpen=function(){return!0},c.prototype.canPromptSave=function(){return this._isFileAPIAvailable()},c.prototype.canSave=function(){return this._isFileAPIAvailable()},c.prototype.canDownload=function(){return!this._isFileAPIAvailable()},c.prototype.chooseDirectory=function(e,t,n){if(!this._isFileAPIAvailable()||!this.canChooseDirectory())return;var i={type:l||"open-directory"};let o=null;var r=!1;window.chooseFileSystemEntries(i).then(e=>(o=e,d(e))).then(()=>{let t=e(new c.Directory(this,o));return r=!0,t}).catch(e=>{if(e instanceof DOMException&&"SecurityError"===e.name){if(console.warn("Bugged!"),n)return void n()}else!r&&!l&&e instanceof TypeError&&(l="openDirectory");t&&t()})},c.prototype.openPrompt=function(e,t,n){let{disableFileSystemAccessAPI:o=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!o&&this._isFileAPIAvailable()){var r={multiple:!!n};if(e.length>0){const t={};r.excludeAcceptAllOptions=!0;for(let n=0,i=e.length;n<i;n++){const{mime:i,ext:o}=e[n];i&&o?void 0!==t[i]?(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(o.startsWith(".")?o:".".concat(o))):t[i]=o.startsWith(".")?o:".".concat(o):console.warn('openPrompt warning: no mime or ext. given mime: "'.concat(i,'", given ext: "').concat(o,'"'))}r.types=[{accept:t}]}return window.showOpenFilePicker(r).then(e=>{Array.isArray(e)||(e=[e]),e.forEach(n=>{n.getFile().then(e=>e.arrayBuffer()).then(i=>t(new c.Item(this,new Uint8Array(i),n.name,n),e.length)).catch(()=>{console.log("ERROR reading file")})})}).catch(e=>{e instanceof DOMException||console.warn("showOpenFilePicker warning",e)}),void(this._fileInputCallback=t)}const a=e.map(e=>e.ext).flat();if(!this._fileInput){this._fileInput=document.createElement("input"),this._fileInput.setAttribute("type","file"),this._fileInput.multiple=n,this._fileInput.style.opacity=0,this._fileInput.style.position="absolute",this._fileInput.style.zIndex=-1,this._fileInput.style.left="-9999px",this._fileInput.style.top="-9999px";var s=function(e){var t=this._fileInput.files.length;if(e>=t)this._fileInput.value="";else{var n=this._fileInput.files[e],i=n.name;if(n instanceof File||n instanceof Blob){var o=new FileReader;o.onload=function(){this._fileInputCallback(new c.Item(this,new Uint8Array(o.result),i),t),s(e+1)}.bind(this),o.readAsArrayBuffer(n)}else s(e+1)}}.bind(this);this._fileInput.addEventListener("change",()=>{s(0)}),document.body.appendChild(this._fileInput)}i.hardware===i.Hardware.Tablet&&i.operatingSystem===i.OperatingSystem.OSX_IOS?this._fileInput.removeAttribute("accept"):a&&a.length?this._fileInput.setAttribute("accept",a.map(e=>"."+e).join(",")):this._fileInput.removeAttribute("accept"),this._fileInputCallback=t,this._fileInput.focus(),this._fileInput.click()},c.prototype.savePrompt=function(e,t,n,i){if(this._isFileAPIAvailable()){var o={suggestedName:e};if(t.length>0){const e={};o.excludeAcceptAllOptions=!0;for(let n=0,i=t.length;n<i;n++){let{mime:i,ext:o}=t[n];i&&o?("jpg"===o&&(i="x-really-an-image/jpeg"),void 0!==e[i]?(Array.isArray(e[i])||(e[i]=[e[i]]),e[i].push(o.startsWith(".")?o:".".concat(o))):e[i]=o.startsWith(".")?o:".".concat(o)):console.warn('openPrompt warning: no mime or ext. given mime: "'.concat(i,'", given ext: "').concat(o,'"'))}let n=[{accept:e}];const i=Object.keys(e);(i||[]).length>1&&(n=i.map(t=>{let n={};return n[t]=e[t],{accept:n}})),o.types=n}var r=!1;window.showSaveFilePicker(o).then(e=>(r=!0,n(new c.Item(this,null,e.name,e)))).catch(t=>{if(!r&&!s&&t instanceof TypeError&&(s="saveFile"),!r&&t.code!==DOMException.ABORT_ERR)return this.download(e,n);i&&i()})}},c.prototype.download=function(e,t){return t(new c.Item(this,null,e))},e.exports=c},function(e,t,n){"use strict";n(537),n(45),n(25),n(9),n(14),n(29),n(19),n(24);var i=n(1),o=n(710),r=n(16),a=n(32),s=n(12),l=n(217),c=n(397),d=n(232),u=n(1137);const p=n(1123);var g=n(36);const h=n(390);var f={};function m(e,t,n){this._document=e,this._options=t,this._settings=i.GUtil.extend({size:"1x",format:"png",jpegQuality:s.JPEG_EXPORT_QUALITY_DEFAULT,backgroundColor:e?e.getScene().getActivePage().getProperty("bck"):null,backgroundOpacity:e?e.getScene().getActivePage().getProperty("bop"):1,chooserColor:e?e.getScene().getActivePage().getProperty("bck"):null,chooserOpacity:e?e.getScene().getActivePage().getProperty("bop"):1,convertTextToPath:!1,decimalPlacesPrecision:3,configuration:{ignoreEffects:!1,forceEffectsWhenZoomed:!0,sceneBackground:!0,isOutline:function(){return!1}},preserveEditingCapabilities:!1,layerNamesAsId:o.GSVGExport.DefaultOptions.layerNamesAsId,downsampleImages:!1},this._options||f);var r=this._isUserFree();this.init(r,n)}i.GObject.inherit(m,i.GObject),m.prototype._warningSection=null,m.prototype._isUserFree=function(){var e=gDesigner.getLicense();return!e.isLegacy()&&(e.isFree()||gDesigner.isAnonymous()||e.isExpired())},m.prototype.init=function(e,t){this._settings.background||(this._settings.background="page-background"),this._chooserElem=null,this._dialog=$("<div></div>"),this._setupContainer=$("<div></div>").addClass("setup-container").appendTo(this._dialog),this._modeContainer=$("<div/>").addClass("mode-container").appendTo(this._setupContainer);var n=function(e,t,n){return $("<label/>").attr("data-mode",e).append($("<span></span>").addClass("icon "+n)).append($("<span></span>").addClass("name").text(t)).on("click",function(t){gDesigner.stats("export_change_mode",e),$(t.target).closest("label").hasClass("g-disabled")||this._setActiveMode(e)}.bind(this)).appendTo(this._modeContainer)}.bind(this);n("canvas",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.canvas")),d["gravit-icon-display"]),n("selection",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.selection")),d["gravit-icon-cursor-filled"]),n("assets",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.assets")),"gravit-icon-layers"),this._settingsContainer=$("<div/>").addClass("settings-container").appendTo(this._setupContainer);var o=function(n,i,o,r){r=$.extend({controlLeft:!1,forbiddenForFree:!0},r);var s=$("<span></span>").addClass("control").append(o);e&&r.forbiddenForFree?(s.find("*").on("mousedown",a.watchDog.trap(null,null,e=>{e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),r.prostats&&gDesigner.stats(r.prostats)},t)).on("click",a.watchDog.trap(null,null,e=>{e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault()},t)),s.find("*").each((e,t)=>{$._data(t,"events").click.reverse(),$._data(t,"events").mousedown.reverse()})):r.pro&&s.find("input").gPro().on("click",a.watchDog.trap(null,null,e=>r.prostats&&gDesigner.stats(r.prostats))).after($("<span></span>").gPro()),r.controlLeft&&s.addClass("control-left"),"jpeg-quality"===n&&s.css("width","55%").css("height","100%").css("display","flex").css("justify-content","center");var l=$("<div></div>").attr("data-setting",n);return""!==i&&l.append($("<span></span>").addClass("label").text(i)),l.append(s).appendTo(this._settingsContainer),l}.bind(this),r={controlLeft:!0};o("format",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.format")),$("<select/>").on("change",function(e){this._settings.format=$(e.target).val(),gDesigner.stats("export_change_documenttype",this._settings.format),"pdf"!==this._settings.format&&(this._settings.configuration.ignoreEffects=!1),"pdf"!=this._settings.format&&"jpg"!=this._settings.format||"no-background"!=this._settings.background||(this._settings.background="page-background"),this._updateSettings(),this._updatePreview(),this._updateSizeMenu()}.bind(this)).append($("<option></option>").attr("value","png").text("PNG")).append($("<option></option>").attr("value","jpg").text("JPEG")).append($("<option></option>").attr("value","svg").text("SVG")).append($("<option></option>").attr("value","pdf").text("PDF")),{forbiddenForFree:!1}),o("size",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.size")),$("<div></div>").addClass("g-input-select").append($("<input/>").attr("size","6").val(this._settings.size).on("change",function(e){gDesigner.stats("export_change_size",$(e.target).val()),this._settings.size=$(e.target).val(),this._updatePreview()}.bind(this))).append($("<button></button>").on("click",function(e){gDesigner.stats("export_open_size-menu"),this._sizeMenu.open(e.target,c.Position.Right_Bottom,c.Position.Right_Bottom,function(t){$(e.target).closest("div").find("input").val(this._formatCaption(t.getCaption())).trigger("change").focus().select()}.bind(this))}.bind(this))),{prostats:"export_nonprotriespro_size"});const s=$("<div />").gInputSlider({min:25,max:100}).css("align-self","center").gInputSlider("value",this._settings.jpegQuality).on("change",function(e){gDesigner.stats("export_change_jpeg-quality");var t=parseInt($(e.target).gInputSlider("value"),10);this._settings.jpegQuality=t,this._updatePreview(),u.gInputBox("value",t)}.bind(this)),u=$("<input />").attr("type","text").gInputBox({minValue:25,maxValue:100,incrementValue:1,postfix:"%"}).gInputBox("value",this._settings.jpegQuality).on("change",function(e){var t=parseInt(u.gInputBox("value"),10);t>100?t=100:t<25&&(t=25),s.gInputSlider("value",t),this._settings.jpegQuality=t,this._updatePreview()}.bind(this));o("jpeg-quality",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.jpeg-quality")),$("<div/>").addClass("jpeg-quality").append(s).append($("<label />").append(u)),{prostats:"export_nonprotriespro_jpeg-quality"});var p=$("<div/>").addClass("export-background-selector").append($("<select/>").on("change",function(e){!1&e.isTrigger&&gDesigner.stats("export_change_background-pattern",$(e.target).val()),this._settings.background=$(e.target).val(),$(e.target).next(".export-background-pattern-chooser").css("display","custom-background"===this._settings.background?"":"none"),this._updateBackground(),this._updatePreview()}.bind(this)).append($("<option></option>").attr("value","page-background").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.page-background")))).append($("<option></option>").attr("value","custom-background").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.custom-background")))).append($("<option></option>").attr("value","no-background").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.no-background"))))).append($("<span></span>").css("display","custom-background"===this._settings.background?"":"none").addClass("export-background-pattern-chooser").gPatternChooser({noEyedropper:!0,types:[i.GColor],hasOpacity:!0}).gPatternChooser("value",this._settings.chooserColor).on("chooseropen",(function(){this._chooserElem=$(this)})).on("chooserclose",(function(e,t,n){this._chooserElem=null})).on("patternchange",function(e,t,n,i){t&&(this._settings.backgroundColor=t,this._settings.chooserColor=t),n?(this._settings.backgroundOpacity=n,this._settings.chooserOpacity=n):this._settings.backgroundOpacity=this._document?this._document.getScene().getActivePage().getProperty("bop"):1,this._updateBackground(),this._updatePreview()}.bind(this)));this._settings.chooserColor&&p.find(".export-background-pattern-chooser").gPatternChooser("setPattern",this._settings.chooserColor),this._settings.chooserOpacity&&p.find(".export-background-pattern-chooser").gPatternChooser("opacity",this._settings.chooserOpacity),o("background-color",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.background-color")),p,{prostats:"export_nonprotriespro_select-background"}),p.find('option[value="'+this._settings.background+'"]').prop("selected",!0),o("color-space",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.color-mode")),$("<select/>").on("change",function(e){gDesigner.stats("export_change_colorspace",$(e.target).val()),this._settings.colorSpace=$(e.target).val()}.bind(this)).append($("<option/>").attr("value","rgb").text("RGB")).append($("<option/>").attr("value","cmyk").text("CMYK")),{prostats:"export_nonprotriespro_color-space"}),o("ignore-effects","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",!0).on("change",function(e){gDesigner.stats("export_toggle_ignoreeffects",$(e.target).prop("checked")?"enable":"disable"),this._settings.configuration.ignoreEffects=!$(e.target).prop("checked"),this._updatePreview()}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.with-effects")))),Object.assign({},r,{prostats:"export_nonprotriespro_ignore-effects"})),o("decimal-places-precision",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.decimal-places-precision")),$("<input/>").attr("type","text").css("width","63px").gInputBox({minValue:0,maxValue:6}).gInputBox("value",this._settings.decimalPlacesPrecision).on("change",function(e){gDesigner.stats("export_change_decimalprecision"),this._settings.decimalPlacesPrecision=parseInt($(e.target).gInputBox("value"))}.bind(this)),{pro:!0,prostats:"export_nonprotriespro_decimalprecision"}),o("convert-text-to-path","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",!0).on("change",function(e){gDesigner.stats("export_toggle_convert-to-path",$(e.target).prop("checked")?"enable":"disable"),this._settings.convertTextToPath=$(e.target).prop("checked")}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.export-as-curves")))),Object.assign({},r,{prostats:"export_nonprotriespro_convert-text-to-path"})),o("export-all","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",!0).on("change",function(e){gDesigner.stats("export_click_exportall");var t=$(e.target).prop("checked");this._previewContainer.find(".item .preview-check input").each((e,n)=>{$(n).prop("checked",t),this._updateStorageDestinationSetting()})}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.export-all")))),Object.assign({},r,{prostats:"export_nonprotriespro_export-all"})),o("layer-as-id","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",this._settings.layerNamesAsId).on("change",function(e){gDesigner.stats("export_click_layer-as-id"),this._settings.layerNamesAsId=$(e.target).prop("checked")}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.layer-as-id")))).append($("<div></div>").addClass("description").html(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.layer-as-id-info")))),Object.assign(r,{pro:!0,prostats:"export_nonprotriespro_layer-as-id"})),o("export-preserve-editing-capabilities","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",!0).on("change",function(e){gDesigner.stats("export_toggle_preserve-svg-editing-capabilities",$(e.target).prop("checked")?"enable":"disable"),this._settings.preserveEditingCapabilities=$(e.target).prop("checked")}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.preserve-svg-editing-capabilites")))).append($("<div></div>").addClass("description").html(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.preserve-svg-editing-capabilites-description")))),Object.assign(r,{pro:!0,prostats:"export_nonprotriespro_preserve-svg-editing-capabilities"})),o("do-not-downsample-images","",$("<label></label>").addClass("label").append($("<input/>").attr("type","checkbox").prop("checked",!this._settings.downsampleImages).on("change",function(e){gDesigner.stats("export_toggle_do-not-downsample-images",$(e.target).prop("checked")),this._settings.downsampleImages=!$(e.target).prop("checked")}.bind(this))).append($("<span></span>").html("&nbsp;"+i.GLocale.get(new i.GLocaleKey("GExportDialog","text.do-not-downsample-images")))).append($("<div></div>").addClass("description").html(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.do-not-downsample-images-info")))),Object.assign({},r,{prostats:"do-not-downsample-images"})),o("storage-destination",i.GLocale.get(new i.GLocaleKey("GExportDialog","text.export-to")),$("<select/>").on("change",()=>{const e=this._getSelectedStorageDestination();e&&gDesigner.stats("export_change_output",e.stats)})),this._previewContainer=$("<div></div>").addClass("preview-container").appendTo(this._dialog),this._sizeMenu=new l,this._setActiveMode("canvas",!0),this._updateSettings(),this._updateSizeMenu(),this._dialog.gDialog({releaseOnClose:!0,className:e?"g-export-dialog dialog-expired-pro":"g-export-dialog",buttons:[$("<button>"+i.GLocale.get(new i.GLocaleKey("GLocale","cancel"))+"</button>").on("click",()=>{gDesigner.stats("export_cancel_button"),this.close()}),$("<button>"+i.GLocale.get(new i.GLocaleKey("GCommonNames","text.export"))+"</button>").addClass("primary").on("click",a.watchDog.trap(()=>{gDesigner.stats("export_execute_button",this._settings&&this._settings.format),this._export()},null,e=>gDesigner.stats("export_nonprotriespro_export"),t))]}),p.find("select").trigger("change")},m.prototype.open=function(){this._dialog.gDialog("open",!0)},m.prototype.close=function(){this._chooserElem&&this._chooserElem.gPatternChooser("close"),this._dialog.gDialog("close")},m.prototype._shouldWarningBeShown=function(e){if(!this._hasFormat())return!1;if(!(this._settings.format===h.PDF.ext))return!1;if(!e||!e.length)return!1;const t=new i.GLength(200,i.GLength.Unit.IN).toUnit(i.GLength.Unit.PX),n=i.GLength.DPI;return e.some(e=>{const i=o.GBitmapExport.getBitmapPaintArea(e.element,e.size,n);if(i.getWidth()>t||i.getHeight()>t)return!0})},m.prototype._updateWarningSection=function(e){this._shouldWarningBeShown(e)?(this._warningSection||(this._warningSection=this._buildWarningSection().appendTo(this._settingsContainer)),this._warningSection.show()):this._warningSection&&this._warningSection.hide()},m.prototype._buildWarningSection=function(){return $("<div/>").addClass("warning-section").append($("<span/>").addClass("control").append($("<label/>").addClass("label").append($("<span/>").addClass("icon").addClass("gravit-icon-export-warning")).append($("<span/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.warning")))).append($("<div/>").addClass("description").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.canvas-bigger-than-200-in"))))))},m.prototype._getStorageDestinations=function(){const e=this._getFormat();if(e){const t=gContainer.getStorageDestinations();if(t)return t.filter(t=>t.isSupported(e))}return[]},m.prototype._getSelectedStorageDestination=function(){const e=parseInt(this._settingsContainer.find("[data-setting=storage-destination] > .control > select").val());return this._getStorageDestinations().find(t=>t.id===e)},m.prototype._isStorageDestinationSettingAvailable=function(){return!(this._getStorageDestinations().length<2)},m.prototype._updateStorageDestinationSetting=function(){const e=this._isStorageDestinationSettingAvailable(),t=e?this._getStorageDestinations():[];this._settingsContainer.find("[data-setting=storage-destination]").css("display",e?"":"none").find("select").empty().append(t.map(e=>$("<option/>").attr("value",e.id).text(e.label)))},m.prototype._getFormat=function(){if(this._hasFormat()){if("assets"===this._activeMode)return h.ZIP.ext;if(this._previewContainer.find(".item .preview-check input:checked").length>1){if(!(this._settings.format===h.PDF.ext))return h.ZIP.ext}return this._settings.format}return null},m.prototype._setActiveMode=function(e,t){e!==this._activeMode&&(this._activeMode=e,this._modeContainer.find("> label").each((function(t,n){var i=$(n);i.toggleClass("g-active",i.attr("data-mode")===e)})),"selection"===e&&"page-background"===this._settings.background&&(this._settings.background="custom-background"),this._updateSettings(),t||this._updatePreview(),this._updateSizeMenu())},m.prototype._hasBackgroundColor=function(){return"canvas"===this._activeMode||"selection"===this._activeMode&&this._settings.format in{png:1,jpg:1,pdf:1}},m.prototype._hasSize=function(){return this._hasFormat()&&this._settings.format in{png:1,jpg:1,pdf:1}},m.prototype._hasJpegQuality=function(){return this._hasFormat()&&this._settings.format in{jpg:1,pdf:1}},m.prototype._hasFormat=function(){return"canvas"===this._activeMode||"selection"===this._activeMode},m.prototype._updateBackground=function(){if(this._settings.configuration.sceneBackground=!0,!this._hasBackgroundColor())return this._settings.backgroundColor=null,void(this._settings.backgroundOpacity=0);if("custom-background"!==this._settings.background)this._settings.configuration.sceneBackground="page-background"==this._settings.background,this._settings.backgroundColor="jpg"===this._settings.format?i.GRGBColor.WHITE:null,this._settings.backgroundOpacity=1;else{this._settings.configuration.sceneBackground=!1;var e=this._settingsContainer.find("[data-setting=background-color]").find(".export-background-pattern-chooser");if(e.gPatternChooser("value")?(this._settings.backgroundColor=e.gPatternChooser("value"),this._settings.backgroundOpacity=e.gPatternChooser("opacity"),this._settings.backgroundColor instanceof i.GColor||(this._settings.backgroundColor=i.GRGBColor.WHITE,this._settings.backgroundOpacity=1,e.gPatternChooser("value",this._settings.backgroundColor),e.gPatternChooser("opacity",this._settings.backgroundOpacity))):(this._settings.backgroundColor=this._document?this._document.getScene().getActivePage().getProperty("bck"):null,this._settings.backgroundOpacity=this._document?this._document.getScene().getActivePage().getProperty("bop"):1,this._settings.backgroundColor&&this._settings.backgroundColor instanceof i.GColor?null==this._settings.backgroundOpacity&&(this._settings.backgroundOpacity=1):(this._settings.backgroundOpacity=1,this._settings.backgroundColor=i.GRGBColor.WHITE),e.gPatternChooser("value",this._settings.backgroundColor),e.gPatternChooser("opacity",this._settings.backgroundOpacity)),"jpg"===this._settings.format){var t=i.GRGBColor.WHITE.getValue().slice(),n=this._settings.backgroundColor.getValue().slice();t[3]=1,n[3]=this._settings.backgroundOpacity;var o=i.GRGBColor.mix(t,n);this._settings.backgroundColor=new i.GRGBColor(o),this._settings.backgroundOpacity=1}}},m.prototype._updateSettings=function(){this._updateBackground(),this._settingsContainer.find("[data-setting=size]").css("display",this._hasSize()?"":"none"),this._settingsContainer.find("[data-setting=format]").css("display",this._hasFormat()?"":"none"),this._settingsContainer.find("[data-setting=jpeg-quality]").css("display",this._hasJpegQuality()?"":"none"),this._settingsContainer.find("[data-setting=background-color]").css("display",this._hasBackgroundColor()?"":"none"),this._settingsContainer.find("[data-setting=background-color]").find(".export-background-pattern-chooser").css("display","custom-background"===this._settings.background?"":"none"),this._settingsContainer.find("[data-setting=color-space]").css("display",this._hasFormat()&&"pdf"===this._settings.format?"":"none"),this._settingsContainer.find("[value=no-background]").css("display",!this._hasFormat()||"pdf"!==this._settings.format&&"jpg"!==this._settings.format?"":"none"),this._settingsContainer.find("[data-setting=retina-display]").css("display",!this._hasSize()||"jpg"!==this._settings.format&&"png"!==this._settings.format?"none":""),this._settingsContainer.find("[data-setting=ignore-effects]").css("display",this._hasFormat()&&"pdf"===this._settings.format?"":"none").find("input").prop("checked",!this._settings.configuration.ignoreEffects),this._settingsContainer.find("[data-setting=convert-text-to-path]").css("display",!this._hasFormat()||"svg"!==this._settings.format&&"pdf"!==this._settings.format?"none":"").find("input").prop("checked",this._settings.convertTextToPath),this._settingsContainer.find("[data-setting=layer-as-id]").css("display",this._hasFormat()&&"svg"===this._settings.format?"":"none").find("input").prop("checked",this._settings.layerNamesAsId),this._settingsContainer.find("[data-setting=export-preserve-editing-capabilities]").css("display",this._hasFormat()&&"svg"===this._settings.format?"":"none").find("input").prop("checked",this._settings.preserveEditingCapabilities),this._settingsContainer.find("[data-setting=decimal-places-precision]").css("display",this._hasFormat()&&"svg"===this._settings.format?"":"none"),this._settingsContainer.find("[data-setting=format]").find("[value="+this._settings.format+"]").attr("selected",!0),this._settings.colorSpace&&this._settingsContainer.find("[data-setting=color-space]").find("[value="+this._settings.colorSpace+"]").attr("selected",!0),this._settingsContainer.find("[data-setting=do-not-downsample-images]").css("display",this._hasFormat()&&"pdf"===this._settings.format?"":"none").find("input").prop("checked",!this._settings.downsampleImages),this._settingsContainer.find("[data-setting=export-all]").find("input").prop("checked",!this._options||!this._options.element),$(".export-background-selector").find('option[value="page-background"]').css("display","selection"===this._activeMode?"none":""),$(".export-background-selector").find('option[value="'+this._settings.background+'"]').prop("selected",!0),this._updateStorageDestinationSetting()},m.prototype._generateExportables=function(){if("canvas"===this._activeMode||"selection"===this._activeMode){var e={size:this._settings.size,suffix:"",format:this._settings.format,jpegQuality:this._settings.jpegQuality,backgroundColor:this._settings.backgroundColor,backgroundOpacity:this._settings.backgroundOpacity,colorSpace:this._settings.colorSpace,configuration:this._settings.configuration,convertTextToPath:this._settings.convertTextToPath,decimalPlacesPrecision:this._settings.decimalPlacesPrecision,preserveEditingCapabilities:this._settings.preserveEditingCapabilities,layerNamesAsId:this._settings.layerNamesAsId,overrideBackground:"page-background"!==this._settings.background,downsampleImages:this._settings.downsampleImages};if("canvas"===this._activeMode)return u.generateExportables(this._document.getScene(),$.extend({name:this._document.getTitle()},e),!1);var t=this._document.getEditor().getSelection();return t&&t.length?u.generateExportables(t,e,!1):[]}if("assets"===this._activeMode)return u.generateExportables(this._document.getScene(),null,!0)},m.prototype._export=async function(e){this._options||(f=this._settings);var t=this._generateExportables();let n=[];try{var a=this._previewContainer.find(".item .preview-check input");if(a.length){var s=[];a.each((function(e,t){var n=$(t);n.prop("checked")&&s.push(n.closest(".item").data("element"))}));for(var l=[],c=0;c<t.length;++c)for(var d=0;d<s.length;++d){if(s[d]instanceof i.GPage&&t[c].element instanceof i.GPage&&s[d].getReferenceId()===t[c].element.getReferenceId()||s[d]===t[c].element){l.push(t[c]);break}}t=l}var h=o.GBitmapExport.getMaximumCanvasSize();if(t.some(e=>{if("jpg"===e.format||"png"===e.format){var t=i.GLength.DPI,n=o.GBitmapExport.getBitmapPaintArea(e.element,e.size,t);if(n.getWidth()>h.width||n.getHeight()>h.height||n.getWidth()*n.getHeight()>h.area)return!0}return!1}))return void g.alert(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.default-limit")).replace("%width",h.width).replace("%height",h.height).replace("%area",h.area/1024/1024+"MP")).css({width:"500px"});if(t.some(e=>"pdf"===e.format&&!o.GPDFExport.isSupported(e.element,!e.configuration||!e.configuration.ignoreEffects,e.size)))return void g.alert(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.pdf-limit")).replace("%limit",Math.round(r.GPlatform.maxPngDataSize/1024/1024)+"MB")).css({width:"500px"});if(n=this._persistOpacities(t),t.length){const e=this._getSelectedStorageDestination();if(e&&!await this._checkWriteAccess(e))return;var m=$("<div></div>").addClass("export-overlay").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.exporting"))+"...").appendTo(this._dialog),y=$("<div></div>").addClass("message").append($("<span></span>"));let n={abort:void 0,message:e=>{y.find("span").text(e)},close:()=>m.remove(),error:()=>n.message(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.pdf-export-error")))};const r={storageDestination:e},a=e=>{e&&g.error(e,{closeCallback:()=>this.close()})};t.length&&"pdf"===t[0].format&&(m.append($("<button>").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.cancel"))).on("click",()=>{n.abort&&n.abort(),n.close()})),m.append(y)),u.export(t,this._document.getStorage()||gDesigner.getDefaultStorage(),this._document.getTitle(),()=>{if(this.close(),!gDesigner.getSetting("disable_warning_unsupported_features",!1)){let e=[];for(let n of t)"svg"===n.format&&(e=e.concat(o.GSVGExport.getUnsupportedFeatures(n.element)));e.length&&new p(e).open()}},()=>this.close(),"assets"===this._activeMode,(function(e){var t=m.find("progress");t.length||m.append($("<p>").append(t=$("<progress>").attr({min:"0",max:"100"}).css("width","200px"))),t.val(e)}),n,a,r)}}finally{this._restoreOpacities(t,n)}},m.prototype._checkWriteAccess=async function(e){const t=this._document.getStorage()||gDesigner.getDefaultStorage(),n=await t.getWritePermission(e),i=n.isAuthorized();return!i&&n.hasStatusText()&&g.error(n.getStatusText(),{showTitle:!1}),i},m.prototype._formatCaption=function(e){return"pdf"===this._settings.format?e.replace(/[^0-9\.]/g,"")+"dpi":e},m.prototype._updateSizeMenu=function(){this._sizeMenu.clearItems();let e="1x";if("pdf"===this._settings.format){const t=this._document&&this._document.getScene()&&this._document.getScene().getProperty("dpi");e=isNaN(t)?"72dpi":t+"dpi",this._sizeMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.default"))+" (72dpi)"),this._sizeMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.web"))+" (96dpi)"),this._sizeMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.medium-quality"))+" (150dpi)"),this._sizeMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.high-quality"))+" (300dpi)")}else this._sizeMenu.createAddItem("1x"),this._sizeMenu.createAddItem("2x"),this._sizeMenu.createAddItem("0.5x"),this._sizeMenu.createAddItem("3x"),this._sizeMenu.createAddItem("512w"),this._sizeMenu.createAddItem("512h"),this._sizeMenu.createAddItem("128x128"),this._sizeMenu.createAddItem("300dpi");for(var t=0;t<this._sizeMenu.getItemCount();t++)if(-1!==this._sizeMenu.getItem(t).getCaption().indexOf(this._settings.size))return;this._settings.size=e,this._settingsContainer.find(".g-input-select > input").val(this._settings.size)},m.prototype._updatePreview=function(){this._previewContainer.empty();var e=this._generateExportables();let t=[];try{if(t=this._persistOpacities(e),this._settingsContainer.find("[data-setting=export-all]").css("display","canvas"!==this._activeMode||e.length>1?"":"none"),e.length){for(var n=$("<div></div>").addClass("loader").append($("<span></span>").addClass("text").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.preparing-preview"))+"...")).appendTo(this._previewContainer),r=[],a=0;a<e.length;++a){for(var s=e[a],l=null,c=0;c<r.length;++c)if(r[c].element===s.element){l=r[c];break}l||(l={element:s.element,name:s.name,format:s.format,size:s.size,jpegQuality:s.jpegQuality,backgroundColor:s.backgroundColor,backgroundOpacity:s.backgroundOpacity,sizes:"",formats:"",configuration:s.configuration},r.push(l)),""!==l.formats&&(l.formats+=", "),l.formats+=s.format,s.size&&(""!==l.sizes&&(l.sizes+=", "),l.sizes+=s.size)}var d=null;(r.length>1||"assets"===this._activeMode)&&(d=$("<div></div>").addClass("list content").appendTo(this._previewContainer));var u=[];for(a=0;a<r.length;++a){l=r[a];var p,g,h=i.GBitmap.ImageType.PNG,f=null;"jpg"===l.format&&(h=i.GBitmap.ImageType.JPEG,f=(l.jpegQuality||100)/100);var m=window.devicePixelRatio;if(d){var y=new i.GLength(50,i.GLength.Unit.PX);p=(g=l.element.toBitmap(y,y,2,l.backgroundColor,l.configuration,null,l.backgroundOpacity)).toImageDataUrl(h,f)}else{var v=null;this._hasBackgroundColor()&&(v=l.backgroundColor);var _=l.element._getBitmapPaintArea(),b=[0],w=o.GBitmapExport.convertSizeToScale(_.getWidth(),_.getHeight(),l.size,null,b),C=_.getWidth()*(b[0]/i.GLength.DPI)*w.getX(),E=_.getHeight()*(b[0]/i.GLength.DPI)*w.getY(),S=l.size;(C>1920||E>1080)&&(S=Math.min(1920/_.getWidth(),1080/_.getHeight())+"x"),p=(g=o.GBitmapExport.export(l.element,S,v,l.configuration,null,l.backgroundOpacity,!0)).toImageDataUrl(h,f)}var G=g.getWidth()/m,A=g.getHeight()/m,T=$("<img />").attr("src",p),P=$("<div></div>").addClass("preview-image").css("background",i.GPattern.asCSSBackground(null,0)).append(T);if(u.push({img:T,w:G,h:A,preview:P}),d){var L="";"assets"===this._activeMode&&(l.sizes&&(L=l.sizes+" - "),L+=l.formats),$("<div></div>").addClass("item").data("element",l.element).append(P).append($("<div></div>").addClass("preview-check").append($("<input/>").prop("checked",!this._options||!this._options.element||this._options.element==l.element).on("change",()=>{this._updateStorageDestinationSetting()}).attr("type","checkbox"))).append($("<div></div>").addClass("preview-name").text(l.name)).append($("<div></div>").addClass("preview-meta").text(L)).appendTo(d)}else P.addClass("content").appendTo(this._previewContainer)}n.remove()}else switch(this._activeMode){case"selection":$("<div></div>").addClass("empty").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.selection-warning"))).appendTo(this._previewContainer);break;case"assets":$("<div></div>").addClass("empty").text(i.GLocale.get(new i.GLocaleKey("GExportDialog","text.assets-warning"))).appendTo(this._previewContainer)}}finally{this._restoreOpacities(e,t)}this._updateStorageDestinationSetting(),this._updateWarningSection(e)},m.prototype._persistOpacities=function(e){let t=[];if("canvas"===this._activeMode&&"svg"!==this._settings.format&&"pdf"!==this._settings.format)for(var n=0;n<e.length;++n){var i=e[n];if(i.overrideBackground){var o=i.element.getProperty("bop");t.push({index:n,opacity:o}),i.element.setProperty("bop",0)}}return t},m.prototype._restoreOpacities=function(e,t){if(t.length>0)for(var n=0;n<e.length;++n)for(var i=e[n],o=0;o<t.length;++o)if(n===t[o].index){i.element.setProperty("bop",t[o].opacity);break}},e.exports=m},function(e,t){(function(){!function(e){"use strict";var t,n="File format is not recognized.",i="Error while reading zip file.";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function o(){this.crc=-1}function r(){}function a(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function s(){}function l(e){var t,n=this;n.size=0,n.init=function(i,o){var r=new Blob([e],{type:"text/plain"});(t=new d(r)).init((function(){n.size=t.size,i()}),o)},n.readUint8Array=function(e,n,i,o){t.readUint8Array(e,n,i,o)}}function c(t){var n,i=this;i.size=0,i.init=function(e){for(var o=t.length;"="==t.charAt(o-1);)o--;n=t.indexOf(",")+1,i.size=Math.floor(.75*(o-n)),e()},i.readUint8Array=function(i,o,r){var s,l=a(o),c=4*Math.floor(i/3),d=4*Math.ceil((i+o)/3),u=e.atob(t.substring(c+n,d+n)),p=i-3*Math.floor(c/4);for(s=p;s<p+o;s++)l.array[s-p]=u.charCodeAt(s);r(l.array)}}function d(e){var t=this;t.size=0,t.init=function(n){t.size=e.size,n()},t.readUint8Array=function(t,n,i,o){var r=new FileReader;r.onload=function(e){i(new Uint8Array(e.target.result))},r.onerror=o;try{r.readAsArrayBuffer(function(e,t,n){if(t<0||n<0||t+n>e.size)throw new RangeError("offset:"+t+", length:"+n+", size:"+e.size);return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}(e,t,n))}catch(e){o(e)}}}function u(){}function p(e){var n;this.init=function(e){n=new Blob([],{type:"text/plain"}),e()},this.writeUint8Array=function(e,i){n=new Blob([n,t?e:e.buffer],{type:"text/plain"}),i()},this.getData=function(t,i){var o=new FileReader;o.onload=function(e){t(e.target.result)},o.onerror=i,o.readAsText(n,e)}}function g(t){var n="",i="";this.init=function(e){n+="data:"+(t||"")+";base64,",e()},this.writeUint8Array=function(t,o){var r,a=i.length,s=i;for(i="",r=0;r<3*Math.floor((a+t.length)/3)-a;r++)s+=String.fromCharCode(t[r]);for(;r<t.length;r++)i+=String.fromCharCode(t[r]);s.length>2?n+=e.btoa(s):i=s,o()},this.getData=function(t){t(n+e.btoa(i))}}function h(e){var n=[];this.init=function(e){e()},this.writeUint8Array=function(e,i){n.push(t?e:e.buffer),i()},this.getData=function(t){t(new Blob(n,{type:e}))}}function f(e,t,n,i,o,r,a,s,l,c){var d,u,p,g=0,h=t.sn;function f(){e.removeEventListener("message",m,!1),s(u,p)}function m(t){var n=t.data,o=n.data,s=n.error;if(s)return s.toString=function(){return"Error: "+this.message},void l(s);if(n.sn===h)switch("number"==typeof n.codecTime&&(e.codecTime+=n.codecTime),"number"==typeof n.crcTime&&(e.crcTime+=n.crcTime),n.type){case"append":o?(u+=o.length,i.writeUint8Array(o,(function(){y()}),c)):y();break;case"flush":p=n.crc,o?(u+=o.length,i.writeUint8Array(o,(function(){f()}),c)):f();break;case"progress":a&&a(d+n.loaded,r);break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",n)}}function y(){(d=524288*g)<=r?n.readUint8Array(o+d,Math.min(524288,r-d),(function(n){a&&a(d,r);var i=0===d?t:{sn:h};i.type="append",i.data=n;try{e.postMessage(i,[n.buffer])}catch(t){e.postMessage(i)}g++}),l):e.postMessage({sn:h,type:"flush"})}u=0,e.addEventListener("message",m,!1),y()}function m(e,t,n,i,r,a,s,l,c,d){var u,p=0,g=0,h="input"===a,f="output"===a,m=new o;!function o(){var a;if((u=524288*p)<r)t.readUint8Array(i+u,Math.min(524288,r-u),(function(t){var i;try{i=e.append(t,(function(e){s&&s(u+e,r)}))}catch(e){return void c(e)}i?(g+=i.length,n.writeUint8Array(i,(function(){p++,setTimeout(o,1)}),d),f&&m.append(i)):(p++,setTimeout(o,1)),h&&m.append(t),s&&s(u,r)}),c);else{try{a=e.flush()}catch(e){return void c(e)}a?(f&&m.append(a),g+=a.length,n.writeUint8Array(a,(function(){l(g,m.get())}),d)):l(g,m.get())}}()}function y(t,n,i,o,a,s,l,c,d,u,p){e.zip.useWebWorkers&&l?f(t,{sn:n,codecClass:"NOOP",crcType:"input"},i,o,a,s,d,c,u,p):m(new r,i,o,a,s,"input",d,c,u,p)}function v(e){var t,n,i="",o=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++)i+=(n=255&e.charCodeAt(t))>127?o[n-128]:String.fromCharCode(n);return i}function _(e){return decodeURIComponent(escape(e))}function b(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function w(e,t,n,i,o){e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(e){}}(e.lastModDateRaw),1!=(1&e.bitFlag)?((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(n+22,!0),e.extraFieldLength=t.view.getUint16(n+24,!0)):o("File is using Zip64 (4gb+ file size).")):o("File contains encrypted entry.")}function C(t,o,r){var s=0;function l(){}l.prototype.getData=function(i,o,l,c){var d=this;function u(e,t){c&&!function(e){var t=a(4);return t.view.setUint32(0,e),d.crc32==t.view.getUint32(0)}(t)?r("CRC failed."):i.getData((function(e){o(e)}))}function p(e){r(e||"Error while reading file data.")}function g(e){r(e||"Error while writing file data.")}t.readUint8Array(d.offset,30,(function(o){var h,v=a(o.length,o);1347093252==v.view.getUint32(0)?(w(d,v,4,!1,r),h=d.offset+30+d.filenameLength+d.extraFieldLength,i.init((function(){0===d.compressionMethod?y(d._worker,s++,t,i,h,d.compressedSize,c,u,l,p,g):function(t,n,i,o,r,a,s,l,c,d,u){var p=s?"output":"none";e.zip.useWebWorkers?f(t,{sn:n,codecClass:"Inflater",crcType:p},i,o,r,a,c,l,d,u):m(new e.zip.Inflater,i,o,r,a,p,c,l,d,u)}(d._worker,s++,t,i,h,d.compressedSize,c,u,l,p,g)}),g)):r(n)}),p)};var c={getEntries:function(e){var o=this._worker;!function(e){if(t.size<22)r(n);else{o(22,(function(){o(Math.min(65558,t.size),(function(){r(n)}))}))}function o(n,o){t.readUint8Array(t.size-n,n,(function(t){for(var n=t.length-22;n>=0;n--)if(80===t[n]&&75===t[n+1]&&5===t[n+2]&&6===t[n+3])return void e(new DataView(t.buffer,n,22));o()}),(function(){r(i)}))}}((function(s){var c,d;c=s.getUint32(16,!0),d=s.getUint16(8,!0),c<0||c>=t.size?r(n):t.readUint8Array(c,t.size-c,(function(t){var i,s,c,u,p=0,g=[],h=a(t.length,t);for(i=0;i<d;i++){if((s=new l)._worker=o,1347092738!=h.view.getUint32(p))return void r(n);w(s,h,p+6,!0,r),s.commentLength=h.view.getUint16(p+32,!0),s.directory=16==(16&h.view.getUint8(p+38)),s.offset=h.view.getUint32(p+42,!0),c=b(h.array.subarray(p+46,p+46+s.filenameLength)),s.filename=2048==(2048&s.bitFlag)?_(c):v(c),s.directory||"/"!=s.filename.charAt(s.filename.length-1)||(s.directory=!0),u=b(h.array.subarray(p+46+s.filenameLength+s.extraFieldLength,p+46+s.filenameLength+s.extraFieldLength+s.commentLength)),s.comment=2048==(2048&s.bitFlag)?_(u):v(u),g.push(s),p+=46+s.filenameLength+s.extraFieldLength+s.commentLength}e(g)}),(function(){r(i)}))}))},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null),e&&e()},_worker:null};e.zip.useWebWorkers?T("inflater",(function(e){c._worker=e,o(c)}),(function(e){r(e)})):o(c)}function E(e){return unescape(encodeURIComponent(e))}function S(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function G(t,n,i,o){var r={},s=[],l=0,c=0;function d(e){i(e||"Error while writing zip file.")}function u(e){i(e||"Error while reading file data.")}var p={add:function(n,p,g,h,v){var _,b,w,C=this._worker;function G(e,n){var i=a(16);l+=e||0,i.view.setUint32(0,1347094280),void 0!==n&&(_.view.setUint32(10,n,!0),i.view.setUint32(4,n,!0)),p&&(i.view.setUint32(8,e,!0),_.view.setUint32(14,e,!0),i.view.setUint32(12,p.size,!0),_.view.setUint32(18,p.size,!0)),t.writeUint8Array(i.array,(function(){l+=16,g()}),d)}function A(){v=v||{},n=n.trim(),v.directory&&"/"!=n.charAt(n.length-1)&&(n+="/"),r.hasOwnProperty(n)?i("File already exists."):(b=S(E(n)),s.push(n),function(e){var i;w=v.lastModDate||new Date,_=a(26),r[n]={headerArray:_.array,directory:v.directory,filename:b,offset:l,comment:S(E(v.comment||""))},_.view.setUint32(0,335546376),v.version&&_.view.setUint8(0,v.version),o||0===v.level||v.directory||_.view.setUint16(4,2048),_.view.setUint16(6,(w.getHours()<<6|w.getMinutes())<<5|w.getSeconds()/2,!0),_.view.setUint16(8,(w.getFullYear()-1980<<4|w.getMonth()+1)<<5|w.getDate(),!0),_.view.setUint16(22,b.length,!0),(i=a(30+b.length)).view.setUint32(0,1347093252),i.array.set(_.array,4),i.array.set(b,30),l+=i.array.length,t.writeUint8Array(i.array,e,d)}((function(){p?o||0===v.level?y(C,c++,p,t,0,p.size,!0,G,h,u,d):function(t,n,i,o,r,a,s,l,c){e.zip.useWebWorkers?f(t,{sn:n,options:{level:r},codecClass:"Deflater",crcType:"input"},i,o,0,i.size,s,a,l,c):m(new e.zip.Deflater,i,o,0,i.size,"input",s,a,l,c)}(C,c++,p,t,v.level,G,h,u,d):G()})))}p?p.init(A,u):A()},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null);var n,i,o,c=0,u=0;for(i=0;i<s.length;i++)c+=46+(o=r[s[i]]).filename.length+o.comment.length;for(n=a(c+22),i=0;i<s.length;i++)o=r[s[i]],n.view.setUint32(u,1347092738),n.view.setUint16(u+4,5120),n.array.set(o.headerArray,u+6),n.view.setUint16(u+32,o.comment.length,!0),o.directory&&n.view.setUint8(u+38,16),n.view.setUint32(u+42,o.offset,!0),n.array.set(o.filename,u+46),n.array.set(o.comment,u+46+o.filename.length),u+=46+o.filename.length+o.comment.length;n.view.setUint32(u,1347093766),n.view.setUint16(u+8,s.length,!0),n.view.setUint16(u+10,s.length,!0),n.view.setUint32(u+12,c,!0),n.view.setUint32(u+16,l,!0),t.writeUint8Array(n.array,(function(){t.getData(e)}),d)},_worker:null};e.zip.useWebWorkers?T("deflater",(function(e){p._worker=e,n(p)}),(function(e){i(e)})):n(p)}o.prototype.append=function(e){for(var t=0|this.crc,n=this.table,i=0,o=0|e.length;i<o;i++)t=t>>>8^n[255&(t^e[i])];this.crc=t},o.prototype.get=function(){return~this.crc},o.prototype.table=function(){var e,t,n,i=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),r.prototype.append=function(e,t){return e},r.prototype.flush=function(){},l.prototype=new s,l.prototype.constructor=l,c.prototype=new s,c.prototype.constructor=c,d.prototype=new s,d.prototype.constructor=d,u.prototype.getData=function(e){e(this.data)},p.prototype=new u,p.prototype.constructor=p,g.prototype=new u,g.prototype.constructor=g,h.prototype=new u,h.prototype.constructor=h;var A={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function T(t,n,i){if(null===e.zip.workerScripts||null===e.zip.workerScriptsPath){var o,r,a;if(e.zip.workerScripts){if(o=e.zip.workerScripts[t],!Array.isArray(o))return void i(new Error("zip.workerScripts."+t+" is not an array!"));r=o,a=document.createElement("a"),o=r.map((function(e){return a.href=e,a.href}))}else(o=A[t].slice(0))[0]=(e.zip.workerScriptsPath||"")+o[0];var s=new Worker(o[0]);s.codecTime=s.crcTime=0,s.postMessage({type:"importScripts",scripts:o.slice(1)}),s.addEventListener("message",(function e(t){var o=t.data;if(o.error)return s.terminate(),void i(o.error);"importScripts"===o.type&&(s.removeEventListener("message",e),s.removeEventListener("error",l),n(s))})),s.addEventListener("error",l)}else i(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));function l(e){s.terminate(),i(e)}}function P(e){console.error(e)}e.zip={Reader:s,Writer:u,BlobReader:d,Data64URIReader:c,TextReader:l,BlobWriter:h,Data64URIWriter:g,TextWriter:p,createReader:function(e,t,n){n=n||P,e.init((function(){C(e,t,n)}),n)},createWriter:function(e,t,n,i){n=n||P,i=!!i,e.init((function(){G(e,t,n,i)}),n)},useWebWorkers:!0,workerScriptsPath:null,workerScripts:null}}(this)}).call(window)},function(e,t){(function(){!function(){"use strict";var e,t,n=zip.TextWriter,i=zip.BlobWriter,o=zip.Data64URIWriter,r=zip.Reader,a=zip.TextReader,s=zip.BlobReader,l=zip.Data64URIReader,c=zip.createReader,d=zip.createWriter;function u(e){var t,n=this;n.size=0,n.init=function(t){n.size=e.uncompressedSize,t()},n.readUint8Array=function(o,r,a,l){!function(o){n.data?o():e.getData(new i,(function(e){n.data=e,t=new s(e),o()}),null,n.checkCrc32)}((function(){t.readUint8Array(o,r,a,l)}))}}function p(e){var t=0;return function e(n){t+=n.uncompressedSize||0,n.children.forEach(e)}(e),t}function g(e,t,n){var i=0;function o(){++i<e.children.length?r(e.children[i]):t()}function r(e){e.directory?g(e,o,n):(e.reader=new e.Reader(e.data,n),e.reader.init((function(){e.uncompressedSize=e.reader.size,o()})))}e.children.length?r(e.children[i]):t()}function h(e){var t=e.parent.children;t.forEach((function(n,i){n.id==e.id&&t.splice(i,1)}))}function f(e,t,n,i){t.isDirectory?function e(t,n,o){!function(e,t){e.isDirectory&&e.createReader().readEntries(t),e.isFile&&t([])}(n,(function(n){var r=0;function a(){var s=n[r];s?function(n){function o(t){e(t,n,(function(){r++,a()}))}n.isDirectory&&o(t.addDirectory(n.name)),n.isFile&&n.file((function(e){var i=t.addBlob(n.name,e);i.uncompressedSize=e.size,o(i)}),i)}(s):o()}a()}))}(e,t,n):t.file((function(i){e.addBlob(t.name,i),n()}),i)}function m(e,t,n,i,o,r,a){var s=0;t.directory?function e(t,n,i,o,r,l){var c=0;function d(){var u=n.children[c];u?function(n){function i(t){s+=n.uncompressedSize||0,e(t,n,(function(){c++,d()}),o,r,l)}n.directory?t.getDirectory(n.name,{create:!0},i,r):t.getFile(n.name,{create:!0},(function(e){n.getData(new zip.FileWriter(e,zip.getMimeType(n.name)),i,(function(e){o&&o(s+e,l)}),a)}),r)}(u):i()}d()}(e,t,n,i,o,r):t.getData(new zip.FileWriter(e,zip.getMimeType(t.name)),n,i,a)}function y(e){e.entries=[],e.root=new w(e)}function v(e,t,n,i){if(e.directory)return i?new w(e.fs,t,n,e):new b(e.fs,t,n,e);throw"Parent entry is not a directory."}function _(){}function b(e,t,n,i){_.prototype.init.call(this,e,t,n,i),this.Reader=n.Reader,this.Writer=n.Writer,this.data=n.data,n.getData&&(this.getData=n.getData)}function w(e,t,n,i){_.prototype.init.call(this,e,t,n,i),this.directory=!0}function C(){y(this)}u.prototype=new r,u.prototype.constructor=u,u.prototype.checkCrc32=!1,_.prototype={init:function(e,t,n,i){if(e.root&&i&&i.getChildByName(t))throw"Entry filename already exists.";n||(n={}),this.fs=e,this.name=t,this.id=e.entries.length,this.parent=i,this.children=[],this.zipVersion=n.zipVersion||20,this.uncompressedSize=0,e.entries.push(this),i&&this.parent.children.push(this)},getFileEntry:function(e,t,n,i,o){var r=this;g(r,(function(){m(e,r,t,n,i,p(r),o)}),i)},moveTo:function(e){if(!e.directory)throw"Target entry is not a directory.";if(e.isDescendantOf(this))throw"Entry is a ancestor of target entry.";if(this!=e){if(e.getChildByName(this.name))throw"Entry filename already exists.";h(this),this.parent=e,e.children.push(this)}},getFullname:function(){for(var e=this.name,t=this.parent;t;)e=(t.name?t.name+"/":"")+e,t=t.parent;return e},isDescendantOf:function(e){for(var t=this.parent;t&&t.id!=e.id;)t=t.parent;return!!t}},_.prototype.constructor=_,b.prototype=e=new _,e.constructor=b,e.getData=function(e,t,n,i){var o=this;!e||e.constructor==o.Writer&&o.data?t(o.data):(o.reader||(o.reader=new o.Reader(o.data,i)),o.reader.init((function(){e.init((function(){!function(e,t,n,i,o){var r=0;!function a(){var s=524288*r;i&&i(s,e.size),s<e.size?e.readUint8Array(s,Math.min(524288,e.size-s),(function(e){t.writeUint8Array(new Uint8Array(e),(function(){r++,a()}))}),o):t.getData(n)}()}(o.reader,e,t,n,i)}),i)})))},e.getText=function(e,t,i,o){this.getData(new n(o),e,t,i)},e.getBlob=function(e,t,n,o){this.getData(new i(e),t,n,o)},e.getData64URI=function(e,t,n,i){this.getData(new o(e),t,n,i)},w.prototype=t=new _,t.constructor=w,t.addDirectory=function(e){return v(this,e,null,!0)},t.addText=function(e,t){return v(this,e,{data:t,Reader:a,Writer:n})},t.addBlob=function(e,t){return v(this,e,{data:t,Reader:s,Writer:i})},t.addData64URI=function(e,t){return v(this,e,{data:t,Reader:l,Writer:o})},t.addFileEntry=function(e,t,n){f(this,e,t,n)},t.addData=function(e,t){return v(this,e,t)},t.importBlob=function(e,t,n){this.importZip(new s(e),t,n)},t.importText=function(e,t,n){this.importZip(new a(e),t,n)},t.importData64URI=function(e,t,n){this.importZip(new l(e),t,n)},t.exportBlob=function(e,t,n){this.exportZip(new i("application/zip"),e,t,n)},t.exportText=function(e,t,i){this.exportZip(new n,e,t,i)},t.exportFileEntry=function(e,t,n,i){this.exportZip(new zip.FileWriter(e,"application/zip"),t,n,i)},t.exportData64URI=function(e,t,n){this.exportZip(new o("application/zip"),e,t,n)},t.importZip=function(e,t,n){var i=this;c(e,(function(e){e.getEntries((function(e){e.forEach((function(e){var t=i,n=e.filename.split("/"),o=n.pop();n.forEach((function(e){t=t.getChildByName(e)||new w(i.fs,e,null,t)})),e.directory||v(t,o,{data:e,Reader:u})})),t()}))}),n)},t.exportZip=function(e,t,n,i){var o=this;g(o,(function(){d(e,(function(e){!function(e,t,n,i,o){var r=0;!function e(t,n,i,o,a){var s=0;!function l(){var c=n.children[s];c?t.add(c.getFullname(),c.reader,(function(){r+=c.uncompressedSize||0,e(t,c,(function(){s++,l()}),o,a)}),(function(e){o&&o(r+e,a)}),{directory:c.directory,version:c.zipVersion}):i()}()}(e,t,n,i,o)}(e,o,(function(){e.close(t)}),n,p(o))}),i)}),i)},t.getChildByName=function(e){var t,n;for(t=0;t<this.children.length;t++)if((n=this.children[t]).name==e)return n},C.prototype={remove:function(e){h(e),this.entries[e.id]=null},find:function(e){var t,n=e.split("/"),i=this.root;for(t=0;i&&t<n.length;t++)i=i.getChildByName(n[t]);return i},getById:function(e){return this.entries[e]},importBlob:function(e,t,n){y(this),this.root.importBlob(e,t,n)},importText:function(e,t,n){y(this),this.root.importText(e,t,n)},importData64URI:function(e,t,n){y(this),this.root.importData64URI(e,t,n)},exportBlob:function(e,t,n){this.root.exportBlob(e,t,n)},exportText:function(e,t,n){this.root.exportText(e,t,n)},exportFileEntry:function(e,t,n,i){this.root.exportFileEntry(e,t,n,i)},exportData64URI:function(e,t,n){this.root.exportData64URI(e,t,n)}},zip.fs={FS:C,ZipDirectoryEntry:w,ZipFileEntry:b},zip.getMimeType=function(){return"application/octet-stream"}}()}).call(window)},function(e,t){(function(){!function(e){"use strict";function t(e,t){var n={raw:!0,chunkSize:1048576};t&&"number"==typeof t.level&&(n.level=t.level),this._backEnd=e?new pako.Deflate(n):new pako.Inflate(n),this._chunks=[],this._dataLength=0,this._backEnd.onData=this._onData.bind(this)}function n(e){t.call(this,!0,e)}function i(){t.call(this,!1)}t.prototype._onData=function(e){this._chunks.push(e),this._dataLength+=e.length},t.prototype._fetchData=function(){var e=this._backEnd;if(0!==e.err)throw new Error(e.msg);var t,n=this._chunks;if(1===n.length)t=n[0];else if(n.length>1){t=new Uint8Array(this._dataLength);for(var i=0,o=n.length,r=0;i<o;i++){var a=n[i];t.set(a,r),r+=a.length}}return n.length=0,this._dataLength=0,t},t.prototype.append=function(e,t){return this._backEnd.push(e,!1),this._fetchData()},t.prototype.flush=function(){return this._backEnd.push(new Uint8Array(0),!0),this._fetchData()},n.prototype=Object.create(t.prototype),i.prototype=Object.create(t.prototype);var o=e.zip||e;o.Deflater=o._pako_Deflater=n,o.Inflater=o._pako_Inflater=i}(this)}).call(window)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REARRANGE_TAB_SELECTOR=t.REARRANGE_TAB_CLASS=void 0,t.allowRearrangeTabs=function(e){$(".tabs").sortable({axis:"x",containment:$("#header"),revert:150,activate:function(e,t){$(t.item[0]).trigger("click"),$(t.placeholder[0]).css({height:"1px"});var n=t.item.offset().top;$(".tabs").children().map((function(){$(this).hasClass("ui-sortable-placeholder")||$(this).offset().top>n&&$(this).addClass("hide")}))},beforeStop:function(){$(".tabs").children().removeClass("hide")}}),$("#mainframe").on("click",(function(){$(".more-button").hasClass("active")&&$(".more-button").removeClass("active")})),$("<div></div>").addClass("more-button").append($("<div></div>").addClass("more-symbol")).append($("<div></div>").addClass("moreTab")).on("click",(function(){gDesigner.stats("header_click_more-button",$(".more-button").hasClass("active")?"Close":"Open"),$(".more-button").hasClass("active")?$(".more-button").removeClass("active"):setTimeout((function(){$(".more-button").addClass("active")}),10),o()})).appendTo(e)},t.toggleRearrangeTabsVisibility=function(e,t){$(e).find(i).css("display",t?"":"none")},t.updateTabsInterface=o,n(1390);t.REARRANGE_TAB_CLASS="more-button";const i=".".concat("more-button");function o(){var e=0,t=0;$(".moreTab").empty(),$(".moreTab").append($(".tabs").children().clone(!0)),$(".moreTab").children().children().prepend($("<span/>").addClass("select")),$(".moreTab").css({left:-$(".moreTab").width(),maxHeight:$("body").height()-50}),$(".moreTab").children().off("contextmenu"),$(".tabs").children().each((function(n){if(t);else if((e+=$(this).outerWidth()+7.5)>$(".section.windows").outerWidth())return t=n})),setTimeout((function(){t&&$(".tabs>div").index($(".tab.g-active"))>=t&&$(".tabs").find(".tab.g-active").insertBefore($(".tabs").children().eq(t-1)),$(".moreTab").children().eq($(".tabs>div").index($(".tab.g-active"))).children().children(".select").addClass("more-tab-icon")}),100)}t.REARRANGE_TAB_SELECTOR=i},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(1391),n(1392),n(1141),n(1143),n(547),n(1142)],void 0===(r="function"==typeof(i=function(e){return e.widget("ui.sortable",e.ui.mouse,{version:"1.13.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&e<t+n},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,(function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var i=null,o=!1,r=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each((function(){if(e.data(this,r.widgetName+"-item")===r)return i=e(this),!1})),e.data(t.target,r.widgetName+"-item")===r&&(i=e(t.target)),!!i&&(!(this.options.handle&&!n&&(e(this.options.handle,i).find("*").addBack().each((function(){this===t.target&&(o=!0)})),!o))&&(this.currentItem=i,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,n,i){var o,r,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=e("parent"!==a.appendTo?a.appendTo:this.currentItem.parent()),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),e.extend(this.offset,{parent:this._getParentOffset()}),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(r=this.document.find("body"),this.storedCursor=r.css("cursor"),r.css("cursor",a.cursor),this.storedStylesheet=e("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(r)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(t),!0},_scroll:function(e){var t=this.options,n=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity?this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+t.scrollSpeed:e.pageY-this.overflowOffset.top<t.scrollSensitivity&&(this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-t.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity?this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+t.scrollSpeed:e.pageX-this.overflowOffset.left<t.scrollSensitivity&&(this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft-t.scrollSpeed)):(e.pageY-this.document.scrollTop()<t.scrollSensitivity?n=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity&&(n=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)),e.pageX-this.document.scrollLeft()<t.scrollSensitivity?n=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity&&(n=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed))),n},_mouseDrag:function(t){var n,i,o,r,a=this.options;if(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),this._contactContainers(t),null!==this.innermostContainer)for(a.scroll&&!1!==this._scroll(t)&&(this._refreshItemPositions(!0),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},n=this.items.length-1;n>=0;n--)if(o=(i=this.items[n]).item[0],(r=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(o===this.currentItem[0]||this.placeholder[1===r?"next":"prev"]()[0]===o||e.contains(this.placeholder[0],o)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],o))){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,o=this.placeholder.offset(),r=this.options.axis,a={};r&&"x"!==r||(a.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),r&&"y"!==r||(a.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(a,parseInt(this.options.revert,10)||500,(function(){i._clear(t)}))}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each((function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))})),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each((function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")})),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,o=i+this.helperProportions.height,r=e.left,a=r+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,d=this.offset.click.left,u="x"===this.options.axis||i+c>s&&i+c<l,p="y"===this.options.axis||t+d>r&&t+d<a,g=u&&p;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?g:r<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<a&&s<i+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,n,i="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),o="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!i||!o)&&(t=this.dragDirection.vertical,n=this.dragDirection.horizontal,this.floating?"right"===n||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),i=this.dragDirection.vertical,o=this.dragDirection.horizontal;return this.floating&&o?"right"===o&&n||"left"===o&&!n:i&&("down"===i&&t||"up"===i&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,i,o,r,a=[],s=[],l=this._connectWith();if(l&&t)for(n=l.length-1;n>=0;n--)for(i=(o=e(l[n],this.document[0])).length-1;i>=0;i--)(r=e.data(o[i],this.widgetFullName))&&r!==this&&!r.options.disabled&&s.push(["function"==typeof r.options.items?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);function c(){a.push(this)}for(s.push(["function"==typeof this.options.items?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=s.length-1;n>=0;n--)s[n][0].each(c);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,(function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0}))},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,o,r,a,s,l,c,d=this.items,u=[["function"==typeof this.options.items?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(n=p.length-1;n>=0;n--)for(i=(o=e(p[n],this.document[0])).length-1;i>=0;i--)(r=e.data(o[i],this.widgetFullName))&&r!==this&&!r.options.disabled&&(u.push(["function"==typeof r.options.items?r.options.items.call(r.element[0],t,{item:this.currentItem}):e(r.options.items,r.element),r]),this.containers.push(r));for(n=u.length-1;n>=0;n--)for(a=u[n][1],i=0,c=(s=u[n][0]).length;i<c;i++)(l=e(s[i])).data(this.widgetName+"-item",a),d.push({item:l,instance:a,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(t){var n,i,o,r;for(n=this.items.length-1;n>=0;n--)i=this.items[n],this.currentContainer&&i.instance!==this.currentContainer&&i.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=o.outerWidth(),i.height=o.outerHeight()),r=o.offset(),i.left=r.left,i.top=r.top)},refreshPositions:function(e){var t,n;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),null!==this.innermostContainer&&this._refreshItemPositions(e),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;t>=0;t--)n=this.containers[t].element.offset(),this.containers[t].containerCache.left=n.left,this.containers[t].containerCache.top=n.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(t){var n,i,o=(t=t||this).options;o.placeholder&&o.placeholder.constructor!==String||(n=o.placeholder,i=t.currentItem[0].nodeName.toLowerCase(),o.placeholder={element:function(){var o=e("<"+i+">",t.document[0]);return t._addClass(o,"ui-sortable-placeholder",n||t.currentItem[0].className)._removeClass(o,"ui-sortable-helper"),"tbody"===i?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(o)):"tr"===i?t._createTrPlaceholder(t.currentItem,o):"img"===i&&o.attr("src",t.currentItem.attr("src")),n||o.css("visibility","hidden"),o},update:function(e,r){n&&!o.forcePlaceholderSize||(r.height()&&(!o.forcePlaceholderSize||"tbody"!==i&&"tr"!==i)||r.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),r.width()||r.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(o.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),o.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,n){var i=this;t.children().each((function(){e("<td>&#160;</td>",i.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(n)}))},_contactContainers:function(t){var n,i,o,r,a,s,l,c,d,u,p=null,g=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(p&&e.contains(this.containers[n].element[0],p.element[0]))continue;p=this.containers[n],g=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(this.innermostContainer=p,p)if(1===this.containers.length)this.containers[g].containerCache.over||(this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1);else{for(o=1e4,r=null,a=(d=p.floating||this._isFloating(this.currentItem))?"left":"top",s=d?"width":"height",u=d?"pageX":"pageY",i=this.items.length-1;i>=0;i--)e.contains(this.containers[g].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[a],c=!1,t[u]-l>this.items[i][s]/2&&(c=!0),Math.abs(t[u]-l)<o&&(o=Math.abs(t[u]-l),r=this.items[i],this.direction=c?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[g])return void(this.currentContainer.containerCache.over||(this.containers[g]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));r?this._rearrange(t,r,null,!0):this._rearrange(t,null,this.containers[g].element,!0),this._trigger("change",t,this._uiHash()),this.containers[g]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[g],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[g]._trigger("over",t,this._uiHash(this)),this.containers[g].containerCache.over=1}},_createHelper:function(t){var n=this.options,i="function"==typeof n.helper?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||this.appendTo[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),i[0].style.width&&!n.forceHelperSize||i.width(this.currentItem.width()),i[0].style.height&&!n.forceHelperSize||i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),Array.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(t=e(o.containment)[0],n=e(o.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(o[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*i}},_generatePosition:function(t){var n,i,o=this.options,r=t.pageX,a=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),o.grid&&(n=this.originalPageY+Math.round((a-this.originalPageY)/o.grid[1])*o.grid[1],a=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-o.grid[1]:n+o.grid[1]:n,i=this.originalPageX+Math.round((r-this.originalPageX)/o.grid[0])*o.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-o.grid[0]:i+o.grid[0]:i)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay((function(){o===this.counter&&this.refreshPositions(!i)}))},_clear:function(e,t){this.reverting=!1;var n,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function o(e,t,n){return function(i){n._trigger(e,i,t._uiHash(t))}}for(this.fromOutside&&!t&&i.push((function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push((function(e){this._trigger("update",e,this._uiHash())})),this!==this.currentContainer&&(t||(i.push((function(e){this._trigger("remove",e,this._uiHash())})),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||i.push(o("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(i.push(o("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<i.length;n++)i[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(1141),n(547),n(1142)],void 0===(r="function"==typeof(i=function(e){var t=!1;return e(document).on("mouseup",(function(){t=!1})),e.widget("ui.mouse",{version:"1.13.0",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,(function(e){return t._mouseDown(e)})).on("click."+this.widgetName,(function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,o=1===n.which,r=!("string"!=typeof this.options.cancel||!n.target.nodeName)&&e(n.target).closest(this.options.cancel).length;return!(o&&!r&&this._mouseCapture(n))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){i.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=!1!==this._mouseStart(n),!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(n){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,t=!1,n.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){var i,o,r;!function(a){"use strict";o=[n(173),n(547)],void 0===(r="function"==typeof(i=function(e){return e.extend(e.expr.pseudos,{data:e.expr.createPseudo?e.expr.createPseudo((function(t){return function(n){return!!e.data(n,t)}})):function(t,n,i){return!!e.data(t,i[3])}})})?i.apply(t,o):i)||(e.exports=r)}()},function(e,t,n){"use strict";n(28);const i=n(353),o=n(78),r=n(77),a=n(200);function s(e){this._htmlElement=e}s.prototype._root=null,s.prototype._panels=[],s.prototype._activePanel=null,s.prototype.init=function(){this._root=$("<div></div>").addClass("root").appendTo(this._htmlElement),gravit.footer.forEach(e=>{let t=$("<div></div>").addClass("panel-container");this._root.append(t),e.init(t),this._panels.push({container:t,panel:e}),this._activePanel||this.setActivePanel(e.getId()),e.addEventListener(i.UpdateEvent,function(){this._updateFooter(),gDesigner.relayout()}.bind(this))}),this._updateFooter(),gDesigner.addEventListener(o,this._documentEvent,this)},s.prototype._documentEvent=function(e){const t=e.document;switch(e.type){case o.Type.Activated:t.addEventListener(a,this._documentStatusChanged,this),this._document=t;break;case o.Type.Deactivated:t.removeEventListener(a,this._documentStatusChanged,this),this._document=null}},s.prototype._documentStatusChanged=function(e){if(!this._document||gDesigner.getActiveDocument()!==this._document)return;const t=e=>this._htmlElement.toggleClass("document-loading",e);switch(e.status){case r.Loading:case r.Saving:case r.Syncing:case r.Downloading:if((this._document.isCloudFile()||this._document.isExternalFile())&&e.status===r.Saving)return;t(!0);break;case r.LoadCancelled:case r.DownloadCancelled:case r.SaveCancelled:case r.Saved:case r.SyncFailed:case r.Downloaded:case r.DownloadFailed:case r.Loaded:case r.LoadFailed:t(!1)}},s.prototype._updateFooter=function(){const e=this._panels.some(e=>e.panel.isEnabled());this._htmlElement.css("display",e?"":"none")},s.prototype.setActivePanel=function(e){for(var t=0;t<this._panels.length;++t){var n=this._panels[t],i=n.panel.getId();i===e?(n.container.css("display",""),n.panel.activate()):(n.container.css("display","none"),i===this._activePanel&&n.panel.deactivate())}this._activePanel=e},s.prototype.relayout=function(){},s.prototype.getHeight=function(){return this._htmlElement[0].clientHeight},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(9),n(14),n(29),n(3);var o=n(12),r=n(1),a=i(n(78));const s=n(36),l=n(772),c=n(76),d=n(718),u=n(264);function p(e){this._htmlElement=e}r.GObject.inherit(p,r.GObject),p.prototype._interval=null,p.prototype._needToShow=!1,p.prototype.init=function(){this.update(),gDesigner.addEventListener(d,this._userPropertiesChangedEvent,this),gDesigner.addEventListener(u,this._userLoggedEvent,this),gDesigner.addEventListener(a.default,this._documentEvent,this)},p.prototype.update=async function(){return gDesigner.getUser().then(e=>this._updateInfo(e))},p.prototype._userPropertiesChangedEvent=function(e){this._updateInfo(e.user)},p.prototype._togglePanel=function(e){"boolean"==typeof e&&(!e&&!this._needToShow||e)&&gDesigner.setPartVisible(l.Info,e)},p.prototype._userLoggedEvent=function(e){this._updateInfo(e.user)},p.prototype._documentEvent=function(e){this._togglePanel(!1),this._updateSaveInfo(e),this._updateDocumentSubscription(e)},p.prototype._updateSaveInfo=function(){},p.prototype._updateDocumentSubscription=function(){},p.prototype._updateInfo=function(e){if(this._togglePanel(!1),this._interval&&clearInterval(this._interval),gDesigner.isEnabledSubscriptions()&&!gDesigner.getLicense().isGuest()&&e&&!e.isEmailVerified()&&!e.isAnonymous()){this._interval=setInterval(this.update.bind(this),o.DateAPI.daysToMilliseconds(1)),o.gApi.listen("/confirmation",()=>this.update(),!0);let t=new Date(e.created);e.email_expire&&(t=new Date(e.email_expire));let n=r.GLocale.get(new r.GLocaleKey("GInfo","text.title")).replace("%date",r.GLocale.toLocaleDate(t));this._htmlElement.empty().append($("<span></span>").text(n)).append($("<span/>").addClass("link").text(r.GLocale.get(new r.GLocaleKey("GInfo","text.resend-email"))).on("click",()=>{let t,n;if(gContainer.getRuntime()===c.Runtime.Electron){const e=gContainer.getPlatform();"darwin"!==e&&"win32"!==e||(t="designer://"),n=gDesigner.getAssetsURL()}else n=location.origin;return o.gApi.resendEmailConfirmation({appUrl:t,webUrl:n,email:e.email,force:!0,origin:location.origin}).then(()=>{s.custom({title:r.GLocale.get(new r.GLocaleKey("GInfo","text.email-sent")),subtitle:r.GLocale.get(new r.GLocaleKey("GInfo","text.email-sent-submessage")),icon:"ok"})}).catch(e=>{s.custom({title:r.GLocale.get(new r.GLocaleKey("GInfo","text.something-went-wrong")),subtitle:o.gApi.formatError(e)})}),!1})),this._togglePanel(!0)}},p.prototype.toString=function(){return"[Object GInfo]"},e.exports=p},function(e,t,n){"use strict";n(3);var i=n(1),o=n(43),r=n(56),a=n(217),s=n(397),l=n(108),c=n(1137),d=n(399),u=n(395);const p=n(118);function g(){}i.GObject.inherit(g,l),g.prototype._panel=null,g.prototype._toolbar=null,g.prototype._exportButton=null,g.prototype._createSliceButton=null,g.prototype._document=null,g.prototype._elements=null,g.prototype._sizeMenu=null,g.prototype.isSticky=function(){return!0},g.prototype.init=function(e,t){this._panel=e,this._toolbar=t,t.addClass("list-toolbar"),$("<label></label>").addClass("panel-title").text(i.GLocale.get(new i.GLocaleKey("GExportProperties","text.make-exportable"))).appendTo(t),this._exportButton=$("<button></button>").addClass("btn-export").attr("id","btn-export").attr("data-title",i.GLocale.get(new i.GLocaleKey("GCommonNames","text.export"))+"...").append($("<span></span>").addClass("gravit-icon-export")).on("click",this._export.bind(this)).appendTo(t),this._createSliceButton=$("<button></button>").attr("data-title",i.GLocale.get(new i.GLocaleKey("GExportProperties","action.create-slice"))).append($("<span></span>").addClass("gravit-icon-slice")).on("click",this._createSlice.bind(this)).appendTo(t).gRichTooltip(r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GExportProperties","text.create-slice-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GExportProperties","text.create-slice-tooltip-description")),learnMore:"https://documentation.designer.io/import-export/export/#slices"})),$("<button></button>").attr("data-title",i.GLocale.get(new i.GLocaleKey("GExportProperties","action.add"))).append($("<span></span>").addClass("gravit-icon-plus")).on("click",this._addExport.bind(this)).appendTo(t).gRichTooltip(r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GExportProperties","text.add-export-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GExportProperties","text.add-export-tooltip-description")),learnMore:"https://documentation.designer.io/import-export/export/#mass-exporting-assets-and-slices"})),this._sizeMenu=new a,this._sizeMenu.createAddItem("1x"),this._sizeMenu.createAddItem("2x"),this._sizeMenu.createAddItem("0.5x"),this._sizeMenu.createAddItem("3x"),this._sizeMenu.createAddItem("512w"),this._sizeMenu.createAddItem("512h"),this._sizeMenu.createAddItem("128x128"),this._sizeMenu.createAddItem("300dpi"),gDesigner.addEventListener(p,this._settingChanged,this)},g.prototype.update=function(e){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null),this._elements=null,e){this._document=e;var t=this._getElements();this._elements=[];for(var n=!1,o=0;o<t.length;++o)t[o]instanceof i.GBlock&&this._elements.push(t[o]),t[o]instanceof i.GSlice||(n=!0);if(this._elements&&this._elements.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._createSliceButton.css("display",n?"":"none"),this._updateProperties(),!0}return!1},g.prototype._getElements=function(){var e=this._document.getEditor();if(this._document&&e&&(this._elements=e.getSelection(),this._elements&&this._elements.length&&(this._elements=e.filterIndividualElements(this._elements)),!this._elements||0===this._elements.length)){var t=gDesigner.getToolManager().getActiveTool(),n=null;t instanceof o.GItemTool&&(n=t.getDefaultStyle())?this._elements=[n]:this._elements=[this._document.getScene().getActivePage()]}return this._elements},g.prototype._export=function(){new d(()=>{gDesigner.stats("exportproperties_click_export");var e=c.generateExportables(this._elements);c.export(e,this._document.getStorage()||gDesigner.getDefaultStorage(),this._document.getTitle(),null,null,!0)},()=>{gDesigner.stats("exportproperties_cancel_anonymous")})},g.prototype._createSlice=function(){gDesigner.stats("exportproperties_click_createslice");var e=this._document.getEditor();e.beginTransaction();try{for(var t=[],n=0;n<this._elements.length;++n){var o=this._elements[n];if(!(o instanceof i.GSlice)){var r=(o.getProperty(u.EXPORT_PROPERTY_NAME,!0,[])||[]).slice(),a=o.getPaintBBox();o.setProperty(u.EXPORT_PROPERTY_NAME,void 0,!0);var s=new i.GSlice;s.setProperties(["x","y","w","h"],[a.getX(),a.getY(),a.getWidth(),a.getHeight()]),s.setProperty(u.EXPORT_PROPERTY_NAME,r,!0),t.push(s)}}e.insertElements(t,!0,!0,!1)}finally{e.commitTransaction(i.GLocale.get(new i.GLocaleKey("GExportProperties","action.create-slices")))}},g.prototype._addExport=function(){gDesigner.stats("exportproperties_click_add-item-to-export");var e=this._document.getEditor();e.beginTransaction();try{for(var t=0;t<this._elements.length;++t){for(var n=this._elements[t],o=(n.getProperty(u.EXPORT_PROPERTY_NAME,!0,[])||[]).slice(),r={sz:"",sf:"",fm:"png"},a=[{sz:"1x",sf:"@1x"},{sz:"2x",sf:"@2x"},{sz:"3x",sf:"@3x"},{sz:"1.5x",sf:"@1,5x"},{sz:"0.5x",sf:"@0,5x"}],s=0;s<a.length;++s){for(var l=a[s],c=!1,d=0;d<o.length;++d)if(o[d].sz===l.sz){c=!0;break}if(!c){r.sz=l.sz,r.sf=o.length>0?l.sf:"";break}}o.push(r),n.setProperty(u.EXPORT_PROPERTY_NAME,o,!0)}}finally{e.commitTransaction(i.GLocale.get(new i.GLocaleKey("GExportProperties","action.add")))}},g.prototype._settingChanged=function(e){"touch"===e.key&&this._updateProperties()},g.prototype._updateExport=function(e,t,n){var o=this._document.getEditor();o.beginTransaction();try{for(var r=0;r<this._elements.length;++r){var a=this._elements[r],s=a.getProperty(u.EXPORT_PROPERTY_NAME,!0);!s||e>=s.length||((s=s.slice())[e]=$.extend({},s[e]),s[e][t]=n,a.setProperty(u.EXPORT_PROPERTY_NAME,s,!0))}}finally{o.commitTransaction(i.GLocale.get(new i.GLocaleKey("GExportProperties","action.update-setting")))}},g.prototype._removeExport=function(e){var t=this._document.getEditor();t.beginTransaction();try{for(var n=0;n<this._elements.length;++n){var o=this._elements[n],r=o.getProperty(u.EXPORT_PROPERTY_NAME,!0);!r||e>=r.length||((r=r.slice()).splice(e,1),o.setProperty(u.EXPORT_PROPERTY_NAME,r,!0))}}finally{t.commitTransaction(i.GLocale.get(new i.GLocaleKey("GExportProperties","action.remove")))}},g.prototype._afterPropertiesChange=function(e){!e.temporary&&this._elements.length&&this._elements[0]===e.node&&e.properties.indexOf(u.EXPORT_PROPERTY_NAME)>=0&&this._updateProperties()},g.prototype._updateProperties=function(){var e=[],t=gDesigner.isTouchEnabled(),n=t?"40%":"30%",o=t?"25%":"35%",r=t?"25%":"30%",a=t?"12%":"5%";if(this._elements)for(let t=0;t<this._elements.length;++t){var l=this._elements[t].getProperty(u.EXPORT_PROPERTY_NAME,!0,[])||[];if(l)for(var c=0;c<l.length;++c)c<e.length?e[c].diff=!0:e.push($.extend({},l[c]))}this._panel.empty().css("margin",e.length?"":"0"),this._toolbar.toggleClass("empty-list",0===e.length).find("label:first-child").text(0===e.length?i.GLocale.get(new i.GLocaleKey("GExportProperties","text.make-exportable")):i.GLocale.get(new i.GLocaleKey("GCommonNames","text.export"))),this._exportButton.css("display",e.length?"":"none");for(let l=0;l<e.length;++l){var d=l+1===e.length,p=e[l];$("<div></div>").data("index",l).gPropertyRow({clazz:"export-properties-row",columns:[{width:n,label:d?i.GLocale.get(new i.GLocaleKey("GCommonNames","text.size")):null,content:$("<div></div>").append($("<input/>").attr("type","text").css("margin","0").css("width","70%").val(p.sz).on("change",function(e){gDesigner.stats("exportproperties_change_size-dropdown");var t=$(e.target);this._updateExport($(e.target).closest(".g-property-row").data("index"),"sz",t.val())}.bind(this))).append($("<button></button>").addClass("g-flat").css("width","30%").append($('<span class="gravit-icon-down"></span>').css("font-size","12px")).on("click",function(e){gDesigner.stats("exportproperties_click_change-size"),this._sizeMenu.open(e.target,s.Position.Left_Top,s.Position.Right_Bottom,(function(t){$(e.target).closest("div").find("input").val(t.getCaption()).trigger("change").focus().select()}))}.bind(this)))},{width:o,label:d?i.GLocale.get(new i.GLocaleKey("GExportProperties","text.suffix")):null,content:$("<input/>").attr("type","text").val(p.diff?null:p.sf).attr("placeholder",p.diff?i.GLocale.get(new i.GLocaleKey("GExportProperties","text.multiple")):i.GLocale.get(new i.GLocaleKey("GCommonNames","text.none"))).on("change",function(e){gDesigner.stats("exportproperties_toggle_multiple");var t=$(e.target);this._updateExport($(e.target).closest(".g-property-row").data("index"),"sf",t.val())}.bind(this))},{width:r,label:d?i.GLocale.get(new i.GLocaleKey("GExportProperties","text.format")):null,content:$("<select></select>").append($("<option></option>").attr("value","png").text("PNG")).append($("<option></option>").attr("value","jpg").text("JPEG")).append($("<option></option>").attr("value","svg").text("SVG")).append($("<option></option>").attr("value","pdf").text("PDF")).val(p.fm).on("change",function(e){gDesigner.stats("exportproperties_format_dropdown");var t=$(e.target);this._updateExport($(e.target).closest(".g-property-row").data("index"),"fm",t.val())}.bind(this))},{width:a,content:$("<button></button>").addClass(t?"g-flat gravit-icon-close":"g-flat").html(t?"":"&#x2715;").on("click",function(e){gDesigner.stats("exportproperties_click_removeitem"),this._removeExport($(e.target).closest(".g-property-row").data("index"))}.bind(this))}]}).appendTo(this._panel)}},g.prototype.toString=function(){return"[Object GExportProperties]"},e.exports=g},function(e,t,n){var i=n(22);e.exports=i(1..valueOf)},function(e,t,n){"use strict";var i=n(6),o=n(114),r=n(57),a=n(95),s=i.RangeError;e.exports=function(e){var t=r(a(this)),n="",i=o(e);if(i<0||i==1/0)throw s("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},function(e,t,n){"use strict";n(3);var i=n(1),o=n(1399);function r(e){this._htmlElement=$("<div></div>").addClass("g-effects-panel").gOverlay({releaseOnClose:!1,padding:!1}),this._catTranslate=e}r.prototype._htmlElement=null,r.prototype._content=null,r.prototype._catTranslate=null,r.prototype._parent=null,r.prototype.addItem=function(e){this._content.append(e._htmlElement)},r.prototype.createSelector=function(){var e=$("<select></select>").addClass("g-effects-select").addClass("active");return this._htmlElementSelector=$("<div></div>").addClass("g-effects-selector").append(e),this._htmlElement.append(this._htmlElementSelector),e},r.prototype.addItems=function(e){for(this._content||(this._content=$("<div></div>").addClass("g-effects-content"),this._htmlElement.append(this._content));e.length%3!=0;){var t=new o;e.push(t)}this._content.children(".g-effects-button").remove();for(var n=0;n<e.length;++n)if(e[n]instanceof o)this.addItem(e[n]);else{t=new o(i.GLocale.getValue(e[n].i18n,"name"),e[n].icon,e[n].clazz,e[n].cb,!e[n].mostUsed,e[n],this._catTranslate);this.addItem(t)}},r.prototype.open=function(e){this._parent=e,this._htmlElement.gOverlay("open",e)},r.prototype.close=function(e){this._htmlElement.gOverlay("close",e||this._parent)},r.prototype.toString=function(){return"[Object GEffectsPanel]"},e.exports=r},function(e,t,n){"use strict";n(3);var i=n(1),o=n(32);function r(e,t,n,r,a,s,l){var c=e&&t&&n&&r&&l;if(this._htmlElement=$("<li></li>").addClass("g-effects-button"),c){let c="";s&&s.category&&(c=l(s.category)+"/"),this._htmlElement.gPro({pro:a}).append($("<span></span>").addClass("g-effects-button-icon").append($("<i></i>").addClass(t))).append($("<span></span>").addClass("g-effects-button-caption").append(e)).on("click",o.watchDog.trap((function(){let e=n&&i.GLocale.getValue(s&&s.i18n||n,"name","unknown",0)||"unkn";a?gDesigner.stats("effects_add_proeffectdefault",c+e):gDesigner.stats("effects_add_effectdefault",c+e),r(n,s)}),()=>!a,()=>gDesigner.stats("effects_nonprotriespro_proeffectdefault",c+(n&&i.GLocale.getValue(s&&s.i18n||n,"name","unknown",0)||"unkn")))).on("mouseover",function(){this._htmlElement.addClass("active")}.bind(this)).on("mouseout",function(){this._htmlElement.removeClass("active")}.bind(this))}}r.prototype._htmlElement=null,r.prototype.toString=function(){return"[Object GEffectsButton]"},e.exports=r},function(e,t,n){"use strict";var i=n(17);n(19),n(9),n(24),n(14),n(29),n(45),n(3);var o=n(1),r=n(12),a=n(1051),s=i(n(108)),l=i(n(1047)),c=i(n(202)),d=i(n(144)),u=i(n(192)),p=i(n(78)),g=i(n(77)),h=i(n(200)),f=i(n(305)),m=i(n(56));function y(){}o.GObject.inherit(y,s.default),y.ID="version-history",y.TITLE=new o.GLocaleKey("GVersionHistoryProperties","title"),y.prototype._relayoutBindedToActiveDocument=null,y.prototype._panel=null,y.prototype._toolbar=null,y.prototype._loadingIndicator=null,y.prototype._previewOverlay=null,y.prototype._fileId=null,y.prototype._enabledInputs=null,y.prototype._previousDoc=null,y.prototype._previewDoc=null,y.prototype.isGroup=function(e){return!0},y.prototype.isAvailable=function(e){return!1},y.prototype.init=function(e,t){this._panel=e,this._toolbar=t;t.addClass("filled"),t.addClass("version-history-toolbar"),$("<label/>").addClass("version-history-toolbar").append($("<span />").addClass("pro").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","title")))).appendTo(t),$("<button/>").append($("<span></span>").addClass("gravit-icon-detach")).on("click",function(){gDesigner.stats("version-history-panel_close_panel"),this.close()}.bind(this)).appendTo(t),this._loadingIndicator=$("<div/>").addClass("version-history-panel-loading g-loading").appendTo(e),this._versionsContainer=$("<div/>").addClass("section").append([$("<div/>").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.title-manual-save"))).gRichTooltip(m.default.from({title:o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.title-manual-save-tooltip-title")),middle:!1,marginLeft:10})),$("<div/>").addClass("content")]);var n=$("<div/>").addClass("container").append(this._versionsContainer).appendTo(e);r.AUTO_SAVE_ENABLED&&(this._autoSaveContainer=$("<div/>").addClass("section").append([$("<div/>").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.title-auto-save"))).gRichTooltip(m.default.from({title:o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.title-auto-save-tooltip-title")),middle:!1,marginLeft:10})),$("<div/>").addClass("content")]).appendTo(n)),gDesigner.addEventListener(l.default,this._handleEvent,this)},y.prototype._handleEvent=function(e){e.type===l.default.Type.Enable?this._updateVersionHistory(e.fileId):e.type===l.default.Type.Close&&this.close()},y.prototype._updateVersionHistory=function(e){this._versionsContainer.find(".content").empty(),r.AUTO_SAVE_ENABLED&&this._autoSaveContainer.find(".content").empty(),this._toggleLoading(!0);var t=this;this._fileId=e;const n=[r.gApi.listVersions(this._fileId,"tf").then(e=>{const{f:t,t:n}=e;let i=[];for(let e=0,t=n?n.length:0;e<t;e++)n[e]?i.push(r.gApi.getFile(this._fileId,!1,n[e].versionId,"t")):i.push(null);return Promise.all(i).then(e=>{let n=[];for(let i=0,o=t.length;i<o;i++){let o={version:t[i],thumbnail:e[i]||{name:gDesigner.getWindows().getActiveWindow().getTitle(),url_t:"assets/icon/versus.svg"}};n.push(o)}return Promise.resolve(n)})})];r.AUTO_SAVE_ENABLED&&n.push(r.gApi.listAutoSaves(this._fileId).then(e=>{let t=[],n=[];for(let t=0,i=e.versions.length;t<i;t++)n.push(e.versions_t&&e.versions_t[t]?r.gApi.getAutoSaveThumbnail(this._fileId,e.versions_t[t].versionId):null);return Promise.all(n).then(n=>{for(let i=0,o=e.versions.length;i<o;i++){let o={version:e.versions[i],thumbnail:{name:gDesigner.getWindows().getActiveWindow().getTitle(),url_t:n&&n[i]&&n[i].url||"assets/icon/versus.svg"},autosave:!0};t.push(o)}return t})})),Promise.all(n).then(e=>{let[n,i]=e;t._renderVersionsList(n,i),this._toggleLoading(!1)}).catch(e=>(new u.default(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","error-loading"))).open(),this._toggleLoading(!1),!1))},y.prototype._renderVersionsList=function(e,t){const n=gDesigner.isEnabledProFeatures(),i=this,s=gDesigner.getActiveDocument().getStorageItem(),l=s&&s.getVersionId&&s.getVersionId(),c=!!l;let d,u=this._versionsContainer.find(".content");r.AUTO_SAVE_ENABLED&&(d=this._autoSaveContainer.find(".content"));const g=e.find(e=>e.version.latest);let h=g,m=!1;if(r.AUTO_SAVE_ENABLED&&t&&t.length){const e=t.find(e=>e.version.latest);r.DateAPI.lt(g.version.modified,e.version.modified,!1)&&(h=e,m=!0)}const y=(e,t,r)=>{let{version:s,thumbnail:d,autosave:u}=e;return $("<div />").addClass("version-history-item").addClass((c?l===s.versionId:(m&&u||!m&&!u)&&s.latest)?"vhi-initial":"").addClass(n||s.latest?"":"vhi-disabled").addClass((c?l===s.versionId:s.versionId===h.version.versionId)?"vhi-active":"").append($("<div />").addClass("vhi-thumbnail").css("background-image","url("+d.url_t+")")).append($("<div />").addClass("vhi-info").append($("<div />").addClass("vhi-title").text(s.versionId===h.version.versionId?o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.current-version")):o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","text.version")).replace("%version",r-t))).append($("<div />").addClass("vhi-updated").text((0,a.dateToVersionFormat)(s.modified)))).append($("<div />").addClass("vhi-settings").addClass("gravit-icon-settings").on("click",(function(e){e.stopPropagation(),(n||s.latest)&&($(this).find(".vhi-settings-list").toggle(),gDesigner.stats("version-history-panel_click_setting-icon"))})).on("dblclick",(function(e){e.stopPropagation()})).append($("<div />").addClass("vhi-settings-list").append($("<div />").addClass("vhi-settings-item g-menu-item-menu").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","preview"))).on("click",(function(e){e.stopPropagation(),gDesigner.stats("version-history-panel_show-preview_from-settings-menu"),gDesigner.intercomStats("Preview version from history"),i._showPreview(s.versionId,d.name,$(this).closest(".version-history-item"),u),$(this).parent(".vhi-settings-list").hide()}))).append($("<div />").addClass("vhi-settings-item g-menu-item-menu").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","restore"))).on("click",(function(e){e.stopPropagation(),gDesigner.stats("version-history-panel_restore-version_from-settings-menu"),gDesigner.intercomStats("Open version from history"),i._applyVersion(s.versionId,d.name,u),$(this).parent(".vhi-settings-list").hide()}))))).on("click",(function(e){if($(this).hasClass("vhi-disabled"))return gDesigner.stats("version-history-panel_click_disabled"),gDesigner.handlePROFeatureInterruption(),!1;var t=this;setTimeout((function(){var e=parseInt($(t).data("dblclicked"),10);e?$(t).data("dblclicked",e-1):(gDesigner.stats("version-history-panel_show-preview_from-main-panel"),i._showPreview(s.versionId,d.name,$(t),u),gDesigner.intercomStats("Preview version from history"))}),500)})).on("dblclick",(function(e){if($(this).hasClass("vhi-disabled"))return gDesigner.stats("version-history-panel_dblclick_disabled"),gDesigner.handlePROFeatureInterruption(),!1;$(this).data("dblclicked",2),gDesigner.stats("version-history-panel_apply-version"),i._applyVersion(s.versionId,d.name,u),gDesigner.intercomStats("Open version from history")})).on("mouseenter",(function(){(n||s.latest)&&$(this).addClass("show-icon")})).on("mouseleave",(function(){$(this).removeClass("show-icon"),$(this).find(".vhi-settings-list").hide()}))};function v(e){for(let t=0,n=e.length;t<n;t++){let i=e[t],o=null;o=i.autosave?d:u,o.append(y(i,t,n))}}u.empty(),d&&d.empty(),v(e),r.AUTO_SAVE_ENABLED&&v(t),this._updatePanelHeight(),gDesigner.addEventListener(p.default,this._documentEvent,this),gDesigner.addEventListener(f.default,this._storageEventHandler,this)},y.prototype._updatePanelHeight=function(){let e=parseInt(this._panel.closest(".sidebar-inspector").outerHeight(),10)-parseInt(this._toolbar.outerHeight(),10);this._panel.css("height",e)},y.prototype._documentStatusEventHandler=function(e){let{status:t}=e;t===g.default.LoadFailed&&this._closePreview()},y.prototype._documentEvent=function(e){let{document:t,type:n}=e;if(n===p.default.Type.AutoSaveSynchronized)return void this._updateVersionHistory(this._fileId);if(this._loadingPreview)return;const i=t.getStorageItem()instanceof c.default.Item,o=t.getScene();(i&&t.getStorageItem().getId()!==this._fileId||!i&&o&&o.getProperty("cid")!==this._fileId)&&this.close()},y.prototype._storageEventHandler=function(e){let{type:t,storageItem:n}=e;t===f.default.Type.VersionUpdate&&n instanceof c.default.Item&&this._fileId===n.getId()&&this._updateVersionHistory(this._fileId)},y.prototype._showPreview=async function(e,t,n,i){var r=gDesigner.getActiveDocument();if(r.isModified())return new u.default(o.GLocale.get(new o.GLocaleKey("GVersionsHistoryAction","unsaved-modifications"))).open(),!1;this._loadingPreview=!0;var a=new d.default(await c.default.from(gDesigner.getDefaultStorage(),this._fileId,t,e,!!i));a.lockByVersionHistory(),this._previewDoc?(gDesigner.replaceDocument(this._previewDoc,a),this._previewDoc.removeEventListener(h.default,this._documentStatusEventHandler,this),this._previewDoc=a):(this._previousDoc=r,this._previewDoc=a,gDesigner.replaceDocument(this._previousDoc,a)),a.addEventListener(h.default,this._documentStatusEventHandler,this),a.load(null,{progress:e=>{100==e&&(this._loadingPreview=!1,gDesigner.trigger(new p.default(p.default.Type.StorageItemUpdated,a)))}}),this._enabledInputs||(this._enabledInputs={allEnabledButtons:$("button:not([disabled=true])"),allEnabledInput:$("input:not([disabled=true])"),allEnabledTextarea:$("textarea:not([disabled=true])")},this._enabledInputs.allEnabledButtons.attr("disabled",!0),this._enabledInputs.allEnabledInput.attr("disabled",!0),this._enabledInputs.allEnabledTextarea.attr("disabled",!0)),$(".version-history-item.vhi-active").removeClass("vhi-active"),n.addClass("vhi-active"),this._previewOverlay||(this._previewOverlay=$("<div />").css({position:"absolute",zIndex:9999,left:0,right:0,top:0,bottom:0}).data("versionId",e).data("title",t).appendTo($("body")),this._relayout(e,t,i),this._relayoutBindedToActiveDocument&&window.removeEventListener("resize",this._relayoutBindedToActiveDocument),this._relayoutBindedToActiveDocument=this._relayout.bind(this,e,t,i),window.addEventListener("resize",this._relayoutBindedToActiveDocument))},y.prototype._relayout=function(e,t,n){if(this._previewOverlay){var i=$("#toolbar");this._buttonsToolbar=$("<div />").addClass("vhp-preview-overlay").css({position:i.css("position"),top:i.css("top"),left:i.css("left"),right:i.css("right"),bottom:i.css("bottom"),background:i.css("background")||i.css("background-color"),border:i.css("border")}).append($("<button />").addClass("edit-version").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","edit-version"))).on("click",function(){gDesigner.stats("version-history-panel_edit-version"),gDesigner.intercomStats("Open version from history"),this._applyVersion(e,t,n)}.bind(this))).append($("<button />").addClass("close-preview").text(o.GLocale.get(new o.GLocaleKey("GVersionHistoryProperties","close-preview"))).on("click",function(){gDesigner.stats("version-history-panel_close_preview"),this._closePreview()}.bind(this))),this._previewOverlay.empty().append(this._buttonsToolbar),this._panel.addClass("z-index-top"),this._toolbar.addClass("z-index-top")}this._updatePanelHeight()},y.prototype._closePreview=function(){this._enabledInputs&&(this._enabledInputs.allEnabledButtons.removeAttr("disabled"),this._enabledInputs.allEnabledInput.removeAttr("disabled"),this._enabledInputs.allEnabledTextarea.removeAttr("disabled"),this._enabledInputs=null),this._previousDoc&&(gDesigner.openDocument(this._previousDoc.getStorageItem()),this._previousDoc=null),this._previewDoc&&(this._previewDoc.removeEventListener(h.default,this._documentStatusEventHandler,this),this._previewDoc!==gDesigner.getActiveDocument()&&gDesigner.removeDocument(this._previewDoc),this._previewDoc=null,$(".version-history-item.vhi-active").removeClass("vhi-active"),$(".version-history-item.vhi-initial").addClass("vhi-active")),this._previewOverlay&&(window.removeEventListener("resize",this._relayoutBindedToActiveDocument),this._panel.removeClass("z-index-top"),this._toolbar.removeClass("z-index-top"),this._previewOverlay.remove(),this._previewOverlay=null)},y.prototype._applyVersion=async function(e,t,n){gDesigner.stats("version-history-panel_open_version",this._fileId);var i=gDesigner.getActiveDocument();if(i.isModified())return new u.default(o.GLocale.get(new o.GLocaleKey("GVersionsHistoryAction","unsaved-modifications"))).open(),!1;var r=gDesigner.openDocumentWithReload(await c.default.from(gDesigner.getDefaultStorage(),this._fileId,t,e,n));gDesigner.activateDocument(r),this._previousDoc&&(this._previousDoc=null),this._previewDoc||gDesigner.removeDocument(i),this.close()},y.prototype._toggleLoading=function(e){var t=this._panel.find(".container");e?(t.hide(),this._loadingIndicator.show()):(t.show(),this._loadingIndicator.hide())},y.prototype.close=function(){gDesigner.stats("version-history-panel_close_panel",this._fileId),this._closePreview(),gDesigner.trigger(new l.default(l.default.Type.Disable)),gDesigner.removeEventListener(p.default,this._documentEvent,this),gDesigner.removeEventListener(f.default,this._storageEventHandler,this)},y.prototype.toString=function(){return"[Object GVersionHistoryProperties]"},e.exports=y},function(e,t,n){"use strict";const i=n(354);e.exports=function(e){e.prototype._versionHistoryPanelOverlay=null,e.prototype._updateVersionsPanelTouch=function(){if(this._versionHistoryMode){this._versionHistoryPanelOverlay||(this._versionHistoryPanelOverlay=$("<div/>").append(this._versionHistoryPanel).gOverlay({clazz:"g-version-history-panel-overlay",closeCallback:()=>this._versionHistoryProperties.close()}));const e=(this.getOrientation()===i.Orientation.Left?gDesigner.getLeftSidebars():gDesigner.getRightSidebars()).getHtmlElement(),t=e.offset(),n=e.width();this._versionHistoryPanelOverlay.css({minWidth:n}).gOverlay("open",{x:t.left+n,y:t.top})}else this._versionHistoryPanelOverlay&&this._versionHistoryPanelOverlay.gOverlay("close"),this._versionHistoryPanelOverlay=null}}},function(e,t,n){"use strict";n(9),n(58);const i=n(77),o=n(78),r=n(1403),a=n(1404),s=n(1405),l=n(151),c=n(702),d=n(703);function u(e){this._worker=e,this._docs=[]}u.prototype._docs=null,u.prototype._worker=null,u.prototype.has=function(e){return this._docs.indexOf(e)>=0},u.prototype._addDocToQueue=function(e){this._docs.push(e)},u.prototype._removeDocFromQueue=function(e){this._docs.splice(this._docs.indexOf(e),1)},u.prototype.isSaving=function(){return this._docs.length>0},u.prototype.save=async function(e){if(this.has(e))return Promise.resolve(null);this._addDocToQueue(e);const t=e.getEditor(),n=t&&t.markSavePoint();try{if(this._isDocAllowedToBeAutoSaved(e)){gDesigner.trigger(new o(o.Type.AutoSaveSynchronizing,e));const t=this._getAutoSaveHelper(e.getStorageItem().getFile());return function(t){const n=e.getStorageItem();n.setVersionId&&n.setVersionId(null);n.setFile(t)}(await t.updateFileSceneAndMetadata(e.getId(),e.getStorageItem().getFile(),e.getScene(),await this._createDocumentMetadata(e))),gDesigner.trigger(new o(o.Type.Modified,e)),gDesigner.trigger(new o(o.Type.AutoSaveSynchronized,e)),!0}return!1}catch(t){throw gDesigner.trigger(new o(o.Type.AutoSaveSynchronizationFailed,e)),n&&n.rollback(),t}finally{this._removeDocFromQueue(e)}},u.prototype._isDocAllowedToBeAutoSaved=function(e){return![i.Saving,i.Syncing].includes(e.getStatus())&&e.canSaveToCloud()},u.prototype._createDocumentMetadata=async function(e){const t=new c;return t.thumbnail=await d.fromBlob(await e.buildPreview()),t},u.prototype._getAutoSaveHelper=function(e){let t=null;const n=e.getStorage();return n===l.Storage.Gravit?t=new r(this._worker):n===l.Storage.GoogleDrive?t=new a(this._worker):n!==l.Storage.SharePoint&&n!==l.Storage.OneDriveBusiness||(t=new s(this._worker)),t},e.exports=u},function(e,t,n){"use strict";n(9);var i=n(1);const{FILE_FORMATS:o}=n(12),r=o.find(e=>e.default),{COMMAND_SAVE:a,COMMAND_SYNC_IMAGES:s}=n(532),l=n(1052);e.exports=class extends l{constructor(e){super(e)}async updateFileSceneAndMetadata(e,t,n,i){await this._syncSceneImages(e,n);const{sceneSnapshot:o,urls:r}=await this._saveScene(e,t,n);return console.log({documentId:e,file:t,sceneSnapshot:o,urls:r}),await this._saveThumbnail(i.thumbnail.getImageAsBlob(),r.url_t),gApi.getFile(e+"?edit")}_syncSceneImages(e,t){return new Promise(n=>{let o=t.getDictionary().getEntries(),r=[];o=o.map(e=>(e.hasOwnProperty("cachedCanvas")&&(e.cachedCanvas=null),e)),t.acceptChildren(e=>{e instanceof i.GImage&&r.push({name:e.getProperty("name"),url:e.getProperty("url")})});const a=Object.create(t),l=this._request(s.REQUEST,{id:e,images:r,entries:o,cloudURL:gApi.url});this._worker.addEventListener("message",function(e){const{cmd:t,id:o,data:r}=e.data;if(t!==s.SUCCESS||o!==l)return!1;let c=a.getDictionary();a.setCloudSynchronization(null);let d=new i.GDictionary;return d.deserialize(r),c.merge(d),n(),!0}.bind(this),{once:!0})})}_saveScene(e,t,n){return new Promise((o,s)=>{let l=i.GNode.serialize(n,{save:!0});const c=Object.create(n),d=this._request(a.REQUEST,{id:e,file:t,scene:l,type:r.type});this._worker.addEventListener("message",function(e){const{cmd:t,id:n,data:i}=e.data;if(t!==a.SUCCESS&&t!==a.FAILED||n!==d)return!1;t===a.SUCCESS?o({sceneSnapshot:c,urls:i.urls}):t===a.FAILED&&s();return!0}.bind(this),{once:!0})})}_saveThumbnail(e,t){const n=new XMLHttpRequest;n.open("PUT",t);const i={"Content-Type":"image/jpeg","Cache-Control":"public,max-age=31600000"};for(var o in i)n.setRequestHeader(o,i[o]);n.send(e)}}},function(e,t,n){"use strict";n(9);var i=n(1);const{FILE_FORMATS:o}=n(12),r=o.find(e=>e.default),{COMMAND_SAVE:a}=n(532),s=n(1052),l=n(502);e.exports=class extends s{constructor(e){super(e)}async updateFileSceneAndMetadata(e,t,n,i){const o=await this._requestWorkerToSave(e,t,n,i);return l.convertToCloudItem(o)}_requestWorkerToSave(e,t,n,o){return new Promise((s,l)=>{const c=this._request(a.REQUEST,{id:e,file:t,metadata:o,scene:i.GNode.serialize(n,{save:!0}),type:r.type});this._worker.addEventListener("message",function(e){const{cmd:t,id:n,data:i}=e.data;if(t!==a.SUCCESS&&t!==a.FAILED||n!==c)return!1;t===a.SUCCESS?s(i.file):t===a.FAILED&&l();return!0}.bind(this),{once:!0})})}}},function(e,t,n){"use strict";n(9);var i=n(1);const o=n(151),{FILE_FORMATS:r}=n(12),a=r.find(e=>e.default),{COMMAND_SAVE:s}=n(532),l=n(1052);e.exports=class extends l{constructor(e){super(e)}async updateFileSceneAndMetadata(e,t,n,i){const r=await this._requestWorkerToSave(e,t,n,i);return o.from(r)}_requestWorkerToSave(e,t,n,o){return new Promise((r,l)=>{const c=this._request(s.REQUEST,{id:e,file:t,metadata:o,scene:i.GNode.serialize(n,{save:!0}),type:a.type});this._worker.addEventListener("message",function(e){const{cmd:t,id:n,data:i}=e.data;if(t!==s.SUCCESS&&t!==s.FAILED||n!==c)return!1;t===s.SUCCESS?r(i.file):t===s.FAILED&&l();return!0}.bind(this),{once:!0})})}}},function(e,t,n){"use strict";function i(){this._queue=new Set}n(19),n(24),n(9),i.prototype._queue=null,i.prototype._isProcessing=!1,i.prototype._onNext=null,i.prototype.add=function(e){return this._queue.add(e),this},i.prototype.delete=function(e){return this._queue.delete(e),this},i.prototype.has=function(e){return this._queue.has(e)},i.prototype.onNext=async function(e){this._onNext=e},i.prototype.process=async function(){if(!this._isProcessing)return this._isProcessing=!0,await this._processQueue(),this._isProcessing=!1,this},i.prototype._processQueue=async function(){const e=this._queue.values().next().value;e&&(await this._onNext(e).catch(e=>{console.error("[GQueue] - It should never get here",e)}),this._queue.delete(e),await this._processQueue())},e.exports=i},function(e,t,n){"use strict";n(28),n(58),n(3);var i=n(43),o=n(1),r=n(16),a=n(402),s=n(510),l=n(108);const c=n(323),d=n(77),{SHOW_SIDEBAR_BADGE:u}=n(12);function p(){this._elements=[]}o.GObject.inherit(p,l),p.prototype._panel=null,p.prototype._toolbar=null,p.prototype._document=null,p.prototype._elements=null,p.prototype.init=function(e,t,n,i,r,a){this._panel=e,this._toolbar=t,this._addListPanel(e,n,i,r,a),t.append($("<label>").addClass("annotation-panel-label").text(o.GLocale.get(new o.GLocaleKey("GAnnotations","text.page"))))},p.prototype._addListPanel=function(e,t,n,i,s){var l=$("<div></div>").addClass("annotations-container").appendTo(e);this._annotationPanel||(this._annotationPanel=$("<div></div>").addClass("annotations").on("mouseenter",function(){var e=this._document.getScene();e&&e.acceptChildren((function(e){return e.hasFlag(o.GNode.Flag.Highlighted)&&e.removeFlag(o.GNode.Flag.Highlighted),!0})),this._annotationPanel.gAnnotationPanel("setBlockHighlight",!0)}.bind(this)).on("mouseleave",function(){this._annotationPanel.gAnnotationPanel("setBlockHighlight",!1)}.bind(this)).on("click",function(){this._document.getEditor().clearSelection();var e=this._document.getScene();e&&e.setActiveLayer(null),r.GPlatform.modifiers.optionKey&&gDesigner.executeAction(a.ID,void 0,"outlinesidebar")}.bind(this)).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation()}.bind(this)).appendTo(l),this._annotationPanel.gAnnotationPanel({clickCallback:this._clickTreeNodeCallback.bind(this),updateCommentCount:this._updateCommentCount.bind(this),showResolved:n,updateSidebar:i,updateAnnotationCache:s,sidebarActive:t}),window.refreshannot=()=>this._annotationPanel.gAnnotationPanel("refresh"),window.relayoutannot=()=>this._annotationPanel.gAnnotationPanel("relayout"))},p.prototype.relayout=function(e){this._annotationPanel&&this._annotationPanel.gAnnotationPanel("relayout",e)},p.prototype.isAddingAnnotation=function(){return this._annotationPanel.gAnnotationPanel("isEditingOrAddingContent")},p.prototype.toggleShowResolved=function(e){this._annotationPanel.gAnnotationPanel("showResolved",e)},p.prototype.setPage=function(e){this._annotationPanel.gAnnotationPanel("page",e),e&&this._setAnnotationLabel(e.getProperty("name"))},p.prototype._setAnnotationLabel=function(e){this._toolbar.find(".annotation-panel-label").text(e)},p.prototype._updateCommentCount=function(e,t){var n=this._toolbar.find(".g-badge");u&&e>0?(0===n.length&&(n=$("<span/>").addClass("g-badge comment-count"),this._toolbar.append(n)),t>0?n.addClass("unread"):n.removeClass("unread"),n.text(e)):n.remove()},p.prototype.getPage=function(){return this._annotationPanel.gAnnotationPanel("page")},p.prototype.setAnnotations=function(e){return this._annotationPanel.gAnnotationPanel("annotations",e)},p.prototype.setDelayedSyncCallback=function(e){this._annotationPanel.gAnnotationPanel("setDelayedSyncCallback",e)},p.prototype._clickTreeNodeCallback=function(e){if(e instanceof o.GComment&&(e=e.getParent()),e&&!e.hasFlag(o.GNode.Flag.Selected)){this._document.getScene().updateActivePageForElem(e),this._document.getScene().updateActiveLayerForElem(e);var t=this._document.getEditor(),n=!1;if(jQuery(gDesigner.getWindows().getActiveWindow().getView().getHtmlElement()).find("> div[tabindex=0]").focus(),r.GPlatform.modifiers.metaKey||!e.hasFlag(o.GNode.Flag.Selected)&&!e.hasFlag(o.GElement.Flag.FullLocked)&&!r.GPlatform.modifiers.shiftKey){let i=[e];if(e.hasMixin(o.GAnnotation.Linkable)){let t=e.getAnnotableReferences();t&&(t=t.filter(e=>!e.hasFlag(o.GNode.Flag.Selected)),t.length&&(i=i.concat(t),this._document.getScene().updateActivePageForElem(t[0])))}t.updateSelection(r.GPlatform.modifiers.metaKey,i),n=!0}if(n&&r.GPlatform.modifiers.optionKey)t.hasSelection()?gDesigner.executeAction(s.ID,void 0,"outlinesidebar"):gDesigner.executeAction(a.ID,void 0,"outlinesidebar");else if(n){let t;if(e.hasMixin(o.GAnnotation.Linkable)){const n=e.getAnnotableReferences();n&&n.length&&n.forEach(e=>{if(e instanceof o.GElement){const n=e.getPaintBBox();n&&!n.isEmpty()&&(t=t?t.united(n):n)}})}else e instanceof o.GElement&&(t=e.getPaintBBox());const n=this._document&&this._document.getActiveWindow();n&&n.scrollIntoView(t)}}},p.prototype._selectionChangedEvent=function(){const e=this._document&&this._document.getEditor(),t=e&&e.getSelection();if(t&&t.length){t.filter(e=>e.hasMixin(o.GAnnotable)).forEach(e=>{const t=e.getLinkedAnnotations();t&&t.forEach(e=>{e.hasFlag(o.GNode.Flag.Selected)||e.setFlag(o.GNode.Flag.Selected)})})}},p.prototype._isSyncTransactionEvent=function(e){return!(!(e.data&&e.data.nodes&&e.data.parent)||e.data.type!==i.GAnnotationEditor.TransactionType.RemoveAnnotation&&e.data.type!==i.GAnnotationEditor.TransactionType.AddAnnotation)},p.prototype._handleModifiedEvent=function(e){if(this._isSyncTransactionEvent(e)){const n=e.data.evtType===i.GEditor.ModifiedEvent.Type.Undo,o=e.data.evtType===i.GEditor.ModifiedEvent.Type.Redo,r=e.data.type===i.GAnnotationEditor.TransactionType.RemoveAnnotation,a=e.data.type===i.GAnnotationEditor.TransactionType.AddAnnotation,s=!!this._document.getAnnotationsId(),l=n&&r||n&&a||o&&a,d=o&&r;let u;if(s&&l)u=c.filterAnnotationElements(e.data.nodes),u.length&&u.forEach(t=>{c.removeSidFromAnnotations(t),t.getParent()||e.data.parent.insertChild(t)});else if(s&&d){var t=e.data.parent.getChildren();u=c.filterAnnotationElements(e.data.nodes).filter(e=>t.some(t=>t.getId()===e.getId())),u.length&&c.removeAnnotations(u,e.data.parent,void 0,!1)}}},p.prototype.update=function(e,t,n){if(n&&this._annotationPanel.gAnnotationPanel("cleanEmptyAnnotations"),this._document&&(this._document.getScene().removeEventListener(o.GElement.GeometryChangeEvent,this._geometryChange,this),this._document.getScene().removeEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getEditor().removeEventListener(i.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),this._document.getEditor().removeEventListener(i.GEditor.ModifiedEvent,this._handleModifiedEvent,this),this._document.getEditor().removeEventListener(i.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._document=null),this._elements=[],e){for(var r=0;r<t.length;++r)this._elements.push(t[r]);if(this._elements.length===t.length){if(this._document=e,this._elements.length)return this._document.getScene().addEventListener(o.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(o.GElement.GeometryChangeEvent,this._geometryChange,this),this._document.getEditor().addEventListener(i.GEditor.EdGeometryChangeEvent,this._edGeometryChange,this),this._document.getEditor().addEventListener(i.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._document.getEditor().addEventListener(i.GEditor.ModifiedEvent,this._handleModifiedEvent,this),this._updateDimensions(),this._updateToolbar(),this._document.getStatus()!==d.Ready&&this._document.getStatus()!==d.Loaded||!this._document.getActiveWindow()||this._document.getActiveWindow().getView().invalidate(null,!0),!0;this._document.getEditor().addEventListener(i.GEditor.ModifiedEvent,this._handleModifiedEvent,this)}}else this.setPage(null);return!1},p.prototype._afterPropertiesChange=function(e){e.node===this.getPage()&&e.properties.includes("name")&&this._setAnnotationLabel(e.node.getProperty("name"))},p.prototype._geometryChange=function(e){e.type!==o.GElement.GeometryChangeEvent.Type.After&&e.type!==o.GElement.GeometryChangeEvent.Type.Child||this._elements.indexOf(e.element)>=0&&this._updateDimensions()},p.prototype._edGeometryChange=function(){this._updateDimensions(!1,!0)},p.prototype._updateDimensions=function(){},p.prototype._updateToolbar=function(){this._toolbar.find("[data-action]").each(function(e,t){var n=$(t);n.prop("disabled",!gDesigner.canExecuteAction(n.attr("data-action")))}.bind(this))},p.prototype.toString=function(){return"[Object GAnnotations]"},e.exports=p},function(e,t,n){"use strict";var i=n(17);n(19),n(24),n(58),n(9),n(28),n(3);var o=n(43),r=n(1),a=i(n(323)),s=n(108);const l=n(352),c=n(351),d=n(1053),u=n(118);function p(e,t,n,i,o,r,a,s){this._elements=[],this._availableProperties=e||[],this._propertyClass=t,this._propertyTool=n,this._toolbarIcon=i,this._toolbarTooltip=o,this._tooltips=r,this._pendingUpdates=new Map,this._statType=a,this._panelClass=s}r.GObject.inherit(p,s),p.PropertySet={BorderHeadMarker:"_bhm",BorderTailMarker:"_btm",FillLayer:"_ptf",BorderLayer:"_ptb",BorderWidth:"_bw"},p.PropertyTarget={FillLayer:p.PropertySet.FillLayer,BorderLayer:p.PropertySet.BorderLayer,Element:null},p.prototype._panel=null,p.prototype._pendingUpdates=null,p.prototype._document=null,p.prototype._elements=null,p.prototype._availableProperties=null,p.prototype._propertyClass=null,p.prototype._propertyTool=null,p.prototype._toolbarIcon=null,p.prototype._toolbarTooltip=null,p.prototype._tooltips=null,p.prototype._isEditing=!1,p.prototype.init=function(e,t){this._panel=e,this._panel.addClass(this._panelClass);var n=function(e){var t=this;if(e===p.PropertySet.BorderLayer||e===p.PropertySet.FillLayer){let n,i=()=>e===p.PropertySet.FillLayer?t._statType+"/FillColor":e===p.PropertySet.BorderLayer?t._statType+"/OutlineColor":void 0,o=$("<div></div>").attr("data-property",e).toggleClass("g-disabled",!this._getAppManager().isCommentingEditingEnabled()).gPatternChooser({types:[r.GColor],singleOption:!0,onOpen:function(){gDesigner.stats("annotations_open_patternchooser",i())},onClickEyedropper:function(){gDesigner.stats("annotations_click_eyedropper",i())}}).on("chooseropen",(function(){try{t._document.getEditor().hideSelection(),t._chooserElem=$(this)}finally{t.setIsEditing(!0)}})).on("chooserclose",(function(e,n,i){try{gDesigner.getWorkspace().getStyleEdManager().getOverlayLock(i)?n():(t._styleEdOn=!1,gDesigner.getWorkspace().getStyleEdManager().deactivateEditor(),t._document&&t._document.getEditor().resetHideSelection()),t._chooserElem=null}finally{t.setIsEditing(!1)}})).on("patternchange",(function(n,i,o,a,s,l){if(t._getAppManager().isCommentingEditingEnabled()){var c=["_vs"],d=[!0];void 0!==i&&(c.push("_pt"),d.push(i)),"number"==typeof o&&(c.push("_op"),d.push(o));var u=null;s&&(u={chooserOn:!0},null!=l&&(u.activeStopIdx=l)),t._assignProperties(c,d,r.GLocale.get(new r.GLocaleKey("GAnnotationProperties","text.change-annotation-style")),a,e,u)}})).prepend(this._availableProperties.includes(p.PropertySet.BorderLayer)&&this._availableProperties.includes(p.PropertySet.FillLayer)?$("<span>").addClass("gravit-icon").addClass("patternchooser-icon").addClass(e===p.PropertySet.BorderLayer?"gravit-icon-pen":"gravit-icon-annotation-fill"):null);return o.find("span.preview.g-button").attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationProperties",this._tooltips[e]))),o.find("div.eyedropper").attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationProperties",this._tooltips[e+"dropper"]))),n=e===p.PropertySet.BorderLayer?new r.GLocaleKey("GStylable","layer.border"):new r.GLocaleKey("GStylable","layer.fill"),o.append($("<span/>").addClass("layer-title").text(r.GLocale.get(n))),o}if(e===p.PropertySet.BorderWidth){var n=(n,i)=>{if(this._getAppManager().isCommentingEditingEnabled()){gDesigner.stats("annotations_line-width",this._statType);var o=$(n).gUnitBox("value"),a=o?o.toUnit(r.GLength.Unit.PX):null;if(null!==a&&a>=0){const n=["_vs",e],o=[!0,a],r=void 0,s=p.PropertyTarget.BorderLayer;i?this._recordPendingUpdateForSelection(e,n,o,r,s):this._cleanPendingUpdateForSelection(e),t._assignProperties(n,o,r,i,s)}else t._updateProperties()}};return $("<input>").attr("data-property",e).attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationProperties",this._tooltips[e]))).toggleClass("g-disabled",!this._getAppManager().isCommentingEditingEnabled()).prop("disabled",!this._getAppManager().isCommentingEditingEnabled()).on("change",(function(){n(this,!0)})).blur((function(){n(this)})).gUnitBox({minValue:0,source:"border"})}if(e===p.PropertySet.BorderHeadMarker||e===p.PropertySet.BorderTailMarker){const n=n=>{if(!this._getAppManager().isCommentingEditingEnabled())return;const i=$(n.target).prop("checked"),o=e===p.PropertySet.BorderHeadMarker?"head":"tail";gDesigner.stats("annotations_border-marker_".concat(o),i?"on":"off"),t._assignProperty(e,i?r.GStylable.BorderMarker.Arrow:null,void 0,void 0,p.PropertyTarget.BorderLayer)},i=$("<input>").attr("data-property",e).addClass("custom-checkbox-mode").attr("type","checkbox").toggleClass("g-disabled",!this._getAppManager().isCommentingEditingEnabled()).prop("disabled",!this._getAppManager().isCommentingEditingEnabled()).on("change",n);return gDesigner.isTouchEnabled()&&i.gCheckboxSlider(),$("<label>").append(i).append($("<span>").text(e===p.PropertySet.BorderTailMarker?r.GLocale.get(new r.GLocaleKey("GAnnotationProperties","text.end-arrow")):r.GLocale.get(new r.GLocaleKey("GAnnotationProperties","text.start-arrow"))))}throw new Error("Unknown input property: "+e)}.bind(this),i=[];this._availableProperties.indexOf(p.PropertySet.BorderHeadMarker)>=0&&this._availableProperties.indexOf(p.PropertySet.BorderTailMarker)>=0&&(this._availableProperties.splice(this._availableProperties.indexOf(p.PropertySet.BorderHeadMarker),1),this._availableProperties.splice(this._availableProperties.indexOf(p.PropertySet.BorderTailMarker),1),this._availableProperties.push("arrows"));for(var a=0;a<this._availableProperties.length;a++){let e=this._availableProperties[a];i.push({clazz:this._availableProperties.includes(p.PropertySet.BorderLayer)&&this._availableProperties.includes(p.PropertySet.FillLayer)?"larger":"arrows"===e?"auto-grow":"medium",content:"arrows"===e?$("<div>").append(n(p.PropertySet.BorderHeadMarker)).append(n(p.PropertySet.BorderTailMarker)).addClass("arrows"):n(e)})}$("<div></div>").gPropertyRow({columns:i}).appendTo(this._panel),this._availableProperties.indexOf(p.PropertySet.FillLayer)>=0&&this._availableProperties.indexOf(p.PropertySet.BorderLayer)>=0&&this._panel.find('[data-property="'.concat(p.PropertySet.FillLayer,'"]')).closest(".column").css("margin-right","40px"),this._availableProperties.indexOf(p.PropertySet.BorderWidth)>=0&&this._panel.find('[data-property="'.concat(p.PropertySet.BorderWidth,'"]')).closest(".column").css("margin-right","10px"),this._toolbarButton=$("<button>").attr("class","toolbar-button icon "+this._toolbarIcon).toggleClass("g-disabled",!this._getAppManager().isCommentingEditingEnabled()).attr("data-title",r.GLocale.get(new r.GLocaleKey("GAnnotationProperties",this._toolbarTooltip))).on("click",()=>{if(gDesigner.stats("annotations_click_toolbar-btn",this._statType),this._getAppManager().isCommentingEditingEnabled()){var e=gDesigner.getToolManager().getTool(this._propertyTool);e===gDesigner.getToolManager().getActiveTool()?gDesigner.getToolManager().activateTool(o.GPointerTool,null,!0):gDesigner.getToolManager().activateTool(e,null,!0)}}).data("toolClass",this._propertyTool).prependTo(t)},p.prototype._settingChanged=function(e){"touch"===e.key&&this._updateTouchComponents()},p.prototype._updateTouchComponents=function(e){const t=this._panel.find(".custom-checkbox-mode");gDesigner.isTouchEnabled()?t.gCheckboxSlider():t.gCheckboxSlider("unmount")},p.prototype.update=function(e,t,n){if(this._document&&(this._applyPendingUpdateForSelection(),gDesigner.removeEventListener(c,this._stateChangedEvent,this),gDesigner.getFileReviewManager().removeEventListener(d.UpdateEvent,this._handleReviewUpdate,this),gDesigner.removeEventListener(u,this._settingChanged,this),this._document.getScene()&&this._document.getScene().removeEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.removeEventListener(l,this._collaborationEvent,this),this._document=null),this._elements=[],e&&t&&e.getScene()){if(gDesigner.addEventListener(c,this._stateChangedEvent,this),gDesigner.getFileReviewManager().addEventListener(d.UpdateEvent,this._handleReviewUpdate,this),gDesigner.addEventListener(u,this._settingChanged,this),t)for(var i=0;i<t.length;++i){var o=t[i];(o instanceof r.GStyle&&n&&n instanceof this._propertyTool||o instanceof this._propertyClass&&o.hasMixin(r.GAnnotation))&&this._elements.push(o)}if(this._elements.length)return this._document=e,this._document.getScene().addEventListener(r.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.addEventListener(l,this._collaborationEvent,this),this._updateProperties(),this._updateTouchComponents(),!0}return!1},p.prototype._collaborationEvent=async function(e){switch(e.type){case l.Type.ReviewStatusChanged:this._updateToolbar(),this._elements.length&&this._updateProperties()}},p.prototype._handleReviewUpdate=async function(e){this._updateToolbar(),this._elements.length&&this._updateProperties()},p.prototype._stateChangedEvent=async function(e){this._updateToolbar(),this._document&&e.document===this._document&&this._updateProperties()},p.prototype._getAppManager=function(){return this._appManager||(this._appManager=gDesigner.getApplicationManager()),this._appManager},p.prototype._updateToolbar=function(){this._toolbarButton.toggleClass("g-disabled",!this._getAppManager().isCommentingEditingEnabled())},p.prototype._afterPropertiesChange=function(e){!e.temporary&&e.node===this._elements[0]&&this._availableProperties.some(t=>e.properties.indexOf(t)>=0)&&this._updateProperties()},p.prototype._recordPendingUpdateForSelection=function(e,t,n,i,o){this._pendingUpdates.set(e,{props:t,values:n,title:i,target:o})},p.prototype._cleanPendingUpdateForSelection=function(e){this._pendingUpdates.delete(e)},p.prototype._applyPendingUpdateForSelection=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;function t(e){const t=this._pendingUpdates.get(e);t&&this._assignProperties(t.props,t.values,t.title,!1,t.target)}e?t.call(this,e):this._pendingUpdates.forEach((e,n)=>{t.call(this,n),this._cleanPendingUpdateForSelection(n)})},p.prototype._updateProperties=function(){if(!this._elements||!this._elements.length)return void console.warn("GAnnotationProperties: empty _elements array");if(!this._document.getScene())return void console.warn("Scene is null");var e=this._elements[0];o.GElementEditor.getEditor(e);const t=!e.hasMixin(r.GAnnotation)||a.default.isOwner(gDesigner.getSyncUser(),e),n=this._getAppManager().isCommentingEditingEnabled();if(this._availableProperties.indexOf(p.PropertySet.FillLayer)>=0){var i=e.getPaintLayers().getFillLayers()[0];this._panel.find('[data-property="'.concat(p.PropertySet.FillLayer,'"]')).gPatternChooser("setPattern",i?i.getProperty("_pt",!1,!1,!0):null).gPatternChooser("value",i?i.getProperty("_pt",!1,!1,!0):null).gPatternChooser("opacity",i?i.getProperty("_op",!1,!1,!0):null),t&&n?this._panel.find('[data-property="'.concat(p.PropertySet.FillLayer,'"]')).removeClass("g-disabled"):this._panel.find('[data-property="'.concat(p.PropertySet.FillLayer,'"]')).addClass("g-disabled")}if(this._availableProperties.indexOf(p.PropertySet.BorderLayer)>=0){i=e.getPaintLayers().getBorderLayers()[0];this._panel.find('[data-property="'.concat(p.PropertySet.BorderLayer,'"]')).gPatternChooser("setPattern",i?i.getProperty("_pt",!1,!1,!0):null).gPatternChooser("value",i?i.getProperty("_pt",!1,!1,!0):null).gPatternChooser("opacity",i?i.getProperty("_op",!1,!1,!0):null),t&&n?this._panel.find('[data-property="'.concat(p.PropertySet.BorderLayer,'"]')).removeClass("g-disabled"):this._panel.find('[data-property="'.concat(p.PropertySet.BorderLayer,'"]')).addClass("g-disabled")}if(this._availableProperties.indexOf(p.PropertySet.BorderWidth)>=0){var s=(i=e.getPaintLayers().getBorderLayers()[0]).getProperty(p.PropertySet.BorderWidth).toString(),l=this._panel.find('[data-property="'.concat(p.PropertySet.BorderWidth,'"]'));l.gUnitBox({unit:this._document.getScene().$ut===r.GLength.Unit.PX?r.GLength.Unit.PX:r.GLength.Unit.PT,minValue:0}).gUnitBox("value",null!==s?new r.GLength.parseLength(s,r.GLength.Unit.PT):null),t&&n?l.removeClass("g-disabled").attr("disabled",!1):l.addClass("g-disabled").attr("disabled",!0)}[p.PropertySet.BorderHeadMarker,p.PropertySet.BorderTailMarker].filter(e=>this._availableProperties.indexOf(e)>=0||this._availableProperties.includes("arrows")).forEach(i=>{var o=e.getPaintLayers().getBorderLayers()[0].getProperty(i),r=this._panel.find('[data-property="'+i+'"]');r.prop("checked",!!o),t&&n?(r.removeClass("g-disabled"),r.attr("disabled",!1)):(r.addClass("g-disabled"),r.attr("disabled",!0))})},p.prototype._assignProperty=function(e,t,n,i,o,r){this._assignProperties([e],[t],n,i,o,r)},p.prototype._assignProperties=function(e,t,n,i,o,a){if(this._document){var s=this._document.getEditor();i||s.beginTransaction();try{for(var l=null,c=0;c<this._elements.length;++c){var d;o===p.PropertyTarget.FillLayer?((d=this._elements[c].getPaintLayers().getFillLayers()[0])||(d=new r.GStylable.FillPaintLayer,this._elements[c].getPaintLayers().appendChild(d)),l=$.extend({fillLayerIndex:d.getParent().getIndexOfChild(d)},l||a)):o===p.PropertyTarget.BorderLayer?((d=this._elements[c].getPaintLayers().getBorderLayers()[0])||(d=new r.GStylable.BorderPaintLayer,this._elements[c].getPaintLayers().appendChild(d)),l=$.extend({borderLayerIndex:d.getParent().getIndexOfChild(d)},l||a)):d=this._elements[c],d&&d.setProperties(e,t,!1,!1,i)}}finally{i||s.commitTransaction(n,l)}}else console.warn("GAnnotationProperties: empty _document property")},p.prototype.isEditing=function(){return this._isEditing},p.prototype.setIsEditing=function(e){this._isEditing=e},p.prototype.toString=function(){return"[Object GAnnotationProperties]"},e.exports=p},function(e,t,n){"use strict";var i=n(17);n(9),n(58);var o=i(n(1043));const{GLocale:r,GLocaleKey:a,GObject:s}=n(1),l=n(351),c=n(1053),d=n(108),u=n(78),p=n(400),{FileStatus:{IN_REVIEW:g,AWAITING_APPROVAL:h,APPROVED:f,REOPENED:m},GFileReviewActions:{ACTION_REQUEST_REVIEW:y,ACTION_REQUEST_APPROVAL:v,ACTION_REOPEN:_,ACTION_APPROVE:b},FileReviewStatusAvailable:w,ShareRoles:C,FILE_REVIEW_ENABLED:E}=n(12),S=n(1410);function G(){}s.inherit(G,d),G.prototype.init=function(e,t){this._container=e,this._fileStatusHistoryDialog=new S,this._init()},G.prototype.update=function(e,t,n){return e!==this._document&&e?(this._document=e,this._reviewManager&&this._reviewManager.removeEventListener(c.UpdateEvent,this._handleReviewUpdate,this),gDesigner.addEventListener(l,this._stateChangedEvent,this),this._reviewManager=gDesigner.getFileReviewManager(),this._reviewManager.addEventListener(c.UpdateEvent,this._handleReviewUpdate,this),this._requestUIUpdate()):e||(gDesigner.removeEventListener(l,this._stateChangedEvent,this),this._reviewManager&&(this._reviewManager.removeEventListener(c.UpdateEvent,this._handleReviewUpdate,this),this._reviewManager=null)),this._document=e,!!this._document},G.prototype.isAvailable=function(){return!!E},G.prototype._init=function(){E&&(this._updatingStatus=!1,this._container.addClass("g-annotation-review-docker"),this._buildMainPanel($("<div/>").addClass("panel").addClass("main-panel").hide()),this._document&&this._requestUIUpdate())},G.prototype._getDAOStatus=async function(e){const t=this._getAppManager();var n;switch(e){case g:return n=await t.hasAccess(y,!0),{status:e,getLabel:()=>r.get(new a("GReviewDockerProperties","text.review-title")),getDescription:()=>r.get(new a("GReviewDockerProperties","text.review-description")),getIcon:()=>null,getIconLabel:()=>null,isAvailable:async()=>n&&!!this._reviewManager&&this._reviewManager.canUpdateToStatus(g)};case m:return n=await t.hasAccess(_,!0),{status:e,getLabel:()=>r.get(new a("GReviewDockerProperties",n?"text.reopen-title":"text.reopened-title")),getDescription:()=>r.get(new a("GReviewDockerProperties","text.reopen-description")),getIcon:()=>null,getIconLabel:()=>null,isAvailable:async()=>n&&!!this._reviewManager&&this._reviewManager.canUpdateToStatus(m)};case h:const o=t.hasRole(C.Owner),s=await this._reviewManager.hasApprovers();return n=await t.hasAccess(v,!0),{status:e,getLabel:()=>r.get(new a("GReviewDockerProperties",n?"text.request-approval-title":"text.requested-approval-title")),getDescription:()=>r.get(new a("GReviewDockerProperties","text.request-approval-description")),getIcon:()=>o&&!s?"info":null,getIconLabel:()=>o&&!s?r.get(new a("GReviewDockerProperties","text.request-approval-tooltip")):null,isAvailable:async()=>{const e=!!this._reviewManager&&this._reviewManager.canUpdateToStatus(h);return s&&n&&e}};case f:n=await t.hasAccess(b,!0);var i=this._getStatus();return{status:e,getLabel:()=>r.get(new a("GReviewDockerProperties",n&&e!==i?"text.approve-title":"text.approved-title")),getDescription:()=>r.get(new a("GReviewDockerProperties","text.approved-description")),getIcon:()=>null,getIconLabel:()=>null,isAvailable:async()=>n&&!!this._reviewManager&&this._reviewManager.canUpdateToStatus(f)}}},G.prototype._stateChangedEvent=function(){this._requestUIUpdate()},G.prototype._handleReviewUpdate=function(){this._requestUIUpdate()},G.prototype._buildMainPanel=function(e){this._mainPanel=e;let t=$("<div/>").addClass("row").addClass("header").appendTo(this._mainPanel);$("<div/>").text(r.get(new a("GReviewDockerProperties","text.current-status"))).addClass("status").click(()=>{this._opened=!1,this._container.gDialog("close")}).appendTo(t),$("<div/>").text(r.get(new a("GReviewDockerProperties","text.status-history"))).addClass("history-actions").hide().click(()=>{gDesigner.stats("reviewdocker_open_status-history"),this._fileStatusHistoryDialog.open()}).appendTo(t),this._statusSelectorContainer=$("<div/>").addClass("row").addClass("status-selector").appendTo(this._mainPanel);let n=$("<div/>").addClass("row").addClass("footer").hide().appendTo(this._mainPanel);$("<div/>").addClass("footer-title").text(r.get(new a("GReviewDockerProperties","text.please-share-to-start"))).appendTo(n),$("<div/>").addClass("footer-action").text(r.get(new a("GReviewDockerProperties","text.share-design-now"))).addClass("footer-action").click(()=>this._requestShare()).appendTo(n),this._mainPanel.appendTo(this._container)},G.prototype._requestShare=function(){const e=gDesigner.getShareManager();e.isShareProRestricted()?gDesigner.stats("reviewdocker_nonprotriespro_share"):gDesigner.stats("reviewdocker_share"),this._document.getStorageItem()?e.share():((new o.default).listen(u).when(e=>!!(e&&e.type&&e.document&&!e.document.isLockedByVersionHistory()&&e.type===u.Type.StorageItemUpdated&&e.document.getId())&&(this._document===e.document||this._document.getStorageItem()&&this._document.getId()===e.document.getId())).do(()=>e.share()),gDesigner.executeAction(p.ID))},G.prototype._requestUIUpdate=async function(){this.isAvailable()&&(this._updatingUI?this._requestedDuringUIUpdate=!0:(this._updatingUI=!0,await this._updateUI(),this._updatingUI=!1,this._requestedDuringUIUpdate&&(this._requestedDuringUIUpdate=!1,await this._updateUI())))},G.prototype._getAppManager=function(){return this._appManager||(this._appManager=gDesigner.getApplicationManager()),this._appManager},G.prototype._updateFooter=function(){var e=this._mainPanel.find(".footer"),t=this._mainPanel.find(".history-actions");const n=!(!this._document||!this._document.getStorageItem());e.find(".footer-title").text(r.get(new a("GReviewDockerProperties",n?"text.please-share-to-start":"text-please-save-share-to-start"))),e.find(".footer-action").text(r.get(new a("GReviewDockerProperties",n?"text.share-design-now":"text.save-share-design-now"))),this._isDocumentSane()?(e.hide(),t.show()):(e.show(),t.hide())},G.prototype._updateUI=async function(){w.includes(this._getStatus())&&(this._statusSelectorContainer.empty(),this._mainPanel&&this._mainPanel.hide(),this._document&&(this._mainPanel&&this._mainPanel.show(),await this._createStatusList(this._statusSelectorContainer),this._updateFooter(),this._mainPanel.show()))},G.prototype._getStatus=function(){return this._reviewManager&&this._reviewManager.getStatus()||g},G.prototype._isDocumentSane=function(){return!!this._document&&(this._getAppManager().isSharing()&&this._document.isCollaborative())},G.prototype._createStatusList=async function(e){var t=this._getStatus(),n=this._isStatusChangeAllowed();$("<div/>").addClass("dropdown-icon").appendTo(e),this._selectedItemContainer=$("<div/>").addClass("selected-item-container").toggleClass("disabled",!this._isDocumentSane()||!n).appendTo(e),this._currentSelectedStatusElement=await this._makeItemForDAO(await this._getDAOStatus(t),{selected:!0,canHover:!1,disabled:!this._isDocumentSane()}),this._currentSelectedStatusElement.appendTo(this._selectedItemContainer),this._statusListOverlay=$("<div/>").gOverlay({padding:!1,clazz:"g-file-status-selector-overlay",offsetY:-66,releaseOnClose:!1}),this._statusSelector=$("<div/>").addClass("g-file-status-selector").appendTo(this._statusListOverlay);const i=async e=>{var n=await this._makeItemForDAO(e,{selected:e.status===t,canHover:!0});n.appendTo(this._statusSelector);await e.isAvailable()?n.on("click",async()=>{if(gDesigner.stats("reviewdocker_design",(e=>{switch(e){case g:return"InReview";case h:return"RequestApproval";case f:return"Approved";case m:return"ReOpened"}})(e.status)),this._statusListOverlay.gOverlay("close"),this._getStatus()!==e.status){this._updatingStatus=!0;const t=await this._makeItemForDAO(e,{selected:!1,canHover:!1,loading:!0});this._currentSelectedStatusElement.replaceWith(t),this._currentSelectedStatusElement=t,this._reviewManager.updateReviewStatus(e.status).then(()=>this._updatingStatus=!1).catch(()=>this._updatingStatus=!1)}}):n.on("click",()=>this._statusListOverlay.gOverlay("close"))};if(this._isDocumentSane()&&n){this._selectedItemContainer.removeClass("disabled");for(let e=0;e<w.length;e++){var o=w[e],r=await this._getDAOStatus(o);await i(r)}e.on("click",async()=>{this._updatingStatus||this._statusListOverlay.gOverlay("open",this._selectedItemContainer)})}},G.prototype._makeItemForDAO=async function(e,t){let{selected:n=!1,canHover:i=!0,loading:o=!1,disabled:r=!1}=t;var a=$("<div/>").addClass("g-annotation-review-docker-status-item").data("status",e).attr("status-id",e.status).toggleClass("disabled",r||!n&&!await e.isAvailable()).toggleClass("can-hover",i).toggleClass("loading",o),s=$("<div/>").addClass("icon-container").toggleClass("loading",o).append($("<div/>").addClass("loading-indicator")).appendTo(a);if(!o){var l=e.getIcon();l?(s.addClass(l),e.getIconLabel()&&s.attr("data-title",e.getIconLabel())):s.toggleClass("selected",n)}var c=$("<div/>").addClass("details-container").appendTo(a);return $("<div/>").addClass("title").text(e.getLabel()).appendTo(c),$("<div/>").addClass("description").text(e.getDescription()).appendTo(c),a},G.prototype._isStatusChangeAllowed=function(){return!0},e.exports=G},function(e,t,n){"use strict";n(9),n(14),n(29);const{GLocale:i,GLocaleKey:o}=n(1),r=n(1054),{gApi:a,Notification:s,NotificationConstants:{ACTIONS:{ACTION_APPROVE:l,ACTION_REQUEST_APPROVE:c,ACTION_REOPEN:d,ACTION_IN_REVIEW:u}={}}}=n(12);function p(){this._container=null,this._opened=!1}p.prototype._updateHistoryList=async function(){const e=this._container.find(".list");e.empty(),e.addClass("loading");var t=await a.annotations.getDesignHistory(gDesigner.getActiveDocument().getId()).catch(e=>[]);e.append(t.map(e=>{const t=s.from(e);var n;switch(t.getAction()){case l:n=i.get(new o("GFileStatusHistoryDialog","text.action-approved"));break;case c:n=i.get(new o("GFileStatusHistoryDialog","text.action-request-approval"));break;case d:n=i.get(new o("GFileStatusHistoryDialog","text.action-reopened"));break;case u:n=i.get(new o("GFileStatusHistoryDialog","text.action-in-review"))}if(n){var a=$("<span></span>").addClass("annotation-title-group"),p=$("<span></span>").html(n.replace("%name",t.uname)).addClass("annotation-title").appendTo(a),g=i.toLocaleDate(t.created,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"});return $("<span>").text("·").addClass("dot").appendTo(a),$("<span></span>").text(g).addClass("annotation-date").appendTo(a),new r({id:t.uid,name:t.uname,last_name:t.last_name}).build().addClass("g-user-preview-history").insertBefore(p),a}})),e.removeClass("loading")},p.prototype.open=function(){if(this._opened)return;this._opened=!0,this._container&&this._container.remove(),this._container=$("<div/>").gDialog({className:"g-file-status-history-dialog"});let e=$("<div/>").addClass("row").addClass("header").appendTo(this._container);$("<div/>").addClass("title").text(i.get(new o("GFileStatusHistoryDialog","text.status-history"))).appendTo(e),$("<div></div>").addClass("btn-close").click(()=>{this._opened=!1,this._container.gDialog("close")}).append($("<span></span>").addClass("gravit-icon-close")).appendTo(e),$("<div/>").addClass("list").appendTo(this._container);this._container.gDialog("open",!1),this._updateHistoryList()},e.exports=p},function(e,t,n){"use strict";var i=n(1),o=n(353);function r(e){this._htmlElement=e,this._collapseIcon=$('<span class="collapse-icon"><span></span><span></span></span>')}r.CollapseMode={None:"none",Half:"half",Full:"full"},r.prototype._htmlElement=null,r.prototype._collapseIcon=null,r.prototype._panels=null,r.prototype._activePanel=null,r.prototype._collapseMode=null,r.prototype.getCollapseMode=function(){return this._collapseMode},r.prototype.setCollapseMode=function(e){e!==this._collapseMode&&(this._collapseMode&&this._htmlElement.removeClass("collapse-"+this._collapseMode),this._collapseMode=e,this._collapseMode&&this._htmlElement.addClass("collapse-"+this._collapseMode))},r.prototype.toggleCollapseMode=function(){switch(this._collapseMode){case r.CollapseMode.Full:this.setCollapseMode(r.CollapseMode.None);break;case r.CollapseMode.Half:this.setCollapseMode(r.CollapseMode.Full);break;case r.CollapseMode.None:this.setCollapseMode(r.CollapseMode.Half)}},r.prototype.getActivePanel=function(){return this._activePanel},r.prototype.setActivePanel=function(e){if(e===this._activePanel)this.toggleCollapseMode();else{for(var t=0;t<this._panels.length;++t){var n=this._panels[t],i=n.panel.getId();i===e?(n.container.css("display",""),n.tab.addClass("g-active"),n.panel.activate()):(n.container.css("display","none"),n.tab.removeClass("g-active"),i===this._activePanel&&n.panel.deactivate())}this._activePanel=e}},r.prototype.setPanelEnabled=function(e,t){var n=this._getPanelInfo(e);if(n)if(t)n.container.find(".g-disabled-overlay").remove(),n.container.removeClass("g-disabled");else{var i=n.container.find(".g-disabled-overlay");0===i.length&&(i=$("<div></div>").addClass("g-disabled-overlay").appendTo(n.container)),n.container.addClass("g-disabled")}},r.prototype.init=function(){this._panels=[];var e=$("<div></div>").addClass("panels-tabs").appendTo(this._htmlElement),t=$("<div></div>").addClass("panels-frame").appendTo(this._htmlElement),n=function(n){var r=$("<button></button>").addClass("panel-tab").attr("data-panel-id",n.getId()).text(i.GLocale.get(n.getTitle())).on("click",function(e){gDesigner.stats("panels_set_active"),this.setActivePanel($(e.target).closest("button").attr("data-panel-id"))}.bind(this)).on("mousedown",(function(e){e.preventDefault()})).prepend(this._collapseIcon.clone()).appendTo(e),a=$("<div></div>").addClass("panel-container panel-"+n.getId()).css("display","none").appendTo(t);n.init(a),a.find("button").each((function(e,t){t.on("mousedown",(function(e){e.preventDefault()}))})),this.setPanelEnabled(n.getId(),n.isEnabled()),this._panels.push({tab:r,container:a,panel:n}),n.addEventListener(o.UpdateEvent,function(){this.setPanelEnabled(n.getId(),n.isEnabled())}.bind(this))}.bind(this);if(gravit.panels)for(var a=0;a<gravit.panels.length;++a){var s=gravit.panels[a];n(s),this._activePanel||this.setActivePanel(s.getId())}this.setCollapseMode(r.CollapseMode.None)},r.prototype.relayout=function(){},r.prototype._getPanelInfo=function(e){for(var t=0;t<this._panels.length;++t){if(this._panels[t].panel.getId()===e)return this._panels[t]}},e.exports=r},function(e,t,n){"use strict";n(28);var i=n(354);i.prototype._rightSidebarDefaultWidthForTouch=300,i.prototype._updateTouchToolbar=function(e){const t=["fill","border","effect"];if(!gDesigner.isTouchEnabled())return;this._touchToolbar||(this._touchToolbar=$("<div/>").addClass("g-touch-toolbar").prependTo(this._htmlElement));let n=null;this._touchToolbar.empty(),this.removeClassName("align-active"),this._sidebars.forEach(i=>{let{sidebar:o,container:r}=i;const a=o.getTouchTools(e);o&&o.isVisible()&&a&&a.forEach(e=>{e.sidebar=o.getId();const i=!!this._activeTouchTool&&e.id==this._activeTouchTool.id;i&&(n=e);let a=e.panel;if(Array.isArray(e.panel)||(a=[e.panel]),"dimension.align"===e.id&&i&&this.addClassName("align-active"),a.forEach(t=>{let n;n="string"==typeof t?r.find(t):$(t),n.attr("g-touch-tool",e.id).toggleClass("g-active",i).addClass("g-touch-toolbar-panel")}),e.toolbar){let t=e.toolbar;Array.isArray(e.toolbar)||(t=[e.toolbar]),t.forEach(t=>{let n;n="string"==typeof t?r.find(t):$(t),n.attr("g-touch-tool",e.id).toggleClass("g-active",i).addClass("g-touch-toolbar-label")})}var s=$("<button/>").addClass("g-touch-toolbar-button").attr("g-touch-tool",e.id).attr("id",e.id).toggleClass("g-active",i).append($("<span/>").addClass(e.icon||"")).on("click",()=>{this.removeClassName("align-active"),"dimension.align"==e.id?($(".scrolling-panels").addClass("hide"),this.addClassName("align-active")):$(".scrolling-panels").removeClass("hide"),-1!=t.indexOf(e.id)?$(".sidebar-inspector").addClass("expand"):$(".sidebar-inspector").removeClass("expand"),this._activeTouchTool&&this._activeTouchTool.id==e.id?this._isActiveSidebarDeactivatable()&&(this.setActiveTouchTool(null),this._htmlElement.css("width",o.getDefaultWidth()+"px")):this._tryActivateSidebar(o)&&(this.setActiveTouchTool(e),e.panelWidth?this._htmlElement.css("width",e.panelWidth):this._htmlElement.css("width",o.getDefaultWidth()+"px"),".appearance-toolbar"!==e.toolbar?this._htmlElement.find(".appearance-properties-panel").addClass("display-none"):this._htmlElement.find(".appearance-properties-panel").removeClass("display-none"))}).appendTo(this._touchToolbar);if(-1!=t.indexOf(e.id)){var l=$(".".concat(e.id,"-block")).length;s.append($("<div/>").addClass("count").append($("<div/>").addClass("scale").text(l)))}})}),this.setActiveTouchTool(n),n||this._setDefaultRightSidebarWidthForTouch()},i.prototype.updateTouchToolbar=function(){this._updateTouchToolbar()},i.prototype._setDefaultRightSidebarWidthForTouch=function(){this._htmlElement.css("width",this._rightSidebarDefaultWidthForTouch+"px")}},function(module,exports,__webpack_require__){"use strict";__webpack_require__(19),__webpack_require__(24),__webpack_require__(83),__webpack_require__(28),__webpack_require__(537),__webpack_require__(14),__webpack_require__(63),__webpack_require__(132),__webpack_require__(3),__webpack_require__(45),__webpack_require__(25);var _editor=__webpack_require__(43),_core=__webpack_require__(1),_client=__webpack_require__(16),_config=__webpack_require__(12),_richtooltipconfig=__webpack_require__(56);const GCategory=__webpack_require__(18),GDocument=__webpack_require__(144),GDocumentStatus=__webpack_require__(77),simpleShapes=__webpack_require__(1414),GAnnotationsSidebar=__webpack_require__(511),GInspectorSidebar=__webpack_require__(773),GWindows=__webpack_require__(545),GArrangeAction=__webpack_require__(778),GClipAction=__webpack_require__(722),GConvertToPathAction=__webpack_require__(723),GCreateSymbolAction=__webpack_require__(550),GExportAction=__webpack_require__(770),GFitAllAction=__webpack_require__(402),GGravitCloudAction=__webpack_require__(401),GGroupAction=__webpack_require__(724),GLinkImageAction=__webpack_require__(1164),GMagnificationAction=__webpack_require__(1055),GMergeAction=__webpack_require__(779),GOpenAction=__webpack_require__(725),GOriginalViewAction=__webpack_require__(1165),GPlaceImportAction=__webpack_require__(1166),GRedoAction=__webpack_require__(1167),GSaveAction=__webpack_require__(400),GSaveAsAction=__webpack_require__(398),GShowGridAction=__webpack_require__(1168),GShowGuideLinesAction=__webpack_require__(1056),GShowSymbolLabelsAction=__webpack_require__(1169),GSplitAction=__webpack_require__(780),GToggleGuideAction=__webpack_require__(1170),GToggleSidebarAction=__webpack_require__(1057),GToggleSnapAction=__webpack_require__(1171),GToggleSnapZonesAction=__webpack_require__(1172),GTransformAction=__webpack_require__(781),GUndoAction=__webpack_require__(1058),GVectorizeBorderAction=__webpack_require__(782),GZoomInAction=__webpack_require__(1173),GZoomOutAction=__webpack_require__(1174),GMenuOpenEvent=__webpack_require__(717),GMenu=__webpack_require__(217),GMenuItem=__webpack_require__(308),GCollaborators=__webpack_require__(1175),GDocumentEvent=__webpack_require__(78),GSettingChangedEvent=__webpack_require__(118),GApplicationStateChangedEvent=__webpack_require__(351),GShareEvent=__webpack_require__(777),GNetworkAvailabilityChangedEvent=__webpack_require__(263),GUIIcons=__webpack_require__(232);function GToolbar(e){this._htmlElement=e,this._initShapeMenu=!1}_core.GObject.inherit(GToolbar,_core.GObject),GToolbar.getToolName=function(e){if(e&&gravit)for(var t of gravit.tools)if(t.tool===e||e instanceof t.tool){var n=t.title;if(_core.GLocale.getLanguage()!==_core.GLocaleLanguage.English)try{n=_core.GLocale.get(new _core.GLocaleKey(t.toolString,"name"),void 0,_core.GLocaleLanguage.English)}catch(e){n="[errored]"}return n}return""},GToolbar.getToolTooltipConfig=function(e){return gravit&&gravit.tools&&gravit.tools.length?gravit.tools.filter(t=>{let{toolString:n}=t;return n===e})[0].richTooltipConfig:null},GToolbar.prototype._htmlElement=null,GToolbar.prototype._zoomButton=null,GToolbar.prototype._pageButton=null,GToolbar.prototype._selectSection=null,GToolbar.prototype._commentToggleSection=null,GToolbar.prototype._currentZoomLevel=-1,GToolbar.prototype._symbolsButton=null,GToolbar.prototype._initShapeMenu=!1,GToolbar.prototype._toolsDiv=null,GToolbar.prototype._exportButton=null,GToolbar.prototype._shareButton=null,GToolbar.prototype._viewMenu=null,GToolbar.prototype._collaboratorsDiv=null,GToolbar.prototype.init=function(){$("<div></div>").addClass("section compound-section file-section").append(this._createLabelButton({action:gDesigner.getAction(GSaveAction.ID)})).append(this._createLabelButton({action:gDesigner.getAction(GUndoAction.ID),icon:"gravit-icon-undo",split:!0,menu:()=>this._createQuickHistoryUndoRedoMenu(),click:()=>gDesigner.executeAction(GUndoAction.ID)})).append(this._createLabelButton({action:gDesigner.getAction(GRedoAction.ID)})).appendTo(this._htmlElement),this._initZoomButton(),this._viewMenu=new GMenu,$("<div></div>").addClass("section compound-section view-section").append(this._zoomButton).append(this._createLabelButton({icon:GUIIcons["gravit-icon-expand"],label:_core.GLocale.get(new _core.GLocaleKey("GFitAllAction","title")),click:function(){gDesigner.executeAction(GFitAllAction.ID,void 0,"toolbar")},tooltipConfig:GFitAllAction.TOOLTIP_CONFIG[_richtooltipconfig.TOOLTIP_AREA.TOOLBAR]})).append(this._createLabelButton({icon:"gravit-icon-move",label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.view")),menu:this._createToolItems("view",this._viewMenu),getActiveItem:()=>{const e=gDesigner.getToolManager(),t=e&&e.getActiveTool(),n=t&&GToolbar.getToolName(t);return n&&this._viewMenu.findItem(n)},split:!0,click:function(e){this._activateOrResetTool($(e.target).closest(".toolbar-button").data("tool"))}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GHandTool")}).data("tool-group","view").data("tool",_editor.GHandTool)).append(this._createSnapButton()).appendTo(this._htmlElement),this._toolsDiv=$("<div></div>").addClass("section compound-section tool-section").append(this._createLabelButton({icon:"gravit-icon-cursor-filled",label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.select")),menu:this._createToolItems("select"),split:!0,click:function(e){gDesigner.stats("toolbar_click_menu","select");var t=$(e.target).closest(".toolbar-button").data("tool");this._activateOrResetTool(t)}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GPointerTool")}).addClass("select-toolbar-button").data("tool-group","select").data("tool",_editor.GPointerTool)).append(this._createLabelButton({icon:"gravit-icon-shapes",label:_core.GLocale.get(new _core.GLocaleKey("GShape","name")),menu:this._createToolItems("shape"),split:!0,click:function(e){gDesigner.stats("toolbar_click_menu","shape"),$(e.target).closest(".toolbar-button").data("tool")&&this._initShapeMenu?this._activateOrResetTool($(e.target).closest(".toolbar-button").data("tool")):$(e.target).closest(".toolbar-button").find("button.dropdown-button").trigger("mousedown")}.bind(this)}).addClass("shapes-toolbar-button").data("tool-group","shape").data("tool",_editor.GRectangleTool)).append(this._createLabelButton({icon:"gravit-icon-pen",label:_core.GLocale.get(new _core.GLocaleKey("GPath","name")),menu:this._createToolItems("path"),split:!0,click:function(e){gDesigner.stats("toolbar_click_menu","pen");var t=$(e.target).closest(".toolbar-button").data("tool");this._activateOrResetTool(t)}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GPenTool")}).addClass("path-toolbar-button").data("tool-group","path").data("tool",_editor.GPenTool)).append(this._createLabelButton({icon:"gravit-icon-scalpel",label:_core.GLocale.get(new _core.GLocaleKey("GKnifeTool","name")),menu:this._createToolItems("knife"),split:!0,click:function(e){gDesigner.stats("toolbar_click_menu","knife");var t=$(e.target).closest(".toolbar-button").data("tool");this._activateOrResetTool(t)}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GKnifeTool")}).addClass("knife-toolbar-button").data("tool-group","knife").data("tool",_editor.GKnifeTool)).append(this._createLabelButton({icon:"gravit-icon-textbox",label:_core.GLocale.get(new _core.GLocaleKey("GText","name")),click:function(e){gDesigner.stats("toolbar_click_menu","text"),this._activateOrResetTool($(e.target).closest(".toolbar-button").data("tool"))}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GTextTool")}).addClass("text-toolbar-button").data("tool",_editor.GTextTool)).append(this._createLabelButton({icon:"gravit-icon-upload-image-icon",label:_core.GLocale.get(new _core.GLocaleKey("GPlaceImportAction","tooltip-title")),menu:this._createImageMenu(),split:!0,click:()=>gDesigner.executeAction(GPlaceImportAction.ID,void 0,"toolbar"),tooltipConfig:GPlaceImportAction.TOOLTIP_CONFIG[_richtooltipconfig.TOOLTIP_AREA.TOOLBAR]}).addClass("image-toolbar-button")).appendTo(this._htmlElement),void 0!==typeof localStorage&&localStorage.getItem("enable_mods")&&(this._toolsDiv.append(this._createLabelButton({icon:"gravit-icon-plus",label:"Add custom button",click:()=>{let e=$("<div/>").append($("<div/>").text("Add custom button code")).append(this._textEdit($('<textarea rows="30" cols="100" wrap="off" class="custom_button_code">').text("function (shapes, scene, selEditor, core, editor, client) {\n\t// your code here\n\t\n}"))).append($("<div/>").append("<label>Name:</label>").append($('<input type="text" class="custom_button_name" value="New custom action">')));e.gDialog({releaseOnClose:!0,className:"context-pane",buttons:[$('<button class="settings-button">Cancel</button>').on("click",()=>{e.gDialog("close")}),$('<button class="settings-button">Save</button>').on("click",()=>{var t=JSON.parse(localStorage.getItem("designer.custom"))||[],n=_core.GUtil.uuid();t.push({name:$(".custom_button_name")[0].value,code:$(".custom_button_code")[0].value,id:n}),localStorage.setItem("designer.custom",JSON.stringify(t)),this._refreshCustomButtons(),e.gDialog("close")})]}),e.gDialog("open",!1),$(".custom_button_code").focus(),$(".custom_button_code")[0].selectionStart=$(".custom_button_code")[0].selectionEnd=$(".custom_button_code")[0].value.indexOf("code here")+11}})),this._refreshCustomButtons()),$("<div></div>").addClass("section compound-section transform-section").append(this._createLabelButton({action:gDesigner.getAction(GTransformAction.ID+"."+GTransformAction.Type.FlipHorizontal),icon:"gravit-icon-flip-horizontal"})).append(this._createLabelButton({action:gDesigner.getAction(GTransformAction.ID+"."+GTransformAction.Type.FlipVertical),icon:"gravit-icon-flip-vertical"})).append(this._createLabelButton({action:gDesigner.getAction(GTransformAction.ID+"."+GTransformAction.Type.Rotate90Left),icon:"gravit-icon-rotate-left"})).append(this._createLabelButton({action:gDesigner.getAction(GTransformAction.ID+"."+GTransformAction.Type.Rotate90Right),icon:"gravit-icon-rotate-right"})).appendTo(this._htmlElement),$("<div></div>").addClass("section compound-section group-section").append(this._createLabelButton({action:gDesigner.getAction(GGroupAction.ID),label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.group"))})).append(this._createLabelButton({action:gDesigner.getAction(GSplitAction.ID),label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.split"))})).append(this._createLabelButton({action:gDesigner.getAction(GMergeAction.ID),label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.merge")),menu:this._createMergeMenu(),split:!0})).append(this._createLabelButton({action:gDesigner.getAction(GClipAction.ID),label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.clip"))})).appendTo(this._htmlElement),$("<div></div>").addClass("section compound-section arrange-section").append(this._createLabelButton({action:gDesigner.getAction(GArrangeAction.ID+"."+_editor.GEditor.ArrangeOrderType.BringForward)})).append(this._createLabelButton({action:gDesigner.getAction(GArrangeAction.ID+"."+_editor.GEditor.ArrangeOrderType.SendBackward)})).appendTo(this._htmlElement),$("<div></div>").addClass("section compound-section action-section").append(this._createLabelButton({action:gDesigner.getAction(GCreateSymbolAction.ID)})).append(this._createLabelButton({action:gDesigner.getAction(GConvertToPathAction.ID)})).append(this._createLabelButton({action:gDesigner.getAction(GVectorizeBorderAction.ID)})).appendTo(this._htmlElement),this._exportButton=this._createLabelButton({action:gDesigner.getAction(GExportAction.ID),split:!0,menu:this._createExportMenu()}).addClass("export-toolbar-button"),this._exportButton.find(".dropdown-button").addClass("g-touch-only"),this._collaboratorsDiv=$("<div/>").gCollaborators(),this._shareButton=$("<button/>").gShareButton(),$("<div></div>").addClass("section compound-section export-section").append(this._exportButton).append($("<div/>").addClass("share-section").append(this._collaboratorsDiv).append(this._shareButton)).appendTo(this._htmlElement),this._updateActiveTool(gDesigner.getToolManager().getActiveTool()),this._updateContextTools(),this._updateZoomFromWindow(),this._updateShareSection(),this._updateActions(),gDesigner.getToolManager().addEventListener(_editor.GToolManager.ToolChangedEvent,this._toolChangedEvent,this),gDesigner.getWindows().addEventListener(GWindows.WindowEvent,this._windowEvent,this),gDesigner.addEventListener(GDocumentEvent,this._documentEvent,this),gDesigner.addEventListener(GSettingChangedEvent,this._settingChangedEvent,this),gDesigner.addEventListener(GNetworkAvailabilityChangedEvent,this._networkAvailabilityChangedEvent,this),gDesigner.addEventListener(GApplicationStateChangedEvent,this._applicationStateChangedEvent,this),gDesigner.addEventListener(GShareEvent,this._shareEvent,this)},GToolbar.prototype.setVisible=function(e){const t=this.isVisible();this._htmlElement.css("display",e?"":"none"),t!==e&&gDesigner.relayout()},GToolbar.prototype.isVisible=function(){this._htmlElement.is(":visible")},GToolbar.prototype._applicationStateChangedEvent=function(e){this._updateUI(),this._updateViewBasedOnPermissions()},GToolbar.prototype._updateViewBasedOnPermissions=function(){},GToolbar.prototype._shareEvent=function(e){e.type===GShareEvent.Type.Updated&&this._updateUI()},GToolbar.prototype._updateUI=function(){this._updateShareSection(),this._updateActions();const e=!gDesigner.getApplicationManager().isPagesInspectEnabled();if(this._htmlElement.toggleClass("g-simple-ui",e),e){this._pageButton||(this._pageButton=$("<div/>").addClass("page-button").addClass("toolbar-button").gPageButton().prependTo(this._htmlElement.find(".view-section")),this._updatePageButton());const e=gDesigner.getApplicationManager().isCommentingEnabled();this._selectSection?e||(this._selectSection.remove(),this._selectSection=null):e&&(this._selectSection=$("<div></div>").addClass("section compound-section select-section").append(this._createLabelButton({icon:"gravit-icon-cursor-filled",label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.select")),click:function(e){gDesigner.stats("toolbar_click_menu","select");var t=$(e.target).closest(".toolbar-button").data("tool");this._activateOrResetTool(t)}.bind(this),tooltipConfig:GToolbar.getToolTooltipConfig("GPointerTool")}).data("tool-group","select").data("tool",_editor.GPointerTool)).insertAfter(this._htmlElement.find(".view-section")),this._updateActiveTool(gDesigner.getToolManager().getTool(_editor.GPointerTool))),this._commentToggleSection?e||(this._commentToggleSection.remove(),this._commentToggleSection=null):e&&(this._commentToggleSection=$("<div></div>").addClass("section compound-section comment-toggle-section").append(this._createCommentToggleToolbarBtn()).insertAfter(this._htmlElement.find(".select-section"))),gDesigner.isTouchEnabled()&&this._updateTouchSimpleUI()}else this._selectSection&&(this._selectSection.remove(),this._selectSection=null),this._pageButton&&(this._pageButton.gPageButton("release"),this._pageButton=null),this._commentToggleSection&&(this._commentToggleSection.remove(),this._commentToggleSection=null)},GToolbar.prototype._networkAvailabilityChangedEvent=function(e){this._collaboratorsDiv.gCollaborators(e.connected?GCollaborators.Mode.Online:GCollaborators.Mode.Offline),e.connected?this._updateShareSection():gDesigner.getApplicationManager().isSharing()&&this._collaboratorsDiv.css("display","")},GToolbar.prototype._updatePageButton=function(){if(this._pageButton){const e=gDesigner.getActiveDocument(),t=e&&e.getScene();this._pageButton.gPageButton("scene",t),this._pageButton.css("display",t?"":"none")}},GToolbar.prototype._updateShareSection=function(){const e=this._isShareButtonVisible(),t=this._isRealtimeCollaboratorsVisible();if(this._shareButton.css("display",e?"":"none"),this._collaboratorsDiv.css("display",t?"":"none"),e){const e=gDesigner.getApplicationManager().isPrivateSharing(),t=gDesigner.getApplicationManager().isSharing();this._shareButton.gShareButton("update",{isPrivate:e,isSharing:t})}t&&this._collaboratorsDiv.gCollaborators("collaborators",this._getRealtimeCollaborators())},GToolbar.prototype._isShareButtonVisible=function(){return gDesigner.getApplicationManager().isShareEnabled()&&gDesigner.getApplicationManager().hasRole(_config.ShareRoles.Owner)},GToolbar.prototype._isRealtimeCollaboratorsVisible=function(){const e=gDesigner.getApplicationManager();if(!e.isSharing())return!1;const t=gDesigner.getActiveDocument();if(!e.hasPermission(t,_config.SharePermissions.EDIT)&&!e.hasPermission(t,_config.SharePermissions.COMMENT))return!1;const n=this._getRealtimeCollaborators();return!!n&&n.length>0},GToolbar.prototype._getRealtimeCollaborators=function(){const e=gDesigner.getSyncUser();return _core.GUtil.bubbleSort((gDesigner.getApplicationManager().getRealtimeCollaborators()||[]).filter(t=>t.getRole().hasPermission(_config.SharePermissions.COMMENT)&&!(e&&e.getUID()===t.getUID())),(function(e,t){const n=e.getRole(),i=t.getRole();return n.equals(i)||!n.is(_config.ShareRoles.CoAuthor)&&!i.is(_config.ShareRoles.CoAuthor)?_core.GUtil.SortOperators.Equals:_core.GUtil.SortOperators.LessThan}))},GToolbar.prototype._createSnapButton=function(){return this._createLabelButton({icon:"gravit-icon-magnet",active:!1===gDesigner.getSetting("snap_disabled"),label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.snap")),menu:this._createSnapMenu(),split:!0,click:function(e){var t=$(e.target).closest(".toolbar-button").find(".action-button");t.toggleClass("g-active",!t.hasClass("g-active")),gDesigner.executeAction(GToggleSnapAction.ID,void 0,"toolbar")}.bind(this),tooltipConfig:GToggleSnapAction.TOOLTIP_CONFIG[_richtooltipconfig.TOOLTIP_AREA.TOOLBAR]}).addClass("snap-button")},GToolbar.prototype._createCommentToggleToolbarBtn=function(){let e=gDesigner.getAction(GToggleSidebarAction.ID+"."+GAnnotationsSidebar.ID),t=e.isChecked(),n=t?"gravit-icon-hide-comment":"gravit-icon-show-comment",i=t?_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.comment-off")):_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.comment-on"));return this._createLabelButton({icon:n,label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.comment-toggle")),click:function(){gDesigner.executeAction(e.getId(),void 0,"toolbar",!0);let t="Hide Comments";e.isChecked()&&(t="Show Comments"),gDesigner.stats("toolbar_activate_tool",t),this.updateCommentToggleStatus()}.bind(this),tooltipConfig:_richtooltipconfig.GRichTooltipConfig.from({title:i})})},GToolbar.prototype.updateCommentToggleStatus=function(){if(!this._commentToggleSection)return;let e=gDesigner.getAction(GToggleSidebarAction.ID+"."+GAnnotationsSidebar.ID),t=this._commentToggleSection.find(".toolbar-button"),n=t.find(".action-button .icon"),i="gravit-icon-show-comment",o=_richtooltipconfig.GRichTooltipConfig.from({title:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.comment-on"))});e.isChecked()&&(i="gravit-icon-hide-comment",o=_richtooltipconfig.GRichTooltipConfig.from({title:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.comment-off"))})),this._updateIcon(n,i),t.gRichTooltip(o)},GToolbar.prototype._createOpenMenu=function(){const e=new GMenu;e.createAddItem(gDesigner.getAction(GOpenAction.ID)),e.createAddItem(gDesigner.getAction("".concat(GGravitCloudAction.ID,".").concat(GGravitCloudAction.Actions.Open)));const t=gContainer.getRecentDocuments();if(t&&t.length){e.createAddDivider();const n=e.createAddItem("".concat(_core.GLocale.get(new _core.GLocaleKey("GFilesPanel","text.title-recent-files")),":"));n.setEnabled(!1),n.addClass("title"),t.forEach(t=>{e.createAddItem(t.getName(),()=>{gDesigner.openDocument(t)}).setIcon(gContainer.getRecentDocumentIconClass(t))})}return e},GToolbar.prototype._createQuickHistoryUndoRedoMenu=function(){const e=new GMenu(null,"g-quick-history-undo-redo-menu");e.addEventListener(GMenuOpenEvent.EVENT,()=>{gDesigner.stats("toolbar_click_menu","undoopen")});var t=gDesigner.getLicense(),n=!(gDesigner.isEnabledProFeatures()||t.isPro()&&!t.isExpired());n&&e.getHtmlElement().addClass("pro");const i=gDesigner.getAction(GRedoAction.ID);e.createAddItem(i);const o=gDesigner.getActiveDocument(),r=o&&o.getEditor();if(!r)return e;const a=r.getCurrentStateId(),s=gDesigner.getAction(GUndoAction.ID);if(r.hasRedoState()){const t=r.getRedoStates();e.createAddDivider(),t.forEach(t=>{this._buildAndIncludeItemForState(t,i,!0,a,e,r,n)})}return r.hasUndoState()&&(e.createAddDivider(),r.getUndoStates().slice().reverse().forEach(t=>{this._buildAndIncludeItemForState(t,s,!1,a,e,r,n)})),e},GToolbar.prototype._buildAndIncludeItemForState=function(e,t,n,i,o,r,a){const s=i===e.id,l=new GMenuItem(GMenuItem.Type.Item,o);l.setCaption(e.name),l.setIcon(s?"gravit-icon-dot":t.getIcon()),s&&l.addClass("g-active"),t.isEnabled()||l.addClass("g-disabled"),l.addEventListener(GMenuItem.ActivateEvent,()=>this._actionHandler(e,n,r,o,a,t)),o.addItem(l)},GToolbar.prototype._actionHandler=function(e,t,n,i,o,r){if(!r.isEnabled())return;if(o)return void gDesigner.handlePROFeatureInterruption();let a=n.getCurrentStateId();if(a!==e.id){gDesigner.stats("toolbar_click_menu","undoclick");do{t?n.redoState():n.undoState(),a=n.getCurrentStateId()}while(a!==e.id)}},GToolbar.prototype._createExportMenu=function(){const e=new GMenu;e.createAddItem(gDesigner.getAction("".concat(GExportAction.ID)));const t=["cdrapp","des","gvdesign","pdf"];GDocument.FileTypes.filter(e=>e.store&&!t.includes(e.ext)).forEach(t=>e.createAddItem(gDesigner.getAction("".concat(GSaveAsAction.ID,".").concat(t.ext))));const n=new GMenuItem(GMenuItem.Type.Menu,GMenu);return n.setCaption(GCategory.CATEGORY_FILE_EXPORT_PDF.label.split("/").slice(-1).pop()),n.getMenu().createAddItem(gDesigner.getAction("".concat(GSaveAsAction.ID,".pdf"))),n.getMenu().createAddItem(gDesigner.getAction("".concat(GSaveAsAction.ID,".pdf.96"))),n.getMenu().createAddItem(gDesigner.getAction("".concat(GSaveAsAction.ID,".pdf.150"))),n.getMenu().createAddItem(gDesigner.getAction("".concat(GSaveAsAction.ID,".pdf.300"))),n.getMenu().createAddItem(gDesigner.getAction("".concat(GExportAction.ID,".pdf"))),e.addItem(n),e},GToolbar.prototype._textEdit=function(e){return e.css({whiteSpace:"pre",fontFamily:"monospace",fontSize:"14px"}).on("keydown",(function(e){if(9===e.keyCode){let n=this.selectionStart;var t=this.selectionEnd;return this.value=this.value.substring(0,n)+"\t"+this.value.substring(t,this.value.length),this.selectionStart=n+1,this.selectionEnd=n+1,e.preventDefault(),!1}e.keyCode})).on("keyup",(function(e){if(13===e.keyCode){for(var t,n="",i=this.selectionStart,o=this.selectionEnd,r=i-1;r>0;){if("\n"===this.value.charAt(r)){var a=0;for(t=r;--r>=0;)if("\n"===this.value.charAt(r)){var s=this.value.substr(r+1,t).match(/^\t+/);if(s&&s.length){a=s[0].length;break}}for(var l=0;l<a;l++)n+="\t";break}r--}this.value=this.value.substring(0,i)+n+this.value.substring(o,this.value.length),this.selectionStart=i+n.length,this.selectionEnd=i+n.length}}))},GToolbar.prototype._refreshCustomButtons=function(){$(".custom_codes_button").remove();var customCode=JSON.parse(localStorage.getItem("designer.custom")),myself=this;if(customCode&&customCode.length){function customMenu(e){var t=new GMenu;return t.createAddItem("Edit",function(){var e=customCode.find(e=>e.id===this);let t=$("<div/>").append($("<div/>").text("Edit code")).append(myself._textEdit($('<textarea rows="30" cols="100" class="custom_button_code_edit">').text(e.code))).append($("<div/>").append("<label>Name:</label>").append($('<input type="text" class="custom_button_name_edit" value="'+e.name+'">')));t.gDialog({releaseOnClose:!0,className:"context-pane",buttons:[$('<button class="settings-button">Cancel</button>').on("click",()=>{t.gDialog("close")}),$('<button class="settings-button">Save</button>').on("click",()=>{e.name=$(".custom_button_name_edit")[0].value,e.code=$(".custom_button_code_edit")[0].value,localStorage.setItem("designer.custom",JSON.stringify(customCode)),t.gDialog("close"),myself._refreshCustomButtons()})]}),t.gDialog("open",!1),$(".custom_button_code_edit").focus()}.bind(e)),t.createAddItem("Delete",function(){var e=localStorage.getItem("designer.custom"),t=JSON.parse(e);t=t.filter(e=>{if(e.id!==this)return!0}),localStorage.setItem("designer.custom",JSON.stringify(t)),$("."+this).remove()}.bind(e)),t}customCode.forEach(item=>{this._toolsDiv.append(this._createLabelButton({icon:"gravit-icon-favorite",label:item.name,menu:customMenu(item.id),split:!0,click:function(evt){var code=$(evt.target).closest(".toolbar-button").data("code");function evaled(){var core=__webpack_require__(1),editor=__webpack_require__(43),client=__webpack_require__(16);eval("("+code+")")(gDesigner.getActiveDocument().getEditor().getSelection(),gDesigner.getActiveDocument().getScene(),gDesigner.getActiveDocument().getEditor(),core,editor,client)}evaled.call(null)}.bind(this)}).data("code",item.code).addClass(item.id).addClass("custom_codes_button"))})}},GToolbar.prototype._initZoomButton=function(){var e=new GMenu;e.setTooltipType(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR);var t=this;e.createAddItem(gDesigner.getAction(GOriginalViewAction.ID)),e.createAddDivider(),GMagnificationAction.ZOOM_LEVELS.forEach(t=>{e.createAddItem(gDesigner.getAction(GMagnificationAction.ID+"."+t.toString()))}),this._zoomButton=this._createLabelButton({caption:"100%",label:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.zoom")),menu:e,menudblclick:()=>{var e=gDesigner.getWindows().getActiveWindow().getView();this._zoomButton.find(".left-attached").hide(),this._zoomButton.find(".right-attached").hide(),this._zoomButton.find(".gravit-zoom-manual-input").show().find("> input").val(parseInt(100*e.getZoom(),10)).focus().select(),gDesigner.stats("toolbar_zoom_manual-input")}}).addClass("zoom-button"),$("<span></span>").addClass("gravit-icon-zoom-in icon").insertBefore(this._zoomButton.find(".caption")),this._zoomButton.find(".action-button").gRichTooltip(_richtooltipconfig.GRichTooltipConfig.from({title:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.zoom-button-tooltip-title"))})).addClass("left-attached right-attached").find(".dropdown-icon").remove(),$("<button></button>").addClass("left-attached attached-button").css("width","15px").text("-").on("click",(function(){gDesigner.executeAction(GZoomOutAction.ID,void 0,"toolbar")})).gRichTooltip(GZoomOutAction.TOOLTIP_CONFIG[_richtooltipconfig.TOOLTIP_AREA.TOOLBAR]).insertBefore(this._zoomButton.find(".action-button")),$("<button></button>").addClass("right-attached attached-button").css("width","15px").text("+").on("click",(function(){gDesigner.executeAction(GZoomInAction.ID,void 0,"toolbar")})).gRichTooltip(GZoomInAction.TOOLTIP_CONFIG[_richtooltipconfig.TOOLTIP_AREA.TOOLBAR]).appendTo(this._zoomButton),$("<div />").addClass("gravit-zoom-manual-input").css("display","none").insertBefore(this._zoomButton.find(".action-button")).html([$("<input />").attr("type","number").attr("min",GMagnificationAction.ZOOM_LEVELS[0]).attr("max",GMagnificationAction.ZOOM_LEVELS[GMagnificationAction.ZOOM_LEVELS.length-1]).on("blur",()=>{$(this).data("keydown")||(t._zoomButton.find(".left-attached").show(),t._zoomButton.find(".right-attached").show(),t._zoomButton.find(".gravit-zoom-manual-input").hide())}).on("keydown",e=>{e.stopPropagation(),$(this).data("keydown",!0)}).on("keyup",e=>{if($(this).data("keydown")){if(13===e.which){var n=gDesigner.getWindows().getActiveWindow().getView();t._zoomButton.find(".left-attached").show(),t._zoomButton.find(".right-attached").show(),t._zoomButton.find(".gravit-zoom-manual-input").hide(),gDesigner.zoomAtViewCenter(n,t._zoomButton.find(".gravit-zoom-manual-input > input").val()/100)}else 27===e.which&&(t._zoomButton.find(".left-attached").show(),t._zoomButton.find(".right-attached").show(),t._zoomButton.find(".gravit-zoom-manual-input").hide());$(this).data("keydown",null)}}).on("keypress",e=>{var t=e.keyCode||e.which;if(8===t||46===t||37===t||39===t)return!0;(t<48||t>57)&&e.preventDefault()}),$("<span />").text("%")])},GToolbar.prototype.relayout=function(){},GToolbar.prototype._activateOrResetTool=function(e,t){var n=gDesigner.getToolManager(),i=n.getTool(e);if(i===n.getActiveTool()){if(t)return;i=n.getTool(_editor.GPointerTool)}var o=gDesigner.getRightSidebars().getActiveSidebar(),r=o&&gDesigner.getRightSidebars().getSidebar(o);(!r||r.isToolAllowed(i)||r.isDeactivatable())&&(e&&gDesigner.stats("toolbar_activate_tool",GToolbar.getToolName(e)),n.activateTool(i,null,!0))},GToolbar.prototype._updateActiveTool=function(e,t){for(var n=null,i=0;i<gravit.tools.length;++i)if(e.constructor===gravit.tools[i].tool){n=gravit.tools[i];break}this._htmlElement.find(".toolbar-button").each(function(e,t){var i=$(t),o=i.data("tool"),r=i.data("tool-group");if("shape"===r&&n&&"shape"===n.group&&(this._initShapeMenu=!0),o){if(r&&n&&n.group===r){o=n.tool;var a=i.data("tool",o).find(".action-button .icon"),s=n.icon;if(!s){var l=gDesigner.getToolManager().getTool(o);l.getIcon&&(s=l.getIcon())}n&&n.richTooltipConfig&&i.data("tool",o).gRichTooltip(n.richTooltipConfig).find(".action-button").gRichTooltip(n.richTooltipConfig),this._updateIcon(a,s)}i.find(".action-button").toggleClass("g-active",!(!n||n.tool!==o))}}.bind(this))},GToolbar.prototype._updateIcon=function(e,t){t&&"<svg"===t.substr(0,4)?(e.empty(),e.attr("class","icon"),e.append($(t).attr({width:"16px",height:"16px"}).css("stroke","transparent").css("vertical-align","middle"))):(e.empty(),e.attr("class","icon "+t))},GToolbar.prototype._toolChangedEvent=function(e){if(e.newTool){var t=gDesigner.getRightSidebars().getActiveSidebar();t&&(gDesigner.getRightSidebars().getSidebar(t).isToolAllowed(e.newTool)||gDesigner.getRightSidebars().setActiveSidebar(GInspectorSidebar.ID)),this._updateActiveTool(e.newTool,e.previousTool)}this._clearViewMenuActiveItem()},GToolbar.prototype._clearViewMenuActiveItem=function(){const e=this._viewMenu&&this._viewMenu.getActiveItem();e&&e.changeActiveState(!1)},GToolbar.prototype._updateContextTools=function(){this._htmlElement.find(".toolbar-button").each((function(e,t){var n=$(t),i=n.data("tool");if(i){var o=gDesigner.getToolManager().getTool(i),r=n.find(".action-button");$(r).hasClass("g-disabled")===gDesigner.getToolManager().isContextActivatable(o)&&(gDesigner.getToolManager().isContextActivatable(o)?$(r).removeClass("g-disabled"):$(r).addClass("g-disabled"))}}))},GToolbar.prototype._updateActions=function(){this._htmlElement.find(".toolbar-button[data-action]").each((function(e,t){var n=$(t),i=n.data("action");i&&n.gPro({pro:!!i.isPro(),feature:i.getId()});const o=gDesigner.getApplicationManager();if(o&&!o.isDocumentTabManagementEnabled()){const e=gDesigner.getActiveDocument();if(e&&i instanceof GSaveAction){const t=e.getStatus()===GDocumentStatus.Saving,i=e.isSynchronizing()||t;n.find(".processing").toggleClass("g-active",i)}}n.find("button").toggleClass("g-disabled",!i||!i.isAvailable()||!i.isEnabled())}))},GToolbar.prototype._selectionChangedEvent=function(e){this._updateActions(),this._updateContextTools()},GToolbar.prototype._settingChangedEvent=function(e){"snap_disabled"===e.key?this._htmlElement.find(".snap-button > .action-button").toggleClass("g-active",!1===e.newValue):"touch"===e.key&&(gDesigner.isTouchEnabled()?this._updateTouchUI():this._updateDesktopUI())},GToolbar.prototype._updateDesktopUI=function(){const e=this._htmlElement.find(".view-section > .zoom-button");e.is(this._zoomButton)||(this._zoomButton=null,this._initZoomButton(),e.replaceWith(this._zoomButton),this._updateZoomFromWindow(!0)),this._pageButton&&(this._pageButton.gPageButton("reinit"),this._pageButton.hasClass("dropdown")&&this._pageButton.removeClass("dropdown"))},GToolbar.prototype._updateTouchUI=function(){},GToolbar.prototype._documentEvent=function(e){var t=e.document;switch(e.type){case GDocumentEvent.Type.Activated:t&&t.getEditor()&&t.getEditor().addEventListener(_editor.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._updatePageButton(),this._updateActions(),this._updateContextTools();break;case GDocumentEvent.Type.Deactivated:{t&&t.getEditor()&&t.getEditor().removeEventListener(_editor.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._updatePageButton(),this._updateActions(),this._updateContextTools();const e=gDesigner.getToolManager();if(e){const t=e.getActiveTool();t.supportsElementClick()&&t.clearClickedElement()}break}case GDocumentEvent.Type.Modified:this._updateActions(),this._updateContextTools(),this._updateActiveWindow();break;case GDocumentEvent.Type.StorageItemUpdated:case GDocumentEvent.Type.SynchronismUpdated:this._updateActiveWindow(),this._updateActions()}},GToolbar.prototype._windowEvent=function(e){var t=e.window.getView();switch(e.type){case GWindows.WindowEvent.Type.Activated:t&&t.addEventListener(_client.GSceneWidget.TransformEvent,this._updateZoomFromWindow,this),this._updateZoomFromWindow(),this._updateContextTools();break;case GWindows.WindowEvent.Type.Deactivated:t&&t.removeEventListener(_client.GSceneWidget.TransformEvent,this._updateZoomFromWindow,this),this._updateZoomFromWindow(),this._updateContextTools()}this._updateActiveWindow()},GToolbar.prototype._updateActiveWindow=function(){},GToolbar.prototype._updateZoomFromWindow=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=gDesigner.getWindows().getActiveWindow();if(t&&t.getView()){var n=_core.GMath.round(100*t.getView().getZoom(),!1,0);(this._currentZoomLevel!==n||e)&&(this._htmlElement.find(".zoom-button > .action-button .caption").text(n.toString()+"%"),this._currentZoomLevel=n)}},GToolbar.prototype._createToolItems=function(e,t){t||(t=new GMenu),t.setTooltipType(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR);var n=null;return gravit.tools.forEach((i,o)=>{if(i.group===e)if(n!==i.category&&(o>0&&t.createAddDivider(),n=i.category),"simpleshape"===n)this.createSimpleShapesMenu(t);else{var r=new GMenuItem;r.setCaption(i.title),r.setIcon(i.icon),r.setShortcutHint(i.key?[i.key]:null),r.setPro(i.pro,i.feature),r.addEventListener(GMenuItem.ActivateEvent,()=>{i&&i.title&&gDesigner.stats("toolbar_activate_tool",GToolbar.getToolName(i.tool)),this._activateOrResetTool(i.tool,!0)}),r.addEventListener(GMenuItem.UpdateEvent,()=>{gDesigner.canActivateTool(i.tool,!0)&&i.key?r.setShortcutHint([i.key]):r.setShortcutHint(null)}),i.richTooltipConfig&&r.setTooltipConfig(_richtooltipconfig.GRichTooltipConfig.from(Object.assign({},i.richTooltipConfig.getConfig(),{side:!0}))),t.addItem(r)}}),t},GToolbar.prototype._createLabelButton=function(e){var t=e.label,n=e.className,i=e.icon,o=e.click,r=e.menudblclick||null;let a=!1,s=null;const l=this;e.action&&(a=e.action.isPro(),s=e.action.getTooltipConfig(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR),t||(t=_core.GLocale.get(e.action.getTitle())),i||(i=e.action.getIcon()||e.action.getGroupIcon()),o||(o=function(){gDesigner.executeAction(e.action.getId(),[void 0,function(e){e&&e.documentStatus===GDocumentStatus.SaveCancelled&&l._updateActions()}],"toolbar")})),e.tooltipConfig&&(s=e.tooltipConfig);var c=$("<div></div>").addClass("toolbar-button").gPro({pro:a});n&&c.addClass(n),e.action&&c.attr("data-action",e.action.getId()).data("action",e.action);var d=$("<button></button>").addClass("action-button").toggleClass("g-active",!0===e.active).attr("data-title",t).appendTo(c).on("mousedown",(function(e){e.preventDefault()}));if(s&&d.gRichTooltip(s),i?(this._updateIcon($("<span></span>").appendTo(d),i),d.addClass("icon")):e.caption&&d.append($("<span></span>").addClass("caption").text(e.caption)),o&&d.on("click",o),e.menu||e.menuOpen){var u=null;if(e.split?(c.addClass("dropdown"),u=$("<button></button>").addClass("dropdown-button").append($("<span></span>").addClass("gravit-icon-down")).appendTo(c).on("mouseover",(function(e){_config.IS_COREL||e.stopPropagation()}))):u=d.addClass("menu").append($("<span></span>").addClass("gravit-icon-down dropdown-icon")),e.menu?u.gMenuButton({menu:e.menu,dblclick:r,getActiveItem:e.getActiveItem||null}):e.menuOpen&&u.on("click",e.menuOpen),"gravit-icon-undo"===i){var p=gDesigner.getLicense(),g=gDesigner.isEnabledProFeatures()||p.isPro()&&!p.isExpired();_config.IS_COREL?u.attr("data-title",_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.undoList-button-tooltip-title"))):u.gRichTooltip(_richtooltipconfig.GRichTooltipConfig.from({title:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.undoList-button-tooltip-title")),description:_core.GLocale.get(new _core.GLocaleKey("GToolbar","text.undoList-button-tooltip-description")),learnMore:"https://documentation.designer.io/basics/tools-toolbar/",isPro:!g})),g||u.addClass("pro-without-icon")}}return $("<span/>").addClass("processing").appendTo(c),c},GToolbar.prototype.createSimpleShapesMenu=function(e){var t=function(e){var t=null,n=new _core.GParameterizedVertexProcessor(e.annotations?e.annotations.name:null,e.annotations?e.annotations.annotList:null,e.parameters,e.vertices),i=null;if(e.annotations&&e.annotations.annotList&&e.annotations.annotList.length)for(var o=e.annotations.annotList,r=0;r<o.length;++r){var a=o[r];i?i.push(new _core.GPoint(a.x0,a.y0)):i=[new _core.GPoint(a.x0,a.y0)]}var s=null;if(n){s=new _core.GSimpleShape(n,i,14,14,e.name);var l=(s=new _core.GVertexTransformer(s,new _core.GTransform(1,0,0,1,1,1))).toSVGPath();l&&(t='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="isolation:isolate" width="16" height="16"><path d="'+l+'" style="fill:none;fill-rule:evenodd;stroke:currentColor;""stroke-width:2;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:3;opacity:1;"/></svg>')}t||(t="gravit-icon-rectangle");var c=$("<span></span>");return this._updateIcon(c,t),$("<button></button>").addClass("button").attr("data-sshape",e.name).on("mouseup",function(n){n.preventDefault(),gDesigner.getToolManager().activateTool(_editor.GSimpleShapeTool,t,!0),gDesigner.getToolManager().getActiveTool().init(e)}.bind(this)).addClass("icon").append(c)}.bind(this),n={};for(let e=0;e<simpleShapes.length;++e){var i=simpleShapes[e];n[i.shapeGroup]||(n[i.shapeGroup]={});var o=n[i.shapeGroup];o[i.subGroup]?o[i.subGroup].push(i):o[i.subGroup]=[i]}for(var r in n){var a=e.findItem(r);a||((a=new GMenuItem(GMenuItem.Type.Menu,GMenu)).setCaption(r),e.addItem(a));var s=a.getMenu(),l=n[r];for(var c in l){var d=new GMenuItem;d.setNoHover(!0),s.addItem(d);var u=l[c];for(let e=0;e<u.length;++e){var p=t(u[e]);d._htmlElement.append(p)}}}},GToolbar.prototype._createMergeMenu=function(){var e=new GMenu;return e.setTooltipType(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR),e.createAddItem(gDesigner.getAction("modify.merge.op-1")),e.createAddItem(gDesigner.getAction("modify.merge.op-4")),e.createAddItem(gDesigner.getAction("modify.merge.op-3")),e.createAddItem(gDesigner.getAction("modify.merge.op-2")),e},GToolbar.prototype._createSnapMenu=function(){var e=new GMenu;return e.setTooltipType(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR),e.createAddItem(gDesigner.getAction(GToggleSnapAction.ID)),_config.HAS_SNAPZONES&&e.createAddItem(gDesigner.getAction(GToggleSnapZonesAction.ID)),e.createAddDivider(),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GGridGuide.ID)),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GGuideLinesGuide.ID)),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GFullPixelsGuide.ID)),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GPointsGuide.ID)),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GBBoxGuide.ID)),e.createAddItem(gDesigner.getAction(GToggleGuideAction.ID+"."+_editor.GPageGuide.ID)),e.createAddDivider(),e.createAddItem(gDesigner.getAction(GShowGridAction.ID)),e.createAddItem(gDesigner.getAction(GShowGuideLinesAction.ID)),e.createAddItem(gDesigner.getAction(GShowSymbolLabelsAction.ID)),e},GToolbar.prototype._createImageMenu=function(){var e=new GMenu;return e.setTooltipType(_richtooltipconfig.TOOLTIP_AREA.TOOLBAR),e.createAddItem(gDesigner.getAction(GPlaceImportAction.ID)),e.createAddItem(gDesigner.getAction(GLinkImageAction.ID)),e},GToolbar.prototype.getHeight=function(){return this._htmlElement[0].clientHeight},__webpack_require__(1415)(GToolbar),module.exports=GToolbar},function(e,t,n){"use strict";e.exports=[{name:"Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,1,1,-1,2,1,1,1,-1,2,1,-1,1,-1,2,1,-1,1,-1,5],width:100,height:100},{name:"Rounded Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-.67,y0:-1,X:"x",Y:-1,minX:-.99,maxX:0}]},parameters:[{name:"rlen",expression:"1 + annot[0].X"},{name:"hlen",expression:"sqrt((1 + annot[0].X) * (1 + annot[0].X) * 2) * 0.310026286"}],vertices:[1,2,"-1 + rlen",1,-1,4,1,-1,2,"-1 + rlen",4,2,"-1 + rlen - hlen",1,-1,4,1,-1,2,"-1 + rlen - hlen",2,1,-1,2,"1 - rlen",4,2,"-1 + rlen",1,1,4,1,-1,2,"1 - rlen + hlen",4,2,"-1 + rlen - hlen",1,1,2,2,"1 - rlen",1,1,4,1,1,2,"1 - rlen",4,2,"1 - rlen + hlen",1,1,4,1,1,2,"1 - rlen + hlen",2,1,1,2,"-1 + rlen",4,2,"1 - rlen",1,-1,4,1,1,2,"-1 + rlen - hlen",4,2,"1 - rlen + hlen",1,-1,5],width:100,height:100},{name:"Snip Single Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:.99}]},parameters:[{name:"len",expression:"1 - annot[0].X"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,1,2,"-1 + len",2,2,"1 - len",1,-1,2,1,-1,1,-1,5],width:100,height:100},{name:"Snip Same Side Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-1,y0:1,X:"x",Y:1,minX:-1,maxX:0},{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:1}]},parameters:[{name:"tlen",expression:"1 - annot[1].X"},{name:"blen",expression:"1 + annot[0].X"}],vertices:[1,1,-1,2,"1 - blen",2,2,"-1 + blen",1,1,2,2,"1 - blen",1,1,2,1,1,2,"1 - blen",2,1,1,2,"-1 + tlen",2,2,"1 - tlen",1,-1,2,2,"-1 + tlen",1,-1,2,1,-1,2,"-1 + tlen",5],width:100,height:100},{name:"Snip Diagonal Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-1,y0:-1,X:"x",Y:-1,minX:-1,maxX:0},{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:1}]},parameters:[{name:"trbllen",expression:"1 - annot[1].X"},{name:"tlbrlen",expression:"1 + annot[0].X"}],vertices:[1,1,-1,2,"1 - trbllen",2,2,"-1 + trbllen",1,1,2,2,"1 - tlbrlen",1,1,2,1,1,2,"1 - tlbrlen",2,1,1,2,"-1 + trbllen",2,2,"1 - trbllen",1,-1,2,2,"-1 + tlbrlen",1,-1,2,1,-1,2,"-1 + tlbrlen",5],width:100,height:100},{name:"Snip and Round Single Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-.67,y0:-1,X:"x",Y:-1,minX:-.99,maxX:0},{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:1}]},parameters:[{name:"trlen",expression:"1 - annot[1].X"},{name:"tlrlen",expression:"1 + annot[0].X"},{name:"tlhlen",expression:"sqrt((1 + annot[0].X) * (1 + annot[0].X) * 2) * 0.310026286"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,1,2,"-1 + trlen",2,2,"1 - trlen",1,-1,2,2,"-1 + tlrlen",1,-1,4,1,-1,2,"-1 + tlrlen",4,2,"-1 + tlrlen - tlhlen",1,-1,4,1,-1,2,"-1 + tlrlen - tlhlen",5],width:100,height:100},{name:"Round Single Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:.99}]},parameters:[{name:"rlen",expression:"1 - annot[0].X"},{name:"hlen",expression:"sqrt((1 - annot[0].X) * (1 - annot[0].X) * 2) * 0.310026286"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,1,2,"-1 + rlen",4,2,"1 - rlen",1,-1,4,1,1,2,"-1 + rlen - hlen",4,2,"1 - rlen + hlen",1,-1,4,1,-1,1,-1,5],width:100,height:100},{name:"Round Same Side Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-.99,y0:1,X:"x",Y:1,minX:-.99,maxX:0},{x0:.67,y0:-1,X:"x",Y:-1,minX:0,maxX:.99}]},parameters:[{name:"brlen",expression:"1 + annot[0].X"},{name:"bhlen",expression:"sqrt((1 + annot[0].X) * (1 + annot[0].X) * 2) * 0.310026286"},{name:"trlen",expression:"1 - annot[1].X"},{name:"thlen",expression:"sqrt((1 - annot[1].X) * (1 - annot[1].X) * 2) * 0.310026286"}],vertices:[1,2,"-1 + trlen",1,-1,4,1,-1,2,"-1 + trlen",4,2,"-1 + trlen - thlen",1,-1,4,1,-1,2,"-1 + trlen - thlen",2,1,-1,2,"1 - brlen",4,2,"-1 + brlen",1,1,4,1,-1,2,"1 - brlen + bhlen",4,2,"-1 + brlen - bhlen",1,1,2,2,"1 - brlen",1,1,4,1,1,2,"1 - brlen",4,2,"1 - brlen + bhlen",1,1,4,1,1,2,"1 - brlen + bhlen",2,1,1,2,"-1 + trlen",4,2,"1 - trlen",1,-1,4,1,1,2,"-1 + trlen - thlen",4,2,"1 - trlen + thlen",1,-1,5],width:100,height:100},{name:"Round Diagonal Corner Rectangle",shapeGroup:"Shapes",subGroup:"Rectangles",annotations:{name:"annot",annotList:[{x0:-.67,y0:-1,X:"x",Y:-1,minX:-.99,maxX:0},{x0:.99,y0:-1,X:"x",Y:-1,minX:0,maxX:.99}]},parameters:[{name:"trblrlen",expression:"1 - annot[1].X"},{name:"trblhlen",expression:"sqrt((1 - annot[1].X) * (1 - annot[1].X) * 2) * 0.310026286"},{name:"tlbrrlen",expression:"1 + annot[0].X"},{name:"tlbrhlen",expression:"sqrt((1 + annot[0].X) * (1 + annot[0].X) * 2) * 0.310026286"}],vertices:[1,2,"-1 + tlbrrlen",1,-1,4,1,-1,2,"-1 + tlbrrlen",4,2,"-1 + tlbrrlen - tlbrhlen",1,-1,4,1,-1,2,"-1 + tlbrrlen - tlbrhlen",2,1,-1,2,"1 - trblrlen",4,2,"-1 + trblrlen",1,1,4,1,-1,2,"1 - trblrlen + trblhlen",4,2,"-1 + trblrlen - trblhlen",1,1,2,2,"1 - tlbrrlen",1,1,4,1,1,2,"1 - tlbrrlen",4,2,"1 - tlbrrlen + tlbrhlen",1,1,4,1,1,2,"1 - tlbrrlen + tlbrhlen",2,1,1,2,"-1 + trblrlen",4,2,"1 - trblrlen",1,-1,4,1,1,2,"-1 + trblrlen - trblhlen",4,2,"1 - trblrlen + trblhlen",1,-1,5],width:100,height:100},{name:"Oval",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,0,1,-1,4,1,-1,1,0,4,1,-.55191502,1,-1,4,1,-1,1,-.55191502,4,1,0,1,1,4,1,-1,1,.55191502,4,1,-.55191502,1,1,4,1,1,1,0,4,1,.55191502,1,1,4,1,1,1,.55191502,4,1,0,1,-1,4,1,1,1,-.55191502,4,1,.55191502,1,-1,5],width:100,height:100},{name:"Triangle",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:0,y0:-1,X:"x",Y:-1,minX:-1,maxX:1}]},parameters:[{name:"topx",expression:"annot[0].X"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,2,"topx",1,-1,5],width:117,height:100},{name:"Right Triangle",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,-1,1,-1,5],width:100,height:100},{name:"Parallelogram",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.67,y0:-1,X:"x",Y:-1,minX:-1,maxX:1}]},parameters:[{name:"sidelen",expression:"1 - annot[0].X"}],vertices:[1,1,-1,1,1,2,2,"-1 + sidelen",1,1,2,1,1,1,-1,2,2,"1 - sidelen",1,-1,5],width:133,height:100},{name:"Trapezoid",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.67,y0:-1,X:"x",Y:-1,minX:-1,maxX:0}]},parameters:[{name:"len",expression:"1 + annot[0].X"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,2,"1 - len",1,-1,2,2,"-1 + len",1,-1,5],width:133,height:100},{name:"Diamond",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,0,1,-1,2,1,-1,1,0,2,1,0,1,1,2,1,1,1,0,5],width:133,height:133},{name:"Regular Pentagon",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,0,1,-1,2,1,-.95105652,1,-.30901699,2,1,-.58778525,1,.80901699,2,1,.58778525,1,.80901699,2,1,.95105652,1,-.30901699,5],width:105.14622309,height:100},{name:"Hexagon",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.5,y0:-.8660254,X:"x",Y:-.8660254,minX:-1,maxX:0}]},parameters:[{name:"len",expression:"1 + annot[0].X"}],vertices:[1,1,1,1,0,2,2,"1 - len",1,-.8660254,2,2,"-1 + len",1,-.8660254,2,1,-1,1,0,2,2,"-1 + len",1,.8660254,2,2,"1 - len",1,.8660254,5],width:115.47005434,height:100},{name:"Heptagon",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,0,1,-1,2,1,-.78183148,1,-.6234898,2,1,-.97492791,1,.22252093,2,1,-.43388374,1,.90096887,2,1,.43388374,1,.90096887,2,1,.97492791,1,.22252093,2,1,.78183148,1,-.6234898,5],width:102.57168598,height:100},{name:"Octagon",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.38268343,y0:-.92387953,X:"x",Y:-.92387953,minX:-.92387953,maxX:0}]},parameters:[{name:"len",expression:"0.92387953 + annot[0].X"}],vertices:[1,1,.92387953,2,"-0.92387953 + len",2,2,"0.92387953 - len",1,-.92387953,2,2,"-0.92387953 + len",1,-.92387953,2,1,-.92387953,2,"-0.92387953 + len",2,1,-.92387953,2,"0.92387953 - len",2,2,"-0.92387953 + len",1,.92387953,2,2,"0.92387953 - len",1,.92387953,2,1,.92387953,2,"0.92387953 - len",5],width:100,height:100},{name:"Decagon",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,1,1,0,2,1,.80901699,1,-.58778525,2,1,.30901699,1,-.95105652,2,1,-.30901699,1,-.95105652,2,1,-.80901699,1,-.58778525,2,1,-1,1,0,2,1,-.80901699,1,.58778525,2,1,-.30901699,1,.95105652,2,1,.30901699,1,.95105652,2,1,.80901699,1,.58778525,5],width:100,height:95.105652},{name:"Dodecagon",shapeGroup:"Shapes",subGroup:"Various",vertices:[1,1,.9659258262890683,1,-.25881904510252074,2,1,.7071067811865476,1,-.7071067811865475,2,1,.25881904510252096,1,-.9659258262890682,2,1,-.25881904510252063,1,-.9659258262890683,2,1,-.7071067811865475,1,-.7071067811865476,2,1,-.9659258262890682,1,-.258819045102521,2,1,-.9659258262890683,1,.2588190451025208,2,1,-.7071067811865477,1,.7071067811865475,2,1,-.2588190451025215,1,.9659258262890681,2,1,.2588190451025203,1,.9659258262890684,2,1,.7071067811865468,1,.7071067811865483,2,1,.9659258262890681,1,.25881904510252157,5],width:100,height:100},{name:"Frame",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.75,y0:-1,X:"x",Y:-1,minX:-1,maxX:0}]},parameters:[{name:"width",expression:"1 + annot[0].X"}],vertices:[1,1,-1,1,1,2,1,1,1,1,2,1,1,1,-1,2,1,-1,1,-1,5,1,2,"-1 + width",2,"1 - width",2,2,"1 - width",2,"1 - width",2,2,"1 - width",2,"-1 + width",2,2,"-1 + width",2,"-1 + width",5],width:100,height:100},{name:"Half Frame",shapeGroup:"Shapes",subGroup:"Various",annotations:{name:"annot",annotList:[{x0:-.33,y0:-1,X:"x",Y:-1,minX:-1,maxX:1},{x0:-1,y0:-.33,X:-1,Y:"y",minY:-1,maxY:1}]},parameters:[{name:"xwidth",expression:"1 + annot[0].X"},{name:"ywidth",expression:"min(1 + annot[1].Y, 1 - annot[0].X)"}],vertices:[1,1,1,1,-1,2,1,-1,1,-1,2,1,-1,1,1,2,2,"-1 + xwidth",2,"1 - xwidth",2,2,"-1 + xwidth",2,"-1 + ywidth",2,2,"1 - ywidth",2,"-1 + ywidth",5],width:100,height:100},{name:"Right Arrow",shapeGroup:"Arrows",subGroup:"Classical",annotations:{name:"annot",annotList:[{maxX:.99,Y:-.75,x0:0,y0:-.75,X:"x",minX:-1.99},{x0:-2,y0:-.25,X:-2,Y:"y",minY:-.74,maxY:-.01}]},parameters:[{name:"arrowheadLen",expression:"1 - annot[0].X"},{name:"shaftWidth",expression:"-annot[1].Y * 2"}],vertices:[1,1,-2,2,"-shaftWidth / 2",2,1,-2,2,"shaftWidth / 2",2,2,"1 - arrowheadLen",2,"shaftWidth / 2",2,2,"1 - arrowheadLen",1,.75,2,1,1,1,0,2,2,"1 - arrowheadLen",1,-.75,2,2,"1 - arrowheadLen",2,"-shaftWidth / 2",5],width:100,height:50},{name:"Left-Right Arrow",shapeGroup:"Arrows",subGroup:"Classical",annotations:{name:"annot",annotList:[{x0:0,y0:-.75,X:"x",Y:-.75,minX:-.99,maxX:.99},{x0:-3,y0:-.25,X:-3,Y:"y",minY:-.74,maxY:-.01}]},parameters:[{name:"arrowheadLen",expression:"1 - annot[0].X"},{name:"shaftWidth",expression:"-annot[1].Y * 2"}],vertices:[1,2,"-3 + arrowheadLen",2,"-shaftWidth / 2",2,2,"-3 + arrowheadLen",1,-.75,2,1,-3,1,0,2,2,"-3 + arrowheadLen",1,.75,2,2,"-3 + arrowheadLen",2,"shaftWidth / 2",2,2,"1 - arrowheadLen",2,"shaftWidth / 2",2,2,"1 - arrowheadLen",1,.75,2,1,1,1,0,2,2,"1 - arrowheadLen",1,-.75,2,2,"1 - arrowheadLen",2,"-shaftWidth / 2",5],width:133,height:50},{name:"Plus",shapeGroup:"Equation",subGroup:"Classical",annotations:{name:"annot",annotList:[{x0:-.36,y0:-.12,X:-.36,Y:"y",minY:-.36,maxY:0}]},parameters:[{name:"len",expression:"0.36 + annot[0].Y"}],vertices:[1,1,-.36,2,"-0.36 + len",2,1,-.36,2,"0.36 - len",2,2,"-0.36 + len",2,"0.36 - len",2,2,"-0.36 + len",1,.36,2,2,"0.36 - len",1,.36,2,2,"0.36 - len",2,"0.36 - len",2,1,.36,2,"0.36 - len",2,1,.36,2,"-0.36 + len",2,2,"0.36 - len",2,"-0.36 + len",2,2,"0.36 - len",1,-.36,2,2,"-0.36 + len",1,-.36,2,2,"-0.36 + len",2,"-0.36 + len",5],width:72,height:72},{name:"Minus",shapeGroup:"Equation",subGroup:"Classical",vertices:[1,1,-.36,1,-.12,2,1,-.36,1,.12,2,1,.36,1,.12,2,1,.36,1,-.12,5],width:72,height:24},{name:"Multiply",shapeGroup:"Equation",subGroup:"Classical",annotations:{name:"annot",annotList:[{x0:-.33941126,y0:-.16970563,X:-.33941126,Y:"y",minY:-.33941126,maxY:0}]},parameters:[{name:"projHeight",expression:"-annot[0].Y"}],vertices:[1,1,-.33941126,2,"-projHeight",2,2,"-0.33941126 + projHeight",1,0,2,1,-.33941126,2,"projHeight",2,2,"-projHeight",1,.33941126,2,1,0,2,"0.33941126 - projHeight",2,2,"projHeight",1,.33941126,2,1,.33941126,2,"projHeight",2,2,"0.33941126 - projHeight",1,0,2,1,.33941126,2,"-projHeight",2,2,"projHeight",1,-.33941126,2,1,0,2,"-0.33941126 + projHeight",2,2,"-projHeight",1,-.33941126,5],width:67.882252,height:67.882252},{name:"Equal",shapeGroup:"Equation",subGroup:"Classical",annotations:{name:"annot",annotList:[{x0:-.36,y0:-.06,X:-.36,Y:"y",minY:-.3,maxY:0}]},parameters:[{name:"len",expression:"0.3 + annot[0].Y"}],vertices:[1,1,-.36,2,"-0.3 + len",2,1,.36,2,"-0.3 + len",2,1,.36,1,-.3,2,1,-.36,1,-.3,5,1,1,-.36,2,"0.3 - len",2,1,.36,2,"0.3 - len",2,1,.36,1,.3,2,1,-.36,1,.3,5],width:72,height:60}]},function(e,t,n){"use strict";n(171);const i=n(402),o=n(510),r=n(400),a=n(1058),s=n(1055),l=n(725),c=n(401),d=n(398),u=n(1176),p=n(217),g=n(308),h=n(232),f=n(76),{GSystem:m,GMath:y}=n(1),{FILE_FORMATS:v}=n(12);e.exports=function(e){e.prototype._windowButton=null,e.prototype._nativeButton=null,e.prototype._touchSection=null,e.prototype._updateTouchUI=function(){this._touchSection||(this._touchSection=this._createTouchSection().prependTo(this._htmlElement)),this._windowButton||(this._windowButton=this._createWindowButton().hide().insertBefore(this._exportButton)),this._nativeButton||gContainer.getRuntime()===f.Runtime.Electron&&m.operatingSystem!==m.OperatingSystem.OSX_IOS&&(this._nativeButton=this._createNativeButton().appendTo(this._htmlElement.find(".export-section")));!gDesigner.getApplicationManager().isEditingEnabled()?this._updateTouchSimpleUI():this._updateTouchFullUI(),this._updateActiveWindow(),this._updateZoomFromWindow(!0),this._updateActions(),this._updateContextTools(),this._updateViewBasedOnPermissions()},e.prototype._updateViewBasedOnPermissions=function(){this._windowButton&&(gDesigner.getApplicationManager().isDocumentTabManagementEnabled()?this._windowButton.show():this._windowButton.hide())},e.prototype._updateTouchFullUI=function(){this._htmlElement.find(".menu-section > .zoom-button").length||(this._touchZoomButton&&(this._touchZoomButton=null),this._initTouchZoomButton(),this._touchZoomButton.insertBefore(".menu-section > .snap-button"))},e.prototype._updateTouchSimpleUI=function(){this._updateTouchZoomButtonSimpleUI(),this._updateZoomFromWindow(!0),this._updateTouchPageButton()},e.prototype._updateTouchZoomButtonSimpleUI=function(){const e=this._htmlElement.find(".view-section > .zoom-button");e.is(this._touchZoomButton)||(this._touchZoomButton=null,this._initTouchZoomButton(),e.replaceWith(this._touchZoomButton))},e.prototype._updateTouchPageButton=function(){this._pageButton&&(this._pageButton.gPageButton("reinit"),this._pageButton.addClass("dropdown"))},e.prototype._initTouchZoomButton=function(){const e=$("<button />").addClass("dropdown-button").append($("<span></span>").addClass("gravit-icon-down")),t=new p(void 0,"g-zoom-menu");this._touchZoomButton=$("<div/>").addClass("zoom-button").addClass("toolbar-button").addClass("action-button").addClass("g-menu-button").addClass("dropdown").append($("<div />").addClass("action-button").append($("<span />").addClass("caption").text("100%"))).append(e).gMenuButton({menu:()=>(t.clearItems(),[gDesigner.getAction(i.ID),gDesigner.getAction(o.ID),gDesigner.getAction("".concat(s.ID,".50")),gDesigner.getAction("".concat(s.ID,".100")),gDesigner.getAction("".concat(s.ID,".200")),gDesigner.getAction("".concat(s.ID,".400"))].reduce((e,t)=>(e.createAddItem(t),e),t)),getActiveItem:()=>{var e=gDesigner.getWindows().getActiveWindow(),n=100*(e&&e.getView()).getZoom(),i=n&&y.round(n,!1,0),o=i&&gDesigner.getAction("".concat(s.ID,".").concat(i)),r=o&&o.getTitle();return r&&t.findItem(r)},reference:e})},e.prototype._getTouchMenubarIcon=function(){return gContainer.getRuntime()===f.Runtime.IPad?"gravit-icon-touch-menubar-ipad":"gravit-icon-touch-menubar"},e.prototype._createTouchSection=function(){return this._touchZoomButton||this._initTouchZoomButton(),$("<div></div>").addClass("section menu-section g-touch-only").append(this._createLabelButton({icon:this._getTouchMenubarIcon(),menu:()=>{const e=gDesigner.getMainMenu();return e.detach(),e}}).addClass("menubar-toolbar-button")).append(this._createLabelButton({icon:"gravit-icon-open",split:!0,menu:()=>this._createOpenMenu(),click:()=>gDesigner.executeAction(l.ID)}).addClass("open-toolbar-button")).append(this._createSaveButtonGroup()).append(this._createLabelButton({action:gDesigner.getAction(a.ID),icon:"gravit-icon-undo",split:!0,menu:()=>this._createQuickHistoryUndoRedoMenu(),click:()=>gDesigner.executeAction(a.ID)}).addClass("undo-toolbar-button")).append(this._touchZoomButton).append(this._createSnapButton())},e.prototype._createSaveButtonGroup=function(){const e=gDesigner.getAction(r.ID);return this._createLabelButton({icon:"gravit-icon-save",split:!0,menu:[gDesigner.getAction("".concat(d.ID,".").concat(v.find(e=>e.default).ext)),gDesigner.getAction("".concat(c.ID,".").concat(c.Actions.SaveAs)),gDesigner.getAction(u.ID)].reduce((e,t)=>(e.createAddItem(t),e),new p),click:()=>gDesigner.executeAction(r.ID)}).addClass("save-toolbar-button").attr("data-action",e.getId()).data("action",e)},e.prototype._createWindowButton=function(){const e=new p;return this._createLabelButton({caption:" ",menu:()=>{e.clearItems();const t=gDesigner.getWindows();return t.getWindows().reduce((e,n)=>(this._createAndAppendWindowTabToMenu(t,e,n),e),e)},getActiveItem:()=>this._findActiveWindowItemInMenu(e)}).addClass("window-button").addClass("g-touch-only")},e.prototype._createAndAppendWindowTabToMenu=function(e,t,n){const i=this._getWindowTitle(n),o=t.createAddItem(i,()=>{e.activateWindow(n,!0)});o.setDetachable(!0),o.addEventListener(g.DetachEvent,()=>{e.removeWindow(n)});const r=n.getDocument();r&&(r.isCloudFile()||r.isExternalFile())&&o.setIcon(h["gravit-icon-cloud"])},e.prototype._findActiveWindowItemInMenu=function(e){const t=gDesigner.getWindows(),n=t&&t.getActiveWindow(),i=this._getWindowTitle(n);return i&&e.findItem(i)},e.prototype._createNativeButton=function(){const e=e=>$("<button/>").addClass("native-button").append($("<span/>").addClass(e));return this._createLabelButton({caption:"",icon:"gravit-icon-3-dots",click:t=>{$("<div/>").append($("<div/>").addClass("container").append(e("gravit-icon-minimize").on("click",()=>gContainer.minimizeWindow())).append(e("gravit-icon-maximize").on("click",()=>gContainer.maximizeWindow())).append(e("gravit-icon-close").on("click",()=>gContainer.closeWindow()))).gOverlay({releaseOnClose:!0,clazz:"g-toolbar-native-button-overlay"}).gOverlay("open",$(t.target))}}).addClass("native-button").addClass("g-touch-only")},e.prototype._updateActiveWindow=function(){if(gDesigner.isTouchEnabled()&&this._windowButton)if(gDesigner.getApplicationManager().isDocumentTabManagementEnabled()){const i=gDesigner.getWindows()&&gDesigner.getWindows().getActiveWindow();if(i){const o=i.getDocument();var e=this._getWindowTitle(i),t="..."+e.substr(e.length-3);const r=this._windowButton.show().toggleClass("syncing",o&&o.isSynchronizing()).find(".action-button .caption").text(e);this._windowButton.find(".subicon").remove(),this._windowButton.find(".ending").remove();var n=r[0].offsetWidth<r[0].scrollWidth;this._windowButton.toggleClass("text-overflow",n),n&&$("<span/>").addClass("ending").attr("data-ending",t).insertBefore(this._windowButton.find(".gravit-icon-down")),this._windowButton.find(".subicon").remove(),o&&(o.isCloudFile()||o.isExternalFile())&&$("<span/>").addClass("subicon").addClass(h["gravit-icon-cloud-window"]).insertBefore(this._windowButton.find(".gravit-icon-down"))}else this._windowButton.hide()}else this._windowButton.hide()},e.prototype._getWindowTitle=function(e){const t=e&&e.getDocument();return e&&"".concat(e.getTitleWithExtension()).concat(t&&t.isModified()?"*":"")}}},function(e,t,n){"use strict";var i=n(17);n(28),n(9),n(45),n(58);var o=n(1),r=n(12),a=n(322),s=n(32),l=i(n(231)),c=i(n(36)),d=i(n(648)),u=n(144),p=n(725),g=n(106),h=n(1182),f=n(1429),m=n(1042),{youtubePlaylist:y}=n(1185),v=n(399);n(202);const _=n(767),b=n(544);function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var t=this._createFooter(),n=this;this._createOption.bind(this),this._createPresetsFrame.bind(this),this.open.bind(this),this.isOpen.bind(this),this.close.bind(this),this._newDocumentCustomSize.bind(this),this.getDialogElement.bind(this),this._openFromCloud=!1,this._parentDialogInstance=e,this._spectatorModeClazz="on-spectator-mode",this._cb=null,this._dialog=$("<div></div>");$("<div></div>").addClass("links").append($("<div></div>").addClass("loader").text(o.GLocale.get(new o.GLocaleKey("GLocale","loading"))+"..."));var i=$("<div></div>").addClass("sidebar").appendTo(this._dialog);r.LICENSE.UPGRADEABLE&&(gDesigner.getApplicationManager().isLicenseUpgradeable()||i.addClass("on-pro"));var s=$("<div/>").addClass("sidebar-options").appendTo(i),u=$("<div></div>").addClass("frame").appendTo(this._dialog),p=this._createPresetsFrame().appendTo(u),f=null,m=null;this._createSeparator(s,"start-option");var y=function(e){this._dialog.find(".sidebar-options").find(".option").removeClass("active"),this._dialog.find(".sidebar-options").find(e).addClass("active")}.bind(this),_=function(){this._dialog.find(".option.start-option").trigger("click"),this._dialog.find(".frame").removeClass("cloud-frame"),this._dialog.find(".g-dialog-content").removeClass("cloud-dialog"),this._dialog.parent().removeClass("cloud-files-dialog"),y(".start-option")}.bind(this);this._createOption(s,o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.start-option")),o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.start-option-description")),"start-option",(function(e){u.children().detach(),u.append(p);var t=gDesigner.getSetting("show_welcome_screen"),i="boolean"!=typeof t||t;e||n._isSpectatorMode()||gDesigner.stats("newdocumentdialog_click_newdesign"),$("<div></div>").addClass("footer-section").append($("<label></label>").text(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.start-option-check"))).append($("<input>").attr("type","checkbox").prop("checked",!i).on("change",e=>{gDesigner.stats("newdocumentdialog_toggle_show-welcome-screen",i?"enable":"disable"),gDesigner.setSetting("show_welcome_screen",!$(e.target).is(":checked"))}))).appendTo(u),n._isSpectatorMode()||y(".start-option")})),this._createSeparator(s,"templates-option"),this._createOption(s,o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-option")),o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-option-description")),"templates-option",(function(e){if(n._isSpectatorMode())return;const t=function(){u.children().detach(),y(".templates-option"),e||gDesigner.stats("newdocumentdialog_click_templates"),gDesigner.getUser().then(e=>{let t=e=>{if(u.children().detach(),!e)return u.removeClass("loading"),void _();f?u.append(f):(f=$("<div/>"),u.append(f),n._loadTemplates(f))};e?t(e):r.LOGIN_DIALOGS.POPUP?g.performLogin().then(t):n._createCloudLoginFrame("template",t,u)})};gDesigner.isOffline()?l.default.openUnavailableFeature(t):t()})),this._createSeparator(s,"cloud-option"),this._createOption(s,o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-option")),o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-option-description")),"cloud-option",(function(e,t,i,o,a,s){const c=function(){e||gDesigner.stats("newdocumentdialog_open_cloudfiles"),n._openFromCloud?(u.children().detach(),u.addClass("loading"),y(".cloud-option"),h.isMaximized().then(e=>{e&&u.closest(".g-dialog-container").addClass("fullscreen")}),gDesigner.getUser().then(e=>{let l=e=>{if(u.children().detach(),!e)return u.removeClass("loading"),void n.close();m||(m=$("<div/>").addClass("cloud-workspace")),u.append(m),m.empty(),n._loadCloudFiles(m,t,i,o,a,s)};e?l(e):r.LOGIN_DIALOGS.POPUP?g.performLogin().then(l):n._createCloudLoginFrame("cloud",l,u)})):new v(()=>{let e={closable:!0,showCloudOptions:!0,openFromCloud:!0,closeCallback:()=>{n._parentDialogInstance&&n._parentDialogInstance.close()}};new w(n).open(e)})};return gDesigner.isOffline()?l.default.openUnavailableFeature(c):c()})),this._createSeparator(s,"local-option"),this._createOption(s,o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.local-option")),o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.local-option-description")),"local-option",function(e){e||gDesigner.stats("newdocumentdialog_click_opendocument"),this._openDocument()}.bind(this),!0),this._createSeparator(s,"recent-option");var b=this._createOption(s,o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.recent-option")),o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.recent-option-description")),"recent-option",function(e){e||gDesigner.stats("newdocumentdialog_click_recent");var t=$("<div></div>").gOverlay({releaseOnClose:!0,clazz:"g-recent-documents",padding:!1}),n=$("<div></div>").addClass("menu").appendTo(t),i=gContainer.getRecentDocuments();i&&i.length?i.forEach(e=>{var t=gContainer.getRecentDocumentIconClass(e);$("<div></div>").addClass("item file").data("file",e).on("click",async e=>{gDesigner.stats("newdocumentdialog_click_openrecentdocument");try{gDesigner.openDocument($(e.target).closest(".file").data("file"))}catch(e){if(!(e instanceof d.default))throw this.close(),e;c.default.externalFileError(!0)}this.close()}).append($("<div/>").addClass("icon").addClass(t||"")).append($("<div/>").addClass("name").append(e.getName()+"."+e.getExtension().toLowerCase())).appendTo(n)}):$("<div></div>").addClass("item").append(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.recent-option-empty"))).appendTo(n);var r=b.offset().left+b.width()-10,a=b.offset().top-t.height();t.gOverlay("open",{x:r,y:a})}.bind(this),!0);this._createSeparator(s),r.LICENSE.UPGRADEABLE&&$("<div></div>").addClass("activate-trial").css("display",gDesigner.getApplicationManager().isLicenseUpgradeable()?"":"none").append($("<div></div>").addClass("title").html(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.try-out-pro")))).append($("<div></div>").addClass("subtitle").html(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.start-free-trial")))).on("click",()=>gDesigner.activateTrialLicense().then(()=>this._updateUI())).appendTo(i);var C=$("<div></div>").addClass("footer").appendTo(i),E=$("<div />").addClass("links-container").appendTo(C),S=$("<div/>").addClass("links-column").appendTo(E),G=$("<div/>").addClass("links-column").appendTo(E),A=$("<div/>").addClass("links-column").appendTo(E),T=0;t.forEach(e=>{e.links.forEach(e=>{var t=$("<div/>").addClass("link");$("<div/>").addClass("link-icon").appendTo(t),$("<a/>").on("click",(function(t){e.statType?gDesigner.stats(e.statType):gDesigner.stats("newdocumentdialog_open_externallink",o.GLocale.get(e.labelLocale,null,o.GLocaleLanguage.English)),e.click?e.click.call(this):gContainer.openExternalLink(t,e.href)})).text(o.GLocale.get(e.labelLocale||e.text)).appendTo(t),T%3==0?t.appendTo(S):T%3==1?t.appendTo(G):t.appendTo(A),++T})}),a.SHOW_BETA_BRANDING&&gDesigner.isBeta()&&$("<div/>").addClass("beta-badge").attr("title","βETA").appendTo(i),this._getVersionInfoWidget().appendTo(i),this._closeCallbackListeners=[],this._dialog.gDialog({closeTimeout:0,releaseOnClose:!1,className:"g-new-document-dialog",closeCallback:e=>{this._closeCallback&&this._closeCallback(e),this._closeCallbackListeners.length&&(this._closeCallbackListeners.forEach(t=>t.call(null,e)),this._closeCallbackListeners=[])},alwaysCloseable:!0}),document.addEventListener("keydown",function(e){13===e.keyCode&&this._dialog.gDialog("isOpen")&&this._newDocumentCustomSize()}.bind(this))}o.GObject.inherit(w,o.GObject),w.prototype._getVersionInfoWidget=function(){let e="";"lts"===gDesigner.getEnv()?e=" LTS":"rc"===gDesigner.getEnv()&&(e=" RC");const t=_.getRuntime();return t&&(e+=" ".concat(t.abbr)),$("<div/>").addClass("version").html(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.version"))+" "+gDesigner.getVersionFriendlyName()+e).on("click",(function(){if(gDesigner.stats("newdocumentdialog_show_gravitversion"),"production"!==gDesigner.getEnv()&&"lts"!==gDesigner.getEnv()&&"rc"!==gDesigner.getEnv()){var t=$(this),n=t.data("nfo");n||t.data("nfo",n={current:0}),function(n){switch(n.current=(n.current+1)%4,n.current){case 0:t.html(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.version"))+" "+gDesigner.getVersionFriendlyName()+e);break;case 1:t.html(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.internal-version"))+": "+gDesigner.getVersion());break;case 2:t.html(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.build"))+": "+(gDesigner.getBuildNum()||""));break;case 3:t.html(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.commit"))+": "+(gDesigner.getCommitSHA()||"").substr(0,8))}}(n)}}))},w.prototype._licenseChangedEvent=function(e){this._updateUI()},w.prototype._updateUI=function(){if(r.LICENSE.UPGRADEABLE){const e=gDesigner.getApplicationManager().isLicenseUpgradeable();this._dialog.find(".activate-trial").css("display",e?"":"none"),this._dialog.find(".sidebar").toggleClass("on-pro",!e)}this._dialog.find(".templates-option").css("display",gDesigner.isOffline()?"none":""),this._dialog.find(".cloud-option").css("display",gDesigner.isOffline()?"none":""),this._updateForUserLicense()},w.prototype.getDialogElement=function(){return this._dialog},w.prototype._updateForUserLicense=function(){const e=this._dialog.find(".header"),t=this._dialog.find(".presets-frame"),n=e.find(".preset .g-input"),i=t.find(".presets .preset");if(!this._isSpectatorMode())return this._dialog.find(".start-option").removeClass(this._spectatorModeClazz).removeAttr("data-title"),this._dialog.find(".templates-option").removeClass(this._spectatorModeClazz).removeAttr("data-title"),t.removeClass(this._spectatorModeClazz),e.removeClass(this._spectatorModeClazz),e.find(".select-overlay").remove(),n.find("input").removeAttr("readonly").removeAttr("disabled").removeAttr("data-title"),n.find("select").removeAttr("disabled").removeAttr("data-title").removeClass("g-disabled"),n.find(".cloud-button").removeAttr("disabled").removeAttr("data-title").removeClass("g-disabled").addClass("active"),i.find(".icon").removeAttr("data-title"),void i.find(".select-container").removeAttr("data-title");const r=o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.option-not-available-in-view-mode"));this._dialog.find(".start-option").addClass(this._spectatorModeClazz).attr("data-title",r),this._dialog.find(".templates-option").addClass(this._spectatorModeClazz).attr("data-title",r),t.addClass(this._spectatorModeClazz),e.addClass(this._spectatorModeClazz),n.find("input").attr("readonly",!0).attr("disabled",!0).attr("data-title",r),n.find("select").attr("disabled",!0).attr("data-title",r).addClass("g-disabled").insertAfter(),n.find(".cloud-button").attr("data-title",r).addClass("g-disabled").removeClass("active"),i.find(".icon").attr("data-title",r),i.find(".select-container").attr("data-title",r),e.find(".select-overlay").length||$("<div>").addClass("select-overlay").attr("data-title",r).insertAfter(e.find(".preset .g-input select"))},w.prototype._createOption=function(e,t,n,i,o,r){var a=$("<div/>").addClass("option").addClass(i).on("click",function(e,t,n,i,s,l){this._dialog.find(".frame").removeClass("loading"),r||(this._dialog.find(".sidebar-options").find(".option-separator").removeClass("active"),$(a).prevAll(".option-separator:visible").first().addClass("active"),$(a).nextAll(".option-separator:visible").first().addClass("active")),o(!0&e.isTrigger,t,n,i,s,l)}.bind(this)).appendTo(e);$("<div/>").addClass("option-icon").appendTo(a);var s=$("<div/>").addClass("option-text").appendTo(a);return $("<div/>").addClass("option-title").html(t).appendTo(s),$("<div/>").addClass("option-subtitle").html(n).appendTo(s),a},w.prototype._createFooter=function(){return[{section:o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.connect")),links:[{href:"https://www.designer.io/en/blog",labelLocale:new o.GLocaleKey("GNewDocumentDialog","text.blog")},{href:"https://www.designer.io/changelog",labelLocale:new o.GLocaleKey("GNewDocumentDialog","text.changelog")},{href:"",labelLocale:new o.GLocaleKey("GNewDocumentDialog","text.example-files"),statType:"newdocumentdialog_click_example-files",click:()=>{const e=()=>(new w).open({closable:!0,openFromCloud:!0,showCloudOptions:!0,nativeCloud:!0,showExampleFiles:!0});gDesigner.isOffline()?l.default.openUnavailableFeature(e):e()}},{href:"https://discuss.gravit.io",labelLocale:new o.GLocaleKey("GNewDocumentDialog","text.discuss")},{href:y,labelLocale:new o.GLocaleKey("GOpenLinkAction","title.tutorials")},{href:"http://documentation.designer.io",labelLocale:new o.GLocaleKey("GOpenLinkAction","title.user-guide")}]}]},w.prototype._createSeparator=function(e,t){$("<div/>").addClass("option-separator").addClass(t).appendTo(e)},w.prototype._createPresetsFrame=function(){var e=$("<div></div>").addClass("presets-container"),t=$("<div/>").addClass("header").appendTo(e),n=$("<div></div>").addClass("presets").appendTo($("<div/>").addClass("presets-frame").appendTo(e));m.getPresets(!0).forEach((e,t)=>{$("<div/>").addClass("preset").data("preset",e).append($("<p/>").addClass("title").text(e.name)).append($("<div/>").addClass("icon").on("click",t=>{this._isSpectatorMode()||this._showPresetDropdown(t,e)}).append($("<img/>").attr("src","assets/img/new-document/"+e.icon+"-white.svg")).append($("<img/>").attr("src","assets/img/new-document/"+e.icon+"-black.svg").addClass("hover"))).append($("<div/>").addClass("select-container").append([$("<p/>").addClass("name").text(e.subTitle).on("click",t=>{this._isSpectatorMode()||this._showPresetDropdown(t,e)})])).appendTo(n)}),$("<div/>").addClass("preset").append($("<p/>").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-option")))).append($("<div/>").addClass("icon").on("click",()=>{this._isSpectatorMode()||this._dialog.find(".sidebar-options").find(".templates-option").trigger("click")}).css("padding-bottom","42px").append($("<img/>").attr("src","assets/img/new-document/preset-templates-white.svg")).append($("<img/>").attr("src","assets/img/new-document/preset-templates-black.svg").addClass("hover"))).appendTo(n);var i=e=>13===e.keyCode?this._newDocumentCustomSize():void 0;return $("<div/>").addClass("preset custom-size").append($("<div/>").addClass("g-input").on("click",e=>e.stopPropagation()).append($("<div/>").addClass("input-holder").append($("<div/>").append($("<input/>").on("keydown",i).attr("name","width").attr("placeholder",o.GLocale.get(new o.GLocaleKey("GCommonNames","text.width"))).val("").gInputBox({minValue:0,incrementValue:1,allowEmptyValue:!0})).append($("<img/>").addClass("versus").attr("src","assets/icon/versus.svg")).append($("<input/>").on("keydown",i).attr("name","height").attr("placeholder",o.GLocale.get(new o.GLocaleKey("GCommonNames","text.height"))).val("").gInputBox({minValue:0,incrementValue:1,allowEmptyValue:!0})))).append($("<select/>").attr("name","unit").val("px").gUnit({short:!0})).on("change",(function(e){var t=$(this).find(":selected").val()||"px";"undefined"!=typeof gDesigner&&gDesigner.stats("newdocumentdialog_change_unit",t)})).append($("<img/>").addClass("result").attr("src","assets/icon/result.svg")).append($("<button/>").addClass("cloud-button").append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","action.create-canvas")))).addClass("active").on("click",()=>{this._isSpectatorMode()||this._newDocumentCustomSize()}))).append($("<p/>").addClass("infinite-canvas").text(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","action.leave-empty-infinite")))).appendTo(t),a.NEWDOCUMENTDIALOG.HR_UNDER_PRESETS&&$("<hr/>").appendTo(t),e},w.prototype._createCloudLoginFrame=function(e,t,n){if(0===$(n).children().length){n.removeClass("loading");var i=$("<div/>").addClass("cloud-login").addClass(e),r="template"===e;$("<div/>").addClass("cloud-logo").addClass(e).appendTo(i);var a=r?o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-login-title")):o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-login-title")),s=r?o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-login-phrase1")):o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-login-phrase1")),l=r?o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.templates-login-phrase2")):o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-login-phrase2"));$("<div/>").html(a).addClass("title").addClass(e).appendTo(i),$("<div/>").html(s).addClass("subtitle").addClass("first").addClass(e).appendTo(i),$("<div/>").html(l).addClass("subtitle").addClass("second").addClass(e).appendTo(i),$("<div/>").addClass("login-buttons").append($("<div/>").addClass("g-button cloud-login-button").addClass("login").html(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-login"))).on("click",(function(){g.performLogin().then((function(e){t&&t(e)}))}))).append($("<div/>").addClass("g-button cloud-login-button").html(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.cloud-signup"))).on("click",(function(){g.performSignup().then((function(e){t&&t(e)}))}))).appendTo(i),n.append(i)}},w.prototype._loadCloudFiles=function(e,t,n,i,o,r){this.handled=!1;var a=new h({parentComponent:e,closeCallback:async function(e){this.handled=!0,await this.close(),this._parentDialogInstance&&await this._parentDialogInstance.close(),e||n&&n()}.bind(this),documentToSave:t,cancelSave:async function(){this.handled=!0,await this.close(),n&&n()}.bind(this),defaultFilename:i,readyStateChange:this.readyStateChange,nativeCloud:o,showExampleFiles:r}),s=()=>{var e=this._closeCallbackListeners.indexOf(s);this._closeCallbackListeners.splice(e,1),this.handled||n&&n(),a.handleParentClose()};this._closeCallbackListeners.push(s)},w.prototype._loadTemplates=function(e){new f(e,function(){this.close()}.bind(this))},w.prototype.open=function(e){let{closable:t,cb:n,showCloudOptions:i,openFromCloud:o,defaultOption:r,newOrFromTemplate:a,documentToSave:s,cancelSaveCallback:l,defaultFilename:c,closeCallback:d,nativeCloud:u,showExampleFiles:p}=e;this._cb=n||null,this._closeCallback=d,this._openFromCloud=o;g.isOnline();var h=function(){this._dialog.find(".sidebar").css("display",""),this._dialog.find(".sidebar-options").find(".option").css("display",""),this._dialog.find(".sidebar-options").find(".option-separator").css("display",""),this._dialog.find(".sidebar").find(".footer").css("display",""),this._dialog.find(".sidebar").find(".version").css("display","")}.bind(this),f=function(){this._dialog.find(".cloud-option").css("display",i?"":"none"),this._dialog.find(".option.start-option").trigger("click"),this._dialog.find(".frame").removeClass("cloud-frame"),this._dialog.find(".g-dialog-content").removeClass("cloud-dialog"),this._dialog.parent().removeClass("cloud-files-dialog"),i&&o&&(this._dialog.find(".sidebar").css("display","none"),this._dialog.addClass("cloud-dialog"),this._dialog.parent().addClass("cloud-files-dialog"),this._dialog.find(".frame").addClass("cloud-frame"),this._dialog.find(".cloud-option").trigger("click",[s,l,c,u,p])),r&&this._dialog.find("."+r).trigger("click")}.bind(this);this._dialog.gDialog("open",t),h(),f(),this._updateUI(),this._closeCallbackListeners.push(()=>{gDesigner.removeEventListener(b,this._licenseChangedEvent,this)}),gDesigner.addEventListener(b,this._licenseChangedEvent,this)},w.prototype.saveCloudFile=function(e,t,n,i,o){let r={closable:!0,showCloudOptions:!0,openFromCloud:!0,cancelSaveCallback:t,documentToSave:e,defaultFilename:n,nativeCloud:o};this.readyStateChange=i,this.open(r)},w.prototype.isOpen=function(){return this._dialog.gDialog("isOpen")},w.prototype.close=function(){return this._dialog.parent().removeClass("cloud-files-dialog"),this._dialog.gDialog("close",!1,0),(0,s.sleep)(0)},w.prototype._newDocumentFromPreset=async function(e,t,n){var i=this._dialog.find(".frame"),a=e.layouts[t];if(gDesigner.stats("newdocumentdialog_new_document-from-preset",n||(a.localeClass?o.GLocale.get(a.localeClass,null,o.GLocaleLanguage.English):a.name),!1,!0),a.template)try{i.addClass("loading");var s=new u,l=await r.gApi.getPresetTemplate({type:a.template});i.removeClass("loading"),gDesigner.addDocument(s),s.setDocumentFromTemplate(!0),s.loadFromData(l.data),this.close(),this._cb&&this._cb()}catch(e){i.hasClass("loading")&&i.removeClass("loading"),this._newDocument(a.width,a.height,a.unit,a.dpi)}else this._newDocument(a.width,a.height,a.unit,a.dpi)},w.prototype._newDocumentCustomSize=function(){gDesigner.stats("newdocumentdialog_new_custom-sized");var e=this._dialog.find(".preset.custom-size"),t=e.find('[name="width"]').gInputBox("value"),n=e.find('[name="height"]').gInputBox("value"),i=e.find('[name="unit"]').val(),o=""===t,r=""===n,a=o?0:parseInt(t),s=r?0:parseInt(n);isNaN(a)||isNaN(s)||!i||!a&&!o||!s&&!r||this._newDocument(t,n,i)},w.prototype._newDocument=function(e,t,n,i){var r=gDesigner.createScene();r.setProperties(["ut","dpi"],[n,i||o.GLength.DPI]),r.getActivePage().setProperties(["bck","w","h"],[o.GRGBColor.WHITE,new o.GLength(e,n).toPoint(),new o.GLength(t,n).toPoint()]),gDesigner.addDocument(new u(r)),this.close(),this._cb&&this._cb()},w.prototype._openDocument=function(){gDesigner.executeAction(p.ID,[null,this.close.bind(this)],void 0,!0)},w.prototype._getLayoutFormattedSize=function(e){var t=e.includes,n="";if(t){for(var i=[],o=0,r=t.length;o<r;o++){var a=t[o];i.push(a.width+"x"+a.height)}n=i.join(", ")+" "+e.unit}else n=e.width+"x"+e.height+" "+e.unit;return n},w.prototype._showPresetDropdown=function(e,t){e.stopPropagation();var n=$(e.target).closest(".preset").find(".name"),i=$("<ul/>");t.layouts.forEach((e,n)=>{var r=$("<li/>").attr("data-value",n).text(e.name+" ("+this._getLayoutFormattedSize(e)+")").on("click",e=>{i.gOverlay("close");var n=parseInt($(e.target).attr("data-value")),r="";r=t.localeClass?o.GLocale.get(t.localeClass,null,o.GLocaleLanguage.English):t.name||"",r=t.layouts[n].localeClass?r+"/"+o.GLocale.get(t.layouts[n].localeClass,null,o.GLocaleLanguage.English):r+"/"+t.layouts[n].name,"undefined"!=typeof gDesigner&&gDesigner.stats("newdocumentdialog_change_preset",r),this._newDocumentFromPreset(t,n,r)});i.append(r)}),i.gOverlay({clazz:"preset-select",padding:!1,offsetY:10}),i.gOverlay("open",n)},w.prototype._isSpectatorMode=function(){return!1},e.exports=w},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GFilesPanelViewBase",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"GFilesPanelViewNative",{enumerable:!0,get:function(){return o.default}}),t.default=void 0;var o=i(n(1418)),r=i(n(1183)),a={GFilesPanelViewNative:o.default,GFilesPanelViewBase:r.default};t.default=a},function(e,t,n){"use strict";n(19),n(24);var i=n(17);n(28),n(84),n(14),n(759),n(261),n(29),n(321),n(3),n(83),n(9),n(115);var o=n(1),r=n(16),a=i(n(1183)),s=n(1051),l=n(32),c=n(534),d=i(n(36)),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var a=o?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=e[r]}i.default=e,n&&n.set(e,i);return i}(n(771)),p=n(766);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}const h=n(151),{CLOUD_DIALOG:f}=n(12),{GPlatform:m}=n(16),y=n(76),{GRegex:v}=n(238),_=function(){a.default.apply(this,arguments),this._lockEnter=!1,this.panel.addClass("full-width")};o.GObject.inherit(_,a.default);var b=n(217),w=n(308);_.prototype._lockEnter=!1,_.prototype.filesPanel=null,_.prototype.createHeader=function(){var e=this,t=$("<div/>").addClass("header").appendTo(this.panel);this.renderNewFolderButton(t,()=>{var t=e.filesPanel.drive.getCurrentFolder();if(!t||e.filesPanel.drive.isRootFolder())return e.filesPanel.updateFilesList();e._cloudFolders.forEach(e=>{e.getFolder().id===(t.id||t)&&e.refresh()})});var n="";$("<div />").addClass("search-container").append($("<input />").addClass("search-field").attr("type","text").attr("size","12").attr("placeholder",o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.search-placeholder"))).on("keyup",(function(t){t.stopPropagation();var i=$(this).val().trim();i!==n&&(n=$(this).val(),gDesigner.stats("filespanel-view_execute_search",i),e.filesPanel.search(i));var o=e.panel.find(".header").find(".search-container").find(".clear-search-icon"),r=e.panel.find(".header").find(".search-container").find(".search-icon");i.length?(o.show(),r.hide()):(o.hide(),r.show())})).on("focusin",(function(){e.panel.find(".header").find(".search-container").toggleClass("g-active",!0)})).on("focusout",(function(){e.panel.find(".header").find(".search-container").toggleClass("g-active",!1)})).on("input:reset",(function(){$(this).val(""),n="",e.panel.find(".header").find(".search-container").find(".clear-search-icon").hide()})).on("keydown",(function(t){if(r.GKey.translateCode(t.key)===r.GKey.Constant.TAB){var n=$(this).val().trim();e.filesPanel.search(n),t.preventDefault(),t.stopPropagation()}}))).append($("<div />").addClass("clear-search-icon").append($("<span />").addClass("icon").addClass("gravit-icon-close")).on("click",(function(t){t.stopPropagation();var i=e.panel.find(".header").find(".search-container").find(".search-field"),o=e.panel.find(".header").find(".search-container").find(".search-icon");i.val(""),n="",e.filesPanel.updateFilesList(!1,!1),gDesigner.stats("filespanel-view_clear_search-field"),$(this).hide(),i.focus(),o.show()})).hide()).append($("<div />").addClass("search-icon").append($("<span />").addClass("icon").addClass("gravit-icon-magnifier")).on("click",(function(t){t.stopPropagation(),gDesigner.stats("filespanel-view_search_focus"),e.panel.find(".header").find(".search-container").find(".search-field").focus()}))).appendTo(t),$("<div/>").addClass("fake").appendTo(t),this.renderSortButton(t);const i=this.filesPanel.getAvailableFileTypesFilter();"function"==typeof u.default&&this.filesPanel.drive instanceof u.default&&i&&i.length>1&&this.renderFileTypeFilterButton(t),this.renderGridStyleButtons(t),this._buildContextMenu(),this._buildAdditionalContextMenu()},_.prototype._permissionChanged=function(){a.default.prototype._permissionChanged.call(this);const e=this.panel.find(".header").find(".new-folder");if(this._isCreateFolderEnabled())e.attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.new-folder-tooltip"))),e.removeClass("g-disabled");else{const t=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.option-isnt-available"),"This option isn’t available for Cloud Drives");e.attr("data-title",t),e.addClass("g-disabled")}},_.prototype.addSearchBar=function(e){$("<div />").addClass("g-search-no-results").hide().text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.search-not-found"))).appendTo(e)},_.prototype.createFooter=function(e){var t=$("<div/>").addClass("footer").appendTo(this.panel);if(this.filesPanel.isSaveMode()){var n=$("<div />").addClass("save-form-container").appendTo(t);const r=$("<div/>").addClass("input-container").appendTo(n);var i=$("<input/>").addClass("file-name").val(e?(0,l.decodeHTML)(e):o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.untitled"))).appendTo(r);const a=m.webBrowser===m.constructor.WebBrowser.Safari,s=gContainer.getRuntime()===y.Runtime.IPad;(a||s)&&i.on("click",()=>{i.focus()}),$("<div/>").addClass("g-button").addClass("cloud-button").addClass("cancel").attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.cancel-tooltip"))).html(o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))).on("click",function(e){e.stopPropagation(),this.filesPanel.handleCancelSave()}.bind(this)).appendTo(r),this.filesPanel.setKeyListener((e,t)=>{if(13===e&&!this._lockEnter){const e=this._getSelectedExtension(),n=this._getSaveOptions();if(!this.filesPanel._canDownload(e))return;t.preventDefault(),this.filesPanel.handleSave(i.val(),e,n)}}),gDesigner.getApplicationManager().isSavingToCloudEnabled()&&gDesigner.getApplicationManager().isSavingAsEnabled()&&$("<div/>").addClass("g-button").addClass("cloud-button").addClass("primary").addClass("save").append($("<span/>").addClass("icon").addClass("gravit-icon-w-save")).append($("<span/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GSaveAction","title")))).on("click",function(e){e.stopPropagation();const t=this._getSelectedExtension(),n=this._getSaveOptions();this.filesPanel._canDownload(t)&&this.filesPanel.handleSave(i.val(),t,n)}.bind(this)).appendTo(r),this._setSelectedExtension(u.DEFAULT_TYPE.ext),this.panel.find(".g-items-container").addClass("g-items-container-footer"),i.focus()}else t.hide()},_.prototype._getSelectedExtension=function(){const e=this.panel.find(".save-form-container").find("option:selected").val();if(!e)return this.filesPanel.getDefaultSaveFormat()&&this.filesPanel.getDefaultSaveFormat().ext||u.DEFAULT_TYPE.ext;const t=this.filesPanel.getPossibleExtensions();return(0,l.getExtensionFromString)(e,t)||u.DEFAULT_TYPE.ext},_.prototype._getSelectedVersion=function(){const e=this.panel.find(".save-form-container").find("option:selected").val();if(!e)return Number(this.filesPanel.getDefaultVersionForSave());const t=this._getVersionFromValue(e);return Number(t||this.filesPanel.getDefaultVersionForSave())},_.prototype._setSelectedExtension=function(e){this.panel.find('select.file-extension > option[value="'.concat(e.toUpperCase(),'"]')).prop("selected",!0)},_.prototype._removeCDRExtensionFromFileName=function(e){return e.endsWith(".cdr")?e.replace(new RegExp(".cdr$"),""):e},_.prototype.addFile=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this._removeCDRExtensionFromFileName(e.name);var r=this,a=this.filesPanel.isItemSelected(e),c=this.filesPanel.isItemInClipboard(e),d=null;d=t?this.panel.find(".g-recent-files-list"):n?this.panel.find(".g-example-files-list"):this.panel.find(".g-files-list");var u=$("<div/>").attr("draggable",e.hasPermission(h.Permission.CutPaste)).attr("id",e.id).addClass("g-gravit-file").addClass("g-cloud-element").addClass(e.id).addClass(a?"selected":"").addClass(c&&this.filesPanel.isClipboardModeCut()?"cut":"").data("node",e).attr("data-title",e._rootPath?e._rootPath:i).on("dragstart",(function(t){if(r._isDuringRenaming())return t.stopPropagation(),void t.preventDefault();$(this).addClass("dragging"),$(".g-tooltip").toggleClass("visible",!1);const n=t.dataTransfer||t.originalEvent.dataTransfer,i=document.createElement("div"),o=$(i);o.addClass("drag-ghost-item"),o.text(e.name),document.getElementById(e.id).appendChild(i),n.setDragImage(i,30,15),n.setData("text/plain",JSON.stringify(e))})).on("drag",(function(e){if(r._isDuringRenaming())return e.stopPropagation(),void e.preventDefault();$(".g-tooltip").toggleClass("visible",!1)})).on("dragend",(function(){$(this).removeClass("dragging")})).on("dblclick",function(t){if(t.stopPropagation(),t.preventDefault(),!r._isDuringRenaming())return this.filesPanel.handleFileDblClick(e),!1}.bind(this)).on("click",function(n){n.stopPropagation(),n.preventDefault(),r._isDuringRenaming()||(this.filesPanel.handleFileClick(e,u),this._updateFileInfoPanel(e,u,t))}.bind(this)).on("contextmenu",function(t){t.stopPropagation(),r._handleFileContextMenu(e,u,t)}.bind(this));e.example&&u.addClass("g-gravit-example-file");var g=d.find("#".concat(e.id));g.length?$(g).replaceWith(u):u.appendTo(d);var m,y,v=$("<div />").addClass("image-container").appendTo(u);this.filesPanel.getSortType()===p.GFilesPanelSortTypes.CREATED?(m=(0,s.dateToFilePreviewFormat)(e.created?e.created:e.updated),y=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.created"))):(m=(0,s.dateToFilePreviewFormat)(e.updated?e.updated:e.created),y=o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.updated")));var _=e instanceof h&&e.getSize(),b="";if(_&&f.SHOW_FILE_SIZE_INFO){var w=(0,l.getSizeInfo)(_);w.gb?b+=(b?"":" ")+"".concat(w.gb," GB"):w.mb?b+=(b?"":" ")+"".concat(w.mb," MB"):w.kb?b+=(b?"":" ")+"".concat(w.kb," KB"):b+=(b?"":" ")+"< 1 KB"}var C=null;e instanceof h&&(C=e.getPreviewURL()),C||(C=e.url_t||e.url_s),C?v.css("background-image","url(".concat(C,")")):v.addClass("default-preview");var E=$("<div/>").addClass("name-container").appendTo(u);$("<div />").addClass("file-name-container").append($("<div />").addClass("name").text(i)).append($("<input />").attr("type","text").css("display","none").addClass("file-name").val(i).css("width",$(this).parent().find(".name").outerWidth())).appendTo(E),this._updateFileNamePreview(u,e),$("<div />").addClass("file-updated").attr("data-title","".concat(y," ").concat(m).concat(b?", "+b:"")).text("".concat(y," ").concat(m).concat(b?", "+b:"")).appendTo(u);var S=$("<div />").addClass("file-top-tile").appendTo(u);return this._isContextMenuAvailableForFile(e)&&$("<div />").addClass("file-context").append($("<span />").addClass("icon").addClass("gravit-icon-w-kebab").on("mouseover",(function(e){e.stopPropagation()}))).on("click",function(t){t.stopPropagation(),r._handleFileContextMenu(e,u,t)}.bind(this)).on("dblclick",(function(e){e.stopPropagation()})).on("mouseover",(function(e){e.stopPropagation()})).appendTo(S),e.hasPermission(h.Permission.Open)&&!this.filesPanel.isSaveMode()&&$("<button />").addClass("open-design-button g-button cloud-button").text(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.open-design"))).on("click",t=>{t.stopPropagation(),e.example||gDesigner.stats("filespanel-view_open_cloudfile"),this.filesPanel.openFile(e)}).appendTo(S),u},_.prototype._handleFileContextMenu=function(e,t,n){this._isContextMenuAvailableForFile(e)&&(gDesigner.stats("filespanel-view_context_cloudfile"),this.filesPanel.isItemSelected(e)||this.resetSelection(!0),this._addToSelection(t),this._openContextMenuForEventPosition(n))},_.prototype._updateFileNamePreview=function(e,t){const n=this._removeCDRExtensionFromFileName(t.name);var i=$(e).find(".file-name-container");i.attr("data-ending","..."+n.substr(n.length-4));var o=i.find(".name");o.text(n),(e=>e&&e.offsetWidth<e.scrollWidth)(o[0])&&i.addClass("ending")},_.prototype.addFolder=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._factoryFolder(e,t).getHTMLContainer().appendTo(this.panel.find(".g-folders-list.main"))},_.prototype.addCustomFolder=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._factoryFolder(e,t).getHTMLContainer().appendTo(this.panel.find(".g-folders-list.custom-folders")),"shared_files_with_me"===e.id&&("shared_files_with_me"===this.filesPanel.drive.getCurrentFolder().id?this.hideFileTypeFilterButton():this.displayFileTypeFilterButton())},_.prototype.scrollToSelectedElement=function(e){var t=null;return this.panel.find(".g-files-list").find(".g-gravit-file").each(function(n,i){if($(i).data("node").id===e.id)return t=$(i).data("node"),setTimeout(()=>{this.panel.find(".g-items-container").scrollTop($(i).position().top)}),!1}.bind(this)),t},_.prototype.updateControls=function(e){this.panel.find(".g-gravit-folder").length>0?this.panel.find(".g-folders-list").show():this.panel.find(".g-folders-list").hide();const t=this.panel.find(".header"),n=t.find(".new-folder"),i=t.find(".back");this.getSearchValue()?(n.addClass("g-disabled"),i.addClass("g-hidden"),this.panel.find(".g-files-list").find(".g-gravit-file").length<1&&this._showNoResultsInfo()):this._isCreateFolderEnabled()&&n.removeClass("g-disabled"),this.filesPanel.isRootFolder()?i.addClass("g-hidden"):i.removeClass("g-hidden"),e&&this.filesPanel.isSaveMode()&&this.panel.find(".footer").find("input.file-name").select()},_.prototype._showNoResultsInfo=function(){this.panel.find(".g-search-no-results").show()},_.prototype._checkItemPermission=function(e,t){return(e instanceof Array?e:[e]).every(e=>e instanceof h?e.hasPermission(t):(console.error("Wrong check for file permission",e),!0))},_.prototype._openContextMenuForEventPosition=function(e){var t=e.pageX,n=e.pageY;this._contextMenu.open({x:t,y:n})},_.prototype._renameFile=function(e,t,n){const i=this._removeCDRExtensionFromFileName(e.name),a=this;a.toggleLoading(!1);var s=t.find("input");s.off("focusout"),s.off("keypress");var l=t.find("div.name");t.addClass("renaming"),$(t).attr("data-title",i),l.text(i),s.css("width",l.outerWidth()),s.val(i),$(t).find(".file-name-container").removeClass("ending"),s.css("width",l.outerWidth());var c=s.val(),u=!1;s.show(),l.hide(),s.focus();const p=t=>{let n;return n=e.getType()===h.Type.File?o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.file-already-exists-on-current-location")).replace("%filename",'"'.concat(t,'"')):o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.folder-already-exists-on-current-location")).replace("%foldername",'"'.concat(t,'"')),new Promise(e=>{d.default.confirm(n,t=>e(!!t),null,null,!1,!0,!0)})};var g=async function(){try{s.hide(),l.show();let i,r=s.val();if(e.getType()===h.Type.File&&!a._isUserInputValidFileName(r))return d.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.new-file-name-invalid"))),void s.val(c);if(r.trim()&&r.trim()!==e.name){a.toggleLoading(!0);try{let o=0;const s=e.ext||e.extension;if(a.filesPanel.drive.supportsSaveCollisionFlow())if(e.getType()===h.Type.File){if(await a.filesPanel.drive.fileExists(r,s,e.parent||a.filesPanel.drive.getRootFolder())&&!await p(r))return a._renameFile(e,t,n);if(a.filesPanel.drive.requiresOverwriteCollisionHandling())for(i=r;await a.filesPanel.drive.fileExists(i,s,e.parent||a.filesPanel.drive.getRootFolder());)i="".concat(r," (").concat(++o,")")}else{if(await a.filesPanel.drive.folderExists(r,e.parent||a.filesPanel.drive.getRootFolder())&&!await p(r))return a._renameFile(e,t,n);if(a.filesPanel.drive.requiresOverwriteCollisionHandling())for(i=r;await a.filesPanel.drive.folderExists(i,e.parent||a.filesPanel.drive.getRootFolder());)i="".concat(r," (").concat(++o,")")}i||(i=r),await a.filesPanel.renameItem(e,i)}catch(e){return a.toggleLoading(!1),e&&e.badName?void d.default.alert(e.message):(s.val(c),void d.default.alert(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.error-renaming"))))}!function(t){const n=gDesigner.getWindows(),i=n&&n.getWindows();if(!i||!i.length)return;for(let n=0,o=i.length;n<o;n++){let o=i[n].getDocument();if(o&&o.getId()===e.id){o.setTitle(t);break}}}(i),e.name=i,s.css("width",l.outerWidth());const u=t=>{$(t).data("node").name=i,$(t).attr("data-title",i),$(t).find("div.name").text(i),a._updateFileNamePreview(t,e)};e.getType()===h.Type.Folder?u(t):$.each(a._rightSide.find(".".concat(e.id)),(e,t)=>{u(t)}),a._fileInfoPanelIsOpen&&a._updateFileInfoPanel(e,t,!1),a.filesPanel._triggerFileRenamed(e),a.toggleLoading(!1),n&&n()}else s.val(c)}catch(e){throw console.log("err changing the name",e),e}};s.on("focusout",(function(){u||(g(),u=!0),t.removeClass("renaming")})).on("keypress",(function(e){const n=e.which||e.charCode||e.keyCode;r.GKey.translateKey(n)!==r.GKey.Constant.ENTER||u||(gDesigner.stats("filespanel-view_update_cloudfile-name"),g(),u=!0),t.removeClass("renaming")}))},_.prototype._updateMenuItemCaption=function(e,t){this.filesPanel.getSelection().length>1?e.setCaption(o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.selection-multiple")).replace("%selection",t).replace("%multiple",o.GLocale.get(new o.GLocaleKey("GFilesPanel","text.multiple")))):e.setCaption(t)},_.prototype._isFolderSelected=function(){var e=this.filesPanel.getSelection();return 1===e.length&&e[0].getType()===h.Type.Folder},_.prototype._getNativeMenuItems=function(){return[{caption:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.open")),click:()=>{if(this._isFolderSelected()){gDesigner.stats("filespanel-view_open_cloudfolder");var e=this.filesPanel.getSelection(),t=this._getSelectedFolderUIElement();this.filesPanel.navigateToFolder(e[0]),this.filesPanel.manageOpenFolder(t,e[0]),this._expandSelectedFolder()}else{gDesigner.stats("filespanel-view_opencontext_cloud");e=this.filesPanel.getSelection();this.filesPanel.openFile.call(this.filesPanel,e[0])}},update:e=>{var t=this.filesPanel.getSelection();e.sender.setEnabled(1===t.length),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.Open))}},{caption:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.rename")),click:()=>{var e=this.filesPanel.getSelection();gDesigner.stats("filespanel-view_rename_cloud");const t=this._isFolderSelected()?$(".g-gravit-folder.selected"):this._rightSide.find(".selected").eq(0);this._renameFile(e[0],t)},update:e=>{var t=this.filesPanel.getSelection();e.sender.setEnabled(1===t.length),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.Rename))}},{caption:o.GLocale.get(new o.GLocaleKey("GPasteAction","title")),click:()=>{this.filesPanel.isClipboardModeCut()?this.filesPanel.performCutPaste():this.filesPanel.performCopyPaste()},update:e=>{var t=this.filesPanel.getSelection();const n=this.filesPanel.isClipboardModeCut()||this.filesPanel.isClipboardModeCopy();e.sender.setEnabled(n),e.sender.setVisible(this._checkItemPermission(t,h.Permission.CutPaste)||(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t))}},{caption:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.copy")),click:()=>{this.filesPanel.performCopyPaste(p.GFilesPanelClipboardModes.DEFAULT)},update:e=>{var t=this.filesPanel.getSelection();this._updateMenuItemCaption(e.sender,o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.copy"))),e.sender.setEnabled(t.length>0),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.Copy))}},{caption:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.cut")),click:()=>{this.filesPanel.performCutPaste(p.GFilesPanelClipboardModes.DEFAULT)},update:e=>{var t=this.filesPanel.getSelection();this._updateMenuItemCaption(e.sender,o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.cut"))),e.sender.setEnabled(t.length>0),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.CutPaste))}},{caption:o.GLocale.get(new o.GLocaleKey("GDeleteAction","title")),click:()=>{this.filesPanel.handleDelete()},update:e=>{var t=this.filesPanel.getSelection();this._updateMenuItemCaption(e.sender,o.GLocale.get(new o.GLocaleKey("GDeleteAction","title"))),e.sender.setEnabled(t.length>0),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.Delete))}}]},_.prototype._buildContextMenu=function(){this._contextMenu=new b(null,"g-file-panel-context-menu"),this._setContextMenuActiveRangeSize();this._getNativeMenuItems().forEach(e=>{this._contextMenu.createAddItem(e.caption,e.click).addEventListener(w.UpdateEvent,e.update.bind(this))}),this._createContextMenuDownloadMenu()},_.prototype._buildAdditionalContextMenu=function(){},_.prototype._createContextMenuDownloadMenu=async function(){this._contextMenu.createAddItem(o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.download-title")),()=>{1===this.filesPanel.getSelection().length?gDesigner.stats("filespanel-view_download_file"):gDesigner.stats("filespanel-view_download_multiple-files"),this.filesPanel.handleDownload()}).addEventListener(w.UpdateEvent,e=>{var t=this.filesPanel.getSelection();this._updateMenuItemCaption(e.sender,o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.download-title")),t),e.sender.setEnabled(t.length>0),e.sender.setVisible(!(0,c.hasRootFolderInSelections)(this.filesPanel.drive,t)&&this._checkItemPermission(t,h.Permission.Download)&&!this._isFolderSelected())})},_.prototype.toggleFolders=function(e){this.panel.find(".g-left-side").toggleClass("g-no-display",!e)},_.prototype.getSearchValue=function(){const e=this.panel.find(".header").find(".search-container").find(".search-field").val();return e?e.trim():""},_.prototype.focusFileNameInput=function(e){this.setFileNameInputValue(e.name),this.panel.find(".footer").find("input.file-name").focus().select()},_.prototype.setFileNameInputValue=function(e){this.panel.find(".footer").find("input.file-name").val(e)},_.prototype._isDuringRenaming=function(){return!!this.panel.find(".g-gravit-file.selected.renaming").length},_.prototype._expandSelectedFolder=function(){$(".g-gravit-folder.opened .folder-state-icon.closed").click()},_.prototype.setLockEnterState=function(e){this._lockEnter=e},_.prototype._isUserInputValidFileName=function(e){return v.String.ValidFileName.test(e)},_.prototype._getSelectedFolderUIElement=function(){return $(".g-gravit-folder.g-cloud-element.selected")},e.exports=_},function(e,t,n){"use strict";n(9),n(163);const i=n(151);function o(e,t,n){var i;this._folder=e,this._isRootFolder=n,this._container=$("<div/>").addClass("g-container").data("node",e),this._element=i=$("<div/>").addClass("g-gravit-folder").addClass("g-cloud-element").attr("data-title",e.name).data("node",e).appendTo(this._container),this._childrenContainer=$("<div/>").addClass("g-children").appendTo(this._container),this._folderContainer=$("<div/>").addClass("folder-container").appendTo(i),this._folderState=$("<div />").addClass("folder-state-icon").appendTo(this._folderContainer),this._folderIcon=$("<div />").addClass("folder-icon").appendTo(this._folderContainer),$("<div />").addClass("name").text(e.name).appendTo(this._folderContainer),$("<input />").attr("type","text").css("display","none").addClass("folder-name").css("width",this._folderContainer.find(".name").outerWidth()).val(e.name).appendTo(this._folderContainer),this._parent=t,this._folderContext=$("<div/>").addClass("folder-context").append($("<span />").addClass("icon").addClass("gravit-icon-w-kebab").on("mouseover",(function(e){e.stopPropagation()}))).on("mouseover",(function(e){e.stopPropagation()})).appendTo(i),this._update()}o.prototype._isRootFolder=!1,o.prototype._parent=null,o.prototype._container=null,o.prototype._element=null,o.prototype._folderContainer=null,o.prototype._folderContext=null,o.prototype._folder=null,o.prototype._loading=!1,o.prototype._children=null,o.prototype._isOpen=!1,o.prototype._done=!1,o.prototype.isRootFolder=function(){return this._isRootFolder},o.prototype.isLoading=function(){return this._loading},o.prototype.getFolder=function(){return this._folder},o.prototype.getParent=function(){return this._parent},o.prototype.setLoading=function(e){this._loading!==e&&(this._loading=e,this._update())},o.prototype.onToggle=function(e){return this._onToggle=e,this},o.prototype.toggleState=function(){gDesigner.stats("filespanel_expand-collapse_cloudfolder"),this._folderState.removeClass("open"),this._folderState.removeClass("closed"),this._isOpen=!this._isOpen,this._update(),this._onToggle&&this._onToggle(this._isOpen)},o.prototype.isStateOpen=function(){return this._isOpen},o.prototype.update=function(){this._update()},o.prototype.setRefreshHandler=function(e){return this._refreshCallback=e,this},o.prototype.isDone=function(){return this._done},o.prototype.loadChildrenOnDemand=function(e){this.setLoading(!0);const t=(this._children||[]).length;return e(this._folder,100,t).then(e=>{this._done=e.length<100,e.length&&(this._childrenContainer.append(e.map(e=>e.getHTMLContainer())),this._children=this._children.concat(e)),this.update()}).finally(()=>{this.setLoading(!1)})},o.prototype.refresh=function(){return this.setChildren([]),this.update(),this._refreshCallback&&this._refreshCallback(this)},o.prototype._update=function(){this._children&&this._children.length?(this._folderState.addClass(this._isOpen?"open":"closed"),this._isOpen?this._childrenContainer.show():this._childrenContainer.hide()):this._childrenContainer.hide(),this._folderIcon.empty(),this._folderIcon.append($("<div />").addClass("icon").addClass(this._loading?"loading":this._folder.getIcon()||"gravit-icon-w-folder"))},o.prototype.onClick=function(e){return this._folderContainer.on("click",t=>{t.stopPropagation(),e(this._folder,this.getHTMLElement())}),this},o.prototype.onDoubleClick=function(e){return this._folderContainer.on("dblclick",t=>{t.stopPropagation(),e(this._folder,this.getHTMLElement())}),this},o.prototype.onFolderStateClick=function(e){return this._folderState.on("click",t=>{t.stopPropagation(),e(this._folder,this.getHTMLElement())}),this},o.prototype.onContext=function(e){return this._folderContext&&(this._element.on("contextmenu",t=>{t.stopPropagation(),e(this._folder,this.getHTMLElement(),t)}),this._folderContext.on("click",t=>{t.stopPropagation(),e(this._folder,this.getHTMLElement(),t)})),this},o.prototype.onFileDrop=function(e){let t=null,n=this;return this._element.on("drop",(async function(t){$(this).removeClass("drag-over");const o=t.originalEvent.dataTransfer,r=JSON.parse(o.getData("text"));var a=i.from(r);e(a,n._folder)})).on("dragover",(function(e){$(this).addClass("drag-over"),t||(t=setTimeout(()=>{n._isOpen||n._folderState.trigger("click")},1e3))})).on("dragleave",(function(e){$(this).removeClass("drag-over"),t&&clearTimeout(t),t=null})),this},o.prototype.getHTMLContainer=function(){return this._container},o.prototype.setChildren=function(e){this._children=e,this._childrenContainer.empty(),this._children&&this._children.length||(this._isOpen=!1),this._children&&this._children.length&&this._childrenContainer.append(e.map(e=>e.getHTMLContainer()))},o.prototype.getChildren=function(){return this._children},o.prototype.getHTMLElement=function(){return this._element},e.exports=o},function(e,t,n){"use strict";const i=n(1421);function o(){}o.getRenderForFile=function(e){return new i},e.exports=o},function(e,t,n){"use strict";var i=n(17);n(9),n(14),n(29);var o=n(1),r=n(1051),a=i(n(986)),s=i(n(323)),l=n(32),c=n(12);const d=n(0),u=n(1422),p=n(1061);function g(){}d.inherit(g,u),g.prototype.render=async function(e,t){this._createUI(e),await this._updateUIForFile(e,t)},g.prototype._createUI=function(e){$("<div/>").addClass("file-preview-container").append($("<img/>").addClass("file-preview").attr("src","")).appendTo(e);const t=$("<div/>").addClass("file-button-container").appendTo(e);$("<button/>").gShareButton({clazz:"file-panel-share-button",defaultText:o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.share-this-file")),stats:"filespanel-view_infoPanel_share",restrictedStats:"filespanel-view_infoPanel_nonprotriespro-share"}).appendTo(t).hide(),$("<div/>").addClass("file-name").appendTo(e),$("<div/>").addClass("file-created").appendTo(e);var n=$("<div/>").addClass("collaboration").appendTo(e);$("<span/>").addClass("collaborators").append($("<div/>").addClass("gravit-icon-collaborators")).append($("<div/>").addClass("collaborators-number").text("0")).append($("<span/>").text(" "+o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.collaborators")))).appendTo(n).hide(),$("<span/>").addClass("comments").append($("<div/>").addClass("gravit-icon-comment")).append($("<div/>").addClass("comments-number").text("0")).append($("<span/>").addClass("comments-label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.comments")))).appendTo(n).hide(),$("<div/>").addClass("status").append($("<div/>").addClass("label").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.status"))+": ")).append($("<div/>").addClass("state").text("")).appendTo(e).hide()},g.prototype._updateUIForFile=async function(e,t){const n=e.find(".share-button"),i=e.find(".comments-number"),d=e.find(".comments-label"),u=e.find(".collaborators-number"),g=e.find(".file-created"),h=e.find(".collaboration"),f=e.find(".status"),m=e.find(".collaborators");e.find(".file-preview").attr("src",t.getPreviewURL()||c.DEFAULT_FILE_THUMBNAIL),e.find(".file-preview").unbind("dblclick"),e.find(".file-preview").on("dblclick",e=>{e.stopPropagation(),e.preventDefault(),this._triggerEvent(p.Type.DoubleClickFile,t)}),e.find(".file-name").text(t.name),e.data("fileId",t.id);const y=await a.default.createStorageItem(t);y.supportsShadowFile()&&await y.syncShadowFile();const v=await c.gApi.getFileExtended(y.getId()).catch(()=>null);g.text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.created")).replace("%createdTime",(0,r.dateToFilePreviewFormat)(t.created||v.created)));const _=v&&s.default.getCommentsCount(v)||0;i.text(_),d.text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase",1===_?"text.comment":"text.comments")));let b=null,w=null,C=!1;if(!v)return h.hide(),n.gShareButton("update",{disabled:!0,isSharing:!1}),void n.attr("data-title",o.GLocale.get(new o.GLocaleKey("GFilesPanelViewBase","text.can-only-share-by-owner")));{const e=gDesigner.getSyncUser();({state:{isPrivate:b,sharing:w,owner:C}}=(0,l.getFileStateAndRole)(e,v,{})),!gDesigner.getApplicationManager().isShareEngineEnabled()||w&&!C||n.show(),h.show()}if(n.gShareButton("update",{disabled:!1,storeItem:y,isSharing:w,closeCallback:()=>{this._triggerEvent(p.Type.Reload)},isPrivate:b}),n.removeAttr("data-title"),!w)return f.hide(),e.find(".collaborators").hide(),void e.find(".comments").hide();const E=await gDesigner.getFileReviewManager().getDocumentReviewHistory(y.getId());e.find(".comments").show(),E.length>1&&v?(f.show(),this._updateStatus(e,v.status)):f.hide();const S=v.getPrivateShareList().filter(e=>!e.owner).length;S>0?(m.show(),u.text(S)):m.hide()},g.prototype._updateStatus=function(e,t){const n=e.find(".state");switch(t){case c.FileStatus.IN_REVIEW:n.text(o.GLocale.get(new o.GLocaleKey("GReviewDockerProperties","text.review-title")));break;case c.FileStatus.REOPENED:n.text(o.GLocale.get(new o.GLocaleKey("GReviewDockerProperties","text.reopen-title")));break;case c.FileStatus.AWAITING_APPROVAL:n.text(o.GLocale.get(new o.GLocaleKey("GReviewDockerProperties","text.request-approval-title")));break;case c.FileStatus.APPROVED:n.text(o.GLocale.get(new o.GLocaleKey("GReviewDockerProperties","text.approved-title")))}},e.exports=g},function(e,t,n){"use strict";n(9);const i=n(68),o=n(0),r=n(1061);function a(){}o.inherit(a,i),a.prototype.render=async function(e,t){throw"Not implemented!"},a.prototype._triggerEvent=async function(e,t){this.hasEventListeners(r)&&this.trigger(new r(e,t))},e.exports=a},function(e,t,n){"use strict";var i=n(17);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GGoogleDrive=t.GCloudDrive=void 0;const o=i(n(771)).default;t.GCloudDrive=o;var r=n(1424);const a=r;t.GGoogleDrive=a;var s={GCloudDrive:o,GGoogleDrive:r};t.default=s},function(e,t,n){"use strict";var i=n(17);n(25),n(9),n(163),n(28),n(83);var o=n(1),r=i(n(144)),a=i(n(78)),s=i(n(77)),l=i(n(715)),c=i(n(385));const d=n(1425),u=n(1184),p=n(502),g=n(151),h=n(1426),f=n(756),m=n(536),y=n(473),v=n(106),{gApi:_,CloudIntegration:b}=n(12),{decrypt:w}=n(32),C=n(36);let E;function S(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.default.call(this,e),this._accountId=t;const{clientId:n=null,apiKey:i=null,appId:r=null,onUpdateSigninStatus:a=function(){},accessToken:s,expires:c,corporate:d=!1}=this._settings;if(this._settings=Object.assign(this._settings,{clientId:n,apiKey:i,appId:r,onUpdateSigninStatus:a,accessToken:s,expires:c,corporate:d}),this._settings.corporate&&(this._securityLevel=y.SecurityLevel.Highest),s&&(this._googleDriveClient=this._buildGoogleClient({accessToken:s,expires:c,corporate:d,accountId:t})),this._clientId=n,this._apiKey=i,this._appId=r,this._onUpdateSigninStatus=a,this._folders={},this.isLowestSecurityLevel()){const e=async e=>this._googlePickerLoaded?this._openFilePicker(e).catch(()=>C.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))):gContainer.getGoogleAPI().loadFilePicker().then(()=>{this._googlePickerLoaded=!0}).then(()=>this._openFilePicker(e)).catch(e=>{console.log("[GGoogleDrive error - Google Drive Picker]",e),C.alert(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))});this.addAction({title:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.add-files")),icon:"gravit-icon-add-files",execute:e}),this.setDefaultEmptyMessage({title:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.you-have-not-added")),buttons:[{title:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.add-additional-files")),execute:e}]}),this.addEventListener(l.default.DriveEvent,t=>{if(t.type===l.default.DriveEvent.Type.Added){const n=$("<div/>").gDialog({className:"g-googledrive-warning-dialog",releaseOnClose:!0}).append($("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>n.gDialog("close"))).append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.warning-message")))).append($("<div/>").addClass("buttons").append($("<button/>").addClass("g-highlight-button").text(o.GLocale.get(new o.GLocaleKey("GLocale","ok"))).on("click",()=>n.gDialog("close"))).append($("<button/>").addClass("g-highlight-button highlighted").text(o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.add-additional-files"))).on("click",()=>{e(t.source),n.gDialog("close")}))).gDialog("open",!1)}})}}o.GObject.inherit(S,l.default),S.LAST_TEAM_DRIVE_ID_PROP_NAME=b&&b.cloudOptions&&(b.cloudOptions.find(e=>"googledrive"===e.type)||{}).lastTeamDrivePropName||null,S.prototype._securityLevel=y.SecurityLevel.Lowest,S.prototype._googlePickerLoaded=!1,S.prototype._googleDriveClient=null,S.prototype.CURRENT_FOLDER_PROP="designer.filespanel.google-drive.current-folder",S.getInstance=function(){return E||(E=new S),E},S.prototype.setCorporateStorage=function(e){if(l.default.prototype.setCorporateStorage.call(this,e),S.LAST_TEAM_DRIVE_ID_PROP_NAME){let t=null;e&&({id:t}=e),this.saveLastTeamDriveId(S.LAST_TEAM_DRIVE_ID_PROP_NAME,t)}},S.prototype.getPreviousSelectedFolder=function(){return l.default.prototype.getPreviousSelectedFolder.apply(this,arguments).then(e=>e?g.from(e):e)},S.prototype._openFilePicker=function(e){const t=this;async function n(e){const n=t.getRootFolder();let i,o,r=!1;if(({parentId:i}=e[0]),i!==n.id)try{o=await t._googleDriveClient.getFileDetails(i)}catch(e){i=n.id,r=!0}return o||(o=n),{folder:o,showMessage:r}}async function i(e,i){for(let n=0;n<e.length;n++){let i=e[n];const{id:o,type:r}=i;"folder"!==r&&await t._googleDriveClient.updateFileDetails(o,{viewedByMeTime:(new Date).toISOString()})}const{showMessage:r,folder:a}=await n(e);r&&C.messageWithInfo({mainMessage:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.selected-files-folder-not-added")),infoMessage:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.selected-files-folder-not-added-additional"))}),t.trigger(new l.default.DriveEvent(null,l.default.DriveEvent.Type.FolderSwitchRequired,{folder:a})),i()}return new Promise((t,r)=>{if(!this.isSignedIn()||!this._googlePickerLoaded)return r();gContainer.getGoogleAPI().openFilePicker(a=>{if(e.toggleLoading(!0),1===a.length){const s=a[0],{id:l,type:c}=s;"folder"!==c?(n(a).then(e=>{let{showMessage:t}=e;t&&C.messageWithInfo({mainMessage:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.selected-file-folder-not-added")),infoMessage:o.GLocale.get(new o.GLocaleKey("GGoogleDrive","text.selected-files-folder-not-added-additional"))})}),this.getFile(l).then(e=>this._convertToCloudItems(e).then(e=>e[0])).then(e=>new Promise((t,n)=>{if(this.isFileSupported(e))return t(e);C.alert(o.GLocale.get(new o.GLocaleKey("GDocument","text.unsupported-file-extension")),n)})).then(e=>this.openFile(e)).then(()=>e.close()).then(t).catch(r).finally(()=>e.toggleLoading(!1))):i(a,t)}else i(a,t)},r)})},S.prototype.hasUserProfile=function(){return!0},S.prototype.isRootFolder=function(e){e=void 0!==e?e:this.getCurrentFolder();var t=this.getRootFolder();return"string"==typeof e?e===t.id:!e||e&&!e.id||e===t||e.id===t.id},S.prototype.getRootFolder=function(){return this.getCorporateStorage()?this.getCorporateStorage():g.from({id:"root",name:o.GLocale.get(new o.GLocaleKey("GFilesPanel","action.my-cloud"))})},S.prototype.uninstall=async function(){return new Promise(async e=>(l.default.prototype.uninstall.call(this),this.isLowestSecurityLevel()&&this.isSignedIn()&&await this.signOut(),e()))},S.prototype.getUser=function(){return new Promise(async(e,t)=>{try{var n;if(this._settings.corporate)n=await gDesigner.getUser();else{if(!gContainer.getGoogleAPI().isLoaded())return t("Google Drive Client not loaded!");n=await gContainer.getGoogleAPI().getBasicProfile()}return e(n)}catch(e){t(e)}})},S.prototype.install=function(e){return this.isInstalled()?Promise.resolve():this.isLowestSecurityLevel()?gContainer.getGoogleAPI().install(e).then(()=>this._loadClient()).then(()=>this._driveInstalled=!0):(this._driveInstalled=!0,Promise.resolve())},S.prototype.isLowestSecurityLevel=function(){return this._securityLevel===y.SecurityLevel.Lowest},S.prototype._loadClient=function(){return new Promise(async(e,t)=>{var n=this;const i=this.isLowestSecurityLevel()?"https://www.googleapis.com/auth/drive.file":"https://www.googleapis.com/auth/drive";var r,a,s;try{if(n._apiKey&&n._clientId)a=n._clientId,r=n._apiKey,s=n._appId;else{var l=await _.cloudServices.googleDrive.getClientConfiguration();const{GOOGLE_DRIVE_PUBLIC_CLIENT_ID:e,GOOGLE_DRIVE_PUBLIC_API_KEY:t,GOOGLE_DRIVE_APP_ID:n}=JSON.parse(w(l));a=e,r=t,s=n,this._apiKey=r,this._clientId=a,this._appId=s}}catch(e){return t(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.loading-failed")))}gContainer.getGoogleAPI().init({appId:s,apiKey:r,clientId:a,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:i}).then(()=>{gContainer.getGoogleAPI().listenSignInStateChanges(n._updateSigninStatus.bind(n)),n._updateSigninStatus(gContainer.getGoogleAPI().isSignedIn()),e()},e=>{t(e)})})},S.prototype._updateSigninStatus=function(e){this._onUpdateSigninStatus(e),this.isSignedIn()&&(this._googleDriveClient=this._buildGoogleClient())},S.prototype.isSignedIn=function(){return gContainer.getGoogleAPI().isLoaded()||console.error("Google Drive Client not loaded!"),gContainer.getGoogleAPI().isSignedIn()},S.prototype.signIn=function(){return new Promise((e,t)=>gContainer.getGoogleAPI().isLoaded()?this.isSignedIn()?e():gContainer.getGoogleAPI().signIn().then(t=>{this._googleDriveClient=this._buildGoogleClient(t),e()}).catch(e=>e&&"popup_blocked_by_browser"===e.error?t(new c.default(o.GLocale.get(new o.GLocaleKey("GExternalStorage","text.error-window-blocked-alternative")))):t(e)):t("Google Drive Client not loaded!"))},S.prototype.signOut=function(){if(!gContainer.getGoogleAPI().isLoaded())throw Error("Google Drive Client not loaded!");return gContainer.getGoogleAPI().signOut()},S.prototype.fetchFolders=async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;var i=t?this._getParentReference(t):this._getParentContext();return this._search(u.from({type:g.Type.Folder,limit:n>0?n:1e3,orderBy:S.SearchEngine.SortMap[e],parent:i})).then(async e=>{this._currentPage=e;let n=e.getItems();return this.isRootFolder(t)&&!this.PREVIOUS_SELECTED_FOLDER_PATH.length&&(this._rootFolderID=n&&n.length&&"root"===n[0].getParentId()?n[0].parents[0]:null,await this.generatePreviousSelectedFolderPath()),n})},S.prototype._buildSearchQuery=function(e){const t=new d;var n=e.hasValue("type")&&e.type;const i=n===g.Type.Folder,o=n===g.Type.File;return i?t.add("mimeType","=",f.MimeType.Folder):o&&(t.group(e=>{this.getSupportedExtensions().forEach(t=>e.or("fileExtension","=",t)),this.getSupportedMIMETypes().forEach(t=>e.or("mimeType","=",t))}),this.shouldOnlyListOwnedFiles()&&t.in("me","owners")),e.hasValue("parent")?"*"!==e.parent&&t.in(e.parent,"parents"):t.in("root","parents"),e.hasValue("name")&&t.add("name","contains",e.name),e.hasValue("exactname")&&t.add("name","=",e.exactname),e.hasValue("fileExtension")&&t.add("fileExtension","=",e.fileExtension.toLowerCase()),t.add("trashed","=",new d.RawValue(!1)),t.build()},S.prototype._getParentContext=function(){return this._getParentReference(this.getCurrentFolder())||this._getParentReference(this.getCorporateStorage())},S.prototype.getFolders=function(){var e={},t=this._getParentContext();return t&&(e[t]={folder:{name:null,id:null,parent:null}}),e},S.prototype._search=async function(e,t){var n=e.hasKey("limit")&&e.getAsInt("limit")||this.getQueryLimit();t=t||new h({query:e});return new Promise(async(i,o)=>{try{var r={q:this._buildSearchQuery(e),pageSize:n-t.getSize(),fields:"nextPageToken, files( id, driveId, parents, name, fileExtension, fullFileExtension, hasThumbnail, thumbnailLink, size, contentHints(thumbnail(image, mimeType)), description, mimeType, version, createdTime, modifiedTime, webContentLink, capabilities(canDownload, canEdit) )",pageToken:e.hasValue("nextPageToken")&&e.nextPageToken||""},a=this.getCorporateStorage();a&&(r=Object.assign(r,{includeItemsFromAllDrives:!0,corpora:"drive",supportsAllDrives:!0,driveId:a.id})),e.hasValue("orderBy")&&(r.orderBy=e.orderBy);const o=await this._googleDriveClient.searchFiles(r);var{files:s,nextPageToken:l}=o;if(!s.length)return i(t);s=t.getSize()+s.length>n?s.slice(0,Math.max(n-t.getSize(),0)):s;var c=await this._convertToCloudItems(s);return e.hasValue("parent")&&c.forEach(t=>{t.parent=e.parent}),t.update({nextPageToken:l,items:c}),t.getSize()<n&&l&&(t=await this._search(e,t)),i(t)}catch(e){o()}})},S.prototype._convertToCloudItems=async function(e){return(e=e instanceof Array?e:[e]).map(e=>p.convertToCloudItem(e))},S.prototype.navigateToParentFolder=function(){var e=this._currentFolder.parent?this._currentFolder.parent:null;return this.setCurrentFolder(this._getParentReference(e)),this},S.prototype._getParentReference=function(e){return e&&"object"==typeof e?e._id||e.id:e},S.prototype.getFile=function(e){return this._googleDriveClient.getFileDetails(e,this.getCorporateStorage()?{supportsAllDrives:!0}:{})},S.prototype.getFolder=async function(e){const t=await this._googleDriveClient.getFileDetails(e.id||e,this.getCorporateStorage()?{supportsAllDrives:!0}:{});return this._convertToCloudItems(t).then(e=>e[0])},S.prototype.supportsSaveCollisionFlow=function(){return!0},S.prototype.fileExists=async function(e,t,n){var i=n?this._getParentReference(n):this._getParentContext();return this._search(u.from({type:g.Type.File,parent:i,exactname:"".concat(e,".").concat(t),fileExtension:t})).then(e=>!!e.getItems().length)},S.prototype.folderExists=function(e,t){var n=t?this._getParentReference(t):this._getParentContext();return this._search(u.from({type:g.Type.Folder,parent:n,exactname:e})).then(e=>!!e.getItems().length)},S.prototype.getRawFile=function(e,t,n){return this._googleDriveClient.getFile(e.id,this.getCorporateStorage()?{supportsAllDrives:!0}:{},t,n&&n.progress)},S.prototype._createStorageItem=async function(e,t,n){const i=t&&await v.createUint8ArrayFromBlob(t);return new p.Item(gDesigner.getDefaultStorage(),e,i,n)},S.prototype.openFile=async function(e,t){return new Promise(async function(n,i){try{const i=Object.assign(e,{settings:this._googleDriveClient.getTokenIssuerSettings()});var o=await this._createStorageItem(i,await this.getRawFile(e));o.setCloudClient(this._googleDriveClient),gDesigner.openDocument(o,t),await this._googleDriveClient.updateFileDetails(o.getUniqueId(),{viewedByMeTime:(new Date).toISOString()},{supportsAllDrives:!0}),n()}catch(e){i(e)}}.bind(this))},S.prototype.saveNewFile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0;return new Promise(async(c,d)=>{const u=function(e,t,n){console.log(e);const i=gDesigner.getHeader(),r=i.getWindowTab(gDesigner.getWindows().getWindow(t)),a=i.getWindowTab(gDesigner.getWindows().getWindow(n));r&&a?(n.updateStatus(s.default.SaveFailed),gDesigner.removeDocument(n,(function(){t.updateStatus(s.default.SaveFailed)}))):r?t.updateStatus(s.default.SaveFailed):n.updateStatus(s.default.SaveFailed),d(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-saving-file")))};var p=new r.default;try{n=n||this.getDefaultFileFormat().ext.toUpperCase();var g=e.getScene();g.getActivePage().getGeometryBBox()||d(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.error-emtpy-infinite-canvas"))),i=e.updateSaveOptionsLastModifiedDate(i);const r=(this.findFileFormatByExtension(n)||this.getDefaultFileFormat()).mime,f={name:t,mimeType:r,fileExtension:n,parent:this._getParentContext(),settings:this._settings},m=r!==this.getDefaultFileFormat().mime,y=this.getCorporateStorage();y&&(f.driveId=y.id);var h=await this._createStorageItem(f);h.setCloudClient(this._googleDriveClient),gDesigner.addDocument(p),p.setSynchronizing(!0),p.setTitle(t),p.updateStatus(s.default.Saving);const v=o.GNode.store(g,i);v.cfs=!1;const _=JSON.stringify(v);return p.deserializeData(_).then(async()=>{e.getFileFormatVersion()&&p.setFileFormatVersion(e.getFileFormatVersion()),l&&l(s.default.Loaded),i=p.updateSaveOptionsLastModifiedDate(i),h.write(p,async()=>{e&&e.getEditor()&&gDesigner.removeDocument(e,null,!0),p.setStorageItem(h),await p.saveAnnotations(m,!0),p.setSynchronizing(!1),l&&l(s.default.Saved),gDesigner.hasEventListeners(a.default)&&(gDesigner.trigger(new a.default(a.default.Type.Modified,p)),gDesigner.trigger(new a.default(a.default.Type.Activated,p))),gDesigner.addToRecentFiles(h),p.updateStatus(s.default.Saved),c()},()=>{console.error(">>>saveNewFile write error",arguments),p.setSynchronizing(!1),l&&l(s.default.SaveFailed),d()},null,i)}).catch(t=>u(t,p,e))}catch(t){u(t,p,e)}})},S.prototype.fetchRecentFiles=function(){return this._fetchFiles(null,0,"-viewed","*",this._currentRecentFilesPage).then(e=>(this._currentRecentFilesPage=e,e.getItems()))},S.prototype.fetchFiles=async function(e,t,n){var i=this.getCurrentFolder(),o=i&&this._getParentReference(i);this._currentFilesPage&&(this._currentFilesPage.__parent===o&&this._currentFilesPage.__search===e&&this._currentFilesPage.__sort===n||(this._currentFilesPage=null));return await this._fetchFiles(e,t,n,i,this._currentFilesPage).then(t=>(this._currentFilesPage=t,this._currentFilesPage.__search=e,this._currentFilesPage.__sort=n,this._currentFilesPage.__parent=o,t.getItems()))},S.prototype._fetchFiles=async function(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4?arguments[4]:void 0;var r=i?this._getParentReference(i):this._getParentContext();if(t&&o&&!o.nextPageToken){var a=h.from(o);return a.items=[],a}return this._search(u.from({type:g.Type.File,limit:this.getQueryLimit(),orderBy:S.SearchEngine.SortMap[n],nextPageToken:t?o&&o.nextPageToken:"",parent:r,name:e}))},S.prototype.isItemAllowedToBeRendered=function(e){return e.hasPermission(g.Permission.Download)},S.prototype.isFileAllowedToBeOpened=function(e){return e.hasPermission(g.Permission.Download)},S.prototype.supportsCorporateStorage=function(){return!0},S.prototype.getCorporateStorages=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new u,t=arguments.length>1?arguments[1]:void 0;if(this.shouldOnlyListOwnedFiles())return Promise.resolve([]);var n=e.hasKey("limit")&&e.getAsInt("limit")||this.getQueryLimit();return t=t||new h({query:e}),new Promise(async(i,o)=>{try{const o={pageSize:n-t.getSize(),fields:"*",nextPageToken:e.hasValue("nextPageToken")&&e.nextPageToken},l=await this._googleDriveClient.searchTeamDrives(o);var{drives:r,nextPageToken:a}=l;if(!r.length)return i(t);r=t.getSize()+r.length>n?r.slice(0,Math.max(n-t.getSize(),0)):r;var s=await this._convertToCloudItems(r);return t.update({nextPageToken:a,items:s}),t.getSize()<n&&a&&(t=await this.getStorages(e,t)),i(t.getItems())}catch(e){o()}})},S.prototype._buildGoogleClient=function(e){if(!e){if(!gContainer.getGoogleAPI().isLoaded())throw Error("Google Drive Client not loaded!");e=gContainer.getGoogleAPI().getTokenConfiguration({corporate:!1,accountId:this._accountId})}return new f(new m(e))},S.prototype.getSupportedFileFormats=function(){return p.getSupportedFileFormats()},S.prototype.generatePreviousSelectedFolderPath=async function(){const e=this.getCurrentFolder();if(this.isRootFolder(e))return this.PREVIOUS_SELECTED_FOLDER_PATH=[],this.PREVIOUS_SELECTED_FOLDER_PATH;this.PREVIOUS_SELECTED_FOLDER_PATH.push(e.id);let t=e.getParentId()?e.getParentId():e.parents?e.parents[0]:null;if(t&&t!==this._rootFolderID){let e=await this.getFolder(t).catch(()=>null);for(;e;)this.PREVIOUS_SELECTED_FOLDER_PATH.push(e.id),t=e.getParentId()?e.getParentId():e.parents?e.parents[0]:null,e=t&&t!==this._rootFolderID?await this.getFolder(t).catch(()=>null):null}return this.PREVIOUS_SELECTED_FOLDER_PATH},S.SearchEngine={SortMap:{"-updated":"".concat(f.SearchEngine.OrderBy.ModifiedTime," ").concat(f.SearchEngine.Sorts.Descending),updated:"".concat(f.SearchEngine.OrderBy.ModifiedTime," ").concat(f.SearchEngine.Sorts.Ascending),"-created":"".concat(f.SearchEngine.OrderBy.CreatedTime," ").concat(f.SearchEngine.Sorts.Descending),created:"".concat(f.SearchEngine.OrderBy.CreatedTime," ").concat(f.SearchEngine.Sorts.Ascending),"-name":"".concat(f.SearchEngine.OrderBy.Name," ").concat(f.SearchEngine.Sorts.Descending),name:"".concat(f.SearchEngine.OrderBy.Name," ").concat(f.SearchEngine.Sorts.Ascending),"-viewed":"".concat(f.SearchEngine.OrderBy.ViewedByMeTime," ").concat(f.SearchEngine.Sorts.Descending),viewed:"".concat(f.SearchEngine.OrderBy.ViewedByMeTime," ").concat(f.SearchEngine.Sorts.Ascending)}},e.exports=S},function(e,t,n){"use strict";function i(){this.stack=[]}i.RawValue=function(e){this.value=e},i.RawValue.prototype.getValue=function(){return this.value},i.prototype._checkRaw=function(e){return e instanceof i.RawValue?e.getValue():"'".concat(e,"'")},i.prototype.add=function(e,t,n,o){return this._add(e instanceof i.RawValue?e:new i.RawValue(e),t,n,o)},i.prototype._add=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.Connector.AND;return this.stack.push({field:e,operator:t,value:n,connector:o}),this},i.prototype.group=function(e){var t=new i;return this.stack.push(t),e(t),this},i.prototype.and=function(e,t,n){return this.add(e,t,n,i.Connector.AND)},i.prototype.or=function(e,t,n){return this.add(e,t,n,i.Connector.OR)},i.prototype.in=function(e,t){return this._add(e,i.Connector.IN,t instanceof i.RawValue?t:new i.RawValue(t))},i.prototype.build=function(){var e=this;return this.stack.map((function(t,n){return t instanceof i?"".concat(0!==n?i.Connector.AND+" ":"","(").concat(t.build(),")"):"".concat(0!==n?t.connector+" ":"").concat(e._checkRaw(t.field)," ").concat(t.operator," ").concat(e._checkRaw(t.value))})).join(" ")},i.Connector={AND:"AND",IN:"IN",OR:"OR"},e.exports=i},function(e,t,n){"use strict";n(25);const i=n(151),o=n(1184);function r(e){var t,n,i;if(e&&(t=e.nextPageToken,n=e.items,i=e.query),n&&!this._isItemValid(n))throw Error("Must be a cloud item");this.nextPageToken=t,this.items=n||[],this.query=i}r.prototype._isItemValid=function(e){return!(e=e instanceof Array?e:[e]).some(e=>!e instanceof i)},r.prototype.nextPageToken=null,r.prototype.items=null,r.prototype.isEmpty=function(){return!this.items||this.items instanceof Array&&!this.items.length},r.prototype.getSize=function(){return this.items.length},r.prototype.getItems=function(){return this.items},r.prototype.update=function(e){var t=e.nextPageToken,n=e.items,i=e.query;if(!this._isItemValid(n))throw Error("Must be a cloud item");this.nextPageToken=t,this.items=this.items.concat(n),i&&(this.query=i)},r.from=function(e){var t=new r;return(t=Object.assign(t,e)).query&&(t.query=o.from(t.query)),t.items&&(t.items=t.items.map(e=>i.from(e))),t},e.exports=r},function(e,t,n){"use strict";var i=n(17);n(84),n(14),n(29);var o=n(1),r=i(n(36));function a(e,t,n,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};var s=this;this._dialog=$("<div></div>"),$("<div/>").css("display","grid").append($("<span/>").css("display","block").html(o.GLocale.get(new o.GLocaleKey("GNewFilePrompt","text.name-document")))).append($("<input/>").attr("type","text").css("margin-top","10px").css("width","100%").val(i||"").addClass("name")).appendTo(this._dialog);var l=function(e){13===e.which&&(gDesigner.stats("newfile_enter_save"),c(),e.stopPropagation())},c=function(){if($(s._dialog).find(".name").val().trim()){var t=$(s._dialog).find(".name").val();a&&a.fn&&!a.fn(t)?r.default.alert(a.errorMessage.replace("%fileName%",'"'.concat(t,'"'))):(e(t),s.close())}};$(s._dialog).find(".name").keypress(l),this._dialog.gDialog({className:"g-new-file-prompt-dialog",releaseOnClose:!1,closeCallback:t,buttons:[$("<button".concat(n?' class="'.concat(n,'"'):"",">").concat(o.GLocale.get(new o.GLocaleKey("GNewFilePrompt","action.create")),"</button>")).on("click",(function(){gDesigner.stats("newfile_click_save"),c()})),$("<button>"+o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))+"</button>").on("click",(function(){gDesigner.stats("newfile_click_close"),s.close()}))]})}o.GObject.inherit(a,o.GObject),a.prototype.open=function(){this._dialog.gDialog("open",!0),$(this._dialog).find(".name").focus()},a.prototype.close=function(){this._dialog.gDialog("close")},e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;class i extends Error{constructor(){super("REPEAT"),this.name="GRepeatActionError"}}var o=i;t.default=o},function(e,t,n){"use strict";n(28),n(9);var i=n(1),o=n(12),r=n(106),a=n(144);n(1182),n(143);const s=o.FILE_FORMATS.find(e=>e.default);var l={},c=null;e.exports=class{constructor(e,t){var n=$("<div/>").addClass("g-templates-panel").appendTo(e);c=t,this._createHeader(n);var i=$("<div/>").addClass("templates").appendTo(n);this._initCategories(i),this._showLargeFiles=!1}_openPreset(e){r.loadDesignData(e.id).then(e=>{var t=new a;gDesigner.addDocument(t),t.loadFromData(e.data)}).catch(e=>{e&&console.log(e)})}_addPreset(e,t,n){var i=e.find(".presets-row:last-child"),r=this._showLargeFiles?2:4;0!==i.length&&i.children().length!==r||(i=$("<div/>").addClass("presets-row").appendTo(e)),$("<img/>").addClass("preset").attr("src",t.url_t).css("width",Math.ceil((i[0].scrollWidth+35)/r)-35+"px").on("click",function(){c&&c(),gDesigner.stats("cloudtemplates_add_"+(this._currentCategory?this._currentCategory.name:"default"),t.name),o.IS_TRUNK&&console.log("Template ID: ",t.id),this._openPreset(t)}.bind(this)).appendTo(i)}_updatePresetLayout(){if(this._currentCategory){var e=l[this._currentCategory.path]||[],t=$(".g-templates-panel").find(".templates").empty();e.forEach(e=>this._addPreset(t,e,this._currentCategory))}}_loadPage(e){var t=this;this._currentCategory=e,this._switchSize.css("display",""),this._backButton.css("display","");var n=function(){var n=l[e.path]||[];$(".g-templates-panel").find(".templates").empty();for(var i=0;i<n.length;++i)t._addPreset($(".g-templates-panel").find(".templates"),n[i],e);$(".g-templates-panel").find(".header").find(".back").removeClass("g-disabled"),$(".g-templates-panel").find(".header").find(".back").addClass("active"),t._toggleLoading(!1)};if(l[e.path])n();else{this._toggleLoading(!0),async function(t){try{var n=await o.gApi.listMarket({path:e.path,type:s.type,limit:o.PRESET_LIMIT});l[e.path]=n,t()}catch(e){t(),console.error(e)}}(n)}}_initCategories(e){this._switchSize.css("display","none"),this._backButton.css("display","none"),$(".g-templates-panel").find(".templates").empty();for(var t=0;t<o.CATEGORIES.length;++t){const s=o.CATEGORIES[t];var n=$(".g-templates-panel").find(".templates").find(".template-row:last-child");0!==n.length&&4!==n.children().length||(n=$("<div/>").addClass("template-row")).appendTo(e);var r=$("<div/>").addClass("template").on("click",function(){gDesigner.stats("cloudtemplates_load_template",s.name),this._loadPage(s)}.bind(this)).appendTo(n);$("<img/>").addClass("template-icon").attr("src",s.url).css("width",Math.ceil(s.width/4)+"px").appendTo(r);var a=s.preset.width+" x "+s.preset.height+(s.preset.unit?" "+s.preset.unit:" px");$("<div/>").addClass("template-info").append($("<div/>").addClass("template-name").html(i.GLocale.get(new i.GLocaleKey("GCommonNames",s.path)))).append($("<div/>").addClass("template-size").html(a)).appendTo(r)}}_createHeader(e){var t=$("<div/>").addClass("header").appendTo(e);this._switchSize=$("<div></div>").addClass("switch-size").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GFilesPanel","text.large-mode")))).append($("<label></label>").addClass("g-switch").append($("<input>").attr("type","checkbox").prop("checked",this._showLargeFiles).on("change",e=>{this._showLargeFiles=$(e.target).is(":checked"),gDesigner.stats("cloudtemplates_switch_size",this._showLargeFiles?"large":"small"),this._updatePresetLayout()})).append($("<div></div>"))).appendTo(t),this._backButton=$("<div/>").addClass("g-button").addClass("cloud-button").addClass("back").addClass("g-disabled").attr("data-title",i.GLocale.get(new i.GLocaleKey("GFilesPanel","action.back-tooltip"))).append($("<span/>").addClass("icon").addClass("gravit-icon-w-back")).append($("<span/>").addClass("label").text(i.GLocale.get(new i.GLocaleKey("GFilesPanel","action.back")))).on("click",function(){gDesigner.stats("cloudtemplates_click_backbutton",this._currentCategory?this._currentCategory.name:""),0===$(".g-templates-panel").find(".templates").find(".template-row").length&&(this._initCategories($(".g-templates-panel").find(".templates")),$(".g-templates-panel").find(".header").find(".back").removeClass("active"),$(".g-templates-panel").find(".header").find(".back").addClass("g-disabled"))}.bind(this)).appendTo(t)}_toggleLoading(e){$(".g-dialog-content").find(".frame").toggleClass("loading",e)}}},function(e,t,n){"use strict";var i=n(17);n(9),n(83),n(25);var o=n(1),r=n(43),a=i(n(1431)),s=i(n(175));const{gApi:l}=n(12);e.exports=class{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._firstName=e,this._lastName=t,this._anonymous=n,this._confirmBtn=$("<button/>").addClass("confirm-btn").attr("disabled",this._checkNameFieldsFilled()).text(o.GLocale.get(new o.GLocaleKey("GUserNameConfigDialog","text.ok"))).on("click",()=>{gDesigner.stats("user-name-config-dialog_update-user-name"),this._updateUserName()}),this._dialog=$("<div/>").append($("<div/>").addClass("header").append($("<span/>").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GUserNameConfigDialog","text.dialog-title"))))).append($("<div/>").addClass("tips-content-container").append($("<span/>").addClass("tips").text(o.GLocale.get(new o.GLocaleKey("GUserNameConfigDialog","text.name-usage-tips"))))).append(this._buildNameFields()).append(this._confirmBtn).gDialog({releaseOnClose:!0,className:"g-username-config-dialog"})}_buildNameFields(){return $("<div/>").addClass("name-fields").append($("<div/>").addClass("label-and-input").addClass("first-name-field").append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GUserNameConfigDialog","text.first-name")))).append($("<input/>").addClass("field-input").val(this._firstName).on("input",e=>this._nameFieldValueChange(!0,e)).on("change",e=>this._nameFieldValueChange(!0,e)))).append($("<div/>").addClass("label-and-input").addClass("last-name-field").append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GUserNameConfigDialog","text.last-name")))).append($("<input/>").addClass("field-input").val(this._lastName).on("input",e=>this._nameFieldValueChange(!1,e)).on("change",e=>this._nameFieldValueChange(!1,e))))}async _updateUserName(){const e={name:this._firstName,last_name:this._lastName},t=new s.default(e);this._anonymous?gContainer.setCookie({name:a.default.ANONYMOUS_USERNAME,value:encodeURIComponent(JSON.stringify(e))}):await l.updateUser(e),await this._updateUserProperties(t),this.close()}async _updateUserProperties(e){r.GEditorOptions.userConfig=Object.assign({},r.GEditorOptions.userConfig,{userName:e.getFullUserName()}),gDesigner.getCloudCommunicationManager().userPropertiesChanged(),await gDesigner.getUser()}_checkNameFieldsFilled(){return!this._firstName||!this._firstName.length}_nameFieldValueChange(e,t){e?this._firstName=$(t.target).val():this._lastName=$(t.target).val(),this._confirmBtn.attr("disabled",this._checkNameFieldsFilled())}open(){gDesigner.stats("user-name-config-dialog_open"),this._dialog.gDialog("open",!1)}close(){this._dialog.gDialog("close")}}},function(e,t,n){"use strict";e.exports={COLLABORATION_FLAG:"_gcollab",ANONYMOUS_USERNAME:"_ANONYMOUS_USERNAME",SESSION_TOKEN:"_gvt"}},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(16),a=i(n(1059)),s=i(n(1060));function l(e){const t=e=>{if(r.GKey.translateKey(e.keyCode)===r.GKey.Constant.ESC)return e.preventDefault(),e.stopPropagation(),$(document).off("keydown",t),this._dialog.gDialog("close"),!1};let n="g-install-pwa-dialog";e&&(n+="-dark"),this._dialog=$("<div />").gDialog({releaseOnClose:!0,className:n,alwaysCloseable:!0,closeCallback:()=>$(document).off("keydown",t)}),$(document).on("keydown",t),this._dialog.append(this._getCloseButton()).append(this._getDialogContent())}o.GObject.inherit(l,o.GObject),l.prototype._getCloseButton=function(){return $("<div />").addClass("g-btn-close").append($("<span />").addClass("gravit-icon-close")).on("click",this.close.bind(this))},l.prototype._getDialogContent=function(){return $("<div />").addClass("content").append(this._getHeader()).append(this._getMainContent())},l.prototype._getHeader=function(){return $("<div />").addClass("header")},l.prototype._getMainContent=function(){return $("<div />").addClass("main-content").append($("<div />").addClass("title").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.title")))).append($("<div />").addClass("description").append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.description-text")))).append($("<a />").attr("href","https://www.designer.io/pro").attr("target","_blank").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.description-pro-link")))).append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.end-sentence-dot"))))).append(s.default.isSupported()?this._getButtons():this._buildChromiumInfoSection()).append(this._getFooter())},l.prototype._getButtons=function(){var e=this;return $("<div />").addClass("buttons").append($("<button />").addClass("primary").addClass("g-button").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","action.install-button"))).on("click",(function(t){try{gDesigner.executeAction(a.default.ID)}catch(t){a.default.install()}e.close()}))).append($("<button />").addClass("g-button").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","action.not-now-button"))).on("click",()=>{const e=gDesigner.now().getTime();gContainer.setProperty(a.default.closedInstallPWADialogDatePropName,e),this.close()}))},l.prototype._buildChromiumInfoSection=function(){return $("<div />").addClass("chromium-section").append($("<div/>").addClass("chromium-content").html(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.pwa-requires"))))},l.prototype._getFooter=function(){return $("<div />").addClass("footer").append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.footer-main-text")))).append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","action.footer-link-text")))).append($("<span />").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","text.end-sentence-dot")))).append($("<span> </span>")).append($("<a />").attr("href","https://www.designer.io/en/gravit-designer/progressive-web-app-for-design/").attr("target","_blank").text(o.GLocale.get(new o.GLocaleKey("GInstallPwaDialog","action.footer-more-information"))))},l.prototype._dialog=null,l.prototype.open=function(){this._dialog.gDialog("open",!1)},l.prototype.close=function(){this._dialog.gDialog("close")},l.prototype.toString=function(){return"[Object GInstallPwaDialog]"},e.exports=l},function(e,t,n){"use strict";n(28);var i=n(1),o=n(43),r=n(1186),a=n(1062),s=n(723),l=n(550),c=n(784),d=n(1063),u=n(1064),p=n(1065),g=n(779),h=n(1066),f=n(783),m=n(781),y=n(782),v=n(217),_=n(308),b=n(397),w=n(1067),C=n(787),E=n(1069),S=n(1070),G=n(1068),A=n(785),T=n(722),P=n(1197),L=n(1198),D=n(1199),x=n(1071),I=n(1200),O=n(1201),k=n(1202),F=n(1203),R=n(510),M=n(26),{replaceImage:N,setOriginSize:B,cropImage:U}=n(1152),K=n(78);const j=n(786);r.prototype._contextMenuContainerTouch=null,r.prototype._createTouchContextMenu=function(){var e=$("<div/>").gOverlay({releaseOnClose:!1,clazz:"context-menu-touch-overlay"}),t=this;this._contextMenuContainerTouch=e;$("<div/>").addClass("transform-section").gPropertyRow({columns:[{width:"48%",content:this._createActionButtons([{action:gDesigner.getAction(m.ID+"."+m.Type.FlipHorizontal)},{action:gDesigner.getAction(m.ID+"."+m.Type.FlipVertical)}])},{width:"4%"},{width:"48%",content:this._createActionButtons([{action:gDesigner.getAction(m.ID+"."+m.Type.Rotate90Left),icon:"gravit-icon-rotate-left"},{action:gDesigner.getAction(m.ID+"."+m.Type.Rotate90Right),icon:"gravit-icon-rotate-right"}])}]}).appendTo(e);$("<div/>").addClass("paste-section").gPropertyRow({columns:[{content:this._createActionButtonWithMenu(gDesigner.getAction(C.ID),i.GLocale.get(new i.GLocaleKey("GContextMenu","text.paste")),[gDesigner.getAction(E.ID),gDesigner.getAction(S.ID),gDesigner.getAction(G.ID),gDesigner.getAction(j.ID),gDesigner.getAction(A.ID)])}]}).appendTo(e),$("<div/>").addClass("compound-section").gPropertyRow({columns:[{content:this._createActionButtonWithMenu(gDesigner.getAction(g.ID),i.GLocale.get(new i.GLocaleKey("GContextMenu","text.create-compound")),[gDesigner.getAction(g.ID+".op-"+i.GVertexPolyBoolean.OR),gDesigner.getAction(g.ID+".op-"+i.GVertexPolyBoolean.SUB),gDesigner.getAction(g.ID+".op-"+i.GVertexPolyBoolean.AND),gDesigner.getAction(g.ID+".op-"+i.GVertexPolyBoolean.XOR),gDesigner.getAction(D.ID)])}]}).appendTo(e),$("<div/>").addClass("path-section").gPropertyRow({columns:[{content:this._createActionButtonWithMenu(gDesigner.getAction(s.ID),i.GLocale.get(new i.GLocaleKey("GContextMenu","text.convert-to-path")),[gDesigner.getAction(y.ID),gDesigner.getAction(F.ID),gDesigner.getAction(x.ID),gDesigner.getAction(I.ID),gDesigner.getAction(O.ID),gDesigner.getAction(p.ID),gDesigner.getAction(f.ID),gDesigner.getAction(k.ID)])}]}).appendTo(e),$("<div/>").addClass("symbol-section").gPropertyRow({columns:[{content:this._createActionButtonWithMenu(gDesigner.getAction(l.ID),i.GLocale.get(new i.GLocaleKey("GContextMenu","text.create-symbol")),[gDesigner.getAction(d.ID),gDesigner.getAction(c.ID),{caption:i.GLocale.get(new i.GLocaleKey("GContextMenu","text.go-to-master")),click:e=>{var t=gDesigner.getActiveDocument(),n=t.getEditor();if(t){var o=t.getEditor().getIndividualSelection();if(o&&o.length){var r=o.find(e=>e instanceof i.GSymbol&&!e.isLocked()&&!e.isMaster());if(r){var a=r;n.beginTransaction(),n.clearSelection(),n.updateSelection(!1,[a]),gDesigner.executeAction(R.ID,void 0,void 0,!0),n.commitTransaction(i.GLocale.get(new i.GLocaleKey("GContextMenu","text.go-to-master")))}}}gDesigner.stats("touchmenu_go-to-master")},icon:"gravit-icon-go-to-master",isEnabled:()=>{var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor().getIndividualSelection();if(t&&t.length)if(t.find(e=>e instanceof i.GSymbol&&!e.isLocked()&&!e.isMaster()))return!0}return!1}}])}]}).appendTo(e);$("<div/>").addClass("text-section").gPropertyRow({columns:[{content:this._createActionButtonMenu("gravit-icon-textbox",i.GLocale.get(new i.GLocaleKey("GContextMenu","text.text")),[gDesigner.getAction(a.ID),gDesigner.getAction(u.ID),gDesigner.getAction(h.ID)],()=>!!this._getFirstSelectedTextElement())}]}).appendTo(e);var n=[{caption:i.GLocale.get(new i.GLocaleKey("GContextMenu","text.crop")),click:e=>{var t=gDesigner.getActiveDocument().getEditor().hasSelectionDetail();U(this._getFirstSelectedImageElement(),t),gDesigner.stats("touchmenu_crop-image")},icon:"gravit-icon-crop",update:e=>{var t=gDesigner.getActiveDocument().getEditor().hasSelectionDetail();e.setCaption(i.GLocale.get(new i.GLocaleKey("GImageProperties",t?"action.no-crop":"action.crop")))}},{caption:i.GLocale.get(new i.GLocaleKey("GContextMenu","text.original-size")),click:e=>{B(this._getFirstSelectedImageElement()),gDesigner.stats("touchmenu_original-size")},icon:"gravit-icon-expand"},{caption:i.GLocale.get(new i.GLocaleKey("GContextMenu","text.replace-image")),click:e=>{gDesigner.stats("touchmenu_replace-image"),N(this._getFirstSelectedImageElement(),gDesigner.getActiveDocument())},icon:"gravit-icon-replaceimg"}];$("<div/>").addClass("image-section").gPropertyRow({columns:[{content:this._createActionButtonMenu("gravit-icon-image",i.GLocale.get(new i.GLocaleKey("GContextMenu","text.image")),n,()=>!!this._getFirstSelectedImageElement())}]}).appendTo(e);return $("<div/>").addClass("").gPropertyRow({columns:[{width:"48%",content:this._createActionButtons([{action:gDesigner.getAction(T.ID)},{action:gDesigner.getAction(w.ID),icon:"gravit-icon-mask-with-shape"}])},{width:"4%"},{width:"48%",content:this._createActionButtons([{action:gDesigner.getAction(P.ID),icon:"gravit-icon-flatten"},{action:gDesigner.getAction(L.ID),icon:"gravit-icon-duplicate"}])}]}).appendTo(e),$("<div/>").addClass("").gPropertyRow({columns:[{width:"48%",content:this._createActionButtons([{icon:"gravit-icon-lock",click:e=>{t._setAllSelectionsLocked(),this._contextMenuContainerTouch.gOverlay("close"),gDesigner.stats("touchmenu_lock-layer")},isEnabled:()=>t._getSelectedItems().length>0},{icon:"gravit-icon-hide-big",click:e=>{t._setAllSelectionsHidden(),this._contextMenuContainerTouch.gOverlay("close"),gDesigner.stats("touchmenu_hide-layer")},isEnabled:()=>t._getSelectedItems().length>0}])},{width:"4%"},{width:"48%",content:this._createSelectMenuButton()}]}).appendTo(e),gDesigner.addEventListener(K,this._documentEvent.bind(this)),e},r.prototype._elementsToCheck=[],r.prototype._documentEvent=function(e){e.type===K.Type.ContextMenuOpened&&(gDesigner.getAction(G.ID).setPosition(this._contextMenuClientPosition),this._elementsToCheck.forEach(e=>{e.isEnabled&&e.element&&e.element.attr("disabled",!e.isEnabled(this._mouseEvent))}))},r.prototype._createActionButtons=function(e){var t=$("<div/>").addClass("button-group");return(e=e instanceof Array?e:[e]).forEach(e=>{var n=this._createActionButton(e);t.append(n)}),t},r.prototype._createActionButton=function(e){var t=e.label,n=e.icon,o=e.click;let r=e.isEnabled,a=!1;e.action&&(a=e.action.isPro(),t||(t=i.GLocale.get(e.action.getTitle())),n||(n=e.action.getIcon()||e.action.getGroupIcon()),o||(o=function(){gDesigner.executeAction(e.action.getId(),void 0,"touchmenu")}),r||(r=function(){return gDesigner.canExecuteAction(e.action.getId())}));var s=$("<div></div>").gPro({pro:a});e.action&&s.addClass("action").attr("data-action",e.action.getId()).data("action",e.action);var l=$("<button></button>").addClass("action-button").addClass(e.longButton?"long-button":"").toggleClass("g-active",!0===e.active).appendTo(s).on("mousedown",(function(e){e.preventDefault()}));return this._elementsToCheck.push({element:l,isEnabled:r}),n&&(this._updateIcon($("<span></span>").appendTo(l),n),l.addClass("icon")),e.label&&l.append($("<span></span>").addClass("label").text(e.label)),e.isMenu&&l.append($("<span></span>").addClass("icon item-tail gravit-icon-chevron-left-small")),o&&l.on("click",o),s},r.prototype._createActionButtonWithMenu=function(e,t,n){var i=$("<div/>").addClass("action-button-with-menu");i.append(this._createActionButton({action:e,label:t,longButton:!0}));var o=new v(null,"g-context-menu");o.__which="touchmenu",n.forEach(e=>{if(e instanceof M)o.createAddItem(e,null,null,null,e.getId()===G.ID?r.ID:null);else{var t=o.createAddItem(e.caption,e.click);t.setIcon(e.icon),t.addEventListener(_.UpdateEvent,(function(){t.setEnabled(e.isEnabled())}))}});var a=$("<button/>").addClass("open-menu icon gravit-icon-chevron-left-small").on("click",e=>{o.open($(e.target),b.Position.Right_Bottom,b.Position.Center)});return this._elementsToCheck.push({element:a,isEnabled:()=>n.some(e=>e.isEnabled())}),i.append(a),i},r.prototype._createActionButtonMenu=function(e,t,n,i){var o=new v(null,"g-context-menu");o.__which="touchmenu",n.forEach(e=>{if(e instanceof M)o.createAddItem(e);else{var t=o.createAddItem(e.caption,e.click);t.setIcon(e.icon),t.addEventListener(_.UpdateEvent,(function(){e.update&&e.update(t)}))}});var r=$("<div/>").addClass("action-menu-button");return r.append(this._createActionButton({label:t,icon:e,click:e=>{o.open($(e.target).closest(".action-menu-button"),b.Position.Right_Bottom,b.Position.Center)},isMenu:!0,isEnabled:i})),r},r.prototype._createSelectMenuButton=function(){var e=$("<div/>").addClass("select-menu-button");return e.append(this._createActionButton({label:i.GLocale.get(new i.GLocaleKey("GContextMenu","text.select")),click:e=>{var t=this._getHitsElments(),n=gDesigner.getActiveDocument().getEditor(),i=$("<div/>").gOverlay({releaseOnClose:!0,offsetX:100,offsetY:-25,clazz:"selected-menu-overlay"}),o=$("<div/>").appendTo(i);i.gOverlay("open",$(e.target).closest(".select-menu-button"));o.gSelectedPanel({clickCallback:e=>{n.clearSelection(),n.updateSelection(!1,[e])},renderFinishCallback:()=>{i.gOverlay("relayout")}}).gSelectedPanel("setSelections",t)},isMenu:!0,isEnabled:e=>{var t=this._getHitsElments(e);return!!(t&&t.elementHits&&t.elementHits.length>0)}})),e},r.prototype._updateIcon=function(e,t){e.empty(),e.attr("class","icon "+t)},r.prototype._getSelectedItems=function(){var e=gDesigner.getActiveDocument();if(e){var t=e.getEditor();if(t){var n=t.getSelection();return n||[]}}return[]},r.prototype._getFirstSelectedImageElement=function(){var e=this._getSelectedItems();return e&&e.length>0?e.find(e=>e instanceof i.GImage):null},r.prototype._getFirstSelectedTextElement=function(){var e=this._getSelectedItems();return e&&e.length>0?e.find(e=>e instanceof i.GText):null},r.prototype._setAllSelectionsHidden=function(){var e=this._getSelectedItems();e&&e.length>0&&o.GEditor.tryRunTransaction(gDesigner.getActiveDocument().getScene(),(function(){for(var t=0;t<e.length;t++)e[t].setProperty("vis",!1),e[t].removeFlag(i.GNode.Flag.Highlighted)}),i.GLocale.get(new i.GLocaleKey("GCommonNames","action.toggle-visibility")))},r.prototype._setAllSelectionsLocked=function(){var e=this._getSelectedItems();e&&e.length>0&&o.GEditor.tryRunTransaction(gDesigner.getActiveDocument().getScene(),(function(){for(;e.length>0;)e[0].setProperty("lkt",i.GBlock.LockType.Full),e[0].removeFlag(i.GNode.Flag.Highlighted),e[0].accept((function(e){e.removeFlag(i.GNode.Flag.Selected)}))}),i.GLocale.get(new i.GLocaleKey("GCommonNames","action.toggle-lock")))}},function(e,t,n){"use strict";n(25),n(3);const i=n(386);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,{edit:!1,inspect:!1,copy:!1,owner:!0,share:!1,sharing:!1,isPrivate:!1,comment:!1,role:i.ROLES.NO_ACCESS_ROLE,realtimeCollaborators:[]},e)}o.prototype.edit=!1,o.prototype.inspect=!1,o.prototype.copy=!1,o.prototype.owner=!0,o.prototype.share=!1,o.prototype.sharing=!1,o.prototype.comment=!1,o.prototype.role=i.ROLES.NO_ACCESS_ROLE,o.prototype.isPrivate=!1,o.prototype.realtimeCollaborators=[],o.prototype.toString=function(){return"Object [GShareState]"},e.exports=o},function(e,t,n){"use strict";n(25),n(9),n(163),n(84),n(171),n(28),n(19),n(24),n(111),n(90),n(3);var i=n(1);const{gApi:o,IS_TRUNK:r,IS_BETA:a,NODE_ENV:s,trunkURL:l,betaURL:c,ltsURL:d,rcURL:u,prodURL:p,HAS_ANNOTATIONS:g}=n(12),{sleep:h,watchDog:f}=n(32),m=n(36),y=n(76),v=[{id:"copy",label:new i.GLocaleKey("GShareDialog","text.allow-to-save-label"),info:new i.GLocaleKey("GShareDialog","text.allow-to-save-info"),pro:!1,sharePermissions:{copy:!0,comment:!!g},analyticsRef:"save"},{id:"inspect",label:new i.GLocaleKey("GShareDialog","text.allow-to-inspect-label"),info:new i.GLocaleKey("GShareDialog","text.allow-to-inspect-info"),pro:!0,default:!0,sharePermissions:{inspect:!0,comment:!!g},analyticsRef:"inspect"}];e.exports=class{constructor(e,t){this._user=e,this._dialog=$("<div/>").append($("<div/>").addClass("header").append($("<span/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.title")))).append($("<div/>").addClass("share-switch").append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.switch-on")))).append($("<div/>").addClass("editor").append($("<label/>").addClass("g-switch").append($("<input>").attr("type","checkbox").on("change",e=>{const t=$(e.target).closest("input").is(":checked");gDesigner.stats("sharedialog_click_sharing",t);let n={access:t};t&&this._lastSharePermissions&&(n=Object.assign({},this._lastSharePermissions,n)),this._toggleLoading(!0),this._setSharePermissions(n).catch(this._handleException).finally(()=>{this._toggleLoading(!1)})})).append($("<div></div>")))))).append($("<span/>").addClass("subtitle").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.subtitle-on")))).append($("<div/>").addClass("share-link").append($("<div/>").addClass("share-input").append($("<input>").attr("type","text").attr("readonly",!0)).append($("<div/>").addClass("share-copied").append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.copied")))))).append($("<div/>").addClass("share-copy").addClass("g-highlight-button").addClass("highlighted").append($("<span/>").addClass("icon").addClass("gravit-icon-share-copy")).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.copy")))).on("click",async e=>{const t=$(e.target).closest(".share-link"),n=t.find("input").val();n&&n.trim().length&&(gDesigner.stats("sharedialog_click_copy"),gContainer.copyToClipboard(n.trim()).then(async()=>{const e=t.find(".share-copied");e.addClass("visible"),await h(2e3),e.removeClass("visible")}).catch(e=>{m.alert(e&&e.message||i.GLocale.get(new i.GLocaleKey("GShareDialog","text.failed-copying-to-clipboard")))}))}))).append($("<div/>").addClass("share-settings").append(v.map(e=>{let{id:t,label:n,info:o,sharePermissions:r,shareBy:a,pro:s,default:l,analyticsRef:c}=e;const d=$("<div/>").attr("id",t).addClass("share-setting-container"),u=e=>{this._toggleLoading(!0);const t=$(e.target).closest("input").is(":checked");gDesigner.stats("sharedialog_click_${analyticsRef}",t);const n=Object.entries(r).reduce((e,n)=>(e[n[0]]=n[1]&&t,e),{}),i=Object.assign(this._getSharePermissions(),n,{access:!0});this._lastSharePermissions=i,this._setSharePermissions(i).catch(this._handleException).finally(()=>{this._toggleLoading(!1)})},p=()=>gDesigner.stats("sharedialog_nonprotriespro_".concat(c));return $("<label/>").addClass("share-setting-input").append($("<input>").attr("type","checkbox").on("click",s?f.trap(u,null,p):u).on("mousedown",s?f.trap(null,null,p):()=>{})).append($("<div/>").addClass("share-setting-panel").append($("<span/>").addClass("title").text(i.GLocale.get(n)).append(s?$("<span></span>").gPro():"")).append($("<span/>").addClass("subtitle").text(i.GLocale.get(o)))).appendTo(d),a&&this._buildShareByInput(a).appendTo(d),d}))).gDialog({releaseOnClose:!0,className:"g-share-dialog-legacy"}),$("<div/>").addClass("g-btn-close").append($("<span />").addClass("gravit-icon-close")).on("click",()=>this.close()).appendTo(this._dialog),this._toggleLoading(!0),o.getFile(t.getId(),!0).then(async e=>{if(this._file=e,this._updateProperties(),this._shareList&&this._shareList.length)this._lastSharePermissions=this._getSharePermissions();else{const e=v.map(e=>{let{sharePermissions:t}=e;return t}).reduce((e,t)=>Object.assign({},t,e),{});this._lastSharePermissions=e,await this._setSharePermissions(Object.assign(e,{access:!0}))}}).catch(this._handleException).finally(()=>{this._toggleLoading(!1)})}_handleException(e){m.alert(o.formatError(e))}_isSharingByLink(){return!0}_getSharePermissions(){if(this._shareList){const e=this._shareList.reduce((e,t)=>Object.assign(e,t),{});return v.filter(e=>{let{pro:t}=e;return!!t}).forEach(t=>{let{sharePermissions:n}=t;Object.entries(n).forEach(t=>{let[n,i]=t;Object.assign(e,{[n]:f.check(e[n],i)})})}),e}return{}}async _setSharePermissions(e){e&&Object.keys(e).length?(delete e.role,this._isSharingByLink()&&(this._shareList&&this._shareList.length?await Promise.all(this._shareList.map(t=>{let{token:n}=t;return o.updateShare(n,e)})):await o.createShare(this._file.id,e))):this._isSharingByLink()&&await Promise.all(this._shareList.map(e=>{let{token:t}=e;return o.deleteShare(t)})),this._file=await o.getFile(this._file.id,!0),this._updateProperties()}_updateProperties(){const e=this._file.link_accesses||[];this._shareList=e;const t=this._shareList.length&&!!this._shareList[0].access,n=this._shareList.length&&!!this._shareList[0].copy,o=this._shareList.length&&!!this._shareList[0].inspect;this._dialog.toggleClass("share-on",!!t),this._dialog.find(".subtitle").first().text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.subtitle-".concat(t?"on":"off")))),this._dialog.find(".share-switch > span").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.switch-".concat(t?"on":"off")))),this._dialog.find(".share-switch input").prop("checked",t),this._dialog.find("#copy > .share-setting-input > input").prop("checked",n),this._dialog.find("#inspect > .share-setting-input > input").prop("checked",o);let r="";if(this._shareList&&this._shareList.length){const e=new URL(this._getOrigin()),t=e.searchParams;this._isSharingByLink()?t.set("token",this._shareList[0].token):t.set("d",this._file.id),r=e.toString()}this._dialog.find(".share-link > .share-input > input").val(r)}_getOrigin(){return gContainer.getRuntime()===y.Runtime.Browser||gContainer.getRuntime()===y.Runtime.PWA?location.origin:r?l:a?c:"rc"===s?u:"lts"===s?d:p}_buildShareByInput(e){if("user"===e)return $("<div/>").css("display","none").addClass("share-emails").gShareUserInput()}_toggleLoading(e){this._dialog.toggleClass("g-loading",!!e)}open(){this._dialog.gDialog("open",!0)}close(){this._dialog.gDialog("close")}}},function(e,t,n){"use strict";n(9),n(163),n(84),n(14),n(29),n(19),n(24),n(111),n(90),n(3),n(58),n(25);var i=n(1),o=n(16);const{FileExtended:r,gApi:a,trunkURL:s,betaURL:l,ltsURL:c,rcURL:d,prodURL:u,DateAPI:p,ShareRoles:g,Share:h,REMOVE_GUEST_USER_WHEN_ROLE_IS_NO_ACCESS:f,ENABLE_GUEST_ACCESS:m,defaultUserSettings:{share:{defaults:{private:{pro:y=!0}={}}={},quotas:{free:{private:v=0}={}}={}}={}}={}}=n(12),{IS_TRUNK:_,IS_BETA:b,IS_RC:w,IS_LTS:C}=n(198),{sleep:E}=n(32),S=n(175),G=n(36),A=n(76),T=n(348),P=n(386),L=n(232),D=n(389),x=n(305);class I{constructor(e,t,n){this._user=e,this._sharedFile=new r,this._initialSharedFile=null,this._statistics=null,this._storageItem=t,this._closeCallback=n}_initialize(){if(!this._isInitialized)return this._initLayout(),this._toggleLoading(!0),this._loadShare().then(()=>this._loadShareInit()).then(()=>this._updateProperties()).then(()=>{this._isInitialized=!0}).catch(e=>this._handleException(e)).finally(()=>this._toggleLoading(!1))}async _loadShareInit(){if(!this._sharedFile.getPublicShare()){const t=P.ROLES.DEFAULT_PUBLIC_ROLE;if(t){const n=(new h).assignRole(t);return this._storageItem.supportsExternalSharing()?this._storageItem.requestExternalShare(null,n).then(()=>e.call(this,n)).catch(e=>this._handleException(e)):e.call(this,n)}}function e(e){return a.createShare(this._storageItem.getId(),e).then(()=>(gDesigner.hasEventListeners(x)&&gDesigner.trigger(new x(x.Type.ShareCreated,this._storageItem)),this._loadShare()))}}_initLayout(){this._infoSection=$("<div/>").addClass("share-info-section").css("display","none").append($("<span/>").addClass("gravit-icon-info")).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.participants-will-be-invited")))),this._dialog=$("<div/>").append($("<div/>").addClass("header").append($("<span/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.title"))))).append($("<div/>").addClass("share-link").append($("<div/>").addClass("share-input").append($("<input>").attr("type","text").attr("readonly",!0)).append($("<div/>").addClass("share-copied").append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.copied")))))).append($("<div/>").addClass("share-copy").addClass("g-highlight-button").addClass("highlighted").append($("<span/>").addClass("icon").addClass(L["gravit-icon-share-copy"])).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.copy")))).on("click",async e=>{const t=$(e.target).closest(".share-link"),n=t.find("input").val();if(n&&n.trim().length)return gDesigner.stats("sharedialog_click_copy"),gContainer.copyToClipboard(n.trim()).then(async()=>{const e=t.find(".share-copied");e.addClass("visible"),await E(2e3),e.removeClass("visible")}).catch(e=>{G.alert(e&&e.message||i.GLocale.get(new i.GLocaleKey("GShareDialog","text.failed-copying-to-clipboard")))})}))).append(this._buildShareByLink()).append(this._buildShareByUser()).append(this._infoSection).gDialog({releaseOnClose:!0,className:"g-share-dialog",closeCallback:()=>{this._sendInvitationEmails(),this._closeCallback&&this._closeCallback()}}),$("<div/>").addClass("g-btn-close").append($("<span />").addClass("gravit-icon-close")).on("click",()=>this.close()).appendTo(this._dialog)}_getRole(e){return P.makeFromShare(e)}_loadShare(){if(!this._storageItem.hasMixin(D))throw console.log("Storage item not supported"),"Storage not supported";return this._storageItem.getOrCreateCollaborativeFile().then(e=>{this._sharedFile=e,this._initialSharedFile||(this._initialSharedFile=this._sharedFile.clone())}).then(async()=>{this._statistics=await a.getSharingStatistics()})}_setSelectedPrivateShare(e){if(this._dialog.find(".share-by-user > .share-settings > .share-setting.g-selected").removeClass("g-selected"),e){const t=this._dialog.find('.share-by-user > .share-settings > .share-setting[user_id="'.concat(e,'"]')).addClass("g-selected")[0];t&&t.scrollIntoView({behavior:"smooth"})}}_handleException(e){console.error(e.stack?e.stack:e),G.alert(a.formatError(e)),this._toggleLoading(!1)}_getPrivateAndInvitedShareList(){const e=this._sharedFile.getPrivateShareList().filter(e=>!e.owner||e.id!==this._user.getUID()),t=this._sharedFile.getInvitedShareList&&this._sharedFile.getInvitedShareList()||[];return e.concat(t)}_getShareListLayout(e){return i.GUtil.bubbleSort(e,(e,t)=>{let{created:n}=e,{created:i}=t;return p.gt(n,i,!1)?1:p.lt(n,i,!1)?-1:0}).map(e=>{const t=new S(e),n=t.getUID(),o=t.getEmail(),{guest:r=!1}=e,s=this._getRole(e),l=this._canResendInvitationEmail(e)?[{icon:"gravit-icon-resend-invitation-email",label:i.GLocale.get(new i.GLocaleKey("GShareDialog","text.resend-invitation-email")),click:()=>{gDesigner.stats("sharedialog_private-share_resend"),this._toggleLoading(!0),a.share.sendInvitationEmails(this._storageItem.getId(),[o]).then(()=>{G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.resent-invitation-email")).replace("%email",o))}).catch(e=>this._handleException(e)).finally(()=>this._toggleLoading(!1))}}]:[],c=this._createShareSetting({label:o,icon:this._getAvatar(t),defaultRole:P.ROLES.DEFAULT_PRIVATE_ROLE,removeCallback:()=>{this._unshareWithUser({id:n,email:o,role:s})},buttons:l}).attr("user_id",n).on("click",()=>{this._setSelectedPrivateShare(n)});return c.find(".g-role-selector").gRoleSelector("role",s).on("rolechange",t=>{const a=$(t.target).closest(".g-role-selector").gRoleSelector("role");a?f&&r&&a.is(g.NoAccess)?this._unshareWithUser({id:n,email:o,role:a}):this._shareWithUser({id:n,email:o,role:a},e.assignRole(a)).catch(()=>{$(t.target).closest(".g-role-selector").gRoleSelector("restoreRole")}):G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.role-required")))}),c})}_updateProperties(){if(this._sharedFile.getPublicShare()){const e=this._getRole(this._sharedFile.getPublicShare());this._dialog.find(".share-by-link .g-role-selector").gRoleSelector("role",e)}this._infoSection.css("display",this._hasNewInvitationEmails()?"":"none");const e=this._getPrivateAndInvitedShareList(),t=gDesigner.getLicense();if(0===t.getPrivateShareQuota())this._dialog.find(".share-by-user").addClass("g-disabled").on("click",e=>{$(e.target).hasClass("share-by-user")&&gDesigner.handlePROFeatureInterruption()});else if(t.getPrivateShareQuota()>0){const n=this._statistics?this._statistics.getPrivateShareQuota():0,o=t.getPrivateShareQuota()-n;this._dialog.find(".share-by-user .subtitle").css("display","").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.projects-left")).replace("%number",o));const r=o<=0&&!(e&&e.length);this._dialog.find(".share-by-user .add-button").prop("disabled",r)}else this._dialog.find(".share-by-user .subtitle").css("display","none"),this._dialog.find(".share-by-user .add-button").prop("disabled",!1);this._dialog.find(".share-by-user > .share-settings").empty(),e&&e.length&&this._dialog.find(".share-by-user > .share-settings").append(this._getShareListLayout(e));let n="";const o=new URL(this._getOrigin()),r=o.searchParams;this._sharedFile.getPublicShare()?r.set("token",this._sharedFile.getPublicShare().token):r.set("d",this._storageItem.getId()),n=o.toString(),this._dialog.find(".share-link > .share-input > input").val(n)}_getOrigin(){return gContainer.getRuntime()===A.Runtime.Browser||gContainer.getRuntime()===A.Runtime.PWA?location.origin:_?s:b?l:w?d:C?c:u}_buildShareByLink(){const e=this._createShareSetting({icon:$("<span/>").addClass("gravit-icon-public-share-link").addClass("icon"),label:i.GLocale.get(new i.GLocaleKey("GShareDialog","text.public-share-link")),defaultRole:P.ROLES.DEFAULT_PUBLIC_ROLE}),t=e.find(".g-role-selector");return e.find(".g-role-selector").on("rolechange",()=>{const n=t.gRoleSelector("role");if(!n)return void G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.role-required")));gDesigner.stats("sharedialog_public-share_role",n.name);const o=this._sharedFile.getPublicShare();if(o)return this._toggleLoading(!0),this._storageItem.supportsExternalSharingByLink()?this._storageItem.updateDomainShare(n).then(()=>{r.call(this)}).catch(t=>{G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.error-change-role-failed"))),e.find(".g-role-selector").gRoleSelector("restoreRole"),this._toggleLoading(!1),console.error("updateDomainShare error: ",t)}):r.call(this);function r(){a.updateShare(o.token,o.assignRole(n)).then(()=>this._loadShare()).then(()=>this._updateProperties()).catch(e=>this._handleException(e)).finally(()=>this._toggleLoading(!1))}}),$("<div/>").addClass("share-settings-section").append($("<div/>").addClass("share-settings-container").addClass("share-by-link").append($("<div/>").addClass("share-settings").append(e)))}_buildShareByUser(){const e=$("<input/>").addClass("private-share-email-input").attr("placeholder",i.GLocale.get(new i.GLocaleKey("GShareDialog","text.private-share-placeholder"))).attr("type","email").on("keypress",e=>{const t=e.which||e.charCode||e.keyCode;if(o.GKey.translateKey(t)===o.GKey.Constant.ENTER)return e.preventDefault(),e.stopPropagation(),$(e.target).closest(".share-by-user").find(".add-button").trigger("click"),!1}),t=$("<div/>").gRoleSelector({defaultRole:P.ROLES.DEFAULT_PRIVATE_ROLE});return t.on("rolechange",()=>{const e=t.gRoleSelector("role");gDesigner.stats("sharedialog_private-share_role",e.name)}),$("<div/>").addClass("share-settings-section").append($("<div/>").addClass("share-settings-container").addClass("share-by-user").append($("<div/>").addClass("share-settings-header").append($("<div/>").addClass("share-settings-header-caption").append($("<span/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.private-sharing"))).gPro({pro:y||-1!==v,badgeAlwaysVisible:!0})).append($("<span/>").addClass("subtitle"))).append($("<div/>").addClass("share-settings-header-input").append($("<div/>").addClass("input-section").append(e).append(t)).append($("<button/>").addClass("add-button").addClass("g-highlight-button highlighted").text(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.private-sharing-add"))).on("click",n=>{const i=(e.val()||"").trim(),o=t.gRoleSelector("role");this._tryPrivateShareWithUser(i,o,n)})))).append($("<div/>").addClass("share-settings")))}async _tryPrivateShareWithUser(e,t,n){if(gDesigner.stats("sharedialog_private-share_add"),!e)return void G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.empty-email")));if(!t)return void G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.role-required")));this._toggleLoading(!0);try{if(this._storageItem instanceof T.Item&&!await this._storageItem.isEmailFromCorporateDomain(e))return this._handleException(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.you-can-not-invite-user-from-another-domain"))),void this._toggleLoading(!1)}catch(e){}const o=e=>{this._toggleLoading(!0);const n=(new h).assignRole(t),i=this._dialog.find(".share-settings-header-input"),o=i.find(".g-role-selector"),r=i.find(".private-share-email-input");this._shareWithUser(e,n,!1).then(e=>{e?r.val(null):gDesigner.stats("sharedialog_invalid-email")}).catch(()=>{o.gRoleSelector("restoreRole")}).finally(()=>{this._toggleLoading(!1)})};try{let t=await a.listUsers({q:e,all:!0}).then(e=>e.filter(e=>e.id!==this._user.getUID()).map(e=>new S(e)));const r=t&&t.length>0;let s=!0;if(r){this._storageItem instanceof T.Item&&this._storageItem.getCloudClient().isCorporate()&&(t=t.filter(e=>e.corporate_provider&&e.corporate_provider===this._storageItem.getCloudClient().getCorporateProviderName()));const e=(this._sharedFile.getPrivateShareList()||[]).filter(e=>e.role!==g.Owner.id).map(e=>e.id);e&&e.length&&(t=t.filter(t=>{let{id:n}=t;return!e.includes(n)}),s=!1)}if(t&&t.length>0)if(this._toggleLoading(!1),t.length>1){const i=$(n.target).closest(".share-settings-header-input");this._pickUser(e,t,i).then(t=>{t&&o(Object.assign(t,{email:e}))}).catch(this._handleException)}else o(Object.assign(t[0],{email:e}));else s?o({id:e,email:e}):this._handleException(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.private-share-no-options-left")).replace("%email",e))}catch(e){this._handleException(e)}}_createShareSetting(e){let{icon:t,label:n,defaultRole:i,removeCallback:o,buttons:r}=e;return $("<div/>").addClass("share-setting").append(t||"").append($("<span/>").addClass("label").text(n)).append($("<div/>").gRoleSelector({defaultRole:i,buttons:r})).append(o?$("<div/>").addClass("gravit-icon-x-delete").on("click",o):"")}_getAvatar(e){const t=e.getUserColor(),{avatar:n}=e,i=$("<div/>").addClass("avatar");return this._shouldShowAvatar(e)?this._isSVGAvatar(n)?$(n).appendTo(i):i.css({backgroundImage:'url("'.concat(n,'")')}):(e.getFirstName()&&!e.guest||(e.name=e.getFullUserName()),i.css("border-color",t).css("background-color",t).append($("<span/>").text(e.getUserNameInitials()))),i}_getAvatarForPicker(e){const t=e.getUserColor(),{avatar:n}=e,i=$("<div/>").append($("<div/>").addClass("g-user-selector-avatar").css("border-color",t).css("background-color",t).append($("<span/>").text(e.getUserNameInitials()))).addClass("g-user-selector-all-avatar");return this._shouldShowAvatar(e)&&(this._isSVGAvatar(n)?$(n).appendTo(i):i.append($("<div/>").addClass("avatar").append($("<div/>").addClass("gravatar-avatar").css({backgroundImage:'url("'.concat(n,'")')})))),i}_isSVGAvatar(e){return"<svg>"===e.substr(0,"<svg>".length)}_shouldShowAvatar(e){return!!e.hasOwnPictureAvatar()||!(!e.avatar||-1===e.avatar.indexOf("static/assets"))}_isSameUser(e,t){let n=Object.assign({},e),i=Object.assign({},t);return n.id||(n.id=n.email),i.id||(i.id=i.email),e.id===t.id||e.id===t.email||e.id===t.login||e.email===t.email||e.login===t.email}_shareWithUser(e,t){let n,o,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("object"!=typeof e||!e.email)throw Error("Invalid args");({email:o,id:n}=e),n||(n=o);const a=this._user;return n===a.id||n===a.email||n===a.login?(G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.you-can-not-invite-yourself"))),Promise.reject()):(this._toggleLoading(!0),this._storageItem instanceof T.Item?this._storageItem.isEmailFromCorporateDomain(o).then(e=>{if(e)return this._prepareShare(o,t,n,r);throw i.GLocale.get(new i.GLocaleKey("GShareDialog","text.you-can-not-invite-user-from-another-domain"))}).catch(e=>{throw this._handleException(e),e}):this._prepareShare(o,t,n,r))}_prepareShare(e,t,n,i){return this._storageItem.supportsExternalSharing()?this._storageItem.requestExternalShare(e,t).then(()=>this._processShare(e,t,n,i)).catch(e=>{throw this._handleException(e),e}):this._processShare(e,t,n,i)}_processShare(e,t,n,o){const r=o?t:Object.assign(t,{sendEmail:o,validated:!0}),s=this._storageItem.toString();let l=!1;return this._storageItem instanceof T.Item&&(l=this._storageItem.getCloudClient().isCorporate()),s.indexOf("GCloudStorage")>=0?gDesigner.stats("sharedialog_private-share_cloud"):s.indexOf("GGoogleDriveStorage")>=0?gDesigner.stats("sharedialog_private-share_".concat(l?"corporate-":"","googledrive")):s.indexOf("GSharePointStorage")>=0&&gDesigner.stats("sharedialog_private-share_".concat(l?"corporate-":"","sharepoint")),a.shareWithUser(this._storageItem.getId(),n,r).then(async e=>(await this._loadShare(),this._updateProperties(),this._setSelectedPrivateShare(e.user_id),e)).catch(t=>{if(t.status)switch(t.status){case a.HTTP_STATUS_CODES.CONFLICT:return void G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.you-can-not-invite-yourself")));case a.HTTP_STATUS_CODES.NOT_FOUND:return void G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.invalid-email")).replace("%email",e));case a.HTTP_STATUS_CODES.FORBIDDEN:return void("only same domain users allowed"===t.message?G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.you-can-not-invite-user-from-another-domain"))):G.alert(i.GLocale.get(new i.GLocaleKey("GCommonNames","error.http.forbidden"))))}this._handleException(t)}).finally(()=>this._toggleLoading(!1))}_unshareWithUser(e){const{email:t,role:n}=e,{id:i=t}=e;return this._toggleLoading(!0),this._storageItem.supportsExternalSharing()?this._storageItem.requestExternalUnShare(t,n).then(()=>o.call(this)).catch(e=>{this._handleException(e)}):o.call(this);function o(){return a.unshareWithUser(this._storageItem.getId(),i).then(()=>this._setSelectedPrivateShare(null)).then(()=>this._loadShare()).then(()=>this._updateProperties()).catch(e=>this._handleException(e)).finally(()=>this._toggleLoading(!1))}}_toggleLoading(e){this._dialog.toggleClass("g-loading",!!e)}async open(){await this._initialize(),this._dialog.gDialog("open",!0)}close(){this._dialog.gDialog("close")}_canResendInvitationEmail(e){const t=P.makeFromShare(e);if(t&&!t.is(g.NoAccess)){return(this._initialSharedFile&&this._initialSharedFile.getPrivateShareList().map(e=>e.id).concat(this._initialSharedFile.getInvitedShareList().map(e=>e.id))||[]).includes(e.id)}return!1}_hasNewInvitationEmails(){return this._getNewAddedShareEmails().length>0}async _sendInvitationEmails(){const e=this._getNewAddedShareEmails();if(e&&e.length>0)return m?this._sendGuestInvitation(e):this._sendUserInvitation(e)}_sendUserInvitation(e){return gDesigner.stats("sharedialog_private-share_invite"),a.share.sendInvitationEmails(this._storageItem.getId(),e).then(()=>{this._showSentInvitationEmailAlert(e)})}_sendGuestInvitation(e){let t=[],n=e.slice();return Promise.all(n.map(e=>a.signupGuestUser({email:e,file_id:this._storageItem.getId()}).catch(()=>{t.push(e)}))).then(()=>{if(t.length)return a.share.sendInvitationEmails(this._storageItem.getId(),t).catch(()=>{})}).then(()=>{this._showSentInvitationEmailAlert(e)})}_showSentInvitationEmailAlert(e){G.alert(i.GLocale.get(new i.GLocaleKey("GShareDialog","text.sent-invitation-email")).replace("%emails",e.join(", ")),null,{className:"g-sent-invitation-email-dialog"})}_pickUser(e,t,n){return new Promise(i=>{let o;const r=$("<div/>").addClass("g-user-selector").append($("<div/>").addClass("g-user-selector-container").append(t.map(t=>$("<div/>").addClass("g-user-selector-content").append(this._getAvatarForPicker(t)).append($("<div/>").addClass("g-user-selector-info").append($("<span/>").text(t.getFullUserName())).append($("<span/>").text(e))).on("click",()=>{o=t,r.gOverlay("close")})))).gOverlay({clazz:"g-share-dialog-user-selector",releaseOnClose:!0,padding:!1,closeCallback:()=>i(o)}).gOverlay("open",n)})}_getNewAddedShareEmails(){const e=this._initialSharedFile&&this._initialSharedFile.getPrivateShareList().map(e=>e.id)||[],t=this._initialSharedFile&&this._initialSharedFile.getInvitedShareList().map(e=>e.email)||[];return this._sharedFile.getPrivateShareList().filter(t=>!e.includes(t.id)).filter(e=>!t.includes(e.email)).map(e=>e.email).concat(this._sharedFile.getInvitedShareList().filter(e=>!t.includes(e.email)).map(e=>e.email))}}I.prototype._isInitialized=!1,I.prototype._sharedFile=null,e.exports=I},function(e,t,n){"use strict";n(9),n(129),n(14),n(115),n(58),n(19),n(24);var i=n(12);const o=n(264),r=n(202),a=n(78),s=n(1072),l=n(175),c=n(352);var d=null;function u(e){if(d)throw new Error("GCloudCommunicationManager is a singleton");e.addEventListener(o,this._userLoggedEvent,this),e.addEventListener(a,this._documentEvent,this),d=this,this.initialize()}u.clearSingleton=function(){d=null},u.prototype._fileCacheMapExt={},u.prototype._userCache=null,u.prototype.getUser=async function(){this._initializeUserCache();const e=await this._userCache.get();return e||this._userCache.reset(),e},u.prototype.confirmEmail=function(e){return i.gApi.confirmEmail(e).then(e=>(this._removeUserCache(),e))},u.prototype.updateUser=function(e){return i.gApi.updateUser(e).then(e=>(this._removeUserCache(),new l(e)))},u.prototype.updateAvatar=function(e){return i.gApi.updateAvatar(e).then(e=>(this._removeUserCache(),e))},u.prototype.useAuthorizationToken=function(e){this._removeUserCache(),i.gApi.useAuthorizationToken(e)},u.prototype.userPropertiesChanged=function(){this._removeUserCache()},u.prototype.getFileExtendedCached=async function(e){var t=(e=e||gDesigner.getActiveDocument()).getId();return t?(this._fileCacheMapExt[t]||(this._fileCacheMapExt[t]=new s(()=>this._getFileExtended(e))),this._fileCacheMapExt[t].get()):null},u.prototype._userLoggedEvent=function(e){const{user:t}=e;t?(this._initializeUserCache(),this._userCache.setCacheValue(t)):this._removeUserCache(),this._resetAllCache()},u.prototype._removeUserCache=function(){this._userCache=null},u.prototype._initializeUserCache=async function(){this._userCache||(this._userCache=new s(()=>i.gApi.getUser().then(e=>new l(e)).catch(()=>null),i.USER_CHECK_MIN_WAIT))},u.prototype._updateDocState=function(e){this._resetFileCache(e)},u.prototype._resetFileCache=function(e){if(e){var t=e.getId();return t&&this._fileCacheMapExt[t]?this._fileCacheMapExt[t].reset():void 0}},u.prototype._resetAllCache=function(){this._fileCacheMapExt={}},u.prototype._documentEvent=function(e){const t=e.document;if(t)switch(e.type){case a.Type.Added:this._updateDocState(t),t.addEventListener(c,this._collaborationEvent,this);break;case a.Type.Removed:t.removeEventListener(c,this._collaborationEvent,this);break;case a.Type.Modified:this._updateDocState(t)}},u.prototype._collaborationEvent=function(e){const{sender:t,type:n}=e;n===c.Type.ShareUpdate&&this._updateDocState(t)},u.prototype._getFileExtended=async function(e){const t=(e=e||gDesigner.getActiveDocument())&&e.getStorageItem();if(!t)return null;const n=t.getId();return n?t instanceof r.Item?this.getFileExtended(n).catch(()=>null):t&&t.supportsSharing()&&t.supportsShadowFile()?t.getOrCreateCollaborativeFile():null:null};var p={};async function g(e,t,n){let o,r;try{if(o=i.gApi[t](n),!(o instanceof Promise))return o;r=await o}catch(e){throw e}finally{delete e[n]}return r}u.prototype.initialize=function(){const e=Object.keys(d).filter(e=>e.startsWith("get")),t=i.CACHED_GAPI_FUNCTIONS.filter(t=>/^is|^get/.test(t)&&!e.includes(t));for(let e of t)p[e]={},d[e]=async function(e){const t=p[this];if(void 0!==t[e])return t[e];const n=g(t,this,e);return n instanceof Promise&&(t[e]=n),n}.bind(e)},e.exports=u},function(e,t,n){"use strict";var i=n(17);n(9),n(25);var o=i(n(10));n(1205);const r=n(721),a=n(1439),s=n(351),l=n(1206),c=n(544),{SHARE_ENGINE:d,HAS_ANNOTATIONS:u,ShareRoles:p,FileStatus:{APPROVED:g},FILE_REVIEW_ENABLED:h,LEGACY_SHARE_DIALOG:f}=n(12);function m(e){this._state=new a,d&&gDesigner.addEventListener(l,this._shareStateChangedEvent,this),gDesigner.addEventListener(r,this._applicationStatusEvent,this),gDesigner.addEventListener(c,this._licenseChangedEvent,this),this._init(e)}m.prototype._init=async function(e){e&&e()},m.prototype._shareStateChangedEvent=function(e){const t=new a(Object.assign({},this._state)),{owner:n,share:i,sharing:o,edit:r,inspect:s,copy:l,comment:c,isPrivate:d,role:p,realtimeCollaborators:g=[]}=e.state;n?Object.assign(t,{edit:!0,saveAs:!0,export:!0,inspect:!0,copyPaste:!0,comment:!!u}):Object.assign(t,{edit:r,saveAs:l,export:l,copyPaste:l,inspect:s,comment:c}),Object.assign(t,{isShareEnabled:i,isSharing:o,isPrivateSharing:d,role:p,realtimeCollaborators:g}),this._setState(t,e.document)},m.prototype._setState=function(e,t){o.default.equals(e,this._state,!0)||(this._state=e,this._triggerAppStateEvent(t,e))},m.prototype._triggerAppStateEvent=function(e,t){gDesigner.hasEventListeners(s)&&gDesigner.trigger(new s(e,t))},m.prototype._applicationStatusEvent=function(e){e.status===r.Status.Ready&&gDesigner.isAnonymous()&&gDesigner.addNotification({anonymous:!0})},m.prototype._licenseChangedEvent=function(e){},m.prototype.isShareEnabled=function(){return!!this._state.isShareEnabled&&d},m.prototype.isShareEngineEnabled=function(){return d},m.prototype.isSharing=function(){return!!this._state.isSharing&&d},m.prototype.isPrivateSharing=function(){return this._state.isPrivateSharing&&!!d},m.prototype.getRealtimeCollaborators=function(){return d&&this._state.realtimeCollaborators||[]},m.prototype.isEditingEnabled=function(){return!gDesigner.getLicense().isGuest()&&(this._state.edit||!!f&&this._state.inspect)},m.prototype.isSavingAsEnabled=function(){return!gDesigner.getLicense().isGuest()&&this._state.saveAs},m.prototype.isSavingToCloudEnabled=function(){return!gDesigner.getLicense().isGuest()&&this._state.edit},m.prototype.isExportEnabled=function(){return!gDesigner.getLicense().isGuest()&&this._state.export},m.prototype.isInspectEnabled=function(){return this._state.inspect||this._state.edit},m.prototype.isPagesInspectEnabled=function(){return this.isInspectEnabled()},m.prototype.isCommentingEnabled=function(){return this._state.comment&&u},m.prototype.isCommentingEditingEnabled=function(){if(!this.isCommentingEnabled())return!1;if(h){var e=!0,t=gDesigner.getActiveDocument(),n=t&&t.getStorageItem(),i=n&&n.getFile();return i&&i.status===g&&(e=!1),e}return!0},m.prototype.isCopyPasteEnabled=function(){return this._state.copyPaste},m.prototype.hasAccess=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=gDesigner.getShareManager().getRole();return!(!n||!(!t&&n.is(p.Owner)||await n.can(e)))},m.prototype.hasPermission=function(e,t){const n=gDesigner.getShareManager().getRole(e);return!(!n||!n.hasPermission(t))},m.prototype.hasRole=function(e){const t=gDesigner.getShareManager().getRole();return!!t&&t.is(e)},m.prototype.isFileFormatEnabledForSaveAs=function(e){return this._state.saveAs},m.prototype.isCreatingNewDocumentEnabled=function(){return!gDesigner.getLicense().isGuest()},m.prototype.isOpenFromCloudEnabled=function(){return!gDesigner.getLicense().isGuest()},m.prototype.isOnlyFileOpenFromCloudEnabled=function(){return!1},m.prototype.isOpenFromRecentFilesEnabled=function(){return!0},m.prototype.isDocumentTabManagementEnabled=function(){return this._state.isDocumentTabManagementEnabled},m.prototype.isOpenFilesFromLocalEnabled=function(){return!gDesigner.getLicense().isGuest()},m.prototype.isReminderManagerEnabled=function(e){return!0},m.prototype.isInAppPurchaseAvailable=function(e){return!0},m.prototype.isLicenseUpgradeable=function(e){return(e=e||gDesigner.getLicense()).canUpgrade()},m.prototype.isImportResourcesEnabled=function(){return this.isOpenFilesFromLocalEnabled()},e.exports=m},function(e,t,n){"use strict";n(25),n(3);const{HAS_ANNOTATIONS:i}=n(12);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,{isShareEnabled:!1,isSharing:!1,isPrivateSharing:!1,role:void 0,realtimeCollaborators:[],edit:!0,save:!0,export:!0,inspect:!0,comment:!!i,copyPaste:!0,isDocumentTabManagementEnabled:!0},e)}o.prototype.isDocumentTabManagementEnabled=!0,o.prototype.isShareEnabled=!1,o.prototype.isSharing=!1,o.prototype.isPrivateSharing=!1,o.prototype.role=void 0,o.prototype.realtimeCollaborators=[],o.prototype.edit=!0,o.prototype.saveAs=!0,o.prototype.export=!0,o.prototype.inspect=!0,o.prototype.comment=!!i,o.prototype.copyPaste=!0,o.prototype.toString=function(){return"Object [GApplicationState]"},e.exports=o},function(e,t,n){"use strict";n(19),n(24);var i=n(12);const{ANNOTATION_EVENT:o,SHARE_EVENT:r,USER_EVENT:a,REVIEW_STATUS_CHANGED:s,LOCK_REQUEST_EVENT:l,LOCK_UPDATE_EVENT:c,FILE_UPDATE_EVENT:d,FILE_AUTO_SAVE_EVENT:u}=i.gApi.COLLABORATION_EVENTS,p=n(352),g=n(78);function h(){this._documents=new Map,gDesigner.addEventListener(g,this._documentEvent,this)}h.prototype._documents=null,h.prototype._documentEvent=function(e){const t=e.document;switch(e.type){case g.Type.Added:case g.Type.Activated:case g.Type.StorageItemUpdated:(!t.isLockedByVersionHistory()&&t.isCloudFile()||t.getId()&&t.getStorageItem()&&t.getStorageItem().supportsShadowFile())&&this.attachDocument(t);break;case g.Type.Removed:this.detachDocument(t)}},h.prototype.attachDocument=function(e){if(!i.ENABLE_COLLABORATION)return;if(this._documents.has(e))return;const t=new i.gApi.WebSocketClient;t.setToken(e.getToken()),t.connect("/v2/realtime/"+e.getId()),i.ENABLE_COLLABORATION&&(t.on(o,t=>{this._trigger(e,p.Type.AnnotationsUpdate,t.data)}),t.on(a,t=>{this._trigger(e,p.Type.UserUpdate,t.data)}),t.on(s,t=>{this._trigger(e,p.Type.ReviewStatusChanged,t.data)}),t.on(l,t=>{this._trigger(e,p.Type.LockRequest,t.data)}),t.on(c,t=>{const n=t.data&&t.data.lock?new i.Lock(t.data.lock):null;this._trigger(e,p.Type.LockUpdated,n)}),t.on(d,t=>{this._trigger(e,p.Type.FileUpdate,t.data)})),i.SHARE_ENGINE&&t.on(r,t=>{this._trigger(e,p.Type.ShareUpdate,t.data)}),i.AUTO_SAVE_ENABLED&&t.on(u,t=>{this._trigger(e,p.Type.FileAutoSave,t.data)}),this._documents.set(e,{doc:e,ws:t})},h.prototype.detachDocument=function(e){const t=this._documents.get(e);t&&(t.ws.close(),this._documents.delete(e))},h.prototype._trigger=function(e,t,n){const i=new p(t,n);e.hasEventListeners(i)&&e.trigger(i)},e.exports=h},function(e,t,n){"use strict";var i=n(17)(n(1442));e.exports=class{constructor(e,t){this._promiseManager=new i.default}getAnnotations(e,t){return this._fetch({id:e,shareToken:t})}updateAnnotations(e,t,n){return this._fetch({id:e,data:t,shareToken:n})}_fetch(e){let{id:t,data:n,shareToken:i}=e;const o=n?()=>gApi.updateAnnotations(t,n,i):()=>gApi.getAnnotations(t,i);return this._promiseManager.pushPromise(o)}}},function(e,t,n){"use strict";n(9),n(163);e.exports=class{constructor(){this._promiseQueue=[]}pushPromise(e){if(0===this._promiseQueue.length){const t=e();return t.finally(()=>{this._promiseQueue.shift()}),this._promiseQueue.push(t),t}const t=this._promiseQueue.length,n=this._promiseQueue[t-1],i=new Promise(t=>{n.then(()=>{e().then(t)})});return i.finally(()=>{this._promiseQueue.shift()}),this._promiseQueue.push(i),i}}},function(e,t,n){"use strict";n(19),n(24),n(111),n(90),n(83),n(3);var i=n(12),o=n(32);const r=n(1073),a=n(1444);e.exports=class extends r{constructor(){super(),this._url=new URL(i.gApi.url)}setId(e){return this._id=e,this}setTime(e){return this._url.searchParams.set("time",e.getTime()),this}setEndpoint(e){return this._url.pathname=e,this}setLanguage(e){return this._url.searchParams.set("lang",e),this}setCampaign(e){return e&&this._url.searchParams.set("campaign",e),this}setShareFile(e){return e&&this._url.searchParams.set("shareFile",e),this}setDashboard(e){return e&&this._url.searchParams.set("dashboard",e),this}setProduct(e){return e&&this._url.searchParams.set("product",(0,o.stringToBase64String)(JSON.stringify(e))),this}setInAppPurchasesAvailable(e){return this._url.searchParams.set("iap",e),this}setLayout(e){return e=e||0,this._url.searchParams.set("layout",e),this}build(){return new a(this._id,this._url.toString())}}},function(e,t,n){"use strict";const i=n(1136),o=n(1074),{gApi:r}=n(12);e.exports=class extends o{constructor(e,t){super(),this._id=e,this._url=t}open(){if(this._isOpen())return;const e=new i({id:this._id,className:"overlay"});e.open(this._url),e.on("error",()=>{e.close()}),r.isCookieEnabled&&!r.isCookieEnabled()&&e.on("load",()=>{e.postMessage({cmd:"auth",token:r.getAuthorizationToken()},r.url)})}_isOpen(){return!!$("#".concat(this._id)).length}}},function(e,t,n){"use strict";n(25);const i=n(1073);e.exports=class extends i{constructor(e){super(),this._crossViewClass=e,this._dialogOptions={}}setTime(e){return Object.assign(this._dialogOptions,{now:e}),this}setEndpoint(e){return Object.assign(this._dialogOptions,{endpoint:e}),this}setCampaign(e){return Object.assign(this._dialogOptions,{campaign:e}),this}setShareFile(e){return Object.assign(this._dialogOptions,{shareFile:e}),this}setDashboard(e){return Object.assign(this._dialogOptions,{dashboard:e}),this}setProduct(e){return Object.assign(this._dialogOptions,{product:e}),this}setInAppPurchasesAvailable(e){return Object.assign(this._dialogOptions,{inAppPurchasesAvailable:e}),this}setLayout(e){return e=e||0,Object.assign(this._dialogOptions,{layout:e}),this}build(){return new this._crossViewClass(this._dialogOptions)}}},function(e,t,n){"use strict";var i=n(17);n(9),n(25);var o=n(12),r=n(1),a=i(n(1074));function s(){}r.GObject.inherit(s,o.GPaywallDialog.Impl),s.prototype.open=function(e){let{dialog:t}=e;this._dialog=t.getHTMLElement().gDialog({releaseOnClose:!0,nowrap:!0}).gDialog("open")},s.prototype.close=function(){let{licenseHasBeenUpgraded:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._dialog.closest(".g-dialog-container").remove(),e&&gDesigner.requestLicenseUpdate()},s.prototype.openPurchaseFlow=async function(e){let{dialog:t,options:n={}}=e;await gDesigner.openPaymentDialog(null,n).catch(()=>null),t.close()},s.prototype.openExternalLink=function(e){let{link:t}=e;gContainer.openExternalLink(null,t)},s.prototype.getProduct=function(){return Promise.resolve({price:-1,listPrice:-1,locale:navigator.language,currency:"USD"})},s.prototype.getLicense=function(){let e=gDesigner.getLicense();return Promise.resolve({license:e.getLicenseType(),expire:e.getExpirationDate(),created:e.getCreationDate(),legacy:e.isLegacy()})},s.prototype.getUser=function(){return gDesigner.getSyncUser()},s.prototype.getLanguage=function(){return r.GLocale.getLanguage()};class l extends a.default{constructor(e){super(),this._dialogOptions=e}async open(){new o.GPaywallDialog(Object.assign(this._dialogOptions,{impl:new s,gApi:o.gApi})).open()}}e.exports=l},function(e,t,n){"use strict";n(9);var i=n(1);const o=n(1210),r=n(1448);class a{static openTrialExpired(){return a._openReminder("trialexpired")}static openProExpireSoon(){return a._openReminder("proexpiresoon")}static openProExpired(){return a._openReminder("proexpired")}static async _openReminder(e){const t=await this._getProduct();return(await o.newBuilder(r)).setId("reminder-cross-frame").setEndpoint("/pro/reminder/".concat(e)).setTime(gDesigner.now()).setLanguage(i.GLocale.getLanguage()).setProduct(t).build().open()}static _getProduct(){return gInAppPurchase.getProduct().catch(()=>null)}}e.exports=a},function(e,t,n){"use strict";var i=n(17);n(9),n(25);var o=n(12),r=n(1),a=i(n(1074));class s extends o.GReminderDialog.Impl{open(e){let{dialog:t}=e;this._dialog=t.getHTMLElement().gDialog({releaseOnClose:!0,nowrap:!0}).gDialog("open")}async openPurchaseFlow(e){let{dialog:t,options:n={}}=e;await gDesigner.openPaymentDialog(null,n).catch(()=>null),t.close()}openExternalLink(e){let{link:t}=e;gContainer.openExternalLink(null,t)}close(){this._dialog.gDialog("close")}getProduct(){return Promise.resolve({price:-1,listPrice:-1,locale:navigator.language,currency:"USD"})}getLicense(){let e=gDesigner.getLicense();return Promise.resolve({license:e._license,expire:e._expire,created:e._created,legacy:e._legacy})}getLanguage(){return r.GLocale.getLanguage()}}class l extends a.default{constructor(e){super(),this._dialogOptions=e}async open(){const e=new s,t=Object.assign(this._dialogOptions,{impl:e});switch(this._dialogOptions.endpoint){case"/pro/reminder/proexpiresoon":(await o.GReminderDialogFactory.newProExpireSoon(t)).open();break;case"/pro/reminder/proexpired":(await o.GReminderDialogFactory.newProExpired(t)).open();break;case"/pro/reminder/trialexpired":(await o.GReminderDialogFactory.newTrialExpired(t)).open()}}}e.exports=l},function(e,t,n){"use strict";function i(){}i.createCDRIntegrationEngine=function(){return null},e.exports=i},function(e,t,n){"use strict";const i=n(788),o=n(789),r=n(1212);e.exports=class extends i{constructor(e){super(e),this.addGesture(new o({doubleTapDetection:o.DetectionMode.Nearby,doubleTapThreshold:200})),this.addGesture(new r),this.setClickSuppressionEnabled(!0)}_touchEnd(e){const t=e.changedTouches[0];!t||$(t.target).data("ginputbox")&&this._touchmoved||$(t.target).is(":focus")||(document.activeElement&&document.activeElement!==t.target&&$(document.activeElement).blur(),$(t.target).focus()),super._touchEnd(e)}_handleEvent(e){const t=e.changedTouches&&e.changedTouches[0];if(!t||!$(t.target).is("select"))try{super._handleEvent(e)}finally{e.cancelable&&(e.preventDefault(),e.stopPropagation())}}}},function(e,t,n){"use strict";const i=n(1452),o=n(1076);e.exports=class{constructor(){this._gestures=[],this._state=new o,this._delayedTouchEventsEnabled=!0,this._suppressClickEnabled=!1,this._swiping=!1}addGesture(e){this._gestures.push(e)}setDelayedTouchEventsEnabled(e){this._delayedTouchEventsEnabled=e}setClickSuppressionEnabled(e){this._suppressClickEnabled=e}touchStart(e){this._swiping=!1,this._state.update(e),this._handleDelayedTouchStartEvent(e);const t=new i(e);this._delayedTouchEventsEnabled&&!t.areThereMultipleTouchPoints()?(this._delayedTouchEvent=e,this._delayedTouchEventTimeout=setTimeout(this._triggerDelayedTouchEvent.bind(this),50)):this._execute("start",e)}touchMove(e){this._swiping=!0,this._state.update(e),this._handleDelayedTouchStartEvent(e),this._execute("move",e)}touchEnd(e){this._state.update(e),this._handleDelayedTouchStartEvent(e),this._execute("end",e)}touchCancel(e){this._state.update(e),this._execute("cancel",e)}gestureStart(e){this._dropDelayedTouchEvent(),this._execute("gesture",e)}scroll(e){this._swiping=!0}_execute(e,t){this._state.setSwiping(this._isSwiping());const n=new i(t),o=this._gestures.length;let r=!1;for(let t=0;t<o;t++){const i=this._gestures[t];try{if(r){i.deactivate(n,this._state);continue}if("start"===e&&(i.canActivate(n,this._state)?i.activate(n,this._state):i.deactivate(n,this._state)),!i.isActive())continue;r=i[e](n,this._state)}catch(e){console.error("GGestureHelper",e);try{i.deactivate(n,this._state)}catch(e){console.warn("GGestureHelper deactivation",e)}}}}_isSwiping(){return!!this._suppressClickEnabled&&this._swiping}_handleDelayedTouchStartEvent(e){this._delayedTouchEventTimeout&&new i(e).areThereMultipleTouchPointsOnTheTarget()?this._dropDelayedTouchEvent():this._triggerDelayedTouchEvent()}_triggerDelayedTouchEvent(){this._delayedTouchEventTimeout&&(clearTimeout(this._delayedTouchEventTimeout),this._delayedTouchEventTimeout=null,this._delayedTouchEvent&&(this._execute("start",this._delayedTouchEvent),this._delayedTouchEvent=null))}_dropDelayedTouchEvent(){this._delayedTouchEventTimeout&&clearTimeout(this._delayedTouchEventTimeout),this._delayedTouchEventTimeout=null,this._delayedTouch=null}hasActiveIdentifiers(){return this._state.hasActiveIdentifiers()}}},function(e,t,n){"use strict";e.exports=class{constructor(e){this._event=e}areThereTwoTouchPoints(){return 2===this._event.touches.length}areThereTwoTouchPointsOnTheTarget(){return 2===this._event.targetTouches.length}areThereMultipleTouchPointsOnTheTarget(){return this._event.targetTouches.length>1}isThereOneTouchPointOnTheTarget(){return 1===this._event.targetTouches.length}areThereMultipleTouchPoints(){return this._event.touches.length>1}getOriginalEvent(){return this._event}iterateChangedTouches(e){const t=this._event.changedTouches,n=t.length;for(let i=0;i<n&&!1!==e(t[i]);i++);}isTrusted(){return this._event.isTrusted}isCancelable(){return this._event.cancelable}}},function(e,t,n){"use strict";var i=n(43);const o=n(788),r=n(1454),a=n(789),s=n(1455),l=n(1212);e.exports=class extends o{constructor(e){super(e),this.addGesture(new r),this.addGesture(new a),this.addGesture(new l),this.addGesture(new s)}_handleEvent(e){e.cancelable&&e.preventDefault(),super._handleEvent(e)}_touchStart(e){this._isSelecting()&&this._gestureHelper.hasActiveIdentifiers()||super._touchStart(e)}_isSelecting(){const e=gDesigner.getToolManager().getActiveTool();return!!(e&&e instanceof i.GSelectTool)&&e.hasSelectedArea()}}},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=n(12),s=i(n(790)),l=i(n(1076));let c=!1,d=0,u=0,p=0,g=0,h=0,f=0,m=0,y=0,v=0,_=0,b=o.GPaintCanvas.getScreenDPI()*r.GSceneWidget.options.pinchToZoomFactor,w=2/o.GPaintCanvas.getScreenDPI();class C extends s.default{canActivate(e){return e.areThereTwoTouchPointsOnTheTarget()}start(e){const t=e.getOriginalEvent(),n=t.targetTouches[0];h=d=m=n.clientX,f=u=y=n.clientY,c=e.areThereTwoTouchPointsOnTheTarget();const i=gDesigner.getActiveView();if(!i)return;const o=gDesigner.getContextMenu();o&&o.close(),this._twoFingersState=new l.default,this._twoFingersState.update(t);let r=t.targetTouches[1];p=v=r.clientX,g=_=r.clientY,i.startTouchMode(),this._moved=!1}move(e){if(!this._twoFingersState)return!1;const t=e.getOriginalEvent();this._twoFingersState.update(t),this._moved=!0,t.cancelable&&(t.preventDefault(),t.stopPropagation());const n=gDesigner.getActiveView();if(!n)return!0;const i=t.targetTouches[0],s=t.targetTouches[1];if(!s)return!0;const{clientX:l,clientY:h}=i,{clientX:f,clientY:C}=s;if(d&&(c=o.GMath.isEqualEps(d,l,a.MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE)&&o.GMath.isEqualEps(u,h,a.MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE)&&o.GMath.isEqualEps(p,f,a.MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE)&&o.GMath.isEqualEps(g,C,a.MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE),!c)){const e=o.GMath.ptDist(m,y,v,_),t=o.GMath.ptDist(l,h,f,C);if(o.GMath.isEqualEps(e,t,a.MIN_TWO_FINGERS_TOUCH_MOVE_DISTANCE)){const e=((0==m?0:l-m)+(0==v?0:f-v))/w,t=((0==y?0:h-y)+(0==_?0:C-_))/w;n.scrollBy(-e,-t)}else{const a=t-e;let l=gDesigner.getWindows().getActiveWindow().getView().getZoom()+a/b;const c=new Touch({identifier:o.GUtil.uuid(),pageX:(i.pageX+s.pageX)/2,pageY:(i.pageY+s.pageY)/2,target:i.target});l=l<r.GSceneWidget.options.minZoomFactor?r.GSceneWidget.options.minZoomFactor:l;var E=n.getViewTransform().mapPoint(n._convertClientPositionFromMousePosition(c));n.zoomAt(E,l)}}return m=l,y=h,v=f,_=C,!0}end(e){if(this._twoFingersState&&this._twoFingersState.update(e.getOriginalEvent()),!this._twoFingersState||!this._twoFingersState.hasActiveIdentifiers()){this._twoFingersState=null;const e=gDesigner.getActiveView();e&&e.endTouchMode()}d=u=p=g=m=y=v=_=0;const t=!!this._moved;return this._moved=!1,t}}e.exports=C},function(e,t,n){"use strict";var i=n(17),o=n(12),r=i(n(790));class a extends r.default{canActivate(e){return e.isThereOneTouchPointOnTheTarget()}start(e){this._startLongPressEvent(e)}move(){this._dropLongPressEvent()}end(){this._dropLongPressEvent()}cancel(){this._dropLongPressEvent()}gesture(){this._dropLongPressEvent()}deactivate(e,t){super.deactivate(e,t),this._dropLongPressEvent()}_startLongPressEvent(e){const t=e.getOriginalEvent();if(this._dropLongPressEvent(),e.areThereMultipleTouchPoints())return;const{clientX:n,clientY:i,target:r}=t.targetTouches[0];this._longPressEventTimeout=setTimeout(()=>{const e=jQuery.Event("contextmenu",{pageX:n,pageY:i,clientX:n,clientY:i});$(r).trigger(e)},o.LONG_PRESS_TIME_OUT)}_dropLongPressEvent(){this._longPressEventTimeout&&clearTimeout(this._longPressEventTimeout)}}e.exports=a},function(e,t,n){"use strict";var i=n(17);n(58),n(19),n(24),n(171),n(14),n(63),n(28);var o=n(16),r=n(43),a=n(1),s=i(n(78)),l=i(n(1213)),c=i(n(217)),d=i(n(308)),u=i(n(1214)),p=i(n(787)),g=i(n(1069)),h=i(n(1070)),f=i(n(785)),m=i(n(786)),y=i(n(1215)),v=i(n(724)),_=i(n(780)),b=i(n(1216)),w=i(n(1217)),C=i(n(778)),E=i(n(1218)),S=i(n(723)),G=i(n(1219)),A=i(n(1220)),T=i(n(1459)),P=i(n(788)),L=i(n(789));class D extends P.default{constructor(e){super(e),this.addGesture(new L.default),this.setDelayedTouchEventsEnabled(!1)}_handleEvent(e){e.cancelable&&(e.preventDefault(),e.stopPropagation()),super._handleEvent(e)}}const x={[o.GKey.Constant.LEFT]:37,[o.GKey.Constant.UP]:38,[o.GKey.Constant.RIGHT]:39,[o.GKey.Constant.DOWN]:40,[o.GKey.Constant.SHIFT]:16,[o.GKey.Constant.CONTROL]:17,[o.GKey.Constant.ALT_LEFT]:18},I=Object.values(x),O=(e,t)=>{const n=gDesigner.getActiveDocument(),i=n&&n.getActiveWindow(),o=i&&i.getView(),r=o&&o.getHtmlElement();r&&r.dispatchEvent(new KeyboardEvent(e,{keyCode:t}))},k=e=>e===o.GKey.Constant.ALT_LEFT||e===o.GKey.Constant.ALT_RIGHT||e===o.GKey.Constant.SHIFT||e===o.GKey.Constant.CONTROL,F=[o.GKey.Constant.UP,o.GKey.Constant.LEFT,o.GKey.Constant.RIGHT,o.GKey.Constant.DOWN];function R(e){this._htmlElement=e,this._keyState={},this._heldKeys=new Map,this._keyDownInveral={},this._keyDownBound=this._keyDown.bind(this),this._keyUpBound=this._keyUp.bind(this),this._mouseUpBound=this._mouseup.bind(this),this._touchHandler=new T.default,this.init()}R.prototype._touchHandler=null,R.prototype._htmlElement=null,R.prototype._keyState=null,R.prototype._heldKeys=null,R.prototype._keyDownInveral=null,R.prototype._document=null,R.prototype._keyDownBound=null,R.prototype._keyUpBound=null,R.prototype._mouseUpBound=null,R.prototype.init=function(){o.GPlatform.constructor.bypassKeyDownRestrictionByClassName("g-virtual-key"),this._htmlElement.gCollapsible();const e=$("<div/>").addClass("container").appendTo(this._htmlElement),t=e=>{const t=this._keyDownInveral[e];t&&(clearInterval(t),delete this._keyDownInveral[e]),k(e)&&o.GPlatform.releaseKey(e),O("keyup",x[e])},n=e=>{const t=this._keyDownInveral[e];t&&clearInterval(t),(e=>F.includes(e))(e)&&(this._keyDownInveral[e]=setInterval(()=>{O("keydown",x[e])},100)),k(e)&&o.GPlatform.holdKey(e),O("keydown",x[e])},i=e=>{let{key:i,icon:r,dblclick:a,actionClass:l}=e;const c=s({name:r?null:o.GKey.toLocalizedShort(i,!0),icon:r,actionClass:"g-virtual-key"+(l?" "+l:""),mousedown:e=>{e.stopImmediatePropagation(),this._isHoldingKey(i)||n(i)},click:e=>{e.stopImmediatePropagation(),this._isHoldingKey(i)||(t(i),gDesigner.stats("virtualkey_assistantbar_click",i))},dblclick:a,mouseup:e=>{e.stopImmediatePropagation(),this._isHoldingKey(i)||t(i)},touchstart:()=>{this._isHoldingKey(i)||n(i)},touchend:()=>{this._isHoldingKey(i)||t(i)},touchcancel:()=>{this._isHoldingKey(i)||t(i)},active:()=>!!this._keyState[x[i]]||this._isHoldingKey(i)});return new D(c[0]),c},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.reduce((e,t)=>{let{icon:n,action:i,isEnabled:o}=t;const r=e.createAddItem(i);return n&&r.setIcon(n),o&&r.addEventListener(d.default.UpdateEvent,()=>{r.setEnabled(o())}),e},new c.default(null,"g-assistant-bar-menu"+(t?" "+t:"")))},s=e=>{let{action:t,name:n,menu:i,icon:o,click:r,dblclick:a,mousedown:s,mouseup:l,touchstart:c,touchmove:d,touchend:u,touchcancel:p,split:g=!1,active:h,actionClass:f}=e;const m=$("<div/>").addClass("toolbar-button").toggleClass("split",!!g),y=$("<button/>").addClass("action-button").appendTo(m);if(f&&y.addClass(f),h&&(m.data("active",h),m.toggleClass("g-active",!!h())),t&&(m.data("action",t),o||(o=t.getIcon()),r||(r=()=>gDesigner.executeAction(t.getId(),void 0,"assistantbar"))),n&&$("<span/>").text(n).appendTo(y),o&&$("<span/>").addClass(o).appendTo(y),r&&y.on("click",r),a&&y.on("dblclick",a),s&&m.on("mousedown",s),l&&m.on("mouseup",l),c&&m.on("touchstart",c),d&&m.on("touchmove",d),u&&m.on("touchend",u),p&&m.on("touchcancel",p),i){let e;i.__which="assistantbar",e=g?$("<button/>").addClass("dropdown-button").append($("<span></span>").addClass("gravit-icon-touch-arrow-up")).appendTo(m):y.append($("<span></span>").addClass("gravit-icon-touch-arrow-up")),e.gMenuButton({menu:i,touch:!0})}return m},l=$("<div/>").addClass("left-side").appendTo(e),T=$("<div/>").addClass("right-side").appendTo(e).gCollapsible({orientation:A.default.Orientation.Horizontal}).gCollapsible("collapse").on("visibilitychanged",(e,t)=>{gContainer.setProperty("designer.assistant-bar.left-side.expanded",!!t)});$("<div/>").gPropertyRow({height:"auto",columns:[{width:"86px",content:i({key:o.GKey.Constant.SHIFT,actionClass:"g-virtual-key-".concat(o.GKey.Constant.SHIFT),dblclick:()=>this._toggleModifierKey(o.GKey.Constant.SHIFT)})},{width:"auto",content:s({icon:"gravit-icon-touch-copy",action:gDesigner.getAction(u.default.ID_COPY)})},{width:"68px",content:s({icon:"gravit-icon-touch-paste",action:gDesigner.getAction(p.default.ID),menu:a([{icon:"gravit-icon-touch-paste-in-place",action:gDesigner.getAction(g.default.ID)},{icon:"gravit-icon-touch-paste-inside",action:gDesigner.getAction(h.default.ID)},{icon:"gravit-icon-touch-paste-and-replace",action:gDesigner.getAction(m.default.ID)},{icon:"gravit-icon-touch-paste-style",action:gDesigner.getAction(f.default.ID)}],"paste-menu"),split:!0})},{width:"auto",content:s({icon:"gravit-icon-touch-trash-2",action:gDesigner.getAction(y.default.ID)})},{width:"auto",content:s({icon:"gravit-icon-touch-selection",click:()=>{const e=gDesigner.getActiveDocument(),t=e&&e.getEditor();if(t){t.getSelection()&&t.getSelection().length>0?gDesigner.executeAction(w.default.ID,void 0,"assistantbar"):gDesigner.executeAction(b.default.ID,void 0,"assistantbar")}}})},{width:"62px",content:s({icon:"gravit-icon-touch-arrange-order",menu:a(Object.values(r.GEditor.ArrangeOrderType).map(e=>({icon:"gravit-icon-touch-arrange-"+e,action:gDesigner.getAction(C.default.ID+"."+e),isEnabled:()=>this._isArrangeActionEnabled(e)})),"arrange-menu")})},{width:"auto",content:s({icon:"gravit-icon-touch-fullscreen",action:gDesigner.getAction(E.default.ID),active:()=>gDesigner.getAction(E.default.ID).isFullscreen()})}]}).appendTo(l),$("<div/>").gPropertyRow({height:"auto",columns:[{width:"86px",content:i({key:o.GKey.Constant.CONTROL,actionClass:"g-virtual-key-".concat(o.GKey.Constant.CONTROL),dblclick:()=>this._toggleModifierKey(o.GKey.Constant.CONTROL)})},{width:"114px",content:i({key:o.GKey.Constant.ALT_LEFT,actionClass:"g-virtual-key-".concat(o.GKey.Constant.ALT_LEFT),dblclick:()=>this._toggleModifierKey(o.GKey.Constant.ALT_LEFT)})},{width:"auto",content:s({icon:"gravit-icon-touch-group",action:gDesigner.getAction(v.default.ID)})},{width:"auto",content:s({icon:"gravit-icon-touch-ungroup",action:gDesigner.getAction(_.default.ID)})},{width:"62px",content:s({icon:"gravit-icon-touch-convert-to-path",action:gDesigner.getAction(S.default.ID)})},{width:"auto",content:s({icon:"gravit-icon-touch-help",click:()=>gDesigner.executeAction(G.default.ID,void 0,"assistantbar")})}]}).appendTo(l),$("<div/>").gPropertyRow({height:"auto",columns:[{width:"auto",content:i({key:o.GKey.Constant.UP,icon:"gravit-icon-touch-arrow-key-up"})},{width:"auto",content:i({key:o.GKey.Constant.DOWN,icon:"gravit-icon-touch-arrow-key-down"})}]}).appendTo(T),$("<div/>").gPropertyRow({height:"auto",columns:[{width:"auto",content:i({key:o.GKey.Constant.LEFT,icon:"gravit-icon-touch-arrow-key-left"})},{width:"auto",content:i({key:o.GKey.Constant.RIGHT,icon:"gravit-icon-touch-arrow-key-right"})}]}).appendTo(T),gContainer.getProperty("designer.assistant-bar.left-side.expanded").then(e=>{T.gCollapsible(e?"expand":"collapse")})},R.prototype._toggleModifierKey=function(e){const t=!o.GPlatform.isHoldingKey(e);this._toggleKey(e,t),this._htmlElement.find(".g-virtual-key-".concat(e)).toggleClass("g-held",t),this._updateActions()},R.prototype._toggleKey=function(e,t){t?(o.GPlatform.holdKey(e),this._heldKeys.set(e,!0)):(o.GPlatform.releaseKey(e),this._heldKeys.delete(e))},R.prototype._isHoldingKey=function(e){return!!this._heldKeys&&!!this._heldKeys.get(e)},R.prototype._keyDown=function(e){I.includes(e.which||e.keyCode)&&(this._keyState[e.which||e.keyCode]=!0,this._updateActions())},R.prototype._keyUp=function(e){I.includes(e.which||e.keyCode)&&(delete this._keyState[e.which||e.keyCode],this._updateActions())},R.prototype._mouseup=function(e){e.isTrusted&&(Object.keys(this._keyDownInveral).forEach(e=>{O("keyup",x[e]),clearInterval(this._keyDownInveral[e])}),this._keyDownInveral=[])},R.prototype.activate=function(){document.addEventListener("keydown",this._keyDownBound,!0),document.addEventListener("keyup",this._keyUpBound,!0),document.addEventListener("mouseup",this._mouseUpBound,!0),gDesigner.addEventListener(s.default,this._documentEvent,this),gDesigner.addEventListener(l.default,this._fullScreenEvent,this),o.GPlatform.addEventListener(o.GModifiersChangedEvent,this._modifiersChangedEvent,this),this._activateDocument(gDesigner.getActiveDocument()),this._touchHandler.activate(this._htmlElement[0]),this._heldKeys=new Map,this._updateActions()},R.prototype.deactivate=function(){document.removeEventListener("keydown",this._keyDownBound,!0),document.removeEventListener("keyup",this._keyUpBound,!0),document.removeEventListener("mouseup",this._mouseUpBound,!0),gDesigner.removeEventListener(s.default,this._documentEvent,this),gDesigner.removeEventListener(l.default,this._fullScreenEvent,this),o.GPlatform.removeEventListener(o.GModifiersChangedEvent,this._modifiersChangedEvent,this),this._deactivateDocument(gDesigner.getActiveDocument()),o.GPlatform.releaseKey(o.GKey.Constant.ALT_LEFT),o.GPlatform.releaseKey(o.GKey.Constant.ALT_RIGHT),o.GPlatform.releaseKey(o.GKey.Constant.SHIFT),o.GPlatform.releaseKey(o.GKey.Constant.CONTROL),this._touchHandler.deactivate(this._htmlElement[0]),this._heldKeys=null},R.prototype._activateDocument=function(e){e&&e.getEditor().addEventListener(r.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._document=e},R.prototype._deactivateDocument=function(e){e&&e.getEditor().removeEventListener(r.GEditor.SelectionChangedEvent,this._selectionChangedEvent,this),this._document=null},R.prototype._selectionChangedEvent=function(e){this._updateActions()},R.prototype._fullScreenEvent=function(){this._updateActions()},R.prototype._modifiersChangedEvent=function(){this._updateActions()},R.prototype._documentEvent=function(e){const t=e.document;if(!t.isLockedByVersionHistory())switch(e.type){case s.default.Type.Activated:this._activateDocument(t),this._updateActions();break;case s.default.Type.Deactivated:this._deactivateDocument(t),this._updateActions();break;case s.default.Type.Modified:this._updateActions()}},R.prototype._updateActions=function(){this._htmlElement.find(".toolbar-button").each((function(){const e=$(this),t=e.data("action"),n=e.data("active");if(t){const n=!t.isAvailable()||!t.isEnabled();e.find("button").prop("disabled",n).toggleClass("g-disabled",n)}n&&e.toggleClass("g-active",!!n())}))},R.prototype._isArrangeActionEnabled=function(e){if(!gDesigner.getAction(C.default.ID+"."+e).isEnabled())return!1;const t=this._document?this._document.getEditor().getIndividualSelection():null;if(!t)return!1;if(t.length>1)return!0;const n=t[0],i=n.getParent();switch(e){case r.GEditor.ArrangeOrderType.SendToFront:if(n.getNext()){let e=n.getNext(),t=null;for(;!t&&e;)e instanceof a.GElement&&(t=e),e=e.getNext();return!!t&&r.GEditor.validateBlockInsertion(i,n)}return!1;case r.GEditor.ArrangeOrderType.BringForward:{let e=n.getNext();if(e){let t=null;for(;!t&&e;)e instanceof a.GElement&&(e.hasFlag(a.GNode.Flag.Selected)||(t=e)),e=e.getNext();if(null!==t){const e=t.getNext();return r.GEditor.validateBlockInsertion(i,n,e)}}return!1}case r.GEditor.ArrangeOrderType.SendBackward:{let e=n.getPrevious();if(null!==e){let t=null;for(;!t&&e;)e instanceof a.GElement&&(e.hasFlag(a.GNode.Flag.Selected)||r.GEditor.validateBlockInsertion(i,n,e)&&(t=e)),e=e.getPrevious();return!!t}return!1}case r.GEditor.ArrangeOrderType.SendToBack:if(null!==n.getPrevious()){let e=i.getFirstChild(),t=null;for(;!t&&e&&e!==n;)e instanceof a.GElement&&r.GEditor.validateBlockInsertion(i,n,e)&&(t=e),e=e.getNext();return!!t}return!1}return!0},R.prototype.getHtmlElement=function(){return this._htmlElement},e.exports=R},function(e,t,n){"use strict";n(1);var i=function(){this._timer=0};i.prototype._element=$("<div />").addClass("g-fullscreen-banner"),i.prototype._timeout=5e3,i.prototype.setBannerText=function(e){return this._element.html(e),this},i.prototype.show=function(){var e=this;return $("body").append(this._element),this._element.animate({opacity:1},500),this._timer=setTimeout((function(){e.hide()}),5e3),this},i.prototype.hide=function(){return this._element.animate({opacity:0},{duration:500,complete:function(){$(this).remove()}}),clearTimeout(this._timer),this},e.exports=i},function(e,t,n){"use strict";n(28);var i=n(1);const o=[{selector:"#toolbar > .section > .menubar-toolbar-button",i18n:"text.menu",offsetX:10},{selector:"#toolbar > .section > .open-toolbar-button > .action-button",i18n:"text.open",furtherAway:!0},{selector:"#toolbar > .section > .save-toolbar-button > .action-button",i18n:"text.save"},{selector:"#toolbar > .section > .undo-toolbar-button > .action-button",i18n:"text.undo-redo",furtherAway:!0},{selector:"#toolbar > .section > .zoom-button > .action-button > .caption",i18n:"text.zoom",offsetY:14},{selector:"#toolbar > .section > .snap-button > .action-button",i18n:"text.snapping",furtherAway:!0},{selector:"#toolbar > .section > .select-toolbar-button > .action-button",i18n:"text.select"},{selector:"#toolbar > .section > .shapes-toolbar-button > .action-button",i18n:"text.shapes",furtherAway:!0},{selector:"#toolbar > .section > .path-toolbar-button > .action-button",i18n:"text.path"},{selector:"#toolbar > .section > .knife-toolbar-button > .action-button",i18n:"text.knife",furtherAway:!0},{selector:"#toolbar > .section > .text-toolbar-button > .action-button",i18n:"text.text"},{selector:"#toolbar > .section > .image-toolbar-button > .action-button",i18n:"text.image",furtherAway:!0},{selector:"#toolbar > .section > .window-button  > .action-button",i18n:"text.files"},{selector:"#toolbar > .section > .export-toolbar-button > .action-button",i18n:"text.export"},{selector:'.g-touch-toolbar-button[g-touch-tool="pages"]',i18n:"text.pages"},{selector:'.g-touch-toolbar-button[g-touch-tool="layers"]',i18n:"text.layers",furtherAway:!0},{selector:'.g-touch-toolbar-button[g-touch-tool="libraries"]',i18n:"text.libraries"},{selector:'.g-touch-toolbar-button[g-touch-tool="symbols"]',i18n:"text.symbols",furtherAway:!0},{selector:'.g-touch-toolbar-button[g-touch-tool="dimension.align"]',i18n:"text.align-distribute",className:"align-distribute"},{selector:'.g-touch-toolbar-button[g-touch-tool="dimension.dimension"]',i18n:"text.transform",furtherAway:!0},{selector:'.g-touch-toolbar-button[g-touch-tool="document"]',i18n:"text.document"},{selector:'.g-touch-toolbar-button[g-touch-tool="appearance"]',i18n:"text.appearance",furtherAway:!0},{selector:'.g-touch-toolbar-button[g-touch-tool="fill"]',i18n:"text.fills"},{selector:'.g-touch-toolbar-button[g-touch-tool="border"]',i18n:"text.borders",furtherAway:!0},{selector:'.g-touch-toolbar-button[g-touch-tool="effect"]',i18n:"text.effects"},{selector:'.g-touch-toolbar-button[g-touch-tool="annotation"]',i18n:"text.comments",furtherAway:!0},{selector:"#assistant-bar > .container",side:i.GRect.Side.LEFT_CENTER,i18n:"text.modifier-keys",disconnected:!0,offsetX:-15,className:"assistant-bar"},{selector:"#assistant-bar > .container",side:i.GRect.Side.RIGHT_CENTER,i18n:"text.nudge",disconnected:!0,offsetX:15,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-copy",side:i.GRect.Side.TOP_CENTER,i18n:"text.copy",offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-paste",side:i.GRect.Side.TOP_CENTER,i18n:"text.paste",furtherAway:!0,offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-trash-2",side:i.GRect.Side.TOP_CENTER,i18n:"text.delete",offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-selection",side:i.GRect.Side.TOP_CENTER,i18n:"text.select-deselect",furtherAway:!0,offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-arrange-order",side:i.GRect.Side.TOP_CENTER,i18n:"text.arrange",offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-fullscreen",side:i.GRect.Side.TOP_CENTER,i18n:"text.fullscreen",furtherAway:!0,offsetY:-10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-group",i18n:"text.group",offsetY:10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-ungroup",i18n:"text.ungroup",furtherAway:!0,offsetY:10,className:"assistant-bar"},{selector:"#assistant-bar .gravit-icon-touch-convert-to-path",i18n:"text.convert-to-path",offsetY:10,className:"assistant-bar"}];e.exports=new class{constructor(){this._resizeBound=this._resize.bind(this)}open(){this._panel&&this._panel.remove();const e=$("body").addClass("g-quick-help");this._panel=$("<div/>").addClass("g-quick-help-screen").addClass(i.GLocale.getLocaleTagISO6391()).addClass("hidden").on("click",()=>this.close()).appendTo(e),gDesigner.getRightSidebars().disableContextSensitive(),this._update(),this._panel.removeClass("hidden"),$(window).on("resize",this._resizeBound)}close(){$("body").removeClass("g-quick-help"),this._panel&&this._panel.remove(),delete this._panel,gDesigner.getRightSidebars().enableContextSensitive(),$(window).off("resize",this._resizeBound)}_resize(){this._panel&&(this._panel.empty(),this._update())}_update(){this._createStaticTooltips(),o.forEach(e=>this._createDynamicTooltip(e))}_createStaticTooltips(){$("<div/>").addClass("static-tooltips").append($("<div/>").addClass("container").append($("<img/>").attr("src","assets/help/pinch-to-zoom.svg")).append(this._createTooltip({disconnected:!0,i18n:"text.pinch-to-zoom"}))).append($("<div/>").addClass("container").append($("<img/>").attr("src","assets/help/drag-with-2-fingers.svg")).append(this._createTooltip({disconnected:!0,i18n:"text.drag-with-2-fingers"}))).append($("<div/>").addClass("container").append($("<img/>").attr("src","assets/help/tap-and-holder.svg")).append(this._createTooltip({disconnected:!0,i18n:"text.tap-and-hold"}))).appendTo(this._panel)}_createDynamicTooltip(e){const t=$(e.selector),n=t.offset();if(!n||!t.is(":visible"))return;const o=this._createTooltip(e).appendTo(this._panel),r=new i.GRect(n.left,n.top,t.outerWidth(),t.outerHeight()),a=new i.GRect(0,0,o.outerWidth(),o.outerHeight()),s=this._calculatePosition(a,r,e);o.css({top:s.getY(),left:s.getX()})}_calculatePosition(e,t,n){const o=n.side||i.GRect.Side.BOTTOM_CENTER,r=t.getSide(o);switch(o){case i.GRect.Side.TOP_CENTER:{const t=e.getSide(i.GRect.Side.CENTER).getX();return new i.GPoint(r.getX()-t+(n.offsetX||0),r.getY()-e.getHeight()+(n.offsetY||0))}case i.GRect.Side.BOTTOM_CENTER:{const t=e.getSide(i.GRect.Side.CENTER).getX();return new i.GPoint(r.getX()-t+(n.offsetX||0),r.getY()+(n.offsetY||0))}case i.GRect.Side.LEFT_CENTER:{const t=e.getSide(i.GRect.Side.CENTER).getY();return new i.GPoint(r.getX()-e.getWidth()+(n.offsetX||0),r.getY()-t+(n.offsetY||0))}case i.GRect.Side.RIGHT_CENTER:{const t=e.getSide(i.GRect.Side.CENTER).getY();return new i.GPoint(r.getX()+(n.offsetX||0),r.getY()-t+(n.offsetY||0))}default:throw"Unsupported side"}}_createTooltip(e){const t=$("<div>").addClass("content").append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GQuickHelpScreen",e.i18n))));return $("<div/>").addClass("tooltip"+(e.className?" "+e.className:"")).addClass("side-"+(e.side||i.GRect.Side.BOTTOM_CENTER)).toggleClass("further-away",!!e.furtherAway).append($("<div/>").addClass("container").append($("<div>").addClass("connector").css("display",e.disconnected?"none":"")).append(t))}}},function(e,t,n){"use strict";var i=n(17)(n(789));const o=n(788);e.exports=class extends o{constructor(e){super(e),this.addGesture(new i.default),this.setDelayedTouchEventsEnabled(!1)}_handleEvent(e){e.cancelable&&e.preventDefault(),super._handleEvent(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(19),n(24);class i extends Error{constructor(){super(...arguments),this.constructor=i,this.__proto__=i.prototype,this.name="GMSTeamsModeUserNotFoundError"}toString(){return this.message}}var o=i;t.default=o},function(e,t,n){"use strict";n(9);const{PasswordlessAuthenticationActions:i,gApi:o}=n(12),r=n(36),a=n(546),s=n(306),{GLocale:l,GLocaleKey:c}=n(1);e.exports=class{async execute(){let{[i.SetPassword]:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await o.passwordlessAuthentication.authenticateWithSetPasswordToken(e),await s.checkLicense();const t=await gDesigner.getUser();t&&gDesigner.executeWhenReady(()=>{new a(t,a.Tabs.ChangePassword,{token:e,tabs:[a.Tabs.ChangePassword],closeable:!1,changePasswordOptions:{autoClose:!0,title:l.get(new c("GChangePasswordPanel","text.set-password")),info:l.get(new c("GChangePasswordPanel","text.set-password-info"))}}).open()})}catch(e){gDesigner.executeWhenReady(()=>{r.error(e)})}}}},function(e,t,n){"use strict";n(9);const{PasswordlessAuthenticationActions:i,gApi:o}=n(12),r=n(36),a=n(546),s=n(306);e.exports=class{async execute(){let{[i.ResetPassword]:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await o.passwordlessAuthentication.authenticateWithResetPasswordToken(e),await s.checkLicense();const t=await gDesigner.getUser();t&&gDesigner.executeWhenReady(()=>{new a(t,a.Tabs.ChangePassword,{token:e,tabs:[a.Tabs.ChangePassword]}).open()})}catch(e){gDesigner.executeWhenReady(()=>{r.error(e)})}}}},function(e,t,n){"use strict";n(9);const{PasswordlessAuthenticationActions:i,gApi:o}=n(12),r=n(306),a=n(36);e.exports=class{async execute(){let{[i.PasswordlessToken]:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return await o.passwordlessAuthentication.authenticateWithPasswordlessToken(e),await r.checkLicense(),gDesigner.getUser()}catch(e){gDesigner.executeWhenReady(()=>{a.error(e)})}}}},function(e,t,n){var i;!function(o,r,a){if(o){for(var s,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},c={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)l[111+p]="f"+p;for(p=0;p<=9;++p)l[p+96]=p.toString();v.prototype.bind=function(e,t,n){return e=e instanceof Array?e:[e],this._bindMultiple.call(this,e,t,n),this},v.prototype.unbind=function(e,t){return this.bind.call(this,e,(function(){}),t)},v.prototype.trigger=function(e,t){return this._directMap[e+":"+t]&&this._directMap[e+":"+t]({},e),this},v.prototype.reset=function(){return this._callbacks={},this._directMap={},this},v.prototype.stopCallback=function(e,t){if((" "+t.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function e(t,n){return null!==t&&t!==r&&(t===n||e(t.parentNode,n))}(t,this.target))return!1;if("composedPath"in e&&"function"==typeof e.composedPath){var n=e.composedPath()[0];n!==e.target&&(t=n)}return"INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable},v.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},v.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(l[t]=e[t]);s=null},v.init=function(){var e=v(r);for(var t in e)"_"!==t.charAt(0)&&(v[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},v.init(),o.Mousetrap=v,e.exports&&(e.exports=v),void 0===(i=function(){return v}.call(t,n,t,e))||(e.exports=i)}function g(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function h(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return l[e.which]?l[e.which]:c[e.which]?c[e.which]:String.fromCharCode(e.which).toLowerCase()}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function m(e,t,n){return n||(n=function(){if(!s)for(var e in s={},l)e>95&&e<112||l.hasOwnProperty(e)&&(s[l[e]]=e);return s}()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function y(e,t){var n,i,o,r=[];for(n=function(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus")).split("+")}(e),o=0;o<n.length;++o)i=n[o],u[i]&&(i=u[i]),t&&"keypress"!=t&&d[i]&&(i=d[i],r.push("shift")),f(i)&&r.push(i);return{key:i,modifiers:r,action:t=m(i,r,t)}}function v(e){var t=this;if(e=e||r,!(t instanceof v))return new v(e);t.target=e,t._callbacks={},t._directMap={};var n,i={},o=!1,a=!1,s=!1;function l(e){e=e||{};var t,n=!1;for(t in i)e[t]?n=!0:i[t]=0;n||(s=!1)}function c(e,n,o,r,a,s){var l,c,d,u,p=[],g=o.type;if(!t._callbacks[e])return[];for("keyup"==g&&f(e)&&(n=[e]),l=0;l<t._callbacks[e].length;++l)if(c=t._callbacks[e][l],(r||!c.seq||i[c.seq]==c.level)&&g==c.action&&("keypress"==g&&!o.metaKey&&!o.ctrlKey||(d=n,u=c.modifiers,d.sort().join(",")===u.sort().join(",")))){var h=!r&&c.combo==a,m=r&&c.seq==r&&c.level==s;(h||m)&&t._callbacks[e].splice(l,1),p.push(c)}return p}function d(e,n,i,o){t.stopCallback(n,n.target||n.srcElement,i,o)||!1===e(n,i)&&(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}(n),function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}(n))}function u(e){"number"!=typeof e.which&&(e.which=e.keyCode);var n=h(e);n&&("keyup"!=e.type||o!==n?t.handleKey(n,function(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}(e),e):o=!1)}function p(e,t,r,a){function c(t){return function(){s=t,++i[e],clearTimeout(n),n=setTimeout(l,1e3)}}function u(t){d(r,t,e),"keyup"!==a&&(o=h(t)),setTimeout(l,10)}i[e]=0;for(var p=0;p<t.length;++p){var g=p+1===t.length?u:c(a||y(t[p+1]).action);m(t[p],g,a,e,p)}}function m(e,n,i,o,r){t._directMap[e+":"+i]=n;var a,s=(e=e.replace(/\s+/g," ")).split(" ");s.length>1?p(e,s,n,i):(a=y(e,i),t._callbacks[a.key]=t._callbacks[a.key]||[],c(a.key,a.modifiers,{type:a.action},o,e,r),t._callbacks[a.key][o?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:o,level:r,combo:e}))}t._handleKey=function(e,t,n){var i,o=c(e,t,n),r={},u=0,p=!1;for(i=0;i<o.length;++i)o[i].seq&&(u=Math.max(u,o[i].level));for(i=0;i<o.length;++i)if(o[i].seq){if(o[i].level!=u)continue;p=!0,r[o[i].seq]=1,d(o[i].callback,n,o[i].combo,o[i].seq)}else p||d(o[i].callback,n,o[i].combo);var g="keypress"==n.type&&a;n.type!=s||f(e)||g||l(r),a=p&&"keydown"==n.type},t._bindMultiple=function(e,t,n){for(var i=0;i<e.length;++i)m(e[i],t,n)},g(e,"keypress",u),g(e,"keydown",u),g(e,"keyup",u)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(e,t){!function(e){if(e){var t={},n=e.prototype.stopCallback;e.prototype.stopCallback=function(e,i,o,r){return!!this.paused||!t[o]&&!t[r]&&n.call(this,e,i,o)},e.prototype.bindGlobal=function(e,n,i){if(this.bind(e,n,i),e instanceof Array)for(var o=0;o<e.length;o++)t[e[o]]=!0;else t[e]=!0},e.init()}}("undefined"!=typeof Mousetrap?Mousetrap:void 0)},function(e,t,n){"use strict";n(3);var i=n(1),o=n(32),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.connect-lines",s.TITLE=new i.GLocaleKey("GConnectLinesAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY_PATH},s.prototype.getGroup=function(){return"structure/path"},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null;if(e)for(var t=0;t<e.length;++t)if(e[t]instanceof i.GPath)return!0;return!1},s.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getSelection():null,r=[],a=null;if(n)for(var s=0;s<n.length;++s){var l=n[s];l instanceof i.GPath&&(a?a===l.getParent()&&r.push(l):(a=l.getParent())&&r.push(l))}if(r.length){t.beginTransaction();try{if(1==r.length)r[0].setProperty("closed",!0);else try{(0,o.blockChanges)(t,null,null,a);var c,d=(r=i.GNode.order(r))[r.length-1],u=d.getProperty("trf"),p=u?u.inverted():null,g=d.getNext(),h=[];for(s=0;s<r.length-1;++s)(c=r[s]).removeFlag(i.GNode.Flag.Selected),c.setProperty("closed",!1),a.removeChild(c),u=(u=c.getProperty("trf"))?p?u.multiplied(p):u:p,h=h.concat(c.getAnchorPoints().serialize(u));d.removeFlag(i.GNode.Flag.Selected),a.removeChild(d),h=h.concat(d.getAnchorPoints().serialize());var f=new i.GPath;f.getAnchorPoints().deserialize(h),f.assignFrom(d),a.insertChild(f,g)}finally{(0,o.releaseChanges)(t,null,null,a),t.updateSelection(!1,[f])}}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}},s.prototype.toString=function(){return"[Object GConnectLinesAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="view.zoom.fit-current-layer",a.TITLE=new i.GLocaleKey("GFitCurrentLayerAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_VIEW},a.prototype.getGroup=function(){return"zoom"},a.prototype.isEnabled=function(){var e=gDesigner.getActiveDocument(),t=e?e.getScene().getActiveLayer():null;return t&&t.getPaintBBox()&&!t.getPaintBBox().isEmpty()},a.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e.getScene().getActiveLayer();e.getActiveWindow().getView().zoomAll(t.getPaintBBox(),!1,!0)},a.prototype.toString=function(){return"[Object GFitCurrentLayerAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="edit.invert-selection",s.TITLE=new i.GLocaleKey("GInvertSelectionAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_EDIT},s.prototype.getGroup=function(){return"select"},s.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,"I"]},s.prototype.isEnabled=function(){return!!gDesigner.getActiveDocument()},s.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e.getScene(),n=t.getActivePage(),o=gDesigner.getActiveDocument().getActiveWindow().getView().getViewConfiguration().multiPageView,r=[];t.accept((function(e){if(e instanceof i.GItem&&!e.hasMixin(i.GAnnotation)&&!(e.getParent()instanceof i.GItem)&&!e.hasFlag(i.GNode.Flag.Selected)&&(e.getPage()===n||o)&&!e.isLocked()){var t=!e.getProperty("vis")||e.findParent((function(e){return e instanceof i.GBlock&&!e.getProperty("vis")})),a=e.getProperty("plkt"),s=a&i.GBlock.ProgramLck.NoEdit&&a&i.GBlock.ProgramLck.NoSizeChanges&&a&i.GBlock.ProgramLck.NoMove&&a&i.GBlock.ProgramLck.NoDelete;t||s||r.push(e)}})),e.getEditor().updateSelection(!1,r)},s.prototype.toString=function(){return"[Object GInvertSelectionAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="file.new",s.TITLE=new i.GLocaleKey("GNewAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.isEnabled=function(){return gDesigner.getApplicationManager().isCreatingNewDocumentEnabled()},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_FILE},s.prototype.getGroup=function(){return"document"},s.prototype.getShortcut=function(){return[o.GKey.Constant.OPTION,"N"]},s.prototype.getAdditionalShortcuts=function(){return[[o.GKey.Constant.META,"N"]]},s.prototype.execute=function(){gContainer.newDocumentActionPerformed(),gDesigner.openNewDocumentDialog({closable:!0,showCloudOptions:!0,defaultOption:"start-option",newOrFromTemplate:!0})},s.prototype.toString=function(){return"[Object GNewAction]"},e.exports=s},function(e,t,n){"use strict";n(3);n(43);var i=n(1),o=n(16),r=n(18),a=n(144),s=(n(402),n(26));function l(){}i.GObject.inherit(l,s),l.ID="file.new.clipboard",l.TITLE=new i.GLocaleKey("GNewClipboardAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_FILE},l.prototype.getGroup=function(){return"document"},l.prototype.getShortcut=function(){return[o.GKey.Constant.SHIFT,o.GKey.Constant.CONTROL,o.GKey.Constant.OPTION,"N"]},l.prototype.isEnabled=function(){return!!gDesigner.getApplicationManager().isCopyPasteEnabled()&&(!!gDesigner.getActiveDocument()&&!!gDesigner.getClipboardContent(i.GNode.MIME_TYPE))},l.prototype.execute=function(){var e=i.GNode.deserialize(gDesigner.getClipboardContent(i.GNode.MIME_TYPE));if(e&&e.length>0){var t=e.filter((function(e){return e instanceof i.GItem||e instanceof i.GLayer}));if(t.length>0){var n=gDesigner.createScene();n.getActivePage().setProperties(["bck","w","h"],[i.GRGBColor.WHITE,0,0]),gDesigner.addDocument(new a(n));var o=gDesigner.getActiveDocument().getEditor();o.beginTransaction();try{o.insertElements(t,!0,!0,!0)}finally{o.commitTransaction("Paste"),gDesigner.setClipboardContent(i.GNode.MIME_TYPE,null)}gDesigner.getActiveDocument().getActiveWindow().centerAndZoom()}}},l.prototype._getBBox=function(e){var t=null;return i.GUtil.each(e,(function(e,n){var o=n.getPaintBBox();o&&o.getWidth()+o.getHeight()>0&&(t=t?t.united(o):new i.GRect(o.getX(),o.getY(),o.getWidth(),o.getHeight()))})),t},l.prototype.toString=function(){return"[Object GNewClipboardAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(1222)),a=i(n(26)),s=i(n(18));function l(){}o.GObject.inherit(l,a.default),l.ID="view.fast-view",l.TITLE=new o.GLocaleKey("GFastViewAction","title"),l.GroupID="view",l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return o.GLocale.get(l.TITLE)},l.prototype.getCategory=function(){return s.default.CATEGORY_VIEW},l.prototype.getGroup=function(){return l.GroupID},l.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},l.prototype.isCheckable=function(){return!0},l.prototype.isChecked=function(){const e=gDesigner.getActiveDocument(),t=e&&e.getActiveWindow();if(t){var n=t.getView().getViewConfiguration();return!!n&&n.paintMode===o.GScenePaintConfiguration.PaintMode.Fast}return!1},l.prototype.execute=function(){var e,t=gDesigner.getActiveDocument().getActiveWindow().getView().getViewConfiguration();if(t.paintMode===o.GScenePaintConfiguration.PaintMode.Fast){var n=gDesigner.getActiveDocument().getScene().getActivePage();if(t.defaultEffectDetailLevel=null,n&&!n.isFixedSized())e=o.GScenePaintConfiguration.PaintMode.Full;else e=(n.getProperty(r.default.CLIP_PROPERTY_NAME,!0)||r.default.CLIP_CONTENT_ENABLED)===r.default.CLIP_CONTENT_ENABLED?o.GScenePaintConfiguration.PaintMode.Output:o.GScenePaintConfiguration.PaintMode.Full}else t.defaultEffectDetailLevel=.5/o.GPaintCanvas.getScreenDPI(),e=o.GScenePaintConfiguration.PaintMode.Fast;gDesigner.setPaintMode(e),gDesigner.updateGEditorSceneConfigurationPaintMode(e)},l.prototype.toString=function(){return"[GAction GFastViewAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(1);e.exports={_reInitLayout:function(){this._canvasPropertiesRowInTouch=$("<div></div>").attr("data-property-row","canvas-size").addClass("canvas-properties-touch").gPropertyRow({columns:[{clazz:"canvas-properties-color-column",content:this._createInput("bck")},{clazz:"canvas-properties-type-and-size-column",content:$("<div>").addClass("canvas-properties-type-and-size-wrapper").append($("<div>").addClass("preset-size-wrapper").append(this._createInput("preset-size"))).append($("<div>").addClass("width-wrapper").append(this._createInput("w"))).append($("<div>").addClass("height-wrapper").append(this._createInput("h")))}]}).insertBefore(this._hrAfterbleedRow),this._bleedRowInTouch=$("<div>").addClass("page-size-and-bleed-properties-touch").gPropertyRow({columns:[{content:$("<span>"+i.GLocale.get(new i.GLocaleKey("GPageProperties","text.bleed"))+"</span>")},{clazz:"bleed-selector-column",content:this._createInput("bl")},{clazz:"page-size-and-bleed-separator-column",content:$("<div>").addClass("page-size-and-bleed-separator")},{clazz:"canvas-rotate-btn-column",content:this._createInput("rotate-canvas")},{clazz:"canvas-trim-btn-column",content:this._createInput("trim-canvas")},{clazz:"canvas-clip-btn-column",content:this._createInput("clip-content")}]}).insertBefore(this._hrAfterbleedRow)}}},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=n(193),s=i(n(18)),l=i(n(26));class c extends l.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._isReverse=e,this._title=new r.GLocaleKey("GEnterLayerGroupAction","title".concat(this._isReverse?".reverse":""))}getId(){return this._isReverse?c.ID_REVERSE:c.ID}getTitle(){return this._title}getCategory(){return s.default.CATEGORY_VIEW}getShortcut(){return this._isReverse?[o.GKey.Constant.SHIFT,o.GKey.Constant.ENTER]:[o.GKey.Constant.ENTER]}isVisible(){return!1}execute(){const e=gDesigner.getLeftSidebars().getSidebar(a.SidebarsIds.GOutlineSidebar).getLayerPanel(),{vtree:t,currentFocus:n}=e.data("glayerpanel");if(!n)return;let i;if(!this._isReverse&&n.firstChild?i=n.firstChild:this._isReverse&&n.parent&&n.parent.row&&(i=n.parent),i){const o=e.gLayerPanel("getItem",n),a=e.gLayerPanel("getItem",i);o.removeFlag(r.GNode.Flag.Selected),a.setFlag(r.GNode.Flag.Selected),t.expandAndFocus(a)}}toString(){return"[Object GEnterLayerGroupAction]"}}c.ID="view.enter-layer-group",c.ID_REVERSE="view.enter-layer-group.reverse",e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=n(193),s=i(n(18)),l=i(n(26));class c extends l.default{getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return s.default.CATEGORY_MODIFY}getShortcut(){return[o.GKey.Constant.META,"2"]}isVisible(){return!1}execute(){const e=gDesigner.getLeftSidebars().getActiveSidebar(),t=gDesigner.getLeftSidebars().getSidebar(a.SidebarsIds.GOutlineSidebar),n=t.getLayerPanel(),i=n.gLayerPanel("getCurrentFocusedNode");if(i&&e===t.getId()){const e=n.gLayerPanel("getItem",i);e.hasFlag(r.GNode.Flag.Selected)&&n.gLayerPanel("toggleLockStatusOfLayerOrItem",e)}}toString(){return"[Object GLockLayerAction]"}}c.ID="modify.lock-layer",c.TITLE=new r.GLocaleKey("GLockLayerAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=n(193),s=i(n(18)),l=i(n(26));class c extends l.default{getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return s.default.CATEGORY_VIEW}getShortcut(){return[o.GKey.Constant.META,"3"]}isVisible(){return!1}execute(){const e=gDesigner.getLeftSidebars().getActiveSidebar(),t=gDesigner.getLeftSidebars().getSidebar(a.SidebarsIds.GOutlineSidebar),n=t.getLayerPanel(),i=n.gLayerPanel("getCurrentFocusedNode");if(i&&e===t.getId()){const e=n.gLayerPanel("getItem",i);e.hasFlag(r.GNode.Flag.Selected)&&n.gLayerPanel("toggleHideStatusOfLayerOrItem",e)}}toString(){return"[Object GToggleLayerVisibilityAction]"}}c.ID="view.toggle-layer-visibility",c.TITLE=new r.GLocaleKey("GToggleLayerVisibilityAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(725));function s(){}o.GObject.inherit(s,a.default),s.ID="".concat(a.default.ID,".safari"),s.prototype.getId=function(){return s.ID},s.prototype.getShortcut=function(){return[r.GKey.Constant.META,r.GKey.Constant.ALT_LEFT,"O"]},s.prototype.isVisible=function(){return r.GPlatform.webBrowser===r.GPlatform.constructor.WebBrowser.Safari},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=(n(16),n(56)),r=n(18),a=n(26),s=n(1130);function l(){l.TOOLTIP_CONFIG={[o.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON]:o.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GImportFontsAction","text.try-this-feature-pro-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GImportFontsAction","text.try-this-feature-pro-tooltip-description")),learnMore:"https://documentation.designer.io/import-export/import/#import-fonts",upgradeToProStatsValue:"font.import",middle:!1,side:!0})}}i.GObject.inherit(l,a),l.ID="font.import",l.TITLE=new i.GLocaleKey("GImportFontsAction","title"),l.TOOLTIP_CONFIG=null,l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_FILE_IMPORT},l.prototype.getGroup=function(){return"import/import-fonts"},l.prototype.isEnabled=function(e){return e=e||gDesigner.getDefaultStorage(),!!gDesigner.getApplicationManager().isImportResourcesEnabled()&&(e.canPromptOpen()&&"undefined"!=typeof window&&window.indexedDB)},l.prototype.execute=function(e,t){(e=e||new s).import(t)},l.prototype.getTooltipArea=function(){return o.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON},l.prototype.getTooltipConfig=function(e){return e&&l.TOOLTIP_CONFIG[e]||null},l.prototype.toString=function(){return"[Object GImportFontsAction]"},e.exports=l},function(e,t,n){"use strict";n(25),n(19),n(24),n(111),n(90),n(3);var i=n(1),o=n(16),r=n(710),a=n(32),s=n(18),l=n(26),c=n(399),d=n(192),u=n(1479),p=n(76);const g=n(36);var h=null,f=!1,m=!1;function y(){}i.GObject.inherit(y,l),y.ID="file.print",y.TITLE=new i.GLocaleKey("GPrintAction","title"),y.prototype.getId=function(){return y.ID},y.prototype.getTitle=function(){return y.TITLE},y.prototype.getIcon=function(){return"gravit-icon-print"},y.prototype.getCategory=function(){return s.CATEGORY_FILE},y.prototype.getGroup=function(){return"print"},y.prototype.isEnabled=function(){if(!gDesigner.getApplicationManager().isExportEnabled())return!1;const e=gDesigner.getActiveDocument();return e&&(!e.isNew()||e.isModified())},y.prototype.getShortcut=function(){return[o.GKey.Constant.COMMAND,"P"]},y.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e.getScene(),n=new u.Item("PDF"),o={suppressMessages:!0,dpi:gDesigner.isEnabledProFeatures()?300:150,preserveEditingCapabilities:!1,jpegQuality:100,export:!0},s=()=>{console.log("NO DATA :(")};const l=()=>{-1!==navigator.userAgent.indexOf("Firefox")||gContainer.getRuntime()===p.Runtime.Electron&&r.GSVGExport.hasSupportedEffects(t)?g.confirm(i.GLocale.get(new i.GLocaleKey("GPrintAction","printing-warning")),e=>{e&&y()},void 0,void 0,void 0,!0,!0):y()};var y=()=>{Object.assign(o,{convertTextToPath:!0});let n=[];t.iteratePages((function(e){n.push(e)}));let i=[],l=(t,c)=>{if(t||!c)return s();if(i.push(c),n.shift(),n.length)return void r.GSVGExport.export(n[0],o,l);let d="";for(var u=0;u<i.length;u++){let e="data:image/svg+xml;base64,"+(0,a.stringToBase64String)(i[u]);d=d.concat("<img style='height:100%;width:auto;max-width:100%;display:block;' src='"+e+"'/>")}var p=h.contentDocument;p.head.innerHTML="<style type='text/css' media='print'>@page { margin: 0mm; }</style>",p.body.style.margin="0",p.body.style.height="100%",p.body.innerHTML=d,p.title=e.getTitle(),$(h.contentWindow.document).ready((function(){h.contentWindow.focus();try{h.contentWindow.print()}catch(e){m=!0,v()}}))};n.length&&r.GSVGExport.export(n[0],o,l)},v=()=>new d(i.GLocale.get(new i.GLocaleKey("GPrintAction","printing-disabled"))).open(),_=()=>{if(h.src){h.focus();try{h.contentWindow.print()}catch(e){f=!0,h.onload=l,h.src="about:blank"}}},b=()=>{n.read(e=>{let t=new window.Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(t);h.setAttribute("src",n)})};h||((h=document.createElement("iframe")).style.visibility="hidden",h.style.position="fixed",h.style.right="0",h.style.bottom="0",h.style.zIndex="-1",document.body.appendChild(h),gContainer.getRuntime()===p.Runtime.Electron&&(f=!0)),new c(()=>{!function(){if(m)v();else if(f)l();else{var i=0,a=[300,150,72,36,null];gDesigner.isEnabledProFeatures()||a.shift();for(var c=!1;!r.GPDFExport.isSupported(t,!0,a[i++]+"dpi");)if(null===a[i]){c=!0;break}c?(h.onload=null,y()):(o.dpi=a[i-1],h.onload=_,e.store(n,b,s,o))}}()},()=>{gDesigner.stats("action-cancelled_anonymous",this.getId())})},y.prototype.toString=function(){return"[Object GPrintAction]"},e.exports=y},function(e,t,n){"use strict";var i=n(1),o=n(216);function r(){}i.GObject.inherit(r,o),r.Item=function(e){o.Item.call(this,new r),this._extension=e},i.GObject.inherit(r.Item,o.Item),r.Item.prototype._extension=null,r.Item.prototype.getExtension=function(){return this._extension},r.Item.prototype.read=function(e,t,n){return e(this._data)},r.Item.prototype.write=function(e,t,n,i){this._data=e,t&&t()},e.exports=r},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(94);function a(){}i.GObject.inherit(a,r),a.ID="modify.reverse-order",a.TITLE=new i.GLocaleKey("GReverseOrderAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_MODIFY_PATH},a.prototype.getGroup=function(){return"structure/path"},a.prototype.isEnabled=function(){if(!r.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null,t=!1;if(e)for(var n=0;!t&&n<e.length;++n)e[n]instanceof i.GPath&&(t=!0);return t},a.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getSelection():null,o=[];if(n)for(var r=0;r<n.length;++r){var a=n[r];a instanceof i.GPath&&o.push(a)}if(o.length){t.beginTransaction();try{for(r=0;r<o.length;++r)o[r].reverseOrder()}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}},a.prototype.toString=function(){return"[Object GReverseOrderAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="file.save-all",a.TITLE=new i.GLocaleKey("GSaveAllAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_FILE},a.prototype.getGroup=function(){return"file"},a.prototype.isAvailable=function(e){return!1},a.prototype.isEnabled=function(){return!1},a.prototype.execute=function(){for(var e=gDesigner.getDocuments(),t=0;t<e.length;++t)e[t].isModified()&&e[t].save()},a.prototype.toString=function(){return"[Object GSaveAllAction]"},e.exports=a},function(e,t,n){"use strict";n(9),n(3);var i=n(1),o=n(18),r=n(26),a=n(1159),s=n(1161);function l(){}i.GObject.inherit(l,r),l.ID=s.ID,l.TITLE=new i.GLocaleKey("GSettingsAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return o.CATEGORY_EDIT},l.prototype.getGroup=function(){return"settings"},l.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-setting-touch":""},l.prototype.execute=async function(){(new a).then(e=>e.open())},l.prototype.toString=function(){return"[Object GSettingsAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26),s=n(1056);function l(){}i.GObject.inherit(l,a),l.ID="view.canvas.show-rulers",l.TITLE=new i.GLocaleKey("GShowRulersAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return r.CATEGORY_VIEW_CANVAS},l.prototype.getGroup=function(){return"show/canvas"},l.prototype.getShortcut=function(){return[o.GKey.Constant.META,o.GKey.Constant.OPTION,"R"]},l.prototype.isEnabled=function(){return!(!gDesigner.getWindows().getActiveWindow()||!gDesigner.getWindows().getActiveWindow().getView())},l.prototype.isCheckable=function(){return!0},l.prototype.isChecked=function(){return gDesigner.getWindows().getActiveWindow()&&gDesigner.getWindows().getActiveWindow().getView()&&gDesigner.getWindows().getActiveWindow().getView().hasRulers()},l.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView(),t=!e.hasRulers(),n=gDesigner.getAction(s.ID);t&&!n.isChecked()&&gDesigner.executeAction(s.ID,void 0,void 0,!0),e.setRulers(t),$("#mainframe").toggleClass("rulers",t),gDesigner.setSetting("rulers_visible",t)},l.prototype.toString=function(){return"[Object GShowRulersAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="view.canvas.show-slices",a.TITLE=new i.GLocaleKey("GShowSlicesAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_VIEW_CANVAS},a.prototype.getGroup=function(){return"show/canvas"},a.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},a.prototype.isCheckable=function(){return!0},a.prototype.isChecked=function(){var e=gDesigner.getWindows().getActiveWindow();if(e){var t=e.getView().getViewConfiguration();return!!t&&!0===t.slices}return!1},a.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow().getView();e.getViewConfiguration().slices=!e.getViewConfiguration().slices,e.invalidateAndResetCache(null)},a.prototype.toString=function(){return"[Object GShowSlicesAction]"},e.exports=a},function(e,t,n){"use strict";n(19),n(24),n(297),n(3);var i=n(1),o=n(32),r=n(18),a=n(94);function s(){}i.GObject.inherit(s,a),s.ID="modify.bmp2path",s.TITLE=new i.GLocaleKey("GVectorizeImageAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_MODIFY_PATH},s.prototype.getGroup=function(){return"structure/modify"},s.prototype.isEnabled=function(){if(!a.prototype.isEnabled.call(this))return!1;var e=gDesigner.getActiveDocument()?gDesigner.getActiveDocument().getEditor().getSelection():null;if(e)for(var t=0;t<e.length;++t)if(e[t]instanceof i.GImage&&!e[t].getStatus())return!0;return!1},s.prototype.execute=function(){var e=gDesigner.getActiveDocument(),t=e?e.getEditor():null,n=t?t.getIndividualSelection():null,r=[];if(n)for(var a=0;a<n.length;++a)n[a]instanceof i.GImage&&!n[a].getStatus()&&r.push(n[a]);if(r.length){t.beginTransaction();try{var s,l=[];s=new Set;for(a=0;a<r.length;++a){var c=r[a].getParent();c&&s.add(c)}try{(0,o.blockChanges)(t,s);for(a=0;a<r.length;++a){var d=r[a],u=d.getParent(),p=d.getNext(),g=this._vectorize(d);g&&(u.insertChild(g,p),l.push(g)),u.removeChild(d)}}finally{(0,o.releaseChanges)(t,s),l.length&&t.updateSelection(!1,l)}}finally{t.commitTransaction(i.GLocale.get(this.getTitle()))}}},s.prototype._vectorize=function(e){new i.GVertexContainer;var t,n,o=e.getImageCanvas(),r=new i.GImageTracer,a=r.getImgdata(o),s=a.width,l=a.height,c=r.imagedataToTracedata(a,{ltres:1,qtres:Math.min(s/4,l/4,10),numberofcolors:8,blurradius:2,colorquantcycles:5,pathomit:Math.min(.25*s,.25*l,20)}),d=c.palette,u=[];for(t in c.layers)if(c.layers.hasOwnProperty(t))for(n=0;n<c.layers[t].length;n++)u[c.layers[t][n][0].y1*s+c.layers[t][n][0].x1]={l:""+t,p:""+n};var p,g,h=Object.keys(u);h.sort((function(e,t){return e-t}));var f,m,y=new i.GGroup,v=-1;for(t=0;t<h.length;t++)if(p=u[h[t]].l,f=t+1<h.length?u[h[t+1]].l:-1,g=u[h[t]].p,0!==d[p].a){var _=new i.GRGBColor([d[p].r,d[p].g,d[p].b]),b=c.layers[p];p!==v&&(m=new i.GVertexContainer);var w=b[g];m.addVertex(i.GVertex.Command.Move,w[0].x1,w[0].y1);for(var C=0;C<w.length;C++){var E=w[C];"L"===E.type?m.addVertex(i.GVertex.Command.Line,E.x2,E.y2):(m.addVertex(i.GVertex.Command.Curve,E.x3,E.y3),m.addVertex(i.GVertex.Command.Curve,E.x2,E.y2))}if(p!==f){m=new i.GVertexSimplifier(m).simplify(.4,!1,!0);var S=i.GPathUtil.createPathFromVertexSource(m);S&&(S.getPaintLayers().appendChild(new i.GStylable.FillPaintLayer(_)),S.setProperty("name",_.getClosestCSSName()),y.appendChild(S))}v=p}return y},s.prototype.toString=function(){return"[Object GVectorizeImageAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(14),n(115),n(29);var o=n(1),r=n(16),a=i(n(1487)),s=i(n(76)),l=i(n(26)),c=i(n(18)),d=i(n(36)),u=i(n(396)),p=i(n(1224));const{isExecutingOnMSTeamsSync:g}=u.default;class h extends l.default{constructor(){super(),this.ID="view.play",this.TITLE=new o.GLocaleKey("GPlayAction","title"),this._scene=null,this._isInPlayMode=null,this._shouldExitFullScreen=null,this._isErrorMessageDisplaying=!1,this._timeoutId=null,this._isLoading=!1,this._keyDownHandlerBind=this._keyDownHandler.bind(this),this._fullScreenRequestDeniedHandlerBind=this._fullScreenRequestDeniedHandler.bind(this),this._browserFullScreenModeChangeHandlerBind=this._browserFullScreenModeChangeHandler.bind(this)}getId(){return h.ID}getTitle(){return h.TITLE}getCategory(){return c.default.CATEGORY_VIEW}getShortcut(){return[r.GKey.Constant.META,r.GKey.Constant.OPTION,r.GKey.Constant.ENTER]}isEnabled(){return!!gDesigner.getActiveDocument()&&a.default.enabled&&!this._isErrorMessageDisplaying&&!this._isLoading}isVisible(){return!g()}execute(){if(this._isInPlayMode)return this._exitPlayMode();if(this._scene=this._getScene(),this._scene)if(this._setIsLoading(!0),this._widget=new r.GSceneWidget(this._scene),this._widget.getViewConfiguration().paintMode=o.GScenePaintConfiguration.PaintMode.Output,this._overlay=$("<div></div>").css({position:"absolute",zIndex:9999,left:0,right:0,top:0,bottom:0,background:"black"}),this._overlay.append(this._widget._htmlElement).appendTo($("body")),document.addEventListener("keydown",this._keyDownHandlerBind,!0),window.addEventListener("unhandledrejection",this._fullScreenRequestDeniedHandlerBind),gContainer.getRuntime()===s.default.Runtime.Electron){const e=n(791).remote.getCurrentWindow();e.once("leave-full-screen",this._exitPlayMode.bind(this)),e.isFullScreen()?(this._setShouldExitFullScreen(!1),this._enterPlayMode()):(this._setShouldExitFullScreen(!0),e.once("enter-full-screen",()=>{this._timeoutId=setTimeout(this._enterPlayMode.bind(this),250)}),e.setFullScreen(!0))}else this._setShouldExitFullScreen(!0),document.addEventListener(a.default.raw.fullscreenchange,this._browserFullScreenModeChangeHandlerBind),a.default.request(this._overlay[0])}changeActivePage(e,t){const n=gDesigner.getAction("".concat(p.default.ID,".").concat(t)).getNextPage(e);n?e.setActivePage(n):t===p.default.Type.Next&&a.default.exit()}_getScene(){gDesigner.toggleLoading(!0);try{return this._cloneActiveScene()}catch(e){return null}finally{gDesigner.toggleLoading(!1)}}_cloneActiveScene(){const e=gDesigner.getActiveDocument(),t=e&&e.getScene();return t?t.clone(null,t.getWorkspace()):null}_keyDownHandler(e){let t=!0;switch(r.GKey.translateCode(e.code)){case r.GKey.Constant.DOWN:case r.GKey.Constant.PAGE_DOWN:case r.GKey.Constant.RIGHT:case r.GKey.Constant.SPACE:this.changeActivePage(this._scene,p.default.Type.Next);break;case r.GKey.Constant.UP:case r.GKey.Constant.PAGE_UP:case r.GKey.Constant.LEFT:this.changeActivePage(this._scene,p.default.Type.Previous);break;case r.GKey.Constant.ESC:gContainer.getRuntime()===s.default.Runtime.Electron&&this._exitPlayMode();break;default:t=!1}t&&e.stopPropagation()}_fullScreenRequestDeniedHandler(e){"Fullscreen request denied"===e.reason.message&&(this._exitPlayMode(),d.default.custom({title:o.GLocale.getValue("GCommonNames","text.something-wrong.try-again"),openCallback:()=>this._setIsErrorMessageDisplaying(!0),closeCallback:()=>this._setIsErrorMessageDisplaying(!1)}))}_enterPlayMode(){this._setIsInPlayMode(!0),this._widget.resize(this._overlay.outerWidth(),this._overlay.outerHeight());const e=this._scene.getActivePage().getPaintBBox();if(this._widget.zoomAll(e,!1),gContainer.getRuntime()===s.default.Runtime.Browser||gContainer.getRuntime()===s.default.Runtime.PWA){/^((?!chrome|android)(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))*[s\u017F]afari/i.test(navigator.userAgent)&&this._createExitFullScreenHint().appendTo(this._overlay)}this._setIsLoading(!1)}_createExitFullScreenHint(){return $("<div/>").addClass("g-exit-full-screen").on("webkitAnimationEnd",e=>{$(e.target).closest(".g-exit-full-screen").remove()}).append($("<div/>").html(o.GLocale.getValue("GPlayAction","text.exit-full-screen").replace("%key",()=>$("<span/>").addClass("highlight").text(o.GLocale.getValue("GPlayAction","text.esc")).prop("outerHTML"))))}_exitPlayMode(){this._timeoutId&&clearTimeout(this._timeoutId),this._shouldExitFullScreen&&this._exitFullScreen(),this._overlay.remove(),this._widget.release(),document.removeEventListener("keydown",this._keyDownHandlerBind,!0),document.removeEventListener(a.default.raw.fullscreenchange,this._browserFullScreenModeChangeHandlerBind),window.removeEventListener("unhandledrejection",this._fullScreenRequestDeniedHandlerBind),this._setIsInPlayMode(!1),this._setIsLoading(!1)}_browserFullScreenModeChangeHandler(){a.default.isFullscreen?this._enterPlayMode():this._exitPlayMode()}_exitFullScreen(){if(gContainer.getRuntime()===s.default.Runtime.Electron){n(791).remote.getCurrentWindow().setFullScreen(!1)}else a.default.exit()}_setIsInPlayMode(e){this._isInPlayMode=e}_setIsLoading(e){this._isLoading=e}_setShouldExitFullScreen(e){this._shouldExitFullScreen=e}_setIsErrorMessageDisplaying(e){this._isErrorMessageDisplaying=e}toString(){return"[Object GPlayAction]"}}e.exports=h},function(e,t,n){!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,i="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,o=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,o=n.length,r={};i<o;i++)if((e=n[i])&&e[1]in t){for(i=0;i<e.length;i++)r[n[0][i]]=e[i];return r}return!1}(),r={change:o.fullscreenchange,error:o.fullscreenerror},a={request:function(e){var n=o.requestFullscreen;e=e||t.documentElement,/ Version\/5\.1(?:\.\d+)? Safari\//.test(navigator.userAgent)?e[n]():e[n](i?Element.ALLOW_KEYBOARD_INPUT:{})},exit:function(){t[o.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var i=r[e];i&&t.addEventListener(i,n,!1)},off:function(e,n){var i=r[e];i&&t.removeEventListener(i,n,!1)},raw:o};o?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[o.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[o.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(t[o.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports=!1:window.screenfull=!1}()},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(18),a=n(26);function s(){}i.GObject.inherit(s,a),s.ID="view.canvas.show-effects",s.TITLE=new i.GLocaleKey("GShowEffectsAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_VIEW_CANVAS},s.prototype.getGroup=function(){return"show/canvas"},s.prototype.isEnabled=function(){return!!gDesigner.getWindows().getActiveWindow()},s.prototype.isCheckable=function(){return!0},s.prototype.getShortcut=function(){return[o.GKey.Constant.META,"E"]},s.prototype.isChecked=function(){var e=gDesigner.getWindows().getActiveWindow();return!!e&&!e.getView().getViewConfiguration().ignoreEffects},s.prototype.execute=function(){var e=gDesigner.getWindows().getActiveWindow();if(!e)return!1;var t=e.getView();t.getViewConfiguration().ignoreEffects=!t.getViewConfiguration().ignoreEffects,t.invalidateAndResetCache(null)},s.prototype.toString=function(){return"[Object GShowEffectsAction]"},e.exports=s},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(396)),a=n(12),s=n(18),l=n(26),c=n(192),d=n(76),u=n(106);const p=n(36),{isExecutingOnMSTeamsSync:g}=r.default;function h(e,t){this._locale=e,this._title=h.Translations[e]||t}h.Translations=["English","Deutsch","中文","Português","Español","Français"],o.GObject.inherit(h,l),h.ID="language",h.prototype._locale=null,h.prototype._title=null,h.prototype.getId=function(){return h.ID+"."+this._locale},h.prototype.isCheckable=function(){return!0},h.prototype.isChecked=function(){return o.GLocale.getLanguage()===this._locale},h.prototype.getTitle=function(){return this._title},h.prototype.getCategory=function(){return s.CATEGORY_HELP_LANGUAGE},h.prototype.getGroup=function(){return"help/language"},h.prototype.isEnabled=function(){return!0},h.prototype.isVisible=function(){return!g()},h.prototype.execute=function(){if(o.GLocale.getLanguage()!==this._locale){let e=()=>gDesigner.setSetting("language",this._locale),t=()=>a.gApi.updateUser({locale:o.GLocale.lookupLocale(this._locale)}).then(()=>e()).then(()=>this._reloadApp()).catch(e=>p.alert(a.gApi.formatError(e)));gDesigner.getUser().then(n=>{n?gDesigner.isAnonymous()?(e(),this._reloadApp()):t():u.performLogin().then(e=>{e&&t()})})}},h.prototype._reloadApp=function(){gContainer.getRuntime()===d.Runtime.Browser||gContainer.getRuntime()===d.Runtime.PWA?location.reload():new c(o.GLocale.get(new o.GLocaleKey("GNewDocumentDialog","text.restart-app"))).open()},h.prototype.toString=function(){return"[Object GSwitchLanguageAction]"},e.exports=h},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26),{IS_BETA:a,IS_TRUNK:s}=n(198);function l(e){let{name:t,category:n,group:o,link:r,icon:a,builder:s}=e;this._name=t,this._category=n,this._group=o,this._link=r,this._builder=s,this._title=new i.GLocaleKey("GOpenLinkAction","title."+t),this._icon=a}l.Links=n(1491),(a||s)&&(l.Links.push({name:"feedback",link:"https://discuss.gravit.io/c/beta/",category:o.CATEGORY_HELP_BETA_FEEDBACK,group:"help/beta_feedback"}),l.Links.push({name:"open-a-ticket",link:"https://designer.io/support",category:o.CATEGORY_HELP_BETA_FEEDBACK,group:"help/beta_feedback"})),i.GObject.inherit(l,r),l.ID="open-link",l.prototype._name=null,l.prototype._title=null,l.prototype.getIcon=function(){return this._icon||null},l.prototype.getId=function(){return l.ID+"."+this._name},l.prototype.getTitle=function(){return this._title},l.prototype.getCategory=function(){return this._category},l.prototype.getGroup=function(){return this._group},l.prototype.isEnabled=function(){return!0},l.prototype.execute=function(){if(this._link||this._builder){let e=this._builder&&"function"==typeof this._builder&&this._builder()||this._link;e&&gContainer.openExternalLink(null,e)}},l.prototype.toString=function(){return"[Object GOpenLinkAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(18),o=n(1185);e.exports=[{name:"contact-us",link:"https://designer.io/support",category:i.CATEGORY_HELP_SUPPORT,group:"help/support"},{name:"user-guide",link:"http://documentation.designer.io/",category:i.CATEGORY_HELP_LEARN,group:"help/learn"},{name:"tutorials",link:o.youtubePlaylist,category:i.CATEGORY_HELP_LEARN,group:"help/learn"},{name:"changelog",link:"https://www.designer.io/changelog",category:i.CATEGORY_HELP,group:"help"},{name:"blog",link:"https://www.designer.io/en/blog",category:i.CATEGORY_HELP_LEARN,group:"help/learn"},{name:"request-new-feature",link:gApi.link.getRequestNewFeatureUrl(),category:i.CATEGORY_HELP,group:"help"},{name:"eula",link:"http://www.corel.com/eula",category:i.CATEGORY_HELP,group:"help"}]},function(e,t,n){"use strict";n(3);var i=n(1),o=n(18),r=n(26),a=n(106);function s(){}i.GObject.inherit(s,r),s.ID="file.open-from-template",s.TITLE=new i.GLocaleKey("GNewFromTemplateAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return o.CATEGORY_FILE},s.prototype.getGroup=function(){return"document"},s.prototype.isEnabled=function(){return a.isOnline()&&!gDesigner.isOffline(6e5)&&gDesigner.getApplicationManager().isCreatingNewDocumentEnabled()},s.prototype.execute=function(){gContainer.newDocumentActionPerformed(),gDesigner.openNewDocumentDialog({closable:!0,showCloudOptions:!0,defaultOption:"templates-option",newOrFromTemplate:!0})},s.prototype.toString=function(){return"[Object GNewFromTemplateAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(26),r=n(18);function a(){}i.GObject.inherit(a,o),a.ID="open-welcome-screen",a.TITLE=new i.GLocaleKey("GOpenWelcomeScreenAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return r.CATEGORY_HELP},a.prototype.getGroup=function(){return"help"},a.prototype.isEnabled=function(){return(!gDesigner._newDocumentDialog||!gDesigner._newDocumentDialog.isOpen())&&gDesigner.getApplicationManager().isCreatingNewDocumentEnabled()},a.prototype.execute=function(){gDesigner.openNewDocumentDialog({closable:!0,showCloudOptions:!0})},a.prototype.toString=function(){return"[Object GOpenWelcomeScreenAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(26),r=n(18);function a(){}i.GObject.inherit(a,o),a.ID="check-for-updates",a.TITLE=new i.GLocaleKey("GCheckForUpdatesAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return r.CATEGORY_HELP},a.prototype.getGroup=function(){return"help"},a.prototype.isEnabled=function(){return!0},a.prototype.execute=function(){gDesigner.getSoftwareUpdateManager().checkForUpdates()},a.prototype.toString=function(){return"[Object GCheckForUpdatesAction]"},e.exports=a},function(e,t,n){"use strict";n(83),n(3);var i=n(1),o=n(1496),r=n(768),a=n(26),s=n(18),l=n(192);function c(){var e,t=Array.prototype.slice.call(arguments);try{e=JSON.stringify(t)}catch(n){e=t.join(", ")}(0,o.addLog)(+new Date,e).then(()=>{console.trace("added log")}).catch(e=>{})}function d(e){return new Proxy(e,{apply:function(e,t,n){e.apply(e,n),c.apply(c,n)}})}function u(){}window.console.log=d(window.console.log),window.console.warn=d(window.console.warn),window.console.error=d(window.console.error),window.console.info=d(window.console.info),window.console.debug=d(window.console.debug),i.GObject.inherit(u,a),u.ID="developer-details",u.TITLE=new i.GLocaleKey("GDeveloperDetailsAction","title"),u.prototype.getId=function(){return u.ID},u.prototype.getTitle=function(){return u.TITLE},u.prototype.getCategory=function(){return s.CATEGORY_HELP_SUPPORT},u.prototype.getGroup=function(){return"help/support"},u.prototype.isEnabled=function(){return!0},u.prototype.execute=function(){(0,o.getLogs)().then(e=>{var t=e.map(e=>{let{time:t,log:n}=e;return"".concat(new Date(t)," : ").concat(n)}).join("\r\n");(0,r.downloadDataURI)(t,"developer-details","txt",{type:"text/plain"}),(0,o.clearLogs)().then(()=>{new l(i.GLocale.get(new i.GLocaleKey("GDeveloperDetailsAction","message"))).open()})})},u.prototype.toString=function(){return"[Object GDeveloperDetailsAction]"},e.exports=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLogs=t.default=t.clearLogs=t.addLog=void 0,n(9);let i;const o=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,r=()=>!!i,a=()=>new Promise((e,t)=>{i||e();try{const n=i.transaction(["logs"],"readwrite").objectStore("logs").clear();n.onsuccess=t=>{e()},n.onerror=e=>{t()}}catch(e){console.log("Cannot clear DB",e.message)}}),s=e=>{let{target:{result:t}}=e;if(i||(console.warn("No database.consolemanager.result:"+t),i=t),i&&!i.objectStoreNames.contains("logs")){i.createObjectStore("logs",{keyPath:"time"}).createIndex("log","log",{unique:!1})}},l=(e,t)=>{let{target:{result:n}}=e;i||(console.warn("No database.consolemanager.result:"+n),i=n),i&&t(i)},c=(e,t)=>{let{target:{result:n}}=e;if(n){if(i=n,i.onerror=e=>{},i.setVersion)if(i.version!=DBVERSION)return void(i.setVersion(DBVERSION).onsuccess=e=>{l(e,t)});l({target:{result:i}},t)}else console.error("DB ERROR: Couldn't connect to indexedDB")},d=e=>{const t=o.open("consoleLogs",1);return"done"!==t.readyState?(t.onupgradeneeded=s,t.onsuccess=t=>{c(t,e)},t.onerror=e=>{},null):(c({target:t.target},e),t)},u=(e,t)=>new Promise((n,o)=>{const a=i=>{const r={time:e,log:t},a=i.transaction(["logs"],"readwrite").objectStore("logs");a.add(r),a.onsuccess=e=>{n(e.target.result)},a.onerror=e=>{o(e)}};r()?a(i):d(a)});t.addLog=u;const p=()=>new Promise((e,t)=>{const n=n=>{const i=n.transaction(["logs"],"readwrite").objectStore("logs");i.getAll().onsuccess=t=>{let{target:{result:n}}=t;e(n)},i.onerror=e=>{t(e)}};return r()?n(i):d(n)});t.getLogs=p;const g=a;t.clearLogs=g,d(a);var h={addLog:u,getLogs:p,clearLogs:g};t.default=h},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(26);function r(e){this._action=e}i.GObject.inherit(r,o),r.prototype._action=null,r.prototype.getId=function(){return this._action.getId()},r.prototype.getTitle=function(){return this._action.getTitle()},r.prototype.getIcon=function(){return this._action.getIcon()},r.prototype.getCategory=function(){return this._action.getCategory()},r.prototype.getGroup=function(){return this._action.getGroup()},r.prototype.getGroupIcon=function(){return this._action.getGroupIcon()},r.prototype.getShortcut=function(){return this._action.getShortcut()},r.prototype.isShortcutGlobal=function(){return this._action.isShortcutGlobal()},r.prototype.isRegisterShortcut=function(){return this._action.isRegisterShortcut()},r.prototype.getAdditionalShortcuts=function(){return this._action.getAdditionalShortcuts()},r.prototype.isEnabled=function(){return this._action.isEnabled()},r.prototype.isCheckable=function(){return this._action.isCheckable()},r.prototype.isChecked=function(){return this._action.isChecked()},r.prototype.isAvailable=function(e){return this._action.isAvailable(e)},r.prototype.execute=function(){if(gDesigner.isEnabledProFeatures(this._action.getId()))return this._action.execute.apply(this._action,arguments);gDesigner.handlePROFeatureInterruption()},r.prototype.executeFromShortcut=function(){return this.execute.apply(this,arguments)},r.prototype.isPro=function(){return!0},r.prototype.getTooltipArea=function(){return this._action.getTooltipArea()},r.prototype.getTooltipConfig=function(e){return this._action.getTooltipConfig(e)},r.prototype.statsValue=function(){return this._action.statsValue()},r.prototype.toString=function(){return this._action.toString()},e.exports=r},function(e,t,n){"use strict";n(14),n(29),n(3);var i=n(1);const o=n(18),r=n(26),a=n(76),{CLOUD_SYNC_FEATURE:{NEW_LAYOUT:s}={}}=n(12);function l(){}i.GObject.inherit(l,r),l.ID="cloud.sync.info",l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){const e=gDesigner.getActiveDocument();if(e&&e.getScene()){const t=e.getScene().lastModifiedDate();return t?i.GLocale.get(new i.GLocaleKey("GCloudSynchronizationAction","text.last-synced-at")).replace("%date",i.GLocale.toLocaleDate(t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})):i.GLocale.get(new i.GLocaleKey("GDocumentChooser","text.cloud.unavailable"))}return i.GLocale.get(new i.GLocaleKey("GDocumentChooser","text.cloud.unavailable"))},l.prototype.getCategory=function(){return o.CATEGORY_FILE},l.prototype.getGroup=function(){return"file"},l.prototype.isVisible=function(){const e=gDesigner.getActiveDocument();return e&&e.isCloudSyncOn()&&e.isCloudSynchronismAvailable()},l.prototype.isEnabled=function(){return!1},l.prototype.isAvailable=function(){return!!s&&gContainer.getRuntime()===a.Runtime.Electron&&i.GSystem.operatingSystem===i.GSystem.OperatingSystem.OSX_IOS},l.prototype.toString=function(){return"[Object GCloudSynchronizationInfoAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="file.share",a.TITLE=new i.GLocaleKey("GShareAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_FILE_SHARE},a.prototype.getGroup=function(){return"file-share/share"},a.prototype.isEnabled=function(){return gDesigner.getApplicationManager().isShareEnabled()},a.prototype.isVisible=function(){return!0},a.prototype.execute=function(){gDesigner.getShareManager().share()},a.prototype.toString=function(){return"[Object GShareAction]"},e.exports=a},function(e,t,n){"use strict";var i=n(17);n(9),n(3);var o=n(1),r=i(n(396));const{isExecutingOnMSTeamsSync:a}=r.default;var s=n(18),l=n(26);const c=n(1041),d=n(36);function u(){}o.GObject.inherit(u,l),u.ID="file.sharepoint-checkout",u.TITLE=new o.GLocaleKey("GSharePointCheckOutAction","title"),u.prototype.getId=function(){return u.ID},u.prototype.getTitle=function(){return u.TITLE},u.prototype.getCategory=function(){return s.CATEGORY_FILE},u.prototype.getGroup=function(){return"file"},u.prototype.isEnabled=function(){if(!a())return!1;const e=gDesigner.getActiveDocument();if(!e)return!1;const t=e.getStorageItem();return!!t&&t instanceof c.Item},u.prototype.isVisible=function(){return this.isEnabled()},u.prototype.execute=async function(){try{const e=gDesigner.getActiveDocument().getStorageItem();if(await e.refreshCheckOutStatus(),e.isCheckedOutByMe())return d.alert(o.GLocale.get(new o.GLocaleKey("GSharePointCheckOutAction","text.already-checkout")));await e.checkOut(),d.alert(o.GLocale.get(new o.GLocaleKey("GSharePointCheckOutAction","text.successul-checkout")))}catch(e){d.alert(e.message)}},u.prototype.toString=function(){return"[Object GSharePointCheckOutAction]"},e.exports=u},function(e,t,n){"use strict";var i=n(17);n(9),n(14),n(29),n(3);var o=n(1),r=i(n(396));const{isExecutingOnMSTeamsSync:a}=r.default;var s=n(18),l=n(26);const c=n(1041),d=n(36),u=n(1502),p=n(78);function g(){}o.GObject.inherit(g,l),g.ID="file.sharepoint-checkin",g.TITLE=new o.GLocaleKey("GSharePointCheckInAction","title"),g.prototype.getId=function(){return g.ID},g.prototype.getTitle=function(){return g.TITLE},g.prototype.getCategory=function(){return s.CATEGORY_FILE},g.prototype.getGroup=function(){return"file"},g.prototype.isEnabled=function(){return!!this._isSupported()&&gDesigner.getActiveDocument().getStorageItem().isCheckedOutByMe()},g.prototype._isSupported=function(){if(!a())return!1;const e=gDesigner.getActiveDocument();if(!e)return!1;const t=e.getStorageItem();return!!t&&t instanceof c.Item},g.prototype.isVisible=function(){return this._isSupported()},g.prototype.execute=async function(){try{const e=gDesigner.getActiveDocument();if(e.isModified())return void d.alert(o.GLocale.get(new o.GLocaleKey("GSharePointCheckInAction","text.doc-modified-save-before-check-in")).replace("%title",e.getTitle()));const t=e.getStorageItem(),n=t.getCloudClient(),i=await n.getLibrarySettings();await u.openCheckInDialog(i).then(async n=>{let{ok:i,comment:o,type:r}=n;i&&(await t.checkIn(o,r),gDesigner.trigger(new p(p.Type.SynchronismUpdated,e)))})}catch(e){d.alert(e.message)}},g.prototype.toString=function(){return"[Object GSharePointCheckInAction]"},e.exports=g},function(e,t,n){"use strict";var i=n(17);n(9);var o=n(1),r=i(n(1124));const a=[{text:new o.GLocaleKey("GFilesPanelViewSharepoint","text.checkin-type-minor"),value:r.default.CheckinType.MinorCheckIn,selected:!0},{text:new o.GLocaleKey("GFilesPanelViewSharepoint","text.checkin-type-major"),value:r.default.CheckinType.MajorCheckIn},{text:new o.GLocaleKey("GFilesPanelViewSharepoint","text.checkin-type-overwrite"),value:r.default.CheckinType.OverwriteCheckIn}];e.exports=class{static openCheckInDialog(e){return new Promise(async t=>{var n=$("<div></div>").addClass("g-container-sharepoint-check-in-dialog").append($("<div></div>").addClass("minor-related").addClass("row").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewSharepoint","text.choose-checkin-type")))).append($("<div></div>").addClass("row").addClass("minor-related").append($("<select/>").addClass("check-in-type").addClass("field").append(a.map(e=>{let{text:t,value:n,selected:i}=e;return $("<option/>").attr("value",n).text(o.GLocale.get(t)).prop("selected",!!i)})))).append($("<div></div>").addClass("row").text(o.GLocale.get(new o.GLocaleKey("GFilesPanelViewSharepoint","text.checkin-comment")))).append($("<div></div>").addClass("row").append($("<textarea/>").addClass("comment").addClass("field").addClass("max-width").attr("type","text")));n.gDialog({releaseOnClose:!0,className:"g-sharepoint-check-in-dialog",buttons:[$("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GLocale","cancel"))).on("click",()=>{n.gDialog("close"),t({ok:!1}),gDesigner.stats("filespanel-view_sharepoint-checkin_cancel")}),$("<button></button>").addClass("primary").text(o.GLocale.get(new o.GLocaleKey("GLocale","ok"))).on("click",()=>{n.gDialog("close");const i=e.enableMinorVersions?n.find(".check-in-type").val():r.default.CheckinType.MajorCheckIn;let o;o=i===r.default.CheckinType.MinorCheckIn?"minor":i===r.default.CheckinType.MajorCheckIn?"major":"overwrite-minor-version",gDesigner.stats("filespanel-view_sharepoint-checkin_confirm",o),t({ok:!0,comment:n.find(".comment").val(),type:i})})]}),n.gDialog("open",!1),e.enableMinorVersions||(n.find(".minor-related").hide(),n.find("textarea").focus())})}}},function(e,t,n){"use strict";n(3);var i=n(1),o=n(16),r=n(26),a=n(18),s=n(76);function l(){}i.GObject.inherit(l,r),l.ID="file.quit",l.TITLE=new i.GLocaleKey("GQuitAction","title"),l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){return l.TITLE},l.prototype.getCategory=function(){return a.CATEGORY_FILE},l.prototype.getGroup=function(){return"file-quit"},l.prototype.isEnabled=function(){return gContainer.getRuntime()!==s.Runtime.Browser&&gContainer.getRuntime()!==s.Runtime.PWA},l.prototype.getShortcut=function(){return[o.GKey.Constant.META,"Q"]},l.prototype.isAvailable=function(){return gContainer.getRuntime()!==s.Runtime.Browser&&gContainer.getRuntime()!==s.Runtime.PWA},l.prototype.execute=function(){gContainer.triggerClose()},l.prototype.toString=function(){return"[Object GQuitAction]"},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(26),r=n(18),a=n(231);function s(){}i.GObject.inherit(s,o),s.ID="example-files",s.TITLE=new i.GLocaleKey("GExampleFilesAction","title"),s.prototype.getId=function(){return s.ID},s.prototype.getTitle=function(){return s.TITLE},s.prototype.getCategory=function(){return r.CATEGORY_HELP_LEARN},s.prototype.getGroup=function(){return"help/learn"},s.prototype.execute=function(){const e={closable:!0,showCloudOptions:!0,openFromCloud:!0,nativeCloud:!0,showExampleFiles:!0},t=()=>gDesigner.openNewDocumentDialog(e);gDesigner.isOffline()?a.openUnavailableFeature(t):t()},s.prototype.toString=function(){return"[GObject GExampleFilesAction]"},e.exports=s},function(e,t,n){"use strict";n(3);var i=n(1),o=n(56),r=n(18),a=n(26);const{TOUCH_LAYOUT:s}=n(12),l=n(76);function c(){c.TOOLTIP_CONFIG={[o.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON]:o.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GToggleTouchAction","text.try-this-feature-pro-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GToggleTouchAction","text.try-this-feature-pro-tooltip-description")),learnMore:"https://documentation.designer.io/touch-interface/",upgradeToProStatsValue:"view.toggle-touch",middle:!1,side:!0})}}i.GObject.inherit(c,a),c.ID="view.toggle-touch",c.TITLE=new i.GLocaleKey("GToggleTouchAction","title"),c.TITLE_DISABLE=new i.GLocaleKey("GToggleTouchAction","title-disable"),c.TOOLTIP_CONFIG=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return gDesigner.isTouchEnabled()?c.TITLE_DISABLE:c.TITLE},c.prototype.getGroup=function(){return"touch"},c.prototype.getCategory=function(){return r.CATEGORY_VIEW},c.prototype.isCheckable=function(){return!0},c.prototype.getIcon=function(){return gDesigner.isTouchEnabled()?"gravit-icon-touch-disable":null},c.prototype.execute=function(){gDesigner.setTouchEnabled(!gDesigner.isTouchEnabled())},c.prototype.getTooltipArea=function(){return o.TOOLTIP_AREA.MAIN_MENU.TRY_PRO_COMMON},c.prototype.getTooltipConfig=function(e){return e&&c.TOOLTIP_CONFIG[e]||null},c.prototype.isAvailable=function(){return!!s&&!gDesigner.getLicense().isGuest()&&gContainer.getRuntime()!==l.Runtime.IPad},c.prototype.statsValue=function(){return"".concat(c.ID,".").concat(gDesigner.isTouchEnabled()?"on":"off")},c.prototype.toString=function(){return"[Object GToggleTouchAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="account.open",a.TITLE=new i.GLocaleKey("GOpenAccountSettingsAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_ACCOUNT},a.prototype.getGroup=function(){return"account"},a.prototype.execute=function(){gDesigner.runDeepLink("account")},a.prototype.isVisible=function(){const e=gDesigner.getSyncUser();return!(e&&!e.canUpdateSelfAccountData())&&gDesigner.isTouchEnabled()},a.prototype.toString=function(){return"[Object GOpenAccountSettingsAction]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26);function a(){}i.GObject.inherit(a,r),a.ID="account.logout",a.TITLE=new i.GLocaleKey("GLogoutAction","title"),a.prototype.getId=function(){return a.ID},a.prototype.getTitle=function(){return a.TITLE},a.prototype.getCategory=function(){return o.CATEGORY_ACCOUNT},a.prototype.getGroup=function(){return"account"},a.prototype.execute=function(){return gDesigner.signout()},a.prototype.isVisible=function(){return gDesigner.isTouchEnabled()},a.prototype.toString=function(){return"[Object GLogoutAction]"},e.exports=a},function(e,t,n){"use strict";n(9),n(475),n(3);var i=n(1),o=n(26),r=n(18);const{gApi:a}=n(12);var s=n(306);function l(){}i.GObject.inherit(l,o),l.ID="toggle-pro-beta-license",l.prototype.getId=function(){return l.ID},l.prototype.getTitle=function(){const e=gDesigner.getLicense();return e.isPro()&&!e.isExpired()?"Switch to Basic License":"Switch to PRO License"},l.prototype.getCategory=function(){return r.CATEGORY_HELP},l.prototype.getGroup=function(){return"help"},l.prototype.isEnabled=function(){return gDesigner.isBeta()},l.prototype.isVisible=function(){return gDesigner.isBeta()},l.prototype.execute=async function(){const e=await a.getUserSettings(),t=e.flags&&e.flags.betaProLicense||!1;a.updateUserSettings({flags:{betaProLicense:!t}}).then(()=>{s.checkLicense()})},l.prototype.toString=function(){return"[Object GToggleProBETALicenseAction]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(9),n(3);var o=n(1),r=i(n(18)),a=i(n(144)),s=i(n(76)),l=i(n(94));function c(e){this._source=e}o.GObject.inherit(c,l.default),c.getId=function(e){return"file.import-image-from-ios-".concat(e)},c.Source={FILES:"files",PHOTOS:"photos"},c.prototype._source=null,c.prototype.getId=function(){return c.getId(this._source)},c.prototype.getTitle=function(){return new o.GLocaleKey("GImportImageFromIOSAction","text.ios-".concat(this._source))},c.prototype.getCategory=function(){return r.default.CATEGORY_FILE_IMPORT_IMAGE},c.prototype.getGroup=function(){return"import/image-type/".concat(this._source)},c.prototype.isAvailable=function(){return gContainer.getRuntime()===s.default.Runtime.IPad},c.prototype.isEnabled=function(e){if(!l.default.prototype.isEnabled.call(this))return!1;const t=gDesigner.getActiveDocument();return!!t&&(!!(e=e||t.getStorage()||gDesigner.getDefaultStorage())&&e.canPromptOpen()&&gDesigner.getApplicationManager().isImportResourcesEnabled())},c.prototype.execute=async function(e,t){const n=gDesigner.getActiveDocument();if(!n)return!1;e=e||n.getStorage()||gDesigner.getDefaultStorage();const i=a.default.FileTypes.filter(e=>e.import_image);try{let o;o=this._source===c.Source.FILES?await e.openFromFiles(i):await e.openFromPhotos(i),n.placeOrImport(o),t&&t()}catch(e){console.warn("GImportImageFromIOSAction.prototype.execute",e)}},c.prototype.toString=function(){return"[Object GImportImageFromIOSAction]"},e.exports=c},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26),a=n(1511),{IS_TRUNK:s,IS_LOCALHOST:l}=n(198);function c(){}i.GObject.inherit(c,r),c.ID="help.translationtool",c.TITLE=new i.GLocaleKey("GTranslationToolAction","title"),c.prototype._translationTool=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return i.GLocale.get(c.TITLE)+" [DEVELOPMENT]"},c.prototype.getCategory=function(){return o.CATEGORY_HELP},c.prototype.getGroup=function(){return"help"},c.prototype.isEnabled=function(){return!0},c.prototype.isVisible=function(){return!(!s&&!l)},c.prototype.execute=function(){this._translationTool||(this._translationTool=new a),this._translationTool.init()},c.prototype.toString=function(){return"[Object GTranslationToolAction]"},e.exports=c},function(e,t,n){"use strict";var i=n(17);n(58),n(45),n(84),n(9),n(19),n(24),n(111),n(90);var o=n(1),r=i(n(1226)),a=i(n(36)),s=n(32);function l(){}o.GObject.inherit(l,o.GObject),l.prototype._translationManager=null,l.prototype._hasUnappliedChanges=null,l.prototype._shouldDownloadMetaData=!1,l.prototype._currentLanguage=null,l.prototype._dialog=null,l.prototype.init=function(){this._translationManager=gDesigner.getTranslationManager(),this._dialog=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-translation-tool-dialog"}),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",this.close.bind(this)).appendTo(this._dialog),this._container=$("<div></div>").addClass("container").appendTo(this._dialog),this._panel=$("<div></div>").addClass("panel").appendTo(this._container),this._header=$("<div></div>").addClass("header").append($("<span/>").addClass("spin").addClass("loading-element").load("assets/icon/gravit-icon-rotate-right-flat.svg")).append($("<span></span>").text("Choose project")).append($("<select></select>").addClass("project-chooser").append(this._translationManager.getProjectsDescription().map(e=>$("<option></option>").text(e).attr("value",e))).on("change",e=>{this._translationManager.getProjectsDescription().includes(e.target.value)&&this._handleProjectChange(e.target.value)})).append($("<span></span>").text("Choose language")).append($("<select></select>").addClass("language-chooser").on("change",e=>{this._handleLanguageChange(e.target.value,e)})).append($("<span></span>").text("Available")).append($("<input></input>").attr("type","checkbox").addClass("check-available").on("change",e=>this._toggleCurrentLanguageAvailability(e.target.checked))).append($("<span></span>").text("Filter by temporary translations")).append($("<input></input>").attr("type","checkbox").addClass("check-temporary").on("change",e=>{const t=$(e.target).closest("input").is(":checked");this._body.find(".translations-container").toggleClass("filter-by-temporary",!!t)})).append($("<span></span>").addClass("only-export-empty-strings").text("Only export empty strings?")).append($("<input></input>").attr("type","checkbox").on("change",e=>this._onlyExportEmptyStrings=e.target.checked)).append($("<button></button>").addClass("button").text("Export CSV").click(this._exportAsCSV.bind(this))).append($("<button></button>").addClass("button").text("Import CSV").click(this._handleCSVImport.bind(this))).append($("<button></button>").addClass("button").text("New language").click(this._handleNewLanguage.bind(this))).appendTo(this._panel),$("<hr></hr>").appendTo(this._panel),this._body=$("<div></div>").addClass("body").appendTo(this._panel),this._footer=$("<div></div>").addClass("footer").append($("<button></button>").addClass("button").text("Apply").on("click",this._applyChanges.bind(this))).append($("<button></button>").addClass("button").text("Download").on("click",this._downloadMetaData.bind(this))).appendTo(this._panel),this._handleProjectChange(o.GTranslation.Projects.Designer),this.open()},l.prototype.open=function(){this._dialog.gDialog("open",!1)},l.prototype._handleProjectChange=function(e){this._translationManager.loadProjectTranslations(e),this._updateUIComponents(),this._handleLanguageChange(o.GLocaleLanguage.Default,!0)},l.prototype._applyChanges=function(){this._translationManager.applyTranslationPatch([this._translation]).then(()=>{this._hasUnappliedChanges=!1,this._shouldDownloadMetaData=!0})},l.prototype._toggleCurrentLanguageAvailability=function(e){this._translation.isAvailable=e,this._hasUnappliedChanges=!0},l.prototype._handleLanguageChange=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&parseInt(this._currentLanguage)===parseInt(e))return;const n=()=>{this._setLoadingStatus(!0),this._currentLanguage=parseInt(e),this._hasUnappliedChanges=!1;let t=this._translationManager.isConsideringExtension();this._header.find(".language-chooser").val(this._currentLanguage),this._body.find(".translations-container").remove();var n=$("<div></div>").addClass("translations-container").toggleClass("filter-by-temporary",this._header.find(".check-temporary").is(":checked"));this._translation=this._translationManager.getTranslationCopy(this._currentLanguage),this._header.find(".check-available").prop("checked",this._translation.isAvailable),n.append(Object.keys(this._translation.translations).map(e=>{let n=$("<div></div>").addClass("path");return n.append($("<span></span>").addClass("description").text(e)),n.append(Object.keys(this._translation.translations[e]).map(i=>{let o=$("<div></div>").addClass("row"),r=this._translation.translations[e][i];const a=this._translation.translationsTemporary&&this._translation.translationsTemporary[e]&&this._translation.translationsTemporary[e][i];let s=!(!a||r&&r.trim());if(r=s?a:r,$("<input></input>").addClass("key").attr("disabled",!0).attr("placeholder","Key").val(i).attr("data-title",r).appendTo(o),s&&o.append($("<span/>").addClass("gravit-icon-google-translate").attr("data-title","This is a temporary translation provided by Google Translator")),$("<input></input>").addClass("value").data({language:this._currentLanguage,path:e,key:i,originalValue:this._translation.translations[e][i]}).on("change",t=>{this._translation.translations[e][i]=t.target.value,this._hasUnappliedChanges=!0}).attr("placeholder","Translation").val(r).appendTo(o),t){var l=this._translation.translationsExtended&&this._translation.translationsExtended[e]&&this._translation.translationsExtended[e][i];const t=this._translation.translationsExtendedTemporary&&this._translation.translationsExtendedTemporary[e]&&this._translation.translationsExtendedTemporary[e][i];l=t||l,s=s||!!t,t&&o.append($("<span/>").addClass("gravit-icon-google-translate").attr("data-title","This is a temporary translation provided by Google Translator")),$("<input></input>").addClass("value").data({language:this._currentLanguage,path:e,key:i,extension:!0,originalValue:l}).on("change",t=>{t.target.value.trim()?(this._translation.translationsExtended||(this._translation.translationsExtended={}),this._translation.translationsExtended[e]||(this._translation.translationsExtended[e]={}),this._translation.translationsExtended[e][i]=t.target.value):delete this._translation.translationsExtended[e][i],this._hasUnappliedChanges=!0}).attr("placeholder","Extension").val(l||"").appendTo(o)}return s&&(o.addClass("temporary"),n.addClass("temporary")),o})),n})),n.appendTo(this._body),this._setLoadingStatus(!1)};this._hasUnappliedChanges?a.default.confirm("You have modified strings, you'll lose them if you don't apply them first, are you sure?",e=>{e?n():this._header.find(".language-chooser").val(this._currentLanguage)}):n()},l.prototype.close=function(){this._hasUnappliedChanges||this._shouldDownloadMetaData?this._shouldDownloadMetaData?a.default.confirm("You haven't downloaded the translations after applying changes, are you sure about closing?",e=>{e&&this._close()}):a.default.confirm("You have modified strings, are you sure about closing?",e=>{e&&this._close()}):this._close()},l.prototype._close=function(){this._hasUnappliedChanges=!1,this._currentLanguage=null,this._shouldDownloadMetaData=!1,this._dialog.gDialog("close",!1,0)},l.prototype._downloadMetaData=async function(){var e=async()=>{this._manageDownload("translations_".concat(this._translationManager.getActiveProject(),".json").toLowerCase(),await this._translationManager.getMetaData()),this._shouldDownloadMetaData=!1};this._hasUnappliedChanges?a.default.confirm("You have modified strings, do you want to download before applying your changes?",t=>{t&&e()}):e()},l.prototype._exportAsCSV=async function(){var e=Object.keys(o.GLocaleLanguage)[Object.values(o.GLocaleLanguage).indexOf(this._currentLanguage)];this._manageDownload("translations_".concat(this._translationManager.getActiveProject(),"_").concat(e,".csv").toLocaleLowerCase(),await this._translationManager.export(r.default.FormatTypes.CSV,this._currentLanguage,this._onlyExportEmptyStrings))},l.prototype._handleCSVImport=async function(){try{this._setLoadingStatus(!0),gDesigner.getDefaultStorage().openPrompt([{ext:"csv",mime:"text/csv"}],e=>{e&&e.read(e=>{var t=(0,s.decodeFromUTF8)(e);this._translationManager.import(t).then(()=>this._handleLanguageChange(this._currentLanguage,!0)).catch(e=>this._handleError(e))})},!1)}catch(e){this._handleError(e)}finally{this._setLoadingStatus(!1)}},l.prototype._manageDownload=function(e,t){var n=document.createElement("a");n.setAttribute("href",URL.createObjectURL(new Blob([t],{type:"text/plain"}))),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},l.prototype._handleError=function(e){"string"!=typeof e||a.default.alert(e)},l.prototype._setLoadingStatus=function(e){var t=this._header.find(".loading-element");e?t.addClass("visible"):t.removeClass("visible")},l.prototype._handleNewLanguage=function(){a.default.prompt("Please name the new language (English)!",e=>{e?a.default.prompt("Please inform the real name of the language!",t=>{a.default.prompt("Please inform the ISO Language Code!",n=>{this._translationManager.createNewLanguage(e,t,n).then(e=>{this._shouldDownloadMetaData=!0,this._updateUIComponents(),this._handleLanguageChange(e.keyValue)}).catch(e=>this._handleError(e))})}):a.default.alert("Invalid value ('".concat(e,"') for language!"))})},l.prototype._updateUIComponents=function(){this._header.find(".project-chooser").val(this._translationManager.getActiveProject());var e=this._header.find(".language-chooser");e.find("option").remove(),e.append(Object.keys(o.GLocaleLanguage).filter(e=>"Default"!==e).filter(e=>!!this._translationManager.getTranslationByKey(o.GLocaleLanguage[e])).map(e=>$("<option></option>").text(e).attr("value",o.GLocaleLanguage[e])))},e.exports=l},function(e,t,n){"use strict";n(3);var i=n(1);const o=n(18),r=n(26);var a=n(192),s=n(76);const{IS_TRUNK:l,IS_LOCALHOST:c,IS_BETA:d}=n(198);function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._serverName=e,this._isDefault=!!t}i.GObject.inherit(u,r),u.ID="help.switchwebcdr",u.TITLE=new i.GLocaleKey("GSwitchWebcdrAction","title"),u.prototype.getId=function(){return u.ID+"."+this._serverName},u.prototype.isCheckable=function(){return!0},u.prototype.isChecked=function(){let e=gDesigner.getSetting("webcdr_choice");return!!e&&e===this._serverName||!e&&this._isDefault},u.prototype.getTitle=function(){return this._serverName},u.prototype.getCategory=function(){return o.CATEGORY_HELP_SWITCHWEBCDR},u.prototype.getGroup=function(){return"help/switchwebcdr"},u.prototype.isEnabled=function(){return!0},u.prototype.isVisible=function(){return!!(l||d||c)},u.prototype.execute=function(){gDesigner.setSetting("webcdr_choice",this._serverName),this._reloadApp()},u.prototype._reloadApp=function(){gContainer.getRuntime()===s.Runtime.Browser||gContainer.getRuntime()===s.Runtime.PWA?location.reload():new a(i.GLocale.get(new i.GLocaleKey("GNewDocumentDialog","text.restart-app"))).open()},u.prototype.toString=function(){return"[Object GSwitchWebcdrAction]"},e.exports=u},function(e,t,n){"use strict";var i=n(17);n(28);var o=n(1),r=n(43),a=n(16),s=i(n(26)),l=i(n(18));class c extends s.default{constructor(e){super(),this._type=e,this._title=new o.GLocaleKey("GTogglePaintLayersVisibilityAction","title.".concat(this._type))}getId(){return"".concat(c.ID,".").concat(this._type)}getTitle(){return this._title}getCategory(){return l.default.CATEGORY_VIEW}getShortcut(){switch(this._type){case c.Type.Fill:return["F"];case c.Type.Border:return[a.GKey.Constant.SHIFT,"B"]}}isVisible(){return!1}isEnabled(){return!document.activeElement||!$(document.activeElement).is(":input")}_getSingleLevelSelection(e){let t=[];return e.forEach(e=>{if(e){const n=e.getChildren();e instanceof o.GLayer||t.push(e),Array.isArray(n)&&n.length>0&&(t=t.concat(this._getSingleLevelSelection(n)))}}),t}_getPaintLayers(e){const t=e&&e.hasMixin(o.GStylable)&&e.getPaintLayers();if(!t)return null;switch(this._type){case c.Type.Fill:return t.getFillLayers();case c.Type.Border:return t.getBorderLayers();default:return null}}_checkPaintLayersVisibility(e){let t=!1,n=!1;for(let i=0;e.length>i&&(!t||!n);i++){const o=e[i],r=this._getPaintLayers(o);if(Array.isArray(r))for(let e=0;r.length>e&&(!t||!n);e++){r[e].getProperty("_vs")?n=!0:t=!0}}return{hasHiddenPaintLayers:t,hasVisiblePaintLayers:n}}_setVisibilityPaintLayersState(e,t){const n=gDesigner.getActiveDocument(),i=n&&n.getScene();i&&r.GEditor.tryRunTransaction(i,()=>{e.forEach(e=>{e.beginUpdate();const n=this._getPaintLayers(e);Array.isArray(n)&&n.forEach(e=>{e.setProperty("_vs",t)}),e.endUpdate()})},o.GLocale.get(c.TITLE))}execute(){const e=gDesigner.getActiveDocument(),t=e&&e.getScene(),n=e&&e.getEditor(),i=n&&n.getSelection();if(t){t.beginUpdate();try{if(Array.isArray(i)&&i.length>0){const e=this._getSingleLevelSelection(i),{hasHiddenPaintLayers:t,hasVisiblePaintLayers:n}=this._checkPaintLayersVisibility(e);if(!t&&!n)return;t&&n?this._setVisibilityPaintLayersState(e,!1):this._setVisibilityPaintLayersState(e,t)}}finally{t.endUpdate()}}}toString(){return"[Object GTogglePaintLayersVisibilityAction]"}}c.ID="view.toggle-paint-layers-visibility",c.Type={Fill:"fill",Border:"border"},e.exports=c},function(e,t,n){"use strict";n(3);const{GObject:i,GLocaleKey:o}=n(1),r=n(26),a=n(18),s=n(1515),{IS_TRUNK:l}=n(198);function c(){}i.inherit(c,r),c.ID="help.shortcuts",c.TITLE=new o("GShowShortcutsAction","title"),c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getCategory=function(){return a.CATEGORY_HELP},c.prototype.getGroup=function(){return"help"},c.prototype.isAvailable=function(){return!!l},c.prototype.execute=function(){(new s).open()},c.prototype.toString=function(){return"[Object GShowShortcutsAction]"},e.exports=c},function(e,t,n){"use strict";n(28);var i=n(1),o=n(16);e.exports=class{constructor(){this._dialog=this._createDialog(),this._dialog.append(this._createCloseButton(),this._getTitle(),this._getContent())}open(){this._dialog.gDialog("open",!0)}close(){this._dialog.gDialog("close")}_getTitle(){const e=i.GLocale.getValue("GShortcutsDialog","text.title");return $("<div />").addClass("title").text(e)}_getContent(){const e=$("<table/>"),t=$("<tbody/>").appendTo(e);return gDesigner.getActions().forEach(e=>{const n=e.getShortcut();if(n){const r=o.GKey.shortcutToString(n);if(!r)return;const a=i.GLocale.get(e.getTitle());this._createTableRow(a,r).appendTo(t)}}),gravit.tools.forEach(e=>{if(e.key){const n=o.GKey.shortcutToString(e.key);if(!n)return;const r=i.GLocale.get(e.richTooltipConfig.getConfig().title);this._createTableRow(r,n).appendTo(t)}}),$("<div/>").addClass("wrapper").append(e)}_createDialog(){return $("<div/>").gDialog({releaseOnClose:!0,className:"g-shortcuts-dialog"})}_createCloseButton(){const e=$("<span />").addClass("gravit-icon-close");return $("<div />").addClass("g-btn-close").append(e).on("click",this.close.bind(this))}_createTableRow(e,t){const n=$("<tr/>");return $("<td/>").text(e).appendTo(n),$("<td/>").text(t).appendTo(n),n}}},function(e,t,n){"use strict";var i=n(17),o=n(16),r=n(1),a=i(n(18)),s=n(193);const l=n(26);class c extends l{constructor(e){super(),this._type=e,this._title=new r.GLocaleKey("GEyeDropperAction","title.".concat(e)),this.pageX=0,this.pageY=0}getId(){return"".concat(c.ID,".").concat(this._type)}getTitle(){return this._title}getCategory(){return a.default.CATEGORY_EDIT}getShortcut(){switch(this._type){case c.Type.Fill:return[o.GKey.Constant.META,o.GKey.Constant.OPTION,"C"];case c.Type.Border:return[o.GKey.Constant.SHIFT,o.GKey.Constant.META,o.GKey.Constant.OPTION,"C"];default:return null}}getAdditionalShortcuts(){switch(this._type){case c.Type.Fill:return[["I"]];default:return null}}isVisible(){return!1}execute(){const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=t&&t.getSelection(),i=gDesigner.getRightSidebars().getSidebar(s.SidebarsIds.GInspectorSidebar),o=n&&n.filter(e=>e&&e.hasMixin(r.GStylable));if(!(o&&o.length>0))return;const{pageX:a,pageY:l}=this._getLastCursorPoint();switch(this._type){case c.Type.Fill:o.find(e=>e.hasStyleFill()&&!(e instanceof r.GText))?i.openFillEyeDropper(a,l):o.find(e=>e instanceof r.GText)?i.openTextColorEyeDropper(a,l):o.find(e=>!e.hasStyleBorder())||i.openBorderEyeDropper(a,l);break;case c.Type.Border:o.find(e=>!e.hasStyleBorder())||i.openBorderEyeDropper(a,l)}}_getLastCursorPoint(){const e=gDesigner.getCursorManager().getLastCursorPoint();return{pageX:e&&e.getX()||0,pageY:e&&e.getY()||0}}toString(){return"[Object GEyeDropperAction]"}}c.ID="edit.eyedropper",c.Type={Border:"border",Fill:"fill",Text:"text"},e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=n(43),s=i(n(18)),l=i(n(26));class c extends l.default{constructor(){super(),this._lastIsCheckedValue=!0}getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return s.default.CATEGORY_VIEW_CANVAS}isCheckable(){return!0}isEnabled(){return!!this._getSelection()}isChecked(){const e=this._getSelection();if(!e)return this._lastIsCheckedValue;const t=!!e.find(e=>!a.GElementEditor.getEditor(e).hasFlag(a.GBaseEditor.Flag.HideEditor));return this._lastIsCheckedValue=t,t}getShortcut(){return[r.GKey.Constant.SHIFT,r.GKey.Constant.META,"X"]}execute(){const e=this._getEditor();if(e){this.isChecked()?e.hideSelection():e.resetHideSelection()}}_getEditor(){const e=gDesigner.getActiveDocument();return e&&e.getEditor()}_getSelection(){const e=this._getEditor(),t=e&&e.getSelection();return t&&t.length>0?t:null}toString(){return"[Object GShowSelectionHandlesAction]"}}c.ID="view.canvas.show-selection-handles",c.TITLE=new o.GLocaleKey("GShowSelectionHandlesAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17);n(28);var o=n(1),r=n(43),a=n(16),s=i(n(26)),l=i(n(18));class c extends s.default{constructor(){super(),this._keyUpHandler=this._keyUp.bind(this),this._opacityLevel=null,this._timeoutID=null,this._currentNumber=""}getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return l.default.CATEGORY_EDIT}isVisible(){return!1}getAdditionalShortcuts(){return[a.GKey.Constant.Digit0,a.GKey.Constant.Digit1,a.GKey.Constant.Digit2,a.GKey.Constant.Digit3,a.GKey.Constant.Digit4,a.GKey.Constant.Digit5,a.GKey.Constant.Digit6,a.GKey.Constant.Digit7,a.GKey.Constant.Digit8,a.GKey.Constant.Digit9].map(e=>[a.GKey.Constant.SHIFT,e])}execute(){const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=e&&e.getScene(),i=t&&t.getSelection();n&&r.GEditor.tryRunTransaction(n,()=>{i.forEach(e=>{e.hasMixin(o.GStylable)&&e.setProperty("_stop",this._opacityLevel)})},o.GLocale.get(c.TITLE))}executeFromShortcut(){this._reset(),$(document).on("keyup",this._keyUpHandler)}_keyUp(e){let{code:t}=e;a.GKey.translateCode(t)!==a.GKey.Constant.SHIFT&&(this._currentNumber+=a.GKey.translateCode(t)||"",this._timeoutID=setTimeout(()=>{this._reset();const e=o.GUtil.parseNumber(this._currentNumber);this._currentNumber="","number"!=typeof e||isNaN(e)||(this._opacityLevel=this._getOpacityLevel(e),this.execute.apply(this,arguments))},s.default.SHORTCUT_DELAY))}_reset(){$(document).off("keyup",this._keyUpHandler),this._timeoutID&&clearTimeout(this._timeoutID)}_getOpacityLevel(e){return 0===e?1:e<10?e/10:e<100?e/100:1}toString(){return"[Object GChangeOpacityAction]"}}c.ID="edit.change-opacity",c.TITLE=new o.GLocaleKey("GChangeOpacityAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(18)),s=i(n(26)),l=n(193);class c extends s.default{static getId(e){return"".concat(c.ID,".").concat(e)}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.Type.General;super(),this._type=e,this._timeoutID=null,this._keyDownHandler=this._keyDown.bind(this)}getId(){return c.getId(this._type)}getTitle(){return c.TITLE}getCategory(){return a.default.CATEGORY_MODIFY}isVisible(){return!1}getShortcut(){switch(this._type){case c.Type.General:return[r.GKey.Constant.META,r.GKey.Constant.OPTION,r.GKey.Constant.A];default:return null}}isEnabled(){return gDesigner.getRightSidebars().getActiveSidebar()===l.SidebarsIds.GInspectorSidebar}executeFromShortcut(){this._type===c.Type.General?(this._reset(),document.addEventListener("keydown",this._keyDownHandler,!0),this._timeoutID=setTimeout(()=>{this._reset()},s.default.SHORTCUT_DELAY)):this.execute.apply(this,arguments)}execute(){const e=gDesigner.getRightSidebars().getSidebar(l.SidebarsIds.GInspectorSidebar),t=this._getNodeType();t&&e.setPathPointsNodeType(t)}_getNodeType(){switch(this._type){case c.Type.Straight:return"-";case c.Type.Mirrored:return o.GPathBase.AnchorPoint.Type.Mirror;case c.Type.Disconnected:return o.GPathBase.AnchorPoint.Type.Asymmetric;case c.Type.Asymmetric:return o.GPathBase.AnchorPoint.Type.Symmetric;case c.Type.Connector:return o.GPathBase.AnchorPoint.Type.Connector;default:return null}}_keyDown(e){let t;switch(e.preventDefault(),e.stopPropagation(),this._reset(),r.GKey.translateCode(e.code)){case r.GKey.Constant.S:t=c.Type.Straight;break;case r.GKey.Constant.M:t=c.Type.Mirrored;break;case r.GKey.Constant.D:t=c.Type.Disconnected;break;case r.GKey.Constant.C:t=c.Type.Connector;break;case r.GKey.Constant.A:t=c.Type.Asymmetric;break;default:t=null}t&&gDesigner.executeAction(c.getId(t))}_reset(){document.removeEventListener("keydown",this._keyDownHandler,!0),this._timeoutID&&clearTimeout(this._timeoutID)}toString(){return"[Object GChangeAnchorPointsJointTypeAction]"}}c.ID="modify.change-anchor-points-joint-type",c.TITLE=new o.GLocaleKey("GChangeAnchorPointsJointTypeAction","title"),c.Type={General:"general",Straight:"straight",Mirrored:"mirrored",Disconnected:"disconnected",Connector:"connector",Asymmetric:"asymmetric"},e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(26)),s=i(n(18));class l extends a.default{getId(){return l.ID}getTitle(){return l.TITLE}getCategory(){return s.default.CATEGORY_FILE}isVisible(){return!1}getShortcut(){return[r.GKey.Constant.OPTION,r.GKey.Constant.Q]}isEnabled(){const e=gDesigner.getActiveDocument(),t=e&&e.getActiveWindow(),n=gDesigner.getWindows();return!(!t||!n)}execute(){const e=gDesigner.getActiveDocument(),t=e&&e.getActiveWindow();gDesigner.getWindows().removeWindow(t)}toString(){return"[Object GCloseActiveWindowAction]"}}l.ID="file.close-active-window",l.TITLE=new o.GLocaleKey("GCloseActiveWindowAction","title"),e.exports=l},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(26)),s=i(n(18)),l=n(193);class c extends a.default{getId(){return c.ID}getTitle(){return c.TITLE}getCategory(){return s.default.CATEGORY_VIEW}getShortcut(){return[r.GKey.Constant.F6]}isVisible(){return!1}execute(){const e=gDesigner.getLeftSidebars(),t=e&&e.getSidebar(l.SidebarsIds.GOutlineSidebar);t&&t.toggleMultiPageMode()}toString(){return"[Object GToggleMultiPageModeAction]"}}c.ID="view.toggle-multi-page-mode",c.TITLE=new o.GLocaleKey("GToggleMultiPageModeAction","title"),e.exports=c},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(26)),s=i(n(18));class l extends a.default{constructor(e){super(),this._type=e,this._title=new o.GLocaleKey("GChangeActiveWindowAction","title.".concat(this._type))}getId(){return"".concat(l.ID,".").concat(this._type)}getTitle(){return this._title}getCategory(){return s.default.CATEGORY_VIEW}isVisible(){return!1}getShortcut(){const e=[r.GKey.Constant.OPTION];switch(this._type){case l.Type.Next:return e.concat(r.GKey.Constant.PERIOD);case l.Type.Previous:return e.concat(r.GKey.Constant.COMMA);default:return null}}isEnabled(){const e=gDesigner.getWindows(),t=e&&e.getWindows();return t&&t.length>1}execute(){if(this.isEnabled()){const e=gDesigner.getWindows(),t=this._getNextWindowAccordingToType(e);e.activateWindow(t)}}_getNextWindowAccordingToType(e){const t=e.getWindows(),n=e&&e.getActiveWindow(),i=t.findIndex(e=>e===n);switch(this._type){case l.Type.Next:return i===t.length-1?t[0]:t[i+1];case l.Type.Previous:return 0===i?t[t.length-1]:t[i-1];default:return null}}toString(){return"[Object GChangeActiveWindowAction]"}}l.ID="view.change-active-window",l.Type={Next:"next",Previous:"previous"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(28),n(19),n(24);var o=n(1),r=n(16),a=i(n(26)),s=i(n(18));class l extends a.default{getId(){return l.ID}getTitle(){return l.TITLE}getCategory(){return s.default.CATEGORY_MODIFY}isVisible(){return!1}getShortcut(){return[r.GKey.Constant.X]}isEnabled(){const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=t&&t.getSelection();return!!(n&&n.find(e=>e.hasMixin(o.GStylable)))}execute(){const e=gDesigner.getActiveDocument(),t=e&&e.getEditor(),n=t&&t.getSelection();if(n){t.beginTransaction();try{n.forEach(e=>{if(e.hasMixin(o.GStylable)){const t=e.getPaintLayers();if(t){const n=this._createPaintLayers(l.Type.Border,t),i=this._createPaintLayers(l.Type.Fill,t);n.forEach(t=>{this._setBorderAlignment(e,t)}),t.clearLayers(),n.concat(i).forEach(e=>{t.appendChild(e)})}}})}finally{t.commitTransaction(o.GLocale.get(this.getTitle()))}}}_createPaintLayers(e,t){const n=["_pt","_op","_vs","_bl"];switch(e){case l.Type.Fill:return t.getBorderLayers().map(e=>{const t=e.getProperties(n);return new o.GStylable.FillPaintLayer(...t)});case l.Type.Border:return t.getFillLayers().map(e=>{const t=e.getProperties(n);return new o.GStylable.BorderPaintLayer(...t)});default:throw Error("Not specified type given")}}_setBorderAlignment(e,t){e instanceof o.GText?t.setProperty("_ba",o.GStylable.BorderAlignment.Outside):e instanceof o.GShape?e instanceof o.GEllipse&&e.$etp===o.GEllipse.Type.Arc?t.setProperty("_ba",o.GStylable.BorderAlignment.Center):t.setProperty("_ba",o.GStylable.BorderAlignment.Inside):e instanceof o.GPath&&!e.$closed&&t.setProperty("_ba",o.GStylable.BorderAlignment.Center)}toString(){return"[Object GSwapPaintLayersAction]"}}l.ID="modify.swap-paint-layers",l.TITLE=new o.GLocaleKey("GSwapPaintLayersAction","title"),l.Type={Fill:"fill",Border:"border"},e.exports=l},function(e,t,n){"use strict";var i=n(17),o=n(1),r=n(16),a=i(n(26)),s=i(n(18)),l=n(193),c=i(n(1057));class d extends a.default{getId(){return d.ID}getTitle(){return d.TITLE}getCategory(){return s.default.CATEGORY_MODIFY}isVisible(){return!1}getShortcut(){return[r.GKey.Constant.META,r.GKey.Constant.M]}isEnabled(){return gDesigner.getApplicationManager().isEditingEnabled()}execute(){this._showOutlineSidebar();const e=gDesigner.getLeftSidebars();(e&&e.getSidebar(l.SidebarsIds.GOutlineSidebar)).insertLayer()}_showOutlineSidebar(){const e=gDesigner.getAction("".concat(c.default.ID,".").concat(l.SidebarsIds.GOutlineSidebar));e.isChecked()||e.execute()}toString(){return"[Object GCreateNewLayerAction]"}}d.ID="modify.create-new-layer",d.TITLE=new o.GLocaleKey("GCreateNewLayerAction","title"),e.exports=d},function(e,t,n){"use strict";n(3);var i=n(1),o=n(108);const r=n(118);function a(){this._items=[]}i.GObject.inherit(a,o),a.prototype._panel=null,a.prototype._document=null,a.prototype._items=null,a.prototype.init=function(e){this._panel=e,this._panel.addClass("frame-property-panel"),$("<div></div>").attr("major-item-only",!0).addClass("item-frame").gPropertyRow({columns:[{width:"auto",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("frm-checkbox").attr("type","checkbox").attr("data-item-property","frm").on("change",function(e){var t=$(e.target).is(":checked");gDesigner.stats("frameproperties_toggle_frame",t?"enable":"disable"),this._assignProperty("frm",t,t?i.GLocale.get(new i.GLocaleKey("GFrameProperties","text.switch-frame")):i.GLocale.get(new i.GLocaleKey("GFrameProperties","text.frame-off")))}.bind(this))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GFrameProperties","text.frame"))))}]}).appendTo(this._panel)},a.prototype.update=function(e,t){if(this._updateUI(),this._document&&(gDesigner.removeEventListener(r,this._settingChanged,this),this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._items=[],e){gDesigner.addEventListener(r,this._settingChanged,this);for(var n=0;n<t.length;++n){t[n]instanceof i.GLayer&&this._items.push(t[n])}if(this._items.length&&this._items.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0}return!1},a.prototype._updateUI=function(){gDesigner.isTouchEnabled()?this._panel.find(".frm-checkbox").gCheckboxSlider():this._panel.find(".frm-checkbox").gCheckboxSlider("unmount")},a.prototype._settingChanged=function(e){"touch"===e.key&&this._updateUI()},a.prototype._afterPropertiesChange=function(e){!e.temporary&&this._items.length>0&&this._items[0]===e.node&&this._updateProperties()},a.prototype._updateProperties=function(){var e=this._items[0];this._panel.find("[major-item-only]").css("display",""),this._panel.find('input[data-item-property="frm"]').prop("disabled",!1).prop("checked",!!e.getProperty("frm"))},a.prototype._assignProperty=function(e,t,n){if("frm"==e){var i=this._document.getEditor();i.beginTransaction();try{for(var o=0;o<this._items.length;++o){var r=this._items[o];r.setFrame&&r.setFrame(t)}}finally{i.commitTransaction(n)}}},a.prototype.toString=function(){return"[Object GFrameProperties]"},e.exports=a},function(e,t,n){"use strict";n(3);var i=n(1),o=n(108);function r(){this._items=[]}i.GObject.inherit(r,o),r.prototype._panel=null,r.prototype._document=null,r.prototype._items=null,r.prototype.init=function(e){this._panel=e,this._panel.addClass("group-frame-property-panel"),$("<div></div>").addClass("group-frame-row").attr("major-item-only",!0).gPropertyRow({columns:[{width:"auto",content:$("<select></select>").attr("data-item-property","frm").on("change",function(e){var t="1"==$(e.target).val();gDesigner.stats("groupframeproperties_toggle_frame",t?"enable":"disable"),this._assignProperty("frm",t,t?i.GLocale.get(new i.GLocaleKey("GGroupFrameProperties","text.switch-frame")):i.GLocale.get(new i.GLocaleKey("GGroupFrameProperties","text.switch-group")))}.bind(this)).append($("<option></option>").attr("value","0").text(i.GLocale.get(new i.GLocaleKey("GGroupFrameProperties","text.group")))).append($("<option></option>").attr("value","1").text(i.GLocale.get(new i.GLocaleKey("GGroupFrameProperties","text.frame"))))}]}).appendTo(this._panel)},r.prototype.update=function(e,t){if(this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._items=[],e){for(var n=0;n<t.length;++n){t[n]instanceof i.GGroup&&this._items.push(t[n])}if(this._items.length&&this._items.length===t.length)return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0}return!1},r.prototype._afterPropertiesChange=function(e){!e.temporary&&this._items.length>0&&this._items[0]===e.node&&this._updateProperties()},r.prototype._updateProperties=function(){var e=this._items[0];this._panel.find("[major-item-only]").css("display",""),this._panel.find('[data-item-property="frm"]').prop("disabled",!1).prop("value",e.getProperty("frm")?"1":"0")},r.prototype._assignProperty=function(e,t,n){if("frm"==e){var i=this._document.getEditor();i.beginTransaction();try{for(var o=0;o<this._items.length;++o){var r=this._items[o];r.setFrame&&r.setFrame(t)}}finally{i.commitTransaction(n)}}},r.prototype.toString=function(){return"[Object GGroupFrameProperties]"},e.exports=r},function(e,t,n){"use strict";n(3);var i=n(1),o=n(108);const r=n(118);function a(){this._items=[]}i.GObject.inherit(a,o),a.prototype._panel=null,a.prototype._document=null,a.prototype._items=null,a.prototype.init=function(e){this._panel=e,this._panel.addClass("item-property-panel"),$("<div></div>").attr("major-item-only",!0).gPropertyRow({columns:[{width:"auto",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("clk-checkbox").attr("type","checkbox").attr("data-item-property","clk").on("change",function(e){gDesigner.stats("itemproperties_click_through"),this._assignProperty("clk",$(e.target).is(":checked"))}.bind(this))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GItemProperties","text.click-through"))).addClass("clickElement"))}]}).appendTo(this._panel),$("<div></div>").attr("major-shape-only",!0).gPropertyRow({columns:[{width:"auto",content:$("<label></label>").addClass("g-checkbox-label").append($("<input>").addClass("scc-checkbox").attr("type","checkbox").attr("data-item-property","scc").on("change",function(e){gDesigner.stats("itemproperties_toggle_scale-with-content",$(e.target).is(":checked")?"enable":"disable"),this._assignProperty("scc",$(e.target).is(":checked"))}.bind(this))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GItemProperties","text.scale-with-content"))))}]}).appendTo(this._panel)},a.prototype.update=function(e,t){if(this._updateUI(),this._document&&(gDesigner.removeEventListener(r,this._settingChanged,this),this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._items=[],e){gDesigner.addEventListener(r,this._settingChanged,this);for(var n=0;n<t.length;++n)t[n]instanceof i.GItem&&this._items.push(t[n]);if(this._items.length&&this._items.length===t.length&&this._hasChildItem(this._items[0]))return this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0}return!1},a.prototype._updateUI=function(){gDesigner.isTouchEnabled()?(this._panel.find(".clk-checkbox").gCheckboxSlider(),this._panel.find(".scc-checkbox").gCheckboxSlider()):(this._panel.find(".clk-checkbox").gCheckboxSlider("unmount"),this._panel.find(".scc-checkbox").gCheckboxSlider("unmount"))},a.prototype._settingChanged=function(e){"touch"===e.key&&this._updateUI()},a.prototype._afterPropertiesChange=function(e){!e.temporary&&this._items.length>0&&this._items[0]===e.node&&this._updateProperties()},a.prototype._updateProperties=function(){var e=this._items[0];this._hasChildItem(e)?(this._panel.find("[major-item-only]").css("display",""),this._panel.find('input[data-item-property="clk"]').prop("disabled",!1).prop("checked",e.getProperty("clk")),e instanceof i.GShape&&!(e instanceof i.GImage&&e.getProperty("dblMode"))?(this._panel.find("[major-shape-only]").css("display",""),this._panel.find("[major-item-only]").addClass("item-click-through"),this._panel.find("[major-shape-only]").addClass("shape-scale-with-content"),this._panel.find('input[data-item-property="scc"]').prop("checked",e.getProperty("scc"))):(this._panel.find("[major-shape-only]").css("display","none"),this._panel.find("[major-item-only]").removeClass("item-click-through"),this._panel.find("[major-shape-only]").removeClass("shape-scale-with-content"))):(this._panel.find("[major-item-only]").css("display","none"),this._panel.find("[major-shape-only]").css("display","none"),this._panel.find("[major-item-only]").removeClass("item-click-through"),this._panel.find("[major-shape-only]").removeClass("shape-scale-with-content"))},a.prototype._assignProperty=function(e,t,n){if("clk"==e||"scc"==e){var o=this._document.getEditor();o.beginTransaction();try{for(var r=0;r<this._items.length;++r){var a=this._items[r];this._hasChildItem(a)&&("clk"==e||a instanceof i.GShape)&&this._items[r].setProperties([e],[t])}}finally{o.commitTransaction(n)}}},a.prototype._hasChildItem=function(e){return!!e.hasMixin(i.GNode.Container)&&!e.acceptChildren((function(e){return!(e instanceof i.GItem)}),!1,!1)},a.prototype.toString=function(){return"[Object GItemProperties]"},e.exports=a},function(e,t,n){"use strict";n(43);var i=n(1),o=(n(16),n(32)),r=(n(56),n(217)),a=(n(1040),n(765),n(143),n(787),n(36)),s=n(1039);function l(){this.initLayout(),this._container.gOverlay({releaseOnClose:!1,padding:!1,clazz:"pattern-chooser-overlay",customRight:-250}),this.initContextMenu()}i.GObject.inheritAndMix(l,s),l.prototype._advancedExpanded=!0,l.prototype._longPressTimer=null,l.prototype._islongPress=!1,l.prototype._contextMenu=null,l.prototype._currentLongPressTarget=null,l.prototype._createChoosers=function(e){return $("<div />").addClass("chooser").append($("<button />").attr("data-palette","colors").append($("<div />").addClass("mini-font").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.colors")).toUpperCase())).on("click",e)).append($("<button />").gPro({feature:"swatches"}).attr("data-palette","swatches").append($("<div />").addClass("mini-font").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.swatches")).toUpperCase())).on("click",o.watchDog.trap(e,null,e=>gDesigner.stats("patternchooser_nonprotriespro_palette","swatches"),"swatches"))).append($("<button />").attr("data-palette","used").append($("<div />").addClass("mini-font").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.in-use")).toUpperCase())).on("click",e)).append($("<button />").attr("data-palette","mixer").append($("<div />").addClass("mini-font").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.mixer")).toUpperCase())).on("click",e)).appendTo(this._palettes)},l.prototype.initContextMenu=function(e){this._contextMenu=new r(null,"g-pattern-chooser-context-menu");var t=(e,t,n)=>{gDesigner.stats("patternchooser_add_swatch",e);var o=new i.GSwatch(t,n),r=gDesigner.getSwatches(e);if(r){for(var s=0;s<r.length;++s)if(i.GUtil.equals(o,r[s],!0))return void a.alert(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.equal-swatch-alert")));r.push(o),gDesigner.setSwatches(e,r)}},n=e=>{var t=this._pattern.clone();return(t instanceof i.GRadialGradient||t instanceof i.GLinearGradient||t instanceof i.GAngularGradient)&&(t._stops[0].color=e),t},o=e=>{var i=$(this._currentLongPressTarget).closest(".swatch").data("swatch");if(i){var o=i.getProperty("_pt"),r=i.getProperty("_op");e=this._getSwatchScope(e,this._pattern);o=n(o),t(e,o,r)}else"INPUT"===this._currentLongPressTarget.nodeName&&t(this._getSwatchScope("document",this._pattern),this._pattern,this._opacity)};this._contextMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GPatternChooser","action.add-to-document-swatches")),()=>{o("document")}).setIcon("gravit-icon-add-swatches"),this._contextMenu.createAddItem(i.GLocale.get(new i.GLocaleKey("GPatternChooser","action.add-to-global-swatches")),()=>{o("global")}).setIcon("gravit-icon-add-swatches")},l.prototype.__getColorModeParams=function(){return{hexWidth:"25%",isTouchEnabled:!0,rgbWidth:"12%",cymkWidth:"12%"}},l.prototype._createPatternEditorFirstRow=function(e,t){return[{width:"80%",padding:!1,content:$("<button />").prepend($("<span></span>").addClass("gravit-icon-add-image")).append($("<div />").addClass("mini-font").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","action.choose-image"))+"...")).addClass("pattern-choose-image-button").on("click",e)},{width:"20%",content:$("<button />").addClass("paste-btn").addClass("g-flat").append($("<span></span>").addClass("gravit-icon-paste-color-choose")).on("click",t)}]},l.prototype._createPatternEditorMaskRow=function(e){return[{padding:!1,width:"50px",content:$("<label />").addClass("g-switch").append($("<input>").attr("id","texture-mask-touch").attr("type","checkbox").attr("data-property","texture_mask").prop("disabled",!0).on("change",e)).append($("<div />"))},{padding:!1,width:"auto",content:$("<label></label>").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","action.set-transparency-mask"))).addClass("set-transparency-mask").attr("for","texture-mask-touch")}]},l.prototype._createPatternEditorScaleRow=function(e,t,n){return[{padding:!1,width:"120px",content:$("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.scale")))},{width:"auto",content:$("<div/>").attr("data-property","texture_tile").gInputSlider({min:10,max:200}).on("input",e).on("change",t)},{width:"50px",content:$("<input>").attr("data-property","texture_tile").attr("type","text").on("change",n).gInputBox({minValue:10,maxValue:200,incrementValue:1,postfix:"%"})}]},l.prototype._createPatternEditorAdvancedRow=function(e){return[{width:"auto",content:$("<div />").addClass("advanced-option").append($("<b>"+i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.advanced"))+" </b>").addClass("title")).append($("<div />").addClass("gravit-icon-right expand-icon").attr("id","expand-icon")).on("click",function(){gDesigner.stats("patternchooser_click_advanced"),e.slideToggle(),this._advancedExpanded=!this._advancedExpanded,$("#expand-icon").removeClass("gravit-icon-right").removeClass("gravit-icon-down"),$("#expand-icon").addClass(this._advancedExpanded?"gravit-icon-right":"gravit-icon-down")}.bind(this))}]},l.prototype.__getCreatePatternEditorParams=function(){return{isTouchEnabled:!0,repeatWidth:"48%",ghostWidth:"4%",postionWith:"48%",sizeWidth:"48%",unitWidth:"8%"}},l.prototype._createMixerPalette=function(e){for(var t=$("<div />").attr("data-container","tints").addClass("tints").append($("<div/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.tints")).toUpperCase())).appendTo(e),n=1;n<=8;n+=1)this._createPaletteSwatch(i.GRGBColor.WHITE,t,!1,!1);var o=$("<div />").attr("data-container","shades").addClass("shades").append($("<div/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.shades")).toUpperCase())).appendTo(e);for(n=1;n<=8;n+=1)this._createPaletteSwatch(i.GRGBColor.WHITE,o,!1,!1);var r=$("<div />").attr("data-container","tones").addClass("tones").append($("<div/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.tones")).toUpperCase())).appendTo(e);for(n=1;n<=8;n+=1)this._createPaletteSwatch(i.GRGBColor.WHITE,r,!1,!1);var a=$("<div />").attr("data-container","mixes").addClass("mixes").append($("<div/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GPatternChooser","text.mixes")).toUpperCase())).appendTo(e);for(n=1;n<=8;n+=1)this._createPaletteSwatch(i.GRGBColor.WHITE,a,!1,!1);this._updateMixerPalette()},l.prototype.__getUpdateMixerPaletteParams=function(){return{maxCount:8}},l.prototype.__getCreateUsedPaletteParams=function(){return{isTouchEnabled:!0,maxCount:8}},l.prototype.__getUpdateSwatchesPaletteParams=function(){return{isTouchEnabled:!0}},l.prototype.__getUpdateGradientStopParams=function(){return{isTouchEnabled:!0}},l.prototype.__getCreatePaletteSwatchParamas=function(){return{isTouchEnabled:!0}},l.prototype.__getUpdateOpacityParams=function(){return{isTouchEnabled:!0}},l.prototype.__getUpdateColorParams=function(){return{isTouchEnabled:!0}},s.prototype._relayout=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._container.gOverlay("relayout",{preserveTop:e})},e.exports=l},function(e,t,n){"use strict";n(28),n(3);var i=n(1),o=n(108),r=(n(143),n(784)),a=n(510);const s=n(118);function l(){}i.GObject.inherit(l,o),l.prototype._panel=null,l.prototype._toolbar=null,l.prototype._document=null,l.prototype._symbols=null,l.prototype._disabledSiblingMaps=null,l.prototype.init=function(e,t){this._panel=e,this._toolbar=t,t.addClass("filled"),t.addClass("page-toolbar"),t.addClass("symbol-instance-toolbar"),e.addClass("symbol-instance-panel");var n=$("<select></select>").attr("data-property","symbol-instance").on("change",function(e){gDesigner.stats("symbolproperties_select_swap");var t=this._document.getScene(),n=this._document.getEditor(),o=function(e){var n=e.findParent((function(e){return e instanceof i.GPage}));n&&t.getActivePage()!==n&&t.setActivePage(n)};if(e.target.value&&"0"!==e.target.value&&"-1"!==e.target.value){var s=$(e.target).find('option[value="'+e.target.value+'"]').data("symbol");if(s){(n=this._document.getEditor()).beginTransaction();var l=s,c=this._symbols[0],d=c.getMasterSymbol(),u=c.getDisabledSiblings(),p=c.swapWith(l);if(this._disabledSiblingMaps||(this._disabledSiblingMaps={}),u){var g=d.getMultireferenceId()+"_"+p.getMultireferenceId();this._disabledSiblingMaps[g]=u}var h=this._disabledSiblingMaps[l.getMultireferenceId()+"_"+c.getMultireferenceId()];h&&p.desynchronize(h),p&&(o(p),n.updateSelection(!1,[p])),n.commitTransaction("Swap symbol instance")}}else if(e.target.value&&"0"===e.target.value){var f=this._symbols[0].getMasterSymbol();n.beginTransaction(),o(f),n.clearSelection(),n.updateSelection(!1,[f]),n.hasSelection()&&gDesigner.executeAction(a.ID,void 0,void 0,!0),n.commitTransaction("Select master symbol")}else e.target.value&&"-1"===e.target.value&&(gDesigner.executeAction(r.ID,void 0,void 0,!0),n.updateSelection(!1,n.getSelection().slice()))}.bind(this));$("<label></label>").text(i.GLocale.get(new i.GLocaleKey("GSymbolProperties","title"))).appendTo(t),$("<div></div>").addClass("chooseinstance-row").gPropertyRow({columns:[{clazz:"chooseinstance-title-col",content:$("<span>"+i.GLocale.get(new i.GLocaleKey("GSymbolProperties","text.chooseinstance"))+"</span>")},{clazz:"chooseinstance-select-col",content:n}]}).appendTo(e)},l.prototype.update=function(e,t){return this._updateUI(),this._document&&(gDesigner.removeEventListener(s,this._settingChanged,this),this._document=null),this._symbols=null,!(!e||(gDesigner.addEventListener(s,this._settingChanged,this),!(t=t.filter(e=>e instanceof i.GSymbol&&!e.isMaster()&&!!e.getMasterSymbol())).length))&&(this._symbols=t.slice(),this._document=e,this._updateProperties(),!0)},l.prototype._updateUI=function(){gDesigner.isTouchEnabled()?this._panel.find(".frm-checkbox").gCheckboxSlider():this._panel.find(".frm-checkbox").gCheckboxSlider("unmount")},l.prototype._settingChanged=function(e){"touch"===e.key&&this._updateUI()},l.prototype._updateProperties=function(){var e,t=this._document.getScene(),n=this._symbols[0],o=n.getMasterSymbol(),a=(t.isFixedSized(),t.getSymbols());this._symbols.length>1?e=this._symbols.length+" "+i.GLocale.get(new i.GLocaleKey("GSymbolProperties","text.instances")):(e=n.getProperty("name")||i.GLocale.get(new i.GLocaleKey("GSymbolProperties","title")),o.getProperty("name")?e+=" ("+i.GLocale.get(new i.GLocaleKey("GSymbolProperties","text.instanceof"))+" "+o.getProperty("name"):e+=" ("+i.GLocale.get(new i.GLocaleKey("GSymbolProperties","text.instance")),e+=")"),this._toolbar.find("label:first-child").text(e);var s,l=this._panel.find('select[data-property="symbol-instance"]').empty();gDesigner.canExecuteAction(r.ID)&&(l.append($('<option value="-1">('+i.GLocale.get(r.TITLE)+")</option>")),l.append(s=$('<option value="-2"></option>')));var c=0;!a.length&&o&&(a=[o]),a.length?l.removeClass("g-disabled").attr("disabled",null):l.addClass("g-disabled").attr("disabled","");var d=!1;a.forEach((function(e){var t=$("<option></option>").data("symbol",e).attr("value",++c).text(e.getProperty("name")).appendTo(l);o.getMultireferenceId()===e.getMultireferenceId()&&(t.prop("selected",!0),d=!0)})),d||s.prop("selected",!0),o&&o.getScene()&&l.append($('<option value="0">('+i.GLocale.get(new i.GLocaleKey("GSymbolProperties","text.master"))+")</option>"))},l.prototype.toString=function(){return"[Object GSymbolProperties]"},e.exports=l},function(e,t,n){"use strict";n(45),n(168),n(9),n(3);var i=n(1),o=n(322),r=n(56),a=n(108),s=n(401),l=n(398),c=n(77),d=n(144),u=n(106),p=n(78),g=n(118),h=(n(399),n(36)),f=n(232);const{FILE_FORMATS:m,CLOUD_SYNC_FEATURE:{NEW_LAYOUT:y}={}}=n(12);var v="."+m.find(e=>e.default).ext;function _(){}i.GObject.inherit(_,a),_.prototype._panel=null,_.prototype._document=null,_.prototype._scene=null,_.prototype.init=function(e,t){this._panel=e.addClass("scene-properties-panel"),t.addClass("scene-properties-toolbar"),y||gDesigner.addEventListener(p,this._synchronismUpdated,this);var n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n=this;if("dpi"===e)return $("<div></div>").append($("<div/>").attr("data-property",e).on("change",(function(){const t=parseInt($(this).gInputSelect("value"))||i.GLength.DPI;gDesigner.stats("sceneproperties_change_canvas-dpi",t),n._assignProperty(e,t,i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-canvas-dpi")))})).gInputSelect({list:[72,96,144,300],minValue:72,maxValue:300})).gRichTooltip(t);if("gx"===e||"gy"===e||"gaw"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){"gx"===e?gDesigner.stats("sceneproperties_change_rect-grid-settings","width"):"gy"===e?gDesigner.stats("sceneproperties_change_rect-grid-settings","height"):"gaw"===e&&gDesigner.stats("sceneproperties_change_axono-grid-settings","size");var t=n._document.getScene().stringToPoint($(this).gInputBox("value"));null!==t&&"number"==typeof t?n._assignProperty(e,t,i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-grid-settings"))):n._updateProperties()})).gInputBox();if("ga1"===e||"ga2"===e)return $("<input>").attr("type","text").attr("data-property",e).on("change",(function(){"ga1"===e?gDesigner.stats("sceneproperties_change_axono-grid-settings","angle1"):gDesigner.stats("sceneproperties_change_axono-grid-settings","angle2");var t=parseFloat($(this).gInputBox("value"));null!==t&&"number"==typeof t?(t=i.GMath.normalizeAngleDegrees(t),"ga1"==e&&(t=(t=t>=180?t-180:t)>=90?89:t),"ga2"==e&&(t=(t=(t=t>0?t-360:t)<=-180?t+180:t)<=-90?-89:t),t=i.GMath.toRadians(t),n._assignProperty(e,t,i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-grid-settings")))):n._updateProperties()})).gInputBox({postfix:"°"});if(0===e.indexOf("gm-")){var o="",r=e.substr("gm-".length);switch(r){case i.GScene.GridMode.Boxed:o=i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.on"));break;case i.GScene.GridMode.Axonometric:o=i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.isometric"));break;default:o=i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.off"))}return $("<label></label>").append($("<input>").addClass("grid-mode-radio").attr("type","radio").attr("data-property",e).on("change",(function(){gDesigner.stats("sceneproperties_change_grid-mode","box"===r?"on":"axo"===r?"isometric":"off"),n._assignProperty("gm",r||null,i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-grid-settings"))),n._updateUI()})).gRichTooltip(t)).append($("<span></span>").text(o))}if("cm"===e)return $("<select></select>").attr("data-property",e).gRichTooltip(t).on("change",(function(){const t=gDesigner.getActiveDocument(),o=t.getScene();if(!gDesigner.isEnabledProFeatures()&&0!=this.selectedIndex)return $(this).val(o.getProperty("cm")),void gDesigner.handlePROFeatureInterruption();const r=$(this).val();gDesigner.stats("sceneproperties_change_color-mode",r);var a=o.getActivePage().getChildren();!!a&&a.find(e=>!(e instanceof i.GAnnotationsList))&&h.alert(i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.reminder"))),gDesigner.setSetting("color_mode",r),n._assignProperty(e,r,i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-color-mode"))),t.setColorModeElms(a)}));if("ut"===e)return $("<select></select>").gUnit().attr("data-property",e).gRichTooltip(t).on("change",(function(){gDesigner.stats("sceneproperties_change_canvas-unit",$(this).val()),n._assignProperty(e,$(this).val(),i.GLocale.get(new i.GLocaleKey("GSceneProperties","action.change-canvas-unit")))}));if(0===e.indexOf("sync-")){o=i.GLocale.get(new i.GLocaleKey("GSceneProperties","text."+e.substring("sync-".length)));return $("<label></label>").append($("<input>").attr("type","radio").attr("data-property",e).on("change",(function(e){var t=-1!==$(e.target).data().property.indexOf("on");gDesigner.stats("sceneproperties_toggle_sync",t?"enable":"disable"),n._assignProperty("cfs",t)}))).append($("<span></span>").text(o))}if(0===e.indexOf("action-")){var a=e.substring("action-".length);return $("<button></button>").append($("<span></span>").text(i.GLocale.get(gDesigner.getAction(a).getTitle()))).on("click",function(e){gDesigner.canExecuteAction(a)&&gDesigner.executeAction(a)}.bind(this))}throw new Error("Unknown input property: "+e)}.bind(this);if($("<label></label>").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.document"))).appendTo(t),$("<div></div>").addClass("unit-row").gPropertyRow({columns:[{clazz:"unit-title-column",content:$("<span>"+i.GLocale.get(new i.GLocaleKey("GCommonNames","text.unit"))+"</span>")},{clazz:"unit-selector-column",content:n("ut",r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.unit-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.unit-tooltip-description")),middle:!1}))}]}).appendTo(e),$("<hr/>").appendTo(e),$("<div></div>").addClass("color-mode-row").gPropertyRow({columns:[{clazz:"color-mode-title-column",content:$("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.color-mode")))},{clazz:"color-mode-selector-column",content:n("cm",r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.color-mode-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.color-mode-tooltip-description")),middle:!1}))}]}).appendTo(e),$("<hr/>").appendTo(e),$("<div></div>").addClass("dpi-row").gPropertyRow({columns:[{clazz:"dpi-title-column",content:$("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.dpi")))},{clazz:"dpi-selector-column",content:n("dpi",r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.dpi-tooltip-title")),middle:!1}))}]}).appendTo(e),$("<hr/>").appendTo(e),$("<div></div>").addClass("grid-mode").gPropertyRow({columns:[{clazz:"grid-mode-title-column",content:$("<span>"+i.GLocale.get(new i.GLocaleKey("GCommonNames","text.grid"))+"</span>")},{clazz:"grid-mode-off-column",content:n("gm-",r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-description-off")),learnMore:"https://documentation.designer.io/design-aids/grid/"}))},{clazz:"grid-mode-box-column",content:n("gm-"+i.GScene.GridMode.Boxed,r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-description-on")),learnMore:"https://documentation.designer.io/design-aids/grid/"}))},{clazz:"grid-mode-axo-column",content:n("gm-"+i.GScene.GridMode.Axonometric,r.GRichTooltipConfig.from({title:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-title")),description:i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.grid-tooltip-description-isometric")),learnMore:"https://documentation.designer.io/design-aids/grid/"}))}]}).appendTo(e),$("<div></div>").addClass("grid-mode-type").attr("data-grid-mode",i.GScene.GridMode.Boxed).gPropertyRow({label:"",columns:[{width:"33.3%",label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.width")),content:n("gx")},{width:"33.3%",label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.height")),content:n("gy")}]}).appendTo(e),$("<div></div>").addClass("grid-mode-type").attr("data-grid-mode",i.GScene.GridMode.Axonometric).gPropertyRow({label:"",columns:[{width:"33.3%",label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.size")),content:n("gaw")},{width:"33.3%",label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.angle"))+" 1",content:n("ga1")},{width:"33.3%",label:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.angle"))+" 2",content:n("ga2")}]}).appendTo(e),$("<hr/>").appendTo(e),!y){let t=$("<div></div>").addClass("actions").append($("<button></button>").addClass(f["sync-button"]).text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","cloud.sync.enable"))).on("click",()=>{gDesigner.stats("sceneproperties_enable_cloud-sync"),this._enableCloudSync()}));$("<div></div>").attr("data-property","enable-cloud-sync").append($("<div></div>").addClass("cloud-sync-panel").append($("<div></div>").addClass("svg-cloud-icon svg-background-icon-theme")).append(t)).appendTo(e);const n=this._getWelcomeLink();n&&t.append(n),$("<div></div>").attr("data-property","switch-cloud-sync").addClass("cloud-sync-switch").append($("<div></div>").addClass("svg-cloud-icon svg-background-icon-theme")).append($("<div></div>").addClass("actions").append($("<label></label>").addClass("g-switch").css("width","28px").append($("<input>").attr("type","checkbox").on("change",e=>{gDesigner.stats("sceneproperties_toggle_cloud-sync",$(e.target).is(":checked")?"enable":"disable");var t=this._document.getScene();const n=$(e.target).is(":checked");t.setProperty("cfs",n),n&&this._document.chooseLatestDocument(t,(e,n)=>{if(e!==t||n){var i=new d(this._document.getStorageItem());i.setScene(e),gDesigner.replaceDocument(this._document,i)}else this._document.storeToCloud(e,async()=>{if(gDesigner.getDefaultStorage().canSave()){let e=!1,n=(await this._document.saveAnnotations(e),this._document.updateSaveOptionsLastModifiedDate({},t.getLastSavedTime()));this._document.store(null,this._updateProperties.bind(this),null,n)}else this._updateProperties()})},null,(e,t)=>t.lastModifiedDate().getTime()>e.lastModifiedDate().getTime())})).append($("<div></div>"))).append($("<span></span>").addClass("label").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","cloud.sync.label")))).append($("<span></span>").addClass("last-modified-date"))).appendTo(e),o.SCENEPROPERTIES.HAS_LOGO_UNDER_SYNC&&e.find(".svg-cloud-icon").load(f["cloud-logo"],()=>{})}},_.prototype._getWelcomeLink=function(){return $("<div></div>").addClass("more").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","cloud.sync.more")))).on("click",()=>{gDesigner.stats("sceneproperties_click_welcome-to-gravit-cloud-medium-com"),gContainer.openExternalLink(null,"https://medium.com/gravitdesigner/welcome-to-the-gravit-cloud-c30f84a7eb1f")})},_.prototype.update=function(e,t){return this._document&&(this._document.getScene().removeEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.removeEventListener(g,this._settingChanged),this._document=null),this._scene=null,!(!e||(1===t.length&&t[0]instanceof i.GPage&&(this._scene=t[0].getScene()),!this._scene))&&(this._document=e,this._document.getScene().addEventListener(i.GNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),gDesigner.addEventListener(g,this._settingChanged,this),this._updateColorMode(),this._updateProperties(),this._updateUI(),!0)},_.prototype._afterPropertiesChange=function(e){e.temporary||this._scene!==e.node||this._updateProperties()},_.prototype._updateUI=function(){let e=this._panel.find(".color-mode-row"),t=this._panel.find(".dpi-row");if(gDesigner.isTouchEnabled()){this._panel.find('input[data-property="gm-"]').is(":checked")?this._panel.find(".grid-mode").removeClass("mode-on"):this._panel.find(".grid-mode").addClass("mode-on"),e.insertAfter(t);let n=t.find(".dpi-selector-column .g-input-select");n.find(".dpi-text").length||$("<span/>").addClass("dpi-text").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.dpi"))).insertAfter(n.find("input")),this._panel.find(".unit-title-column span").text(i.GLocale.get(new i.GLocaleKey("GSceneProperties","text.unit-tooltip-title")))}else t.find(".dpi-selector-column .g-input-select .dpi-text").remove(),e.insertBefore(t.prev()),this._panel.find(".grid-mode").removeClass("mode-on"),this._panel.find(".unit-title-column span").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.unit")))},_.prototype._settingChanged=function(e){"decimals_num"===e.key?this._updateProperties():"touch"===e.key&&this._updateUI()},_.prototype._synchronismUpdated=function(e){e.document!==this._document||e.type!==p.Type.SynchronismUpdated||e.document.isSynchronizing()||this._updateProperties()},_.prototype._updateColorMode=function(){var e=this._panel.find('select[data-property="cm"]').empty(),t=[{value:i.GColor.ColorModes.RGB,pro:!1,text:"RGB"},{value:i.GColor.ColorModes.HSB,pro:!0,text:"HSB"},{value:i.GColor.ColorModes.CMYK,pro:!0,text:"CMYK"}];Array.prototype.forEach.call(t,t=>{var n=$("<option></option>").attr("value",t.value).text(t.text).appendTo(e);1!=t.pro||gDesigner.getLicense().isPro()||n.gPro()})},_.prototype._updateProperties=function(){var e=this._document.getScene();this._panel.find('[data-property="dpi"]').gInputSelect("value",this._scene.getProperty("dpi")||i.GLength.DPI);var t=this._document.hasCDR();this._panel.find('[data-property="dpi"]').find('[type="text"]').prop("disabled",t),this._panel.find('[data-property="dpi"]').find("button").prop("disabled",t),this._panel.find('[data-property="dpi"]').attr("data-title",t?i.GLocale.get(new i.GLocaleKey("GCommonNames","text.cant-change-cdr-limitations")):"");const n=gDesigner.getSetting("color_mode",i.GColor.ColorModes.RGB);n&&this._scene.setProperty("cm",n),this._panel.find('select[data-property="cm"]').val(n),this._panel.find('select[data-property="ut"]').val(this._scene.getProperty("ut")),this._panel.find('input[data-property="gx"]').gInputBox("value",e.pointToString(this._scene.getProperty("gx"),this._scene.getOptimalDecimalsCount()));this._panel.find('input[data-property="gy"]').gInputBox("value",e.pointToString(this._scene.getProperty("gy"),this._scene.getOptimalDecimalsCount())),this._panel.find('input[data-property="gaw"]').gInputBox("value",e.pointToString(this._scene.getProperty("gaw"),this._scene.getOptimalDecimalsCount())),this._panel.find('[type="text"][data-property="ga1"]').gInputBox("value",i.GUtil.formatNumber(i.GMath.toDegrees(this._scene.getProperty("ga1")),1)),this._panel.find('[type="text"][data-property="ga2"]').gInputBox("value",i.GUtil.formatNumber(i.GMath.toDegrees(this._scene.getProperty("ga2")),1));var o=this._scene.getProperty("gm");if(this._panel.find('[data-property^="gm"]').each((function(e,t){var n=$(t),i=n.attr("data-property").substr("gm-".length);n.prop("checked",!i&&!o||i===o)})),!y){var r=this._document.isCloudFile()?!this._document.getScene().getProperty("cid"):!this._document.hasCloudReference(),a=!r&&(this._document.isCloudFile()||this._document.hasCloudReference());this._panel.find('[data-property="enable-cloud-sync"]').css("display",r?"":"none").find("button").prop("disabled",this._document.getStatus()===c.Loading),this._panel.find('[data-property="switch-cloud-sync"]').css("display",a?"":"none").find("input").prop("checked",this._document.getScene()&&this._document.getScene().isCloudSynchronization()||this._document.isCloudFile()).prop("disabled",this._document.isCloudFile());var s=function(e){if(0===e.getTime())return null;var t=e.getHours(),n=e.getMinutes(),i=(t=(t%=12)||12)+":"+(n=n<10?"0"+n:n);return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()+"  "+i}(this._document.getScene().lastModifiedDate());this._panel.find('[data-property="switch-cloud-sync"]').find(".last-modified-date").text(s||"").css("display",s?"":"none")}this._panel.find("[data-grid-mode]").each((function(e,t){var n=$(t),i=n.attr("data-grid-mode");n.css("display",!i&&!o||i===o?"":"none")}))},_.prototype._assignProperty=function(e,t,n){this._assignProperties([e],[t],n)},_.prototype._assignProperties=function(e,t,n){var i=this._document.getEditor();i.beginTransaction();try{this._scene.setProperties(e,t)}finally{i.commitTransaction(n)}},_.prototype._enableCloudSync=function(){var e=()=>{var e=this._document;gDesigner.getDefaultStorage().canSave()?this._document.isNew()?u.createFile(e,t=>{e.getScene().setCloudSynchronization(t.id),gDesigner.executeAction(l.ID+v,[null,e,()=>{u.renameFile(t,e.getTitle(),()=>{e.storeToCloud(e.getScene(),this._updateProperties.bind(this))})}],void 0,!0)}):this._document.isCloudFile()?gDesigner.executeAction(l.ID+v,void 0,(void 0).true):this._document.hasCloudReference()?console.warn("Enable Sync for referenced file"):u.createFile(e,t=>{e.getScene().setCloudSynchronization(t.id),e.storeToCloud(e.getScene(),()=>{e.store()})}):this._document.isNew()?gDesigner.executeAction(s.ID+".save-as",[this._document,t=>{t===c.Loaded&&gDesigner.removeDocument(e,null,!0)}],void 0,!0):this._document.isCloudFile()?gDesigner.executeAction(l.ID+v,void 0,void 0,!0):this._document.hasCloudReference()?console.warn("Enable Sync for referenced file"):gDesigner.executeAction(s.ID+".save-as",[this._document,t=>{t===c.Loaded&&gDesigner.removeDocument(e,null,!0)}],void 0,!0)};gDesigner.getUser().then(t=>{t?e():u.performLogin().then(t=>{t&&e()})})},_.prototype.toString=function(){return"[Object GSceneProperties]"},e.exports=_},function(e,t,n){"use strict";n(168),n(774),n(45),n(3);var i=n(43),o=n(1),r=n(56),a=n(108),s=(n(143),n(118));n(1050);function l(){this._elements=[]}o.GObject.inherit(l,a),l.prototype._panel=null,l.prototype._copiesAndApply=null,l.prototype._copiesAndApplyTouch=null,l.prototype._document=null,l.prototype._elements=null,l.prototype.isGroup=function(e){return!1},l.prototype._scaleKeepRatio=!1,l.prototype._preserveScaleX=100,l.prototype._preserveScaleY=100,l.prototype.init=function(e,t){t.addClass("advanced-transform-toolbar"),this._panel=e.addClass("advanced-transform-properties");var n=this;this._advancedTransformPanel=$("<div></div>").css("width","180px").gOverlay({releaseOnClose:!1,clazz:"g-overlay-advanced-transform"}),$("<div></div>").gPropertyRow({columns:[{width:"auto",content:$("<label></label>").append($("<input />").attr("type","checkbox").attr("data-property","_bs").prop("checked",!0).on("change",(function(){gDesigner.stats("transformproperties_toggle_autoscale-borders",$(this).prop("checked")?"enabled":"disabled"),n._setBorderScale($(this).prop("checked"))}))).append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GBorderPaintLayerProperties","text.autoscale-borders"))))}]}).appendTo(this._advancedTransformPanel),$("<div></div>").gPropertyRow({columns:[{width:"auto",content:$("<label></label>").append($("<input />").attr("type","checkbox").attr("data-property","esc").prop("checked",!0).on("change",(function(){gDesigner.stats("transformproperties_toggle_autoscale-corners",$(this).prop("checked")?"enabled":"disabled"),n._setCornersScale($(this).prop("checked"))}))).append($("<span></span>").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","text.autoscale-corners"))))}]}).appendTo(this._advancedTransformPanel),$("<label></label>").text(o.GLocale.get(new o.GLocaleKey("GTransformProperties","title"))).appendTo(t),$("<button></button>").attr("data-action","stroke-settings").attr("data-title",o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.advanced-transform-settings"))).append($("<span></span>").addClass("gravit-icon-settings")).on("click",function(e){gDesigner.stats("transformproperties_open_advanced"),this._advancedTransformPanel.gOverlay("open",$(e.target).closest("button"))}.bind(this)).appendTo(t);const i=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.move-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.move-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#moving-objects"}),a=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.scale-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.scale-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#scaling-objects"}),s=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.rotate-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.rotate-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#rotating-objects"}),l=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.rotate-axis-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.rotate-axis-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#rotating-objects"}),c=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.skew-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.skew-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#skewing-objects"}),d=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.copies-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.copies-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/basics/transform-panel/#transform-and-copy-objects"}),u=r.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.transdorm-origin-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.transdorm-origin-tooltip-description")),learnMore:"https://documentation.designer.io/basics/transform-panel/#reference-point"});$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","action.move")),columns:[{width:"44%",content:$("<div/>").append($("<input/>").on("keydown",this._confirmEvent.bind(this)).on("change",e=>gDesigner.stats("transformproperties_change_move-x")).attr({type:"text","data-property":"move-x"}).gInputBox().gInputBox("value","0")).gInputLabel({label:"x"}).gRichTooltip(i)},{width:"12%"},{width:"44%",content:$("<div/>").append($("<input/>").on("keydown",this._confirmEvent.bind(this)).on("change",e=>gDesigner.stats("transformproperties_change_move-y")).attr({type:"text","data-property":"move-y"}).gInputBox().gInputBox("value","0")).gInputLabel({label:"y"}).gRichTooltip(i)}]}).appendTo(this._panel),$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.scale")),columns:[{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"scale-x"}).on("change",e=>{gDesigner.stats("transformproperties_change_scale-x");var t=parseFloat($(e.target).gInputBox("value"))||100;if(this._scaleKeepRatio){var n=t/this._preserveScaleX,i=this._panel.find('[data-property="scale-y"]'),o=parseFloat(i.gInputBox("value"))||100;o*=n,i.gInputBox("value",parseFloat(o).toFixed(1))}this._preserveScaleX=t}).gInputBox({postfix:"%"}).gInputBox("value","100")).gInputLabel({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","property-w"),"w")}).gRichTooltip(a)},{width:"12%",content:$("<span></span>").addClass("gravit-icon-unlinked transform-scale-link").css("text-align","center").css("cursor","pointer").on("click",(function(e){var t=$(this);"yes"===t.attr("data-ratio")?(t.attr("data-ratio","no").attr("class","gravit-icon-unlinked transform-scale-link"),n._scaleKeepRatio=!1):(t.attr("data-ratio","yes").attr("class","gravit-icon-linked transform-scale-link"),n._scaleKeepRatio=!0)})).attr("data-title",o.GLocale.get(new o.GLocaleKey("GDimensionProperties","action.keep-ratio"))).attr("data-ratio","no")},{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"scale-y"}).on("change",e=>{gDesigner.stats("transformproperties_change_scale-y");var t=parseFloat($(e.target).gInputBox("value"))||100;if(this._scaleKeepRatio){var n=t/this._preserveScaleY,i=this._panel.find('[data-property="scale-x"]'),o=parseFloat(i.gInputBox("value"))||100;o*=n,i.gInputBox("value",parseFloat(o).toFixed(1))}this._preserveScaleY=t}).gInputBox({postfix:"%"}).gInputBox("value","100")).gInputLabel({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","property-h"),"h")}).gRichTooltip(a)}]}).appendTo(this._panel),$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GCommonNames","action.rotate")),columns:[{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"rotate"}).on("change",e=>gDesigner.stats("transformproperties_change_rotate-up")).gInputBox({postfix:"°"}).gInputBox("value","0")).gInputLabel({label:"&#x2191;"}).gRichTooltip(s)},{width:"12%"},{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"reflect"}).on("change",e=>gDesigner.stats("transformproperties_change_rotate-down")).gInputBox({postfix:"°"}).gInputBox("value","0")).gInputLabel({label:"&#x2193;"}).gRichTooltip(l)}]}).appendTo(this._panel),$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.skew")),columns:[{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"skew-x"}).on("change",e=>gDesigner.stats("transformproperties_change_skew-x")).gInputBox({postfix:"°"}).gInputBox("value","0")).gInputLabel({label:"X"}).gRichTooltip(c)},{width:"12%"},{width:"44%",content:$("<div/>").append($("<input/>").attr({type:"text","data-property":"skew-y"}).on("change",e=>gDesigner.stats("transformproperties_change_skew-y")).gInputBox({postfix:"°"}).gInputBox("value","0")).gInputLabel({label:"Y"}).gRichTooltip(c)}]}).appendTo(this._panel),$("<hr/>").appendTo(this._panel),this._copiesAndApply=$("<div/>").addClass("copies-apply").appendTo(this._panel),this._copiesAndApplyTouch=$("<div/>").addClass("copies-apply-touch").appendTo(this._panel);(e=>{$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.copies")),columns:[{width:"44%",content:$("<input/>").on("change",e=>gDesigner.stats("transformproperties_change_copies")).attr({type:"text","data-property":"copies"}).gInputBox().gInputBox("value","0").gRichTooltip(d)},{width:"12%"},{width:"44%",html:$("<div/>").css("width","100%").css("display","flex").css("justify-content","center").append($("<div></div>").attr("data-property","pivot").css("align-self","center").gPivot().gPivot("value",o.GRect.Side.CENTER)).gRichTooltip(u)}]}).appendTo(e),$("<div></div>").gPropertyRow({label:"",columns:[{width:"100%",content:$("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GCommonNames","action.apply"))).addClass("transform-button").css("margin-top","5px").on("click",this._applyTransformation.bind(this))}]}).appendTo(e)})(this._copiesAndApply),(e=>{var t=$("<div/>").addClass("left");$("<div></div>").gPropertyRow({label:o.GLocale.get(new o.GLocaleKey("GTransformProperties","text.copies")),columns:[{width:"100px",content:$("<input/>").on("change",e=>gDesigner.stats("transformproperties_change_copies")).attr({type:"text","data-property":"copies"}).gInputBox().gInputBox("value","0").gRichTooltip(d)}]}).appendTo(t),$("<div></div>").addClass("transform-apply").gPropertyRow({columns:[{width:"100%",content:$("<button></button>").text(o.GLocale.get(new o.GLocaleKey("GDimensionProperties","text.transform-apply"))).addClass("transform-button").on("click",this._applyTransformation.bind(this))}]}).appendTo(t),t.appendTo(e),$("<div></div>").addClass("right").append($("<div/>").attr("data-property","pivot").gPivot().gPivot("value",o.GRect.Side.CENTER)).appendTo(e)})(this._copiesAndApplyTouch)},l.prototype.isAvailable=function(e){return!0===e},l.prototype._enableTouchModal=function(e){e?(this._copiesAndApplyTouch.css("display","block"),this._copiesAndApply.css("display","none")):(this._copiesAndApplyTouch.css("display","none"),this._copiesAndApply.css("display","block"))},l.prototype.update=function(e,t){if(this._document&&(gDesigner.removeEventListener(s,this._settingChanged),this._document=null),this._enableTouchModal(gDesigner.isTouchEnabled()),this._elements=[],e){for(var n=0;n<t.length;++n)!t[n].hasMixin(o.GElement.Transform)||t[n]instanceof o.GPage||this._elements.push(t[n]);if(this._elements.length&&this._elements.length===t.length)return this._document=e,gDesigner.addEventListener(s,this._settingChanged,this),this._setBorderScale(this._getOwnBorderScale()),this._setCornersScale(this._getOwnCornersScale()),!0}return!1},l.prototype._confirmEvent=function(e){13===e.keyCode&&this._updateDisplayValues()},l.prototype._settingChanged=function(e){"decimals_num"===e.key&&this._updateDisplayValues()},l.prototype._updateDisplayValues=function(){this._document.getScene();var e=this._panel.find('[data-property="move-x"]'),t=parseFloat(e.gInputBox("value"));t=isNaN(t)||t<=0||!t?0:t,e.gInputBox("value",o.GUtil.formatNumber(t,this._document.getScene().getOptimalDecimalsCount())),e=this._panel.find('[data-property="move-y"]'),t=parseFloat(e.gInputBox("value")),t=isNaN(t)||t<=0||!t?0:t,e.gInputBox("value",o.GUtil.formatNumber(t,this._document.getScene().getOptimalDecimalsCount()))},l.prototype._applyTransformation=function(){gDesigner.stats("transformproperties_apply_transformation");var e=this._document.getScene(),t=gDesigner.isTouchEnabled()?this._copiesAndApplyTouch:this._copiesAndApply,n=parseInt(t.find('[data-property="copies"]').gInputBox("value")),r=t.find('[data-property="pivot"]').gPivot("value"),a=e.stringToPoint(this._panel.find('[data-property="move-x"]').gInputBox("value"))||0,s=e.stringToPoint(this._panel.find('[data-property="move-y"]').gInputBox("value"))||0,l=parseFloat(this._panel.find('[data-property="scale-x"]').gInputBox("value"))/100||1,c=parseFloat(this._panel.find('[data-property="scale-y"]').gInputBox("value"))/100||1,d=o.GMath.toRadians(parseFloat(this._panel.find('[data-property="rotate"]').gInputBox("value")))||0,u=o.GMath.toRadians(parseFloat(this._panel.find('[data-property="skew-x"]').gInputBox("value")))||0,p=o.GMath.toRadians(parseFloat(this._panel.find('[data-property="skew-y"]').gInputBox("value")))||0,g=parseFloat(parseFloat(this._panel.find('[data-property="reflect"]').gInputBox("value")))||0;g=0!==g?o.GMath.toRadians(-g):g;var h=function(e,t){var n=i.GElementEditor.openEditor(e);n?(n._setTransform(t),n.applyTransform(e,!0,null,null)):e.transform(e,!0)};function f(e,t,n){t.beginUpdate();try{if((a||s)&&h(t,new o.GTransform(1,0,0,1,a*e,s*e)),1===l&&1===c||h(t,(new o.GTransform).translated(-n.getX(),-n.getY()).scaled(l+(l-1)*(e-1),c+(c-1)*(e-1)).translated(n.getX(),n.getY())),0!==d&&h(t,(new o.GTransform).translated(-n.getX(),-n.getY()).rotated(d*e).translated(n.getX(),n.getY())),(0!==u||0!==p)&&u>-o.GMath.PIHALF&&p>-o.GMath.PIHALF&&u<o.GMath.PIHALF&&p<o.GMath.PIHALF&&h(t,(new o.GTransform).translated(-n.getX(),-n.getY()).skewed(u*e,p*e).translated(n.getX(),n.getY())),0!==g){var i=Math.cos(g),r=Math.sin(g);e%2&&h(t,(new o.GTransform).translated(-n.getX(),-n.getY()).multiplied(new o.GTransform(i,-r,r,i,0,0)).multiplied(new o.GTransform(1,0,0,-1,0,0)).multiplied(new o.GTransform(i,r,-r,i,0,0)).translated(n.getX(),n.getY()))}}finally{t.endUpdate()}}i.GEditor.tryRunTransaction(e,function(){for(var e=[],t=null,i=null,a=0;a<this._elements.length;++a){var s=this._elements[a];r&&(i=s.getGeometryBBox())&&(t=t?t.united(i):i);var l=[s];if(n>0)for(var c=s.getParent(),d=s.getNext()?s.getNext():null,u=0;u<n;++u){var p=s.clone();c.insertChild(p,d),u==n-1&&(p.setFlag(o.GNode.Flag.Selected),s.removeFlag(o.GNode.Flag.Selected)),l.push(p)}e.push(l)}var g=null;if(t&&!t.isEmpty()&&(g=t.getSide(r)),g)for(a=0;a<e.length;++a){if((l=e[a]).length>1)for(var h=0;h<l.length;++h)f(h,l[h],g);else 1==l.length&&f(1,l[0],g)}}.bind(this),o.GLocale.get(new o.GLocaleKey("GTransformProperties","action.apply-transformation")))},l.prototype._getOwnBorderScale=function(){return this._advancedTransformPanel.find('[data-property="_bs"]').prop("checked")},l.prototype._setBorderScale=function(e){this._document&&this._document.getScene().setBorderScale(e&&(void 0===i.GEditorOptions.scaleBorderWidth||i.GEditorOptions.scaleBorderWidth))},l.prototype._getOwnCornersScale=function(){return this._advancedTransformPanel.find('[data-property="esc"]').prop("checked")},l.prototype._setCornersScale=function(e){this._document&&this._document.getScene().setCornersScale(e&&(void 0===i.GEditorOptions.scaleCorners||i.GEditorOptions.scaleCorners))},l.prototype.toString=function(){return"[Object GTransformProperties]"},e.exports=l},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=n(43),a=n(56),s=i(n(309)),l=n(78),c=n(550),d=n(510),u=n(719),p=n(354);function g(){u.call(this)}o.GObject.inherit(g,u),g.ID="symbols",g.TITLE=new o.GLocaleKey("GSymbolsSidebar","title"),g.prototype._htmlElement=null,g.prototype._newSymbolButton=null,g.prototype._symbolsToolbar=null,g.prototype._symbolsPanel=null,g.prototype.getId=function(){return g.ID},g.prototype.getTitle=function(){return g.TITLE},g.prototype.isEnabled=function(){return!0},g.prototype.isVisible=function(){return!!gDesigner.getApplicationManager().isEditingEnabled()},g.prototype.getOrientation=function(){return p.Orientation.Left},g.prototype.getMinimumWidth=function(){return 250},g.prototype.getDefaultWidth=function(){return 250},g.prototype.isResizeable=function(){return!0},g.prototype.relayout=function(){this._symbolsPanel.gSymbolsPanel("relayout")},g.prototype.init=function(e){u.prototype.init.call(this,e),this._htmlElement=e,this._symbolsToolbar=$("<div></div>").addClass("toolbar symbols-toolbar").append($("<label></label>").css("flex-grow","1").text(o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","text.symbols")))).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation()}.bind(this)).appendTo(e),$("<button></button>").attr("data-title",o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","action.delete-symbol"))).on("click",()=>this._deleteSymbol()).append($("<span></span>").addClass("gravit-icon-trash")).append($("<span></span>").addClass("gravit-icon-touch-trash")).appendTo(this._symbolsToolbar).gRichTooltip(a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","text.delete-symbol-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","text.delete-symbol-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/symbols/#symbols-panel"})),this._newSymbolButton=$("<button></button>").attr("data-title",o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","action.create-symbol"))).on("click",function(){gDesigner.stats("symbols_new_symbol"),this._symbolsPanel.gSymbolsPanel("newSymbolClick")&&($(this._symbolsToolbar).gAccordion("toggleOpen",!0),$(this._symbolsToolbar).gAccordion("init",$(this._symbolsPanel)))}.bind(this)).append($("<span></span>").addClass("gravit-icon-plus")).append($("<span></span>").addClass("gravit-icon-touch-plus")).appendTo(this._symbolsToolbar).addClass("g-disabled").gRichTooltip(a.GRichTooltipConfig.from({title:o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","text.create-symbol-tooltip-title")),description:o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","text.create-symbol-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/symbols/#symbols-panel"}));var t=this,n=$("<div></div>").addClass("symbols-container").appendTo(e).on("click",(function(e){gDesigner.stats("symbols_click_symbol"),(e.target===this||$(e.target).hasClass("g-symbols-panel"))&&t._symbolsPanel.gSymbolsPanel("isSelected")&&t._document.getEditor().updateSelection(!1,t._document.getEditor().getSelection().slice().filter((function(e){return!(e instanceof o.GSymbol&&e.isMaster())})))})).on("scroll",(function(){if($("body").hasClass("g-touch")){var e=$(this)[0].scrollTop,t="light"==gDesigner.getSetting("theme")?"DFDFDF":"2E2E2E";e=e>20?20:e,$(".symbols-toolbar").css({"box-shadow":"0 0 25px ".concat(e,"px #").concat(t)})}}));this._symbolsPanel=$("<div></div>").addClass("symbols").on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation()})).on("drop",function(e){e.preventDefault(),e.stopPropagation()}.bind(this)).appendTo(n),this._symbolsPanel.gSymbolsPanel({moveCallback:this._moveSymbolCallback.bind(this),clickCallback:this._clickSymbolCallback.bind(this),dblClickCallback:this._dblClickSymbolCallback.bind(this),startDraggingCallback:this._startSymbolDraggingCallback.bind(this)}),gDesigner.addEventListener(l,this._documentEvent,this)},g.prototype._documentEvent=function(e){if(e.type===l.Type.Activated)this._document=e.document,this._symbolsPanel.gSymbolsPanel("scene",this._document.getScene()),this.trigger(u.UPDATE_EVENT),this._document.getEditor().addEventListener(r.GEditor.SelectionChangedEvent,this._selectionUpdate,this);else if(e.type===l.Type.Deactivated){this._symbolsPanel.gSymbolsPanel("scene",null),this._document.getEditor().removeEventListener(r.GEditor.SelectionChangedEvent,this._selectionUpdate,this),this._document=null,this.trigger(u.UPDATE_EVENT)}},g.prototype._deleteSymbol=function(){gDesigner.stats("symbols_delete_symbol");this._document.getEditor();var e=this._document.getScene(),t=(e.getActivePage(),this._symbolsPanel);t.gSymbolsPanel("isSelected")&&r.GEditor.tryRunTransaction(e,(function(){t.gSymbolsPanel("removeSelected")}),o.GLocale.get(new o.GLocaleKey("GSymbolsSidebar","action.delete-symbol")))},g.prototype._moveSymbolCallback=function(e,t,n){n&&e&&n.length},g.prototype._startSymbolDraggingCallback=function(e){return console.log("start dragging cb"),null},g.prototype._clickSymbolCallback=function(e){if(e&&e.isMaster()){var t=this._document.getEditor();if(t){var n=r.GEditor.getElementPage(e);n&&this._document.getScene().setActivePage(n),t.clearSelection(),t.updateSelection(!1,[e]),t.hasSelection()&&gDesigner.executeAction(d.ID,void 0,void 0,!0)}}},g.prototype._dblClickSymbolCallback=function(e){if(e&&e.isMaster()){var t=this._document.getEditor(),n=this._document.getScene(),i=(n.getActivePage(),[e]);n.visitLinks(e,(function(e){e instanceof o.GSymbol&&i.push(e)})),t&&(t.clearSelection(),t.updateSelection(!1,i))}},g.prototype._selectionUpdate=function(){var e=gDesigner.canExecuteAction(c.ID),t=this._newSymbolButton.hasClass("g-disabled");e&&t?this._newSymbolButton.removeClass("g-disabled"):e||t||this._newSymbolButton.addClass("g-disabled")},g.prototype.getTouchTools=function(){return[new s.default({id:"symbols",sidebar:this.getId(),icon:"gravit-icon-touch-newSymbols",panel:".symbols-container",toolbar:".symbols-toolbar"})]},g.prototype.toString=function(){return"[Object GSymbolsSidebar]"},e.exports=g},function(e,t,n){"use strict";var i=n(17);n(3);var o=n(1),r=i(n(309)),a=n(719),s=n(354),l=n(1534),c=n(106);const d=n(263);function u(){a.call(this)}o.GObject.inherit(u,a),u.ID="library",u.TITLE=new o.GLocaleKey("GLibrarySidebar","title"),u.prototype._initialized=!1,u.prototype._libraryPanel=null,u.prototype._libraryPanelInstance=null,u.prototype._htmlElement=null,u.prototype.getId=function(){return u.ID},u.prototype.getTitle=function(){return u.TITLE},u.prototype.isEnabled=function(){return c.isOnline()},u.prototype.isVisible=function(){return!!gDesigner.getApplicationManager().isEditingEnabled()},u.prototype.getOrientation=function(){return s.Orientation.Left},u.prototype.getMinimumWidth=function(){return 250},u.prototype.getDefaultWidth=function(){return 250},u.prototype.isResizeable=function(){return!0},u.prototype.resize=function(){this._libraryPanelInstance.resize()},u.prototype.relayout=function(){this._libraryPanel&&!this._libraryPanel.hasClass("unavailable")||!this.isEnabled()||this._addLibraryPanel(this._htmlElement)},u.prototype.init=function(e){a.prototype.init.call(this,e),this._htmlElement=e,this._addLibraryPanel(e),$(document).on("networkAvailable",function(){this.relayout();var e=gDesigner.getLeftSidebars(),t=e.getActiveSidebar();t===this.getId()&&e.setSidebarEnabled(t,this.isEnabled())}.bind(this)),gDesigner.addEventListener(d,this._networkAvailabilityChangedEvent,this)},u.prototype._networkAvailabilityChangedEvent=function(e){this._libraryPanel.toggleClass("offline",!e.connected),this._initialized||this._addLibraryPanel(this._htmlElement)},u.prototype._addLibraryPanel=function(e){this._libraryPanel||($("<div></div>").addClass("toolbar library-toolbar g-touch-only").append($("<label/>").text(o.GLocale.get(new o.GLocaleKey("GLibrarySidebar","title")))).appendTo(e),this._libraryPanel=$("<div/>").append($("<div/>").addClass("overlay").append($("<div/>").addClass("box").append($("<span/>").text(o.GLocale.get(new o.GLocaleKey("GOfflineDialog","title.unavailable-feature")))))).addClass("library-container").css("overflow","auto").appendTo(e)),this._libraryPanel.toggleClass("offline",gDesigner.isOffline()),c.isOnline()?(this._libraryPanel.hasClass("unavailable")&&(this._libraryPanel.removeClass("unavailable"),this._libraryPanel.empty()),gDesigner.isOffline()||(this._libraryPanelInstance=new l(this._libraryPanel),this._initialized=!0)):(this._libraryPanel.addClass("unavailable"),$("<span/>").addClass("span-unavailable").text(o.GLocale.get(new o.GLocaleKey("GLibrarySidebar","text.connect"))).appendTo(this._libraryPanel))},u.prototype.getTouchTools=function(){return[new r.default({id:"libraries",sidebar:this.getId(),icon:"gravit-icon-touch-libraries-panel",panel:".library-container"})]},u.prototype.toString=function(){return"[Object GLibrarySidebar]"},e.exports=u},function(e,t,n){"use strict";var i=n(17);n(45),n(14),n(63),n(129),n(29),n(84),n(9),n(19),n(24),n(111),n(90),n(25);var o=n(1086),r=n(1),a=n(16),s=n(12),l=i(n(1535)),c=n(192),d=n(722),{debounce:u,stringToBase64String:p}=n(32);const g=l.default.getElements();e.exports=class{constructor(e){this._parent=e,this._CURRENT_SKIP_COUNT=0,this._IMAGE_PAGE_COUNT=1,this._CURRENT_CATEGORY=null,this._CURRENT_ROOT_CATEGORY=null,this._IMAGE_ASSET_DRAINED=!1,this._LOADING=!1,this._wrapperWidth=250,this._debouncedResizeHandler=u(function(){var e=Array.from(this._parent.find(".assets-wrapper")).filter(e=>$(e).children().length),t=$(e).css("width")?parseInt($(e).css("width").split("px")[0]):250;Math.abs(t-this._wrapperWidth)>50&&(this._wrapperWidth=t,this._initMasonryLayoutColumns($(e),null,null,!0))}.bind(this),200);var t=$("<div/>").addClass("g-library-panel").appendTo(e);this._libraryPanel=t,this._createSearch(t),this._initElements(t)}_updateUI(e,t,n,i,o){var a=this,s=o?[]:t.children||[],l=e.find(".images");if(s.length>0&&0===e.find("select").length){var c=$("<select/>").addClass("selector").on("change",(function(){var n,i=$(this).find("option:selected").data("category");a._CURRENT_SKIP_COUNT=0,a._IMAGE_PAGE_COUNT=1,e.find(".asset-container").remove(),i?(a._CURRENT_CATEGORY=i,(n=a._CURRENT_ROOT_CATEGORY&&(a._CURRENT_ROOT_CATEGORY.name||a._CURRENT_ROOT_CATEGORY.path)||a._CURRENT_ROOT_CATEGORY||"")&&(n+="-"),n+=a._CURRENT_CATEGORY&&(a._CURRENT_CATEGORY.name||a._CURRENT_CATEGORY.path)||a._CURRENT_CATEGORY||""):(a._CURRENT_CATEGORY=t,a._CURRENT_ROOT_CATEGORY=t,(n=a._CURRENT_CATEGORY&&(a._CURRENT_CATEGORY.name||a._CURRENT_CATEGORY.path)||a._CURRENT_CATEGORY||"")&&(n+="-"),n+="All"),gDesigner.stats("librarypanel_change_category",n),a._loadAssets(e,a._CURRENT_CATEGORY,a._updateUI.bind(a))}));"element.image"===t.path&&c.addClass("full-width");var d=e.parent();d.find(".selector-container").remove();var u=d.find(".indicator");$("<div/>").addClass("selector-container").append(c).insertAfter(u),$("<option/>").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","element.all"))).appendTo(c);for(var p=0;p<s.length;++p){var g="element.child.name."+s[p].name.toLowerCase().trim().replace(/\s+/g,"-");$("<option/>").text(r.GLocale.get(new r.GLocaleKey("GCommonNames",g),s[p].name)).data("category",s[p]).appendTo(c)}}!function(t){var n=[];o||e.find(".asset").remove();for(var i=0;i<t.length;++i){let o=t[i],l=o.path&&o.path.startsWith("element.image");var r=a._getPreviewURI(o);if(l)n.push(o);else{var s=$("<div/>").addClass("asset-container").attr("data-title",o.name||""),c=$("<img/>").on("dragstart",(function(){return!1})).attr("draggable",!1).attr("src",r).on("mousedown",(function(e){a._onItemDragStartHandler(o,e)})).addClass("asset");s.append(c),e.append(s)}}if(n){var d=l.length?l:e;a._initMasonryLayoutColumns(d,n,o)}}(n)}_initMasonryLayoutColumns(e,t,n,i){if(i&&e&&(t=e.find(".column").children()).unwrap(),0!==t.length){this._wrapperWidth=e.css("width")?parseInt(e.css("width").split("px")[0]):250;var o,r=this,a=[],l=2,c=null;if(l=Math.max(Math.ceil(this._wrapperWidth/200),l),o=this._wrapperWidth/l-4*(l-1),c=l>2?o/this._wrapperWidth*100+"%":"calc(50% - 4px)",n)a=e.find(".column").toArray();else for(var d=0;d<l;d++){var u=$("<div/>").addClass("column").css("width",c);d>0&&u.css("margin-left","4px"),a.push(u)}for(var p=0;p<t.length;p++){var g;if(i)g=t[p];else{let e=t[p];var h=r._getPreviewURI(e),f=$("<img/>").addClass("asset").attr("draggable",!1).attr("src",h).on("dragstart",(function(){return!1})).on("mousedown",(function(t){r._onItemDragStartHandler(e,t)}));(g=$("<div/>").addClass("asset-container image-asset").css("margin-bottom","4px").append($("<span/>").text(e.user.name).attr("draggable",!1).on("mousedown",(function(t){var n=$(this).parent();r._onItemDragStartHandler(e,t,n)})).on("click",(function(t){t.preventDefault();var n=new URL(e.user.profile);n.searchParams.append("utm_source",encodeURIComponent(s.DESIGNER.TITLE)),n.searchParams.append("utm_medium","referral"),gContainer.openExternalLink(t,n)})))).append(f)}$(a[a.length-1-p%l]).append(g)}n||e.append(a)}}_addAsset(e,t){var n=this;!async function(){if(e.content)t&&(t.center=!0),gDesigner.getActiveDocument().placeOrImport(new Blob([e.content],{type:e.type||"image/svg+xml"}),t,!1,!0);else if(e.path.startsWith("element.ui."))try{var i=await fetch(e.url).then(e=>{if(!e.ok)throw new Error;return e.text()}),l=$.parseXML(i);l&&"svg"===l.documentElement.nodeName&&gDesigner.getActiveDocument().placeOrImport(new Blob([i],{type:"image/svg+xml"}),t,!1,!0)}catch(e){}else if(e.path.startsWith("element.image.")){var u=e.id;try{var p=a.GPlatform.modifiers.optionKey,g=await s.gApi.getUnsplashPhotoUrl({id:u,size:"regular"}),h=await fetch(g).then(e=>{if(!e.ok)throw new Error;return e.blob()});o.GBitmapImport.import(h,(e,i,o,a)=>{if(e)new c(r.GLocale.get(new r.GLocaleKey("GDocument","text.image-too-big"))).open();else{var s=gDesigner.getActiveDocument(),l=s.getScene(),u=s.getEditor(),g=l.getActivePage(),h=u.hasSelection()&&u.getSelection()[0],f=r.GLocale.get(new r.GLocaleKey("GImage","name.unsplash")),m=r.GLocale.get(new r.GLocaleKey("GEditor","action.insert-image"));u.beginTransaction();try{if(!h||h instanceof r.GImage){let e=new r.GImage;e.setProperties(["name","iw","ih","url"],[f,o,a,i]),n._transformNode(e,t),g.appendChild(e),gDesigner.stats("librarypanel_download_image")}else if(p){var y=u.getSelection()[0].getTransform(),v=y&&y.getTranslation();let e=new r.GImage;e.setProperties(["name","iw","ih","url"],[f,o,a,i]),!t&&v&&(t={x:v.getX(),y:v.getY()}),n._transformNode(e,t),g.appendChild(e),u.updateSelection(!0,[e]),gDesigner.executeAction(d.ID,void 0,void 0,!0),gDesigner.stats("librarypanel_download_image","clip")}else{var _=u.getSelection()[0].getPaintLayers();if(_){var b=new r.GTexturePattern(i);b.setSizeMode(r.GTexturePattern.SizeMode.Cover),b.setScene(l);var w=new r.GStylable.FillPaintLayer(b);_.appendChild(w)}m=r.GLocale.get(new r.GLocaleKey("GFillPaintLayerProperties","action.change-properties")),gDesigner.stats("librarypanel_download_image","fill")}}finally{u.commitTransaction(m)}}})}catch(e){}}else{var f=e.url,m=gDesigner.getActiveDocument(),y=m.getEditor(),v=m.getScene().getActivePage(),_=null,b=null,w=v.getGeometryBBox(),C=w&&v.isFixedSized()?w.getWidth():800,E=w&&v.isFixedSized()?w.getHeight():800;if(e.path.startsWith("element.line.tile"))b=(_=.4*C)/10;else{_=e.width,b=e.height;var S=_/b;if((_=C/3)>300&&(_=300),b=_/S,_=Math.round(_),(b=Math.round(b))>E){var G=b;(b=E/3)>300&&(b=300),_=_/G*b,_=Math.round(_),b=Math.round(b)}}var A=new XMLHttpRequest;A.open("GET",f),A.onload=()=>{o.GSVGImport.import(A.responseText,{baseWidth:_,baseHeight:b,forceBaseSize:!0},gDesigner.getActiveDocument().getScene()._workspace.getFontManager(),(i,o)=>{if(o){y.beginTransaction();try{if(e.path.startsWith("element.line.tile")){var a,s,l=new r.GTexturePattern(o,r.GTexturePattern.RepeatMode.Horizontal);l.setPosition(r.GTexturePattern.PositionMode.Center),t?(a=t.x-_/2,s=t.y-b/2):(a=.3*C,s=(E-b)/2);var c=new r.GRectangle;c.setProperty("trf",new r.GTransform(_/2,0,0,b/2,a+_/2,s+b/2)),c.setProperty("isLine",!0,!0,!1),v.appendChild(c),c.getPaintLayers().insertChild(new r.GStylable.FillPaintLayer(l)),gDesigner.getActiveDocument().getEditor().updateSelection(!1,[c])}else n._transformNode(o,t),m.insertElement(o,!t,!0,!1)}finally{y.commitTransaction("Add Element")}}})},A.send()}}()}_transformNode(e,t){if(t&&e.hasMixin(r.GElement.Transform)){var n=e.getGeometryBBox(),i=n&&n.getX()?n.getX():0,o=n&&n.getY()?n.getY():0;n&&(i+=n.getWidth()/2,o+=n.getHeight()/2),e.transform(new r.GTransform(1,0,0,1,t.x-i,t.y-o),!0)}}_createScrollEvent(){$(".library-container").unbind("scroll"),$($(".library-container")).scroll(function(e){var t=$(e.currentTarget);t.scrollTop()>50?0===$(t).find(".library-scroll-top").length&&$("<div/>").addClass("library-scroll-top").append($("<div/>").addClass("container").append($("<span/>").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.back-to-top")))).append($("<span/>").addClass("gravit-icon-back-to-top"))).on("click",(function(){gDesigner.stats("librarypanel_click_backtotop"),$(".library-container").animate({scrollTop:0},"slow")})).appendTo(t):$(t).find(".library-scroll-top").remove()}.bind(this))}_createSearch(e){var t=$("<div/>"),n=$("<div/>"),i=this,o=function(e){i._libraryPanel.find(".category-row").find(".category").removeClass("active"),i._libraryPanel.find(".assets").css("display","none"),i._CURRENT_SKIP_COUNT=0,i._IMAGE_PAGE_COUNT=1,i._CURRENT_CATEGORY=e,i._CURRENT_ROOT_CATEGORY=null,t.find("span").toggleClass("gravit-icon-search",!e||!e.trim()),t.find("span").toggleClass("gravit-icon-close",!!e&&!!e.trim());var o=n.find(".assets-wrapper").first();o.empty(),o.append($("<div></div>").addClass("assets-wrapper images")),e&&e.trim()&&(n.css("display","block"),i._createScrollEvent(null,n,!0),i._loadAssets(o,e,i._updateUI.bind(i),!0))};t.addClass("library-search").append($("<input/>").attr("type","text").addClass("g-input").attr("placeholder",r.GLocale.get(new r.GLocaleKey("GCommonNames","element.search"))+"...").on("keypress",(function(e){13===e.keyCode&&o($(this).val())}))).append($("<span/>").addClass("gravit-icon-search").on("click",(function(){var e=$(this);gDesigner.stats("librarypanel_click_search",e.prev("input").val()),$(n).is(":visible")?(n.find(".assets-wrapper").empty(),n.css("display","none"),e.prev("input").val(""),e.removeClass("gravit-icon-close"),e.addClass("gravit-icon-search")):o(e.prev("input").val())}))).appendTo(e),n.addClass("assets").css("display","none").append($("<div></div>").addClass("assets-content").append([$("<div/>").addClass("indicator"),$("<div/>").addClass("assets-wrapper").append($("<div/>").addClass("assets-wrapper images"))])).append(this._loadMoreButton(n,!0)).appendTo(e)}_loadMoreButton(e,t){return $("<div/>").addClass("button-wrapper").addClass("hidden").append($("<button/>").addClass("load-more").text(r.GLocale.get(new r.GLocaleKey("GCommonNames","text.library-load-more"))).on("click",()=>{this._loadAssets(e.find(".assets-wrapper").first(),this._CURRENT_CATEGORY,this._updateUI.bind(this),t,!0),this._toggleShowMoreButton(!0,!0)}))}_initElements(e){for(var t=this,n=0;n<g.length;++n){let a=g[n];if(n>0&&n%3==0){let t=$("<div/>").addClass("assets").css("display","none").append($("<div/>").addClass("assets-content").append([$("<div/>").addClass("indicator"),$("<div/>").addClass("assets-wrapper")])).appendTo(e);t.append(this._loadMoreButton(t,!1))}var i=this._libraryPanel.find(".category-row:last-child");0!==i.length&&3!==i.children().length||(i=$("<div/>").addClass("category-row")).appendTo(e);let s=$("<div/>").addClass("category").on("click",(function(){var e=a.name||a.path||a||"";e&&(e+="-"),e+="All",gDesigner.stats("librarypanel_search_category",e);var n=$(this),i=n.closest(".category-row"),o=i.children().index(this),r=i.next(".assets"),l=n.hasClass("category")&&n.hasClass("active");i.closest(".g-library-panel").find(".category").removeClass("active"),n.addClass("active");var c=i.closest(".g-library-panel").find(".assets").not(i.next(".assets"));c.removeClass("first second third"),$(".library-search").find("span").removeClass("gravit-icon-close"),$(".library-search").find("span").addClass("gravit-icon-search"),c.css("display","none");var d=r.find(".assets-wrapper");"auto"!==d.css("height")&&d.css("height","auto"),r.find(".selector-container").remove(),d.empty(),c.find(".assets-wrapper").empty();var u=function(e){let t=r.hasClass(e);r.removeClass("first second third"),t?(r.css("display","none"),n.removeClass("active")):(r.addClass(e),r.css("display",""),n.addClass("active"))};u(0===o?"first":1===o?"second":"third");var p=r.find(".assets-content");d=r.find(".assets-wrapper"),p.removeClass(),p.addClass("assets-content"),p.addClass("asset-"+a.path.slice(8).replace(/\./g,"-")),t._createScrollEvent(s,r),t._CURRENT_SKIP_COUNT=0,t._IMAGE_PAGE_COUNT=1,t._CURRENT_CATEGORY=a,t._CURRENT_ROOT_CATEGORY=a,l||t._loadAssets(d,a,t._updateUI)})).appendTo(i);var o=$("<div/>").addClass("content").appendTo(s);$("<img/>").addClass("icon").attr("src",a.url).appendTo(o),$("<span/>").addClass("title").text(r.GLocale.get(new r.GLocaleKey("GCommonNames",a.path.replace(/\.$/,"")),a.name)).appendTo(o)}let a=$("<div/>").addClass("assets").css("display","none").append($("<div/>").addClass("assets-content").append([$("<div/>").addClass("indicator"),$("<div/>").addClass("assets-wrapper")])).appendTo(e);a.append(this._loadMoreButton(a,!1))}_loadAssets(e,t,n,i,o){this._toggleShowMoreButton(!1,!1),this._toggleLoading(!0),this._doLoadAssets(e,t,n,i,o)}async _doLoadAssets(e,t,n,i,o){let r=[],a=0,c=0;try{if(i){let e=[];if(l.default.isUnsplashIntegrationEnabled()){if(!this._IMAGE_ASSET_DRAINED)try{e=await s.gApi.searchUnsplashPhotos({query:t,page:this._IMAGE_PAGE_COUNT})}catch(e){console.warn("Unsplash search failed",e)}c=(e||[]).length,c||(this._IMAGE_ASSET_DRAINED=!0)}r=[],-1!==this._CURRENT_SKIP_COUNT&&(r=await s.gApi.listMarket({q:t,path:"element.",limit:"90",skip:this._CURRENT_SKIP_COUNT+"",sort:"name"})),a=(r||[]).length,r=r.concat(e)}else if(t.path&&t.path.startsWith("element.image"))l.default.isUnsplashIntegrationEnabled()&&(r=t.tag?await s.gApi.searchUnsplashPhotos({query:t.tag,page:this._IMAGE_PAGE_COUNT}):await s.gApi.getUnsplashPhotos({page:this._IMAGE_PAGE_COUNT}),c=(r||[]).length);else{var d=t.path;r=await s.gApi.listMarket({path:"element.line"===d?"element.line.tile":d,tag:t.tag,limit:"90",skip:this._CURRENT_SKIP_COUNT+"",sort:"name"}),a=(r||[]).length}a<90&&0===c?this._toggleShowMoreButton(!1,!1):this._toggleShowMoreButton(!0,!1),r.length<90?(this._CURRENT_SKIP_COUNT=-1,this._IMAGE_PAGE_COUNT++):(this._CURRENT_SKIP_COUNT+=90,this._IMAGE_PAGE_COUNT++)}catch(e){}this._toggleLoading(!1),n.call(this,e,t,r,i,o)}_toggleLoading(e){e?this._libraryPanel.find(".assets").addClass("loading"):this._libraryPanel.find(".assets").removeClass("loading")}_toggleShowMoreButton(e,t){let n=this._libraryPanel.find(".assets").find(".button-wrapper");n.find(".load-more")[t?"addClass":"removeClass"]("hidden"),n[t?"addClass":"removeClass"]("loading"),n[e?"removeClass":"addClass"]("hidden")}_getPreviewURI(e){return e.content&&!e.url_t?"data:".concat(e.type||"image/svg+xml",";base64,").concat(p(e.content)):e.url_t||e.url||e.image.thumb}_onItemDragStartHandler(e,t,n){var i;this._clickCheckTime=Date.now(),i=n?n.get(0).getBoundingClientRect():t.target.getBoundingClientRect();var o=e.width||i.width||50,r=e.height||i.height||50,a=gDesigner.getActiveDocument().getScene().getActivePage();if(e.path.startsWith("element.line.tile"))r=(o=a.getGeometryBBox()&&a.isFixedSized()?.4*a.getGeometryBBox().getWidth():320)/10;else{var s=a.getGeometryBBox(),l=s&&a.isFixedSized()?s.getWidth():800,c=s&&a.isFixedSized()?s.getHeight():800;if(!e.path.startsWith("element.ui")&&!e.path.startsWith("element.icons")){var d=o/r;if((o=l/3)>300&&(o=300),r=o/d,o=Math.round(o),(r=Math.round(r))>c){var u=r;(r=c/3)>300&&(r=300),o=o/e.height*u,o=Math.round(o),r=Math.round(r)}}r*=gDesigner.getWindows().getActiveWindow().getView().getZoom(),o*=gDesigner.getWindows().getActiveWindow().getView().getZoom()}if(!this._dragging){var p=i.left+i.width/2,g=i.top+i.height/2;this._dragOffset={x:p-t.clientX,y:g-t.clientY},this._dragging=!0,this._currentElement=t.target,this._currentItem=e,this._previewSize={w:o,h:r},e.path.startsWith("element.line.tile")?this.dragPreview=$("<div/>").css("background",'url("'+e.url+'")').css("background-repeat","repeat-x").css("background-position",Math.round(r/2)+"px 0px").css("position","absolute").css("height",r/2+"px").css("width",o/2+"px").css("display","none").appendTo("body"):(e.content&&!e.url?this.dragPreview=$(e.content):this.dragPreview=$("<img/>").attr("src",e.url||e.image&&e.image.thumb),this.dragPreview.css("position","absolute").css("height",r+"px").css("width",o+"px").css("display","none").on("dragstart",(function(){return!1})).attr("draggable",!1).appendTo("body"));var h=t.clientX,f=t.clientY;$(this.dragPreview).css("left",h+"px"),$(this.dragPreview).css("top",f+"px"),this._itemDragListener=this._onItemDrag.bind(this),this._itemDragEndListener=this._onItemDragEndHandler.bind(this),document.addEventListener("mousemove",this._itemDragListener),document.addEventListener("touchmove",this._itemDragListener),document.addEventListener("mouseup",this._itemDragEndListener),document.addEventListener("touchend",this._itemDragEndListener)}}_onItemDragEndHandler(e){if($(this.dragPreview).remove(),Date.now()-this._clickCheckTime<=200||!this._dragMoved)return this._dragMoved=!1,document.removeEventListener("mousemove",this._itemDragListener),document.removeEventListener("touchmove",this._itemDragListener),document.removeEventListener("mouseup",this._itemDragEndListener),document.removeEventListener("touchend",this._itemDragEndListener),this._dragging=!1,this._currentElement.style.visibility="visible",void this._addAsset(this._currentItem);if(this._dragMoved=!1,this._dragging){var t=gDesigner.getActiveDocument();document.removeEventListener("mousemove",this._itemDragListener),document.removeEventListener("touchmove",this._itemDragListener),document.removeEventListener("mouseup",this._itemDragEndListener),document.removeEventListener("touchend",this._itemDragEndListener);var n=e.clientX,i=e.clientY;if(gDesigner.positionIsOnCanvas(n,i)){var o=t.getActiveWindow().getView(),r={};Object.assign(r,e),r.clientX=n,r.clientY=i,r.offsetX=e.offsetX+(this._dragOffset&&this._dragOffset.x),r.offsetY=e.offsetY+(this._dragOffset&&this._dragOffset.y),r.pageX=e.pageX+(this._dragOffset&&this._dragOffset.x),r.pageY=e.pageY+(this._dragOffset&&this._dragOffset.y);var a=o._convertClientPositionFromMousePosition(r),s=o.getViewTransform(t.scene).mapPoint(a);a={x:s._x,y:s._y},this._addAsset(this._currentItem,a)}this._dragging=!1,this._currentElement.style.visibility="visible"}}_onItemDrag(e){this._dragMoved=!0,this._currentElement.style.visibility="hidden";var t=e.clientX+(this._dragOffset?this._dragOffset.x:0),n=e.clientY+(this._dragOffset?this._dragOffset.y:0);t-=this._previewSize.w/2,n-=this._previewSize.h/2,$(this.dragPreview).css("left",t+"px"),$(this.dragPreview).css("top",n+"px"),$(this.dragPreview).css("display","")}resize(){this._debouncedResizeHandler()}}},function(e,t,n){"use strict";var i=n(12);class o{static getElements(){return o.isUnsplashIntegrationEnabled()?i.ELEMENTS:i.ELEMENTS.filter(e=>"element.image"!==e.path)}static isUnsplashIntegrationEnabled(){return i.ENABLE_UNSPLASH_INTEGRATION}}e.exports=o},function(e,t,n){"use strict";n(14),n(29),n(9),n(3);var i=n(1);const o=n(548),r=n(353),a=n(1075),s=n(76),l=n(36),{SOFTWARE_UPDATE:c,DateAPI:d}=n(12);function u(){}i.GObject.inherit(u,o),u.ID="software-update-panel",u.prototype._mustBeOpened=null,u.prototype.init=function(e){this._htmlElement=e,this._htmlElement.addClass("software-update-panel"),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>this._hide()).appendTo(this._htmlElement),this._updatePanelState(!1)},u.prototype._hide=function(){this._updatePanelState(!1)},u.prototype._changePanelVisibility=function(e){e?this._htmlElement.removeClass("g-hide"):this._htmlElement.addClass("g-hide")},u.prototype._updatePanelState=function(e){e!==this._mustBeOpened&&(this._changePanelVisibility(e),this._mustBeOpened=e,this.trigger(r.UPDATE_EVENT))},u.prototype._updateContent=function(e){this._htmlElement.find(".content").remove(),this._htmlElement.append($("<div></div>").addClass("content").append(e))},u.prototype.activate=function(){this._addEventListeners()},u.prototype.deactivate=function(){this._removeEventListeners()},u.prototype._addEventListeners=function(){gDesigner.addEventListener(a.AfterUpdate,this._handleAfterUpdate,this),gDesigner.addEventListener(a.DownloadComplete,this._handleDownloadComplete,this),gDesigner.addEventListener(a.Downloading,this._handleDownloadInProgress,this),gDesigner.addEventListener(a.UpdateAvailable,this._handleUpdateAvailable,this),gDesigner.addEventListener(a.UpdateError,this._handleUpdateError,this),gDesigner.addEventListener(a.UpdateNotAvailable,this._handleUpdateNotAvailable,this)},u.prototype._handleAfterUpdate=function(e){if(!this._shouldShowMessages(e))return;const t=e.currentVersion,n=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.after-update")).replace("%currentVersion",t);this._updateContent($("<div></div>").addClass("message").addClass("featured").append(n).append(c.SHOW_CHANGE_LOG?$("<a></a>").text(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.see-release-notes"))).click(e=>{gContainer.openExternalLink(e,gDesigner.getSoftwareUpdateManager().getReleaseNotesLink())}):"")),this._updatePanelState(!0)},u.prototype._handleUpdateNotAvailable=function(e){if(!this._shouldShowMessages(e))return;const t=e.currentVersion,n=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.update-not-available")).replace("%currentVersion",t);this._updateContent($("<div></div>").addClass("message").append(n)),this._updatePanelState(!0)},u.prototype._handleDownloadComplete=function(e){if(!this._shouldShowMessages(e))return;const t=e.newVersion,n=e.forceUpdate,o=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.download-ready")).replace("%newVersion",t);var r=!1;this._updateContent($("<div></div>").addClass("message").addClass("featured").html(o).click(async()=>{r||await gContainer.canUnload(gDesigner.hasModifiedDocuments(),gDesigner.hasSynchronizingDocuments())&&(r=!0,gDesigner.getSoftwareUpdateManager().installUpdate(),this._updateContent($("<div></div>").addClass("message").addClass("featured").append($("<span/>").addClass("gravit-icon-rotate-right-flat").addClass("icon").addClass("spin")).append(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.updating")))))})),this._updatePanelState(!0),n&&this._createForceUpdateMessageDialog()},u.prototype._handleDownloadInProgress=function(e){if(!this._shouldShowMessages(e))return;const t=e.percent,n=e.newVersion;var o=this._htmlElement.find(".progress-content");const r=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.download-progress")).replace("%newVersion",n);o.length||(this._updateContent($("<div></div>").addClass("message").text(r).append($("<div></div>").addClass("progress-content").append($("<div></div>").addClass("progress-element").append($("<div></div>").addClass("progress-bar"))).append($("<div></div>").addClass("percent")))),o=this._htmlElement.find(".progress-content"));o.find(".progress-bar").css({width:"".concat(t,"%")}),o.find(".percent").text(t)},u.prototype._shouldShowMessages=function(e){return!e.isSilent},u.prototype._handleUpdateAvailable=function(e){if(!this._shouldShowMessages(e))return;const t=e.currentVersion,n=e.newVersion,o=e.forceUpdate;if(e.isSilent&&!o)return;!o||gContainer.getRuntime()!==s.Runtime.Browser&&gContainer.getRuntime()!==s.Runtime.PWA||this._createForceUpdateMessageDialog();const r=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.update-available")).replace("%newVersion",n).replace("%currentVersion",t),a=$("<span/>").addClass("gravit-icon-rotate-right-flat").addClass("icon");this._updateContent($("<div></div>").addClass("message").addClass("featured").append(a).append(r).append($("<a></a>").append(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.update-now"))).click(()=>{a.addClass("spin"),this._installAfterDocumentUnload()}))),this._updatePanelState(!0)},u.prototype._installAfterDocumentUnload=async function(){if(await gContainer.canUnload(gDesigner.hasModifiedDocuments(),gDesigner.hasSynchronizingDocuments()))switch(gContainer.getRuntime()){case s.Runtime.Browser:case s.Runtime.PWA:gDesigner.getSoftwareUpdateManager().installUpdate();break;case s.Runtime.Electron:gDesigner.getSoftwareUpdateManager().downloadUpdate()}else l.alert(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.dialog-unsaved-documents")))},u.prototype._createForceUpdateMessageDialog=function(){let e,t=!1;const n=d.minutesToMilliseconds(5),o=()=>{t||(t=!0,e.gDialog("close"),gDesigner.createCountdown(()=>{gDesigner.getSoftwareUpdateManager().installUpdate()},n))};e=$("<div></div>").gDialog({releaseOnClose:!0,className:"g-force-update-app-dialog",closeCallback:o}),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>o()).appendTo(e),$("<div></div>").addClass("logo").appendTo(e),$("<div></div>").addClass("content").append($("<span></span>").addClass("title").html(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.force-new-version-available")).replace("%newVersion",gDesigner.getSoftwareUpdateManager().getNewVersion()))).append($("<span></span>").addClass("subtitle").html(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.force-message-avoid-losing-progress")))).append($("<span></span>").addClass("update-information").html(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.force-update-information-time")).replace("%minutes",5))).append($("<div></div>").addClass("buttons").append($("<button></button>").append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.ok")))).on("click",()=>o()))).appendTo(e),e.gDialog("open",!1)},u.prototype._handleUpdateError=function(e){if(!this._shouldShowMessages(e))return;const t=i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","text.update-error"));this._updateContent($("<div></div>").addClass("message").append(t)),this._updatePanelState(!0)},u.prototype._removeEventListeners=function(){gDesigner.removeEventListener(a.AfterUpdate,this._handleAfterUpdate),gDesigner.removeEventListener(a.DownloadComplete,this._handleDownloadComplete),gDesigner.removeEventListener(a.Downloading,this._handleDownloadInProgress),gDesigner.removeEventListener(a.UpdateAvailable,this._handleUpdateAvailable),gDesigner.removeEventListener(a.UpdateError,this._handleUpdateError),gDesigner.removeEventListener(a.UpdateNotAvailable,this._handleUpdateNotAvailable)},u.prototype.getTitle=function(){return i.GLocale.get(new i.GLocaleKey("GSoftwareUpdatePanel","title"))},u.prototype.isEnabled=function(){return!!this._mustBeOpened},u.prototype.toString=function(){return"[Object GSoftwareUpdatePanel]"},u.prototype.getId=function(){return u.ID},e.exports=u},function(e,t,n){"use strict";n(9),n(14),n(29),n(3);var i=n(1);const{DESIGNER:{TITLE:o}}=n(12),r=n(548),a=n(353),s=n(1204),l=n(78),c=n(769),d=n(1538);function u(){}i.GObject.inherit(u,r),u.ID="notification-panel",u.prototype._htmlElement=null,u.prototype._lastNotification=null,u.prototype._closeCallback=null,u.prototype.init=function(e){this._htmlElement=e,this._htmlElement.addClass("g-hide").addClass("g-notification-panel").on("click",(function(){$(this).toggleClass("bring-to-front",!0),gDesigner.sendSideBarAndAssistBarToBack()})),$("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>{this._close(!0)}).appendTo(this._htmlElement),gDesigner.addEventListener(s,this._notificationEvent,this),gDesigner.addEventListener(l,this._documentEvent,this)},u.prototype.isEnabled=function(){return!this._htmlElement.hasClass("g-hide")},u.prototype._documentEvent=function(e){if(!e.document.isLockedByVersionHistory()&&this._lastNotification&&this._lastNotification.document)switch(e.type){case l.Type.Activated:{let t=e.document!==this._lastNotification.document;this._htmlElement.toggleClass("g-hide",t),this._htmlElement.toggleClass("bring-to-front",t),t&&gDesigner.sendSideBarAndAssistBarToBack();break}case l.Type.Removed:e.document===this._lastNotification.document&&this._close()}},u.prototype._notificationEvent=async function(e){if(this._lastNotification=e.notification,this._closeCallback=e.notification.closeCallback,this._htmlElement.removeClass("g-hide"),this._htmlElement.toggleClass("bring-to-front",!0),gDesigner.sendSideBarAndAssistBarToBack(),this._htmlElement.toggleClass("popup",!!e.notification.popup&&!e.notification.anonymous),e.notification.anonymous){const t=gDesigner.getActiveDocument(),n=t&&t.isDocumentFromTemplate()&&t.isShared(),r=e=>{e&&!e.isAnonymous()&&(this._lastNotification=null,this._htmlElement.addClass("g-hide"))};let a=n?i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.create-account-template")):i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.create-account"));const s=$("<div/>").addClass("anonymous").append($("<div/>").addClass("logo")).append($("<div/>").addClass("content").append($("<span/>").addClass("title").text(i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.title-welcome")).replace("%app",o))).append($("<span/>").text(e.notification.message).css("display",e.notification.message&&!n?"":"none")).append($("<span/>").html(a.replace("%signup",()=>$("<span/>").attr("id","signup-link").addClass("link").text(i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.sign-up"))).prop("outerHTML")).replace("%signin",()=>$("<span/>").attr("id","signin-link").addClass("link").text(i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.sign-in"))).prop("outerHTML")))).append($("<span/>").addClass("footer").html(i.GLocale.get(new i.GLocaleKey("GNotificationPanel","text.footer")).replace("%app",()=>$("<span/>").attr("id","learnmore-link").addClass("link").text(o).prop("outerHTML")))));s.find("#signup-link").on("click",()=>{gDesigner.stats("open-shared_click_create-account"),new c(r).open({anonymous:!0,signup:!0,animate:!0})}),s.find("#signin-link").on("click",()=>{gDesigner.stats("open-shared_click_login"),new c(r).open({anonymous:!0,animate:!0})}),s.find("#learnmore-link").on("click",e=>{gDesigner.stats("open-shared_click_learn-more"),gContainer.openExternalLink(e,"https://designer.io/?utm_campaign=gdsharedfile")}),this._updateContent(s)}else if(e.notification.custom){if(this._closeCallback=e.notification.closeCallback,this._htmlElement.addClass([e.notification.class,e.notification.enter]),this._updateContent(e.notification.content),e.notification.timeout){let t=this;new Promise((function(n){setTimeout((function(){t._htmlElement.removeClass(e.notification.enter),t._htmlElement.addClass(e.notification.exit),n(!0)}),e.notification.timeout)})).then((function(){setTimeout((function(){t._htmlElement.removeClass(e.notification.exit),t._close(!1)}),600)}))}}else e.builder instanceof d?(e.builder.addEventListener(d.Event,e=>{e.type===d.Event.Type.Close&&this._close()}),this._updateContent($("<div></div>").addClass("message").append(await e.builder.build()))):this._updateContent($("<div></div>").addClass("message").append(e.notification.message));this.trigger(a.UPDATE_EVENT)},u.prototype._updateContent=function(e){this._htmlElement.find(".content").remove(),this._htmlElement.append($("<div></div>").addClass("content").append(e))},u.prototype._close=function(e){this._lastNotification=null,this._htmlElement.addClass("g-hide"),this._closeCallback&&e&&this._closeCallback(),this.trigger(a.UPDATE_EVENT)},u.prototype.toString=function(){return"[Object GNotificationPanel]"},u.prototype.getId=function(){return u.ID},e.exports=u},function(e,t,n){"use strict";var i=n(1);function o(e,t){this._builder=e,this._onClose=t}i.GObject.inherit(o,i.GEventTarget),o.prototype.build=function(){return this._builder()},o.prototype.close=function(){this.hasEventListeners(o.Event)&&this.trigger(new o.Event(o.Event.Type.Close)),this._onClose&&this._onClose()},o.Event=function(e){this.type=e},i.GObject.inherit(o.Event,i.GEvent),o.Event.Type={Close:0},e.exports=o},function(e,t,n){"use strict";n(9),n(14),n(29),n(163),n(3);var i=n(1);const o=n(548),r=n(353),a=n(351),s=n(352),l=n(78),c=n(263),d=n(1228),u=n(1230),p=n(36),g=n(175),{DateAPI:h,ShareRoles:f}=n(12);function m(){}i.GObject.inherit(m,o),m.ID="collaborative-text-panel",m.prototype._htmlElement=null,m.prototype._requestLockDialog=null,m.prototype._lastRequestLockTime=0,m.prototype._isModified=!1,m.prototype._applicationStateChangedEvent=function(e){e.document===this._document&&this._update()},m.prototype._documentEvent=function(e){if(!e.document.isLockedByVersionHistory())switch(e.type){case l.Type.Activated:this._deactivate(),this._document=e.document,this._document.addEventListener(u.StatusChangedEvent,this._update,this),this._document.addEventListener(u.LockUpdateEvent,this._update,this),this._document.addEventListener(s,this._collaborationEvent,this),gDesigner.addEventListener(c,this._networkAvailabilityChangedEvent,this),this._update();break;case l.Type.Deactivated:e.document===this._document&&(this._deactivate(),this._htmlElement.css("display","none"));break;case l.Type.Modified:if(!this.isEnabled())return;if(e.document===this._document&&this._document.isCollaborativeTextEditing()){const e=this._document.isModified();this._isModified!==e&&(this._isModified=e,this._update())}}},m.prototype._deactivate=function(){this._document&&(this._document.removeEventListener(u.StatusChangedEvent,this._update,this),this._document.removeEventListener(u.LockUpdateEvent,this._update,this),this._document.removeEventListener(s,this._collaborationEvent,this),gDesigner.removeEventListener(c,this._networkAvailabilityChangedEvent,this))},m.prototype._collaborationEvent=function(e){e.type===s.Type.LockRequest&&this._requestLock(e.data.from&&e.data.from.name)},m.prototype._networkAvailabilityChangedEvent=function(e){this._htmlElement.toggleClass("offline",!e.connected)},m.prototype._update=async function(){if(this._htmlElement.css("display",this.isEnabled()?"":"none"),this.isEnabled()){const e=this._document.getCollaborativeTextController();if(e)if(e.getStatus()===u.Status.UpdateAvailable)this._document.lock(),this._showUpdatePanel();else if(e.getStatus()===u.Status.Updating)this._showUpdatingPanel();else if(gDesigner.getApplicationManager().hasRole(f.Owner))this._showOwnerPanel();else if(await e.canLock())switch(e.getStatus()){case u.Status.Initial:case u.Status.Editing:this._showEditPanel();break;case u.Status.Finished:case u.Status.Previewed:this._showFinishedPanel();break;case u.Status.Previewing:this._showPreviewPanel();break;case u.Status.Sending:this._showSendingPanel()}else this._showRequestPanel()}this.trigger(r.UPDATE_EVENT)},m.prototype._showOwnerPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("owner-panel").append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.owner-message")))))},m.prototype._showUpdatePanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("update-panel").append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.update-available-message")))).append($("<div/>").addClass("buttons").append($("<button/>").addClass("g-highlight-button").addClass("highlighted").addClass("online-action").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.update-now"))).on("click",()=>{gDesigner.stats("collabtextpanel_bottom-bar_file-update"),this._document.getCollaborativeTextController().reloadDocument()}))))},m.prototype._showUpdatingPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("updating-panel").append($("<div>").addClass("g-loading")).append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.updating")))))},m.prototype._showEditPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("edit-panel").append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.finish-editing-message")))).append($("<button/>").addClass("g-highlight-button").addClass("highlighted").addClass("online-action").prop("disabled",!this._document.isModified()).text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.finish-editing"))).on("click",()=>{gDesigner.stats("collabtextpanel_bottom-bar_finish-editing"),this._document.getCollaborativeTextController().finishTextEditing()})))},m.prototype._showFinishedPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("finish-panel").append($("<button/>").prop("disabled",this._document.getCollaborativeTextController().getStatus()===u.Status.Previewed).addClass("g-highlight-button").addClass("outlined").addClass("online-action").append($("<span/>").addClass("icon").addClass("gravit-icon-co-text-editing-display")).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.preview-changes")))).on("click",()=>{gDesigner.stats("collabtextpanel_bottom-bar_preview-changes"),this._document.getCollaborativeTextController().previewChanges()})).append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.send-changes-message")))).append($("<div/>").addClass("buttons").append($("<button/>").addClass("g-highlight-button").addClass("secondary").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.back-to-editing"))).on("click",()=>{gDesigner.stats("collabtextpanel_bottom-bar_back-to-editing"),this._document.getCollaborativeTextController().backToTextEditing()})).append($("<button/>").addClass("g-highlight-button").addClass("highlighted").addClass("online-action").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.send-changes"))).on("click",()=>{gDesigner.stats("collabtextpanel_bottom-bar_send-changes"),p.confirm(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.send-to-owner")),e=>{e&&this._document.getCollaborativeTextController().sendChanges().then(()=>{p.alert(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.your-changes-were-applied")))}).catch(()=>{p.alert(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.send-changes-failed")))})})}))))},m.prototype._showPreviewPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("preview-panel").append($("<div>").addClass("g-loading")).append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.rendering-preview")))))},m.prototype._showSendingPanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("sending-panel").append($("<div>").addClass("g-loading")).append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.sending-changes")))))},m.prototype._showRequestPanel=async function(){const e=await this._document.getCollaborativeTextController().getCurrentLock();if(!e)return this._document.getCollaborativeTextController().resetTextEditing();const t=new g(e.user);this._htmlElement.empty().append($("<div/>").addClass("container").addClass("request-access-panel").append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.request-access-message")).replace("%name",t.getFullUserName()))).append($("<button/>").addClass("g-highlight-button").addClass("highlighted").addClass("online-action").prop("disabled",this._document.getCollaborativeTextController().hasAlreadyRequestedAccess()).text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.request-access"))).on("click",e=>{gDesigner.stats("collabtextpanel_bottom-bar_request-access"),gDesigner.toggleLoading(!0),this._document.getCollaborativeTextController().requestAccess().then(()=>{$(e.target).closest("button").attr("disabled",!0),p.alert(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.request-has-been-sent")).replace("%name",t.getFullUserName()))}).catch(e=>{e.status&&e.status!==gApi.HTTP_STATUS_CODES.NOT_FOUND&&p.error(e)}).finally(()=>{this._update(),gDesigner.toggleLoading(!1)})})))},m.prototype._requestLock=function(e){if(!this.isEnabled())return;if(this._requestLockDialog)return;const t=h.now(),n=h.minutesToMilliseconds(5);this._lastRequestLockTime&&t-this._lastRequestLockTime<n||(this._lastRequestLockTime=t,this._requestLockDialog=p.custom({className:"g-request-lock-dialog",closeCallback:()=>this._requestLockDialog=null,closeable:!1,subtitle:i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.wants-to-take-over")).replace(/%name/g,e||i.GLocale.get(new i.GLocaleKey("GCommonNames","text.unknown-user"))),buttons:[{label:i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.save-my-edits-and-allow")),onclick:e=>{e.gDialog("close"),this._document.getCollaborativeTextController().sendChanges().catch(()=>{p.alert(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.send-changes-failed")))})}},{label:i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.discard-my-edits-and-allow")),onclick:e=>{e.addClass("g-loading"),this._document.getCollaborativeTextController().releaseLock().catch(e=>{p.error(e)}).finally(()=>{e.gDialog("close")})}},{label:i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.decline")),highlighted:!0,onclick:e=>{e.gDialog("close")}}]}))},m.prototype.init=function(e){this._htmlElement=e,this._htmlElement.addClass("g-collaborative-text-panel").css("display","none"),gDesigner.addEventListener(l,this._documentEvent,this),gDesigner.addEventListener(d,this._unloadEvent,this),gDesigner.addEventListener(a,this._applicationStateChangedEvent,this)},m.prototype._unloadEvent=function(e){if(this._document)try{gApi.lock.releaseSync(this._document.getId())}catch(e){}},m.prototype.isEnabled=function(){return!!this._document&&this._document.isCollaborativeTextEditing()},m.prototype.toString=function(){return"[Object GCollaborativeTextPanel]"},m.prototype.getId=function(){return m.ID},e.exports=m},function(e,t,n){"use strict";n(9),n(3);var i=n(1);const o=n(548),r=n(353),a=n(78),s=n(263),l=n(200),c=n(77);n(1230);function d(){}i.GObject.inherit(d,o),d.ID="document-notifications-panel",d.prototype._htmlElement=null,d.prototype._isModified=!1,d.prototype._documentEvent=function(e){if(!e.document.isLockedByVersionHistory())switch(e.type){case a.Type.Activated:this._deactivate(),this._document=e.document,gDesigner.addEventListener(s,this._networkAvailabilityChangedEvent,this),this._document.addEventListener(l,this._handleDocumentStatusEvent,this),this._update(!0);break;case a.Type.Deactivated:e.document===this._document&&(this._deactivate(),this._update(!0));break;case a.Type.UpdateAvailable:this._document===e.document&&this._update(!1)}},d.prototype._deactivate=function(){this._document&&(gDesigner.removeEventListener(s,this._networkAvailabilityChangedEvent,this),this._document.removeEventListener(l,this._handleDocumentStatusEvent,this),this._document=null)},d.prototype._handleDocumentStatusEvent=function(e){e.status===c.Loaded&&this._update(!0)},d.prototype._networkAvailabilityChangedEvent=function(e){this._htmlElement.toggleClass("offline",!e.connected)},d.prototype._update=async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.isEnabled()||!this._document||this._document.isIgnoringCurrentUpdate()||this._document.getStatus()===c.Loading)return void this._close(!0);let t=!e||await this._document.isUpdateAvailable();t?this._showUpdatePanel():this._close(),this.trigger(r.UPDATE_EVENT)},d.prototype._close=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._htmlElement.css("display","none"),e&&this.trigger(r.UPDATE_EVENT)},d.prototype._showUpdatePanel=function(){this._htmlElement.empty().append($("<div/>").addClass("container").addClass("update-panel").append($("<span/>").addClass("message").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.update-available-message")))).append($("<div/>").addClass("buttons").append($("<button/>").addClass("g-highlight-button").addClass("secondary").text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.cancel"))).on("click",()=>{this._document.ignoreCurrentUpdate(),this._close(!0)})).append($("<button/>").addClass("g-highlight-button").addClass("highlighted").addClass("online-action").text(i.GLocale.get(new i.GLocaleKey("GCollaborativeTextPanel","text.update-now"))).on("click",()=>{this._close(!0),this._document.reload()})))),this._htmlElement.css("display","")},d.prototype.init=function(e){this._htmlElement=e,this._htmlElement.addClass("g-document-notification-panel").css("display","none"),gDesigner.addEventListener(a,this._documentEvent,this)},d.prototype.isEnabled=function(){return!!this._document&&!this._document.isCollaborativeTextEditing()},d.prototype.toString=function(){return"[Object GDocumentNotificationsPanel]"},d.prototype.getId=function(){return d.ID},e.exports=d},function(e,t,n){"use strict";n(28);n(1);n(76),n(1542);function i(e){this._storage=e}i.prototype._plugins=null,i.prototype._storage=null,i.prototype.load=function(){try{this._plugins=this._storage.getPlugins(),this._plugins&&this._plugins.forEach(e=>{try{e.load(this._storage)}catch(e){console.error("PluginManager: Could not load plugin",e)}})}catch(e){console.error("PluginManager: Could not load plugins",e)}},i.prototype.init=function(e){if(this._plugins&&this._plugins.length){let t=()=>({actions:[],sidebars:[],panels:[],tools:[],properties:[]}),n=t();this._plugins.forEach(e=>{try{let i=t();e.init(i),Object.keys(i).forEach(e=>{n[e]=n[e].concat(i[e])})}catch(e){console.error("PluginManager: Could not initilize plugin",e)}}),Object.keys(n).forEach(t=>{e[t]=e[t].concat(n[t])})}},i.prototype.start=function(){this._plugins&&this._plugins.length&&this._plugins.forEach(e=>{try{e.start()}catch(e){console.error("PluginManager: Could not start plugin",e)}})},i.prototype.unload=function(e){this._plugins&&this._plugins.length&&this._plugins.forEach(t=>{try{t.unload(this._storage,e)}catch(e){console.error("PluginManager: Could not unload plugin",e)}})},e.exports=i},function(e,t,n){"use strict";function i(e){this.id=e,this._intervals=[],this._timeouts=[]}n(28),n(3),i.prototype.exports=null,i.prototype.id=null,i.prototype._intervals=null,i.prototype._timeouts=null,i.prototype.setTimeout=function(){let e=setTimeout.apply(null,arguments);return this._timeouts.push(e),e},i.prototype.setInterval=function(){let e=setInterval.apply(null,arguments);return this._intervals.push(e),e},i.prototype.unload=function(){this._timeouts.forEach(e=>clearTimeout(e)),this._intervals.forEach(e=>clearInterval(e)),this._timeouts=[],this._intervals=[]},i.prototype.toString=function(){return"[Object GModule]"},e.exports=i},function(e,t,n){"use strict";n(19),n(24),n(111),n(90),n(3);const i=n(1229);e.exports=class{static setupInAppLinkReloadAppForOnce(){gContainer.addEventListener(i,(function e(t){let{type:n,data:o}=t;if(n===i.Type.OpenInAppLink){gContainer.removeEventListener(i,e);const t=o.params,n=new URL(window.location.href);for(let e in t)n.searchParams.set(e,t[e]);window.location.href=n.toString()}}))}}},function(e,t,n){"use strict";n(45);var i,o,r=null,a=null,s=!1;class l{static _getTooltipElement(){return a}static _getBodyWidth(){return $("body").width()}static _getBodyHeight(){return $("body").height()}static showTooltip(e){i=void 0;let t=l._getTooltipElement();if(r||e){var n=$(r||e).closest("[data-title]");if(n.length){var a=n[0].getBoundingClientRect(),c=n.attr("data-title"),d=parseInt(n.attr("data-custom-left-offset")||0),u=!!parseInt(n.attr("data-wrap")||0);if(a&&c){t.addClass("visible").toggleClass("wrap",u).text(c);var p=a.left+a.width/2-t.outerWidth()/2+"px",g=a.top+a.height+"px";t.css({left:p,top:g}),t.offset().top+a.height>l._getBodyHeight()&&t.css("top",a.top-a.height+"px");const e=l._getBodyWidth();if(d+t.offset().left+t.outerWidth()>e){let n=t.offset().left-(t.offset().left+t.outerWidth()-e)+d;t.css("left",n+"px")}l.resetIdle(),s=!0,o=setTimeout(l.resetIdle,500)}}}}static resetIdle(){void 0!==o&&clearTimeout(o),s=!1}static resetTooltip(){void 0!==i&&(clearTimeout(i),i=void 0),a.removeClass("visible").text("").css({left:"",top:""})}static documentOverListener(e){l.resetTooltip();let t=$(e.target).closest("[data-title]"),n=t.data("gRichTooltip")||t.parent().data("gRichTooltip")||t.children().eq(0).data("gRichTooltip");t.length>0&&!n&&(r=e.target,s?l.showTooltip():i=setTimeout(l.showTooltip,500))}static documentOutListener(){l.resetTooltip(),r=null}static init(){a=$("<div></div>").addClass("g-tooltip").appendTo($("body")),document.addEventListener("mouseover",l.documentOverListener),document.addEventListener("mouseout",l.documentOutListener)}}e.exports=l;var c={show:function(){l.showTooltip($(this)),document.addEventListener("click",l.resetTooltip,{once:!0,capture:!0})}};$.fn.gTooltip=function(e){return c[e]?c[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}},function(e,t,n){"use strict";n(19),n(24);class i extends Error{constructor(){super(...arguments),Error.captureStackTrace(this,i),this.code=57005}static isPluginError(e){return e&&e.code&&57005===e.code}}e.exports=i},function(e,t,n){"use strict";e.exports=class{constructor(){this._dialog=$("<div></div>").gDialog({relaseOnClose:!0,className:"g-maintenance-dialog"}),$("<iframe></iframe>").attr("src","assets/static/maintenance/index.html").appendTo(this._dialog)}open(){this._dialog.gDialog("open",!0)}close(){this._dialog.gDialog("close")}}},function(e,t,n){"use strict";n(14),n(63),n(9),n(3),n(58),n(83),n(774),n(168);var i=n(1),o=n(12),r=n(32);const a=n(76),s=n(1075),l=n(1231);var c;e.exports=class{constructor(){this._intervalPID=null,this._releaseStatus={version:void 0,forceUpdate:!1},this._downloadCompleted=!1}_trigger(e){gDesigner.trigger(e)}getNewVersion(){return this._releaseStatus.version}getCurrentVersion(){return gDesigner.getVersion()}getCurrentFriendlyVersion(){return gDesigner.getVersionFriendlyName()}_isVersionGeneralFormatHigherThan(e,t){var n=e.split("."),i=t.split(".");if(3!==n.length||n.some(e=>isNaN(Number(e))))throw"Incorrect release version argument";if(3!==i.length||i.some(e=>isNaN(Number(e))))throw"Incorrect current version argument";var o=+n[0],r=+n[1],a=+n[2],s=+i[0],l=+i[1],c=+i[2];return o>s||o===s&&r>l||o===s&&r===l&&a>c}_isVersionHigherThan(e,t){return!!e&&this._isVersionGeneralFormatHigherThan(e,t)}async initializeReleaseStatus(){try{this._releaseStatus=await o.gApi.software.getRelease({current:this.getCurrentVersion(),env:gDesigner.getEnv(),runtime:gContainer.getRuntime(),build:gDesigner.getBuildNum(),commit:gDesigner.getCommitSHA(),internalVersion:gDesigner.getVersion()})}catch(e){this._releaseStatus={silent:!0,forceUpdate:!1}}}async initializeReleaseStatusWithNotifications(){await this.initializeReleaseStatus(),this._releaseStatus.silent=!1}async checkForUpdates(e){if(gDesigner.isOffline())return console.warn(this.toString()+" Unable to check for updates - system is offline!");try{const t=this.getCurrentVersion();e?await this.initializeReleaseStatus():await this.initializeReleaseStatusWithNotifications();this._isVersionHigherThan(this._releaseStatus.tagVersion,t)?this._isElectron()?c.checkForUpdates():this._trigger(new s.UpdateAvailable({currentVersion:this.getCurrentFriendlyVersion(),newVersion:this._releaseStatus.version,forceUpdate:this._releaseStatus.forceUpdate,isSilent:this._releaseStatus.silent})):e||this._trigger(new s.UpdateNotAvailable({currentVersion:this.getCurrentFriendlyVersion()}))}catch(e){console.error(this.toString(),"exception",e)}}downloadUpdate(){console.info(this.toString()," - Downloading update"),this._isElectron()&&c.downloadUpdate()}async installElectronUpdate(){i.GSystem.operatingSystem===i.GSystem.OperatingSystem.OSX_IOS&&(console.info(this.toString()," - Waiting install - OSX"),await(0,r.sleep)(5e3)),console.info(this.toString()," - Installing update - Call"),c.installUpdate()}async installUpdate(){switch(console.info(this.toString()," - Installing update - Start"),this._releaseStatus.silent||this._trigger(new s.BeforeInstallUpdate),gContainer.getRuntime()){case a.Runtime.Browser:case a.Runtime.PWA:location.reload();break;case a.Runtime.Electron:console.info(this.toString()," - Checking download"),this._downloadCompleted?this._releaseStatus.silent?gContainer.setProperty("install_update_on_start",!0):this.installElectronUpdate():console.warn(this.toString()+" The download has not been finished yet!")}}_isElectron(){return gContainer.getRuntime()===a.Runtime.Electron}async start(){[a.Runtime.Electron,a.Runtime.Browser,a.Runtime.PWA].includes(gContainer.getRuntime())?(this._isElectron()&&((c=n(1548)).on(l.UpdateDownloaded,this._handleDownloadComplete.bind(this)),c.on(l.DownloadProgress,this._handleDownloadInProgress.bind(this)),c.on(l.UpdateAvailable,this._handleUpdateAvailable.bind(this)),c.on(l.Error,this._handleUpdateError.bind(this)),c.on(l.UpdateNotAvailable,this._handleUpdateNotAvailable.bind(this)),c.on(l.CheckingForUpdate,this._handleCheckingForUpdate.bind(this)),await gContainer.getProperty("install_update_on_start")&&(gContainer.removeProperty("install_update_on_start"),await this.initializeReleaseStatus(),this.installElectronUpdate())),this._intervalPID=setTimeout(function(){let e=(new Date).getTime();gContainer.setProperty("last_update_check",e),this.checkForUpdates(!0)}.bind(this),o.DateAPI.daysToMilliseconds(1)),gContainer.getProperty("last_update_check").then(e=>{let t=(new Date).getTime();if(e){let n=o.DateAPI.diff(o.DateAPI.toDate(e),o.DateAPI.toDate(t),!1),i=o.DateAPI.daysToMilliseconds(1);(n<0||n>=i)&&(gContainer.setProperty("last_update_check",t),this.checkForUpdates(!0))}else gContainer.setProperty("last_update_check",t)}),gContainer.getProperty("old_version").then(e=>{const t=this.getCurrentVersion();e?e!==t&&(gContainer.setProperty("old_version",t),o.gApi.software.getRelease().then(e=>{e&&!e.silent&&this._trigger(new s.AfterUpdate({currentVersion:this.getCurrentFriendlyVersion()}))})):gContainer.setProperty("old_version",t)})):console.warn(this.toString()+" Runtime not available for auto update!")}_handleDownloadComplete(){console.info(this.toString()+" Download complete"),this._downloadCompleted=!0,this._trigger(new s.DownloadComplete({newVersion:this._releaseStatus.version,forceUpdate:this._releaseStatus.forceUpdate,isSilent:this._releaseStatus.silent}))}_handleUpdateNotAvailable(){console.info(this.toString()+" Update not available"),this._trigger(new s.UpdateNotAvailable({currentVersion:this.getCurrentFriendlyVersion(),isSilent:this._releaseStatus.silent}))}_handleCheckingForUpdate(){console.info(this.toString()+" Checking for update"),this._trigger(new s.CheckingForUpdate({isSilent:this._releaseStatus.silent}))}_handleDownloadInProgress(e,t){console.info(this.toString()+" Download in progress:"+JSON.stringify(t));const n=t.percent;this._trigger(new s.Downloading({percent:parseFloat(n).toFixed(2),newVersion:this._releaseStatus.version,isSilent:this._releaseStatus.silent}))}_handleUpdateAvailable(e,t){console.info(this.toString()+" Update available:"+JSON.stringify(t)),this._trigger(new s.UpdateAvailable({currentVersion:this.getCurrentFriendlyVersion(),newVersion:this._releaseStatus.version,forceUpdate:this._releaseStatus.forceUpdate,isSilent:this._releaseStatus.silent})),this._releaseStatus.forceUpdate&&this._isElectron()&&c.downloadUpdate()}_handleUpdateError(e,t){console.info(this.toString()+" Update error:"+JSON.stringify(t)),this._trigger(new s.UpdateError({error:t,isSilent:this._releaseStatus.silent}))}stop(){this._intervalPID&&clearInterval(this._intervalPID)}getReleaseNotesLink(){return o.SOFTWARE_UPDATE.CHANGE_LOG_LINK}toString(){return"[Object GSoftwareUpdateManager]"}}},function(e,t,n){"use strict";n(3);var{ipcRenderer:i}=n(791);const o=n(1231);function r(){}r.prototype.installUpdate=function(){console.info(this.toString()+" Firing install update"),i.send(o.CommandInstallUpdate)},r.prototype.checkForUpdates=function(){console.info(this.toString()+" Firing checking update"),i.send(o.CommandCheckForUpdates)},r.prototype.downloadUpdate=function(){console.info(this.toString()+" Firing download update"),i.send(o.CommandDownloadUpdate)},r.prototype.on=function(e,t){i.on(e,t)},r.prototype.toString=function(){return"[Object GElectronUpdateServiceClient]"},e.exports=new r},function(e,t,n){"use strict";const i=n(1129),o=n(1550),r=n(1553),a=n(1554);e.exports=class{static newInAppPurchase(e){switch(e){case i.Windows:return new r;case i.Apple:return new a;default:return new o}}}},function(e,t,n){"use strict";var i=n(17);n(9),n(163),n(25);var o=i(n(1134)),r=i(n(1043)),a=n(1);const{gApi:s,IN_APP_PURCHASE:{CLEVERBRIDGE:{openCartInAPopup:l=!1}={}}={}}=n(12),c=n(721),d=n(264),u=n(546),p=n(231),g=n(1551),h=n(1552),f=n(1077);e.exports=class extends f{getOptions(){return this._paymentFlow?this._paymentFlow.getOptions():null}async purchase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return gDesigner.toggleLoading(!0),this._purchase(e,t).finally(()=>{gDesigner.toggleLoading(!1)})}_purchase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $(".g-payment-dialog").length?Promise.reject(!1):new Promise(async(n,i)=>{try{this._paymentFlow&&this._paymentFlow.abort(),this._paymentFlow=new o.default(t);const l=async()=>{const{immediatePurchase:o=!1,paymentCallback:l,autoClose:p=!1}=t,g=await gDesigner.getUser();if(!e){if(!g)return this._paymentFlow.step((new r.default).listen(d).when(e=>!!e&&!!e.user).do(()=>{gDesigner.openPaymentDialog(e,t)})),void n();{const n=gDesigner.now().getTime();e=await s.getProduct(Object.assign({time:n,language:a.GLocale.getLocaleLanguageTag().slice(0,2)},t))}}if(!e)return void i(new Error("Product is missing"));const{reinstate:h=!1}=e;if(h)return this._paymentFlow.step(gDesigner.executeWhenReady(()=>{new u(this._user,"purchase").open()})),void n({reinstate:!0});this._paymentFlow.step((new r.default).listen(c).when(()=>gDesigner.isInitialized()).do(()=>{this._openCart(e,o,p).finally(l)},o)),n()};gDesigner.isOffline()?(p.openRetryConnection(l),gDesigner.toggleLoading(!1)):await l()}catch(e){i(e)}}).then(e=>(e&&e.reinstate||"undefined"!=typeof dataLayer&&dataLayer.push({event:"USER_CART_VIEW_EVENT"}),e))}_openCart(e,t,n){return l&&!t?this._openCartPopup(e):this._openCartDialog(e,n)}_openCartPopup(e){return(new h).open(e.url)}_openCartDialog(e,t){return(new g).open(e.url,t)}}},function(e,t,n){"use strict";n(9),n(19),n(24),n(111),n(90),n(14),n(63),n(3);var i=n(1);const o=n(231),r=n(36),a=n(1232);e.exports=class{async open(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._url=e,this._autoClose=t,this._isPending=!0;return await gDesigner.isOfflineAsync()?new Promise((e,t)=>{o.openRetryConnection(()=>{this._open().then(e).catch(t)})}):this._open()}async _open(){if($(".g-payment-dialog").length)return Promise.reject();const e=a.getInstance();this._dialog=$("<div></div>").gDialog({className:"g-payment-dialog",releaseOnClose:!0,closeCallback:()=>{e.cancelPurchase()}}).append($("<div></div>").addClass("g-btn-close").append($("<span></span>").addClass("gravit-icon-close")).on("click",()=>{this._close()}));const t=$("<div></div>").addClass("content").appendTo(this._dialog);this._dialog.addClass("g-loading"),this._dialog.gDialog("open",!1);const n=this._getURL();$("<iframe/>").attr("src",n).on("load",()=>{this._dialog.removeClass("g-loading")}).on("error",()=>{this._dialog.removeClass("g-loading")}).appendTo(t);try{await e.waitForPurchase()}catch(e){r.alert(i.GLocale.get(new i.GLocaleKey("GPaymentDialog","text.payment-not-confirmed")))}finally{this._isPending=!1}}_getURL(){let e=this._url;const t=gDesigner.getLinkerParam();if(t){const n=new URL(e);n.searchParams.set.apply(n.searchParams,t.split("=")),e=n.toString()}return e}_close(){if(this._isPending){const e=i.GLocale.get(new i.GLocaleKey("GPaymentDialog","text.dialog-dont-leave")),t=i.GLocale.get(new i.GLocaleKey("GPaymentDialog","text.cancel")),n=i.GLocale.get(new i.GLocaleKey("GPaymentDialog","text.finish-my-order"));r.confirm(e,e=>{e?(this._autoClose=!0,this._isPending||this.close()):this.close()},t,n)}else this.close()}close(){this._dialog.gDialog("close")}}},function(e,t,n){"use strict";n(9);const i=n(36),{gApi:o}=n(12),r=n(1232);e.exports=class{async open(e){try{gContainer.openExternalLink(null,e);const t=r.getInstance();await t.waitForPurchase()}catch(e){i.alert(o.formatError(e))}}}},function(e,t,n){"use strict";n(9),n(163);const i=n(1077),o=n(264),r=n(263),{gApi:a,MicrosoftB2BKeyType:s,PaymentProviders:l,DateAPI:c,IN_APP_PURCHASE:{WINDOWS:{production:d,trunk:u,rc:p,beta:g,lts:h}={}}={}}=n(12),{IS_PRODUCTION:f,IS_LTS:m,IS_RC:y,IS_BETA:v}=n(198),{ERROR_CODES:{ERR_MICROSOFT_STORE_SERVICES_B2B_KEY_NOT_FOUND:_}}=a;e.exports=class extends i{constructor(){if(super(),!window.napi)return;const{remote:e}=n(791),t=e.getCurrentWindow().getNativeWindowHandle();this._store=new window.napi.windowsStore.StoreContext,this._store.initialize(t),gDesigner.addEventListener(o,this._userLoggedEvent,this),gDesigner.addEventListener(r,this._networkAvailabilityChangedEvent,this),this._intervalId=setInterval(()=>this.syncLicense(),c.daysToMilliseconds(1))}async purchase(e,t){try{if(gDesigner.toggleLoading(!0),e||(e=await this.getProduct()),!e)return}finally{gDesigner.toggleLoading(!1)}return new Promise((t,n)=>{const i=setTimeout(()=>{n()},c.minutesToMilliseconds(3));this._store.requestPurchaseAsync(e.productId,(e,o)=>{clearTimeout(i),e?n(e):(gDesigner.toggleLoading(!0),this.syncLicense().then(t).catch(n).finally(()=>{gDesigner.toggleLoading(!1)}))})})}async getProduct(){return new Promise((e,t)=>{this._store.getAssociatedStoreProductsAsync(["Durable"],(n,i)=>{if(n)return t(n);if(!i)return t();const o=this._getInAppOfferToken();if(!o)return t();const r=Object.values(i).find(e=>e.inAppOfferToken===o);if(!r)return t();e({provider:l.WindowsStore,formattedPrice:r.price.formattedRecurrencePrice,currency:r.price.currencyCode,productId:r.storeId})})})}async syncLicense(){const e=await gDesigner.getUser();if(e)return a.microsoftStoreServices.syncLicense().then(()=>gDesigner.requestLicenseUpdate()).catch(async t=>{if(t.cloud&&t.code===_){const t=await a.microsoftStoreServices.getAccessToken(),n=await this._createB2BKeyForPurchaseAPI(e,t),i=await this._createB2BKeyForCollectionsAPI(e,t);return await a.microsoftStoreServices.updateB2BKeys({accessToken:t,keys:{[s.Purchase]:n,[s.Collections]:i}}),a.microsoftStoreServices.syncLicense().then(()=>gDesigner.requestLicenseUpdate())}throw t})}_getInAppOfferToken(){return f?d:v?g:m?h:y?p:u}_createB2BKeyForPurchaseAPI(e,t){return new Promise(async(n,i)=>{this._store.getCustomerPurchaseIdAsync(t,e.getUID(),(e,t)=>{e?i(e):n(t)})})}_createB2BKeyForCollectionsAPI(e,t){return new Promise(async(n,i)=>{this._store.getCustomerCollectionsIdAsync(t,e.getUID(),(e,t)=>{e?i(e):n(t)})})}_userLoggedEvent(e){this.syncLicense()}_networkAvailabilityChangedEvent(e){e.connected&&this.syncLicense()}}},function(e,t,n){"use strict";const i=n(1077);e.exports=class extends i{canMakePayments(){return!1}}},function(e,t,n){"use strict";n(9),n(475);const i=n(264),o=n(1556),{gApi:r,DateAPI:a}=n(12);e.exports=class{init(){gDesigner.addEventListener(i,this._userLoggedEvent,this)}async _userLoggedEvent(e){const t=e.user;if(t&&t.getUID()){gDesigner.removeEventListener(i,this._userLoggedEvent,this);try{await this._shouldShowWindowsStoreAnnouncement(t)&&this._showWindowsStoreAnnouncement()}finally{this._updateWindowStoreAnnouncementFlag()}}}async _shouldShowWindowsStoreAnnouncement(e){const{flags:{windowsStoreAnnouncement:t=!1}={}}=await r.getUserSettings().catch(()=>({}));return!(t||!a.lt(e.created,Date.now()))}_updateWindowStoreAnnouncementFlag(){r.updateUserSettings({flags:{windowsStoreAnnouncement:!0}})}_showWindowsStoreAnnouncement(){gDesigner.executeWhenReady(()=>{(new o).open()})}}},function(e,t,n){"use strict";var i=n(1);const o={[i.GLocaleLanguage.Portuguese]:"pt-br",[i.GLocaleLanguage.Spanish]:"es",[i.GLocaleLanguage.German]:"de",[i.GLocaleLanguage.Italian]:"it",[i.GLocaleLanguage.French]:"fr"};e.exports=class{constructor(){const e=o[i.GLocale.getLanguage()]||"en",t=$("<iframe>").attr("src","https://www.designer.io/".concat(e,"/messages/windows-store")).on("load error",()=>this._dialog.removeClass("g-loading"));this._dialog=$("<div/>").addClass("g-loading").gDialog({releaseOnClose:!0,className:"g-windows-store-announcement-dialog",buttons:[$("<button/>").addClass("primary").text(i.GLocale.get(new i.GLocaleKey("GLocale","ok"))).on("click",()=>this.close())]}).append(t)}open(){this._dialog.gDialog("open",!1)}close(){this._dialog.gDialog("close")}}},function(e,t,n){"use strict";n(9),n(14),n(29);var i=n(1);const o=n(36),{DESIGNER:{TITLE:r}={}}=n(12);e.exports=class{async init(){await this._shouldOpenWarningDialog()&&gDesigner.executeWhenReady(()=>this._openWarningDialog())}_openWarningDialog(){o.custom({icon:"info",closeable:!1,className:"g-beta-warning-dialog",title:i.GLocale.get(new i.GLocaleKey("GBetaFlow","text.title")).replace("%app",r),subtitle:i.GLocale.get(new i.GLocaleKey("GBetaFlow","text.message")),buttons:[{label:i.GLocale.get(new i.GLocaleKey("GBetaFlow","text.i-understand")).toUpperCase(),closeOnClick:!0,highlighted:!0}],dontShowAgainCb:e=>{gContainer.setProperty("designer.betaflow.dismiss-warning-dialog",!!e)}})}async _shouldOpenWarningDialog(){return!await gContainer.getProperty("designer.betaflow.dismiss-warning-dialog",!1)}}},function(e,t,n){"use strict";var i=n(17);n(14),n(29);var o=n(1),r=i(n(36));const{DateAPI:a,DESIGNER:{TITLE:s}={}}=n(12),l=a.minutesToMilliseconds(1),c=.8,d=a.minutesToMilliseconds(30);e.exports=class{constructor(){let{memoryCheckInterval:e=l,memoryUsageThreshold:t=c,autostartTime:n=d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._memoryCheckInterval=Math.max(e,a.minutesToMilliseconds(1)),this._memoryUsageThreshold=t,this._autostartTime=n}start(){this.stop(),this._memoryUsageThreshold<=0||gContainer.isMemoryInfoAvailable()&&(this._memoryCheckIntervalId=setInterval(this._checkMemory.bind(this),this._memoryCheckInterval))}stop(){this._autostartScheduleId&&(clearTimeout(this._autostartScheduleId),delete this._autostartScheduleId),this._memoryCheckIntervalId&&(clearInterval(this._memoryCheckIntervalId),delete this._memoryCheckIntervalId)}_checkMemory(){this._calculateThreshold()>=this._memoryUsageThreshold&&(this._openWarningDialog(),this.stop(),this._scheduleStartup())}_calculateThreshold(){const e=gContainer.getMemoryInfo();return e?e.heapSizeInUse/e.heapSizeLimit:0}_scheduleStartup(){this._autostartTime>0&&(this._autostartScheduleId=setTimeout(()=>{this.start()},this._autostartTime))}_openWarningDialog(){this._dialog||(gDesigner.stats("memorywarningdialog_open"),this._dialog=r.default.custom({closeCallback:()=>{delete this._dialog},className:"g-memory-warn-dialog",closeable:!1,icon:"info",title:o.GLocale.get(new o.GLocaleKey("GMemoryManager","text.title")).replace("%app",s),subtitle:o.GLocale.get(new o.GLocaleKey("GMemoryManager","text.subtitle")),buttons:[{label:o.GLocale.get(new o.GLocaleKey("GLocale","ok")),onclick:e=>{e.gDialog("close")},highlighted:!0}]}))}}},function(e,t,n){"use strict";n(14),n(132);var i=n(1);i.GUtil.image2Canvas=function(e,t){if("string"==typeof e){var n=new Image;return e&&e.match(/^(http|https|\/\/)/)?n.crossOrigin="Anonymous":n.crossOrigin=null,n.src=e,n.onload=function(){this.image2Canvas(n,t)}.bind(this),null}var i=document.createElement("canvas");return i.width=e.naturalWidth,i.height=e.naturalHeight,i.getContext("2d").drawImage(e,0,0),t&&t(i),i},i.GUtil.image2Base64=function(e,t){var n=this.image2Canvas(e,(function(e){t&&t(e.toDataURL("image/png"))}));return n?n.toDataURL("image/png"):null}},function(e,t,n){"use strict";function i(e,t){var n,i,o=this;return function(){return i=Array.prototype.slice.call(arguments,0),n=clearTimeout(n,i),n=setTimeout((function(){e.apply(o,i),n=0}),t),this}}$.expr[":"].editable=function(e){var t=$(e);if("true"===t.attr("contenteditable")||e.isContentEditable)return!0;if(t.is("input")){var n=t.attr("type");return!n||""===n||"text"===n||"password"===n||"email"===n||"number"===n||"month"===n||"search"===n||"tel"===n||"week"===n||"url"===n||"time"===n||"datetime"===n||"datetime-local"===n||"date"===n}return!!t.is("textArea")},$.extend($.fn,{debounce:function(e,t,n){return this.bind(e,i.apply(this,[t,n])),this}})},function(e,t,n){"use strict";n(1).GUtil.prepareForSaving=function(e,t){}},function(e,t,n){"use strict";"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},window.CustomEvent.prototype=window.Event.prototype),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},n(1563)},function(e,t,n){"use strict";n(9),function(){function e(){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{e(n.result)},n.onerror=t,n.readAsArrayBuffer(this)})}"File"in self&&(File.prototype.arrayBuffer=File.prototype.arrayBuffer||e),"Blob"in self&&(Blob.prototype.arrayBuffer=Blob.prototype.arrayBuffer||e)}()},function(e,t,n){"use strict";n(45),n(3);var i=n(1),o=n(16),r=n(12),a=n(32);function s(){}i.GObject.inherit(s,i.GEvent),s.prototype._startX=0,s.prototype._startY=0,s.prototype._timerHandle=null,s.prototype._mouseMove=null,s.prototype._mouseUp=null,s.prototype._mouseDown=null,s.prototype._isTouchDevice=!1,s.prototype._event=null,s.prototype._touching=!1,s.prototype._clearRequestTimeout=function(e){e&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(e.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(e.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(e.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(e.value):clearTimeout(e.value))},s.prototype._requestTimeout=function(e,t){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return{value:window.setTimeout(e,t)};var n=(new Date).getTime(),i={};return i.value=requestAnimFrame((function o(){(new Date).getTime()-n>=t?e.call():i.value=requestAnimFrame(o)})),i},s.prototype._clearLongPressTimer=function(){this._clearRequestTimeout(this._timerHandle),this._timerHandle=null},s.prototype._cancelEvent=function(e){e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation()},s.prototype._mouseDownHandler=function(e){if(e.defaultPrevented)return void this._clearLongPressTimer();let{clientX:t,clientY:n}=e;"touchstart"===e.type&&e.changedTouches&&e.changedTouches[0]&&({clientX:t,clientY:n}=e.changedTouches[0]),this._startX=t,this._startY=n,this._startLongPressTimer(e)},s.prototype._startLongPressTimer=function(e){this._clearLongPressTimer(),this._event=e;var t=e.target,n=parseInt(t.getAttribute("data-long-press-delay")||r.LONG_PRESS_TIME_OUT,10);this._timerHandle=this._requestTimeout(this._fireLongPressEvent.bind(this),n)},s.prototype._fireLongPressEvent=function(){this._clearLongPressTimer();var e=this._event.target,t=this._isTouchDevice?this._event.touches[0].clientX:this._event.clientX,n=this._isTouchDevice?this._event.touches[0].clientY:this._event.clientY,i=e.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:t,clientY:n}})),o=this._event.target.parentElement&&this._event.target.parentElement.className&&-1===this._event.target.parentElement.className.indexOf("g-scene-widget");if(i&&o){const e=t=>{t.isTrusted&&(document.removeEventListener("touchend",e,!0),document.removeEventListener("mouseup",e,!0),this._cancelEvent(t))};document.addEventListener("touchend",e,!0),document.addEventListener("mouseup",e,!0)}},s.prototype.startup=function(){if(this._isTouchDevice=o.GPlatform.constructor.isTouchDevice,this._mouseDown=this._isTouchDevice?"touchstart":"mousedown",this._mouseUp=this._isTouchDevice?"touchend":"mouseup",this._mouseMove=this._isTouchDevice?"touchmove":"mousemove",document.addEventListener(this._mouseUp,this._clearLongPressTimer.bind(this),!0),document.addEventListener(this._mouseMove,this._mouseMoveHandler.bind(this),!0),document.addEventListener("wheel",this._clearLongPressTimer.bind(this),!0),document.addEventListener("scroll",this._clearLongPressTimer.bind(this),!0),document.addEventListener(this._mouseDown,this._mouseDownHandler.bind(this)),this._isTouchDevice&&o.GPlatform.webBrowser===o.GPlatform.constructor.WebBrowser.Safari){const e=!(0,a.isPassiveSupported)()||{passive:!0,capture:!0};document.addEventListener("touchstart",this._documentTouchStart.bind(this),e),document.addEventListener("touchend",this.documentTouchEnd.bind(this),e),document.addEventListener("touchcancel",this.documentTouchEnd.bind(this),e),document.addEventListener("mousedown",this._documentMouseDown.bind(this),!0)}},s.prototype._documentTouchStart=function(e){e.isTrusted&&(this._touching=!0)},s.prototype.documentTouchEnd=function(e){e.isTrusted&&(this._touching=!1)},s.prototype._documentMouseDown=function(e){e.isTrusted&&this._touching&&e.cancelable&&e.stopImmediatePropagation()},s.prototype._mouseMoveHandler=function(e){if("touchmove"===e.type){const{clientX:t,clientY:n}=e.changedTouches[0];if(Math.abs(t-this._startX)<r.MIN_TOUCH_MOVE_DISTANCE&&Math.abs(n-this._startY)<r.MIN_TOUCH_MOVE_DISTANCE)return}this._clearLongPressTimer()},s.prototype.toString=function(){return"[Object GLongPressEvent]"},(new s).startup(),e.exports=s},function(e,t,n){n(1566),n(1567),n(1568),n(1569),n(1571),n(1572),n(1573),n(1574),n(1575),n(1576),n(1577),n(1580),n(1581),n(1583),n(1584),n(1585),n(1586),n(1587),n(1588),n(1589),n(1590),n(1591),n(1592),n(1593),n(1594),n(1147),n(1595),n(1596),n(1597),n(765),n(1598),n(1599),n(1600),n(1601),n(1602),n(1220),n(1603),n(1175),n(1604),n(1605),n(1606)},function(e,t,n){"use strict";var i=n(17),o=n(16),r=i(n(1223)),a=i(n(1227)),s={init:function(e){e=$.extend({selector:null,submitCallback:null,noDblClickEdit:!1},e);var t=this;return this.each((function(){if($(t).data("gautoedit",{options:e,input:null}),!e.noDblClickEdit){var n=$(t).data("gautoedit");$(t).on("dblclick",(function(e){s.open.call(t,n)}))}}))},open:function(e){var t=this,n=$(this);e.input&&s.close.call(this,e);var i,l=e.options.containerSelector?n.find(e.options.containerSelector):e.options.getContainer&&"function"==typeof e.options.getContainer?e.options.getContainer():n,c=e.options.textSelector?n.find(e.options.textSelector).text():l.text(),d=l.offset();e.value=c,e.options.textarea?(i=$("<textarea>"),e.options.textareaResizable||i.css({resize:"none"})):i=$("<input>").attr("type","text"),e.options.style&&"object"==typeof e.options.style&&i.css(e.options.style),gDesigner.isTouchEnabled()&&document.addEventListener("click",(function n(i){$(i.target).hasClass("g-auto-edit")||(document.removeEventListener("click",n,!0),s.submit.call(t,e))}),!0),e.input=i.css({position:"absolute",left:d.left+"px",top:d.top+"px",width:l.outerWidth()+"px",height:l.outerHeight()+"px"}).addClass("g-auto-edit").val(e.value).on("blur",()=>{s.submit.call(t,e)}).on("keydown",n=>{if(o.GKey.translateCode(n.code)===o.GKey.Constant.TAB){s.submit.call(t,e);const i=n.shiftKey?a.default.Type.Previous:a.default.Type.Next;return gDesigner.executeAction("".concat(a.default.ID,".").concat(i),[a.default.Mode.Focus]),gDesigner.executeAction(r.default.ID),!1}}).on("keyup",(function(n){switch(o.GKey.translateKey(n.keyCode)){case o.GKey.Constant.ENTER:s.submit.call(t,e);break;case o.GKey.Constant.ESC:s.close.call(t,e)}})).appendTo($("body")).focus().select()},submit:function(e){var t=$(this),n=e.input?e.input.val():null;s.close.call(this,e),n&&e.value!==n&&(e.options.submitCallback?e.options.submitCallback.call(this,n):t.trigger("submitvalue",n))},close:function(e){$(this);e.input&&(e.input.remove(),e.input=null,e.value=null)}};$.fn.gAutoEdit=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):s.init.apply(this,arguments)}},function(e,t,n){"use strict";n(28);var i=n(1);var o={init:function(e){e=$.extend({},e);const t=[{group:null,options:[{type:i.GPaintCanvas.BlendMode.Normal,name:i.GLocale.getValue("GPaintCanvas","blend.normal"),isCompatible:!0}]},{group:i.GLocale.getValue("GAppearanceProperties","text.darken-image"),options:[{type:i.GPaintCanvas.BlendMode.Darken,name:i.GLocale.getValue("GPaintCanvas","blend.darken"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Multiply,name:i.GLocale.getValue("GPaintCanvas","blend.multiply"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.ColorBurn,name:i.GLocale.getValue("GPaintCanvas","blend.colorburn"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Subtract,name:i.GLocale.getValue("GPaintCanvas","blend.subtract"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.LinearBurn,name:i.GLocale.getValue("GPaintCanvas","blend.linearburn"),isCompatible:!1}]},{group:i.GLocale.getValue("GAppearanceProperties","text.lighten-image"),options:[{type:i.GPaintCanvas.BlendMode.Lighten,name:i.GLocale.getValue("GPaintCanvas","blend.lighten"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Screen,name:i.GLocale.getValue("GPaintCanvas","blend.screen"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.ColorDodge,name:i.GLocale.getValue("GPaintCanvas","blend.colordodge"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.LinearDodge,name:i.GLocale.getValue("GPaintCanvas","blend.lineardodge"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.Add,name:i.GLocale.getValue("GPaintCanvas","blend.add"),isCompatible:!1}]},{group:i.GLocale.getValue("GAppearanceProperties","text.boost-contrast"),options:[{type:i.GPaintCanvas.BlendMode.Overlay,name:i.GLocale.getValue("GPaintCanvas","blend.overlay"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.SoftLight,name:i.GLocale.getValue("GPaintCanvas","blend.softlight"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.HardLight,name:i.GLocale.getValue("GPaintCanvas","blend.hardlight"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.VividLight,name:i.GLocale.getValue("GPaintCanvas","blend.vividlight"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.LinearLight,name:i.GLocale.getValue("GPaintCanvas","blend.linearlight"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.PinLight,name:i.GLocale.getValue("GPaintCanvas","blend.pinlight"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.HardMix,name:i.GLocale.getValue("GPaintCanvas","blend.hardmix"),isCompatible:!1}]},{group:i.GLocale.getValue("GAppearanceProperties","text.adjust-colors"),options:[{type:i.GPaintCanvas.BlendMode.Hue,name:i.GLocale.getValue("GPaintCanvas","blend.hue"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Saturation,name:i.GLocale.getValue("GPaintCanvas","blend.saturation"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Color,name:i.GLocale.getValue("GPaintCanvas","blend.color"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Luminosity,name:i.GLocale.getValue("GPaintCanvas","blend.luminosity"),isCompatible:!0}]},{group:i.GLocale.getValue("GAppearanceProperties","text.invert-colors"),options:[{type:i.GPaintCanvas.BlendMode.Difference,name:i.GLocale.getValue("GPaintCanvas","blend.difference"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Exclusion,name:i.GLocale.getValue("GPaintCanvas","blend.exclusion"),isCompatible:!0},{type:i.GPaintCanvas.BlendMode.Divide,name:i.GLocale.getValue("GPaintCanvas","blend.divide"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.Power,name:i.GLocale.getValue("GPaintCanvas","blend.power"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.Harmonic,name:i.GLocale.getValue("GPaintCanvas","blend.harmonic"),isCompatible:!1},{type:i.GPaintCanvas.BlendMode.Sin,name:i.GLocale.getValue("GPaintCanvas","blend.sin"),isCompatible:!1}]}];return this.each((function(){const e=$(this);for(let n=0;n<t.length;++n){let i=e;const{group:o,options:r}=t[n];o&&(i=$('<optgroup label="'+o+'"></optgroup>'),e.append(i)),r.forEach(e=>{let{type:t,name:n,isCompatible:o}=e;i.append($("<option></option>").attr("value",t).text("".concat(n).concat(o?"":" *")))})}}))}};$.fn.gBlendMode=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";n(19),n(24);var i=n(1),o=null;function r(e){for(var t=0;t<o.length;++t)if(o[t].type===e)return o[t].icon;return null}function a(e){for(var t=0;t<o.length;++t)$('button[data-corner-type="'+o[t].type+'"]').toggleClass("g-active",o[t].type===e)}var s={init:function(e){return e=$.extend({rotate:0},e),o||(o=[{type:i.GPathBase.CornerType.Rounded,title:i.GLocale.get(new i.GLocaleKey("GPathBase","corner.rounded")),icon:"gravit-icon-corner-rounded"},{type:i.GPathBase.CornerType.InverseRounded,title:i.GLocale.get(new i.GLocaleKey("GPathBase","corner.inverse-rounded")),icon:"gravit-icon-corner-inverse-rounded"},{type:i.GPathBase.CornerType.Bevel,title:i.GLocale.get(new i.GLocaleKey("GPathBase","corner.bevel")),icon:"gravit-icon-corner-bevel"},{type:i.GPathBase.CornerType.Inset,title:i.GLocale.get(new i.GLocaleKey("GPathBase","corner.inset")),icon:"gravit-icon-corner-inset"},{type:i.GPathBase.CornerType.Fancy,title:i.GLocale.get(new i.GLocaleKey("GPathBase","corner.fancy")),icon:"gravit-icon-corner-fancy"}]),this.each((function(){var t=this,n=$(this).data("gcornertype",{cornerType:null,notOverlay:e.notOverlay,rotate:e.rotate}),r=function(){for(var r=[],a=100/o.length,l=0;l<o.length;++l)r.push({width:Math.round(a)+"%",content:$("<button></button>").addClass("g-flat").toggleClass("g-active",o[l].type===n.data("gcornertype").cornerType).attr("data-corner-type",o[l].type).attr("data-title",o[l].title).append($("<span></span>").addClass(o[l].icon).css("transform","rotate("+e.rotate+"deg)")).on("click",(function(){var o=$(this).attr("data-corner-type");s.value.call(t,o),n.trigger("cornertypechange",o);var r="unkn",a=Object.keys(i.GPathBase.CornerType);for(var l of a)if(o===i.GPathBase.CornerType[l]){r=l;break}gDesigner.stats("cornertypes_click_change",r),e.notOverlay||c.gOverlay("close")}))});var c=$("<div></div>").css("width",e.notOverlay?"100%":"200px").gPropertyRow({columns:r});e.notOverlay?n.append(c):c.on("open",(function(){n.trigger("open")})).on("close",(function(){n.trigger("close")})).gOverlay({releaseOnClose:!0,clazz:"corner-picker-overlay"}).gOverlay("open",t)};e.notOverlay?r():n.append("<span></span>").on("click",(function(){gDesigner.stats("cornertypes_click_open"),r()}))}))},value:function(e){var t=$(this),n=t.data("gcornertype");return arguments.length?(n.cornerType=e,n.notOverlay?(t.find("."+r(n.cornerType)),a(n.cornerType)):t.find("span").attr("class",r(n.cornerType)).css("transform","rotate("+n.rotate+"deg)"),this):n.cornerType},update:function(e){a(e)}};$.fn.gCornerTypePicker=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):s.init.apply(this,arguments)}},function(e,t,n){"use strict";n(3);var i=n(43),o=n(1),r=n(16);const a=n(1570);function s(){}o.GObject.inheritAndMix(s,o.GObject);var l={init:function(e){return e=$.extend({},e),this.each((function(){var t=this,n=$(this);n.addClass("g-button").data("g-eye-dropper",{picker:null,documentMove:null,documentMouseDown:null,documentKeyDown:null,rgba:null}).attr("data-title",o.GLocale.get(new o.GLocaleKey("GEyeDropper","text.tooltip"))).append($("<span></span>").addClass("gravit-icon-picker")).on("click",(function(i){n.closest(".g-disabled").length||(e.onClick?e.onClick.call(this):gDesigner.stats("eyedropper_click_pick"),i.stopPropagation(),i.preventDefault(),l.setActive.call(t,!l.isActive.call(t),i.pageX,i.pageY))}))}))},isActive:function(){var e=$(this).data("g-eye-dropper");return!!e&&!!e.picker},setValue:function(e){const t=$(this),n="string"==typeof e?e:o.GPattern.asCSSBackground(e);t.find(".g-eye-dropper-preview-color-difference").find(".current").css({background:n});const i=t.data("g-eye-dropper")||{};i.currentColor=n,t.data("g-eye-dropper",i)},setActive:function(e,t,n){if(e!==l.isActive.call(this)){var s=$(this),c=s.data("g-eye-dropper"),d=function(){gDesigner.getToolManager().removeEventListener(i.GToolManager.ToolChangedEvent,d,this),$(".g-eye-dropper-picker").remove()}.bind(this);if(e){var u=gDesigner.getWindows().getActiveWindow();if(!u)return;s.addClass("g-active");for(var p=u.getView().getSceneCanvas().getBitmap().getHTMLElement(!0),g=o.GPaintCanvas.getScreenDPI(),h=$("<canvas></canvas>").attr({width:135,height:135}).addClass("g-cursor-pixel g-eye-dropper-preview"),f=$("<span></span>").addClass("g-eye-dropper-preview-color"),m=$("<span/>").addClass("g-eye-dropper-preview-color-difference").append($("<div/>").addClass("color-preview").addClass("current").css({background:c.currentColor})).append($("<div/>").addClass("color-preview").addClass("new")),y=$("<div/>").addClass("g-eye-dropper-color-pointer"),v=h[0].getContext("2d"),_=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled"],b=0;b<_.length;++b){var w=_[b];if(CanvasRenderingContext2D.prototype.hasOwnProperty(w)){v[w]=!1;break}}c.picker=$("<div></div>").addClass("g-eye-dropper-picker g-cursor-pixel").append(h).append(f).append(m).append(y).appendTo($("body"));var C=function(e){return 1==e.length?"0"+e:e};function E(e,t){if(v.setTransform(1,0,0,1,0,0),u.viewContainsMouse(e,t)){var n=e*g,i=t*g;n=Math.max(0,Math.min(n,p.width)),i=Math.max(0,Math.min(i,p.height));var r=p.getContext("2d").getImageData(n,i,1,1).data,a=C(r[0].toString(16))+C(r[1].toString(16))+C(r[2].toString(16));a=a.toUpperCase(),c.rgba=r;const o=gDesigner.isTouchEnabled()?10:5;h.css("box-shadow","0 0 0 ".concat(o,"px rgb(")+r[0]+","+r[1]+","+r[2]+")"),f.text("R:"+r[0]+" G:"+r[1]+" B:"+r[2]+" #"+a),f.css({display:"block",top:t+5+"px",left:e-55+"px"}),m.find(".new").css({background:"#"+a}),y.css({display:"block",top:t-5+"px",left:e-5+"px"}),m.css({display:"block",top:t-76+"px",left:e-78+"px"}),v.clearRect(0,0,135,135),v.drawImage(p,e*g-8,t*g-8,16,16,0,0,135,135)}else c.rgba=null,h.css("box-shadow",""),f.css({display:"none"}),m.css({display:"none"}),y.attr("style","display: none !important"),v.clearRect(0,0,135,135),v.fillStyle="rgba(0,0,0,0.75)",v.scale(.9,.9),v.fillText(o.GLocale.get(new o.GLocaleKey("GEyeDropper","text.preview")),10,72,135)}gDesigner.isTouchEnabled()&&(c.draggablePoint=new a(h.get(0),e=>{const t=h.get(0).getBoundingClientRect();let n=e.pageX,i=e.pageY;n-=t.width-8,i-=t.height-30,n+=8,i+=8,h.css({left:n+"px",top:i+"px"});const o=h.get(0).getBoundingClientRect(),r=o.left+o.width/2,a=o.top+o.height/2;E.call(this,r,a)},()=>{l.setActive.call(this,!1),c.rgba&&s.trigger("colorchange",[c.rgba])})),c.documentMove=function(e){if(gDesigner.isTouchEnabled())return;const t=e.pageX,n=e.pageY,i=h.get(0).getBoundingClientRect(),o=t-i.width/2+8,r=n-i.height/2+8;h.css({left:o+"px",top:r+"px"}),E.call(this,t,n)}.bind(this),c.documentMouseDown=function(e){gDesigner.isTouchEnabled()?l.isActive.call(this)?l.setActive.call(this,!1):l.setActive.call(this,!0):(l.setActive.call(this,!1),c.rgba&&s.trigger("colorchange",[c.rgba]))}.bind(this),c.documentKeyDown=function(e){r.GKey.translateKey(e.keyCode)===r.GKey.Constant.ESC&&l.setActive.call(this,!1)}.bind(this),"number"==typeof t&&"number"==typeof n&&(gDesigner.isTouchEnabled()?c.draggablePoint.moveTo(t,n,!0):c.documentMove({pageX:t,pageY:n})),document.addEventListener("keydown",c.documentKeyDown),document.addEventListener("mousedown",c.documentMouseDown),document.addEventListener("mousemove",c.documentMove),gDesigner.getToolManager().addEventListener(i.GToolManager.ToolChangedEvent,d,this)}else document.removeEventListener("keydown",c.documentKeyDown),document.removeEventListener("mousedown",c.documentMouseDown),document.removeEventListener("mousemove",c.documentMove),gDesigner.getToolManager().removeEventListener(i.GToolManager.ToolChangedEvent,d,this),c.picker.remove(),c.picker=null,c.documentKeyDown=null,c.documentMouseDown=null,c.documentMove=null,c.draggablePoint&&c.draggablePoint.unmount(),s.removeClass("g-active")}}};e.exports=s,$.fn.gEyeDropper=function(e){return l[e]?l[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):l.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(32);function o(e,t,n){this.element=e,this.mouseMoveCallback=t||i.fakeFunction,this.mouseUpCallback=n||i.fakeFunction,this.init()}o.prototype.init=function(){this._handleMouseDown=this._handleMouseDown.bind(this),this._onDragStart=this._onDragStart.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.element.addEventListener("mousedown",this._handleMouseDown),this.element.style.position="absolute"},o.prototype._updateElementOffset=function(e,t){const n=this.element.getBoundingClientRect();this._offsetX=e-n.left,this._offsetY=t-n.top},o.prototype._resetElementOffset=function(){this._offsetX=0,this._offsetY=0},o.prototype._hasElementOffset=function(){return!!this._offsetX&&!!this._offsetY},o.prototype._handleMouseDown=function(e){e.preventDefault(),e.stopPropagation(),this._resetElementOffset(),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),this.element.addEventListener("dragstart",this._onDragStart),this.moveTo(e.pageX,e.pageY)},o.prototype.moveTo=function(e,t,n){n?this._resetElementOffset():this._hasElementOffset()||this._updateElementOffset(e,t),this.mouseMoveCallback({elementX:e-this._offsetX,elementY:t-this._offsetY,centerX:e-this._offsetX/2,centerY:t-this._offsetY/2,pageX:e,pageY:t})},o.prototype._onMouseMove=function(e){this.moveTo(e.pageX,e.pageY)},o.prototype._onDragStart=function(){return!1},o.prototype._onMouseUp=function(e){this.unmount(),this.mouseUpCallback(e)},o.prototype.unmount=function(){document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),this.element.removeEventListener("mousedown",this._handleMouseDown),this.element.removeEventListener("dragstart",this._onDragStart)},e.exports=o},function(e,t,n){"use strict";var i=n(1),o=n(32),r=n(230),a=n(1007),s=n(1084),l=n(76);function c(){}i.GObject.inheritAndMix(c,i.GObject);var d=function(){return gContainer.getRuntime()!==l.Runtime.Browser&&gContainer.getRuntime()!==l.Runtime.Chrome&&gContainer.getRuntime()!==l.Runtime.PWA},u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;var a=$("<a></a>").data("provider",t).addClass("tablinks").append(i.GLocale.get(e)).on("click",o.watchDog.trap((function(t){n?gDesigner.stats("fonts_click_protab",i.GLocale.get(e,void 0,i.GLocaleLanguage.English)):gDesigner.stats("fonts_click_tab",i.GLocale.get(e,void 0,i.GLocaleLanguage.English));var o=$(t.target),a=o.closest(".tab");a.find(".tablinks").removeClass("active"),o.addClass("active");var s=o.data("provider");if(s)r.enableProviders([s]);else{var l=[];if(a.find(".tablinks:not(.active)").each((function(){var e=$(this).data("provider");e&&l.push(e)})),!d()){var c=gContainer.getSystemFontsProvider();c||l.push(c)}l.length&&r.disableProviders(l)}}),()=>!n,t=>{gDesigner.stats("fonts_nonprotriespro_protab",i.GLocale.get(e))},n)),s=$("<li></li>").addClass("tablink").gPro({pro:!!n,feature:n}).append(a);return s},p=function(e,t){if(e){var n=e.data("gfontsbutton");n&&n.fontList&&n.fontList.gFontsPanel("search",t,e.val())}};const g=function(){const e=$(this).data("gfontsbutton");e&&(e.fontListContainer&&e.fontListContainer.gOverlay("close",this),e.options&&e.options.closeCallback&&e.options.closeCallback.call(this))};var h=function(e){var t=$(e),n=t.data("gfontsbutton");if(!n.fontList){var o=$("<div></div>").addClass("header");n.fontList=$("<div></div>").on("mousedown",(function(e){n.mouseMoved=!1})).on("mousemove",(function(e){n.mouseMoved||(n.mouseMoved=!0)})).on("mouseup",(function(t){"_SPECIAL_"===t.target.name||"g-fonts-panel"===t.target.className||n.mouseMoved?n.mouseMoved=!1:gDesigner.isTouchEnabled()||g.call(e)})).gFontsPanel({preview:o,changeCallback:function(n){t.val(n.displayName||n.family);var i=t.data("gfontsbutton");i.tempFontFamily=n.displayName||n.family,i.options.assignFontCallback(""===n.family?null:n.family,t),setTimeout((function(){e.select()}),1),gDesigner.isTouchEnabled()&&g.call(e)}});var l=$("<div></div>").addClass("g-fonts-panel").addClass("no-overflow").append(function(e){var t=$("<ul></ul>").addClass("tab").append(u(new i.GLocaleKey("GFontsButton","text.web-fonts")));if(t.append(u(new i.GLocaleKey("GFontsButton","text.imported-fonts"),a,"font.import")),gContainer.supportsLocalFonts()&&t.append(u(new i.GLocaleKey("GFontsButton","text.system-fonts"),s)),d()){var n=gContainer.getSystemFontsProvider();n&&t.append(u(new i.GLocaleKey("GFontsButton","text.system-fonts"),n))}return t.find(".tablinks:first").trigger("click"),t}());n.fontListContainer=$("<div></div>"),n.fontListContainer.append(l);n.fontListContainer.append(n.fontList).gOverlay({releaseOnClose:!1,padding:!1,enterCallback:function(e){$(".g-fonts-panel").trigger("keydown",[e.which||e.keyCode])},clazz:"g-font-list-overlay"}).on("close",function(e,t,n){r.getInstance()&&r.getInstance().getLock()&&t()}.bind(e))}},f={getFontList:function(){var e=$(this).data("gfontsbutton");return e?(e.fontList||h(this),e.fontList):null},init:function(e){return this.each((function(){var t=this,n=$(this);e=$.extend({closeCallback:function(){},assignFontCallback:function(){}},e),n.data("gfontsbutton",{options:e,tempFontName:void 0,tempFontFamily:void 0,fontList:void 0,fontContainer:void 0,mouseMoved:!1}).on("focusin",(function(e){n.attr("type","text")})).on("focusout",(function(e){n.attr("type","button");var t=n.data("gfontsbutton").tempFontName;t&&t.length&&!n.val().length&&n.val(t)})).on("input",(function(e){p(n,n.val())})).on("keydown",(function(e){var i=n.data("gfontsbutton");if(i&&i.fontList){var o=i.fontList,r=i.fontListContainer,a=e.which||e.keyCode;40===a?o.gFontsPanel("selectLower"):38===a?o.gFontsPanel("selectUpper"):13===a&&r&&(r.gOverlay("close",t),n.data("gfontsbutton").options.closeCallback.call(t))}})).on("click",(function(e){gDesigner.stats("fonts_expand_textfield"),p(n,""),"text"!==n.attr("type")&&(n.attr("type","text"),t.select()),n.data("gfontsbutton").tempFontFamily=n.val();var i=n.data("gfontsbutton").fontList,o=n.data("gfontsbutton").fontListContainer;i?(o.gOverlay("open",t,t),i.gFontsPanel("refresh",!0)):(h(this),i=n.data("gfontsbutton").fontList,(o=n.data("gfontsbutton").fontListContainer).gOverlay("open",t,t),i.gFontsPanel("refresh"));var r=function(){i.gFontsPanel("selection",n.val()),i.gFontsPanel("focusCurrent"),n.select()};0===i.gFontsPanel("fontsLength")?setTimeout((function(){r()}),100):r()}))})),this}};e.exports=c,$.fn.gFontsButton=function(e){return f[e]?f[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):f.init.apply(this,arguments)}},function(e,t,n){"use strict";n(19),n(24),n(14),n(759),n(9);var i=n(1),o=n(32),r=n(1085),a=n(230);function s(e,t){var n=$(this);n.empty(),n.data("g-fonts-panel").lastPreviewPosition=0,l.call(this,e,t)}function l(e,t){var n=$(this),i=this,r=n.data("g-fonts-panel"),a=e.faces;if(a){var s=function(e,t,n){if(t&&"_SPECIAL_"===t.getAttribute("name"))e.stopPropagation();else{if(t&&!n&&(n=$(t).closest(".fonts-row").data("font")),n.special)return gDesigner.stats("fontspanel_click_deletefont",n.family),void e.stopPropagation();gDesigner.stats("fontspanel_click_setfont",n.family),p.selection.call(i,n.family),r.options.changeCallback&&r.options.changeCallback(n),e.preventDefault()}},l=null;t&&t.length&&(l=t);var u=[],g=[];for(let e=0;e<a.length;++e){const t=a[e];var h=$("<div></div>").addClass("fonts-row").data("font",t).on("mousedown",(function(e){gDesigner.isTouchEnabled()&&!e.originalEvent.isTrusted||s(e,e.target)})).on("click",e=>{gDesigner.isTouchEnabled()&&s(e,e.target)}).append($("<div></div>").addClass("info").text(t.displayname||t.family));u.push(h),t.cachedPreview?($("<div></div>").addClass("preview").append(t.cachedPreview).appendTo(h),r.lastPreviewPosition+=22):t.addPreviewCallback&&(t.row=h,g.push(t))}var f=0;if(l)for(let e=0;e<g.length;e++){const t=g[e];if((t.displayname||t.family).localeCompare(l)>=0){f=e;break}}(0,o.iterateAroundIndex)(g,f,e=>{e.addPreviewCallback.call(e,function(e){this.cachedPreview||(e instanceof Element||e instanceof jQuery)&&(this.cachedPreview=e,r.lastPreviewPosition+=22,function(e,t){null===c&&(c=setTimeout((function(){for(var e of d)e.where.append(e.what);d=[],c=null})));d.push({what:e,where:t})}($("<div></div>").addClass("preview").append(e),this.row))}.bind(e))}),n.append(u),n.on("keydown",(function(e,t){if(13===(t||e.which||e.keyCode)){var n=$(".g-fonts-panel").find(".fonts-row:hover").data("font");n&&n.family&&s(e,null,n)}}))}}var c=null,d=[];function u(e,t){var n=this,i=$(this).data("g-fonts-panel"),o=i.manager;e!==i.previousQuery&&(i.previousQuery=e,o.query(e=>{s.call(n,e,t)},e))}var p={init:function(e){return e=$.extend({search:null,preview:null,changeCallback:null},e),this.each((function(){var t=this,n=gDesigner.getWorkspace().getFontManager().getDefaultFont().getFamily(),i=a.getInstance(),o=$(this).empty().addClass("g-fonts-panel").data("g-fonts-panel",{options:e,lastPreviewPosition:0,search:e.search||null,changeCallback:e.changeCallback||null,manager:i});i.addEventListener(a.ResetEvent,()=>{o.addClass("g-loading"),i.query(e=>{s.call(t,e,n),o.removeClass("g-loading"),n=void 0},"%")}),o.on("scroll",(function(){var e=o.scrollTop(),n=o.data("g-fonts-panel"),i=n.lastPreviewPosition,r=o.height(),a=n.manager;a.isLoading()||e/Math.max(1,i-r)>.7&&a.loadMore(e=>{l.call(t,e,"Open Sans")},n.search)})).on("focusin",(function(e){e.preventDefault()}))}))},selection:function(e){var t=this,n=$(this),i=n.data("g-fonts-panel");if(!arguments.length){var o=n.find(".fonts-row.g-selected");return o.length?o.data("font").family:null}return n.find(".fonts-row").each((function(o,r){var a=$(r),s=a.data("font").family===e;if(a.toggleClass("g-selected",s),s){var c=i.manager;if(!a.data("font").cachedPreview||o>0&&!$(n.find(".fonts-row")[o-1]).data("font").cachedPreview)for(var d=c.loadMore(l.bind(t),i.search);0!==d&&d<o;){if(d>=(d=c.loadMore(l.bind(t),i.search)))break}}})),this},selectUpper:function(){var e=$(this),t=e.data("g-fonts-panel"),n=e.find(".fonts-row.g-selected").prev().data("font");n||(n=e.find(".fonts-row").filter((function(){return $(this).position().top<=$(this).outerHeight()})).data("font")),n&&(p.selection.call(this,n.family),p.focusCurrent.call(this),t.options.changeCallback&&t.options.changeCallback(n))},selectLower:function(){var e=$(this),t=e.data("g-fonts-panel"),n=e.find(".fonts-row.g-selected").next().data("font");n||(n=e.find(".fonts-row").filter((function(){return $(this).position().top<=$(this).outerHeight()})).data("font")),n&&(p.selection.call(this,n.family),p.focusCurrent.call(this),t.options.changeCallback&&t.options.changeCallback(n))},search:function(e,t){var n=$(this),i=n.data("g-fonts-panel");return arguments.length?(e!==i.search&&(i.search=e,p.refresh.call(this,!1,t)),this):i.search},focusCurrent:function(){var e,t=$(this),n=t.find(".fonts-row.g-selected"),i=0;n&&n.position()&&(n.position().top>t.height()-n.outerHeight()?(e=n.index(),t.find(".fonts-row:lt("+e+")").each((function(){i+=$(this).outerHeight(!0)})),t.scrollTop(i-t.height()+n.outerHeight(!0))):n.position().top<0&&(e=n.index(),t.find(".fonts-row:lt("+e+")").each((function(){i+=$(this).outerHeight(!0)})),t.scrollTop(i)))},reload:function(e){$(this).data("g-fonts-panel").previousQuery=null,p.refresh.call(this,!1,e)},refresh:function(e,t){var n=$(this),o=n.data("g-fonts-panel"),r=o.search?o.search+"%":"%";r!==o.previousQuery&&(n.empty(),o.lastPreviewPosition=0,n.text(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.loading"))+"..."),e&&(o.search=null),u.call(this,r,t))},stylesForFont:function(e,t){var n=null,i=$(this).data("g-fonts-panel").manager;if(!i.isCacheEmpty()){var o=i.searchFamilyInCache(e);if(o&&o.fonts&&o.fonts.length){n=[];for(var r=0;r<o.fonts.length;r++)n.push(o.fonts[r].style)}return n}t&&i.query(t,"%",!0)},stylesForWeight:function(e,t,n,i){var o=null,r=$(this).data("g-fonts-panel").manager;if(!r.isCacheEmpty()){var a=r.searchFamilyInCache(t);if(a&&a.fonts&&a.fonts.length){o=[];for(var s=0;s<a.fonts.length;s++)a.fonts[s].weight===e&&(i&&a.fonts[s].hasOwnProperty("family")?a.fonts[s].family===t&&o.push(a.fonts[s].style):o.push(a.fonts[s].style))}return o}n&&r.query(n,"%",!0)},subfamiliesForWeight:function(e,t,n){var i=null,o=$(this).data("g-fonts-panel").manager;if(!o.isCacheEmpty()){var r=o.searchFamilyInCache(t);if(r&&r.fonts&&r.fonts.length){i=[];for(var a=0;a<r.fonts.length;a++)r.fonts[a].weight===e&&i.push({realName:r.fonts[a].family||r.family,subFamily:r.fonts[a].subfamily})}return i}n&&o.query(n,"%",!0)},weightsForFont:async function(e,t,n){var i=null,o=$(this).data("g-fonts-panel").manager;if(!o.isCacheEmpty()){var a=o.searchFamilyInCache(e);if(a.isLocalFont&&(a.fonts=await(0,r.parseNativeFonts)(a.fonts),delete a.isLocalFont),a&&a.fonts&&a.fonts.length){i=[];for(var s=0;s<a.fonts.length;s++)n&&a.fonts[s].hasOwnProperty("family")?a.fonts[s].family===e&&i.push(a.fonts[s].weight):i.push(a.fonts[s].weight)}return i}t&&o.query(t,"%",!0)},fontDisplayName:function(e,t){var n=$(this).data("g-fonts-panel").manager;if(!n.isCacheEmpty()){var i=n.searchFamilyInCache(e);return i&&(i.displayname||i.family)||e}t&&n.query(t,"%",!0)},fontsLength:function(){return $(this).find(".fonts-row").length}};$.fn.gFontsPanel=function(e){return p[e]?p[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):p.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(17);n(3),n(14),n(29),n(168);var o=n(1),r=n(16);n(1143);var a=i(n(1162)),s={value:function(e){var t=$(this),n=t.data("ginputbox");function i(e){if(n){var t=null;"undefined"!=typeof gDesigner&&gDesigner.getActiveDocument()&&(t=gDesigner.getActiveDocument().getScene().getProperty("ut"));var i=n.options&&n.options.postfix!==t?n.options.postfix:null;if(e&&e.length&&n&&i){var o=e.lastIndexOf(i);o>=0&&(e=e.substr(0,o))}}return e}function r(e){if(n){var t=""===(e=i(e)),r=t?null:o.GLength.parseEquationValue(e),a=n.options?n.options.minValue:null,s=n.options?n.options.maxValue:null;"number"!=typeof a&&"number"!=typeof s||("number"==typeof r&&isFinite(r)||t&&n.options.allowEmptyValue?"number"==typeof a&&null!==r&&r<a?e=a.toString():"number"==typeof s&&null!==r&&r>s&&(e=s.toString()):e="number"==typeof a?a.toString():s.toString())}return e}function a(e){if((e||0===e)&&(e=(e=e.toString()).replace(",",".")),n){if(e=r(e),n.options.allowEmptyValue||e||(e="0"),n.options.replace&&null!==n.options.replace.oldValue&&e===n.options.replace.oldValue)return t.val(n.options.replace.newValue);var i=null;"undefined"!=typeof gDesigner&&gDesigner.getActiveDocument()&&(i=gDesigner.getActiveDocument().getScene().getProperty("ut"));var o=n.options&&n.options.postfix!==i?n.options.postfix:null;e&&e.length&&o&&e.substr(e.length-o.length)!==o&&(e+=o)}var a=t[0];return a&&(a.value=e),t}if(arguments.length)return a(e);var s=t.val();s=i(s);var l=""===s,c=l?null:o.GLength.parseEquationValue(s);return s=r(s),n&&(n.options.allowEmptyValue||s&&null!==c&&isFinite(c))||(s="0"),s},increment:function(e,t,n){var i=$(this),r=i.data("ginputbox"),a=parseFloat(o.GUtil.parseNumber(s.value.call(this)));if("number"==typeof a&&!isNaN(a)&&r){var l,c=e?r.options.fastIncrementValue:t&&"%"!==r.options.postfix?r.options.slowIncrementValue:r.options.incrementValue,d=2;"undefined"!=typeof gDesigner&&gDesigner.getActiveDocument()&&(l=gDesigner.getActiveDocument().getScene().getProperty("ut"),d=gDesigner.getActiveDocument().getScene().getOptimalDecimalsCount()),l!==o.GLength.Unit.IN&&l!==o.GLength.Unit.CM||r.options.postfix!==l&&null!==r.options.postfix||r.fixedIncrement||(c*=.1),c<1&&0==d&&(c=1),n?a-=c:a+=c,s.value.call(this,o.GUtil.formatNumber(a,d)),i.change()}},mousemoveIncrement:function(e,t,n,i){var r=$(this),a=r.data("ginputbox");if("number"==typeof n&&!isNaN(n)&&a){var l,c=e?a.options.fastIncrementValue*i:t&&"%"!==a.options.postfix?i*a.options.slowIncrementValue:i,d=2;"undefined"!=typeof gDesigner&&gDesigner.getActiveDocument()&&(l=gDesigner.getActiveDocument().getScene().getProperty("ut"),d=gDesigner.getActiveDocument().getScene().getOptimalDecimalsCount()),l!==o.GLength.Unit.IN&&l!==o.GLength.Unit.CM||a.options.postfix!==l&&null!==a.options.postfix||a.fixedIncrement||(c*=.1),c<1&&0==d&&(c=1);var u=n+c;return s.value.call(this,o.GUtil.formatNumber(u,d)),r.change(),u}},onFocusIn:function(){var e=$(this);e.data("ginputbox").receivingFocus=!0,e.css("border","1px solid rgba(215, 46, 99, 0.3)")},onFocusOut:function(){var e=$(this);e.data("ginputbox").insideClicked=!1,e.data("ginputbox").leftMouseMoved=!1,e.css("border","")},requestFocus:function(){var e=$(this),t=e.data("ginputbox");t.receivingFocus&&(t.options.selectOnFocus&&e.select(),t.receivingFocus=!1)},onMouseEnter:function(){var e=$(this),t=e.data("ginputbox");!t.insideClicked&&t.options.mousemoveIncrement&&(e.css("cursor","url(assets/cursor/cursor-scrub.svg) 16 16, auto"),e.css("border","1px solid rgba(215, 46, 99, 0.3)"))},onMouseLeave:function(){var e=$(this),t=e.data("ginputbox");t.leftMouseMoved||t.insideClicked||!t.options.mousemoveIncrement||(e.css("cursor",""),e.css("border",""))},leftMouseDown:function(e){var t=$(this),n=t.data("ginputbox");if(n.strValue=t.val(),!n.insideClicked&&n.options.mousemoveIncrement){t.css("border","1px solid rgba(215, 46, 99, 0.3)"),n.leftMouseMoved=!1;var i=parseFloat(o.GUtil.parseNumber(s.value.call(this)));""===n.strValue&&isNaN(i)&&(i=0);var a=null,l=t.scrollParent();"undefined"!=typeof gDesigner&&l&&gDesigner.isTouchDevice()&&l.css("overflow-y","hidden");var c=function(e){e.originalEvent.cancelable&&e.preventDefault();var o=0,l=e.pageY||e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&e.originalEvent.changedTouches[0].pageY;null===a?($("html").css("cursor","url(assets/cursor/cursor-scrub.svg) 16 16, auto"),$("html").css("user-select","none"),$("body").css("pointer-events","none"),n.leftMouseMoved=!0,a=l):(o=a-l,a=l),i=s.mousemoveIncrement.call(t[0],r.GPlatform.modifiers.shiftKey||e.shiftKey,r.GPlatform.modifiers.optionKey||e.altKey,i,o)};t.on("touchmove",c),$("html").bind("mousemove",c),$("html").bind("mouseup",(function e(i){$("body").css("pointer-events",""),$("html").css("cursor",""),$("html").css("user-select",""),$("html").unbind("mousemove",c),$("html").unbind("mouseup",e),t.off("touchmove",c),"undefined"!=typeof gDesigner&&!gDesigner.isTouchDevice()&&n.leftMouseMoved&&t.blur(),"undefined"!=typeof gDesigner&&gDesigner.isTouchDevice()&&(l&&l.css("overflow-y","auto"),t.is(":focus")||t.css("border",""))}))}},leftMouseUp:function(){var e=$(this),t=e.data("ginputbox");t.options.mousemoveIncrement&&(t.leftMouseMoved||(t.insideClicked=!0,e.css("cursor","")),"undefined"!=typeof gDesigner&&gDesigner.isTouchDevice()&&t.leftMouseMoved&&t.strValue===e.val()&&e.trigger("focus"))},isInit:function(){return!!$(this).data("ginputbox")},init:function(e){return this.each((function(){var t=this,n=$(this);e=$.extend({selectOnFocus:!0,triggerChangeOnEnter:!0,keyIncrement:!0,wheelIncrement:!0,mousemoveIncrement:!0,incrementValue:1,fastIncrementValue:10,slowIncrementValue:.1,fixedIncrement:!1,minValue:null,maxValue:null,postfix:null},e),n.data("ginputbox",{options:e,receivingFocus:!1,enterKeyValue:void 0,insideClicked:!1,leftMouseMoved:!1,strValue:void 0}).prop("draggable",!1),e.created||n.on("change",(function(e){s.value.call(t,n.val())})).on("focusin",(function(e){s.onFocusIn.call(t)})).on("focusout",(function(e){s.onFocusOut.call(t)})).on("click",(function(e){s.requestFocus.call(t)})).on("wheel",(function(e){if(n.data("ginputbox").options.wheelIncrement&&n.is(":focus")){e.preventDefault();var i=0!=e.originalEvent.deltaX?e.originalEvent.deltaX:e.originalEvent.deltaY;s.increment.call(t,r.GPlatform.modifiers.shiftKey||e.shiftKey,r.GPlatform.modifiers.optionKey||e.altKey,i>0)}})).on("keydown",(function(e){var i=n.data("ginputbox");38!=e.keyCode&&40!==e.keyCode||!i.options.keyIncrement||(e.preventDefault(),s.increment.call(t,r.GPlatform.modifiers.shiftKey||e.shiftKey,r.GPlatform.modifiers.optionKey||e.altKey,40===e.keyCode),n.trigger("focus")),13===e.keyCode&&i.options.triggerChangeOnEnter&&n.blur()})).on("mouseenter",(function(e){a.default.isEnabled()&&(e.preventDefault(),s.onMouseEnter.call(t))})).on("mouseleave",(function(e){a.default.isEnabled()&&s.onMouseLeave.call(t)})).on("mousedown",(function(e){a.default.isEnabled()&&1===e.which&&(s.leftMouseDown.call(t,e),$(this).parents(".properties-panel").addClass("noscroll"))})).on("mouseup",(function(e){a.default.isEnabled()&&1===e.which&&(s.leftMouseUp.call(t),$(this).parents(".properties-panel").removeClass("noscroll"))}))})),this}};$.fn.gInputBox=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):s.init.apply(this,arguments)}},function(e,t,n){"use strict";n(28);var i=n(1);const o=n(217),r=n(397);var a={value:function(e){return arguments.length>0?($(this).find("input").gInputBox("value",e),this):$(this).find("input").gInputBox("value")},init:function(e){return this.each((function(){e=i.GUtil.extend({list:[]},e);const t=new o;e.list.map(e=>"object"!=typeof e?{title:e,data:e}:e).forEach(e=>{let{title:n,data:i}=e;return t.createAddItem(n).setData(i)});const n=$(this);n.addClass("g-input-select").append($("<input/>").attr("type","text").gInputBox(e).on("change",()=>n.trigger("change"))).append($("<button></button>").css("display",e.list.length?"":"none").on("click",e=>{t.open(e.target,r.Position.Right_Bottom,r.Position.Right_Bottom,t=>{$(e.target).closest(".g-input-select").find("input").val(t.getData()).trigger("change")})}))})),this}};$.fn.gInputSelect=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gInputSelect"):a.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1),o={value:function(e){const t=$(this);return arguments.length>0?(t.prop("checked",!!e),this):o.isChecked.call(this)},unmount(){const e=$(this);return e.removeClass("g-checkbox-slider"),e},isChecked:function(){return $(this).is(":checked")},init:function(e){return this.each((function(){const t=$(this);e=i.GUtil.extend({onChange:function(){}},e);const n=o.isChecked.call(this);t.addClass("g-checkbox-slider").prop("type","checkbox").prop("checked",n).toggleClass("checked",n).on("change",(function(t){const n=o.isChecked.call(this);$(this).toggleClass("checked",n),e.onChange(n)}))})),this}};$.fn.gCheckboxSlider=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gCheckboxSlider"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1),o={value:function(e){var t=o.options.call(this).unit;if(arguments.length>0){if(e){var n=gDesigner.getActiveDocument(),r=n?n.getScene():null;$(this).gInputBox("value",i.GUtil.formatNumber(e.toUnit(t),r?r.getOptimalDecimalsCount(t):2))}else $(this).val("");return this}var a=i.GLength.parseEquation($(this).val(),t);return a?a.convert(t):new i.GLength(0,t)},list:function(e){o.options.call(this).list=e},options:function(){return $(this).data("ginputbox").options},init:function(e){return(e=$.extend({unit:i.GLength.Unit.PX,created:!1},e)).postfix=e.unit,this.each((function(){var t=$(this),n=this;$(this).hasClass("g-unitbox")?e.created=!0:t.addClass("g-unitbox").attr("type","text"),t.gInputBox("isInit")||t.gInputBox(e);var r=function(){let e=t.gInputBox("value"),n=$(".g-unitbox.option-list").find(".option-item");if(n.removeClass("g-selected"),e)for(let t=0;t<n.length;++t){let i=n[t];$(i).data("value")==e&&$(i).addClass("g-selected")}};t.on("change",(function(){r()})),e.list&&(t.unbind("click"),t.on("click",(function(a){gDesigner.stats("unitbox_"+(e.source||"")+"_button");for(var s=$("<div></div>").addClass("g-unitbox").addClass("option-list"),l=$("<div></div>"),c=0;c<e.list.length;c++)$("<div></div>").addClass("option-item").text(e.list[c]+" "+e.postfix).data("value",e.list[c]).on("mousedown",(function(){o.value.call(n,new i.GLength($(this).data("value"),e.unit)),t.trigger("change"),l.gOverlay("close")})).appendTo(s);l.append(s).gOverlay({releaseOnClose:!0,padding:!1,enterCallback:function(){var r=$(".g-unitbox.option-list").find(".option-item:hover");r.length>0&&(o.value.call(n,new i.GLength($(r).data("value"),e.unit)),t.trigger("change")),l.gOverlay("close")}}),l.css("min-width",t.outerWidth()),l.gOverlay("open",n),r(),t.gInputBox("requestFocus")})))})),this}};$.fn.gUnitBox=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(17);n(84),n(45),n(19),n(24);var o=n(43),r=n(1),a=n(16),s=n(32),l=n(56),c=n(1233),d=i(n(509)),u=i(n(118)),p=n(404).GVirtualTree,g=n(404).GVirtualTreeNodeNamed,{VTREE_FREE_HEIGHT:h,VTREE_FREE_HEIGHT_TOUCH:f}=n(12),m=n(403),y=["name"];function v(){}function _(e,t,n,i,o){var r=!0,a=$(this).data("glayerpanel");if(a.options.canDropCallback){for(var s=e.id?T.call(this,e.id):a.scene?a.scene.getActivePage():null,l=n?T.call(this,n.id):null,c=[],d=0;d<i.length;++d)c.push(T.call(this,i[d].id));var u=[];if(r=a.options.canDropCallback(s,l,c,u))for(d=0;d<u.length;++d){var p=u[d];o.push(i[p])}}return r}function b(e,t,n,i){if(!n||!n.length||!e)return!1;if(!gDesigner.isEnabledProFeatures()){if((0,s.isSymbolInstance)(e))return!1;if(n.some(e=>e instanceof r.GSymbol)&&(0,s.isSymbol)(e))return!1}for(var a=!0,l=0;l<n.length&&a;++l)(a=!e.isLocked()&&n[l].validateInsertion(e,t)&&o.GEditor.validateBlockInsertion(e,n[l],t))&&i.push[l];return a}function w(e,t,n,i){var o=$(this).data("glayerpanel");if(o.options.moveCallback){for(var r=e.id?T.call(this,e.id):o.scene?o.scene.getActivePage():null,a=n?T.call(this,n.id):null,s=[],l=0;l<i.length;++l)s.push(T.call(this,i[l].id));o.options.moveCallback(r,a,s)}}function C(e,t,n,i){var o=$(this).data("glayerpanel");if(o.options.duplicateCallback){for(var r=e.id?T.call(this,e.id):o.scene?o.scene.getActivePage():null,a=n?T.call(this,n.id):null,s=[],l=0;l<i.length;++l)s.push(T.call(this,i[l].id));o.options.duplicateCallback(r,a,s)}}function E(e){var t=$(this).data("glayerpanel");if(t.options.clickCallback){var n=T.call(this,e.id);t.options.clickCallback(n)}}function S(e){var t=T.call(this,e.id);t&&(e.expanded?t.setFlag(r.GNode.Flag.Expanded):t.removeFlag(r.GNode.Flag.Expanded))}function G(e,t){var n=$(this).data("glayerpanel");n&&n.options&&n.options.renderer&&n.options.renderer(e.id,e.expanded,t),Y.call(this)}function A(e){var t=$(this);e.id===p.COLLAPSE_ID?$(e).addClass(t.data("glayerpanel").options.collapseStyle):e.id===p.EXPAND_ID&&$(e).addClass(t.data("glayerpanel").options.expandStyle)}function T(e){var t=$(this).data("glayerpanel").layersTreeNodeMap[e];return t?t.node:null}function P(e){return $(this).data("glayerpanel").layersTreeNodeMap[e]}function L(e){var t=$(this).data("glayerpanel").layersTreeNodeMapByNodes.get(e);return t?t.treeId:null}function D(e){var t=$(this).data("glayerpanel").layersTreeNodeMapByNodes.get(e);return t?t.treeNode:null}function x(e){var t=$(this).data("glayerpanel").layersTreeNodeMap,n=$(this).data("glayerpanel").layersTreeNodeMapByNodes;e.accept(function(e){if(e instanceof r.GLayer||e instanceof r.GItem){var i=n.get(e);i&&(n.delete(e),t[i.treeId]=null)}}.bind(this))}function I(e,t,n){var i=$(this).data("glayerpanel"),a=P.call(this,e),s=a?a.node:null;if(s){var{parentHidden:u,isHidden:p,lockType:g,isOutlined:h,hasSelection:f}=(0,c.getLayerOrItemStatus)(s),{container:y,title:v,titleGroup:_}=(0,c.buildLayerItemContainer)(n,s,f,t);a.element=_;var b=this;if(s.hasFlag(r.GElement.Flag.PartialLocked)||_.attr("draggable",!0).attr("data-drag-mode",d.default.PRESS_AND_HOLD).on("dragstart",(function(e){if(i.options.startDraggingCallback){var t=i.options.startDraggingCallback(s);if(t&&t.length){var n="",o=t[0].getProperty("name");(o=o||t[0].getNodeNameTranslated())&&(n=o);for(var r=1;r<t.length;++r)(o=(o=t[r].getProperty("name"))||t[r].getNodeNameTranslated())&&(n+=", "+o);n.length&&$(v).html(n);var a=i.vtree,l=[];for(r=0;r<t.length;++r){var c=D.call(b,t[r]);c&&l.push(c)}a.setDragNodes(l),setTimeout(function(){$(v).html(o)}.bind(this),0)}else $(this).attr("draggable",!1)}})),!i.blockHighlight){var w=s.hasFlag(r.GNode.Flag.Highlighted);w||t||!s.hasMixin(r.GNode.Container)||(w=s.acceptChildren((function(e){return e.hasFlag(r.GNode.Flag.Highlighted)}),!1,!0)),y.toggleClass("g-highlighted-row",w)}!g&&gDesigner.getActiveDocument()&&gDesigner.getApplicationManager().isEditingEnabled()&&$(_).gAutoEdit({textSelector:"> .layer-title",getContainer:function(){return P.call(b,e).element},submitCallback:function(e){e&&""!==e.trim()&&o.GEditor.tryRunTransaction(s,(function(){s.setProperty("name",e)}),r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.rename-layer")))}});var C=R(s);C&&!C.inSync(s,!0)&&$("<span></span>").addClass("layer-action layer-synchronize gravit-icon-refresh").attr("data-title",r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.reset-instance"))).on("click",(function(e){gDesigner.stats("layers_click_symbol-reset"),e.stopPropagation(),o.GEditor.tryRunTransaction(s,(function(){C.synchronize(s)}),r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.reset-instance")))})).appendTo(y);var E=g?"gravit-icon-lock":"gravit-icon-unlock";E=gDesigner.isTouchEnabled()?E+"-small":E,$("<span></span>").addClass("layer-action layer-lock "+E).toggleClass("g-active",!!g).attr("data-title",r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-lock"))).on("click",(function(e){e.stopPropagation(),Z.toggleLockStatusOfLayerOrItem(s)})).appendTo(y).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.layer-toggle-lock-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.layer-toggle-lock-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/objects/#locking-objects"})),y.toggleClass("layer-hidden",p);var S=p?"gravit-icon-hide":"gravit-icon-display";if(S=gDesigner.isTouchEnabled()?S+"-small":S,$("<span></span>").addClass("layer-action layer-visibility "+S).toggleClass("g-active",p).attr("data-title",r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){e.stopPropagation(),Z.toggleHideStatusOfLayerOrItem(s)})).appendTo(y).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.layer-toggle-visibility-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.layer-toggle-visibility-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/objects/#hiding-objects"})),s instanceof r.GLayer){$("<span></span>").addClass("layer-action layer-outline gravit-icon-"+(h?"ellipse":"circle")).toggleClass("g-active",h).attr("data-title",r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.toggle-outline"))).on("click",(function(e){gDesigner.stats("layers_toggle_outline"),e.stopPropagation();var t=$(this);u||o.GEditor.tryRunTransaction(s,(function(){s.setProperty("otl",!s.getProperty("otl")),t.toggleClass("gravit-icon-ellipse",s.getProperty("otl")),t.toggleClass("gravit-icon-circle",!s.getProperty("otl"))}),r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.toggle-outline")))})).gRichTooltip(l.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.layer-toggle-outline-tooltip-title")),learnMore:"https://documentation.designer.io/organizing-your-designs/layer-groups/#extra-properties-of-the-layer-groups"})).appendTo(y);$("<span></span>").addClass("layer-color").gPatternChooser({types:[r.GColor],hasOpacity:!1,asButton:!1,simplified:!0}).gPatternChooser("value",s.getProperty("cls")).on("patternchange",(function(e,t,n,i){i||o.GEditor.tryRunTransaction(s,(function(){var e=s.getProperty("cls");s.setProperty("cls",t),s.acceptChildren((function(n){if(n instanceof r.GLayer){var i=n.getProperty("cls");r.GUtil.equals(i,e)&&n.setProperty("cls",t)}}))}),r.GLocale.get(new r.GLocaleKey("GLayerPanel","action.change-layer-color")))})).on("chooseropen",(function(){i.options.patternChooserStatusChangeCallBack(!0)})).on("chooserclose",(function(e,t,n){i.options.patternChooserStatusChangeCallBack(!1)})).appendTo(y)}y.contextmenu({context:m.LayerPanel},function(e){if($.inArray(s,gDesigner.getActiveDocument().getEditor().getSelection())<0){var t=$(this).data("glayerpanel");t.options.clickCallback&&t.options.clickCallback(s)}$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",e)}.bind(this))}}function O(e,t,n){var i=new g(e);return n&&(i.expanded=!0),$(this).data("glayerpanel").vtree.insertNodeBefore(t,i),i}function k(e,t,n){var i=new g(e);return n&&(i.expanded=!0),$(this).data("glayerpanel").vtree.appendNode(t,i),i}function F(e){$(this).data("glayerpanel").vtree.removeNode(e)}function R(e){do{if(e instanceof r.GSymbol)return e.isMaster()?null:e;e=e.getParent()}while(e);return null}function M(e,t){var n=r.GUtil.uuid(),i=$(this).data("glayerpanel"),o=i.vtree;if(!t&&e.getParent()&&e.getParent().hasMixin(r.GNode.Container)&&!(e.getParent()instanceof r.GScene)&&!(e.getParent()instanceof r.GPage)&&!L.call(this,e.getParent()))return;o.beginUpdate();const a=function(e){let t=e.getPrevious();for(;t&&!(t instanceof r.GElement);)t=t.getPrevious();return t}(e);var s,l=a?D.call(this,a):null;if(l)s=O.call(this,n,l,e.hasFlag(r.GNode.Flag.Expanded));else{var c=e.getParent(),d=!c||c instanceof r.GScene||c instanceof r.GPage?null:D.call(this,c);s=k.call(this,n,d,e.hasFlag(r.GNode.Flag.Expanded))}if(i.layersTreeNodeMap[n]={element:null,node:e,treeNode:s},i.layersTreeNodeMapByNodes.set(e,{element:null,treeNode:s,treeId:n}),e.hasMixin(r.GNode.Container))for(var u=e.getFirstChild();null!==u;u=u.getNext())(u instanceof r.GLayer||u instanceof r.GItem)&&M.call(this,u,t);o.endUpdate()}function N(e){var t=D.call(this,e);t&&(F.call(this,t),x.call(this,e))}function B(e,t){return!e.blockHandlers||!(!e.ignoreBlock||e.ignoreBlock!==t)}function U(e){$(this).data("glayerpanel");var t=e.targetNode;if(t instanceof r.GLayer||t instanceof r.GItem&&!(t instanceof r.GPathBase&&t.getParent()&&(t.getParent()instanceof r.GPGEdge||t.getParent()instanceof r.GCompoundPath.Paths)))switch(e.type){case r.GSymbol.AfterSiblingUpdate.INSERT:M.call(this,t);break;case r.GSymbol.AfterSiblingUpdate.REMOVE:N.call(this,t)}}function K(e){B($(this).data("glayerpanel"),e.node)&&(e.node instanceof r.GLayer||e.node instanceof r.GItem&&!(e.node instanceof r.GPathBase&&e.node.getParent()&&(e.node.getParent()instanceof r.GPGEdge||e.node.getParent()instanceof r.GCompoundPath.Paths))&&!function(e){var t=e.getScene();if(t){var n=e.getPage(),i=t.getActivePage();if(i&&n&&n!==i)return!0}return!1}(e.node))&&M.call(this,e.node)}function j(e){B($(this).data("glayerpanel"),e.node)&&(e.node instanceof r.GLayer||e.node instanceof r.GItem)&&N.call(this,e.node)}function H(e){e.temporary||!$(this).data("glayerpanel").blockHandlers&&(e.properties.some(e=>y.indexOf(e)>=0)||R(e.node))&&(e.node instanceof r.GLayer||e.node instanceof r.GItem)&&$(this).data("glayerpanel").vtree.requestInvalidation()}function V(){$(this).data("glayerpanel").vtree.requestInvalidation()}function z(e){"touch"===e.key&&Z._updateLayout.call(this)}function W(e){var t=$(this).data("glayerpanel"),n=$(this).data("glayerpanel").vtree;let{onlyUpdateStyle:i}=t;if(B(t,e.node)){var o=!1;if(e.node instanceof r.GLayer||e.node instanceof r.GItem)if(e.flag===r.GElement.Flag.Hidden||e.flag===r.GElement.Flag.PartialLocked||e.flag===r.GElement.Flag.FullLocked||e.flag===r.GNode.Flag.Selected||e.flag===r.GNode.Flag.Active){var a=e.node.getPage(),s=e.node.getScene(),l=s&&s.getActivePage();l&&a&&l!==a||(o=!0,i||(i=e.flag===r.GNode.Flag.Active))}else if(!t.blockHighlight&&e.flag===r.GNode.Flag.Highlighted){var c=e.node,d=function(e){var t=D.call(this,e);return t&&t.isVisible()}.bind(this);(d(c)||c.findParent(d))&&(o=!0)}if(gDesigner.getSetting("auto_expand_layers")&&e.flag===r.GNode.Flag.Selected&&e.node&&e.node.hasFlag(r.GNode.Flag.Selected)){var u=D.call(this,e.node);u&&(n.expandAndFocus(u,o)?t.currentFocus=u:o=!0)}e.node instanceof r.GPage&&e.flag===r.GNode.Flag.Active&&(X.call(this),q.call(this),o=!1),o&&(i?setTimeout(t=>{Q.call(this,e.node)}):n.requestInvalidation())}}function q(){var e=$(this).data("glayerpanel");if(e.vtree.beginUpdate(),e.scene&&e.scene.getActivePage())for(var t=e.scene.getActivePage().getFirstChild();null!==t;t=t.getNext())(t instanceof r.GLayer||t instanceof r.GItem)&&M.call(this,t,!0);e.vtree.endUpdate(),Y.call(this)}function Y(){gDesigner.isTouchEnabled()&&$(this).parent().css("height",parseInt($(this).find(".vscroller").css("height"),10)+h+"px")}function X(){var e=$(this).data("glayerpanel");e.vtree.clean(),e.layersTreeNodeMap={},e.layersTreeNodeMapByNodes=new Map}function Q(e){$(this).data("glayerpanel");var t=L.call(this,e);if(!t)return null;var n=P.call(this,t);if(!n)return null;var i=n.element,o=i.parent(),a=!1;if(e.hasMixin(r.GNode.Container))for(var s=e.getFirstChild();null!==s&&!a;s=s.getNext())s instanceof r.GItem&&s.hasFlag(r.GNode.Flag.Selected)&&(a=!0);e.getParent()&&e instanceof r.GItem&&Q.call(this,e.getParent()),o.toggleClass("g-active",e.hasFlag(r.GNode.Flag.Active)).toggleClass("g-selected",e.hasFlag(r.GNode.Flag.Selected)).toggleClass("g-has-selection",a),i.toggleClass("g-selected",e.hasFlag(r.GNode.Flag.Selected))}r.GObject.inheritAndMix(v,r.GObject);var Z={init:function(e){return e=$.extend({nodeStyle:"layer-row",expandStyle:"layer-arrow gravit-icon-right",collapseStyle:"layer-arrow gravit-icon-down",freeHeight:h,insertIntoStyle:"g-drop",upSeparatorSpan1Style:"g-up-separator-span1",upSeparatorSpan2Style:"g-up-separator-span2",downSeparatorSpan1Style:"g-down-separator-span1",downSeparatorSpan2Style:"g-down-separator-span2",renderer:I.bind(this),expandRenderer:A.bind(this),separatorRenderer:null,canDropCallback:b.bind(this),moveCallback:null,isDuplicateEffectCallback:null,duplicateCallback:null,clickCallback:null,startDraggingCallback:null,patternChooserStatusChangeCallBack:null},e),this.each((function(){$(this).addClass("g-layer-panel").data("glayerpanel",{vtree:new p(this,G.bind(this),e.nodeStyle,e.expandRenderer?e.expandRenderer:null,e.expandStyle==e.collapseStyle?e.expandStyle:null,e.separatorRenderer?e.separatorRenderer:null,e.freeHeight,e.insertIntoStyle,_.bind(this),w.bind(this),e.isDuplicateEffectCallback,C.bind(this),E.bind(this),S.bind(this),e.upSeparatorSpan1Style,e.upSeparatorSpan2Style,e.downSeparatorSpan1Style,e.downSeparatorSpan2Style,!1,15,21),options:e,layersTreeNodeMap:{},layersTreeNodeMapByNodes:new Map,scene:null,currentFocus:null})}))},refresh:function(){$(this).data("glayerpanel").vtree.refresh()},relayout:function(){var e=$(this).data("glayerpanel"),t=e.vtree,n=e.currentFocus;n&&t.expandAndFocus(n),t.requestInvalidation()},scene:function(e){var t=$(this),n=t.data("glayerpanel");if(!arguments.length)return n.scene;if(e!==n.scene){if(n.scene&&n.scene.hasMixin(r.GEventTarget))n.scene.removeEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.scene.removeEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.scene.removeEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.removeEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this),n.scene.removeEventListener(r.GSymbol.AfterSiblingUpdate,n.afterSiblingUpdate,this),gDesigner.removeEventListener(u.default,n.settingChangedEvent,this),(i=n.scene.getWorkspace())&&i.getFontManager().removeEventListener(r.GFontManager.FontAvailableEvent,n.fontAvailableEvent,this);if(X.call(this),n.scene=e,n.scene){var i;if(n.scene.hasMixin(r.GEventTarget))n.afterNodeInsertHandler=K.bind(this),n.beforeNodeRemoveHandler=j.bind(this),n.afterPropertiesChangeHandler=H.bind(this),n.afterFlagChangeHandler=W.bind(this),n.afterSiblingUpdate=U.bind(this),n.fontAvailableEvent=V.bind(this),n.settingChangedEvent=z.bind(this),n.scene.addEventListener(r.GSymbol.AfterSiblingUpdate,n.afterSiblingUpdate,this),n.scene.addEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.scene.addEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.scene.addEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.addEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this),gDesigner.addEventListener(u.default,n.settingChangedEvent,this),(i=n.scene.getWorkspace())&&i.getFontManager().addEventListener(r.GFontManager.FontAvailableEvent,n.fontAvailableEvent,this);q.call(this),Z._updateLayout.call(this)}}return this},blockHandlers:function(e){$(this).data("glayerpanel").blockHandlers=!!e},onlyUpdateStyle:function(e){$(this).data("glayerpanel").onlyUpdateStyle=!!e},ignoreBlock:function(e){$(this).data("glayerpanel").ignoreBlock=e},setBlockHighlight:function(e){$(this).data("glayerpanel").blockHighlight=!!e},getLastVisitedDroppable:function(){return $(this).data("glayerpanel").vtree.getLastVisitedDroppable()},getTreeNode:function(e){var t=null;return $(this).data("glayerpanel")&&(t=D.call(this,e)),t},getItem:function(e){return T.call(this,e.id)},getTitleOfLayer:function(e){return e.children(".layer-title-group")},getSelected:function(){return $(this).children(".g-selected")},toggleLockStatusOfLayerOrItem:function(e){gDesigner.stats("layers_change_locktype");const{parentLockType:t}=(0,c.getLayerOrItemStatus)(e);if(!t||t===r.GBlock.LockType.Partial){let n=e.getProperty("lkt");const i=e.getProperty("plkt");if(n?i&(r.GBlock.ProgramLck.NoEdit|r.GBlock.ProgramLck.NoMove|r.GBlock.ProgramLck.NoNewChildren|r.GBlock.ProgramLck.NoDelete)||(n=null):n=r.GBlock.LockType.Full,t!==r.GBlock.LockType.Partial||null!==n){const t=[];if(a.GPlatform.modifiers.optionKey){for(let i=e.getParent().getFirstChild();null!=i;i=i.getNext()){const e=i.getProperty("lkt");n===e||e===r.GBlock.LockType.Full&&n===r.GBlock.LockType.Partial||t.push(i)}}else t.push(e);t.length&&o.GEditor.tryRunTransaction(e,(function(){for(let e=0;e<t.length;++e)n===r.GBlock.LockType.Full&&t[e].accept(e=>{e.removeFlag(r.GNode.Flag.Selected)}),t[e].setProperty("lkt",n)}),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-lock")))}}},toggleHideStatusOfLayerOrItem:function(e){gDesigner.stats("layers_toggle_visibility");const{parentHidden:t}=(0,c.getLayerOrItemStatus)(e);if(!t){const t=!e.getProperty("vis"),n=[];if(a.GPlatform.modifiers.optionKey){for(let i=e.getParent().getFirstChild();null!=i;i=i.getNext()){const e=i.getProperty("vis");null!==e&&e!==t&&n.push(i)}}else n.push(e);o.GEditor.tryRunTransaction(e,(function(){for(let e=0;e<n.length;++e)n[e].removeFlag(r.GNode.Flag.Highlighted),n[e].setProperty("vis",t)}),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-visibility")))}},resetVTreeRowHeight:function(e){$(this).data("glayerpanel").vtree.resetRowHeight(e)},getCurrentFocusedNode:function(){return $(this).data("glayerpanel").currentFocus},setCurrentFocusedNode:function(e){$(this).data("glayerpanel").currentFocus=e},_updateLayout:function(){const e=$(this).data("glayerpanel"),t=e&&e.vtree;if(t){const e=gDesigner.isTouchEnabled();t.setFreeHeight(e?f:h),t.setAnimatedDragEnabled(e)}}};e.exports=v,$.fn.gLayerPanel=function(e){return Z[e]?Z[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):Z.init.apply(this,arguments)}},function(e,t,n){"use strict";function i(e,t,n,i){n=n||0,i=i||30,this._scroller=document.createElement("div"),this._scroller.classList.add("vscroller"),this._container=e,this._container.style.overflow="auto",this._container.style.position="relative",this._container.classList.add("g-virtual-list"),this._container.appendChild(this._scroller),this._container.addEventListener("scroll",this._onScroll.bind(this)),this.beginUpdate(),t&&this._renderer(t),i&&this.rowHeight(i),n&&this.rowCount(n),this.endUpdate()}n(45),n(3),i.prototype._renderer=null,i.prototype._rowHeight=0,i.prototype._rowCount=0,i.prototype._visibleRows=0,i.prototype._cachedRows=0,i.prototype._scroller=null,i.prototype._updateCounter=0,i.prototype._lastRenderScrollTop=0,i.prototype._lastCleanedTime=0,i.prototype._cleanViewportTimerId=null,i.prototype._renderer=function(e){return arguments.length?(this._renderer=e,this._render(),this):this._renderer},i.prototype.rowHeight=function(e){return arguments.length?(this._rowHeight=e,this._updateVisibleRows(),this._updateScroller(),this._render(),this):this._rowHeight},i.prototype.rowCount=function(e){return arguments.length?(this._rowCount=e,this._updateScroller(),this._render(),this):this._rowCount},i.prototype.beginUpdate=function(){this._updateCounter++},i.prototype.endUpdate=function(){0==--this._updateCounter&&this._render()},i.prototype.refresh=function(){return this._updateVisibleRows(),this._updateScroller(),this._render(),this},i.prototype._render=function(){if(0===this._updateCounter){var e=this._container.scrollTop,t=parseInt(e/this._rowHeight)-this._visibleRows;this._renderViewport(t<0?0:t)}return this},i.prototype._updateVisibleRows=function(){this._visibleRows=Math.floor(this._container.offsetHeight/this._rowHeight),this._cachedRows=3*this._visibleRows,this._scrollCacheSize=this._visibleRows*this._rowHeight},i.prototype._updateScroller=function(){this._scroller.style.height=(this._rowCount*this._rowHeight).toString()+"px"},i.prototype._onScroll=function(e){e.preventDefault(),this._requestViewportClean();var t=this._container.scrollTop;(!this._lastRenderScrollTop||Math.abs(t-this._lastRenderScrollTop)>this._scrollCacheSize)&&(this._updateVisibleRows(),this._render(),this._lastRenderScrollTop=t)},i.prototype._renderViewport=function(e){for(var t=1,n=this._container.childNodes.length;t<n;t++)this._container.childNodes[t].style.display="none",this._container.childNodes[t].setAttribute("data-clean","");if(this._rowCount&&this._renderer&&this._rowHeight){for(var i=Math.min(this._rowCount,e+this._cachedRows),o=document.createDocumentFragment(),r=e;r<i;r++){var a=document.createElement("div");a.classList.add("vrow"),a.style.top=r*this._rowHeight+"px",this._renderer(r,a),o.appendChild(a)}this._container.appendChild(o)}},i.prototype._requestViewportClean=function(){null===this._cleanViewportTimerId&&(this._cleanViewportTimerId=setTimeout(function(){Date.now()-this._lastCleanedTime>100&&(this._cleanViewport(),this._lastCleanedTime=Date.now()),this._cleanViewportTimerId=null}.bind(this),300))},i.prototype._cleanViewport=function(){for(var e=this._container.querySelectorAll("div[data-clean]"),t=0,n=e.length;t<n;t++)this._container.removeChild(e[t]),this._jqueryCleanup(e[t])},i.prototype._jqueryCleanup=function(e){window.hasOwnProperty("jQuery")&&jQuery.hasOwnProperty("cleanData")&&jQuery.hasOwnProperty("merge")&&jQuery.cleanData(jQuery.merge(Array.prototype.slice.call(e.querySelectorAll("*")),e))},e.exports=i},function(e,t,n){"use strict";n(9),n(3),e.exports=e=>{e._DragAndDropHelper=function(e){this._vtree=e},e._DragAndDropHelper.prototype._droppableNodeUpper=null,e._DragAndDropHelper.prototype._droppableNodeLower=null,e._DragAndDropHelper.prototype._droppableNodeInside=null,e._DragAndDropHelper.prototype.setDroppableNodeInside=function(e){e&&e===this._droppableNodeInside||this._droppableNodeInside&&this._droppableNodeInside.row.classList.remove(this._vtree._insertIntoStyle),this._droppableNodeInside=e,e&&this._droppableNodeInside.row.classList.add(this._vtree._insertIntoStyle)},e._DragAndDropHelper.prototype.setDroppableNodeLower=function(e){this._droppableNodeLower=e,this._droppableNodeUpper=null;const t=this._vtree._dragNode;this._vtree.beginUpdate(),this._vtree.removeNode(t),this._vtree.insertNodeAfter(e,t),this._vtree.endUpdate(!0)},e._DragAndDropHelper.prototype.setDroppableNodeUpper=function(e){this._droppableNodeUpper=e,this._droppableNodeLower=null;const t=this._vtree._dragNode;this._vtree.beginUpdate(),this._vtree.removeNode(t),this._vtree.insertNodeBefore(e,t),this._vtree.endUpdate(!0)},e._DragAndDropHelper.prototype.drop=function(){const e=this._vtree._dragNode,t=this._vtree._root;if(this._droppableNodeInside){const t=this._droppableNodeInside;this._vtree.beginUpdate(),this._vtree.removeNode(e),this._vtree.appendNode(t,e),this._vtree.endUpdate(!0),this._vtree._dropCallback&&this._vtree._dropCallback(t,null,null,[e])}else if(this._droppableNodeUpper){const n=this._droppableNodeUpper;this._vtree._dropCallback&&(n!==t?this._vtree._dropCallback(n.parent,e.next,e.previous,[e]):this._vtree._dropCallback(t,null,null,[e]))}else if(this._droppableNodeLower){const t=this._droppableNodeLower;this._vtree._dropCallback&&this._vtree._dropCallback(t.parent,e.next,e.previous,[e])}},e._DragAndDropHelper.prototype.toString=function(){return"[Object GVirtualTree._DragAndDropHelper]"}}},function(e,t,n){"use strict";n(19),n(24);n(43);var i=n(1),o=(n(16),n(32),n(56),n(1233)),r=n(404).GVirtualTree,a=(n(404).GVirtualTreeNode,n(404).GVirtualTreeNodeNamed),{VTREE_FREE_HEIGHT:s}=n(12);n(143),n(403);function l(){}function c(e){var t=$(this).data("gselectedpanel"),n=$(this).data("gselectedpanel").vtree;if(t.options.clickCallback){var i=g.call(this,e.id);t.options.clickCallback(i)}n.requestInvalidation()}function d(e){var t=g.call(this,e.id);t&&(e.expanded?t.setFlag(i.GNode.Flag.Expanded):t.removeFlag(i.GNode.Flag.Expanded))}function u(e,t){var n=$(this).data("gselectedpanel");n.options.renderer&&n.options.renderer(e.id,e.expanded,t)}function p(e){var t=$(this);e.id===r.COLLAPSE_ID?$(e).addClass(t.data("gselectedpanel").options.collapseStyle):e.id===r.EXPAND_ID&&$(e).addClass(t.data("gselectedpanel").options.expandStyle)}function g(e){var t=h.call(this,e);return t?t.node:null}function h(e){return $(this).data("gselectedpanel").layersTreeNodeMap[e]}function f(e,t,n){$(this).data("glayerpanel");var i=h.call(this,e),r=i?i.node:null;if(r){var{hasSelection:a}=(0,o.getLayerOrItemStatus)(r),{titleGroup:s}=(0,o.buildLayerItemContainer)(n,r,a,t);i.element=s}}function m(e,t,n){var{newNode:i,vtree:o}=y.call(this,e,n);return o.appendNode(t,i),i}function y(e,t){return{newNode:new a(e,t),vtree:$(this).data("gselectedpanel").vtree}}function v(){var e=$(this).data("gselectedpanel"),t=e.vtree;t.beginUpdate();for(var{elementHits:n,filteredElementHits:o,submenus:r}=e.selections,a=(t,n,i)=>{e.layersTreeNodeMap[i]={element:null,node:n,treeNode:t},e.layersTreeNodeMapByNodes.set(n,{element:null,treeNode:t,treeId:i})},s=0;s<o.length;s++){var l=i.GUtil.uuid(),c=o[s].element,d=(c instanceof i.GBlock?c.getLabel():c.getNodeNameTranslated(),"temp-"+n.indexOf(o[s]));if(r[d]){a(p=m.call(this,l,null,!0),c,l);for(let e=0;e<r[d].length;e++){var u=i.GUtil.uuid();a(m.call(this,u,p,!1),r[d][e],u)}}else{var p;a(p=m.call(this,l,null,!1),c,l)}}t.endUpdate()}function _(){var e=$(this).data("gselectedpanel");e.vtree.clean(),e.layersTreeNodeMap={},e.layersTreeNodeMapByNodes=new Map}i.GObject.inheritAndMix(l,i.GObject);var b={init:function(e){return e=$.extend({nodeStyle:"selected-row",expandStyle:"selected-arrow gravit-icon-right",collapseStyle:"selected-arrow gravit-icon-down",freeHeight:0,insertIntoStyle:"g-drop",upSeparatorSpan1Style:"g-up-separator-span1",upSeparatorSpan2Style:"g-up-separator-span2",downSeparatorSpan1Style:"g-down-separator-span1",downSeparatorSpan2Style:"g-down-separator-span2",renderer:f.bind(this),toggleRenderer:p.bind(this),separatorRenderer:null,canDropCallback:()=>!1,moveCallback:null,isDuplicateEffectCallback:null,duplicateCallback:null,clickCallback:null,startDraggingCallback:null,patternChooserStatusChangeCallBack:null,bottomHeight:3},e),this.each((function(){$(this).addClass("g-selected-panel").data("gselectedpanel",{vtree:new r(this,u.bind(this),e.nodeStyle,e.toggleRenderer?e.toggleRenderer:null,e.expandStyle==e.collapseStyle?e.expandStyle:null,e.separatorRenderer?e.separatorRenderer:null,e.freeHeight,e.insertIntoStyle,()=>!1,null,e.isDuplicateEffectCallback,null,c.bind(this),d.bind(this),e.upSeparatorSpan1Style,e.upSeparatorSpan2Style,e.downSeparatorSpan1Style,e.downSeparatorSpan2Style,!1,15,21,e.bottomHeight,e.renderFinishCallback),options:e,layersTreeNodeMap:{},layersTreeNodeMapByNodes:new Map,selections:null,currentFocus:null})}))},refresh:function(){$(this).data("gselectedpanel").vtree.refresh()},relayout:function(){$(this).data("gselectedpanel").vtree.requestInvalidation()},setSelections:function(e){var t=$(this),n=t.data("gselectedpanel");return arguments.length?(e!==n.selections&&(_.call(this),n.selections=e,v.call(this)),this):n.selections}};e.exports=l,$.fn.gSelectedPanel=function(e){return b[e]?b[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(17);n(28),n(9),n(19),n(24),n(14),n(115),n(58);var o=n(43),r=n(1),a=n(792),s=n(12),l=i(n(1235));const c=n(36),d=n(323),u=n(1236),p=n(1582),g=n(1238),h=n(1237),f=n(1163),m=["text"];function y(){}function v(e){var t=$(this).data("gannotationpanel");if(t.options.clickCallback){var n=C.call(this,e.id);t.options.clickCallback(n)}}function _(e){C.call(this,e.id)&&e.expanded}function b(e,t){var n=$(this).data("gannotationpanel");if(n.options.renderer)return n.options.renderer(e.id,e.virtualNode,t)}function w(e){var t=$(this);e.id===u.COLLAPSE_ID?$(e).addClass(t.data("gannotationpanel").options.collapseStyle):e.id===u.EXPAND_ID&&$(e).addClass(t.data("gannotationpanel").options.expandStyle)}function C(e){var t=$(this).data("gannotationpanel").annotTreeNodeMap[e];return t?t.annot:null}function E(e){return $(this).data("gannotationpanel").annotTreeNodeMap[e]}function S(e){var t=$(this).data("gannotationpanel").annotTreeNodeMapByNodes.get(e);return t?t.treeId:null}function G(e){var t=$(this).data("gannotationpanel").annotTreeNodeMapByNodes.get(e);return t?t.treeNode:null}function A(e){var t=$(this).data("gannotationpanel").annotTreeNodeMap,n=$(this).data("gannotationpanel").annotTreeNodeMapByNodes;e.accept(function(e){var i=n.get(e);i&&(n.delete(e),t[i.treeId]=null)}.bind(this))}function T(e){var t=$(this).data("gannotationpanel"),n=[];if(t.annotTreeNodeMap)for(var i in e instanceof r.GComment&&n.push(S.call(this,e.getParent())),t.annotTreeNodeMap)t.annotTreeNodeMap[i]&&t.annotTreeNodeMap[i].annot&&(t.annotTreeNodeMap[i].annot===e||t.annotTreeNodeMap[i].annot instanceof r.GComment&&t.annotTreeNodeMap[i].annot.getParent()===e)&&n.push(i);return n}function P(){return!!gDesigner.getApplicationManager().isCommentingEditingEnabled()||(c.alert(r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.document-approved-no-annotations-update"))),!1)}function L(){const e=$(this).data("gannotationpanel");if(e&&e.syncCallback)try{e.syncCallback()}finally{e.syncCallback=null}}function D(e,t,n){const i=gDesigner.getApplicationManager().isCommentingEditingEnabled();var a=$(this).data("gannotationpanel"),s=E.call(this,e),l=s?s.annot:null,u=null;if(l){var p=!1,f=$(n);if(f.attr("draggable",!1),l.hasMixin(r.GAnnotation)?f.addClass("parent"):f.addClass("child"),!a.showResolved&&(l.hasMixin(r.GAnnotation)&&l.getProperty("rsv")||l instanceof r.GComment&&l.getParent().getProperty("rsv")))return void f.css("display","none");if(f.hover(()=>T.call(this,l).forEach(e=>$("#".concat(e)).addClass("on-hover")),()=>T.call(this,l).forEach(e=>$("#".concat(e)).removeClass("on-hover"))),!(l.hasMixin(r.GAnnotation)?l:l.getParent()).hasFlag(r.GNode.Flag.Selected)&&(l.hasMixin(r.GAnnotation)&&!N(l).length||B(l))&&(p=!0),!a.blockHighlight){var m=l.hasFlag(r.GNode.Flag.Highlighted);!m&&l.hasMixin(r.GNode.Container)&&(m=l.acceptChildren((function(e){return e.hasFlag(r.GNode.Flag.Highlighted)}),!1,!0)),$(f).toggleClass("g-highlighted-row",m)}var y=I.call(this,l),v=E.call(this,y);void 0===v.expanded&&(v.expanded=!0);var _=gDesigner.getActiveDocument();_&&l.getId()===_.getFocusAnnotationId()&&!_.isAnnotationFocused()&&(_.getScene().updateActivePageForElem(v.annot),_.getScene().updateActiveLayerForElem(v.annot),_.setAnnotationFocused(),v.expanded=!0,v.annot.setFlag(r.GNode.Flag.Selected));var b=O.call(this,l);l.hasMixin(r.GAnnotation)&&(u=x.call(this,l,a.showResolved));var w=new h({isCommentingEditingEnable:i,container:f,annotation:l,relatedNodesCount:b,sidebarActive:a.sidebarActive,isLastRow:p,hasResolveAccess:a.vtree.hasResolveAccess(),hasReopenAccess:a.vtree.hasReopenAccess(),mentionData:a.vtree.getMentionData(),onMouseEnter:()=>{l.hasMixin(r.GAnnotation)&&!l.hasFlag(r.GAnnotation.Flag.Hidden)&&l.setFlag(r.GNode.Flag.Highlighted)},onMouseLeave:()=>{l.hasMixin(r.GAnnotation)&&!l.hasFlag(r.GAnnotation.Flag.Hidden)&&l.removeFlag(r.GNode.Flag.Highlighted)},onChange:e=>{P()&&(l.getProperty("text")===e?L.call(this):o.GEditor.tryRunTransaction(l,(function(){l.setProperty("text",e)}),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.edit-comment"))))},onToggleState:()=>{P()&&(o.GEditor.tryRunTransaction(l,(function(){a.showResolved||l.getProperty("rsv")||!l.hasFlag(r.GNode.Flag.Selected)||l.removeFlag(r.GNode.Flag.Selected),l.setProperty("rsv",!l.getProperty("rsv"))}),l.getProperty("rsv")?r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.reopen")):r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.resolve"))),te.call(this),ee.call(this))},onResolve:()=>{P()&&(o.GEditor.tryRunTransaction(l,(function(){!a.showResolved&&l.hasFlag(r.GNode.Flag.Selected)&&l.removeFlag(r.GNode.Flag.Selected),l.setProperty("rsv",!0)}),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.resolve"))),te.call(this),ee.call(this))},onReopen:()=>{P()&&(o.GEditor.tryRunTransaction(l,(function(){l.setProperty("rsv",!1)}),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.reopen"))),te.call(this),ee.call(this))},onDelete:()=>{P()&&c.confirm(r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.confirm-remove")),e=>{e&&d.removeAnnotations([l],l.getParent(),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.remove-".concat(l.hasMixin(r.GAnnotation)?"annotation":"comment"))))},null,null,null,!0,!0)},onCancel:()=>{L.call(this)},onExpandClick:t=>{t.stopPropagation(),v.expanded=!v.expanded;var n=E.call(this,e);try{n.component.setCollapseState(v.expanded)}catch(e){"function"==typeof gdb_showScene&&console.error("REPAIR THIS! component is NULL!")}var i=n.annot;T.call(this,i).forEach((e,t)=>{if(t>0){var n=E.call(this,e);try{n.component.setVisiblity(v.expanded)}catch(e){"function"==typeof gdb_showScene&&console.error("REPAIR THIS! component is NULL!")}}})},onCopyPermalinkClick:async e=>{const t=gDesigner.getActiveDocument();if(t){const n=await gDesigner.getShareManager().getPermalink(t,e);n&&gContainer.copyToClipboard(n)}},onAssignTo:e=>{l.hasMixin(r.GAnnotation)?l.setProperty("asgn",e):l.getParent()&&l.getParent().hasMixin(r.GAnnotation)&&l.getParent().setProperty("asgn",e)},mainAnnotObject:v});s.element=f,s.component=w,a.vtree.addChild(w)}else if(s&&s.replyAnnot){let e=$(n);if(e.addClass("last-row"),!i||!s.replyAnnot.hasFlag(r.GNode.Flag.Selected)||s.replyAnnot.getProperty("rsv")||!a.showResolved&&s.replyAnnot.getProperty("rsv"))return void e.hide();const t=!s.replyAnnot.isFillingCompleted(),l=e=>{if(P()&&(e.length||t&&s.replyAnnot.isEmptyTextAllowed())){let c=gDesigner.getSyncUser();if(d.canUpdate(c)){const d=s.replyAnnot.getScene(),u=d&&o.GEditor.getEditor(d);let p,g;p=t?r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.set-annotation-text")):r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.add-comment")),u&&u.beginTransaction();try{if(t){s.replyAnnot.setProperty("text",e),s.replyAnnot.setProperty("email",c.getAccountName()),j.call(this,s.replyAnnot);var n=r.GUtil.uuid(),i=G.call(this,s.replyAnnot),l={element:null,annot:null,treeNode:R.call(this,n,i,!0,!0),replyAnnot:s.replyAnnot,treeId:n};a.annotTreeNodeMap[n]=l,a.replyNodes.set(s.replyAnnot,l)}else{j.call(this,s.replyAnnot);const t=s.replyAnnot.addComment(e,c.getUID(),o.GEditorOptions.userConfig.userName,c.avatar,c.getAccountName());g=o.GAnnotationEditor.createAddAnnotationTransactionData([t],s.replyAnnot)}te.call(this),ee.call(this)}catch(e){console.log(e)}finally{u&&u.commitTransaction(p,g)}}H(this,s.replyAnnot)}},c=()=>{H(this,s.replyAnnot),L.call(this)},u=e=>{s.replyAnnot.setProperty("asgn",e)};var C=new g({container:e,annotation:s.replyAnnot,onSubmit:l,onCancel:c,onAssignTo:u,mentionData:a.vtree.getMentionData()}),S=a.annotTreeNodeMapByNodes.get(s.replyAnnot);s.reply=C,a.vtree.addChild(C),S&&(S.reply=C)}return u}function x(e,t){let n=e.getProperty("asgn");if(!(n||[]).length)return;var i=e.getProperty("rsv");let s=$("<div/>").addClass("already-assigned-user-row").appendTo($(this)),l=$("<span/>").addClass("assigned-content-group").appendTo(s);return(0,a.getCollabInfo)(n[0]).then(async n=>{$("<span/>").addClass("assign-to-text").html(r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.assigned-to"))+(n&&n.name?n.name:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.unknown-user")))).appendTo(l);const a=!i;(await a?d.canResolveAnnotation(e):d.canReopenAnnotation(e))&&$("<span/>").addClass("assigned-action-group").append($("<span/>").addClass("icon "+(a?"gravit-icon-resolve":"gravit-icon-resolved")).addClass("assigned-icon-resolve").addClass("assigned-resolve-action").attr("data-title",a?r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.assign-resolve")):r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.reopen"))).on("click",()=>{P()&&(a?o.GEditor.tryRunTransaction(e,(function(){!t&&e.hasFlag(r.GNode.Flag.Selected)&&e.removeFlag(r.GNode.Flag.Selected),e.setProperty("rsv",!0)}),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.resolve"))):o.GEditor.tryRunTransaction(e,(function(){e.setProperty("rsv",!1)}),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.reopen"))),te.call(this),ee.call(this))})).appendTo(l)}),s}function I(e){return T.call($(this),e)[0]}function O(e){return T.call($(this),e).length}function k(e,t,n){var i=new u.GSimpleTreeNodeNamed(e);return n&&(i.virtualNode=!0),$(this).data("gannotationpanel").vtree.insertNodeAfter(t,i),i}function F(e,t,n){var i=new u.GSimpleTreeNodeNamed(e);return n&&(i.virtualNode=!0),$(this).data("gannotationpanel").vtree.insertNodeBefore(t,i),i}function R(e,t,n,i){var o=new u.GSimpleTreeNodeNamed(e);return n&&(o.virtualNode=!0),$(this).data("gannotationpanel").vtree.appendNode(t,o,i),o}function M(e){$(this).data("gannotationpanel").vtree.removeNode(e)}function N(e){return e.getChildren().filter(e=>e instanceof r.GComment&&!e.getProperty("rmd"))}function B(e){if(!(e instanceof r.GComment))return!1;for(var t=!0,n=e.getNext();n;){if(n instanceof r.GComment&&!n.getProperty("rmd")){t=!1;break}n=n.getNext()}return t}function U(e){var t=gDesigner.getSyncUser();t&&e.getProperty("uid")&&d.isOwner(t,e)?e.$plkt=null:e.$plkt=r.GBlock.ProgramLck.NoSizeChanges|r.GBlock.ProgramLck.NoMove|r.GBlock.ProgramLck.NoDelete}function K(e,t,n){var i=r.GUtil.uuid(),o=$(this).data("gannotationpanel"),a=o.vtree;if(t||!e.getParent()||e.getParent()instanceof r.GAnnotationsList||S.call(this,e.getParent())){var s;if(a.beginUpdate(),e.hasMixin(r.GAnnotation)){j.call(this,e);var l=function(e){for(var t=null,n=e;!t&&n.getPrevious();)n.getPrevious().getProperty("rmd")?n=n.getPrevious():t=n.getPrevious();return t}(e),c=l?G.call(this,l):null;s=c?F.call(this,i,c,!1):R.call(this,i,null,!1)}else{var d=e.getParent();j.call(this,d);var u=G.call(this,d);s=R.call(this,i,u,!1,!0)}var p={element:null,annot:e,treeNode:s,treeId:i};if(o.annotTreeNodeMap[i]=p,o.annotTreeNodeMapByNodes.set(e,p),e.hasMixin(r.GAnnotation)){for(var g=e.getFirstChild();null!==g;g=g.getNext())g instanceof r.GComment&&!g.getProperty("rmd")&&K.call(this,g,t);if(!N(e).length){var h=r.GUtil.uuid(),f={element:null,annot:null,treeNode:e.isFillingCompleted()?R.call(this,h,s,!0,!0):k.call(this,h,s,!0),replyAnnot:e,treeId:h};o.annotTreeNodeMap[h]=f,o.replyNodes.set(e,f)}U(e)}else if(e instanceof r.GComment&&B(e)){let t,n=r.GUtil.uuid();t=k.call(this,n,s,!0);var m=e.getParent();let i={element:null,annot:null,treeNode:t,replyAnnot:m,treeId:n};o.annotTreeNodeMap[n]=i,o.replyNodes.set(m,i)}a.endUpdate(n)}}function j(e){var t=$(this).data("gannotationpanel").replyNodes,n=t.get(e);return n&&(M.call(this,n.treeNode),t.delete(e),$(this).data("gannotationpanel").annotTreeNodeMap[n.treeNode.id]=null),n}function H(e,t){if(t)!t.getParent()||t.getProperty("rmd")||t.isFillingCompleted()||d.removeAnnotations([t],t.getParent(),r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.remove-empty-annotation")));else{var n=gDesigner.getActiveDocument();if(n){var i=n.getEditor().getSelection();i&&i.map(t=>{t.hasMixin(r.GAnnotation)&&H(e,t)})}}}function V(e,t){var n=e.data("gannotationpanel").annotTreeNodeMapByNodes.get(t);n&&n.component&&(n.component.cancelEditMode(),n.reply&&n.reply.hide())}function z(e){var t=G.call(this,e);t&&(M.call(this,t),A.call(this,e),j.call(this,e),ne.requestInvalidation.call(this))}function W(e,t){return!e.blockHandlers||!(!e.ignoreBlock||e.ignoreBlock!==t)}function q(){return!(!$(this).find(".annotations-buttonrow").toArray().some(e=>"none"!==$(e).css("display"))&&!$(this).find(".g-edit-mode").length)}function Y(e,t){let n=$(this).data("gannotationpanel"),i=!1;const o={};if(!n)return;if(n.blockAnnotationsUpdate)return;if(null!==n.scheduledUpdate)return void(n.updateInProgress&&(n.scheduleNextUpdate=!0));if(e&&e.node&&e.node.recordedTransaction&&(i=!0,e.properties&&e.values&&e.properties.length===e.values.length))for(var a=0,s=e.values.length;a<s;a++)o[e.properties[a]]=e.values[a];if(e&&e.node){if(e.custom)return;if(e.node.hasMixin(r.GAnnotation)&&e.node.isPropertiesIgnorable(e.properties))return}let l=gDesigner.getActiveDocument();l&&l.getAnnotationsId()&&(n.scheduledUpdate=setTimeout(()=>{let e=$(this).data("gannotationpanel");if(!e)return;if(q.call(this)||e.vtree.isPendingInvalidation())return e.scheduledUpdate=null,void Y.call(this);console.log("updating annotations"),e.updateInProgress=!0;let n=e.page.getAnnotations();d.updateAndReturnCloudAnnotationsForDocument(l,r.GNode.store(n,{recordedTransaction:i,recordedProperties:o})).then(e=>{let n=e.annotationsCollection,a=!1,s=$(this).data("gannotationpanel");if(!s)return a;if(!s.updateInProgress)return a;if(q.call(this)&&(s.scheduleNextUpdate=!0),s.updateInProgress=!1,!s.scheduleNextUpdate){let e=d.findAnnotationsListForPage(s.page,n);if(e){let n=r.GNode.restore(e),l=n.getChildren();n.clearChildren(),s.vtree.beginUpdate();let c=d.mergeAnnotations(s.page.getAnnotations(),s.page.getAnnotations().getChildren(),n,l,i?o:void 0);a=a||c,s.vtree.endUpdate(t),te.call(this),ee.call(this)}e||(s.vtree.beginUpdate(),s.page.getAnnotations().clearChildren(),s.vtree.endUpdate(t),te.call(this)),s.options.updateAnnotationCache(n)}if(s.scheduledUpdate=null,s.scheduleNextUpdate&&(s.scheduleNextUpdate=!1,Y.call(this)),a){let t=s.page.getScene();t&&t.getLastTimeAnnotationsFromCloudModified()<e.lastUpdateTime&&t.setLastTimeAnnotationsFromCloudModified(e.lastUpdateTime),gDesigner.notifyDocumentModified(l)}return a}).catch(t=>{console.warn("error during annotations list update: "+t),e.scheduledUpdate=null,e.updateInProgress=!1,e.scheduleNextUpdate&&(e.scheduleNextUpdate=!1,Y.call(this))})},500))}function X(e){var t=$(this).data("gannotationpanel");if(W(t,e.node)){const n=e.node.findParent(e=>e instanceof r.GAnnotationsList),i=()=>{const t=new l.default;if(e.node instanceof r.GComment){const n=e.node.getProperty("text");n&&s.NOTIFICATION_USER_MENTION_REGEX.test(n)||(t.collaboratorsCache=!1)}return t};let o=!1;const a=()=>{if(!e.node.getProperty("rmd")){const t=n?l.default.NO_CACHE_INVALIDATION:i();K.call(this,e.node,null,t)}},c=()=>{n&&Y.call(this,null,i())};(e.node.hasMixin(r.GAnnotation)||e.node instanceof r.GComment||e.node instanceof r.GAnnotationsList)&&(e.node.getProperty("rmd")?o=!0:a()),o?"number"!=typeof t.delayedUpdate&&(t.delayedUpdate=setTimeout(()=>{a(),c(),t.delayedUpdate=null})):c()}}function Q(e){W($(this).data("gannotationpanel"),e.node)&&(z.call(this,e.node),e.node.findParent(e=>e instanceof r.GAnnotationsList)&&Y.call(this))}function Z(e){if(!e.temporary&&!$(this).data("gannotationpanel").blockHandlers){e.properties.some(e=>m.indexOf(e)>=0)&&ne.requestInvalidation.call(this);let t=gDesigner.getSyncUser();d.canUpdate(t)&&e.node.hasMixin(r.GAnnotation)&&e.properties.includes("rsv")&&setTimeout(()=>{let n=e.values[e.properties.indexOf("rsv")];(void 0!==n&&!1!==n)!==e.node.getProperty("rsv")&&(j.call(this,e.node),e.node.addComment("",t.getUID(),o.GEditorOptions.userConfig.userName,t.avatar,t.getAccountName(),e.node.getProperty("rsv")?r.GComment.Type.Close:r.GComment.Type.Open))}),(e.node instanceof r.GAnnotationsList||e.node.findParent(e=>e instanceof r.GAnnotationsList))&&(e.node.hasMixin(r.GAnnotation)&&e.properties.indexOf("uid")>=0&&U(e.node),Y.call(this,e)),e.properties.includes("rmd")&&e.node.getProperty("rmd")?(e.node.hasMixin(r.GAnnotation)&&V(this,e.node),te.call(this),ee.call(this)):e.properties.includes("text")&&e.node.isFillingCompleted()&&e.node.hasMixin(r.GAnnotation)&&V(this,e.node)}}function J(e){var t,n=$(this).data("gannotationpanel");if(W(n,e.node)){var i=!1;if(e.node instanceof r.GComment||e.node.hasMixin(r.GAnnotation))if(e.flag===r.GAnnotation.Flag.Hidden||e.flag===r.GNode.Flag.Selected||e.flag===r.GNode.Flag.Active){var a=e.node.getPage(),s=e.node.getScene(),d=s&&s.getActivePage();if(d&&a&&d!==a||(i=!0),e.node.hasMixin(r.GAnnotation)&&e.flag===r.GNode.Flag.Selected&&!1===e.set&&!e.node.isFillingCompleted()&&!(t=e.node).getProperty("rmd")&&t.getParent())if(e.node.isEmptyTextAllowed()){let t=n.annotTreeNodeMapByNodes.get(e.node);t&&t.reply&&t.reply.isVisible()&&setTimeout(()=>t.reply.forceSubmit())}else c.confirm(r.GLocale.get(new r.GLocaleKey("GAnnotationPanel","text.confirm-discard-annotation")),t=>{if(t)setTimeout(()=>{H(this,e.node)});else{gDesigner.getActiveDocument().getEditor().updateSelection(!1,[e.node]),gDesigner.getToolManager().activateTool(o.GPointerTool,null,!0);var i=n.annotTreeNodeMapByNodes.get(e.node);i&&i.reply&&setTimeout(()=>{i.reply.requestFocus()})}})}else if(!n.blockHighlight&&e.flag===r.GNode.Flag.Highlighted){var u=e.node,p=function(e){var t=G.call(this,e);return t&&t.isVisible()}.bind(this);if(p(u)||u.findParent(p)){var g=n.annotTreeNodeMapByNodes.get(u).component;g?g.toggleHighlight(e.set):console.warn("element parent was null")}}i&&ne.requestInvalidation.call(this,l.default.NO_CACHE_INVALIDATION)}}function ee(){var e=$(this).data("gannotationpanel");if(e.vtree.beginUpdate(),e.page)for(var t=e.page.getAnnotations().getFirstChild();null!==t;t=t.getNext())t.getProperty("rmd")||K.call(this,t,!0);e.vtree.endUpdate()}function te(e){var t=$(this).data("gannotationpanel");t.vtree.clean(),t.annotTreeNodeMap={},t.replyNodes=new Map,t.annotTreeNodeMapByNodes=new Map,void 0!==e&&(t.page=e),"number"==typeof t.delayedUpdate&&(clearTimeout(t.delayedUpdate),t.delayedUpdate=null)}r.GObject.inheritAndMix(y,r.GObject);var ne={init:function(e){return e=$.extend({nodeStyle:"annotation-row",expandStyle:"annotation-arrow gravit-icon-right",collapseStyle:"annotation-arrow gravit-icon-down",freeHeight:7,insertIntoStyle:"g-drop",upSeparatorSpan1Style:"g-up-separator-span1",upSeparatorSpan2Style:"g-up-separator-span2",downSeparatorSpan1Style:"g-down-separator-span1",downSeparatorSpan2Style:"g-down-separator-span2",renderer:D.bind(this),expandRenderer:w.bind(this),separatorRenderer:null,moveCallback:null,clickCallback:null,startDraggingCallback:null,updateCommentCount:null},e),this.each((function(){$(this).addClass("g-annotation-panel").data("gannotationpanel",{vtree:new p(this,b.bind(this),e.nodeStyle,e.expandStyle===e.collapseStyle?e.expandStyle:null,v.bind(this),_.bind(this),e.upSeparatorSpan1Style,e.upSeparatorSpan2Style,e.downSeparatorSpan1Style,e.downSeparatorSpan2Style),options:e,annotTreeNodeMap:{},annotTreeNodeMapByNodes:new Map,replyNodes:new Map,page:null,scheduledUpdate:null,scheduleNextUpdate:!1,blockAnnotationsUpdate:!1,updateInProgress:!1,showResolved:"boolean"==typeof e.showResolved&&e.showResolved,currentFocus:null,sidebarActive:e.sidebarActive,syncCallback:null,delayedUpdate:null})}))},requestInvalidation:function(e){$(this).data("gannotationpanel").vtree.requestInvalidation(0,e)},refresh:function(){$(this).data("gannotationpanel").vtree.refresh()},relayout:function(e){var t=$(this).data("gannotationpanel"),n=t.vtree,i=t.currentFocus;i&&n.expandAndFocus(i),e?(te.call(this),ee.call(this)):ne.requestInvalidation.call(this,l.default.NO_CACHE_INVALIDATION)},cleanEmptyAnnotations:function(){H(this)},isEditingOrAddingContent:function(){return $(this).data("gannotationpanel").vtree.isEditingOrAddingContent()},showResolved:function(e){var t=$(this).data("gannotationpanel");t.showResolved!==e&&(t.showResolved=e,te.call(this),ee.call(this))},page:function(e){var t=$(this),n=t.data("gannotationpanel")||{};return arguments.length?(e!==n.page&&(n.page&&n.page.hasMixin(r.GEventTarget)&&(n.page.removeEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.page.removeEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.page.removeEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.page.removeEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this),null!==n.scheduledUpdate&&(clearTimeout(n.scheduledUpdate),n.scheduledUpdate=null),n.updateInProgress=!1),te.call(this,e),n.page=e,n.page&&(n.page.hasMixin(r.GEventTarget)&&(n.beforeNodeRemoveHandler=Q.bind(this),n.afterPropertiesChangeHandler=Z.bind(this),n.afterFlagChangeHandler=J.bind(this),n.afterNodeInsertHandler=X.bind(this),n.page.addEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.page.addEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.page.addEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.page.addEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this)),ee.call(this))),this):n.page},setDelayedSyncCallback:function(e){$(this).data("gannotationpanel").syncCallback=e},annotations:function(e){let t=!1;if(q.call(this))return f.DELAYED;let n=$(this).data("gannotationpanel"),i=r.GNode.restore(e),o=i.getChildren();return i.clearChildren(),n.blockAnnotationsUpdate=!0,n.vtree.beginUpdate(),t=d.mergeAnnotations(n.page.getAnnotations(),n.page.getAnnotations().getChildren(),i,o),n.vtree.endUpdate(),n.blockAnnotationsUpdate=!1,te.call(this),ee.call(this),t?f.UPDATED:f.SKIPPED},blockHandlers:function(e){$(this).data("gannotationpanel").blockHandlers=!!e},ignoreBlock:function(e){$(this).data("gannotationpanel").ignoreBlock=e},setBlockHighlight:function(e){$(this).data("gannotationpanel").blockHighlight=!!e},getTreeNode:function(e){var t=null;return $(this).data("gannotationpanel")&&(t=G.call(this,e)),t},scrollIntoView:function(){const e=$(this).find(".annotation-row.g-selected").attr("id");if(e){const t=E.call(this,e);t&&(t.reply?t.reply.scrollIntoView():t.component&&t.component.scrollIntoView())}},getItem:function(e){return C.call(this,e.id)}};e.exports=y,$.fn.gAnnotationPanel=function(e){return ne[e]?ne[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):ne.init.apply(this,arguments)}},function(e,t,n){"use strict";n(19),n(24),n(9),n(28);const{GObject:i}=n(1),{GPlatform:o}=n(16),r=n(1236),a=n(1078),s=n(1237),l=n(1238),{handleCollabsData:c}=(n(1072),n(792)),d=n(1235),u=n(387);function p(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.call(this,...t),a.call(this)}i.inheritAndMix(p,r,[a]),p.prototype._checkTreeSanity=function(){return!!$(this._container).data("gannotationpanel")},p.prototype.clean=function(){r.prototype.clean.call(this),this.clearChildren()},p.prototype._isInvalidationBlocked=function(){return!!this.isEditingOrAddingContent()},p.prototype.isEditingOrAddingContent=function(){return!!this.getChildren().filter(e=>e instanceof l).some(e=>e.isVisible())||!!this.getChildren().filter(e=>e instanceof s).some(e=>e.isEditMode())},p.prototype._hasResolveAccess=!1,p.prototype._hasReopenAccess=!1,p.prototype._mentionData={},p.prototype.hasResolveAccess=function(){return this._hasResolveAccess},p.prototype.hasReopenAccess=function(){return this._hasReopenAccess},p.prototype.getMentionData=function(){return this._mentionData||{}},p.prototype.getCollaboratorsCache=function(){return this._collaboratorsCache},p.prototype._beforeInvalidationStart=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new d;this.clearChildren();var t=gDesigner.getApplicationManager();this._hasResolveAccess=await t.hasAccess(u.RESOLVE_COMMENT_ANNOTATION),this._hasReopenAccess=await t.hasAccess(u.REOPEN_COMMENT_ANNOTATION);const n=gDesigner.getActiveDocument(),i=gDesigner.getShareManager();e.collaboratorsCache&&i.resetCollaboratorsCached(n),this._collaboratorsCache=i.getCollaboratorsCached(n),this._mentionData=await c(this._collaboratorsCache)},p.prototype._afterInvalidationEnd=function(){this.scrollIntoView(),this._updateCommentStats()},p.prototype.scrollIntoView=function(){$(this._container).gAnnotationPanel("scrollIntoView")},p.prototype._updateCommentStats=function(){let e=0,t=0,n=this.getChildren(),i=$(this._container).data("gannotationpanel"),o=i&&i.options;n&&n.forEach(n=>{n instanceof s&&!n.isParentAnnotationResolved()&&(n.isRead()||t++,e++)}),o&&o.updateCommentCount&&o.updateCommentCount(e,t)},p.prototype.getCommentStats=function(){return this._commentStats},e.exports=p},function(e,t,n){"use strict";!function(e){e.event.special.input={setup:function(t,n){var i,o=this,r=o.value,a=document.createElement(this.tagName),s="oninput"in a||function(e){if(e.setAttribute("oninput","return"),"function"==typeof e.oninput)return!0;try{document.createEvent("KeyboardEvent");var t=!1,n=function(e){t=!0,e.preventDefault(),e.stopPropagation()};return document.body.appendChild(e),e.addEventListener("input",n,!1),e.removeEventListener("input",n,!1),document.body.removeChild(e),t}catch(e){}}(a),l="inputEventNS"+~~(1e7*Math.random()),c=["focus","blur","paste","cut","keydown","drop",""].join("."+l+" ");function d(){var t=e(o);o.value==r||t.data("triggering.inputEvent")||(r=o.value,t.data("triggering.inputEvent",!0).trigger("input"),window.setTimeout((function(){t.data("triggering.inputEvent",!1)}),0))}if(s)return!1;e(this).find("input, textarea").andSelf().filter("input, textarea").bind(c,(function(e){"focus"==e.type?(d(),clearInterval(i),i=window.setInterval(d,250)):"blur"==e.type?window.clearInterval(i):window.setTimeout(d,0)})),e(this).data("inputEventHandlerNS",l)},teardown:function(){var t=e(this);t.find("input, textarea").unbind(t.data("inputEventHandlerNS")),t.data("inputEventHandlerNS","")}},e.fn.input=function(e){return e?this.bind("input",e):this.trigger("input")}}(jQuery)},function(e,t,n){"use strict";n(45),n(3),n(14),n(29),function(e){jQuery.fn.extend({elastic:function(){var t=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each((function(){if("textarea"!==this.type)return!1;var n=jQuery(this),i=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"}),o=parseInt(n.css("line-height"),10)||parseInt(n.css("font-size"),"10"),r=parseInt(n.css("height"),10)||3*o,a=parseInt(n.css("max-height"),10)||Number.MAX_VALUE;a<0&&(a=Number.MAX_VALUE),i.appendTo(n.parent());for(var s=t.length;s--;)i.css(t[s].toString(),n.css(t[s].toString()));function l(){var e=Math.floor(parseInt(n.width(),10));i.width()!==e&&(i.css({width:e+"px"}),d(!0))}function c(e,t){var i=Math.floor(parseInt(e,10));n.height()!==i&&n.css({height:i+"px",overflow:t})}function d(e){var t=n.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),s=i.html().replace(/<br>/gi,"<br />");if((e||t+"&nbsp;"!==s)&&(i.html(t+"&nbsp;"),Math.abs(i.height()+o-n.height())>3)){var l=i.height()+o;l>=a?c(a,"auto"):c(l<=r?r:l,"hidden")}}n.css({overflow:"hidden"}),n.bind("keyup change cut paste",(function(){d()})),e(window).bind("resize",l),n.bind("resize",l),n.bind("update",d),n.bind("blur",(function(){i.height()<a&&(i.height()>r?n.height(i.height()):n.height(r))})),n.bind("input paste",(function(e){setTimeout(d,250)})),d()}))}})}(jQuery)},function(e,t,n){"use strict";var i=n(17);n(14),n(29),n(321),n(3),n(28),n(58),n(84),n(45);var o=i(n(793)),r=n(238),a=8,s=9,l=13,c=37,d=38,u=39,p=40,g=36,h=35,f={triggerChar:"@",onDataRequest:$.noop,minChars:1,allowRepeat:!1,showAvatars:!0,elastic:!0,defaultValue:"",onCaret:!0,classes:{autoCompleteItemActive:"active"},templates:{wrapper:'<div class="mentions-input-box"></div>',autocompleteList:'<div class="mentions-autocomplete-list"></div>',autocompleteListItem:'<li data-ref-id="<%=id%>" data-ref-type="<%=type%>" data-display="<%=display%>" data-style="<%=fontWeight%>"><%=content%></li>',autocompleteListItemAvatar:'<img src="<%=avatar%>"/>',autocompleteListItemLetterAvatar:'<div class="avatar g-user-commit-avatar"><%=letterAvatarsValue%></div>',autocompleteListItemIcon:'<div class="icon <%=icon%>"></div>',mentionsOverlay:'<div class="mentions"><div></div></div>',mentionItemSyntax:"@[<%=value%>](<%=type%>:<%=id%>)",mentionItemHighlight:'<strong><span id="<%=id%>"><%=value%></span></strong>'}},m=0,y=function(e){return $("<div>").text(e).html()},v=function(e){return e.replace(r.GRegex.String.MentionInputRegexpEncode,"\\$1")},_=function(e,t,n){return!t||t instanceof Array&&!t.length||!n?e:e.replace(new RegExp(r.GRegex.String.MentionInputHighlightRegString.replace("<%=term%>",t),"gi"),"<b>$1</b>")},b=function(e,t){if(e.createTextRange){var n=e.createTextRange();n.move("character",t),n.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},w=function(e){return e.replace(r.GRegex.String.MentionInputRtrim,"")},C=function(e){let t=++m+"";return e?e+t:t},E=function(e,t){return t.forEach(t=>{e=e.replace(t.key,t.value)}),e},S=function(e){var t,n,i,r,m,S,G=[],A={},T=[],P="";function L(){var n=I(),i=[];G.forEach(e=>{i.some(t=>t.name===e.name)||i.push(e)}),i.forEach(t=>{let i=E(e.templates.mentionItemSyntax,[{key:"<%=value%>",value:t.value},{key:"<%=type%>",value:t.type},{key:"<%=id%>",value:t.getUID()}]);n=n.replace(new RegExp(v(t.value),"g"),i)});var o=y(n);i.forEach(t=>{let n=y(t.value),i=E(e.templates.mentionItemSyntax,[{key:"<%=value%>",value:t.value},{key:"<%=type%>",value:t.type},{key:"<%=id%>",value:t.getUID()}]),r=E(e.templates.mentionItemHighlight,[{key:"<%=value%>",value:n},{key:"<%=id%>",value:t.getUID()}]);o=o.replace(new RegExp(v(i),"g"),r)}),o=(o=o.replace(/\n/g,"<br />")).replace(/ {2}/g,"&nbsp; "),t.data("messageText",n),t.trigger("updated"),m.find("div").html(o)}function D(){T=[]}function x(n){for(var i=I(),o=t[0].selectionStart,r=!1,a=!1,s=new RegExp("\\"+e.triggerChar+P,"gi");s.exec(i);)(!1===r||Math.abs(s.lastIndex-o)<r)&&(r=Math.abs(s.lastIndex-o),a=s.lastIndex);var l=a-P.length-1,c=a,d=i.substr(0,l),u=i.substr(c,i.length),p=(d+n.value).length+1;G.find(e=>e.id===n.id)||G.push(n),D(),P="",B();var g=d+n.value+" "+u;t.val(g),t.trigger("mention"),L(),t.focus(),b(t[0],p)}function I(){return $.trim(t.val())}function O(){var e,n,i=$(this);return x(A[i.attr("data-uid")]),e=$(t).offset().top,n=$("body").offset().top,$(window).scrollTop()>e&&$(window).scrollTop(e-n),!1}function k(){D()}function F(){B()}function R(){var t;L(),t=I(),G=(G=G.filter(e=>e.value&&t.includes(e.value))).filter(e=>e);var n=T.lastIndexOf(e.triggerChar);n>-1&&(P=T.slice(n+1).join(""),P=w(P),setTimeout(()=>{j.call(this,P)},1))}function M(e){if(e.keyCode!==a){var t=String.fromCharCode(e.which||e.keyCode);T.push(t)}}function N(e){if(i.data("assign",i.find("li").length),e.keyCode===c||e.keyCode===u||e.keyCode===g||e.keyCode===h)return setTimeout(D,1),void(navigator.userAgent.indexOf("MSIE 9")>-1&&setTimeout(L,1));if(e.keyCode!==a){if(!i.is(":visible"))return!0;switch(e.keyCode){case d:case p:var t=null;return(t=e.keyCode===p?S&&S.length?S.next():i.find("li").first():$(S).prev()).length&&U(t),!1;case l:case s:if(e.stopPropagation(),S&&S.length)return S.trigger("mousedown"),!1}return!0}T=T.slice(0,-1+T.length)}function B(){S=null,i.empty().hide()}function U(t){t.addClass(e.classes.autoCompleteItemActive),t.siblings().removeClass(e.classes.autoCompleteItemActive),S=t}function K(n,o){if(i.show(),!e.allowRepeat){let e=G.map(e=>e.value);o=o.filter(t=>!e.includes(t.showText))}if(o.length){i.empty();var r=$("<ul>").appendTo(i).css("visibility","hidden");o.forEach((t,i)=>{let o=C("mention_");t.setValue(t.showText),A[o]=t;let a=$(E(e.templates.autocompleteListItem,[{key:"<%=id%>",value:y(t.getUID())},{key:"<%=display%>",value:y(t.getFullUserName())},{key:"<%=type%>",value:y(t.type)},{key:"<%=content%>",value:_(y(t.display?t.display:"".concat(t.getFullUserName()).concat(t.getEmail()?"\n ".concat(t.getEmail()):"")),n,!1)},{key:"<%=fontWeight%>",value:y(t.fontWeight)}])).attr("data-uid",o);if(0===i&&U(a),e.showAvatars){var s,l;if(l=t.getUserNameInitials(),t.avatar)if("assets/icon/notification-icon.svg"===t.avatar){let t;t="light"===gDesigner.getSetting("theme","light")?"assets/icon/notification-icon-light.svg":"assets/icon/notification-icon-dark.svg",s=$(E(e.templates.autocompleteListItemAvatar,[{key:"<%=avatar%>",value:t}]))}else t.hasOwnPictureAvatar()?s=$(E(e.templates.autocompleteListItemAvatar,[{key:"<%=avatar%>",value:t.avatar}])):(s=$(E(e.templates.autocompleteListItemLetterAvatar,[{key:"<%=letterAvatarsValue%>",value:l}]))).css({"background-color":t.getUserColor()});else(s=$(E(e.templates.autocompleteListItemLetterAvatar,[{key:"<%=letterAvatarsValue%>",value:l}]))).css({"background-color":t.getUserColor()});s.prependTo(a)}a=a.appendTo(r)}),i.show(),e.onCaret&&function(e,t){var n,i=e.css("position");if("absolute"===i){var o=function(e){var t,n,i,o,r,a,s,l,c,d,u;if((c=e[0])&&$(c).is("textarea")&&null!==c.selectionEnd){for(s={position:"absolute",overflow:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word",boxSizing:"content-box",top:0,left:-9999},d=0,u=(l=["boxSizing","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","textDecoration","textIndent","textTransform","width","word-spacing"]).length;d<u;d++)s[r=l[d]]=$(c).css(r);return i=document.createElement("div"),$(i).css(s),$(c).after(i),n=document.createTextNode(c.value.substring(0,c.selectionEnd)),t=document.createTextNode(c.value.substring(c.selectionEnd)),(o=document.createElement("span")).innerHTML="&nbsp;",i.appendChild(n),i.appendChild(o),i.appendChild(t),i.scrollTop=c.scrollTop,a=$(o).position(),$(i).remove(),a}}(t);n=parseInt(t.css("line-height"),10)||18,e.css("width","15em"),e.css("left",o.left),e.css("top",n+o.top);var r=t.offset().left+t.width(),a=e.offset().left+e.width();r<=a&&e.css("left",Math.abs(e.position().left-(a-r)))}else if("fixed"===i){var s=function(e){var t,n,i,o,r,a,s,l,c,d,u;if((c=e[0])&&$(c).is("textarea")&&null!==c.selectionEnd){for(s={position:"absolute",overflow:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word",boxSizing:"content-box",top:0,left:-9999},d=0,u=(l=["boxSizing","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","textDecoration","textIndent","textTransform","width","word-spacing"]).length;d<u;d++)s[r=l[d]]=$(c).css(r);return i=document.createElement("div"),$(i).css(s),$(c).after(i),n=document.createTextNode(c.value.substring(0,c.selectionEnd)),t=document.createTextNode(c.value.substring(c.selectionEnd)),(o=document.createElement("span")).innerHTML="&nbsp;",i.appendChild(n),i.appendChild(o),i.appendChild(t),i.scrollTop=c.scrollTop,a=$(o).offset(),$(i).remove(),a}}(t);n=parseInt(t.css("line-height"),10)||18,e.css("width","15em"),e.css("left",s.left+1e4),e.css("top",n+s.top)}}(i,t),r.css("visibility","visible")}else B()}function j(t){t&&t.length&&t.length>=e.minChars?e.onDataRequest.call(this,"search",t,(function(e){K(t,e)})):B()}function H(n){G=[];for(var i,r=y(n),a=new RegExp("("+e.triggerChar+")\\[(.*?)\\]\\((.*?):(.*?)\\)","gi"),s=r;null!==(i=a.exec(r));)s=s.replace(i[0],i[1]+i[2]),G.push(new o.default({id:i[4],type:i[3],value:i[2],trigger:i[1]}));t.val(s),L()}return e=$.extend(!0,{},f,e),{init:function(o){"true"!==(t=$(o)).attr("data-mentions-input")&&(n=t.parent(),r=$(e.templates.wrapper),t.wrapAll(r),r=n.find("> div.mentions-input-box"),t.attr("data-mentions-input","true"),t.bind("keydown",N),t.bind("keypress",M),t.bind("click",k),t.bind("blur",F),t.bind("input",R),e.elastic&&t.elastic()),(i=$(e.templates.autocompleteList)).appendTo(r),i.delegate("li","mousedown",O),(m=$(e.templates.mentionsOverlay)).prependTo(r),H(e.defaultValue),e.prefillMention&&x(e.prefillMention)},val:function(e){$.isFunction(e)&&e.call(this,G.length?t.data("messageText"):I())},reset:function(){H()},reinit:function(){H(!1)},getMentions:function(e){$.isFunction(e)&&e.call(this,G)},setMentions:function(e){e&&e.length&&(G=e)}}};$.fn.mentionsInput=function(e,t){var n=arguments;return"object"!=typeof e&&e||(t=e),this.each((function(){var i=$.data(this,"mentionsInput")||$.data(this,"mentionsInput",new S(t));return $.isFunction(i[e])?i[e].apply(this,Array.prototype.slice.call(n,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist"):i.init.call(this,this)}))}},function(e,t,n){"use strict";var i=n(17);n(84),n(45),n(19),n(24);var o=n(43),r=n(1),a=(n(16),i(n(509))),s=n(56),l=i(n(118)),c=n(404).GVirtualTree,d=(n(404).GVirtualTreeNode,n(404).GVirtualTreeNodeNamed),{VTREE_FREE_HEIGHT:u,VTREE_FREE_HEIGHT_TOUCH:p}=n(12),g=(n(143),n(403));function h(){}function f(e,t,n,i,o){var r=!0,a=$(this).data("gpagepanel");if(a.options.canDropCallback){for(var s=e.id?b.call(this,e.id):$(this).data("gpagepanel").scene,l=t?b.call(this,t.id):null,c=[],d=0;d<i.length;++d)c.push(b.call(this,i[d].id));var u=[];if(r=a.options.canDropCallback(s,l,c,u))for(d=0;d<u.length;++d){var p=u[d];o.push(i[p])}}return r}function m(e,t,n,i){if(!n||!n.length||!e)return!1;var o=!0;if(gDesigner.getApplicationManager().isEditingEnabled()){for(var r=0;r<n.length&&o;++r)(o=!e.isLocked()&&n[r]&&n[r].validateInsertion(e,t))&&i.push[r];return o}}function y(e,t,n,i){var o=$(this).data("gpagepanel");if(o.options.moveCallback){for(var r=e.id?b.call(this,e.id):$(this).data("gpagepanel").scene,a=t?b.call(this,t.id):null,s=[],l=0;l<i.length;++l)s.push(b.call(this,i[l].id));o.options.moveCallback(r,a,s)}}function v(e){var t=$(this).data("gpagepanel");if(t.options.clickCallback){var n=b.call(this,e.id);t.options.clickCallback(n)}}function _(e,t){var n=$(this).data("gpagepanel");n.options.renderer&&n.options.renderer(e.id,t),R.call(this)}function b(e){var t=$(this).data("gpagepanel").pagesTreeNodeMap[e];return t?t.node:null}function w(e){return $(this).data("gpagepanel").pagesTreeNodeMap[e]}function C(e){var t=$(this).data("gpagepanel").pagesTreeNodeMapByNodes.get(e);return t?t.treeNode:null}function E(e){var t=$(this).data("gpagepanel").pagesTreeNodeMap,n=$(this).data("gpagepanel").pagesTreeNodeMapByNodes;e.accept(function(e){if(e instanceof r.GPage){var i=n.get(e);i&&(n.delete(e),t[i.treeId]=null)}}.bind(this))}function S(e,t){var n=$(this).data("gpagepanel"),i=w.call(this,e),l=i.node;if(l){if(!(l instanceof r.GPage))throw new Error("item not page");var c=l.getProperty("lkt"),d=!!l.getSlavePages().length,u=0===l.getProperty("w")&&0===l.getProperty("h"),p=$(t);p.attr("draggable",!1).on("mouseenter",(function(){l.getProperty("w")&&!l.hasFlag(r.GElement.Flag.Hidden)&&l.setFlag(r.GNode.Flag.Highlighted)})).on("mouseleave",(function(){l.getProperty("w")&&!l.hasFlag(r.GElement.Flag.Hidden)&&l.removeFlag(r.GNode.Flag.Highlighted)}));var h=$("<span></span>").addClass("page-title-group");h.appendTo(p),i.element=h;var f=l.getProperty("name");f=f||l.getNodeNameTranslated(),d&&!gDesigner.isTouchEnabled()&&(f+=" (master)");var m=$("<span></span>").html(f);m.addClass("page-title").appendTo(h);var y=this;l.hasFlag(r.GElement.Flag.PartialLocked)||h.attr("draggable",!0).attr("data-drag-mode",a.default.PRESS_AND_HOLD).on("dragstart",(function(e){if(n.options.startDraggingCallback){var t=n.options.startDraggingCallback(l);if(t&&t.length){$(this).addClass("g-dragging");var i="",o=t[0].getProperty("name");(o=o||t[0].getNodeNameTranslated())&&(i=o);for(var r=1;r<t.length;++r)(o=(o=t[r].getProperty("name"))||t[r].getNodeNameTranslated())&&(i+=", "+o);i.length&&$(m).html(i);var a=n.vtree,s=[];for(r=0;r<t.length;++r){var c=C.call(y,t[r]);c&&s.push(c)}a.setDragNodes(s),setTimeout(function(){$(this).removeClass("g-dragging"),$(m).html(f)}.bind(this),0)}else $(this).attr("draggable",!1)}})),p.toggleClass("g-active",l.hasFlag(r.GNode.Flag.Active)),n.blockHighlight||p.toggleClass("g-highlighted-row",l.hasFlag(r.GNode.Flag.Highlighted)),!c&&gDesigner.getApplicationManager().isEditingEnabled()&&$(h).gAutoEdit({textSelector:"> .page-title",getContainer:function(){return w.call(y,e).element},submitCallback:function(e){e&&""!==e.trim()&&o.GEditor.tryRunTransaction(l,(function(){l.setProperty("name",e)}),r.GLocale.get(new r.GLocaleKey("GPagePanel","action.rename-page")))}});var v=$("<span></span>").addClass("page-icon gravit-icon-page").insertBefore(m);gDesigner.isTouchEnabled()&&(u?(v.toggleClass("gravit-icon-page-infinity",!0),v.toggleClass("gravit-icon-page",!1)):d&&(v.toggleClass("gravit-icon-page-master",!0),v.toggleClass("gravit-icon-page",!1)));var _=c?"gravit-icon-lock":"gravit-icon-unlock";_=gDesigner.isTouchEnabled()?_+"-small":_,$("<span></span>").addClass("page-action page-lock "+_).toggleClass("g-active",!!c).attr("data-title",r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-lock"))).on("click",(function(e){gDesigner.stats("pages_change_lock"),e.stopPropagation();var t=l.getProperty("lkt");t=t?null:r.GBlock.LockType.Full,o.GEditor.tryRunTransaction(l,(function(){if(l.setProperty("lkt",t),t===r.GBlock.LockType.Full){n.scene.setProperty("edit",!1);var e=gDesigner.getActiveDocument();e&&e.getEditor().clearSelection()}else n.scene.setProperty("edit",!0)}),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-lock")))})).appendTo(p).gRichTooltip(s.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.page-toggle-lock-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.page-toggle-lock-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#page-panel"}));var b=!1===l.getProperty("vis");p.toggleClass("page-hiden",b);var E=b?"gravit-icon-hide":"gravit-icon-display";E=gDesigner.isTouchEnabled()?E+"-small":E,$("<span></span>").addClass("page-action page-visibility "+E).toggleClass("g-active",b).attr("data-title",r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-visibility"))).on("click",(function(e){gDesigner.stats("pages_change_visibility"),e.stopPropagation();var t=!l.getProperty("vis");o.GEditor.tryRunTransaction(l,(function(){l.setProperty("vis",t)}),r.GLocale.get(new r.GLocaleKey("GCommonNames","action.toggle-visibility")))})).appendTo(p).gRichTooltip(s.GRichTooltipConfig.from({title:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.page-toggle-visibility-tooltip-title")),description:r.GLocale.get(new r.GLocaleKey("GCommonNames","text.page-toggle-visibility-tooltip-description")),learnMore:"https://documentation.designer.io/organizing-your-designs/pages/#page-panel"})),p.contextmenu({context:g.PagePanel},function(e){$(this).data("gpagepanel").scene.setActivePage(l),$(gDesigner.getWindows().getHtmlElement()).trigger("contextmenu",e)}.bind(this))}}function G(e,t){var n=new d(e);return $(this).data("gpagepanel").vtree.insertNodeBefore(t,n),n}function A(e,t){var n=new d(e);return $(this).data("gpagepanel").vtree.appendNode(t,n),n}function T(e){$(this).data("gpagepanel").vtree.removeNode(e)}function P(e){var t,n,i=r.GUtil.uuid(),o=$(this).data("gpagepanel"),a=o.vtree;for(a.beginUpdate(),t=e.getNext();t&&!(t instanceof r.GPage);t=t.getNext());var s=t?C.call(this,t):null;n=s?G.call(this,i,s):A.call(this,i,null),o.pagesTreeNodeMap[i]={node:e,treeNode:n,element:null},o.pagesTreeNodeMapByNodes.set(e,{element:null,treeNode:n,treeId:i}),a.endUpdate()}function L(e){var t=C.call(this,e);t&&(T.call(this,t),E.call(this,e))}function D(e){!$(this).data("gpagepanel").blockHandlers&&e.node instanceof r.GPage&&P.call(this,e.node)}function x(e){!$(this).data("gpagepanel").blockHandlers&&e.node instanceof r.GPage&&L.call(this,e.node)}function I(e){if(!e.temporary&&(!$(this).data("gpagepanel").blockHandlers&&(e.node instanceof r.GPage||e.node instanceof r.GScene))){if(e.node instanceof r.GScene&&1===e.properties.length&&"pi"===e.properties[0])return;$(this).data("gpagepanel").vtree.requestInvalidation()}}function O(e){if(!e)return;$(this).find(".page-row.g-active").removeClass("g-active");const t=w.call(this,e.id),n=t&&t.element;n&&$(n).closest(".page-row").addClass("g-active")}function k(e){var t=$(this).data("gpagepanel"),n=$(this).data("gpagepanel").vtree;if(!t.blockHandlers&&e.node instanceof r.GPage)if(e.flag===r.GElement.Flag.Hidden||e.flag===r.GElement.Flag.PartialLocked||e.flag===r.GElement.Flag.FullLocked||e.flag===r.GNode.Flag.Active){var i=e.node.getScene(),o=i&&i.getActivePage();if(o&&o==e.node&&e.set){var a=C.call(this,e.node);n.expandAndFocus(a,!0),e.flag===r.GNode.Flag.Active?O.call(this,a):n.requestInvalidation()}}else t.blockHighlight||e.flag!==r.GNode.Flag.Highlighted||n.requestInvalidation()}function F(e){"touch"===e.key&&N._updateLayout.call(this)}function R(){gDesigner.isTouchEnabled()&&$(this).parent().css("height",parseInt($(this).find(".vscroller").css("height"),10)+u+"px")}function M(){var e=$(this).data("gpagepanel");e.vtree.clean(),e.pagesTreeNodeMap={},e.pagesTreeNodeMapByNodes=new Map,e.scene=null}r.GObject.inheritAndMix(h,r.GObject);var N={init:function(e){return e=$.extend({nodeStyle:"page-row",collapseStyle:"page-arrow gravit-icon-down",freeHeight:u,insertIntoStyle:"g-drop",upSeparatorSpan1Style:"g-up-separator-span1",upSeparatorSpan2Style:"g-up-separator-span2",downSeparatorSpan1Style:"g-down-separator-span1",downSeparatorSpan2Style:"g-down-separator-span2",renderer:S.bind(this),separatorRenderer:null,canDropCallback:m.bind(this),moveCallback:null,clickCallback:null,startDraggingCallback:null},e),this.each((function(){$(this).addClass("g-page-panel").data("gpagepanel",{vtree:new c(this,_.bind(this),e.nodeStyle,null,null,e.separatorRenderer?e.separatorRenderer:null,e.freeHeight,e.insertIntoStyle,f.bind(this),y.bind(this),null,null,v.bind(this),null,e.upSeparatorSpan1Style,e.upSeparatorSpan2Style,e.downSeparatorSpan1Style,e.downSeparatorSpan2Style,!1,0,21),options:e,pagesTreeNodeMap:{},pagesTreeNodeMapByNodes:new Map,scene:null,currentFocus:null})}))},refresh:function(){$(this).data("gpagepanel").vtree.refresh()},relayout:function(){var e=$(this).data("gpagepanel"),t=e.vtree,n=e.currentFocus;n&&t.expandAndFocus(n),t.requestInvalidation()},scene:function(e){var t=$(this),n=t.data("gpagepanel");if(!arguments.length)return n.scene;if(e!==n.scene&&(n.scene&&n.scene.hasMixin(r.GEventTarget)&&(n.scene.removeEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.scene.removeEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.scene.removeEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.removeEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this),gDesigner.removeEventListener(l.default,n.settingChangedEvent,this)),M.call(this),n.scene=e,n.scene)){n.scene.hasMixin(r.GEventTarget)&&(n.afterNodeInsertHandler=D.bind(this),n.beforeNodeRemoveHandler=x.bind(this),n.afterPropertiesChangeHandler=I.bind(this),n.afterFlagChangeHandler=k.bind(this),n.settingChangedEvent=F.bind(this),gDesigner.addEventListener(l.default,n.settingChangedEvent,this),n.scene.addEventListener(r.GNode.AfterInsertEvent,n.afterNodeInsertHandler,this),n.scene.addEventListener(r.GNode.BeforeRemoveEvent,n.beforeNodeRemoveHandler,this),n.scene.addEventListener(r.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.addEventListener(r.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this));for(var i=n.scene.getLastChild();null!==i;i=i.getPrevious())i instanceof r.GPage&&P.call(this,i);N._updateLayout.call(this)}return this},blockHandlers:function(e){$(this).data("gpagepanel").blockHandlers=!!e},getLastVisitedDroppable:function(){return $(this).data("gpagepanel").vtree.getLastVisitedDroppable()},setBlockHighlight:function(e){$(this).data("gpagepanel").blockHighlight=!!e},resetVTreeRowHeight:function(e){$(this).data("gpagepanel").vtree.resetRowHeight(e)},_updateLayout:function(){const e=$(this).data("gpagepanel"),t=e&&e.vtree;if(t){const e=gDesigner.isTouchEnabled();t.setFreeHeight(e?p:u),t.setAnimatedDragEnabled(e)}}};e.exports=h,$.fn.gPagePanel=function(e){return N[e]?N[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):N.init.apply(this,arguments)}},function(e,t,n){"use strict";n(14),n(63),n(28);var i=n(1),o=n(56),r=n(550);function a(e){var t=$(this).data("gsymbolspanel"),n=e.getMultireferenceId();if(t.symbolNodes[n])e.isMaster()&&!e.hasEventListeners(i.GSymbol.AfterThumbnailUpdate)&&e.addEventListener(i.GSymbol.AfterThumbnailUpdate,l.bind(this));else{var o=c.call(this,e);o&&(o.appendTo($(this)),t.symbolNodes[n]=e)}}function s(e,t){if(e.isMaster()){var n=$(this).data("gsymbolspanel"),o=e.getMultireferenceId(),r=$(this).find("#symbol_"+o);if(r.length){if(n.scene){var a=d.call(this,e);if(a&&(a.removeEventListener(i.GSymbol.AfterThumbnailUpdate,l),!t)){var s=n.blockHandlers;n.blockHandlers=!0,n.scene.removeSymbol(a),n.blockHandlers=s}}delete n.symbolNodes[o],r.remove(),0===Object.keys(n.symbolNodes).length&&y.call(this)}}}function l(e){var t=e.symbol,n=t.getFrame();if(n&&t.getPaintBBox()){$(this).data("gsymbolspanel");var o=t.getMultireferenceId(),r=$(this).find("#symbol_"+o),a=r.find(".symbol-image");a.empty();var s=n.getWidth(),l=n.getHeight()/s,c=85,d=c*l;d>85&&(c=(d=85)/l),h(a,c,d);var u=e.image.getBitmap().getHTMLElement(!0);if($(u).css({width:c,height:d,margin:"5px"}),t.hasFlag(i.GNode.Flag.Selected))r.find(".symbol-title-group").addClass("g-highlighted");$(u).appendTo(a)}}function c(e){var t=$(this).data("gsymbolspanel");if(e.isMaster()){if(!(e instanceof i.GSymbol))throw new Error("item not symbol");var n=$(this).find(".symbol-panel-info").parent();n.length&&n.remove();var r=$("<div />").attr("draggable",!1).attr("id","symbol_"+e.getMultireferenceId()).css({display:"inline"}).gRichTooltip(o.GRichTooltipConfig.from({title:e.getProperty("name"),description:i.GLocale.get(new i.GLocaleKey("GCommonNames","text.symbol-panel-symbol-tooltip-description")),middle:!1,learnMore:"https://documentation.designer.io/organizing-your-designs/symbols/#symbols-panel"})),a=$("<span></span>").addClass("symbol-title-group");a.appendTo(r);var s=e.getProperty("name");s=s||e.getNodeNameTranslated();var c=$("<span></span>");e.addEventListener(i.GSymbol.AfterThumbnailUpdate,l.bind(this)),c.addClass("symbol-image").appendTo(a);var u=this;return a.attr("draggable",!0).css({display:"inline-block",backgroundColor:"#eee",margin:"5px",height:"95px",width:"45%",textAlign:"center",lineHeight:"180px"}).on("dragstart",(function(n){$(this).addClass("g-dragging"),n.originalEvent.dataTransfer.effectAllowed="move",n.originalEvent.dataTransfer.setData(i.GNode.MIME_TYPE,i.GNode.serialize(e)),t.dragNode=e,setTimeout(function(){$(this).removeClass("g-dragging")}.bind(this),0)})).on("drop",(function(e){$(this).parent().parent().data("gsymbolspanel").dragNode=null})).on("click",(function(n){gDesigner.stats("symbol_click_select");var i=d.call(u,e);i&&(i.getScene()?t.options.clickCallback(i):a.toggleClass("g-highlighted"))})).on("dblclick",(function(n){gDesigner.stats("symbol_click_focus");var i=d.call(u,e);i&&t.options.dblClickCallback(i)})),r}}function d(e){if(e.getScene())return e;var t=$(this).data("gsymbolspanel");if(!t.scene)return null;for(var n=t.scene.getSymbols(),i=0;i<n.length;i++)if(n[i].getMultireferenceId()===e.getMultireferenceId())return n[i]}function u(e){var t=$(this).data("gsymbolspanel");if(!t.blockHandlers&&e.node instanceof i.GSymbol)if(e.data.created){a.call(this,e.node);var n=t.scene.getSymbolImage(e.node);n?l.call(this,{symbol:e.node,image:n}):e.node.toBitmap()}else s.call(this,e.node,!0)}function p(e){!$(this).data("gsymbolspanel").blockHandlers&&(e.node,i.GSymbol)}function g(e){for(var t=$(this).data("gsymbolspanel"),n=e.node;n&&!(n instanceof i.GSymbol&&n.isMaster());)n=n.getParent();if(!t.blockHandlers&&n){var o=n.getMultireferenceId(),r=$(this).find("#symbol_"+o).find(".symbol-title-group");e.flag===i.GNode.Flag.Selected&&(e.set?r.addClass("g-highlighted"):r.removeClass("g-highlighted"))}}function h(e,t,n){e.css({position:"relative",top:n/2-42.5+"px"})}function f(){$(this).data("gsymbolspanel"),$(this).data("gsymbolspanel");for(var e=$(this).find(".symbol-image"),t=0;t<e.length;t++){var n=$(e[t]),i=n.find("canvas");(i.css("width")||"0px").split("px")[0];h(n,0,(i.css("height")||"0px").split("px")[0])}}function m(){var e=$(this).data("gsymbolspanel");e.symbolNodes={},e.scene=null,$(this).empty(),y.call(this)}function y(){$("<div>").append($("<div>").addClass("symbol-panel-info").append($("<div></div>").addClass("symbol-panel-infotitle").text(i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","common.nosymbolsdefined")))).append($("<span></span>").text(i.GLocale.get(new i.GLocaleKey("GCreateSymbolAction","common.nosymbolsdefined-info"))))).appendTo($(this))}var v={init:function(e){return e=$.extend({moveCallback:null,clickCallback:null,dblClickCallback:null,startDraggingCallback:null},e),this.each((function(){$(this).addClass("g-symbols-panel").data("gsymbolspanel",{options:e,symbolNodes:{},scene:null,currentFocus:null})}))},relayout:function(){f.call(this)},newSymbolClick:function(){return gDesigner.canExecuteAction(r.ID)&&(gDesigner.stats("symbol_click_createnewsymbol"),gDesigner.executeAction(r.ID,void 0,void 0,!0)),!1},isSelected:function(){$(this).data("gsymbolspanel");return $(this).find(".g-highlighted").length>0},removeSelected:function(){var e=$(this).data("gsymbolspanel"),t=$(this).find(".g-highlighted").parent().attr("id");if(t){var n=t.split("_")[1],i=e.symbolNodes[n];i&&s.call(this,i)}},scene:function(e){var t=$(this),n=t.data("gsymbolspanel");if(!arguments.length)return n.scene;if(e!==n.scene&&(n.scene&&n.scene.hasMixin(i.GEventTarget)&&(n.scene.removeEventListener(i.GNode.AfterSpecialChangeEvent,n.afterSpecialChangeHandler,this),n.scene.removeEventListener(i.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.removeEventListener(i.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this)),m.call(this),n.scene=e,n.scene)){n.scene.hasMixin(i.GEventTarget)&&(n.afterSpecialChangeHandler=u.bind(this),n.afterPropertiesChangeHandler=p.bind(this),n.afterFlagChangeHandler=g.bind(this),n.scene.addEventListener(i.GNode.AfterSpecialChangeEvent,n.afterSpecialChangeHandler,this),n.scene.addEventListener(i.GNode.AfterPropertiesChangeEvent,n.afterPropertiesChangeHandler,this),n.scene.addEventListener(i.GNode.AfterFlagChangeEvent,n.afterFlagChangeHandler,this));var o=n.scene.getSymbols();o&&o.forEach(function(e){a.call(this,e);var t=n.scene.getSymbolImage(e);t?l.call(this,{symbol:e,image:t}):e.toBitmap()}.bind(this))}return this}};$.fn.gSymbolsPanel=function(e){return v[e]?v[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):v.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1);const o={init:function(e){e=$.extend({clazz:null,defaultText:i.GLocale.get(new i.GLocaleKey("GToolbar","text.share")),stats:"toolbar_click_share",restrictedStats:"toolbar_nonprotriespro_share",closeCallback:null},e);let t=$(this);return t.data("gsharebutton",{options:e}),this.addClass("share-button").addClass("g-highlight-button").addClass("highlighted").addClass(e.clazz||"").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(e.defaultText)).on("click",()=>{if(t.hasClass("g-disabled"))return;const n=gDesigner.getShareManager();n.isShareProRestricted()?(gDesigner.stats(e.restrictedStats),gDesigner.handleShareFilePROFeatureInterruption()):(gDesigner.stats(e.stats),n.share(t.data("gsharebutton").storeItem,e.closeCallback))}),this},update:function(e){const{isPrivate:t,isSharing:n,disabled:o}=e,r=$(this);o?r.addClass("g-disabled"):r.removeClass("g-disabled");gDesigner.getShareManager().isShareProRestricted()&&r.gPro();const a=r.data("gsharebutton");r.find(".icon").css("display",n?"":"none").toggleClass("gravit-icon-private-share",t).toggleClass("gravit-icon-public-share",!t);const s=n?new i.GLocaleKey("GToolbar","text.shared"):a.options.defaultText?a.options.defaultText:new i.GLocaleKey("GToolbar","text.share");return r.find(".label").text(i.GLocale.get(s)),a.storeItem=e.storeItem,e.closeCallback&&(a.options.closeCallback=e.closeCallback),this}};$.fn.gShareButton=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gShareButton"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";n(9);var i=n(1),o=n(12);const r={init:function(e){e=$.extend({clazz:null,defaultText:i.GLocale.get(new i.GLocaleKey("GUnshareButton","text.unshare-with-me")),stats:"filespanel-view_infoPanel_unshare",restrictedStats:"filespanel-view_infoPanel_nonprotriespro-unshare",unshareCallback:null},e);let t=$(this);return t.data("gunsharebutton",{options:e}),this.addClass("unshare-button").addClass("g-highlight-button").addClass("highlighted").addClass(e.clazz||"").append($("<span/>").addClass("icon")).append($("<span/>").addClass("label").text(e.defaultText)).on("click",()=>{if(t.hasClass("g-disabled"))return;gDesigner.getShareManager().isShareProRestricted()?(gDesigner.stats(e.restrictedStats),gDesigner.handleShareFilePROFeatureInterruption()):(gDesigner.stats(e.stats),gDesigner.getUser().then(async n=>{if(!n)return;const i=t.data("gunsharebutton").storeItem.getId(),r=n.getUID();console.log("About to call unshare with item id: %s and user id: %s",i,r),await o.gApi.unshareWithUser(i,r),"function"==typeof e.unshareCallback&&e.unshareCallback()}))}),this},update:function(e){const{disabled:t,hidden:n}=e,i=$(this);t?i.addClass("g-disabled"):i.removeClass("g-disabled"),n?i.hide():i.show();gDesigner.getShareManager().isShareProRestricted()&&i.gPro();const o=i.data("gunsharebutton");return o.storeItem=e.storeItem,e.unshareCallback&&(o.options.unshareCallback=e.unshareCallback),this}};$.fn.gUnshareButton=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gUnshareButton"):r.init.apply(this,arguments)}},function(e,t,n){"use strict";n(45);var i=n(1044),o=n(397),r={init:function(e){return e=$.extend({menu:null,defaultAction:null,dblclick:null,touch:!1,reference:null},e),this.each((function(){var t=this,n=null;"function"==typeof e.menu&&(e.menuFactory=e.menu,e.menu=e.menuFactory()),e.menu.setTouchMode(!!e.touch);$(this).addClass("g-menu-button").data("gmenubutton",{options:e}).on("mousedown",(function(i){if(i.stopPropagation(),e.menuFactory){const t=e.menuFactory();if(t!==e.menu){e.menu.clearItems();for(let n=0;n<t.getItemCount();++n)e.menu.addItem(t.getItem(n))}}e.dblclick?setTimeout(()=>{parseInt($(t).data("dblclicked"),10)?e.menu.isOpen()&&r.close.call(t):e.defaultAction?n=setTimeout(function(){r.open.call(t),n=null}.bind(this),250):e.menu.isOpen()?r.close.call(t):r.open.call(t)},500):e.defaultAction?n=setTimeout(function(){r.open.call(t),n=null}.bind(this),250):e.menu.isOpen()?r.close.call(t):r.open.call(t)})).on("mouseup",(function(i){i.stopPropagation(),e.dblclick?setTimeout(()=>{var i=parseInt($(t).data("dblclicked"),10);i?$(t).data("dblclicked",i-1):(null!==n&&(clearTimeout(n),n=null),!e.menu.isOpen()&&e.defaultAction&&e.defaultAction())},500):(null!==n&&(clearTimeout(n),n=null),!e.menu.isOpen()&&e.defaultAction&&e.defaultAction())})).on("dblclick",(function(n){n.stopPropagation(),e.dblclick&&($(t).data("dblclicked",2),e.dblclick.call(t))}))}))},open:function(){var e=$(this),t=e.data("gmenubutton").options,n=t.menu;if(!n.isOpen()){e.addClass("g-active");var r;if(n.addEventListener(i,(function t(){e.removeClass("g-active"),n.removeEventListener(i,t)})),t.reference&&(t.reference instanceof jQuery||t.reference instanceof HTMLElement?r=t.reference:"function"==typeof t.reference&&(r=t.reference())),r instanceof HTMLElement&&(r=$(r)),r||(r=e),n.open(r,o.Position.Center,o.Position.Right_Bottom,(function(t){e.trigger("menuitemactivate",t)})),t.getActiveItem&&"function"==typeof t.getActiveItem){const e=t.getActiveItem();e&&n.setActiveItem(e)}}},close:function(){var e=$(this).data("gmenubutton").options.menu;e.isOpen()&&e.close()}};$.fn.gMenuButton=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):r.init.apply(this,arguments)}},function(e,t,n){"use strict";n(45);var i=n(16),o=[],r=function(e){var t=!1;if(o.length>0)for(var n=o.length-1;n>=0;--n){var i=$(o[n]),r=i.closest(".g-overlay"),a=$(e.target).closest("body > *"),s=!1;r.parent().length>0&&r.parent().hasClass("g-dialog-container")&&0===$(e.target).closest(".g-overlay").length&&(s=!0),($(a).index()<r.index()||s)&&(t=!0,i.gOverlay("close",e,n))}return t};document.addEventListener("mousedown",(function(e){r(e)}),!0),document.addEventListener("keydown",(function(e){var t=e.which||e.keyCode;if(27===t)r(e)&&e.stopPropagation();else if(13===t&&o.length>0)for(var n=o.length-1;n>=0;--n){var i=$(o[n]).data("goverlay"),a=i&&i.options;a.enterCallback&&a.enterCallback(e)}}),!0),window.addEventListener("resize",(function(){for(var e=0;e<o.length;++e){$(o[e]).gOverlay("relayout")}}));var a=function(e){e.changed.escapeKey&&(e.isImmediatePropagationStopped=!0)},s={init:function(e){return e=$.extend({modal:!1,padding:!0,releaseOnClose:!1,clazz:"",enterCallback:null,offsetX:0,offsetY:0,bottomOffsetY:0,customRight:null,bottomClazz:null,rightClazz:null,closeCallback:null,disableDarkShadow:!1,middle:!1,side:!1,sideClazz:"g-overlay-side",flipHorizontal:!1},e),this.each((function(){$(this).data("goverlay",{options:e,target:null}).wrap($("<div></div>").addClass("g-overlay").addClass(e.clazz).toggleClass("no-padding",!e.padding).css("position","absolute"))}))},relayout:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=$.extend({preserveTop:!1},e);var t=$(this),n=t.data("goverlay");if(!n||!n.target&&!n.isPoint)return;let i;var o=t.closest(".g-overlay"),r=$(window),a=r.width(),s=r.height(),l=o.outerWidth(),c=o.outerHeight(),d={};n.yTop&&n.xLeft?(d.top=n.yTop,d.left=n.xLeft):(i=$(n.target),d=i.offset());var u,p,g=d.top,h=n.isPoint?0:i.outerWidth()/2,f=d.left+h,m=n.options.middle?f:d.left,y=n.isPoint?0:i.outerWidth(),v=n.options.middle?f:d.left+y,_=n.isPoint?0:i.outerHeight(),b=d.top+_;n.options.side?(t.addClass(n.options.sideClazz),(u=v+n.options.offsetX)+l>a&&(u=m-l-n.options.offsetX,t.addClass("g-overlay-left-side")),(p=g+n.options.offsetY)+c>s&&(p=b-c-n.options.offsetY,t.addClass("g-overlay-valign-bottom"))):((u=null!==n.options.customRight?a-v+n.options.customRight:m+n.options.offsetX)+l>a?(u=v-l-n.options.offsetX,n.options.rightClazz&&t.addClass(n.options.rightClazz)):n.options.flipHorizontal&&(u=m-l-n.options.offsetX),u+l>a&&(u=a-l),(p=b+n.options.offsetY)+c>s&&(p=g-c-parseInt(n.options.bottomOffsetY),n.options.bottomClazz&&t.addClass(n.options.bottomClazz)),p+c>s&&(p=s-c-parseInt(n.options.bottomOffsetY))),u<0&&(u=0),p<0&&(p=0);let w=!1;if(e.preserveTop){const e=o.offset(),t=e&&e.top;w="number"==typeof t&&t+c<s}w||o.css("top",p+"px"),null===n.options.customRight?o.css("left",u+"px"):o.css("right",u+"px")},open:function(e,t,n){var r=$(this);const l=e&&"number"==typeof e.x&&"number"==typeof e.y;var c=r.data("goverlay"),d=c&&c.options;e&&!d.disableDarkShadow&&($(e).closest(".sidebar-inspector").addClass("sidebar-overlay"),$(".g-touch-toolbar").addClass("sidebar-overlay"),$(e).is(":input")&&$(e).closest(".content").addClass("overlay")),c&&(c.target=e,c.isPoint=l,c.xLeft=e.x,c.yTop=e.y);var u,p=r.closest(".g-overlay");if(t&&(u=$(t).closest(".g-dialog-container.visible")),!u||!u.length){var g=$(".g-dialog-container.visible");u=g.length>0?g[g.length-1]:$("body")}return d&&d.modal?$("<div></div>").addClass("g-overlay-modal").append(p).appendTo(u):p.appendTo(u),i.GPlatform.addEventListener(i.GModifiersChangedEvent,a,this[0],null,!0),s.relayout.call(this),o.push(this[0]),r.trigger("open"),n&&n(),this},close:function(e,t){var n=$(this),r=n.data("goverlay");if(o.length&&o[t>=0?t:o.length-1]===this[0]){var s=!1;const t=function(){s=!0};if(n.trigger("close",[t,e]),s)return;var l;i.GPlatform.removeEventListener(i.GModifiersChangedEvent,a,this[0]),r&&(r.target&&($(".sidebar-inspector").removeClass("sidebar-overlay"),$(".g-touch-toolbar").removeClass("sidebar-overlay"),$(".content.overlay").removeClass("overlay")),r.target=null,l=r.options);var c=n.closest(".g-overlay-modal");!l||l.releaseOnClose?n.closest(".g-overlay").remove():n.closest(".g-overlay").detach(),c.remove(),o.pop(),l&&l.closeCallback&&l.closeCallback()}return this},isOpenned:function(e){var t=$(this).data("goverlay");return e?t&&t.target&&t.target.get(0)===e.get(0):t&&t.target}};$.fn.gOverlay=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):s.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(17),o=n(1),r=i(n(509)),a={init:function(e){return e=$.extend({allowDrag:!0,allowDrop:!0},e),this.each((function(){var t=this,n=$(this);n.data("gpatterntarget",{options:e,pattern:null,types:null}),e.allowDrag&&n.attr("draggable","true").attr("data-drag-mode",r.default.PRESS_AND_HOLD).on("dragstart",(function(e){var t=e.originalEvent,i=n.data("gpatterntarget").pattern;if(i){t.stopPropagation(),n.trigger("patterndrag",i);var r=gDragImage().css({background:o.GPattern.asCSSBackground(i),width:"20px",height:"20px"});t.dataTransfer.setDragImage(r[0],10,10),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData(o.GPattern.MIME_TYPE,o.GPattern.serialize(i)),t.dataTransfer.sourceElement=this}else t.preventDefault()})).on("dragend",(function(e){e.stopPropagation()})),e.allowDrop&&n.on("dragover",(function(e){e.stopPropagation();var t=e.originalEvent;t.preventDefault(),t.stopPropagation(),e.originalEvent.dataTransfer.dropEffect="move"})).on("drop",(function(e){e.stopPropagation();var i=n.data("gpatterntarget"),r=e.originalEvent,s=r.dataTransfer.getData(o.GPattern.MIME_TYPE);if(s&&(s=o.GPattern.deserialize(s))){var l=!0;if(i.types&&i.types.length>0){l=!1;for(var c=0;c<i.types.length;++c)if(i.types[c]&&s instanceof i.types[c]){l=!0;break}}if(l){var d=n.data("gpatterntarget").pattern;o.GUtil.equals(s,d)||(a.value.call(t,s),n.trigger("patternchange",s)),n.trigger("patterndrop",[s,r])}}return!1}))}))},value:function(e){var t=$(this),n=t.data("gpatterntarget")||{};return arguments.length?(e="string"==typeof e?o.GPattern.deserialize(e):e,n.pattern=e,this):n.pattern||null},types:function(e){var t=$(this),n=t.data("gpatterntarget");return arguments.length?(n.types=e,this):n.types}};$.fn.gPatternTarget=function(e){return a[e]?a[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):a.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1),o={init:function(e){return this.each((function(){var e=this,t=$(this).data("gpivot",{value:null}).addClass("g-pivot"),n=function(n){$("<div></div>").addClass("side").attr("data-side",n).on("click",(function(i){gDesigner.stats("pivot_click_change-button"),o.value.call(e,n),t.trigger("pivotchange",n)})).appendTo(t)};for(var r in $("<div></div>").addClass("borderline").appendTo(t),i.GRect.Side)if(i.GRect.Side.hasOwnProperty(r)){var a=i.GRect.Side[r];"string"==typeof a&&n(a)}}))},value:function(e){var t=$(this),n=t.data("gpivot");return arguments.length?(n.value=e,t.find("div[data-side]").each((function(t,n){var i=$(n);i.toggleClass("g-active",i.attr("data-side")===e)})),this):n.value}};$.fn.gPivot=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";n(28);var i={init:function(e){return e=$.extend({},e),this.each((function(){var t=$(this);if(t.addClass("g-property-row"),e.hasOwnProperty("clazz")&&t.addClass(e.clazz),e.hasOwnProperty("label")||e.hasOwnProperty("icon")){var n=$('<label class="property-label"></label>').appendTo(t);if(e.hasOwnProperty("icon"))t.addClass("icon-label"),n.addClass("strict-line-height"),"string"==typeof e.icon?$("<span></span>").addClass(e.icon).appendTo(n):n.append(e.icon);else{var i=$("<span />").addClass("vertical-align").appendTo(n);"string"==typeof e.label?i.text(e.label):i.append(e.label)}e.click&&n.addClass("clickable").find("span").append($("<span></span>").addClass("gravit-icon-down click-arrow")).on("click",e.click)}else t.addClass("no-label");e.hasOwnProperty("justified")&&!0===e.justified&&t.addClass("justified");var o=$("<div></div>").addClass("columns").appendTo(t);e.hasOwnProperty("clickable")&&e.clickable&&o.addClass("clickable"),e.hasOwnProperty("hoverable")&&e.hoverable&&o.addClass("hoverable"),e.hasOwnProperty("height")&&o.css("height",e.height);var r=!1;if(e.columns.forEach((function(t){var n="<div></div>";t.content&&$(t.content).is(":input")&&(n="<label></label>");var i=$(n).addClass("column");if(t.hasOwnProperty("clazz")&&i.addClass(t.clazz),"auto"===t.width?i.addClass("auto-grow"):t.width&&i.css("width",t.width),t.prefix){var a="",s=null;"string"==typeof t.prefix?a=t.prefix+"&nbsp;":(a=t.prefix.label,s=t.prefix.width||null),$("<div></div>").addClass("prefix").css("width",s).html(a).appendTo(i)}t.content?$("<div></div>").addClass("content").append(t.content).appendTo(i):t.html?$(t.html).appendTo(i):i.html("&nbsp;"),(!t.content||t.hasOwnProperty("padding")&&!1===t.padding)&&i.addClass("no-padding"),t.label&&(r=!0),e.isMenu&&($("<div/>").addClass("gravit-icon-right").click(()=>{t.content.click()}).appendTo(i),o.addClass("no-padding-left")),e.hasOwnProperty("rawClick")&&e.rawClick&&i.on("click",e.rawClick),e.noPaddingRight&&o.addClass("no-padding-right"),i.appendTo(o)})),r){var a=$("<div></div>").addClass("labels").appendTo(t);e.columns.forEach((function(e){var t=$("<label></label>");e.label?"string"==typeof e.label?$("<span></span>").text(e.label).addClass(e.labelClass?e.labelClass:"").appendTo(t):t.append(e.label):t.html("&nbsp;"),"auto"===e.width?t.addClass("auto-grow"):e.width&&t.css("width",e.width),(!e.content||e.hasOwnProperty("padding")&&!1===e.padding)&&t.addClass("no-padding"),t.appendTo(a)}))}}))}};$.fn.gPropertyRow=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):i.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1),o={init:function(e){var t=[{unit:i.GLength.Unit.PX,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.px")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.px.short"),void 0,i.GLocaleLanguage.English)},{unit:i.GLength.Unit.MM,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.mm")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.mm.short"),void 0,i.GLocaleLanguage.English)},{unit:i.GLength.Unit.CM,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.cm")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.cm.short"),void 0,i.GLocaleLanguage.English)},{unit:i.GLength.Unit.IN,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.in")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.in.short"),void 0,i.GLocaleLanguage.English)},{unit:i.GLength.Unit.PC,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.pc")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.pc.short"),void 0,i.GLocaleLanguage.English)},{unit:i.GLength.Unit.PT,name:i.GLocale.get(new i.GLocaleKey("GLength","unit.pt")),short:i.GLocale.get(new i.GLocaleKey("GLength","unit.pt.short"),void 0,i.GLocaleLanguage.English)}];return e=$.extend({short:!1},e),this.each((function(){var n=$(this);if(n.is("select"))for(var i=0;i<t.length;++i)n.append($("<option></option>").attr("value",t[i].unit).text(e.short?t[i].short:t[i].name))}))}};$.fn.gUnit=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";n(45);var i=[];function o(){if(i.length>0){var e=$(i[i.length-1]);$(e).data("gdialog").closable&&e.gDialog("close",!0)}}document.addEventListener("keydown",(function(e){27===e.keyCode&&o()}));var r={init:function(e){return e=$.extend({releaseOnClose:!0,className:"",buttons:null,openCallback:null,closeCallback:null,nowrap:!1,closeTimeout:null,alwaysCloseable:!1},e),this.each((function(){var t=$(this).data("gdialog",{options:e,closable:!1});if(e.nowrap||t.addClass("g-dialog-content").wrap($("<div></div>").addClass("g-dialog").addClass(e.className||"")),e.buttons&&e.buttons.length)for(var n=$("<div></div>").addClass("g-dialog-footer").appendTo(t.closest(".g-dialog")),i=$("<div/>").addClass("buttons").appendTo(n),o=0;o<e.buttons.length;++o)$(e.buttons[o]).appendTo(i)}))},open:function(e){var t=$(this),n=t.data("gdialog"),r=n.options||{};n&&(n.closable=e||!1);var a=t.closest(".g-dialog"),s=$("<div></div>").addClass("g-dialog-container").on("mousedown",e=>$(e.target).hasClass("g-dialog-container")&&0===$(e.target).find(".g-overlay").length?o():void 0).append(a).appendTo($("body"));if(n){const{options:{className:e}={}}=n;e&&s.addClass("".concat(e,"-container"))}return i.push(this[0]),t.trigger("open"),s.addClass("visible"),r&&r.openCallback&&r.openCallback.call(this),this},isOpen:function(){return i.length&&i[i.length-1]===this[0]},close:function(e,t){var n=$(this),o=n.data("gdialog").options||{};if(o.alwaysCloseable&&i.indexOf(this[0])>=0||i.length&&i[i.length-1]===this[0]){var r=n.closest(".g-dialog-container");if(r.removeClass("visible"),setTimeout(()=>{o.releaseOnClose?n.closest(".g-dialog").remove():n.parents(".g-dialog").detach(),r.remove()},parseInt(isNaN(t)?isNaN(o.closeTimeout)?250:o.closeTimeout:t)),o.alwaysCloseable){var a=i.indexOf(this[0]);i.splice(a,1)}else i.pop();o&&o.closeCallback&&o.closeCallback(e)}return this}};$.fn.gDialog=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):r.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(17);n(45),n(262);var o,r,a,s=n(16),l=n(1),c=i(n(10)),d=n(12),u=n(56),p=i(n(1225)),g={init:function(e){if(e){if(!(e instanceof u.GRichTooltipConfig))throw new Error("Not a Tooltip Config");return e=$.extend({title:"No title",isPro:!1,shortcut:null,video:null,pic:null,description:null,videoTimeout:2e3,middle:!0,marginLeft:0,side:!1,learnMore:null,upgradeToProStatsValue:null,forceShow:!1,flipHorizontal:!1},e.getConfig()),d.IS_COREL&&!e.forceShow?this:this.each((function(){const t=$(this);e._id=c.default.uuid(7),t.data("g-rich-tooltip",e),t.on("mouseover",(function(e){o&&(clearTimeout(o),o=null),r&&(clearTimeout(r),r=null);var n=function(){t.data("g-rich-tooltip-container-hovered",!0),g.showTooltip.call(t,e)};a?n():r=setTimeout(n,500)})),t.on("mouseout",(function(e){r&&(clearTimeout(r),r=null),t.data("g-rich-tooltip-container-hovered",!1),g.hideTooltip.call(t,e)})),t.on("mousedown",(function(){r&&(clearTimeout(r),r=null)}))}))}},showTooltip:function(){const e=$(this),t=e.data("g-rich-tooltip");if(a){if(a.data("g-rich-tooltip-id")===t._id)return;g.close.call(e)}gContainer.getProperty(p.default.StoragePropertyName).then(n=>{t.enhanced="boolean"!=typeof n||n,(a=g.createTooltip(t)).on("mouseover",(function(){o&&(clearTimeout(o),o=null),e.data("g-rich-tooltip-self-tooltip-hovered",!0)})),a.on("mouseout",(function(){e.data("g-rich-tooltip-self-tooltip-hovered",!1),g.hideTooltip.call(e)})),a.on("click",(function(){g.close.call(e)})),a.gOverlay("open",e)})},hideTooltip:function(){const e=$(this);o=setTimeout(()=>{e.data("g-rich-tooltip-container-hovered")||e.data("g-rich-tooltip-self-tooltip-hovered")||g.close.call(e)},100)},createTooltip:function(e){var t=0,n=4;return e.side?(t=0,n=-6):e.middle&&(t=-13),e.marginLeft&&(t+=parseInt(e.marginLeft)),e.flipHorizontal&&(t=0-t),$("<div />").addClass("g-rich-tooltip-container").data("g-rich-tooltip-id",e._id).append(g.createTooltipContent(e)).gOverlay({padding:!0,releaseOnClose:!0,bottomClazz:"from-bottom",rightClazz:"from-right",offsetY:n,offsetX:t,bottomOffsetY:6,clazz:"g-tooltip-content-overlay "+(e.flipHorizontal?"flip-horizontal":""),disableDarkShadow:!0,middle:e.middle,side:e.side,flipHorizontal:e.flipHorizontal})},createTooltipContent:function(e){const{title:t,isPro:n,shortcut:i,video:o,pic:r,description:a,videoTimeout:c,enhanced:d,learnMore:u,upgradeToProStatsValue:p}=e;let g=a;const h=u?'<a href="'.concat(u,'" target="_blank">').concat(l.GLocale.get(new l.GLocaleKey("GCommonNames","text.learn-more")),"</a>"):"";g=g?"".concat(g," ").concat(h):h;const f=$("<div />").addClass("g-tooltip-content-wrapper").toggleClass("g-pro",n).append($("<div />").addClass("g-tooltip-content-header").toggleClass("simple",!d).append(i&&i.length?$("<div />").addClass("g-tooltip-content-shortcut").text(s.GKey.shortcutToString(i)):"").append($("<div />").toggleClass("limit-width",!(!i||!i.length)).addClass("g-tooltip-content-title").text(t))).append(d&&g?$("<div />").addClass("g-tooltip-content-description").html(g):"").append(d&&o&&o.length?$("<div />").addClass("g-tooltip-content-video loading"):"").append(d&&r&&r.length?$("<div />").addClass("g-tooltip-content-picture").append($("<img />").attr("width",298).attr("height",160).attr("src",r)):"").append(d&&n&&!gDesigner.getLicense().isPro()?$("<div />").addClass("g-tooltip-content-footer").append($("<div />").addClass("g-tooltip-footer-pro-badge").append($("<div />").addClass("g-tooltip-pro-icon")).append($("<div />").addClass("g-tooltip-pro-text").text(l.GLocale.get(new l.GLocaleKey("GCommonNames","text.try-this-feature-pro-tooltip-text"))))).on("click",()=>{gDesigner.openPaymentDialog(),gDesigner.stats("action_tooltips_upgradetopro",p)}):"");return d&&o&&setTimeout(()=>{const e=f.find(".g-tooltip-content-video");if(e.length){const t=$("<video />").attr("width",298).attr("height",160).attr("src",o).attr("autoplay",!0).attr("loop",!0);t.on("loadeddata",(function(){e.removeClass("loading")})),e.append(t)}},c),f},close:function(){a&&(a.gOverlay("close"),a=void 0)}};$.fn.gRichTooltip=function(e){return g[e]?g[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):g.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=function(e,t){var n=$(e);n.addClass(t?"collapsed":"expanded"),n.removeClass(t?"expanded":"collapsed");var i=$(n.find(".gravit-icon-down,.gravit-icon-right")[0]);i.removeClass(t?"gravit-icon-down":"gravit-icon-right"),i.addClass(t?"gravit-icon-right":"gravit-icon-down")},o={init:function(e,t,n,o){return this.each((function(){var r=$(this).next(e);if(!$(this).hasClass("accordion")){var a=$("<span></span>").addClass($(this).hasClass("collapsed")?"gravit-icon-right":"gravit-icon-down"),s=$("<button></button>").addClass("g-accordion").on("click",function(){r.toggle();var e="none"===r.css("display");i(this,e),o&&gDesigner.stats("".concat(o,"_toggle_page"),e?"Collapse":"Expand"),$(this).trigger("change")}.bind(this)).append(a),l=$("<div/>").addClass("g-accordion-ghost");if(t){var c=$(this).find(t+":first");n?$(s).insertBefore(c):($(s).insertAfter(c),$(l).insertAfter(s)),c.on("click",(function(){s.trigger("click")})).on("mouseover",(function(){s.toggleClass("hovered")})).on("mouseout",(function(){s.toggleClass("hovered")}))}else $(this).append(s),$(this).append(l);$(this).addClass("accordion")}r.css("display",$(this).hasClass("collapsed")?"none":"")}))},toggleOpen:function(e){i(this,!e)}};$.fn.gAccordion=function(e){return o[e]?o[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):o.init.apply(this,arguments)}},function(e,t,n){"use strict";var i={init:function(e){return this.each((function(){var t=$(this),n=e.autoPadding,i=$("<span/>").addClass("g-input-label");e.label?i.html(e.label):e.class&&i.addClass(e.class),t.find("input").css("padding-left","20px").css("width","100%"),n&&t.find("input").css("padding-left","".concat(21+e.label.length,"px")),t.prepend(i)}))}};$.fn.gInputLabel=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):i.init.apply(this,arguments)}},function(e,t,n){"use strict";var i=n(1),o=n(32),r=(n(143),!1),a=null,s=null;function l(){}function c(e,t){var n=gDesigner.getActiveDocument().getEditor(),o=n.getSelection();if(o&&o.length>0){var r=i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.style-attribution"));n.beginTransaction();try{for(var a=0;a<o.length;++a)t?o[a].removeStyle(e.getReferenceId()):o[a].addStyle(e.getReferenceId())}finally{n.commitTransaction(r)}n.updateSelection(!1,o)}}function d(e,t,n,o){var r=gDesigner.getActiveDocument();t||((n=new i.GStyle).setProperty("name",i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.new-style"))),n.setProperty("defaultStyle",!1));var a=n.clone(),s=null;r.getEditor().getSelection()&&r.getEditor().getSelection().length>0&&(s=r.getEditor().getSelection()[0]),!t&&s&&a.assignStyleFrom(s);var l=t?i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.style-editor")):i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.style-creator")),d=$("<div/>").append($("<span/>").text(l)).addClass("creator-toolbar"),u=$("<input/>").css("align-self","center").css("width","100%").attr("type","text").val(n.getProperty("name")),g=$("<div/>").addClass("style").append($("<img/>").css("align-self","center").css("margin-left","10px").attr("src",gDesigner.getStylePreview(a,s instanceof i.GText))).append(u),f=$("<div/>").addClass("checkboxes").append($("<div/>").append($("<input/>").attr("data-property","style").attr("type","checkbox").prop("checked",!t||$.inArray(i.GStylable.PropertySet.Style,n.getProperty("ps"))>=0)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.style")))).addClass("checkbox")).append($("<div/>").append($("<input/>").attr("data-property","fill").attr("type","checkbox").prop("checked",!t||$.inArray(i.GStylable.PropertySet.FillPaintLayers,n.getProperty("ps"))>=0)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.fill")))).addClass("checkbox")).append($("<div/>").append($("<input/>").attr("data-property","border").attr("type","checkbox").prop("checked",!t||$.inArray(i.GStylable.PropertySet.BorderPaintLayers,n.getProperty("ps"))>=0)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.border")))).addClass("checkbox")).append($("<div/>").append($("<input/>").attr("data-property","effects").attr("type","checkbox").prop("checked",!t||$.inArray(i.GStylable.PropertySet.Effects,n.getProperty("ps"))>=0)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.effects")))).addClass("checkbox")).append($("<div/>").append($("<input/>").attr("data-property","text").attr("type","checkbox").prop("checked",t?$.inArray(i.GStylable.PropertySet.Text,n.getProperty("ps"))>=0:s instanceof i.GText)).append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.text")))).addClass("checkbox")),m=$("<div/>"),y=$("<div/>").append($("<button/>").html(t?i.GLocale.get(new i.GLocaleKey("GCommonNames","action.apply")):i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","action.create"))).on("click",(function(){gDesigner.stats("designerstyle_click_create");var a=[];if(f.find('input[data-property="style"]').is(":checked")&&a.push(i.GStylable.PropertySet.Style),f.find('input[data-property="fill"]').is(":checked")&&a.push(i.GStylable.PropertySet.FillPaintLayers),f.find('input[data-property="border"]').is(":checked")&&a.push(i.GStylable.PropertySet.BorderPaintLayers),f.find('input[data-property="effects"]').is(":checked")&&a.push(i.GStylable.PropertySet.Effects),f.find('input[data-property="text"]').is(":checked")&&(a.push(i.GStylable.PropertySet.Text),a.push(i.GStylable.PropertySet.Paragraph)),n.setProperties(["name","ps"],[g.find("input").val(),a]),!t){if(s&&n.assignStyleFrom(s),r.getScene().getStyles().appendChild(n),h(n,e,!1,o),o.parent()){var l=o.parent();l.offset().top+l.height()>document.body.clientHeight&&l.offset({top:l.offset().top-34,left:l.offset().left})}c(n)}gDesigner.createNewStylePreview(n,!0,s instanceof i.GText),m.gOverlay("close",e),!t&&o&&o.gOverlay("close"),p(t?$(".g-style-creator").find(".styles"):$(".g-style-editor").find(".styles:not(.no-style)"),t)}))).addClass("creator-toolbar bottom");m.addClass("g-style-creator").append(d).append($("<div/>").addClass("styles").append(g)).append(f).append(y).gOverlay({padding:!1,releaseOnClose:!0}).gOverlay("open",e);var v=m.parent().offset().top,_=m.parent().offset().left;m.parent().offset({top:v,left:_-100}),u.focus()}function u(e){if(a){var t=$(e).data("style");return t&&t.getReferenceId()!==a.getReferenceId()}return!1}function p(e,t){if(e.empty(),gDesigner.getActiveDocument().getScene().getStyles()){var n=gDesigner.getActiveDocument().getScene().getStyles();t||($(".g-style-editor").find(".no-style").empty(),f($(".g-style-editor").find(".no-style")));for(var i=n.getFirstChild();null!==i;i=i.getNext())!1===i.getProperty("defaultStyle")&&h(i,e,t)}}function g(e){var t=gDesigner.getActiveDocument().getEditor().getSelection();return!!(t&&t.length>0)&&t[0].getProperty("sref")===e.getReferenceId()}function h(e,t,n,o){var l=function(e){if(!r)return e.preventDefault(),void e.stopPropagation();var n=(s=$(e.target).closest(".style")).offset(),i=e.originalEvent;i.stopPropagation(),a=s.data("style"),!1,i.pageX-n.left,i.pageY-n.top,i.dataTransfer.effectAllowed="move",i.dataTransfer.setData("text/plain","dummy_data"),t.find(".style").each((function(e,n){$(n).on("dragenter",(function(e){u(this)&&($(this).parent().find(".style").removeClass("g-drop"),$(this).addClass("g-drop"))})).on("dragleave",(function(e){u(this)&&$(e.target).parent()!==this&&e.target!==this&&$(this).removeClass("g-drop")})).on("dragover",(function(e){var t=e.originalEvent;u(this)&&(t.preventDefault(),t.stopPropagation(),t.dataTransfer.dropEffect="move")})).on("drop",(function(){var e=$(this);e.removeClass("g-drop"),!0;var n=e.data("style");if(a&&n&&a.getParent()===n.getParent()){var i=a.getParent(),o=i.getIndexOfChild(a),r=i.getIndexOfChild(n);i.removeChild(a),i.insertChild(a,o<r?n.getNext():n),p(t,!0)}}))}))}.bind(this),h=function(){!1}.bind(this),f=$("<div/>").addClass("style").data("style",e).appendTo(t);$("<div/>").addClass("style-selector").appendTo(f),n&&f.attr("draggable",!0).on("mousedown",(function(e){r=$(e.target).hasClass("style")||$(e.target).parent().hasClass("style")})).on("dragstart",l).on("dragend",h),n||f.attr("data-selected",g(e)?"yes":"no").addClass(g(e)?"g-selected":"").on("click",(function(){var t=$(this);gDesigner.stats("designerstyle_click_assign",e&&e.getReferenceId()),"no"===t.attr("data-selected")&&($(".g-style-editor").find(".style").removeClass("g-selected"),$(".g-style-editor").find(".style").attr("data-selected","no"),t.attr("data-selected","yes").addClass("g-selected"),c(e)),o&&o.gOverlay("close")}));var m=null,y=gDesigner.getActiveDocument().getEditor().getSelection();if(y&&y.length>0&&(m=y[0]),f.append($("<img/>").css("align-self","center").attr("src",gDesigner.getStylePreview(e,m instanceof i.GText))),$("<span/>").css({alignSelf:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",width:"200px"}).text(e.getProperty("name")).appendTo(f),n)$("<div/>").addClass("styles-buttons").css("display","none").append($("<button/>").addClass("g-flat").css("align-self","center").append($("<span/>").addClass("gravit-icon-trash")).on("click",(function(){gDesigner.stats("designerstyle_click_disconnect",e&&e.getReferenceId()),e.disconnectStyle(),gDesigner.getActiveDocument().getScene().getStyles().removeChild(e),f.remove()}))).append($("<button/>").addClass("g-flat").css("align-self","center").append($("<span/>").addClass("gravit-icon-settings")).on("click",(function(){gDesigner.stats("designerstyle_click_open",e&&e.getReferenceId()),d(f,!0,e)}))).appendTo(f);t.hasClass("styles")||t.addClass("styles")}function f(e,t){var n=gDesigner.getActiveDocument().getEditor().getSelection();if(n&&n.length>0){var o=$("<div/>").addClass("style").appendTo(e),r=n[0],a=!r.getProperty("sref");$("<div/>").addClass("style-selector").appendTo(o),o.attr("data-selected",a?"yes":"no").addClass(a?"g-selected":"").on("click",(function(){var e=$(this);"no"===e.attr("data-selected")&&(e.parent().find(".style").attr("data-selected","no").removeClass("g-selected"),e.attr("data-selected","yes").addClass("g-selected"),c(r.getReferencedStyle(),!0)),t&&t.gOverlay("close")})),$("<span/>").css("align-self","center").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.no-style"))).css("width","165px").css("margin-left","10px").appendTo(o),e.hasClass("styles")||(e.addClass("styles"),e.addClass("no-style"))}}i.GObject.inheritAndMix(l,i.GObject);var m={init:function(){return this.each((function(){var e=this,t=$(this),n=function(){var n=$("<div/>"),o=$("<div/>"),r=$("<div></div>").addClass("g-style-editor").css("width","250px");if(f(n,r),gDesigner.getActiveDocument().getScene().getStyles())for(var a=gDesigner.getActiveDocument().getScene().getStyles().getFirstChild();null!==a;a=a.getNext())!1===a.getProperty("defaultStyle")&&h(a,o,!1,r);var s=$("<div/>").addClass("style-toolbar").append($("<div/>").append($("<button/>").addClass("g-flat").html(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","action.create-new-style")))).on("click",(function(){gDesigner.stats("designerstyle_click_createnewstyle"),d(o,!1,null,r)}))).append($("<div/>").append($("<button/>").addClass("g-flat").html(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","action.organize-styles"))+"...")).on("click",(function(){gDesigner.stats("designerstyle_click_organize"),function(e){var t=$("<div/>").append($("<span/>").text(i.GLocale.get(new i.GLocaleKey("GDesignerStyleEditor","text.style-organizer")))).addClass("creator-toolbar"),n=$("<div/>"),o=gDesigner.getActiveDocument().getScene().getStyles(),r=!1;if(o)for(var a=o.getFirstChild();null!==a;a=a.getNext())!1===a.getProperty("defaultStyle")&&(r=!0,h(a,n,!0));r||f(n);var s=$("<div/>"),l=$("<div/>").append($("<button/>").html(i.GLocale.get(new i.GLocaleKey("GCommonNames","text.finish"))).on("click",(function(){gDesigner.stats("designerstyle_click_finish");var t=$(".g-style-editor").find(".styles:not(.no-style)");if(t.empty(),o)for(var n=o.getFirstChild();null!==n;n=n.getNext())!1===n.getProperty("defaultStyle")&&h(n,t,!1,e);s.gDialog("close")}))).addClass("creator-toolbar bottom");s.append(t).append(n).append(l).gDialog({releaseOnClose:!0,className:"g-style-creator organizer"}),s.gDialog("open",!1)}(r)})));r.append(n).append(o).append(s).on("open",(function(){t.trigger("open")})).on("close",(function(){t.trigger("close")})).gOverlay({padding:!1,releaseOnClose:!0}).gOverlay("open",e)};t.gPro().on("click",o.watchDog.trap((function(){gDesigner.stats("designerstyle_click_openpanel"),t.find(".g-styles-field").hasClass("g-disabled")||n()}),null,()=>{gDesigner.stats("designerstyle_nonprotriespro_openpanel")}))}))},value:function(e){}};e.exports=l,$.fn.gDesignerStyleEditor=function(e){return m[e]?m[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):m.init.apply(this,arguments)}},function(e,t,n){"use strict";n(9);var i=n(1),o=n(12),r=n(322),a=n(546),s=n(1046),l=null,c=null;var d={init:function(){return this.each((function(){c=$("<div/>").addClass("overlay-fade").on("click",(function(){this.remove(),l.gOverlay("close")})).appendTo($("body"));var e=r.USERLOGIN.loadLogo();l=$("<div></div>").addClass("loading").addClass("g-user-details").addClass(r.USERLOGIN.OVERLAY_CLASS).append(e).gOverlay({clazz:"g-user-login-dialog"+(r.USERLOGIN.OVERLAY_CLASS?" "+r.USERLOGIN.OVERLAY_CLASS:""),padding:!1,releaseOnClose:!0,closeCallback:function(){c.remove()}}).gOverlay("open",this),gDesigner.getUser().then(async e=>{let t=!o.PROFILE_DIALOG_URL;o.PROFILE_DIALOG_URL&&(t=await o.gApi.hasPurchases().catch(()=>!1)),l.removeClass("loading"),l.append(function(e,t){const n=gDesigner.getLicense(),r=()=>{l.gOverlay("close")},c=e.canUpdateSelfAccountData();var d=$("<div/>"),u=$("<div/>").addClass("footer").append($("<div/>").addClass("top-section").append([$("<button/>").html(i.GLocale.get(new i.GLocaleKey("GCommonNames","action.settings"))).addClass("highlight").css("display",c?"":"none").on("click",async n=>{gDesigner.stats("profile_click_open-button"),o.ALWAYS_SHOW_ACCOUNT_SETTING_DIALOG||t?new a(e).open():o.PROFILE_DIALOG_URL?gContainer.openExternalLink(n,o.PROFILE_DIALOG_URL):gContainer.openExternalLink(n,o.gApi.url+"/profile"),r()}),$("<button/>").html(i.GLocale.get(new i.GLocaleKey("GCommonNames","action.sign-out"))).addClass("signout").on("click",(function(){gDesigner.stats("profile_click_signout-button"),gDesigner.signout(),r()}))]));if(o.USER_LOGIN.SHOW_PURCHASE_PRO&&!gDesigner.isAnonymous()&&(!n.isPro()||n.isExpired())){const e=gDesigner.getAction(s.ID);e&&e.isVisible()&&e.isAvailable()&&u.append($("<div/>").addClass("bottom-section").append($("<button/>").addClass("highlight full-width").html(i.GLocale.get(new i.GLocaleKey("GPurchaseProAction","title"))).on("click",(function(){gDesigner.stats("profile_click_purchase-pro"),gDesigner.executeAction(s.ID,null,null,!0)}))))}return e.hasOwnPictureAvatar()?d.append($("<div/>").append($("<div/>").addClass("avatar").css("background-image",'url("'+e.avatar+'")')).append($("<div/>").addClass("username-div").append($("<div/>").addClass("username").append($("<span/>").addClass("name").text(e.getFullUserName())).append($("<span/>").addClass("email").text(e.getAccountName()))))).append(u):d.append($("<div/>").append($("<div/>").addClass("avatar").addClass("g-user-login-avatar").css({"background-color":e.getUserColor()}).text(e.getUserNameInitials())).append($("<div/>").addClass("username-div").append($("<div/>").addClass("username").append($("<span/>").addClass("name").text(e.getFullUserName())).append($("<span/>").addClass("email").text(e.getAccountName()))))).append(u),d}(e,t))})}))}};$.fn.gUserLogin=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}},function(e,t,n){"use strict";const i={init:function(){let{feature:e,pro:t=!0,badgeAlwaysVisible:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.each((function(){var i=$(this);if(i.toggleClass("pro",!!t),i.toggleClass("badge-always-visible",!!n),t){const t=gDesigner.getLicense(),n=t.isLegacy()&&gDesigner.isLegacyFeature(e),o=t.isTrial()&&!n;if(i.toggleClass("trial",o),"option"===i.prop("tagName").toLowerCase()){const e=i.closest("select");e.hasClass("has-pro-option")||e.addClass("has-pro-option"),o&&!e.hasClass("has-trial-option")&&e.addClass("has-trial-option")}}i.toggleClass("legacy-feature",gDesigner.isLegacyFeature(e))}))}};$.fn.gPro=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gPro"):i.init.apply(this,arguments)}},function(e,t,n){"use strict";n(262);const{watchDog:i}=n(32),o=n(386),r={init:function(e){return e=$.extend({defaultRole:null,buttons:[]},e),this.each((function(){const t=o.ROLES.ALL.filter(e=>e.isAssignable()),n=$("<div/>").gOverlay({padding:!1,clazz:"g-role-selector-overlay",releaseOnClose:!1}).addClass("g-role-selector-container").append($("<div/>").addClass("g-role-selector-roles").append(t.map(e=>$("<div/>").attr("role-id",e.id).addClass("g-role-selector-role").append($("<span/>").addClass("icon").addClass("gravit-icon-role-checked")).append($("<div/>").addClass("g-role-selector-role-container").append($("<span/>").addClass("name").text(e.name).gPro({pro:!!e.pro,badgeAlwaysVisible:!0})).append($("<span/>").addClass("text").text(e.description))).on("click",i.trap(()=>{r.role.call(this,e),$(this).trigger("rolechange",e),n.gOverlay("close")},()=>!e.pro)))));e.buttons&&e.buttons.length&&(n.append($("<hr/>")),n.append($("<div/>").addClass("g-role-selector-buttons").append(e.buttons.map(e=>{let{icon:t,label:i,click:o,closeOnClick:r}=e;return $("<div/>").addClass("g-role-selector-button").append($("<span/>").addClass("icon").addClass(t||"")).append($("<span/>").addClass("label").text(i)).on("click",()=>{o(),r&&n.gOverlay("close")})}))));const a=$(this).data("options",e).data("overlay",n).addClass("g-role-selector").append($("<label/>")).append($("<span/>").addClass("gravit-icon-down")).on("click",e=>{n.gOverlay("open",$(e.target).closest(".g-role-selector"))}),s=e.defaultRole||t[0];return r.role.call(this,s),a}))},role:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(arguments.length>0){const n=$(this);let i=t&&n.data("options")?n.data("options").role:null;n.data("options").previousRole=i,n.data("options").role=e,n.find("label").text(e.name);const o=n.data("overlay");return o.find(".g-role-selector-role.g-selected").removeClass("g-selected"),o.find('[role-id="'.concat(e.id,'"]')).addClass("g-selected"),this}return $(this).data("options").role},restoreRole:function(){const e=$(this);e.data("options").previousRole&&r.role.call(this,e.data("options").previousRole,!1)}};$.fn.gRoleSelector=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gRoleSelector"):r.init.apply(this,arguments)}},function(e,t,n){"use strict";n(171);var i=n(1);const o=n(217),r=e=>{e.empty().append($("<div/>").addClass("container").append($("<span/>").addClass("gravit-icon-pages")).append($("<span/>").addClass("caption")).append($("<span/>").addClass("gravit-icon-down")))},a=(e,t)=>{e.empty().append($("<div />").addClass("action-button").append($("<span />").addClass("gravit-icon-touch-pages-panel")).append($("<span />").addClass("caption"))).append(t)},s={init:function(){return this.each((function(){const e=$(this),t=$("<button />").addClass("dropdown-button").append($("<span></span>").addClass("gravit-icon-down"));e.data("g-page-button-dropdownbutton",t);let n=new o(void 0,"g-page-menu");e.addClass("g-page-button").gMenuButton({menu:()=>{const t=e.data("options")&&e.data("options").scene;return t&&(n.clearItems(),t.getChildren().filter(e=>e instanceof i.GPage&&e.isVisible()).reduce((e,t)=>(e.createAddItem(t.getLabel(),()=>{t.setFlag(i.GNode.Flag.Active)}),e),n)),n},getActiveItem:()=>{const t=e.data("options")&&e.data("options").scene;if(t){const e=t.getActivePage();if(e)return n.findItem(e.getLabel())}return null},reference:()=>gDesigner.isTouchEnabled()?t:null}),gDesigner.isTouchEnabled()?a(e):r(e)}))},scene:function(e){const t=$(this),n=t.data("options")||{};return n.scene!==e&&(n.scene&&n.scene.removeEventListener(i.GNode.AfterFlagChangeEvent,s._afterFlagChangeEvent,this),n.scene=e,e&&(s._activatePage.call(this,e.getActivePage()),e.addEventListener(i.GNode.AfterFlagChangeEvent,s._afterFlagChangeEvent,this))),t.data("options",n),this},reinit:function(){const e=$(this);gDesigner.isTouchEnabled()?a(e,e.data("g-page-button-dropdownbutton")):r(e);const t=(e.data("options")||{}).scene;t&&(s._activatePage.call(this,t.getActivePage()),t.hasEventListeners(i.GNode.AfterFlagChangeEvent,s._afterFlagChangeEvent,this)||t.addEventListener(i.GNode.AfterFlagChangeEvent,s._afterFlagChangeEvent,this))},release:function(){const e=$(this),t=e.data("options");return t&&t.scene&&t.scene.removeEventListener(i.GNode.AfterFlagChangeEvent,s._afterFlagChangeEvent,this),e.remove(),this},_afterFlagChangeEvent:function(e){e.node instanceof i.GPage&&e.flag===i.GNode.Flag.Active&&s._activatePage.call(this,e.node)},_activatePage:function(e){$(this).find(".caption").text(e?e.getLabel():"")}};$.fn.gPageButton=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gPageButton"):s.init.apply(this,arguments)}},function(e,t,n){"use strict";n(84);const i={init:function(){return this.each((function(){const e=$(this).addClass("g-share-user-input");$("<input>").attr("type","email").keypress(e=>{const t=e.keyCode?e.keyCode:e.which;if(32!=t&&13!=t||(e.stopPropagation(),e.preventDefault()),13==t){const t=$(e.target).closest("input"),n=t.val();return n&&n.trim().length&&($("<div/>").addClass("email").append($("<span/>").text(n.trim())).append($("<span/>").addClass("gravit-icon-close").on("click",e=>{$(e.target).closest(".email").remove()})).insertBefore(t),t.val("").focus()),!1}}).appendTo(e)})),this},users:function(){return this}};$.fn.gShareUserInput=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.gShareUserInput"):i.init.apply(this,arguments)}},function(e,t,n){"use strict";var i={init:function(e){return this.each((function(){$(this).on("scroll",(function(){if(gDesigner.isTouchEnabled()){var t=$(this)[0].scrollTop,n="light"==gDesigner.getSetting("theme")?"DFDFDF":"2E2E2E";t=t>20?20:t,$(e).css({"box-shadow":"0 ".concat(t,"px 20px -5px #").concat(n)})}}))}))}};$.fn.gToolbarShadow=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.myPlugin"):i.init.apply(this,arguments)}},function(e,t,n){}]);